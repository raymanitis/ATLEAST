function AG(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var hhe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ZA(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var I={exports:{}},on={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T1=Symbol.for("react.element"),fhe=Symbol.for("react.portal"),mhe=Symbol.for("react.fragment"),ghe=Symbol.for("react.strict_mode"),yhe=Symbol.for("react.profiler"),vhe=Symbol.for("react.provider"),bhe=Symbol.for("react.context"),whe=Symbol.for("react.forward_ref"),xhe=Symbol.for("react.suspense"),_he=Symbol.for("react.memo"),khe=Symbol.for("react.lazy"),SB=Symbol.iterator;function She(e){return e===null||typeof e!="object"?null:(e=SB&&e[SB]||e["@@iterator"],typeof e=="function"?e:null)}var MG={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},RG=Object.assign,DG={};function ky(e,t,n){this.props=e,this.context=t,this.refs=DG,this.updater=n||MG}ky.prototype.isReactComponent={};ky.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ky.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function LG(){}LG.prototype=ky.prototype;function XA(e,t,n){this.props=e,this.context=t,this.refs=DG,this.updater=n||MG}var JA=XA.prototype=new LG;JA.constructor=XA;RG(JA,ky.prototype);JA.isPureReactComponent=!0;var CB=Array.isArray,FG=Object.prototype.hasOwnProperty,YA={current:null},zG={key:!0,ref:!0,__self:!0,__source:!0};function BG(e,t,n){var r,i={},a=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(a=""+t.key),t)FG.call(t,r)&&!zG.hasOwnProperty(r)&&(i[r]=t[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:T1,type:e,key:a,ref:s,props:i,_owner:YA.current}}function Che(e,t){return{$$typeof:T1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function QA(e){return typeof e=="object"&&e!==null&&e.$$typeof===T1}function Ihe(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var IB=/\/+/g;function ZT(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ihe(""+e.key):t.toString(36)}function A_(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case T1:case fhe:s=!0}}if(s)return s=e,i=i(s),e=r===""?"."+ZT(s,0):r,CB(i)?(n="",e!=null&&(n=e.replace(IB,"$&/")+"/"),A_(i,t,n,"",function(u){return u})):i!=null&&(QA(i)&&(i=Che(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(IB,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=r===""?".":r+":",CB(e))for(var o=0;o<e.length;o++){a=e[o];var l=r+ZT(a,o);s+=A_(a,t,n,l,i)}else if(l=She(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=r+ZT(a,o++),s+=A_(a,t,n,l,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function yx(e,t,n){if(e==null)return e;var r=[],i=0;return A_(e,r,"","",function(a){return t.call(n,a,i++)}),r}function $he(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ga={current:null},M_={transition:null},The={ReactCurrentDispatcher:Ga,ReactCurrentBatchConfig:M_,ReactCurrentOwner:YA};on.Children={map:yx,forEach:function(e,t,n){yx(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return yx(e,function(){t++}),t},toArray:function(e){return yx(e,function(t){return t})||[]},only:function(e){if(!QA(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};on.Component=ky;on.Fragment=mhe;on.Profiler=yhe;on.PureComponent=XA;on.StrictMode=ghe;on.Suspense=xhe;on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=The;on.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=RG({},e.props),i=e.key,a=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,s=YA.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)FG.call(t,l)&&!zG.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:T1,type:e.type,key:i,ref:a,props:r,_owner:s}};on.createContext=function(e){return e={$$typeof:bhe,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:vhe,_context:e},e.Consumer=e};on.createElement=BG;on.createFactory=function(e){var t=BG.bind(null,e);return t.type=e,t};on.createRef=function(){return{current:null}};on.forwardRef=function(e){return{$$typeof:whe,render:e}};on.isValidElement=QA;on.lazy=function(e){return{$$typeof:khe,_payload:{_status:-1,_result:e},_init:$he}};on.memo=function(e,t){return{$$typeof:_he,type:e,compare:t===void 0?null:t}};on.startTransition=function(e){var t=M_.transition;M_.transition={};try{e()}finally{M_.transition=t}};on.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};on.useCallback=function(e,t){return Ga.current.useCallback(e,t)};on.useContext=function(e){return Ga.current.useContext(e)};on.useDebugValue=function(){};on.useDeferredValue=function(e){return Ga.current.useDeferredValue(e)};on.useEffect=function(e,t){return Ga.current.useEffect(e,t)};on.useId=function(){return Ga.current.useId()};on.useImperativeHandle=function(e,t,n){return Ga.current.useImperativeHandle(e,t,n)};on.useInsertionEffect=function(e,t){return Ga.current.useInsertionEffect(e,t)};on.useLayoutEffect=function(e,t){return Ga.current.useLayoutEffect(e,t)};on.useMemo=function(e,t){return Ga.current.useMemo(e,t)};on.useReducer=function(e,t,n){return Ga.current.useReducer(e,t,n)};on.useRef=function(e){return Ga.current.useRef(e)};on.useState=function(e){return Ga.current.useState(e)};on.useSyncExternalStore=function(e,t,n){return Ga.current.useSyncExternalStore(e,t,n)};on.useTransition=function(){return Ga.current.useTransition()};on.version="18.2.0";(function(e){e.exports=on})(I);const Ni=ZA(I.exports),jp=AG({__proto__:null,default:Ni},[I.exports]);var GE={},ql={exports:{}},Bs={},WG={exports:{}},VG={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(V,Q){var X=V.length;V.push(Q);e:for(;0<X;){var Y=X-1>>>1,ce=V[Y];if(0<i(ce,Q))V[Y]=Q,V[X]=ce,X=Y;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var Q=V[0],X=V.pop();if(X!==Q){V[0]=X;e:for(var Y=0,ce=V.length,pe=ce>>>1;Y<pe;){var fe=2*(Y+1)-1,ye=V[fe],_e=fe+1,Ee=V[_e];if(0>i(ye,X))_e<ce&&0>i(Ee,ye)?(V[Y]=Ee,V[_e]=X,Y=_e):(V[Y]=ye,V[fe]=X,Y=fe);else if(_e<ce&&0>i(Ee,X))V[Y]=Ee,V[_e]=X,Y=_e;else break e}}return Q}function i(V,Q){var X=V.sortIndex-Q.sortIndex;return X!==0?X:V.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],u=[],c=1,d=null,p=3,h=!1,m=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(V){for(var Q=n(u);Q!==null;){if(Q.callback===null)r(u);else if(Q.startTime<=V)r(u),Q.sortIndex=Q.expirationTime,t(l,Q);else break;Q=n(u)}}function k(V){if(g=!1,_(V),!m)if(n(l)!==null)m=!0,J(C);else{var Q=n(u);Q!==null&&ee(k,Q.startTime-V)}}function C(V,Q){m=!1,g&&(g=!1,y(A),A=-1),h=!0;var X=p;try{for(_(Q),d=n(l);d!==null&&(!(d.expirationTime>Q)||V&&!F());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,p=d.priorityLevel;var ce=Y(d.expirationTime<=Q);Q=e.unstable_now(),typeof ce=="function"?d.callback=ce:d===n(l)&&r(l),_(Q)}else r(l);d=n(l)}if(d!==null)var pe=!0;else{var fe=n(u);fe!==null&&ee(k,fe.startTime-Q),pe=!1}return pe}finally{d=null,p=X,h=!1}}var $=!1,N=null,A=-1,D=5,O=-1;function F(){return!(e.unstable_now()-O<D)}function E(){if(N!==null){var V=e.unstable_now();O=V;var Q=!0;try{Q=N(!0,V)}finally{Q?z():($=!1,N=null)}}else $=!1}var z;if(typeof b=="function")z=function(){b(E)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,H=q.port2;q.port1.onmessage=E,z=function(){H.postMessage(null)}}else z=function(){v(E,0)};function J(V){N=V,$||($=!0,z())}function ee(V,Q){A=v(function(){V(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,J(C))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(V){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var X=p;p=Q;try{return V()}finally{p=X}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,Q){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var X=p;p=V;try{return Q()}finally{p=X}},e.unstable_scheduleCallback=function(V,Q,X){var Y=e.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Y+X:Y):X=Y,V){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=X+ce,V={id:c++,callback:Q,priorityLevel:V,startTime:X,expirationTime:ce,sortIndex:-1},X>Y?(V.sortIndex=X,t(u,V),n(l)===null&&V===n(u)&&(g?(y(A),A=-1):g=!0,ee(k,X-Y))):(V.sortIndex=ce,t(l,V),m||h||(m=!0,J(C))),V},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(V){var Q=p;return function(){var X=p;p=Q;try{return V.apply(this,arguments)}finally{p=X}}}})(VG);(function(e){e.exports=VG})(WG);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jG=I.exports,Rs=WG.exports;function De(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var UG=new Set,Ob={};function Sh(e,t){Ag(e,t),Ag(e+"Capture",t)}function Ag(e,t){for(Ob[e]=t,e=0;e<t.length;e++)UG.add(t[e])}var $u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qE=Object.prototype.hasOwnProperty,Nhe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$B={},TB={};function Ehe(e){return qE.call(TB,e)?!0:qE.call($B,e)?!1:Nhe.test(e)?TB[e]=!0:($B[e]=!0,!1)}function Ohe(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Phe(e,t,n,r){if(t===null||typeof t>"u"||Ohe(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function qa(e,t,n,r,i,a,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var Ji={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ji[e]=new qa(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ji[t]=new qa(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ji[e]=new qa(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ji[e]=new qa(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ji[e]=new qa(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ji[e]=new qa(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ji[e]=new qa(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ji[e]=new qa(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ji[e]=new qa(e,5,!1,e.toLowerCase(),null,!1,!1)});var eM=/[\-:]([a-z])/g;function tM(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(eM,tM);Ji[t]=new qa(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(eM,tM);Ji[t]=new qa(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(eM,tM);Ji[t]=new qa(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ji[e]=new qa(e,1,!1,e.toLowerCase(),null,!1,!1)});Ji.xlinkHref=new qa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ji[e]=new qa(e,1,!1,e.toLowerCase(),null,!0,!0)});function nM(e,t,n,r){var i=Ji.hasOwnProperty(t)?Ji[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Phe(t,n,i,r)&&(n=null),r||i===null?Ehe(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Fu=jG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vx=Symbol.for("react.element"),Km=Symbol.for("react.portal"),Zm=Symbol.for("react.fragment"),rM=Symbol.for("react.strict_mode"),KE=Symbol.for("react.profiler"),HG=Symbol.for("react.provider"),GG=Symbol.for("react.context"),iM=Symbol.for("react.forward_ref"),ZE=Symbol.for("react.suspense"),XE=Symbol.for("react.suspense_list"),aM=Symbol.for("react.memo"),vc=Symbol.for("react.lazy"),qG=Symbol.for("react.offscreen"),NB=Symbol.iterator;function x0(e){return e===null||typeof e!="object"?null:(e=NB&&e[NB]||e["@@iterator"],typeof e=="function"?e:null)}var Cr=Object.assign,XT;function q0(e){if(XT===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);XT=t&&t[1]||""}return`
`+XT+e}var JT=!1;function YT(e,t){if(!e||JT)return"";JT=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=r.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var l=`
`+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{JT=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?q0(e):""}function Ahe(e){switch(e.tag){case 5:return q0(e.type);case 16:return q0("Lazy");case 13:return q0("Suspense");case 19:return q0("SuspenseList");case 0:case 2:case 15:return e=YT(e.type,!1),e;case 11:return e=YT(e.type.render,!1),e;case 1:return e=YT(e.type,!0),e;default:return""}}function JE(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Zm:return"Fragment";case Km:return"Portal";case KE:return"Profiler";case rM:return"StrictMode";case ZE:return"Suspense";case XE:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case GG:return(e.displayName||"Context")+".Consumer";case HG:return(e._context.displayName||"Context")+".Provider";case iM:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case aM:return t=e.displayName||null,t!==null?t:JE(e.type)||"Memo";case vc:t=e._payload,e=e._init;try{return JE(e(t))}catch{}}return null}function Mhe(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return JE(t);case 8:return t===rM?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function td(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function KG(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Rhe(e){var t=KG(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,a.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bx(e){e._valueTracker||(e._valueTracker=Rhe(e))}function ZG(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=KG(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function kk(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function YE(e,t){var n=t.checked;return Cr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n!=null?n:e._wrapperState.initialChecked})}function EB(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=td(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function XG(e,t){t=t.checked,t!=null&&nM(e,"checked",t,!1)}function QE(e,t){XG(e,t);var n=td(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?eO(e,t.type,n):t.hasOwnProperty("defaultValue")&&eO(e,t.type,td(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function OB(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function eO(e,t,n){(t!=="number"||kk(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var K0=Array.isArray;function dg(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+td(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function tO(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(De(91));return Cr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function PB(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(De(92));if(K0(n)){if(1<n.length)throw Error(De(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:td(n)}}function JG(e,t){var n=td(t.value),r=td(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function AB(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function YG(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nO(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?YG(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var wx,QG=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(wx=wx||document.createElement("div"),wx.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=wx.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Pb(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var db={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dhe=["Webkit","ms","Moz","O"];Object.keys(db).forEach(function(e){Dhe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),db[t]=db[e]})});function e7(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||db.hasOwnProperty(e)&&db[e]?(""+t).trim():t+"px"}function t7(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=e7(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var Lhe=Cr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rO(e,t){if(t){if(Lhe[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(De(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(De(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(De(61))}if(t.style!=null&&typeof t.style!="object")throw Error(De(62))}}function iO(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var aO=null;function sM(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var sO=null,pg=null,hg=null;function MB(e){if(e=O1(e)){if(typeof sO!="function")throw Error(De(280));var t=e.stateNode;t&&(t=QI(t),sO(e.stateNode,e.type,t))}}function n7(e){pg?hg?hg.push(e):hg=[e]:pg=e}function r7(){if(pg){var e=pg,t=hg;if(hg=pg=null,MB(e),t)for(e=0;e<t.length;e++)MB(t[e])}}function i7(e,t){return e(t)}function a7(){}var QT=!1;function s7(e,t,n){if(QT)return e(t,n);QT=!0;try{return i7(e,t,n)}finally{QT=!1,(pg!==null||hg!==null)&&(a7(),r7())}}function Ab(e,t){var n=e.stateNode;if(n===null)return null;var r=QI(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(De(231,t,typeof n));return n}var oO=!1;if($u)try{var _0={};Object.defineProperty(_0,"passive",{get:function(){oO=!0}}),window.addEventListener("test",_0,_0),window.removeEventListener("test",_0,_0)}catch{oO=!1}function Fhe(e,t,n,r,i,a,s,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var pb=!1,Sk=null,Ck=!1,lO=null,zhe={onError:function(e){pb=!0,Sk=e}};function Bhe(e,t,n,r,i,a,s,o,l){pb=!1,Sk=null,Fhe.apply(zhe,arguments)}function Whe(e,t,n,r,i,a,s,o,l){if(Bhe.apply(this,arguments),pb){if(pb){var u=Sk;pb=!1,Sk=null}else throw Error(De(198));Ck||(Ck=!0,lO=u)}}function Ch(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function o7(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function RB(e){if(Ch(e)!==e)throw Error(De(188))}function Vhe(e){var t=e.alternate;if(!t){if(t=Ch(e),t===null)throw Error(De(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return RB(i),e;if(a===r)return RB(i),t;a=a.sibling}throw Error(De(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,o=i.child;o;){if(o===n){s=!0,n=i,r=a;break}if(o===r){s=!0,r=i,n=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===n){s=!0,n=a,r=i;break}if(o===r){s=!0,r=a,n=i;break}o=o.sibling}if(!s)throw Error(De(189))}}if(n.alternate!==r)throw Error(De(190))}if(n.tag!==3)throw Error(De(188));return n.stateNode.current===n?e:t}function l7(e){return e=Vhe(e),e!==null?u7(e):null}function u7(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=u7(e);if(t!==null)return t;e=e.sibling}return null}var c7=Rs.unstable_scheduleCallback,DB=Rs.unstable_cancelCallback,jhe=Rs.unstable_shouldYield,Uhe=Rs.unstable_requestPaint,Lr=Rs.unstable_now,Hhe=Rs.unstable_getCurrentPriorityLevel,oM=Rs.unstable_ImmediatePriority,d7=Rs.unstable_UserBlockingPriority,Ik=Rs.unstable_NormalPriority,Ghe=Rs.unstable_LowPriority,p7=Rs.unstable_IdlePriority,ZI=null,Ml=null;function qhe(e){if(Ml&&typeof Ml.onCommitFiberRoot=="function")try{Ml.onCommitFiberRoot(ZI,e,void 0,(e.current.flags&128)===128)}catch{}}var Lo=Math.clz32?Math.clz32:Xhe,Khe=Math.log,Zhe=Math.LN2;function Xhe(e){return e>>>=0,e===0?32:31-(Khe(e)/Zhe|0)|0}var xx=64,_x=4194304;function Z0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $k(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,s=n&268435455;if(s!==0){var o=s&~i;o!==0?r=Z0(o):(a&=s,a!==0&&(r=Z0(a)))}else s=n&~i,s!==0?r=Z0(s):a!==0&&(r=Z0(a));if(r===0)return 0;if(t!==0&&t!==r&&(t&i)===0&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if((r&4)!==0&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Lo(t),i=1<<n,r|=e[n],t&=~i;return r}function Jhe(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yhe(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-Lo(a),o=1<<s,l=i[s];l===-1?((o&n)===0||(o&r)!==0)&&(i[s]=Jhe(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function uO(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function h7(){var e=xx;return xx<<=1,(xx&4194240)===0&&(xx=64),e}function eN(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function N1(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Lo(t),e[t]=n}function Qhe(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Lo(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function lM(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Lo(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Bn=0;function f7(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var m7,uM,g7,y7,v7,cO=!1,kx=[],Fc=null,zc=null,Bc=null,Mb=new Map,Rb=new Map,Sc=[],efe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function LB(e,t){switch(e){case"focusin":case"focusout":Fc=null;break;case"dragenter":case"dragleave":zc=null;break;case"mouseover":case"mouseout":Bc=null;break;case"pointerover":case"pointerout":Mb.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rb.delete(t.pointerId)}}function k0(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=O1(t),t!==null&&uM(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function tfe(e,t,n,r,i){switch(t){case"focusin":return Fc=k0(Fc,e,t,n,r,i),!0;case"dragenter":return zc=k0(zc,e,t,n,r,i),!0;case"mouseover":return Bc=k0(Bc,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Mb.set(a,k0(Mb.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Rb.set(a,k0(Rb.get(a)||null,e,t,n,r,i)),!0}return!1}function b7(e){var t=bp(e.target);if(t!==null){var n=Ch(t);if(n!==null){if(t=n.tag,t===13){if(t=o7(n),t!==null){e.blockedOn=t,v7(e.priority,function(){g7(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function R_(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=dO(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);aO=r,n.target.dispatchEvent(r),aO=null}else return t=O1(n),t!==null&&uM(t),e.blockedOn=n,!1;t.shift()}return!0}function FB(e,t,n){R_(e)&&n.delete(t)}function nfe(){cO=!1,Fc!==null&&R_(Fc)&&(Fc=null),zc!==null&&R_(zc)&&(zc=null),Bc!==null&&R_(Bc)&&(Bc=null),Mb.forEach(FB),Rb.forEach(FB)}function S0(e,t){e.blockedOn===t&&(e.blockedOn=null,cO||(cO=!0,Rs.unstable_scheduleCallback(Rs.unstable_NormalPriority,nfe)))}function Db(e){function t(i){return S0(i,e)}if(0<kx.length){S0(kx[0],e);for(var n=1;n<kx.length;n++){var r=kx[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Fc!==null&&S0(Fc,e),zc!==null&&S0(zc,e),Bc!==null&&S0(Bc,e),Mb.forEach(t),Rb.forEach(t),n=0;n<Sc.length;n++)r=Sc[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Sc.length&&(n=Sc[0],n.blockedOn===null);)b7(n),n.blockedOn===null&&Sc.shift()}var fg=Fu.ReactCurrentBatchConfig,Tk=!0;function rfe(e,t,n,r){var i=Bn,a=fg.transition;fg.transition=null;try{Bn=1,cM(e,t,n,r)}finally{Bn=i,fg.transition=a}}function ife(e,t,n,r){var i=Bn,a=fg.transition;fg.transition=null;try{Bn=4,cM(e,t,n,r)}finally{Bn=i,fg.transition=a}}function cM(e,t,n,r){if(Tk){var i=dO(e,t,n,r);if(i===null)cN(e,t,r,Nk,n),LB(e,r);else if(tfe(i,e,t,n,r))r.stopPropagation();else if(LB(e,r),t&4&&-1<efe.indexOf(e)){for(;i!==null;){var a=O1(i);if(a!==null&&m7(a),a=dO(e,t,n,r),a===null&&cN(e,t,r,Nk,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else cN(e,t,r,null,n)}}var Nk=null;function dO(e,t,n,r){if(Nk=null,e=sM(r),e=bp(e),e!==null)if(t=Ch(e),t===null)e=null;else if(n=t.tag,n===13){if(e=o7(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Nk=e,null}function w7(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hhe()){case oM:return 1;case d7:return 4;case Ik:case Ghe:return 16;case p7:return 536870912;default:return 16}default:return 16}}var Tc=null,dM=null,D_=null;function x7(){if(D_)return D_;var e,t=dM,n=t.length,r,i="value"in Tc?Tc.value:Tc.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===i[a-r];r++);return D_=i.slice(e,1<r?1-r:void 0)}function L_(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Sx(){return!0}function zB(){return!1}function Ws(e){function t(n,r,i,a,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Sx:zB,this.isPropagationStopped=zB,this}return Cr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sx)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sx)},persist:function(){},isPersistent:Sx}),t}var Sy={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pM=Ws(Sy),E1=Cr({},Sy,{view:0,detail:0}),afe=Ws(E1),tN,nN,C0,XI=Cr({},E1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hM,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==C0&&(C0&&e.type==="mousemove"?(tN=e.screenX-C0.screenX,nN=e.screenY-C0.screenY):nN=tN=0,C0=e),tN)},movementY:function(e){return"movementY"in e?e.movementY:nN}}),BB=Ws(XI),sfe=Cr({},XI,{dataTransfer:0}),ofe=Ws(sfe),lfe=Cr({},E1,{relatedTarget:0}),rN=Ws(lfe),ufe=Cr({},Sy,{animationName:0,elapsedTime:0,pseudoElement:0}),cfe=Ws(ufe),dfe=Cr({},Sy,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pfe=Ws(dfe),hfe=Cr({},Sy,{data:0}),WB=Ws(hfe),ffe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mfe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gfe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yfe(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=gfe[e])?!!t[e]:!1}function hM(){return yfe}var vfe=Cr({},E1,{key:function(e){if(e.key){var t=ffe[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=L_(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?mfe[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hM,charCode:function(e){return e.type==="keypress"?L_(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?L_(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),bfe=Ws(vfe),wfe=Cr({},XI,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),VB=Ws(wfe),xfe=Cr({},E1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hM}),_fe=Ws(xfe),kfe=Cr({},Sy,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sfe=Ws(kfe),Cfe=Cr({},XI,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ife=Ws(Cfe),$fe=[9,13,27,32],fM=$u&&"CompositionEvent"in window,hb=null;$u&&"documentMode"in document&&(hb=document.documentMode);var Tfe=$u&&"TextEvent"in window&&!hb,_7=$u&&(!fM||hb&&8<hb&&11>=hb),jB=String.fromCharCode(32),UB=!1;function k7(e,t){switch(e){case"keyup":return $fe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function S7(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xm=!1;function Nfe(e,t){switch(e){case"compositionend":return S7(t);case"keypress":return t.which!==32?null:(UB=!0,jB);case"textInput":return e=t.data,e===jB&&UB?null:e;default:return null}}function Efe(e,t){if(Xm)return e==="compositionend"||!fM&&k7(e,t)?(e=x7(),D_=dM=Tc=null,Xm=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _7&&t.locale!=="ko"?null:t.data;default:return null}}var Ofe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function HB(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ofe[e.type]:t==="textarea"}function C7(e,t,n,r){n7(r),t=Ek(t,"onChange"),0<t.length&&(n=new pM("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var fb=null,Lb=null;function Pfe(e){D7(e,0)}function JI(e){var t=Qm(e);if(ZG(t))return e}function Afe(e,t){if(e==="change")return t}var I7=!1;if($u){var iN;if($u){var aN="oninput"in document;if(!aN){var GB=document.createElement("div");GB.setAttribute("oninput","return;"),aN=typeof GB.oninput=="function"}iN=aN}else iN=!1;I7=iN&&(!document.documentMode||9<document.documentMode)}function qB(){fb&&(fb.detachEvent("onpropertychange",$7),Lb=fb=null)}function $7(e){if(e.propertyName==="value"&&JI(Lb)){var t=[];C7(t,Lb,e,sM(e)),s7(Pfe,t)}}function Mfe(e,t,n){e==="focusin"?(qB(),fb=t,Lb=n,fb.attachEvent("onpropertychange",$7)):e==="focusout"&&qB()}function Rfe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return JI(Lb)}function Dfe(e,t){if(e==="click")return JI(t)}function Lfe(e,t){if(e==="input"||e==="change")return JI(t)}function Ffe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ho=typeof Object.is=="function"?Object.is:Ffe;function Fb(e,t){if(Ho(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!qE.call(t,i)||!Ho(e[i],t[i]))return!1}return!0}function KB(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ZB(e,t){var n=KB(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=KB(n)}}function T7(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?T7(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function N7(){for(var e=window,t=kk();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=kk(e.document)}return t}function mM(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function zfe(e){var t=N7(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&T7(n.ownerDocument.documentElement,n)){if(r!==null&&mM(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=ZB(n,a);var s=ZB(n,r);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Bfe=$u&&"documentMode"in document&&11>=document.documentMode,Jm=null,pO=null,mb=null,hO=!1;function XB(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;hO||Jm==null||Jm!==kk(r)||(r=Jm,"selectionStart"in r&&mM(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),mb&&Fb(mb,r)||(mb=r,r=Ek(pO,"onSelect"),0<r.length&&(t=new pM("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Jm)))}function Cx(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ym={animationend:Cx("Animation","AnimationEnd"),animationiteration:Cx("Animation","AnimationIteration"),animationstart:Cx("Animation","AnimationStart"),transitionend:Cx("Transition","TransitionEnd")},sN={},E7={};$u&&(E7=document.createElement("div").style,"AnimationEvent"in window||(delete Ym.animationend.animation,delete Ym.animationiteration.animation,delete Ym.animationstart.animation),"TransitionEvent"in window||delete Ym.transitionend.transition);function YI(e){if(sN[e])return sN[e];if(!Ym[e])return e;var t=Ym[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in E7)return sN[e]=t[n];return e}var O7=YI("animationend"),P7=YI("animationiteration"),A7=YI("animationstart"),M7=YI("transitionend"),R7=new Map,JB="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xd(e,t){R7.set(e,t),Sh(t,[e])}for(var oN=0;oN<JB.length;oN++){var lN=JB[oN],Wfe=lN.toLowerCase(),Vfe=lN[0].toUpperCase()+lN.slice(1);xd(Wfe,"on"+Vfe)}xd(O7,"onAnimationEnd");xd(P7,"onAnimationIteration");xd(A7,"onAnimationStart");xd("dblclick","onDoubleClick");xd("focusin","onFocus");xd("focusout","onBlur");xd(M7,"onTransitionEnd");Ag("onMouseEnter",["mouseout","mouseover"]);Ag("onMouseLeave",["mouseout","mouseover"]);Ag("onPointerEnter",["pointerout","pointerover"]);Ag("onPointerLeave",["pointerout","pointerover"]);Sh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var X0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jfe=new Set("cancel close invalid load scroll toggle".split(" ").concat(X0));function YB(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Whe(r,t,void 0,e),e.currentTarget=null}function D7(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;YB(i,o,u),a=l}else for(s=0;s<r.length;s++){if(o=r[s],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;YB(i,o,u),a=l}}}if(Ck)throw e=lO,Ck=!1,lO=null,e}function cr(e,t){var n=t[vO];n===void 0&&(n=t[vO]=new Set);var r=e+"__bubble";n.has(r)||(L7(t,e,2,!1),n.add(r))}function uN(e,t,n){var r=0;t&&(r|=4),L7(n,e,r,t)}var Ix="_reactListening"+Math.random().toString(36).slice(2);function zb(e){if(!e[Ix]){e[Ix]=!0,UG.forEach(function(n){n!=="selectionchange"&&(jfe.has(n)||uN(n,!1,e),uN(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ix]||(t[Ix]=!0,uN("selectionchange",!1,t))}}function L7(e,t,n,r){switch(w7(t)){case 1:var i=rfe;break;case 4:i=ife;break;default:i=cM}n=i.bind(null,t,n,e),i=void 0,!oO||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function cN(e,t,n,r,i){var a=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;o!==null;){if(s=bp(o),s===null)return;if(l=s.tag,l===5||l===6){r=a=s;continue e}o=o.parentNode}}r=r.return}s7(function(){var u=a,c=sM(n),d=[];e:{var p=R7.get(e);if(p!==void 0){var h=pM,m=e;switch(e){case"keypress":if(L_(n)===0)break e;case"keydown":case"keyup":h=bfe;break;case"focusin":m="focus",h=rN;break;case"focusout":m="blur",h=rN;break;case"beforeblur":case"afterblur":h=rN;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=BB;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=ofe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=_fe;break;case O7:case P7:case A7:h=cfe;break;case M7:h=Sfe;break;case"scroll":h=afe;break;case"wheel":h=Ife;break;case"copy":case"cut":case"paste":h=pfe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=VB}var g=(t&4)!==0,v=!g&&e==="scroll",y=g?p!==null?p+"Capture":null:p;g=[];for(var b=u,_;b!==null;){_=b;var k=_.stateNode;if(_.tag===5&&k!==null&&(_=k,y!==null&&(k=Ab(b,y),k!=null&&g.push(Bb(b,k,_)))),v)break;b=b.return}0<g.length&&(p=new h(p,m,null,n,c),d.push({event:p,listeners:g}))}}if((t&7)===0){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&n!==aO&&(m=n.relatedTarget||n.fromElement)&&(bp(m)||m[Tu]))break e;if((h||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=u,m=m?bp(m):null,m!==null&&(v=Ch(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(g=BB,k="onMouseLeave",y="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(g=VB,k="onPointerLeave",y="onPointerEnter",b="pointer"),v=h==null?p:Qm(h),_=m==null?p:Qm(m),p=new g(k,b+"leave",h,n,c),p.target=v,p.relatedTarget=_,k=null,bp(c)===u&&(g=new g(y,b+"enter",m,n,c),g.target=_,g.relatedTarget=v,k=g),v=k,h&&m)t:{for(g=h,y=m,b=0,_=g;_;_=$m(_))b++;for(_=0,k=y;k;k=$m(k))_++;for(;0<b-_;)g=$m(g),b--;for(;0<_-b;)y=$m(y),_--;for(;b--;){if(g===y||y!==null&&g===y.alternate)break t;g=$m(g),y=$m(y)}g=null}else g=null;h!==null&&QB(d,p,h,g,!1),m!==null&&v!==null&&QB(d,v,m,g,!0)}}e:{if(p=u?Qm(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var C=Afe;else if(HB(p))if(I7)C=Lfe;else{C=Rfe;var $=Mfe}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=Dfe);if(C&&(C=C(e,u))){C7(d,C,n,c);break e}$&&$(e,p,u),e==="focusout"&&($=p._wrapperState)&&$.controlled&&p.type==="number"&&eO(p,"number",p.value)}switch($=u?Qm(u):window,e){case"focusin":(HB($)||$.contentEditable==="true")&&(Jm=$,pO=u,mb=null);break;case"focusout":mb=pO=Jm=null;break;case"mousedown":hO=!0;break;case"contextmenu":case"mouseup":case"dragend":hO=!1,XB(d,n,c);break;case"selectionchange":if(Bfe)break;case"keydown":case"keyup":XB(d,n,c)}var N;if(fM)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Xm?k7(e,n)&&(A="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(_7&&n.locale!=="ko"&&(Xm||A!=="onCompositionStart"?A==="onCompositionEnd"&&Xm&&(N=x7()):(Tc=c,dM="value"in Tc?Tc.value:Tc.textContent,Xm=!0)),$=Ek(u,A),0<$.length&&(A=new WB(A,e,null,n,c),d.push({event:A,listeners:$}),N?A.data=N:(N=S7(n),N!==null&&(A.data=N)))),(N=Tfe?Nfe(e,n):Efe(e,n))&&(u=Ek(u,"onBeforeInput"),0<u.length&&(c=new WB("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=N))}D7(d,t)})}function Bb(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ek(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Ab(e,n),a!=null&&r.unshift(Bb(e,a,i)),a=Ab(e,t),a!=null&&r.push(Bb(e,a,i))),e=e.return}return r}function $m(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function QB(e,t,n,r,i){for(var a=t._reactName,s=[];n!==null&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,i?(l=Ab(n,a),l!=null&&s.unshift(Bb(n,l,o))):i||(l=Ab(n,a),l!=null&&s.push(Bb(n,l,o)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var Ufe=/\r\n?/g,Hfe=/\u0000|\uFFFD/g;function e4(e){return(typeof e=="string"?e:""+e).replace(Ufe,`
`).replace(Hfe,"")}function $x(e,t,n){if(t=e4(t),e4(e)!==t&&n)throw Error(De(425))}function Ok(){}var fO=null,mO=null;function gO(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var yO=typeof setTimeout=="function"?setTimeout:void 0,Gfe=typeof clearTimeout=="function"?clearTimeout:void 0,t4=typeof Promise=="function"?Promise:void 0,qfe=typeof queueMicrotask=="function"?queueMicrotask:typeof t4<"u"?function(e){return t4.resolve(null).then(e).catch(Kfe)}:yO;function Kfe(e){setTimeout(function(){throw e})}function dN(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Db(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Db(t)}function Wc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function n4(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Cy=Math.random().toString(36).slice(2),Il="__reactFiber$"+Cy,Wb="__reactProps$"+Cy,Tu="__reactContainer$"+Cy,vO="__reactEvents$"+Cy,Zfe="__reactListeners$"+Cy,Xfe="__reactHandles$"+Cy;function bp(e){var t=e[Il];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Tu]||n[Il]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=n4(e);e!==null;){if(n=e[Il])return n;e=n4(e)}return t}e=n,n=e.parentNode}return null}function O1(e){return e=e[Il]||e[Tu],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Qm(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(De(33))}function QI(e){return e[Wb]||null}var bO=[],eg=-1;function _d(e){return{current:e}}function pr(e){0>eg||(e.current=bO[eg],bO[eg]=null,eg--)}function ir(e,t){eg++,bO[eg]=e.current,e.current=t}var nd={},ma=_d(nd),ls=_d(!1),Up=nd;function Mg(e,t){var n=e.type.contextTypes;if(!n)return nd;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function us(e){return e=e.childContextTypes,e!=null}function Pk(){pr(ls),pr(ma)}function r4(e,t,n){if(ma.current!==nd)throw Error(De(168));ir(ma,t),ir(ls,n)}function F7(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(De(108,Mhe(e)||"Unknown",i));return Cr({},n,r)}function Ak(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||nd,Up=ma.current,ir(ma,e),ir(ls,ls.current),!0}function i4(e,t,n){var r=e.stateNode;if(!r)throw Error(De(169));n?(e=F7(e,t,Up),r.__reactInternalMemoizedMergedChildContext=e,pr(ls),pr(ma),ir(ma,e)):pr(ls),ir(ls,n)}var hu=null,e2=!1,pN=!1;function z7(e){hu===null?hu=[e]:hu.push(e)}function Jfe(e){e2=!0,z7(e)}function kd(){if(!pN&&hu!==null){pN=!0;var e=0,t=Bn;try{var n=hu;for(Bn=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}hu=null,e2=!1}catch(i){throw hu!==null&&(hu=hu.slice(e+1)),c7(oM,kd),i}finally{Bn=t,pN=!1}}return null}var tg=[],ng=0,Mk=null,Rk=0,to=[],no=0,Hp=null,bu=1,wu="";function ap(e,t){tg[ng++]=Rk,tg[ng++]=Mk,Mk=e,Rk=t}function B7(e,t,n){to[no++]=bu,to[no++]=wu,to[no++]=Hp,Hp=e;var r=bu;e=wu;var i=32-Lo(r)-1;r&=~(1<<i),n+=1;var a=32-Lo(t)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,bu=1<<32-Lo(t)+i|n<<i|r,wu=a+e}else bu=1<<a|n<<i|r,wu=e}function gM(e){e.return!==null&&(ap(e,1),B7(e,1,0))}function yM(e){for(;e===Mk;)Mk=tg[--ng],tg[ng]=null,Rk=tg[--ng],tg[ng]=null;for(;e===Hp;)Hp=to[--no],to[no]=null,wu=to[--no],to[no]=null,bu=to[--no],to[no]=null}var Os=null,Is=null,yr=!1,Ao=null;function W7(e,t){var n=ro(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function a4(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Os=e,Is=Wc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Os=e,Is=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Hp!==null?{id:bu,overflow:wu}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=ro(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Os=e,Is=null,!0):!1;default:return!1}}function wO(e){return(e.mode&1)!==0&&(e.flags&128)===0}function xO(e){if(yr){var t=Is;if(t){var n=t;if(!a4(e,t)){if(wO(e))throw Error(De(418));t=Wc(n.nextSibling);var r=Os;t&&a4(e,t)?W7(r,n):(e.flags=e.flags&-4097|2,yr=!1,Os=e)}}else{if(wO(e))throw Error(De(418));e.flags=e.flags&-4097|2,yr=!1,Os=e}}}function s4(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Os=e}function Tx(e){if(e!==Os)return!1;if(!yr)return s4(e),yr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!gO(e.type,e.memoizedProps)),t&&(t=Is)){if(wO(e))throw V7(),Error(De(418));for(;t;)W7(e,t),t=Wc(t.nextSibling)}if(s4(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(De(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Is=Wc(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Is=null}}else Is=Os?Wc(e.stateNode.nextSibling):null;return!0}function V7(){for(var e=Is;e;)e=Wc(e.nextSibling)}function Rg(){Is=Os=null,yr=!1}function vM(e){Ao===null?Ao=[e]:Ao.push(e)}var Yfe=Fu.ReactCurrentBatchConfig;function Oo(e,t){if(e&&e.defaultProps){t=Cr({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}var Dk=_d(null),Lk=null,rg=null,bM=null;function wM(){bM=rg=Lk=null}function xM(e){var t=Dk.current;pr(Dk),e._currentValue=t}function _O(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function mg(e,t){Lk=e,bM=rg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(as=!0),e.firstContext=null)}function co(e){var t=e._currentValue;if(bM!==e)if(e={context:e,memoizedValue:t,next:null},rg===null){if(Lk===null)throw Error(De(308));rg=e,Lk.dependencies={lanes:0,firstContext:e}}else rg=rg.next=e;return t}var wp=null;function _M(e){wp===null?wp=[e]:wp.push(e)}function j7(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,_M(t)):(n.next=i.next,i.next=n),t.interleaved=n,Nu(e,r)}function Nu(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var bc=!1;function kM(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function U7(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xu(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Vc(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(mn&2)!==0){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Nu(e,n)}return i=r.interleaved,i===null?(t.next=t,_M(r)):(t.next=i.next,i.next=t),r.interleaved=t,Nu(e,n)}function F_(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,lM(e,n)}}function o4(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=s:a=a.next=s,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fk(e,t,n,r){var i=e.updateQueue;bc=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,s===null?a=u:s.next=u,s=l;var c=e.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==s&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(a!==null){var d=i.baseState;s=0,c=u=l=null,o=a;do{var p=o.lane,h=o.eventTime;if((r&p)===p){c!==null&&(c=c.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,g=o;switch(p=t,h=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){d=m.call(h,d,p);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,p=typeof m=="function"?m.call(h,d,p):m,p==null)break e;d=Cr({},d,p);break e;case 2:bc=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=h,l=d):c=c.next=h,s|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(1);if(c===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);qp|=s,e.lanes=s,e.memoizedState=d}}function l4(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(De(191,i));i.call(r)}}}var H7=new jG.Component().refs;function kO(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Cr({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var t2={isMounted:function(e){return(e=e._reactInternals)?Ch(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ra(),i=Uc(e),a=xu(r,i);a.payload=t,n!=null&&(a.callback=n),t=Vc(e,a,i),t!==null&&(Fo(t,e,i,r),F_(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ra(),i=Uc(e),a=xu(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=Vc(e,a,i),t!==null&&(Fo(t,e,i,r),F_(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ra(),r=Uc(e),i=xu(n,r);i.tag=2,t!=null&&(i.callback=t),t=Vc(e,i,r),t!==null&&(Fo(t,e,r,n),F_(t,e,r))}};function u4(e,t,n,r,i,a,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,s):t.prototype&&t.prototype.isPureReactComponent?!Fb(n,r)||!Fb(i,a):!0}function G7(e,t,n){var r=!1,i=nd,a=t.contextType;return typeof a=="object"&&a!==null?a=co(a):(i=us(t)?Up:ma.current,r=t.contextTypes,a=(r=r!=null)?Mg(e,i):nd),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=t2,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function c4(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&t2.enqueueReplaceState(t,t.state,null)}function SO(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=H7,kM(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=co(a):(a=us(t)?Up:ma.current,i.context=Mg(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(kO(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&t2.enqueueReplaceState(i,i.state,null),Fk(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function I0(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(De(309));var r=n.stateNode}if(!r)throw Error(De(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(s){var o=i.refs;o===H7&&(o=i.refs={}),s===null?delete o[a]:o[a]=s},t._stringRef=a,t)}if(typeof e!="string")throw Error(De(284));if(!n._owner)throw Error(De(290,e))}return e}function Nx(e,t){throw e=Object.prototype.toString.call(t),Error(De(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function d4(e){var t=e._init;return t(e._payload)}function q7(e){function t(y,b){if(e){var _=y.deletions;_===null?(y.deletions=[b],y.flags|=16):_.push(b)}}function n(y,b){if(!e)return null;for(;b!==null;)t(y,b),b=b.sibling;return null}function r(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function i(y,b){return y=Hc(y,b),y.index=0,y.sibling=null,y}function a(y,b,_){return y.index=_,e?(_=y.alternate,_!==null?(_=_.index,_<b?(y.flags|=2,b):_):(y.flags|=2,b)):(y.flags|=1048576,b)}function s(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,b,_,k){return b===null||b.tag!==6?(b=bN(_,y.mode,k),b.return=y,b):(b=i(b,_),b.return=y,b)}function l(y,b,_,k){var C=_.type;return C===Zm?c(y,b,_.props.children,k,_.key):b!==null&&(b.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===vc&&d4(C)===b.type)?(k=i(b,_.props),k.ref=I0(y,b,_),k.return=y,k):(k=U_(_.type,_.key,_.props,null,y.mode,k),k.ref=I0(y,b,_),k.return=y,k)}function u(y,b,_,k){return b===null||b.tag!==4||b.stateNode.containerInfo!==_.containerInfo||b.stateNode.implementation!==_.implementation?(b=wN(_,y.mode,k),b.return=y,b):(b=i(b,_.children||[]),b.return=y,b)}function c(y,b,_,k,C){return b===null||b.tag!==7?(b=Ep(_,y.mode,k,C),b.return=y,b):(b=i(b,_),b.return=y,b)}function d(y,b,_){if(typeof b=="string"&&b!==""||typeof b=="number")return b=bN(""+b,y.mode,_),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case vx:return _=U_(b.type,b.key,b.props,null,y.mode,_),_.ref=I0(y,null,b),_.return=y,_;case Km:return b=wN(b,y.mode,_),b.return=y,b;case vc:var k=b._init;return d(y,k(b._payload),_)}if(K0(b)||x0(b))return b=Ep(b,y.mode,_,null),b.return=y,b;Nx(y,b)}return null}function p(y,b,_,k){var C=b!==null?b.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return C!==null?null:o(y,b,""+_,k);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case vx:return _.key===C?l(y,b,_,k):null;case Km:return _.key===C?u(y,b,_,k):null;case vc:return C=_._init,p(y,b,C(_._payload),k)}if(K0(_)||x0(_))return C!==null?null:c(y,b,_,k,null);Nx(y,_)}return null}function h(y,b,_,k,C){if(typeof k=="string"&&k!==""||typeof k=="number")return y=y.get(_)||null,o(b,y,""+k,C);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case vx:return y=y.get(k.key===null?_:k.key)||null,l(b,y,k,C);case Km:return y=y.get(k.key===null?_:k.key)||null,u(b,y,k,C);case vc:var $=k._init;return h(y,b,_,$(k._payload),C)}if(K0(k)||x0(k))return y=y.get(_)||null,c(b,y,k,C,null);Nx(b,k)}return null}function m(y,b,_,k){for(var C=null,$=null,N=b,A=b=0,D=null;N!==null&&A<_.length;A++){N.index>A?(D=N,N=null):D=N.sibling;var O=p(y,N,_[A],k);if(O===null){N===null&&(N=D);break}e&&N&&O.alternate===null&&t(y,N),b=a(O,b,A),$===null?C=O:$.sibling=O,$=O,N=D}if(A===_.length)return n(y,N),yr&&ap(y,A),C;if(N===null){for(;A<_.length;A++)N=d(y,_[A],k),N!==null&&(b=a(N,b,A),$===null?C=N:$.sibling=N,$=N);return yr&&ap(y,A),C}for(N=r(y,N);A<_.length;A++)D=h(N,y,A,_[A],k),D!==null&&(e&&D.alternate!==null&&N.delete(D.key===null?A:D.key),b=a(D,b,A),$===null?C=D:$.sibling=D,$=D);return e&&N.forEach(function(F){return t(y,F)}),yr&&ap(y,A),C}function g(y,b,_,k){var C=x0(_);if(typeof C!="function")throw Error(De(150));if(_=C.call(_),_==null)throw Error(De(151));for(var $=C=null,N=b,A=b=0,D=null,O=_.next();N!==null&&!O.done;A++,O=_.next()){N.index>A?(D=N,N=null):D=N.sibling;var F=p(y,N,O.value,k);if(F===null){N===null&&(N=D);break}e&&N&&F.alternate===null&&t(y,N),b=a(F,b,A),$===null?C=F:$.sibling=F,$=F,N=D}if(O.done)return n(y,N),yr&&ap(y,A),C;if(N===null){for(;!O.done;A++,O=_.next())O=d(y,O.value,k),O!==null&&(b=a(O,b,A),$===null?C=O:$.sibling=O,$=O);return yr&&ap(y,A),C}for(N=r(y,N);!O.done;A++,O=_.next())O=h(N,y,A,O.value,k),O!==null&&(e&&O.alternate!==null&&N.delete(O.key===null?A:O.key),b=a(O,b,A),$===null?C=O:$.sibling=O,$=O);return e&&N.forEach(function(E){return t(y,E)}),yr&&ap(y,A),C}function v(y,b,_,k){if(typeof _=="object"&&_!==null&&_.type===Zm&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case vx:e:{for(var C=_.key,$=b;$!==null;){if($.key===C){if(C=_.type,C===Zm){if($.tag===7){n(y,$.sibling),b=i($,_.props.children),b.return=y,y=b;break e}}else if($.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===vc&&d4(C)===$.type){n(y,$.sibling),b=i($,_.props),b.ref=I0(y,$,_),b.return=y,y=b;break e}n(y,$);break}else t(y,$);$=$.sibling}_.type===Zm?(b=Ep(_.props.children,y.mode,k,_.key),b.return=y,y=b):(k=U_(_.type,_.key,_.props,null,y.mode,k),k.ref=I0(y,b,_),k.return=y,y=k)}return s(y);case Km:e:{for($=_.key;b!==null;){if(b.key===$)if(b.tag===4&&b.stateNode.containerInfo===_.containerInfo&&b.stateNode.implementation===_.implementation){n(y,b.sibling),b=i(b,_.children||[]),b.return=y,y=b;break e}else{n(y,b);break}else t(y,b);b=b.sibling}b=wN(_,y.mode,k),b.return=y,y=b}return s(y);case vc:return $=_._init,v(y,b,$(_._payload),k)}if(K0(_))return m(y,b,_,k);if(x0(_))return g(y,b,_,k);Nx(y,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,b!==null&&b.tag===6?(n(y,b.sibling),b=i(b,_),b.return=y,y=b):(n(y,b),b=bN(_,y.mode,k),b.return=y,y=b),s(y)):n(y,b)}return v}var Dg=q7(!0),K7=q7(!1),P1={},Rl=_d(P1),Vb=_d(P1),jb=_d(P1);function xp(e){if(e===P1)throw Error(De(174));return e}function SM(e,t){switch(ir(jb,t),ir(Vb,e),ir(Rl,P1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:nO(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=nO(t,e)}pr(Rl),ir(Rl,t)}function Lg(){pr(Rl),pr(Vb),pr(jb)}function Z7(e){xp(jb.current);var t=xp(Rl.current),n=nO(t,e.type);t!==n&&(ir(Vb,e),ir(Rl,n))}function CM(e){Vb.current===e&&(pr(Rl),pr(Vb))}var kr=_d(0);function zk(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var hN=[];function IM(){for(var e=0;e<hN.length;e++)hN[e]._workInProgressVersionPrimary=null;hN.length=0}var z_=Fu.ReactCurrentDispatcher,fN=Fu.ReactCurrentBatchConfig,Gp=0,Sr=null,li=null,ki=null,Bk=!1,gb=!1,Ub=0,Qfe=0;function aa(){throw Error(De(321))}function $M(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ho(e[n],t[n]))return!1;return!0}function TM(e,t,n,r,i,a){if(Gp=a,Sr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,z_.current=e===null||e.memoizedState===null?rme:ime,e=n(r,i),gb){a=0;do{if(gb=!1,Ub=0,25<=a)throw Error(De(301));a+=1,ki=li=null,t.updateQueue=null,z_.current=ame,e=n(r,i)}while(gb)}if(z_.current=Wk,t=li!==null&&li.next!==null,Gp=0,ki=li=Sr=null,Bk=!1,t)throw Error(De(300));return e}function NM(){var e=Ub!==0;return Ub=0,e}function gl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ki===null?Sr.memoizedState=ki=e:ki=ki.next=e,ki}function po(){if(li===null){var e=Sr.alternate;e=e!==null?e.memoizedState:null}else e=li.next;var t=ki===null?Sr.memoizedState:ki.next;if(t!==null)ki=t,li=e;else{if(e===null)throw Error(De(310));li=e,e={memoizedState:li.memoizedState,baseState:li.baseState,baseQueue:li.baseQueue,queue:li.queue,next:null},ki===null?Sr.memoizedState=ki=e:ki=ki.next=e}return ki}function Hb(e,t){return typeof t=="function"?t(e):t}function mN(e){var t=po(),n=t.queue;if(n===null)throw Error(De(311));n.lastRenderedReducer=e;var r=li,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var o=s=null,l=null,u=a;do{var c=u.lane;if((Gp&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,s=r):l=l.next=d,Sr.lanes|=c,qp|=c}u=u.next}while(u!==null&&u!==a);l===null?s=r:l.next=o,Ho(r,t.memoizedState)||(as=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,Sr.lanes|=a,qp|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function gN(e){var t=po(),n=t.queue;if(n===null)throw Error(De(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do a=e(a,s.action),s=s.next;while(s!==i);Ho(a,t.memoizedState)||(as=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function X7(){}function J7(e,t){var n=Sr,r=po(),i=t(),a=!Ho(r.memoizedState,i);if(a&&(r.memoizedState=i,as=!0),r=r.queue,EM(e9.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||ki!==null&&ki.memoizedState.tag&1){if(n.flags|=2048,Gb(9,Q7.bind(null,n,r,i,t),void 0,null),Ei===null)throw Error(De(349));(Gp&30)!==0||Y7(n,t,i)}return i}function Y7(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Sr.updateQueue,t===null?(t={lastEffect:null,stores:null},Sr.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Q7(e,t,n,r){t.value=n,t.getSnapshot=r,t9(t)&&n9(e)}function e9(e,t,n){return n(function(){t9(t)&&n9(e)})}function t9(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ho(e,n)}catch{return!0}}function n9(e){var t=Nu(e,1);t!==null&&Fo(t,e,1,-1)}function p4(e){var t=gl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hb,lastRenderedState:e},t.queue=e,e=e.dispatch=nme.bind(null,Sr,e),[t.memoizedState,e]}function Gb(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Sr.updateQueue,t===null?(t={lastEffect:null,stores:null},Sr.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function r9(){return po().memoizedState}function B_(e,t,n,r){var i=gl();Sr.flags|=e,i.memoizedState=Gb(1|t,n,void 0,r===void 0?null:r)}function n2(e,t,n,r){var i=po();r=r===void 0?null:r;var a=void 0;if(li!==null){var s=li.memoizedState;if(a=s.destroy,r!==null&&$M(r,s.deps)){i.memoizedState=Gb(t,n,a,r);return}}Sr.flags|=e,i.memoizedState=Gb(1|t,n,a,r)}function h4(e,t){return B_(8390656,8,e,t)}function EM(e,t){return n2(2048,8,e,t)}function i9(e,t){return n2(4,2,e,t)}function a9(e,t){return n2(4,4,e,t)}function s9(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function o9(e,t,n){return n=n!=null?n.concat([e]):null,n2(4,4,s9.bind(null,t,e),n)}function OM(){}function l9(e,t){var n=po();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&$M(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function u9(e,t){var n=po();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&$M(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function c9(e,t,n){return(Gp&21)===0?(e.baseState&&(e.baseState=!1,as=!0),e.memoizedState=n):(Ho(n,t)||(n=h7(),Sr.lanes|=n,qp|=n,e.baseState=!0),t)}function eme(e,t){var n=Bn;Bn=n!==0&&4>n?n:4,e(!0);var r=fN.transition;fN.transition={};try{e(!1),t()}finally{Bn=n,fN.transition=r}}function d9(){return po().memoizedState}function tme(e,t,n){var r=Uc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},p9(e))h9(t,n);else if(n=j7(e,t,n,r),n!==null){var i=Ra();Fo(n,e,r,i),f9(n,t,r)}}function nme(e,t,n){var r=Uc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(p9(e))h9(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var s=t.lastRenderedState,o=a(s,n);if(i.hasEagerState=!0,i.eagerState=o,Ho(o,s)){var l=t.interleaved;l===null?(i.next=i,_M(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}n=j7(e,t,i,r),n!==null&&(i=Ra(),Fo(n,e,r,i),f9(n,t,r))}}function p9(e){var t=e.alternate;return e===Sr||t!==null&&t===Sr}function h9(e,t){gb=Bk=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function f9(e,t,n){if((n&4194240)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,lM(e,n)}}var Wk={readContext:co,useCallback:aa,useContext:aa,useEffect:aa,useImperativeHandle:aa,useInsertionEffect:aa,useLayoutEffect:aa,useMemo:aa,useReducer:aa,useRef:aa,useState:aa,useDebugValue:aa,useDeferredValue:aa,useTransition:aa,useMutableSource:aa,useSyncExternalStore:aa,useId:aa,unstable_isNewReconciler:!1},rme={readContext:co,useCallback:function(e,t){return gl().memoizedState=[e,t===void 0?null:t],e},useContext:co,useEffect:h4,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,B_(4194308,4,s9.bind(null,t,e),n)},useLayoutEffect:function(e,t){return B_(4194308,4,e,t)},useInsertionEffect:function(e,t){return B_(4,2,e,t)},useMemo:function(e,t){var n=gl();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=gl();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=tme.bind(null,Sr,e),[r.memoizedState,e]},useRef:function(e){var t=gl();return e={current:e},t.memoizedState=e},useState:p4,useDebugValue:OM,useDeferredValue:function(e){return gl().memoizedState=e},useTransition:function(){var e=p4(!1),t=e[0];return e=eme.bind(null,e[1]),gl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Sr,i=gl();if(yr){if(n===void 0)throw Error(De(407));n=n()}else{if(n=t(),Ei===null)throw Error(De(349));(Gp&30)!==0||Y7(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,h4(e9.bind(null,r,a,e),[e]),r.flags|=2048,Gb(9,Q7.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=gl(),t=Ei.identifierPrefix;if(yr){var n=wu,r=bu;n=(r&~(1<<32-Lo(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ub++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Qfe++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ime={readContext:co,useCallback:l9,useContext:co,useEffect:EM,useImperativeHandle:o9,useInsertionEffect:i9,useLayoutEffect:a9,useMemo:u9,useReducer:mN,useRef:r9,useState:function(){return mN(Hb)},useDebugValue:OM,useDeferredValue:function(e){var t=po();return c9(t,li.memoizedState,e)},useTransition:function(){var e=mN(Hb)[0],t=po().memoizedState;return[e,t]},useMutableSource:X7,useSyncExternalStore:J7,useId:d9,unstable_isNewReconciler:!1},ame={readContext:co,useCallback:l9,useContext:co,useEffect:EM,useImperativeHandle:o9,useInsertionEffect:i9,useLayoutEffect:a9,useMemo:u9,useReducer:gN,useRef:r9,useState:function(){return gN(Hb)},useDebugValue:OM,useDeferredValue:function(e){var t=po();return li===null?t.memoizedState=e:c9(t,li.memoizedState,e)},useTransition:function(){var e=gN(Hb)[0],t=po().memoizedState;return[e,t]},useMutableSource:X7,useSyncExternalStore:J7,useId:d9,unstable_isNewReconciler:!1};function Fg(e,t){try{var n="",r=t;do n+=Ahe(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function yN(e,t,n){return{value:e,source:null,stack:n!=null?n:null,digest:t!=null?t:null}}function CO(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var sme=typeof WeakMap=="function"?WeakMap:Map;function m9(e,t,n){n=xu(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){jk||(jk=!0,RO=r),CO(e,t)},n}function g9(e,t,n){n=xu(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){CO(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){CO(e,t),typeof r!="function"&&(jc===null?jc=new Set([this]):jc.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function f4(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new sme;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=wme.bind(null,e,t,n),t.then(e,e))}function m4(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function g4(e,t,n,r,i){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=xu(-1,1),t.tag=2,Vc(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ome=Fu.ReactCurrentOwner,as=!1;function Oa(e,t,n,r){t.child=e===null?K7(t,null,n,r):Dg(t,e.child,n,r)}function y4(e,t,n,r,i){n=n.render;var a=t.ref;return mg(t,i),r=TM(e,t,n,r,a,i),n=NM(),e!==null&&!as?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Eu(e,t,i)):(yr&&n&&gM(t),t.flags|=1,Oa(e,t,r,i),t.child)}function v4(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!zM(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,y9(e,t,a,r,i)):(e=U_(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,(e.lanes&i)===0){var s=a.memoizedProps;if(n=n.compare,n=n!==null?n:Fb,n(s,r)&&e.ref===t.ref)return Eu(e,t,i)}return t.flags|=1,e=Hc(a,r),e.ref=t.ref,e.return=t,t.child=e}function y9(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Fb(a,r)&&e.ref===t.ref)if(as=!1,t.pendingProps=r=a,(e.lanes&i)!==0)(e.flags&131072)!==0&&(as=!0);else return t.lanes=e.lanes,Eu(e,t,i)}return IO(e,t,n,r,i)}function v9(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ir(ag,Ss),Ss|=n;else{if((n&1073741824)===0)return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ir(ag,Ss),Ss|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,ir(ag,Ss),Ss|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,ir(ag,Ss),Ss|=r;return Oa(e,t,i,n),t.child}function b9(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function IO(e,t,n,r,i){var a=us(n)?Up:ma.current;return a=Mg(t,a),mg(t,i),n=TM(e,t,n,r,a,i),r=NM(),e!==null&&!as?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Eu(e,t,i)):(yr&&r&&gM(t),t.flags|=1,Oa(e,t,n,i),t.child)}function b4(e,t,n,r,i){if(us(n)){var a=!0;Ak(t)}else a=!1;if(mg(t,i),t.stateNode===null)W_(e,t),G7(t,n,r),SO(t,n,r,i),r=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=co(u):(u=us(n)?Up:ma.current,u=Mg(t,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==r||l!==u)&&c4(t,s,r,u),bc=!1;var p=t.memoizedState;s.state=p,Fk(t,r,s,i),l=t.memoizedState,o!==r||p!==l||ls.current||bc?(typeof c=="function"&&(kO(t,n,c,r),l=t.memoizedState),(o=bc||u4(t,n,o,r,p,l,u))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=u,r=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,U7(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Oo(t.type,o),s.props=u,d=t.pendingProps,p=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=co(l):(l=us(n)?Up:ma.current,l=Mg(t,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==d||p!==l)&&c4(t,s,r,l),bc=!1,p=t.memoizedState,s.state=p,Fk(t,r,s,i);var m=t.memoizedState;o!==d||p!==m||ls.current||bc?(typeof h=="function"&&(kO(t,n,h,r),m=t.memoizedState),(u=bc||u4(t,n,u,r,p,m,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,m,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,m,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),s.props=r,s.state=m,s.context=l,r=u):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return $O(e,t,n,r,a,i)}function $O(e,t,n,r,i,a){b9(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return i&&i4(t,n,!1),Eu(e,t,a);r=t.stateNode,ome.current=t;var o=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=Dg(t,e.child,null,a),t.child=Dg(t,null,o,a)):Oa(e,t,o,a),t.memoizedState=r.state,i&&i4(t,n,!0),t.child}function w9(e){var t=e.stateNode;t.pendingContext?r4(e,t.pendingContext,t.pendingContext!==t.context):t.context&&r4(e,t.context,!1),SM(e,t.containerInfo)}function w4(e,t,n,r,i){return Rg(),vM(i),t.flags|=256,Oa(e,t,n,r),t.child}var TO={dehydrated:null,treeContext:null,retryLane:0};function NO(e){return{baseLanes:e,cachePool:null,transitions:null}}function x9(e,t,n){var r=t.pendingProps,i=kr.current,a=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),ir(kr,i&1),e===null)return xO(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(s=r.children,e=r.fallback,a?(r=t.mode,a=t.child,s={mode:"hidden",children:s},(r&1)===0&&a!==null?(a.childLanes=0,a.pendingProps=s):a=a2(s,r,0,null),e=Ep(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=NO(n),t.memoizedState=TO,e):PM(t,s));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lme(e,t,s,r,o,i,n);if(a){a=r.fallback,s=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:r.children};return(s&1)===0&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Hc(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Hc(o,a):(a=Ep(a,s,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,s=e.child.memoizedState,s=s===null?NO(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=e.childLanes&~n,t.memoizedState=TO,r}return a=e.child,e=a.sibling,r=Hc(a,{mode:"visible",children:r.children}),(t.mode&1)===0&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function PM(e,t){return t=a2({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ex(e,t,n,r){return r!==null&&vM(r),Dg(t,e.child,null,n),e=PM(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lme(e,t,n,r,i,a,s){if(n)return t.flags&256?(t.flags&=-257,r=yN(Error(De(422))),Ex(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=a2({mode:"visible",children:r.children},i,0,null),a=Ep(a,i,s,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,(t.mode&1)!==0&&Dg(t,e.child,null,s),t.child.memoizedState=NO(s),t.memoizedState=TO,a);if((t.mode&1)===0)return Ex(e,t,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,a=Error(De(419)),r=yN(a,r,void 0),Ex(e,t,s,r)}if(o=(s&e.childLanes)!==0,as||o){if(r=Ei,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=(i&(r.suspendedLanes|s))!==0?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Nu(e,i),Fo(r,e,i,-1))}return FM(),r=yN(Error(De(421))),Ex(e,t,s,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=xme.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Is=Wc(i.nextSibling),Os=t,yr=!0,Ao=null,e!==null&&(to[no++]=bu,to[no++]=wu,to[no++]=Hp,bu=e.id,wu=e.overflow,Hp=t),t=PM(t,r.children),t.flags|=4096,t)}function x4(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),_O(e.return,t,n)}function vN(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function _9(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Oa(e,t,r.children,n),r=kr.current,(r&2)!==0)r=r&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&x4(e,n,t);else if(e.tag===19)x4(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ir(kr,r),(t.mode&1)===0)t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&zk(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),vN(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&zk(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}vN(t,!0,n,null,a);break;case"together":vN(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function W_(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Eu(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),qp|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(De(153));if(t.child!==null){for(e=t.child,n=Hc(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Hc(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function ume(e,t,n){switch(t.tag){case 3:w9(t),Rg();break;case 5:Z7(t);break;case 1:us(t.type)&&Ak(t);break;case 4:SM(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;ir(Dk,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ir(kr,kr.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?x9(e,t,n):(ir(kr,kr.current&1),e=Eu(e,t,n),e!==null?e.sibling:null);ir(kr,kr.current&1);break;case 19:if(r=(n&t.childLanes)!==0,(e.flags&128)!==0){if(r)return _9(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ir(kr,kr.current),r)break;return null;case 22:case 23:return t.lanes=0,v9(e,t,n)}return Eu(e,t,n)}var k9,EO,S9,C9;k9=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};EO=function(){};S9=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,xp(Rl.current);var a=null;switch(n){case"input":i=YE(e,i),r=YE(e,r),a=[];break;case"select":i=Cr({},i,{value:void 0}),r=Cr({},r,{value:void 0}),a=[];break;case"textarea":i=tO(e,i),r=tO(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ok)}rO(n,r);var s;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(s in o)o.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ob.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var l=r[u];if(o=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(a||(a=[]),a.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ob.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&cr("scroll",e),a||o===l||(a=[])):(a=a||[]).push(u,l))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};C9=function(e,t,n,r){n!==r&&(t.flags|=4)};function $0(e,t){if(!yr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function sa(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function cme(e,t,n){var r=t.pendingProps;switch(yM(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sa(t),null;case 1:return us(t.type)&&Pk(),sa(t),null;case 3:return r=t.stateNode,Lg(),pr(ls),pr(ma),IM(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Tx(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Ao!==null&&(FO(Ao),Ao=null))),EO(e,t),sa(t),null;case 5:CM(t);var i=xp(jb.current);if(n=t.type,e!==null&&t.stateNode!=null)S9(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(De(166));return sa(t),null}if(e=xp(Rl.current),Tx(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Il]=t,r[Wb]=a,e=(t.mode&1)!==0,n){case"dialog":cr("cancel",r),cr("close",r);break;case"iframe":case"object":case"embed":cr("load",r);break;case"video":case"audio":for(i=0;i<X0.length;i++)cr(X0[i],r);break;case"source":cr("error",r);break;case"img":case"image":case"link":cr("error",r),cr("load",r);break;case"details":cr("toggle",r);break;case"input":EB(r,a),cr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},cr("invalid",r);break;case"textarea":PB(r,a),cr("invalid",r)}rO(n,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?r.textContent!==o&&(a.suppressHydrationWarning!==!0&&$x(r.textContent,o,e),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&$x(r.textContent,o,e),i=["children",""+o]):Ob.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&cr("scroll",r)}switch(n){case"input":bx(r),OB(r,a,!0);break;case"textarea":bx(r),AB(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Ok)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=YG(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[Il]=t,e[Wb]=r,k9(e,t,!1,!1),t.stateNode=e;e:{switch(s=iO(n,r),n){case"dialog":cr("cancel",e),cr("close",e),i=r;break;case"iframe":case"object":case"embed":cr("load",e),i=r;break;case"video":case"audio":for(i=0;i<X0.length;i++)cr(X0[i],e);i=r;break;case"source":cr("error",e),i=r;break;case"img":case"image":case"link":cr("error",e),cr("load",e),i=r;break;case"details":cr("toggle",e),i=r;break;case"input":EB(e,r),i=YE(e,r),cr("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Cr({},r,{value:void 0}),cr("invalid",e);break;case"textarea":PB(e,r),i=tO(e,r),cr("invalid",e);break;default:i=r}rO(n,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?t7(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&QG(e,l)):a==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Pb(e,l):typeof l=="number"&&Pb(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ob.hasOwnProperty(a)?l!=null&&a==="onScroll"&&cr("scroll",e):l!=null&&nM(e,a,l,s))}switch(n){case"input":bx(e),OB(e,r,!1);break;case"textarea":bx(e),AB(e);break;case"option":r.value!=null&&e.setAttribute("value",""+td(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?dg(e,!!r.multiple,a,!1):r.defaultValue!=null&&dg(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Ok)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return sa(t),null;case 6:if(e&&t.stateNode!=null)C9(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(De(166));if(n=xp(jb.current),xp(Rl.current),Tx(t)){if(r=t.stateNode,n=t.memoizedProps,r[Il]=t,(a=r.nodeValue!==n)&&(e=Os,e!==null))switch(e.tag){case 3:$x(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$x(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Il]=t,t.stateNode=r}return sa(t),null;case 13:if(pr(kr),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(yr&&Is!==null&&(t.mode&1)!==0&&(t.flags&128)===0)V7(),Rg(),t.flags|=98560,a=!1;else if(a=Tx(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(De(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(De(317));a[Il]=t}else Rg(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;sa(t),a=!1}else Ao!==null&&(FO(Ao),Ao=null),a=!0;if(!a)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(kr.current&1)!==0?fi===0&&(fi=3):FM())),t.updateQueue!==null&&(t.flags|=4),sa(t),null);case 4:return Lg(),EO(e,t),e===null&&zb(t.stateNode.containerInfo),sa(t),null;case 10:return xM(t.type._context),sa(t),null;case 17:return us(t.type)&&Pk(),sa(t),null;case 19:if(pr(kr),a=t.memoizedState,a===null)return sa(t),null;if(r=(t.flags&128)!==0,s=a.rendering,s===null)if(r)$0(a,!1);else{if(fi!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(s=zk(e),s!==null){for(t.flags|=128,$0(a,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,e=s.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ir(kr,kr.current&1|2),t.child}e=e.sibling}a.tail!==null&&Lr()>zg&&(t.flags|=128,r=!0,$0(a,!1),t.lanes=4194304)}else{if(!r)if(e=zk(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),$0(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!yr)return sa(t),null}else 2*Lr()-a.renderingStartTime>zg&&n!==1073741824&&(t.flags|=128,r=!0,$0(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(n=a.last,n!==null?n.sibling=s:t.child=s,a.last=s)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Lr(),t.sibling=null,n=kr.current,ir(kr,r?n&1|2:n&1),t):(sa(t),null);case 22:case 23:return LM(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&(t.mode&1)!==0?(Ss&1073741824)!==0&&(sa(t),t.subtreeFlags&6&&(t.flags|=8192)):sa(t),null;case 24:return null;case 25:return null}throw Error(De(156,t.tag))}function dme(e,t){switch(yM(t),t.tag){case 1:return us(t.type)&&Pk(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Lg(),pr(ls),pr(ma),IM(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return CM(t),null;case 13:if(pr(kr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(De(340));Rg()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pr(kr),null;case 4:return Lg(),null;case 10:return xM(t.type._context),null;case 22:case 23:return LM(),null;case 24:return null;default:return null}}var Ox=!1,ua=!1,pme=typeof WeakSet=="function"?WeakSet:Set,ut=null;function ig(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Er(e,t,r)}else n.current=null}function OO(e,t,n){try{n()}catch(r){Er(e,t,r)}}var _4=!1;function hme(e,t){if(fO=Tk,e=N7(),mM(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var s=0,o=-1,l=-1,u=0,c=0,d=e,p=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(o=s+i),d!==a||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(h=d.firstChild)!==null;)p=d,d=h;for(;;){if(d===e)break t;if(p===n&&++u===i&&(o=s),p===a&&++c===r&&(l=s),(h=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=h}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(mO={focusedElem:e,selectionRange:n},Tk=!1,ut=t;ut!==null;)if(t=ut,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ut=e;else for(;ut!==null;){t=ut;try{var m=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:Oo(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(De(163))}}catch(k){Er(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,ut=e;break}ut=t.return}return m=_4,_4=!1,m}function yb(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&OO(t,n,a)}i=i.next}while(i!==r)}}function r2(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function PO(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function I9(e){var t=e.alternate;t!==null&&(e.alternate=null,I9(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Il],delete t[Wb],delete t[vO],delete t[Zfe],delete t[Xfe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function $9(e){return e.tag===5||e.tag===3||e.tag===4}function k4(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||$9(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function AO(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ok));else if(r!==4&&(e=e.child,e!==null))for(AO(e,t,n),e=e.sibling;e!==null;)AO(e,t,n),e=e.sibling}function MO(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(MO(e,t,n),e=e.sibling;e!==null;)MO(e,t,n),e=e.sibling}var Vi=null,Po=!1;function sc(e,t,n){for(n=n.child;n!==null;)T9(e,t,n),n=n.sibling}function T9(e,t,n){if(Ml&&typeof Ml.onCommitFiberUnmount=="function")try{Ml.onCommitFiberUnmount(ZI,n)}catch{}switch(n.tag){case 5:ua||ig(n,t);case 6:var r=Vi,i=Po;Vi=null,sc(e,t,n),Vi=r,Po=i,Vi!==null&&(Po?(e=Vi,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Vi.removeChild(n.stateNode));break;case 18:Vi!==null&&(Po?(e=Vi,n=n.stateNode,e.nodeType===8?dN(e.parentNode,n):e.nodeType===1&&dN(e,n),Db(e)):dN(Vi,n.stateNode));break;case 4:r=Vi,i=Po,Vi=n.stateNode.containerInfo,Po=!0,sc(e,t,n),Vi=r,Po=i;break;case 0:case 11:case 14:case 15:if(!ua&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&((a&2)!==0||(a&4)!==0)&&OO(n,t,s),i=i.next}while(i!==r)}sc(e,t,n);break;case 1:if(!ua&&(ig(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Er(n,t,o)}sc(e,t,n);break;case 21:sc(e,t,n);break;case 22:n.mode&1?(ua=(r=ua)||n.memoizedState!==null,sc(e,t,n),ua=r):sc(e,t,n);break;default:sc(e,t,n)}}function S4(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new pme),t.forEach(function(r){var i=_me.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function $o(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Vi=o.stateNode,Po=!1;break e;case 3:Vi=o.stateNode.containerInfo,Po=!0;break e;case 4:Vi=o.stateNode.containerInfo,Po=!0;break e}o=o.return}if(Vi===null)throw Error(De(160));T9(a,s,i),Vi=null,Po=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Er(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)N9(t,e),t=t.sibling}function N9(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if($o(t,e),dl(e),r&4){try{yb(3,e,e.return),r2(3,e)}catch(g){Er(e,e.return,g)}try{yb(5,e,e.return)}catch(g){Er(e,e.return,g)}}break;case 1:$o(t,e),dl(e),r&512&&n!==null&&ig(n,n.return);break;case 5:if($o(t,e),dl(e),r&512&&n!==null&&ig(n,n.return),e.flags&32){var i=e.stateNode;try{Pb(i,"")}catch(g){Er(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,s=n!==null?n.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&XG(i,a),iO(o,s);var u=iO(o,a);for(s=0;s<l.length;s+=2){var c=l[s],d=l[s+1];c==="style"?t7(i,d):c==="dangerouslySetInnerHTML"?QG(i,d):c==="children"?Pb(i,d):nM(i,c,d,u)}switch(o){case"input":QE(i,a);break;case"textarea":JG(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?dg(i,!!a.multiple,h,!1):p!==!!a.multiple&&(a.defaultValue!=null?dg(i,!!a.multiple,a.defaultValue,!0):dg(i,!!a.multiple,a.multiple?[]:"",!1))}i[Wb]=a}catch(g){Er(e,e.return,g)}}break;case 6:if($o(t,e),dl(e),r&4){if(e.stateNode===null)throw Error(De(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Er(e,e.return,g)}}break;case 3:if($o(t,e),dl(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Db(t.containerInfo)}catch(g){Er(e,e.return,g)}break;case 4:$o(t,e),dl(e);break;case 13:$o(t,e),dl(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(RM=Lr())),r&4&&S4(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(ua=(u=ua)||c,$o(t,e),ua=u):$o(t,e),dl(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&(e.mode&1)!==0)for(ut=e,c=e.child;c!==null;){for(d=ut=c;ut!==null;){switch(p=ut,h=p.child,p.tag){case 0:case 11:case 14:case 15:yb(4,p,p.return);break;case 1:ig(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Er(r,n,g)}}break;case 5:ig(p,p.return);break;case 22:if(p.memoizedState!==null){I4(d);continue}}h!==null?(h.return=p,ut=h):I4(d)}c=c.sibling}e:for(c=null,d=e;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=e7("display",s))}catch(g){Er(e,e.return,g)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Er(e,e.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:$o(t,e),dl(e),r&4&&S4(e);break;case 21:break;default:$o(t,e),dl(e)}}function dl(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if($9(n)){var r=n;break e}n=n.return}throw Error(De(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Pb(i,""),r.flags&=-33);var a=k4(e);MO(e,a,i);break;case 3:case 4:var s=r.stateNode.containerInfo,o=k4(e);AO(e,o,s);break;default:throw Error(De(161))}}catch(l){Er(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function fme(e,t,n){ut=e,E9(e)}function E9(e,t,n){for(var r=(e.mode&1)!==0;ut!==null;){var i=ut,a=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Ox;if(!s){var o=i.alternate,l=o!==null&&o.memoizedState!==null||ua;o=Ox;var u=ua;if(Ox=s,(ua=l)&&!u)for(ut=i;ut!==null;)s=ut,l=s.child,s.tag===22&&s.memoizedState!==null?$4(i):l!==null?(l.return=s,ut=l):$4(i);for(;a!==null;)ut=a,E9(a),a=a.sibling;ut=i,Ox=o,ua=u}C4(e)}else(i.subtreeFlags&8772)!==0&&a!==null?(a.return=i,ut=a):C4(e)}}function C4(e){for(;ut!==null;){var t=ut;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:ua||r2(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!ua)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Oo(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&l4(t,a,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}l4(t,s,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Db(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(De(163))}ua||t.flags&512&&PO(t)}catch(p){Er(t,t.return,p)}}if(t===e){ut=null;break}if(n=t.sibling,n!==null){n.return=t.return,ut=n;break}ut=t.return}}function I4(e){for(;ut!==null;){var t=ut;if(t===e){ut=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ut=n;break}ut=t.return}}function $4(e){for(;ut!==null;){var t=ut;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{r2(4,t)}catch(l){Er(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){Er(t,i,l)}}var a=t.return;try{PO(t)}catch(l){Er(t,a,l)}break;case 5:var s=t.return;try{PO(t)}catch(l){Er(t,s,l)}}}catch(l){Er(t,t.return,l)}if(t===e){ut=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ut=o;break}ut=t.return}}var mme=Math.ceil,Vk=Fu.ReactCurrentDispatcher,AM=Fu.ReactCurrentOwner,so=Fu.ReactCurrentBatchConfig,mn=0,Ei=null,Xr=null,Zi=0,Ss=0,ag=_d(0),fi=0,qb=null,qp=0,i2=0,MM=0,vb=null,ns=null,RM=0,zg=1/0,uu=null,jk=!1,RO=null,jc=null,Px=!1,Nc=null,Uk=0,bb=0,DO=null,V_=-1,j_=0;function Ra(){return(mn&6)!==0?Lr():V_!==-1?V_:V_=Lr()}function Uc(e){return(e.mode&1)===0?1:(mn&2)!==0&&Zi!==0?Zi&-Zi:Yfe.transition!==null?(j_===0&&(j_=h7()),j_):(e=Bn,e!==0||(e=window.event,e=e===void 0?16:w7(e.type)),e)}function Fo(e,t,n,r){if(50<bb)throw bb=0,DO=null,Error(De(185));N1(e,n,r),((mn&2)===0||e!==Ei)&&(e===Ei&&((mn&2)===0&&(i2|=n),fi===4&&Cc(e,Zi)),cs(e,r),n===1&&mn===0&&(t.mode&1)===0&&(zg=Lr()+500,e2&&kd()))}function cs(e,t){var n=e.callbackNode;Yhe(e,t);var r=$k(e,e===Ei?Zi:0);if(r===0)n!==null&&DB(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&DB(n),t===1)e.tag===0?Jfe(T4.bind(null,e)):z7(T4.bind(null,e)),qfe(function(){(mn&6)===0&&kd()}),n=null;else{switch(f7(r)){case 1:n=oM;break;case 4:n=d7;break;case 16:n=Ik;break;case 536870912:n=p7;break;default:n=Ik}n=F9(n,O9.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function O9(e,t){if(V_=-1,j_=0,(mn&6)!==0)throw Error(De(327));var n=e.callbackNode;if(gg()&&e.callbackNode!==n)return null;var r=$k(e,e===Ei?Zi:0);if(r===0)return null;if((r&30)!==0||(r&e.expiredLanes)!==0||t)t=Hk(e,r);else{t=r;var i=mn;mn|=2;var a=A9();(Ei!==e||Zi!==t)&&(uu=null,zg=Lr()+500,Np(e,t));do try{vme();break}catch(o){P9(e,o)}while(1);wM(),Vk.current=a,mn=i,Xr!==null?t=0:(Ei=null,Zi=0,t=fi)}if(t!==0){if(t===2&&(i=uO(e),i!==0&&(r=i,t=LO(e,i))),t===1)throw n=qb,Np(e,0),Cc(e,r),cs(e,Lr()),n;if(t===6)Cc(e,r);else{if(i=e.current.alternate,(r&30)===0&&!gme(i)&&(t=Hk(e,r),t===2&&(a=uO(e),a!==0&&(r=a,t=LO(e,a))),t===1))throw n=qb,Np(e,0),Cc(e,r),cs(e,Lr()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(De(345));case 2:sp(e,ns,uu);break;case 3:if(Cc(e,r),(r&130023424)===r&&(t=RM+500-Lr(),10<t)){if($k(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Ra(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=yO(sp.bind(null,e,ns,uu),t);break}sp(e,ns,uu);break;case 4:if(Cc(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-Lo(r);a=1<<s,s=t[s],s>i&&(i=s),r&=~a}if(r=i,r=Lr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*mme(r/1960))-r,10<r){e.timeoutHandle=yO(sp.bind(null,e,ns,uu),r);break}sp(e,ns,uu);break;case 5:sp(e,ns,uu);break;default:throw Error(De(329))}}}return cs(e,Lr()),e.callbackNode===n?O9.bind(null,e):null}function LO(e,t){var n=vb;return e.current.memoizedState.isDehydrated&&(Np(e,t).flags|=256),e=Hk(e,t),e!==2&&(t=ns,ns=n,t!==null&&FO(t)),e}function FO(e){ns===null?ns=e:ns.push.apply(ns,e)}function gme(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Ho(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Cc(e,t){for(t&=~MM,t&=~i2,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Lo(t),r=1<<n;e[n]=-1,t&=~r}}function T4(e){if((mn&6)!==0)throw Error(De(327));gg();var t=$k(e,0);if((t&1)===0)return cs(e,Lr()),null;var n=Hk(e,t);if(e.tag!==0&&n===2){var r=uO(e);r!==0&&(t=r,n=LO(e,r))}if(n===1)throw n=qb,Np(e,0),Cc(e,t),cs(e,Lr()),n;if(n===6)throw Error(De(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,sp(e,ns,uu),cs(e,Lr()),null}function DM(e,t){var n=mn;mn|=1;try{return e(t)}finally{mn=n,mn===0&&(zg=Lr()+500,e2&&kd())}}function Kp(e){Nc!==null&&Nc.tag===0&&(mn&6)===0&&gg();var t=mn;mn|=1;var n=so.transition,r=Bn;try{if(so.transition=null,Bn=1,e)return e()}finally{Bn=r,so.transition=n,mn=t,(mn&6)===0&&kd()}}function LM(){Ss=ag.current,pr(ag)}function Np(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Gfe(n)),Xr!==null)for(n=Xr.return;n!==null;){var r=n;switch(yM(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Pk();break;case 3:Lg(),pr(ls),pr(ma),IM();break;case 5:CM(r);break;case 4:Lg();break;case 13:pr(kr);break;case 19:pr(kr);break;case 10:xM(r.type._context);break;case 22:case 23:LM()}n=n.return}if(Ei=e,Xr=e=Hc(e.current,null),Zi=Ss=t,fi=0,qb=null,MM=i2=qp=0,ns=vb=null,wp!==null){for(t=0;t<wp.length;t++)if(n=wp[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var s=a.next;a.next=i,r.next=s}n.pending=r}wp=null}return e}function P9(e,t){do{var n=Xr;try{if(wM(),z_.current=Wk,Bk){for(var r=Sr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Bk=!1}if(Gp=0,ki=li=Sr=null,gb=!1,Ub=0,AM.current=null,n===null||n.return===null){fi=1,qb=t,Xr=null;break}e:{var a=e,s=n.return,o=n,l=t;if(t=Zi,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,d=c.tag;if((c.mode&1)===0&&(d===0||d===11||d===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=m4(s);if(h!==null){h.flags&=-257,g4(h,s,o,a,t),h.mode&1&&f4(a,u,t),t=h,l=u;var m=t.updateQueue;if(m===null){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}else{if((t&1)===0){f4(a,u,t),FM();break e}l=Error(De(426))}}else if(yr&&o.mode&1){var v=m4(s);if(v!==null){(v.flags&65536)===0&&(v.flags|=256),g4(v,s,o,a,t),vM(Fg(l,o));break e}}a=l=Fg(l,o),fi!==4&&(fi=2),vb===null?vb=[a]:vb.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var y=m9(a,l,t);o4(a,y);break e;case 1:o=l;var b=a.type,_=a.stateNode;if((a.flags&128)===0&&(typeof b.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(jc===null||!jc.has(_)))){a.flags|=65536,t&=-t,a.lanes|=t;var k=g9(a,o,t);o4(a,k);break e}}a=a.return}while(a!==null)}R9(n)}catch(C){t=C,Xr===n&&n!==null&&(Xr=n=n.return);continue}break}while(1)}function A9(){var e=Vk.current;return Vk.current=Wk,e===null?Wk:e}function FM(){(fi===0||fi===3||fi===2)&&(fi=4),Ei===null||(qp&268435455)===0&&(i2&268435455)===0||Cc(Ei,Zi)}function Hk(e,t){var n=mn;mn|=2;var r=A9();(Ei!==e||Zi!==t)&&(uu=null,Np(e,t));do try{yme();break}catch(i){P9(e,i)}while(1);if(wM(),mn=n,Vk.current=r,Xr!==null)throw Error(De(261));return Ei=null,Zi=0,fi}function yme(){for(;Xr!==null;)M9(Xr)}function vme(){for(;Xr!==null&&!jhe();)M9(Xr)}function M9(e){var t=L9(e.alternate,e,Ss);e.memoizedProps=e.pendingProps,t===null?R9(e):Xr=t,AM.current=null}function R9(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=cme(n,t,Ss),n!==null){Xr=n;return}}else{if(n=dme(n,t),n!==null){n.flags&=32767,Xr=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{fi=6,Xr=null;return}}if(t=t.sibling,t!==null){Xr=t;return}Xr=t=e}while(t!==null);fi===0&&(fi=5)}function sp(e,t,n){var r=Bn,i=so.transition;try{so.transition=null,Bn=1,bme(e,t,n,r)}finally{so.transition=i,Bn=r}return null}function bme(e,t,n,r){do gg();while(Nc!==null);if((mn&6)!==0)throw Error(De(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(De(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(Qhe(e,a),e===Ei&&(Xr=Ei=null,Zi=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Px||(Px=!0,F9(Ik,function(){return gg(),null})),a=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||a){a=so.transition,so.transition=null;var s=Bn;Bn=1;var o=mn;mn|=4,AM.current=null,hme(e,n),N9(n,e),zfe(mO),Tk=!!fO,mO=fO=null,e.current=n,fme(n),Uhe(),mn=o,Bn=s,so.transition=a}else e.current=n;if(Px&&(Px=!1,Nc=e,Uk=i),a=e.pendingLanes,a===0&&(jc=null),qhe(n.stateNode),cs(e,Lr()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(jk)throw jk=!1,e=RO,RO=null,e;return(Uk&1)!==0&&e.tag!==0&&gg(),a=e.pendingLanes,(a&1)!==0?e===DO?bb++:(bb=0,DO=e):bb=0,kd(),null}function gg(){if(Nc!==null){var e=f7(Uk),t=so.transition,n=Bn;try{if(so.transition=null,Bn=16>e?16:e,Nc===null)var r=!1;else{if(e=Nc,Nc=null,Uk=0,(mn&6)!==0)throw Error(De(331));var i=mn;for(mn|=4,ut=e.current;ut!==null;){var a=ut,s=a.child;if((ut.flags&16)!==0){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(ut=u;ut!==null;){var c=ut;switch(c.tag){case 0:case 11:case 15:yb(8,c,a)}var d=c.child;if(d!==null)d.return=c,ut=d;else for(;ut!==null;){c=ut;var p=c.sibling,h=c.return;if(I9(c),c===u){ut=null;break}if(p!==null){p.return=h,ut=p;break}ut=h}}}var m=a.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}ut=a}}if((a.subtreeFlags&2064)!==0&&s!==null)s.return=a,ut=s;else e:for(;ut!==null;){if(a=ut,(a.flags&2048)!==0)switch(a.tag){case 0:case 11:case 15:yb(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,ut=y;break e}ut=a.return}}var b=e.current;for(ut=b;ut!==null;){s=ut;var _=s.child;if((s.subtreeFlags&2064)!==0&&_!==null)_.return=s,ut=_;else e:for(s=b;ut!==null;){if(o=ut,(o.flags&2048)!==0)try{switch(o.tag){case 0:case 11:case 15:r2(9,o)}}catch(C){Er(o,o.return,C)}if(o===s){ut=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,ut=k;break e}ut=o.return}}if(mn=i,kd(),Ml&&typeof Ml.onPostCommitFiberRoot=="function")try{Ml.onPostCommitFiberRoot(ZI,e)}catch{}r=!0}return r}finally{Bn=n,so.transition=t}}return!1}function N4(e,t,n){t=Fg(n,t),t=m9(e,t,1),e=Vc(e,t,1),t=Ra(),e!==null&&(N1(e,1,t),cs(e,t))}function Er(e,t,n){if(e.tag===3)N4(e,e,n);else for(;t!==null;){if(t.tag===3){N4(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(jc===null||!jc.has(r))){e=Fg(n,e),e=g9(t,e,1),t=Vc(t,e,1),e=Ra(),t!==null&&(N1(t,1,e),cs(t,e));break}}t=t.return}}function wme(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ra(),e.pingedLanes|=e.suspendedLanes&n,Ei===e&&(Zi&n)===n&&(fi===4||fi===3&&(Zi&130023424)===Zi&&500>Lr()-RM?Np(e,0):MM|=n),cs(e,t)}function D9(e,t){t===0&&((e.mode&1)===0?t=1:(t=_x,_x<<=1,(_x&130023424)===0&&(_x=4194304)));var n=Ra();e=Nu(e,t),e!==null&&(N1(e,t,n),cs(e,n))}function xme(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),D9(e,n)}function _me(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(De(314))}r!==null&&r.delete(t),D9(e,n)}var L9;L9=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ls.current)as=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return as=!1,ume(e,t,n);as=(e.flags&131072)!==0}else as=!1,yr&&(t.flags&1048576)!==0&&B7(t,Rk,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;W_(e,t),e=t.pendingProps;var i=Mg(t,ma.current);mg(t,n),i=TM(null,t,r,e,i,n);var a=NM();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,us(r)?(a=!0,Ak(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,kM(t),i.updater=t2,t.stateNode=i,i._reactInternals=t,SO(t,r,e,n),t=$O(null,t,r,!0,a,n)):(t.tag=0,yr&&a&&gM(t),Oa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(W_(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=Sme(r),e=Oo(r,e),i){case 0:t=IO(null,t,r,e,n);break e;case 1:t=b4(null,t,r,e,n);break e;case 11:t=y4(null,t,r,e,n);break e;case 14:t=v4(null,t,r,Oo(r.type,e),n);break e}throw Error(De(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Oo(r,i),IO(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Oo(r,i),b4(e,t,r,i,n);case 3:e:{if(w9(t),e===null)throw Error(De(387));r=t.pendingProps,a=t.memoizedState,i=a.element,U7(e,t),Fk(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Fg(Error(De(423)),t),t=w4(e,t,r,n,i);break e}else if(r!==i){i=Fg(Error(De(424)),t),t=w4(e,t,r,n,i);break e}else for(Is=Wc(t.stateNode.containerInfo.firstChild),Os=t,yr=!0,Ao=null,n=K7(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Rg(),r===i){t=Eu(e,t,n);break e}Oa(e,t,r,n)}t=t.child}return t;case 5:return Z7(t),e===null&&xO(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,s=i.children,gO(r,i)?s=null:a!==null&&gO(r,a)&&(t.flags|=32),b9(e,t),Oa(e,t,s,n),t.child;case 6:return e===null&&xO(t),null;case 13:return x9(e,t,n);case 4:return SM(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Dg(t,null,r,n):Oa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Oo(r,i),y4(e,t,r,i,n);case 7:return Oa(e,t,t.pendingProps,n),t.child;case 8:return Oa(e,t,t.pendingProps.children,n),t.child;case 12:return Oa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,ir(Dk,r._currentValue),r._currentValue=s,a!==null)if(Ho(a.value,s)){if(a.children===i.children&&!ls.current){t=Eu(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(a.tag===1){l=xu(-1,n&-n),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),_O(a.return,n,t),o.lanes|=n;break}l=l.next}}else if(a.tag===10)s=a.type===t.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(De(341));s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),_O(s,n,t),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===t){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}Oa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,mg(t,n),i=co(i),r=r(i),t.flags|=1,Oa(e,t,r,n),t.child;case 14:return r=t.type,i=Oo(r,t.pendingProps),i=Oo(r.type,i),v4(e,t,r,i,n);case 15:return y9(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Oo(r,i),W_(e,t),t.tag=1,us(r)?(e=!0,Ak(t)):e=!1,mg(t,n),G7(t,r,i),SO(t,r,i,n),$O(null,t,r,!0,e,n);case 19:return _9(e,t,n);case 22:return v9(e,t,n)}throw Error(De(156,t.tag))};function F9(e,t){return c7(e,t)}function kme(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ro(e,t,n,r){return new kme(e,t,n,r)}function zM(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Sme(e){if(typeof e=="function")return zM(e)?1:0;if(e!=null){if(e=e.$$typeof,e===iM)return 11;if(e===aM)return 14}return 2}function Hc(e,t){var n=e.alternate;return n===null?(n=ro(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function U_(e,t,n,r,i,a){var s=2;if(r=e,typeof e=="function")zM(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Zm:return Ep(n.children,i,a,t);case rM:s=8,i|=8;break;case KE:return e=ro(12,n,t,i|2),e.elementType=KE,e.lanes=a,e;case ZE:return e=ro(13,n,t,i),e.elementType=ZE,e.lanes=a,e;case XE:return e=ro(19,n,t,i),e.elementType=XE,e.lanes=a,e;case qG:return a2(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case HG:s=10;break e;case GG:s=9;break e;case iM:s=11;break e;case aM:s=14;break e;case vc:s=16,r=null;break e}throw Error(De(130,e==null?e:typeof e,""))}return t=ro(s,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function Ep(e,t,n,r){return e=ro(7,e,r,t),e.lanes=n,e}function a2(e,t,n,r){return e=ro(22,e,r,t),e.elementType=qG,e.lanes=n,e.stateNode={isHidden:!1},e}function bN(e,t,n){return e=ro(6,e,null,t),e.lanes=n,e}function wN(e,t,n){return t=ro(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Cme(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=eN(0),this.expirationTimes=eN(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=eN(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function BM(e,t,n,r,i,a,s,o,l){return e=new Cme(e,t,n,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=ro(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},kM(a),e}function Ime(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Km,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function z9(e){if(!e)return nd;e=e._reactInternals;e:{if(Ch(e)!==e||e.tag!==1)throw Error(De(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(us(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(De(171))}if(e.tag===1){var n=e.type;if(us(n))return F7(e,n,t)}return t}function B9(e,t,n,r,i,a,s,o,l){return e=BM(n,r,!0,e,i,a,s,o,l),e.context=z9(null),n=e.current,r=Ra(),i=Uc(n),a=xu(r,i),a.callback=t!=null?t:null,Vc(n,a,i),e.current.lanes=i,N1(e,i,r),cs(e,r),e}function s2(e,t,n,r){var i=t.current,a=Ra(),s=Uc(i);return n=z9(n),t.context===null?t.context=n:t.pendingContext=n,t=xu(a,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Vc(i,t,s),e!==null&&(Fo(e,i,s,a),F_(e,i,s)),s}function Gk(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function E4(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function WM(e,t){E4(e,t),(e=e.alternate)&&E4(e,t)}function $me(){return null}var W9=typeof reportError=="function"?reportError:function(e){console.error(e)};function VM(e){this._internalRoot=e}o2.prototype.render=VM.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(De(409));s2(e,t,null,null)};o2.prototype.unmount=VM.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Kp(function(){s2(null,e,null,null)}),t[Tu]=null}};function o2(e){this._internalRoot=e}o2.prototype.unstable_scheduleHydration=function(e){if(e){var t=y7();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Sc.length&&t!==0&&t<Sc[n].priority;n++);Sc.splice(n,0,e),n===0&&b7(e)}};function jM(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function O4(){}function Tme(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var u=Gk(s);a.call(u)}}var s=B9(t,r,e,0,null,!1,!1,"",O4);return e._reactRootContainer=s,e[Tu]=s.current,zb(e.nodeType===8?e.parentNode:e),Kp(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var u=Gk(l);o.call(u)}}var l=BM(e,0,!1,null,null,!1,!1,"",O4);return e._reactRootContainer=l,e[Tu]=l.current,zb(e.nodeType===8?e.parentNode:e),Kp(function(){s2(t,l,n,r)}),l}function u2(e,t,n,r,i){var a=n._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var l=Gk(s);o.call(l)}}s2(t,s,e,i)}else s=Tme(n,t,e,i,r);return Gk(s)}m7=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Z0(t.pendingLanes);n!==0&&(lM(t,n|1),cs(t,Lr()),(mn&6)===0&&(zg=Lr()+500,kd()))}break;case 13:Kp(function(){var r=Nu(e,1);if(r!==null){var i=Ra();Fo(r,e,1,i)}}),WM(e,1)}};uM=function(e){if(e.tag===13){var t=Nu(e,134217728);if(t!==null){var n=Ra();Fo(t,e,134217728,n)}WM(e,134217728)}};g7=function(e){if(e.tag===13){var t=Uc(e),n=Nu(e,t);if(n!==null){var r=Ra();Fo(n,e,t,r)}WM(e,t)}};y7=function(){return Bn};v7=function(e,t){var n=Bn;try{return Bn=e,t()}finally{Bn=n}};sO=function(e,t,n){switch(t){case"input":if(QE(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=QI(r);if(!i)throw Error(De(90));ZG(r),QE(r,i)}}}break;case"textarea":JG(e,n);break;case"select":t=n.value,t!=null&&dg(e,!!n.multiple,t,!1)}};i7=DM;a7=Kp;var Nme={usingClientEntryPoint:!1,Events:[O1,Qm,QI,n7,r7,DM]},T0={findFiberByHostInstance:bp,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Eme={bundleType:T0.bundleType,version:T0.version,rendererPackageName:T0.rendererPackageName,rendererConfig:T0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fu.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=l7(e),e===null?null:e.stateNode},findFiberByHostInstance:T0.findFiberByHostInstance||$me,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ax=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ax.isDisabled&&Ax.supportsFiber)try{ZI=Ax.inject(Eme),Ml=Ax}catch{}}Bs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nme;Bs.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jM(t))throw Error(De(200));return Ime(e,t,null,n)};Bs.createRoot=function(e,t){if(!jM(e))throw Error(De(299));var n=!1,r="",i=W9;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=BM(e,1,!1,null,null,n,!1,r,i),e[Tu]=t.current,zb(e.nodeType===8?e.parentNode:e),new VM(t)};Bs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(De(188)):(e=Object.keys(e).join(","),Error(De(268,e)));return e=l7(t),e=e===null?null:e.stateNode,e};Bs.flushSync=function(e){return Kp(e)};Bs.hydrate=function(e,t,n){if(!l2(t))throw Error(De(200));return u2(null,e,t,!0,n)};Bs.hydrateRoot=function(e,t,n){if(!jM(e))throw Error(De(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",s=W9;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=B9(t,null,e,1,n!=null?n:null,i,!1,a,s),e[Tu]=t.current,zb(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new o2(t)};Bs.render=function(e,t,n){if(!l2(t))throw Error(De(200));return u2(null,e,t,!1,n)};Bs.unmountComponentAtNode=function(e){if(!l2(e))throw Error(De(40));return e._reactRootContainer?(Kp(function(){u2(null,null,e,!1,function(){e._reactRootContainer=null,e[Tu]=null})}),!0):!1};Bs.unstable_batchedUpdates=DM;Bs.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!l2(n))throw Error(De(200));if(e==null||e._reactInternals===void 0)throw Error(De(38));return u2(e,t,n,!1,r)};Bs.version="18.2.0-next-9e3b772b8-20220608";(function(e){function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}t(),e.exports=Bs})(ql);const V9=ZA(ql.exports),Ome=AG({__proto__:null,default:V9},[ql.exports]);var P4=ql.exports;GE.createRoot=P4.createRoot,GE.hydrateRoot=P4.hydrateRoot;const Pme={colorScheme:"dark"};var Pr=function(){return Pr=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Pr.apply(this,arguments)};function j9(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function Kb(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var H_="right-scroll-bar-position",G_="width-before-scroll-bar",Ame="with-scroll-bars-hidden",Mme="--removed-body-scroll-bar-size";function Rme(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Dme(e,t){var n=I.exports.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}function Lme(e,t){return Dme(t||null,function(n){return e.forEach(function(r){return Rme(r,n)})})}var c2={exports:{}},d2={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fme=I.exports,zme=Symbol.for("react.element"),Bme=Symbol.for("react.fragment"),Wme=Object.prototype.hasOwnProperty,Vme=Fme.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jme={key:!0,ref:!0,__self:!0,__source:!0};function U9(e,t,n){var r,i={},a=null,s=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)Wme.call(t,r)&&!jme.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:zme,type:e,key:a,ref:s,props:i,_owner:Vme.current}}d2.Fragment=Bme;d2.jsx=U9;d2.jsxs=U9;(function(e){e.exports=d2})(c2);const ze=c2.exports.Fragment,x=c2.exports.jsx,B=c2.exports.jsxs;function Ume(e){return e}function Hme(e,t){t===void 0&&(t=Ume);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(a){var s=t(a,r);return n.push(s),function(){n=n.filter(function(o){return o!==s})}},assignSyncMedium:function(a){for(r=!0;n.length;){var s=n;n=[],s.forEach(a)}n={push:function(o){return a(o)},filter:function(){return n}}},assignMedium:function(a){r=!0;var s=[];if(n.length){var o=n;n=[],o.forEach(a),s=n}var l=function(){var c=s;s=[],c.forEach(a)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(c){s.push(c),u()},filter:function(c){return s=s.filter(c),n}}}};return i}function Gme(e){e===void 0&&(e={});var t=Hme(null);return t.options=Pr({async:!0,ssr:!1},e),t}var H9=function(e){var t=e.sideCar,n=j9(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return x(r,{...Pr({},n)})};H9.isSideCarExport=!0;function qme(e,t){return e.useMedium(t),H9}var G9=Gme(),xN=function(){},p2=I.exports.forwardRef(function(e,t){var n=I.exports.useRef(null),r=I.exports.useState({onScrollCapture:xN,onWheelCapture:xN,onTouchMoveCapture:xN}),i=r[0],a=r[1],s=e.forwardProps,o=e.children,l=e.className,u=e.removeScrollBar,c=e.enabled,d=e.shards,p=e.sideCar,h=e.noIsolation,m=e.inert,g=e.allowPinchZoom,v=e.as,y=v===void 0?"div":v,b=e.gapMode,_=j9(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=p,C=Lme([n,t]),$=Pr(Pr({},_),i);return B(ze,{children:[c&&x(k,{sideCar:G9,removeScrollBar:u,shards:d,noIsolation:h,inert:m,setCallbacks:a,allowPinchZoom:!!g,lockRef:n,gapMode:b}),s?I.exports.cloneElement(I.exports.Children.only(o),Pr(Pr({},$),{ref:C})):x(y,{...Pr({},$,{className:l,ref:C}),children:o})]})});p2.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};p2.classNames={fullWidth:G_,zeroRight:H_};var Kme=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Zme(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Kme();return t&&e.setAttribute("nonce",t),e}function Xme(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Jme(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Yme=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Zme())&&(Xme(t,n),Jme(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Qme=function(){var e=Yme();return function(t,n){I.exports.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},q9=function(){var e=Qme(),t=function(n){var r=n.styles,i=n.dynamic;return e(r,i),null};return t},ege={left:0,top:0,right:0,gap:0},_N=function(e){return parseInt(e||"",10)||0},tge=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[_N(n),_N(r),_N(i)]},nge=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return ege;var t=tge(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},rge=q9(),ige=function(e,t,n,r){var i=e.left,a=e.top,s=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Ame,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(H_,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(G_,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(H_," .").concat(H_,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(G_," .").concat(G_,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body {
    `).concat(Mme,": ").concat(o,`px;
  }
`)},age=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,i=r===void 0?"margin":r,a=I.exports.useMemo(function(){return nge(i)},[i]);return x(rge,{styles:ige(a,!t,i,n?"":"!important")})},zO=!1;if(typeof window<"u")try{var Mx=Object.defineProperty({},"passive",{get:function(){return zO=!0,!0}});window.addEventListener("test",Mx,Mx),window.removeEventListener("test",Mx,Mx)}catch{zO=!1}var Tm=zO?{passive:!1}:!1,sge=function(e){return e.tagName==="TEXTAREA"},K9=function(e,t){var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!sge(e)&&n[t]==="visible")},oge=function(e){return K9(e,"overflowY")},lge=function(e){return K9(e,"overflowX")},A4=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=Z9(e,r);if(i){var a=X9(e,r),s=a[1],o=a[2];if(s>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},uge=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},cge=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Z9=function(e,t){return e==="v"?oge(t):lge(t)},X9=function(e,t){return e==="v"?uge(t):cge(t)},dge=function(e,t){return e==="h"&&t==="rtl"?-1:1},pge=function(e,t,n,r,i){var a=dge(e,window.getComputedStyle(t).direction),s=a*r,o=n.target,l=t.contains(o),u=!1,c=s>0,d=0,p=0;do{var h=X9(e,o),m=h[0],g=h[1],v=h[2],y=g-v-a*m;(m||y)&&Z9(e,o)&&(d+=y,p+=m),o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(c&&(i&&d===0||!i&&s>d)||!c&&(i&&p===0||!i&&-s>p))&&(u=!0),u},Rx=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},M4=function(e){return[e.deltaX,e.deltaY]},R4=function(e){return e&&"current"in e?e.current:e},hge=function(e,t){return e[0]===t[0]&&e[1]===t[1]},fge=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},mge=0,Nm=[];function gge(e){var t=I.exports.useRef([]),n=I.exports.useRef([0,0]),r=I.exports.useRef(),i=I.exports.useState(mge++)[0],a=I.exports.useState(q9)[0],s=I.exports.useRef(e);I.exports.useEffect(function(){s.current=e},[e]),I.exports.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var g=Kb([e.lockRef.current],(e.shards||[]).map(R4),!0).filter(Boolean);return g.forEach(function(v){return v.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),g.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var o=I.exports.useCallback(function(g,v){if("touches"in g&&g.touches.length===2)return!s.current.allowPinchZoom;var y=Rx(g),b=n.current,_="deltaX"in g?g.deltaX:b[0]-y[0],k="deltaY"in g?g.deltaY:b[1]-y[1],C,$=g.target,N=Math.abs(_)>Math.abs(k)?"h":"v";if("touches"in g&&N==="h"&&$.type==="range")return!1;var A=A4(N,$);if(!A)return!0;if(A?C=N:(C=N==="v"?"h":"v",A=A4(N,$)),!A)return!1;if(!r.current&&"changedTouches"in g&&(_||k)&&(r.current=C),!C)return!0;var D=r.current||C;return pge(D,v,g,D==="h"?_:k,!0)},[]),l=I.exports.useCallback(function(g){var v=g;if(!(!Nm.length||Nm[Nm.length-1]!==a)){var y="deltaY"in v?M4(v):Rx(v),b=t.current.filter(function(C){return C.name===v.type&&C.target===v.target&&hge(C.delta,y)})[0];if(b&&b.should){v.cancelable&&v.preventDefault();return}if(!b){var _=(s.current.shards||[]).map(R4).filter(Boolean).filter(function(C){return C.contains(v.target)}),k=_.length>0?o(v,_[0]):!s.current.noIsolation;k&&v.cancelable&&v.preventDefault()}}},[]),u=I.exports.useCallback(function(g,v,y,b){var _={name:g,delta:v,target:y,should:b};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(k){return k!==_})},1)},[]),c=I.exports.useCallback(function(g){n.current=Rx(g),r.current=void 0},[]),d=I.exports.useCallback(function(g){u(g.type,M4(g),g.target,o(g,e.lockRef.current))},[]),p=I.exports.useCallback(function(g){u(g.type,Rx(g),g.target,o(g,e.lockRef.current))},[]);I.exports.useEffect(function(){return Nm.push(a),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:p}),document.addEventListener("wheel",l,Tm),document.addEventListener("touchmove",l,Tm),document.addEventListener("touchstart",c,Tm),function(){Nm=Nm.filter(function(g){return g!==a}),document.removeEventListener("wheel",l,Tm),document.removeEventListener("touchmove",l,Tm),document.removeEventListener("touchstart",c,Tm)}},[]);var h=e.removeScrollBar,m=e.inert;return B(ze,{children:[m?x(a,{styles:fge(i)}):null,h?x(age,{gapMode:e.gapMode}):null]})}const yge=qme(G9,gge);var J9=I.exports.forwardRef(function(e,t){return x(p2,{...Pr({},e,{ref:t,sideCar:yge})})});J9.classNames=p2.classNames;const vge=J9;function BO(e,t){let n=e;for(;(n=n.parentElement)&&!n.matches(t););return n}function bge(e,t,n){for(let r=e-1;r>=0;r-=1)if(!t[r].disabled)return r;if(n){for(let r=t.length-1;r>-1;r-=1)if(!t[r].disabled)return r}return e}function wge(e,t,n){for(let r=e+1;r<t.length;r+=1)if(!t[r].disabled)return r;if(n){for(let r=0;r<t.length;r+=1)if(!t[r].disabled)return r}return e}function xge(e,t,n){return BO(e,n)===BO(t,n)}function _ge({parentSelector:e,siblingSelector:t,onKeyDown:n,loop:r=!0,activateOnFocus:i=!1,dir:a="rtl",orientation:s}){return o=>{var l;n==null||n(o);const u=Array.from(((l=BO(o.currentTarget,e))==null?void 0:l.querySelectorAll(t))||[]).filter(g=>xge(o.currentTarget,g,e)),c=u.findIndex(g=>o.currentTarget===g),d=wge(c,u,r),p=bge(c,u,r),h=a==="rtl"?p:d,m=a==="rtl"?d:p;switch(o.key){case"ArrowRight":{s==="horizontal"&&(o.stopPropagation(),o.preventDefault(),u[h].focus(),i&&u[h].click());break}case"ArrowLeft":{s==="horizontal"&&(o.stopPropagation(),o.preventDefault(),u[m].focus(),i&&u[m].click());break}case"ArrowUp":{s==="vertical"&&(o.stopPropagation(),o.preventDefault(),u[p].focus(),i&&u[p].click());break}case"ArrowDown":{s==="vertical"&&(o.stopPropagation(),o.preventDefault(),u[d].focus(),i&&u[d].click());break}case"Home":{o.stopPropagation(),o.preventDefault(),!u[0].disabled&&u[0].focus();break}case"End":{o.stopPropagation(),o.preventDefault();const g=u.length-1;!u[g].disabled&&u[g].focus();break}}}}function Iy(e){const t=I.exports.createContext(null);return[({children:i,value:a})=>x(t.Provider,{value:a,children:i}),()=>{const i=I.exports.useContext(t);if(i===null)throw new Error(e);return i}]}function UM(e){return Array.isArray(e)?e:[e]}function D4(e,t){return n=>{if(typeof n!="string"||n.trim().length===0)throw new Error(t);return`${e}-${n}`}}const kge=()=>{};function Sge(e,t={active:!0}){return typeof e!="function"||!t.active?t.onKeyDown||kge:n=>{var r;n.key==="Escape"&&(e(n),(r=t.onTrigger)==null||r.call(t))}}function qk(e,t){return n=>{e==null||e(n),t==null||t(n)}}function Cge(e){return Object.keys(e)}function Y9({data:e}){const t=[],n=[],r=e.reduce((i,a,s)=>(a.group?i[a.group]?i[a.group].push(s):i[a.group]=[s]:n.push(s),i),{});return Object.keys(r).forEach(i=>{t.push(...r[i].map(a=>e[a]))}),t.push(...n.map(i=>e[i])),t}function Ige(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))}const $ge=typeof window<"u"?I.exports.useLayoutEffect:I.exports.useEffect;function Tge(e){function t(r){const i=Object.keys(r).reduce((a,s)=>(a[`${e}:${s}`]=o=>r[s](o.detail),a),{});$ge(()=>(Object.keys(i).forEach(a=>{window.removeEventListener(a,i[a]),window.addEventListener(a,i[a])}),()=>Object.keys(i).forEach(a=>{window.removeEventListener(a,i[a])})),[i])}function n(r){return(...i)=>Ige(`${e}:${String(r)}`,i[0])}return[t,n]}function A1(e){return Array.isArray(e)||e===null?!1:typeof e=="object"?e.type!==Ni.Fragment:!1}function Q9(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=Q9(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function eq(){for(var e=0,t,n,r="";e<arguments.length;)(t=arguments[e++])&&(n=Q9(t))&&(r&&(r+=" "),r+=n);return r}const tq={dark:["#C1C2C5","#A6A7AB","#909296","#5c5f66","#373A40","#2C2E33","#25262b","#1A1B1E","#141517","#101113"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]};function Nge(e){return()=>({fontFamily:e.fontFamily||"sans-serif"})}var Ege=Object.defineProperty,L4=Object.getOwnPropertySymbols,Oge=Object.prototype.hasOwnProperty,Pge=Object.prototype.propertyIsEnumerable,F4=(e,t,n)=>t in e?Ege(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,z4=(e,t)=>{for(var n in t||(t={}))Oge.call(t,n)&&F4(e,n,t[n]);if(L4)for(var n of L4(t))Pge.call(t,n)&&F4(e,n,t[n]);return e};function Age(e){return t=>({WebkitTapHighlightColor:"transparent",[t||"&:focus"]:z4({},e.focusRing==="always"||e.focusRing==="auto"?e.focusRingStyles.styles(e):e.focusRingStyles.resetStyles(e)),[t?t.replace(":focus",":focus:not(:focus-visible)"):"&:focus:not(:focus-visible)"]:z4({},e.focusRing==="auto"||e.focusRing==="never"?e.focusRingStyles.resetStyles(e):null)})}function M1(e){return t=>typeof e.primaryShade=="number"?e.primaryShade:e.primaryShade[t||e.colorScheme]}function HM(e){const t=M1(e);return(n,r,i=!0,a=!0)=>{if(typeof n=="string"&&n.includes(".")){const[o,l]=n.split("."),u=parseInt(l,10);if(o in e.colors&&u>=0&&u<10)return e.colors[o][typeof r=="number"&&!a?r:u]}const s=typeof r=="number"?r:t();return n in e.colors?e.colors[n][s]:i?e.colors[e.primaryColor][s]:n}}function nq(e){let t="";for(let n=1;n<e.length-1;n+=1)t+=`${e[n]} ${n/(e.length-1)*100}%, `;return`${e[0]} 0%, ${t}${e[e.length-1]} 100%`}function Mge(e,...t){return`linear-gradient(${e}deg, ${nq(t)})`}function Rge(...e){return`radial-gradient(circle, ${nq(e)})`}function rq(e){const t=HM(e),n=M1(e);return r=>{const i={from:(r==null?void 0:r.from)||e.defaultGradient.from,to:(r==null?void 0:r.to)||e.defaultGradient.to,deg:(r==null?void 0:r.deg)||e.defaultGradient.deg};return`linear-gradient(${i.deg}deg, ${t(i.from,n(),!1)} 0%, ${t(i.to,n(),!1)} 100%)`}}function iq(e){return t=>{if(typeof t=="number")return`${t/16}${e}`;if(typeof t=="string"){const n=t.replace("px","");if(!Number.isNaN(Number(n)))return`${Number(n)/16}${e}`}return t}}const G=iq("rem"),Gc=iq("em");function ke({size:e,sizes:t,units:n}){return e in t?t[e]:typeof e=="number"?n==="em"?Gc(e):G(e):e||t.md}function Go(e){return typeof e=="number"?e:typeof e=="string"&&e.includes("rem")?Number(e.replace("rem",""))*16:typeof e=="string"&&e.includes("em")?Number(e.replace("em",""))*16:Number(e)}function Dge(e){return t=>`@media (min-width: ${Gc(Go(ke({size:t,sizes:e.breakpoints})))})`}function Lge(e){return t=>`@media (max-width: ${Gc(Go(ke({size:t,sizes:e.breakpoints}))-1)})`}function Fge(e){return/^#?([0-9A-F]{3}){1,2}$/i.test(e)}function zge(e){let t=e.replace("#","");if(t.length===3){const s=t.split("");t=[s[0],s[0],s[1],s[1],s[2],s[2]].join("")}const n=parseInt(t,16),r=n>>16&255,i=n>>8&255,a=n&255;return{r,g:i,b:a,a:1}}function Bge(e){const[t,n,r,i]=e.replace(/[^0-9,.]/g,"").split(",").map(Number);return{r:t,g:n,b:r,a:i||1}}function GM(e){return Fge(e)?zge(e):e.startsWith("rgb")?Bge(e):{r:0,g:0,b:0,a:1}}function Vm(e,t){if(typeof e!="string"||t>1||t<0)return"rgba(0, 0, 0, 1)";if(e.startsWith("var(--"))return e;const{r:n,g:r,b:i}=GM(e);return`rgba(${n}, ${r}, ${i}, ${t})`}function Wge(e=0){return{position:"absolute",top:G(e),right:G(e),left:G(e),bottom:G(e)}}function Vge(e,t){if(typeof e=="string"&&e.startsWith("var(--"))return e;const{r:n,g:r,b:i,a}=GM(e),s=1-t,o=l=>Math.round(l*s);return`rgba(${o(n)}, ${o(r)}, ${o(i)}, ${a})`}function jge(e,t){if(typeof e=="string"&&e.startsWith("var(--"))return e;const{r:n,g:r,b:i,a}=GM(e),s=o=>Math.round(o+(255-o)*t);return`rgba(${s(n)}, ${s(r)}, ${s(i)}, ${a})`}function Uge(e){return t=>{if(typeof t=="number")return G(t);const n=typeof e.defaultRadius=="number"?e.defaultRadius:e.radius[e.defaultRadius]||e.defaultRadius;return e.radius[t]||t||n}}function Hge(e,t){if(typeof e=="string"&&e.includes(".")){const[n,r]=e.split("."),i=parseInt(r,10);if(n in t.colors&&i>=0&&i<10)return{isSplittedColor:!0,key:n,shade:i}}return{isSplittedColor:!1}}function Gge(e){const t=HM(e),n=M1(e),r=rq(e);return({variant:i,color:a,gradient:s,primaryFallback:o})=>{const l=Hge(a,e);switch(i){case"light":return{border:"transparent",background:Vm(t(a,e.colorScheme==="dark"?8:0,o,!1),e.colorScheme==="dark"?.2:1),color:a==="dark"?e.colorScheme==="dark"?e.colors.dark[0]:e.colors.dark[9]:t(a,e.colorScheme==="dark"?2:n("light")),hover:Vm(t(a,e.colorScheme==="dark"?7:1,o,!1),e.colorScheme==="dark"?.25:.65)};case"subtle":return{border:"transparent",background:"transparent",color:a==="dark"?e.colorScheme==="dark"?e.colors.dark[0]:e.colors.dark[9]:t(a,e.colorScheme==="dark"?2:n("light")),hover:Vm(t(a,e.colorScheme==="dark"?8:0,o,!1),e.colorScheme==="dark"?.2:1)};case"outline":return{border:t(a,e.colorScheme==="dark"?5:n("light")),background:"transparent",color:t(a,e.colorScheme==="dark"?5:n("light")),hover:e.colorScheme==="dark"?Vm(t(a,5,o,!1),.05):Vm(t(a,0,o,!1),.35)};case"default":return{border:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4],background:e.colorScheme==="dark"?e.colors.dark[6]:e.white,color:e.colorScheme==="dark"?e.white:e.black,hover:e.colorScheme==="dark"?e.colors.dark[5]:e.colors.gray[0]};case"white":return{border:"transparent",background:e.white,color:t(a,n()),hover:null};case"transparent":return{border:"transparent",color:a==="dark"?e.colorScheme==="dark"?e.colors.dark[0]:e.colors.dark[9]:t(a,e.colorScheme==="dark"?2:n("light")),background:"transparent",hover:null};case"gradient":return{background:r(s),color:e.white,border:"transparent",hover:null};default:{const u=n(),c=l.isSplittedColor?l.shade:u,d=l.isSplittedColor?l.key:a;return{border:"transparent",background:t(d,c,o),color:e.white,hover:t(d,c===9?8:c+1)}}}}}function qge(e){return t=>{const n=M1(e)(t);return e.colors[e.primaryColor][n]}}function Kge(e){return{"@media (hover: hover)":{"&:hover":e},"@media (hover: none)":{"&:active":e}}}function Zge(e){return()=>({userSelect:"none",color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5]})}function Xge(e){return()=>e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[6]}const ai={fontStyles:Nge,themeColor:HM,focusStyles:Age,linearGradient:Mge,radialGradient:Rge,smallerThan:Lge,largerThan:Dge,rgba:Vm,cover:Wge,darken:Vge,lighten:jge,radius:Uge,variant:Gge,primaryShade:M1,hover:Kge,gradient:rq,primaryColor:qge,placeholderStyles:Zge,dimmed:Xge};var Jge=Object.defineProperty,Yge=Object.defineProperties,Qge=Object.getOwnPropertyDescriptors,B4=Object.getOwnPropertySymbols,eye=Object.prototype.hasOwnProperty,tye=Object.prototype.propertyIsEnumerable,W4=(e,t,n)=>t in e?Jge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nye=(e,t)=>{for(var n in t||(t={}))eye.call(t,n)&&W4(e,n,t[n]);if(B4)for(var n of B4(t))tye.call(t,n)&&W4(e,n,t[n]);return e},rye=(e,t)=>Yge(e,Qge(t));function aq(e){return rye(nye({},e),{fn:{fontStyles:ai.fontStyles(e),themeColor:ai.themeColor(e),focusStyles:ai.focusStyles(e),largerThan:ai.largerThan(e),smallerThan:ai.smallerThan(e),radialGradient:ai.radialGradient,linearGradient:ai.linearGradient,gradient:ai.gradient(e),rgba:ai.rgba,cover:ai.cover,lighten:ai.lighten,darken:ai.darken,primaryShade:ai.primaryShade(e),radius:ai.radius(e),variant:ai.variant(e),hover:ai.hover,primaryColor:ai.primaryColor(e),placeholderStyles:ai.placeholderStyles(e),dimmed:ai.dimmed(e)}})}Object.keys(tq);const iye={dir:"ltr",primaryShade:{light:6,dark:8},focusRing:"auto",loader:"oval",colorScheme:"light",white:"#fff",black:"#000",defaultRadius:"sm",transitionTimingFunction:"ease",colors:tq,lineHeight:1.55,fontFamily:"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",primaryColor:"blue",respectReducedMotion:!0,cursorType:"default",defaultGradient:{from:"indigo",to:"cyan",deg:45},shadows:{xs:"0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.05), 0 0.0625rem 0.125rem rgba(0, 0, 0, 0.1)",sm:"0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 0.625rem 0.9375rem -0.3125rem, rgba(0, 0, 0, 0.04) 0 0.4375rem 0.4375rem -0.3125rem",md:"0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 1.25rem 1.5625rem -0.3125rem, rgba(0, 0, 0, 0.04) 0 0.625rem 0.625rem -0.3125rem",lg:"0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 1.75rem 1.4375rem -0.4375rem, rgba(0, 0, 0, 0.04) 0 0.75rem 0.75rem -0.4375rem",xl:"0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 2.25rem 1.75rem -0.4375rem, rgba(0, 0, 0, 0.04) 0 1.0625rem 1.0625rem -0.4375rem"},fontSizes:{xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem"},radius:{xs:"0.125rem",sm:"0.25rem",md:"0.5rem",lg:"1rem",xl:"2rem"},spacing:{xs:"0.625rem",sm:"0.75rem",md:"1rem",lg:"1.25rem",xl:"1.5rem"},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},headings:{fontFamily:"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",fontWeight:700,sizes:{h1:{fontSize:"2.125rem",lineHeight:1.3,fontWeight:void 0},h2:{fontSize:"1.625rem",lineHeight:1.35,fontWeight:void 0},h3:{fontSize:"1.375rem",lineHeight:1.4,fontWeight:void 0},h4:{fontSize:"1.125rem",lineHeight:1.45,fontWeight:void 0},h5:{fontSize:"1rem",lineHeight:1.5,fontWeight:void 0},h6:{fontSize:"0.875rem",lineHeight:1.5,fontWeight:void 0}}},other:{},components:{},activeStyles:{transform:"translateY(0.0625rem)"},datesLocale:"en",globalStyles:void 0,focusRingStyles:{styles:e=>({outlineOffset:"0.125rem",outline:`0.125rem solid ${e.colors[e.primaryColor][e.colorScheme==="dark"?7:5]}`}),resetStyles:()=>({outline:"none"}),inputStyles:e=>({outline:"none",borderColor:e.colors[e.primaryColor][typeof e.primaryShade=="object"?e.primaryShade[e.colorScheme]:e.primaryShade]})}},qM=aq(iye);function aye(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function sye(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var oye=function(){function e(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?r.insertionPoint?a=r.insertionPoint.nextSibling:r.prepend?a=r.container.firstChild:a=r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(sye(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=aye(i);try{a.insertRule(r,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},e}(),oa="-ms-",Kk="-moz-",_n="-webkit-",sq="comm",KM="rule",ZM="decl",lye="@import",oq="@keyframes",uye="@layer",cye=Math.abs,h2=String.fromCharCode,dye=Object.assign;function pye(e,t){return Hi(e,0)^45?(((t<<2^Hi(e,0))<<2^Hi(e,1))<<2^Hi(e,2))<<2^Hi(e,3):0}function lq(e){return e.trim()}function hye(e,t){return(e=t.exec(e))?e[0]:e}function kn(e,t,n){return e.replace(t,n)}function WO(e,t){return e.indexOf(t)}function Hi(e,t){return e.charCodeAt(t)|0}function Zb(e,t,n){return e.slice(t,n)}function bl(e){return e.length}function XM(e){return e.length}function Dx(e,t){return t.push(e),e}function fye(e,t){return e.map(t).join("")}var f2=1,Bg=1,uq=0,fs=0,Kr=0,$y="";function m2(e,t,n,r,i,a,s){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:f2,column:Bg,length:s,return:""}}function N0(e,t){return dye(m2("",null,null,"",null,null,0),e,{length:-e.length},t)}function mye(){return Kr}function gye(){return Kr=fs>0?Hi($y,--fs):0,Bg--,Kr===10&&(Bg=1,f2--),Kr}function Ps(){return Kr=fs<uq?Hi($y,fs++):0,Bg++,Kr===10&&(Bg=1,f2++),Kr}function Dl(){return Hi($y,fs)}function q_(){return fs}function R1(e,t){return Zb($y,e,t)}function Xb(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function cq(e){return f2=Bg=1,uq=bl($y=e),fs=0,[]}function dq(e){return $y="",e}function K_(e){return lq(R1(fs-1,VO(e===91?e+2:e===40?e+1:e)))}function yye(e){for(;(Kr=Dl())&&Kr<33;)Ps();return Xb(e)>2||Xb(Kr)>3?"":" "}function vye(e,t){for(;--t&&Ps()&&!(Kr<48||Kr>102||Kr>57&&Kr<65||Kr>70&&Kr<97););return R1(e,q_()+(t<6&&Dl()==32&&Ps()==32))}function VO(e){for(;Ps();)switch(Kr){case e:return fs;case 34:case 39:e!==34&&e!==39&&VO(Kr);break;case 40:e===41&&VO(e);break;case 92:Ps();break}return fs}function bye(e,t){for(;Ps()&&e+Kr!==47+10;)if(e+Kr===42+42&&Dl()===47)break;return"/*"+R1(t,fs-1)+"*"+h2(e===47?e:Ps())}function wye(e){for(;!Xb(Dl());)Ps();return R1(e,fs)}function xye(e){return dq(Z_("",null,null,null,[""],e=cq(e),0,[0],e))}function Z_(e,t,n,r,i,a,s,o,l){for(var u=0,c=0,d=s,p=0,h=0,m=0,g=1,v=1,y=1,b=0,_="",k=i,C=a,$=r,N=_;v;)switch(m=b,b=Ps()){case 40:if(m!=108&&Hi(N,d-1)==58){WO(N+=kn(K_(b),"&","&\f"),"&\f")!=-1&&(y=-1);break}case 34:case 39:case 91:N+=K_(b);break;case 9:case 10:case 13:case 32:N+=yye(m);break;case 92:N+=vye(q_()-1,7);continue;case 47:switch(Dl()){case 42:case 47:Dx(_ye(bye(Ps(),q_()),t,n),l);break;default:N+="/"}break;case 123*g:o[u++]=bl(N)*y;case 125*g:case 59:case 0:switch(b){case 0:case 125:v=0;case 59+c:y==-1&&(N=kn(N,/\f/g,"")),h>0&&bl(N)-d&&Dx(h>32?j4(N+";",r,n,d-1):j4(kn(N," ","")+";",r,n,d-2),l);break;case 59:N+=";";default:if(Dx($=V4(N,t,n,u,c,i,o,_,k=[],C=[],d),a),b===123)if(c===0)Z_(N,t,$,$,k,a,d,o,C);else switch(p===99&&Hi(N,3)===110?100:p){case 100:case 108:case 109:case 115:Z_(e,$,$,r&&Dx(V4(e,$,$,0,0,i,o,_,i,k=[],d),C),i,C,d,o,r?k:C);break;default:Z_(N,$,$,$,[""],C,0,o,C)}}u=c=h=0,g=y=1,_=N="",d=s;break;case 58:d=1+bl(N),h=m;default:if(g<1){if(b==123)--g;else if(b==125&&g++==0&&gye()==125)continue}switch(N+=h2(b),b*g){case 38:y=c>0?1:(N+="\f",-1);break;case 44:o[u++]=(bl(N)-1)*y,y=1;break;case 64:Dl()===45&&(N+=K_(Ps())),p=Dl(),c=d=bl(_=N+=wye(q_())),b++;break;case 45:m===45&&bl(N)==2&&(g=0)}}return a}function V4(e,t,n,r,i,a,s,o,l,u,c){for(var d=i-1,p=i===0?a:[""],h=XM(p),m=0,g=0,v=0;m<r;++m)for(var y=0,b=Zb(e,d+1,d=cye(g=s[m])),_=e;y<h;++y)(_=lq(g>0?p[y]+" "+b:kn(b,/&\f/g,p[y])))&&(l[v++]=_);return m2(e,t,n,i===0?KM:o,l,u,c)}function _ye(e,t,n){return m2(e,t,n,sq,h2(mye()),Zb(e,2,-2),0)}function j4(e,t,n,r){return m2(e,t,n,ZM,Zb(e,0,r),Zb(e,r+1,-1),r)}function yg(e,t){for(var n="",r=XM(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function kye(e,t,n,r){switch(e.type){case uye:if(e.children.length)break;case lye:case ZM:return e.return=e.return||e.value;case sq:return"";case oq:return e.return=e.value+"{"+yg(e.children,r)+"}";case KM:e.value=e.props.join(",")}return bl(n=yg(e.children,r))?e.return=e.value+"{"+n+"}":""}function Sye(e){var t=XM(e);return function(n,r,i,a){for(var s="",o=0;o<t;o++)s+=e[o](n,r,i,a)||"";return s}}function Cye(e){return function(t){t.root||(t=t.return)&&e(t)}}var U4=function(t){var n=new WeakMap;return function(r){if(n.has(r))return n.get(r);var i=t(r);return n.set(r,i),i}};function Iye(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var $ye=function(t,n,r){for(var i=0,a=0;i=a,a=Dl(),i===38&&a===12&&(n[r]=1),!Xb(a);)Ps();return R1(t,fs)},Tye=function(t,n){var r=-1,i=44;do switch(Xb(i)){case 0:i===38&&Dl()===12&&(n[r]=1),t[r]+=$ye(fs-1,n,r);break;case 2:t[r]+=K_(i);break;case 4:if(i===44){t[++r]=Dl()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=h2(i)}while(i=Ps());return t},Nye=function(t,n){return dq(Tye(cq(t),n))},H4=new WeakMap,Eye=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,r=t.parent,i=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!H4.get(r))&&!i){H4.set(t,!0);for(var a=[],s=Nye(n,a),o=r.props,l=0,u=0;l<s.length;l++)for(var c=0;c<o.length;c++,u++)t.props[u]=a[l]?s[l].replace(/&\f/g,o[c]):o[c]+" "+s[l]}}},Oye=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function pq(e,t){switch(pye(e,t)){case 5103:return _n+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return _n+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return _n+e+Kk+e+oa+e+e;case 6828:case 4268:return _n+e+oa+e+e;case 6165:return _n+e+oa+"flex-"+e+e;case 5187:return _n+e+kn(e,/(\w+).+(:[^]+)/,_n+"box-$1$2"+oa+"flex-$1$2")+e;case 5443:return _n+e+oa+"flex-item-"+kn(e,/flex-|-self/,"")+e;case 4675:return _n+e+oa+"flex-line-pack"+kn(e,/align-content|flex-|-self/,"")+e;case 5548:return _n+e+oa+kn(e,"shrink","negative")+e;case 5292:return _n+e+oa+kn(e,"basis","preferred-size")+e;case 6060:return _n+"box-"+kn(e,"-grow","")+_n+e+oa+kn(e,"grow","positive")+e;case 4554:return _n+kn(e,/([^-])(transform)/g,"$1"+_n+"$2")+e;case 6187:return kn(kn(kn(e,/(zoom-|grab)/,_n+"$1"),/(image-set)/,_n+"$1"),e,"")+e;case 5495:case 3959:return kn(e,/(image-set\([^]*)/,_n+"$1$`$1");case 4968:return kn(kn(e,/(.+:)(flex-)?(.*)/,_n+"box-pack:$3"+oa+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+_n+e+e;case 4095:case 3583:case 4068:case 2532:return kn(e,/(.+)-inline(.+)/,_n+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(bl(e)-1-t>6)switch(Hi(e,t+1)){case 109:if(Hi(e,t+4)!==45)break;case 102:return kn(e,/(.+:)(.+)-([^]+)/,"$1"+_n+"$2-$3$1"+Kk+(Hi(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~WO(e,"stretch")?pq(kn(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Hi(e,t+1)!==115)break;case 6444:switch(Hi(e,bl(e)-3-(~WO(e,"!important")&&10))){case 107:return kn(e,":",":"+_n)+e;case 101:return kn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+_n+(Hi(e,14)===45?"inline-":"")+"box$3$1"+_n+"$2$3$1"+oa+"$2box$3")+e}break;case 5936:switch(Hi(e,t+11)){case 114:return _n+e+oa+kn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return _n+e+oa+kn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return _n+e+oa+kn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return _n+e+oa+e+e}return e}var Pye=function(t,n,r,i){if(t.length>-1&&!t.return)switch(t.type){case ZM:t.return=pq(t.value,t.length);break;case oq:return yg([N0(t,{value:kn(t.value,"@","@"+_n)})],i);case KM:if(t.length)return fye(t.props,function(a){switch(hye(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return yg([N0(t,{props:[kn(a,/:(read-\w+)/,":"+Kk+"$1")]})],i);case"::placeholder":return yg([N0(t,{props:[kn(a,/:(plac\w+)/,":"+_n+"input-$1")]}),N0(t,{props:[kn(a,/:(plac\w+)/,":"+Kk+"$1")]}),N0(t,{props:[kn(a,/:(plac\w+)/,oa+"input-$1")]})],i)}return""})}},Aye=[Pye],hq=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(g){var v=g.getAttribute("data-emotion");v.indexOf(" ")!==-1&&(document.head.appendChild(g),g.setAttribute("data-s",""))})}var i=t.stylisPlugins||Aye,a={},s,o=[];s=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(g){for(var v=g.getAttribute("data-emotion").split(" "),y=1;y<v.length;y++)a[v[y]]=!0;o.push(g)});var l,u=[Eye,Oye];{var c,d=[kye,Cye(function(g){c.insert(g)})],p=Sye(u.concat(i,d)),h=function(v){return yg(xye(v),p)};l=function(v,y,b,_){c=b,h(v?v+"{"+y.styles+"}":y.styles),_&&(m.inserted[y.name]=!0)}}var m={key:n,sheet:new oye({key:n,container:s,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:a,registered:{},insert:l};return m.sheet.hydrate(o),m};function ar(){return ar=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ar.apply(this,arguments)}var fq={exports:{}},Un={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ri=typeof Symbol=="function"&&Symbol.for,JM=Ri?Symbol.for("react.element"):60103,YM=Ri?Symbol.for("react.portal"):60106,g2=Ri?Symbol.for("react.fragment"):60107,y2=Ri?Symbol.for("react.strict_mode"):60108,v2=Ri?Symbol.for("react.profiler"):60114,b2=Ri?Symbol.for("react.provider"):60109,w2=Ri?Symbol.for("react.context"):60110,QM=Ri?Symbol.for("react.async_mode"):60111,x2=Ri?Symbol.for("react.concurrent_mode"):60111,_2=Ri?Symbol.for("react.forward_ref"):60112,k2=Ri?Symbol.for("react.suspense"):60113,Mye=Ri?Symbol.for("react.suspense_list"):60120,S2=Ri?Symbol.for("react.memo"):60115,C2=Ri?Symbol.for("react.lazy"):60116,Rye=Ri?Symbol.for("react.block"):60121,Dye=Ri?Symbol.for("react.fundamental"):60117,Lye=Ri?Symbol.for("react.responder"):60118,Fye=Ri?Symbol.for("react.scope"):60119;function Vs(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case JM:switch(e=e.type,e){case QM:case x2:case g2:case v2:case y2:case k2:return e;default:switch(e=e&&e.$$typeof,e){case w2:case _2:case C2:case S2:case b2:return e;default:return t}}case YM:return t}}}function mq(e){return Vs(e)===x2}Un.AsyncMode=QM;Un.ConcurrentMode=x2;Un.ContextConsumer=w2;Un.ContextProvider=b2;Un.Element=JM;Un.ForwardRef=_2;Un.Fragment=g2;Un.Lazy=C2;Un.Memo=S2;Un.Portal=YM;Un.Profiler=v2;Un.StrictMode=y2;Un.Suspense=k2;Un.isAsyncMode=function(e){return mq(e)||Vs(e)===QM};Un.isConcurrentMode=mq;Un.isContextConsumer=function(e){return Vs(e)===w2};Un.isContextProvider=function(e){return Vs(e)===b2};Un.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===JM};Un.isForwardRef=function(e){return Vs(e)===_2};Un.isFragment=function(e){return Vs(e)===g2};Un.isLazy=function(e){return Vs(e)===C2};Un.isMemo=function(e){return Vs(e)===S2};Un.isPortal=function(e){return Vs(e)===YM};Un.isProfiler=function(e){return Vs(e)===v2};Un.isStrictMode=function(e){return Vs(e)===y2};Un.isSuspense=function(e){return Vs(e)===k2};Un.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===g2||e===x2||e===v2||e===y2||e===k2||e===Mye||typeof e=="object"&&e!==null&&(e.$$typeof===C2||e.$$typeof===S2||e.$$typeof===b2||e.$$typeof===w2||e.$$typeof===_2||e.$$typeof===Dye||e.$$typeof===Lye||e.$$typeof===Fye||e.$$typeof===Rye)};Un.typeOf=Vs;(function(e){e.exports=Un})(fq);var gq=fq.exports,zye={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Bye={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},yq={};yq[gq.ForwardRef]=zye;yq[gq.Memo]=Bye;var Wye=!0;function Vye(e,t,n){var r="";return n.split(" ").forEach(function(i){e[i]!==void 0?t.push(e[i]+";"):r+=i+" "}),r}var jye=function(t,n,r){var i=t.key+"-"+n.name;(r===!1||Wye===!1)&&t.registered[i]===void 0&&(t.registered[i]=n.styles)},vq=function(t,n,r){jye(t,n,r);var i=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var a=n;do t.insert(n===a?"."+i:"",a,t.sheet,!0),a=a.next;while(a!==void 0)}};function Uye(e){for(var t=0,n,r=0,i=e.length;i>=4;++r,i-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(i){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var bq={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Hye=/[A-Z]|^ms/g,Gye=/_EMO_([^_]+?)_([^]*?)_EMO_/g,wq=function(t){return t.charCodeAt(1)===45},G4=function(t){return t!=null&&typeof t!="boolean"},kN=Iye(function(e){return wq(e)?e:e.replace(Hye,"-$&").toLowerCase()}),q4=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(Gye,function(r,i,a){return wl={name:i,styles:a,next:wl},i})}return bq[t]!==1&&!wq(t)&&typeof n=="number"&&n!==0?n+"px":n};function Jb(e,t,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return wl={name:n.name,styles:n.styles,next:wl},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)wl={name:r.name,styles:r.styles,next:wl},r=r.next;var i=n.styles+";";return i}return qye(e,t,n)}case"function":{if(e!==void 0){var a=wl,s=n(e);return wl=a,Jb(e,t,s)}break}}if(t==null)return n;var o=t[n];return o!==void 0?o:n}function qye(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=Jb(e,t,n[i])+";";else for(var a in n){var s=n[a];if(typeof s!="object")t!=null&&t[s]!==void 0?r+=a+"{"+t[s]+"}":G4(s)&&(r+=kN(a)+":"+q4(a,s)+";");else if(Array.isArray(s)&&typeof s[0]=="string"&&(t==null||t[s[0]]===void 0))for(var o=0;o<s.length;o++)G4(s[o])&&(r+=kN(a)+":"+q4(a,s[o])+";");else{var l=Jb(e,t,s);switch(a){case"animation":case"animationName":{r+=kN(a)+":"+l+";";break}default:r+=a+"{"+l+"}"}}}return r}var K4=/label:\s*([^\s;\n{]+)\s*(;|$)/g,wl,xq=function(t,n,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var i=!0,a="";wl=void 0;var s=t[0];s==null||s.raw===void 0?(i=!1,a+=Jb(r,n,s)):a+=s[0];for(var o=1;o<t.length;o++)a+=Jb(r,n,t[o]),i&&(a+=s[o]);K4.lastIndex=0;for(var l="",u;(u=K4.exec(a))!==null;)l+="-"+u[1];var c=Uye(a)+l;return{name:c,styles:a,next:wl}},Kye=jp["useInsertionEffect"]?jp["useInsertionEffect"]:!1,Z4=Kye||I.exports.useLayoutEffect,_q=I.exports.createContext(typeof HTMLElement<"u"?hq({key:"css"}):null);_q.Provider;var Zye=function(t){return I.exports.forwardRef(function(n,r){var i=I.exports.useContext(_q);return t(n,i,r)})},jO=I.exports.createContext({}),Xye=function(t,n){if(typeof n=="function"){var r=n(t);return r}return ar({},t,n)},Jye=U4(function(e){return U4(function(t){return Xye(e,t)})}),Yye=function(t){var n=I.exports.useContext(jO);return t.theme!==n&&(n=Jye(n)(t.theme)),x(jO.Provider,{value:n,children:t.children})},I2=Zye(function(e,t){var n=e.styles,r=xq([n],void 0,I.exports.useContext(jO)),i=I.exports.useRef();return Z4(function(){var a=t.key+"-global",s=new t.sheet.constructor({key:a,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),o=!1,l=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return t.sheet.tags.length&&(s.before=t.sheet.tags[0]),l!==null&&(o=!0,l.setAttribute("data-emotion",a),s.hydrate([l])),i.current=[s,o],function(){s.flush()}},[t]),Z4(function(){var a=i.current,s=a[0],o=a[1];if(o){a[1]=!1;return}if(r.next!==void 0&&vq(t,r.next,!0),s.tags.length){var l=s.tags[s.tags.length-1].nextElementSibling;s.before=l,s.flush()}t.insert("",r,s,!1)},[t,r.name]),null}),Qye=Object.defineProperty,eve=Object.defineProperties,tve=Object.getOwnPropertyDescriptors,X4=Object.getOwnPropertySymbols,nve=Object.prototype.hasOwnProperty,rve=Object.prototype.propertyIsEnumerable,J4=(e,t,n)=>t in e?Qye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ive=(e,t)=>{for(var n in t||(t={}))nve.call(t,n)&&J4(e,n,t[n]);if(X4)for(var n of X4(t))rve.call(t,n)&&J4(e,n,t[n]);return e},ave=(e,t)=>eve(e,tve(t));function sve({theme:e}){return x(I2,{styles:{"*, *::before, *::after":{boxSizing:"border-box"},html:{colorScheme:e.colorScheme==="dark"?"dark":"light"},body:ave(ive({},e.fn.fontStyles()),{backgroundColor:e.colorScheme==="dark"?e.colors.dark[7]:e.white,color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,lineHeight:e.lineHeight,fontSize:e.fontSizes.md,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"})}})}function E0(e,t,n,r=G){Object.keys(t).forEach(i=>{e[`--mantine-${n}-${i}`]=r(t[i])})}function ove({theme:e}){const t={"--mantine-color-white":e.white,"--mantine-color-black":e.black,"--mantine-transition-timing-function":e.transitionTimingFunction,"--mantine-line-height":`${e.lineHeight}`,"--mantine-font-family":e.fontFamily,"--mantine-font-family-monospace":e.fontFamilyMonospace,"--mantine-font-family-headings":e.headings.fontFamily,"--mantine-heading-font-weight":`${e.headings.fontWeight}`};E0(t,e.shadows,"shadow"),E0(t,e.fontSizes,"font-size"),E0(t,e.radius,"radius"),E0(t,e.spacing,"spacing"),E0(t,e.breakpoints,"breakpoints",Gc),Object.keys(e.colors).forEach(r=>{e.colors[r].forEach((i,a)=>{t[`--mantine-color-${r}-${a}`]=i})});const n=e.headings.sizes;return Object.keys(n).forEach(r=>{t[`--mantine-${r}-font-size`]=n[r].fontSize,t[`--mantine-${r}-line-height`]=`${n[r].lineHeight}`}),x(I2,{styles:{":root":t}})}var lve=Object.defineProperty,uve=Object.defineProperties,cve=Object.getOwnPropertyDescriptors,Y4=Object.getOwnPropertySymbols,dve=Object.prototype.hasOwnProperty,pve=Object.prototype.propertyIsEnumerable,Q4=(e,t,n)=>t in e?lve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pl=(e,t)=>{for(var n in t||(t={}))dve.call(t,n)&&Q4(e,n,t[n]);if(Y4)for(var n of Y4(t))pve.call(t,n)&&Q4(e,n,t[n]);return e},SN=(e,t)=>uve(e,cve(t));function hve(e,t){var n;if(!t)return e;const r=Object.keys(e).reduce((i,a)=>{if(a==="headings"&&t.headings){const s=t.headings.sizes?Object.keys(e.headings.sizes).reduce((o,l)=>(o[l]=pl(pl({},e.headings.sizes[l]),t.headings.sizes[l]),o),{}):e.headings.sizes;return SN(pl({},i),{headings:SN(pl(pl({},e.headings),t.headings),{sizes:s})})}if(a==="breakpoints"&&t.breakpoints){const s=pl(pl({},e.breakpoints),t.breakpoints);return SN(pl({},i),{breakpoints:Object.fromEntries(Object.entries(s).sort((o,l)=>Go(o[1])-Go(l[1])))})}return i[a]=typeof t[a]=="object"?pl(pl({},e[a]),t[a]):typeof t[a]=="number"||typeof t[a]=="boolean"||typeof t[a]=="function"?t[a]:t[a]||e[a],i},{});if((t==null?void 0:t.fontFamily)&&!((n=t==null?void 0:t.headings)!=null&&n.fontFamily)&&(r.headings.fontFamily=t.fontFamily),!(r.primaryColor in r.colors))throw new Error("MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more \u2013 https://mantine.dev/theming/colors/#primary-color");return r}function fve(e,t){return aq(hve(e,t))}function kq(e){return Object.keys(e).reduce((t,n)=>(e[n]!==void 0&&(t[n]=e[n]),t),{})}const mve={html:{fontFamily:"sans-serif",lineHeight:"1.15",textSizeAdjust:"100%"},body:{margin:0},"article, aside, footer, header, nav, section, figcaption, figure, main":{display:"block"},h1:{fontSize:"2em"},hr:{boxSizing:"content-box",height:0,overflow:"visible"},pre:{fontFamily:"monospace, monospace",fontSize:"1em"},a:{background:"transparent",textDecorationSkip:"objects"},"a:active, a:hover":{outlineWidth:0},"abbr[title]":{borderBottom:"none",textDecoration:"underline"},"b, strong":{fontWeight:"bolder"},"code, kbp, samp":{fontFamily:"monospace, monospace",fontSize:"1em"},dfn:{fontStyle:"italic"},mark:{backgroundColor:"#ff0",color:"#000"},small:{fontSize:"80%"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},"audio, video":{display:"inline-block"},"audio:not([controls])":{display:"none",height:0},img:{borderStyle:"none",verticalAlign:"middle"},"svg:not(:root)":{overflow:"hidden"},"button, input, optgroup, select, textarea":{fontFamily:"sans-serif",fontSize:"100%",lineHeight:"1.15",margin:0},"button, input":{overflow:"visible"},"button, select":{textTransform:"none"},"button, [type=reset], [type=submit]":{WebkitAppearance:"button"},"button::-moz-focus-inner, [type=button]::-moz-focus-inner, [type=reset]::-moz-focus-inner, [type=submit]::-moz-focus-inner":{borderStyle:"none",padding:0},"button:-moz-focusring, [type=button]:-moz-focusring, [type=reset]:-moz-focusring, [type=submit]:-moz-focusring":{outline:`${G(1)} dotted ButtonText`},legend:{boxSizing:"border-box",color:"inherit",display:"table",maxWidth:"100%",padding:0,whiteSpace:"normal"},progress:{display:"inline-block",verticalAlign:"baseline"},textarea:{overflow:"auto"},"[type=checkbox], [type=radio]":{boxSizing:"border-box",padding:0},"[type=number]::-webkit-inner-spin-button, [type=number]::-webkit-outer-spin-button":{height:"auto"},"[type=search]":{appearance:"none"},"[type=search]::-webkit-search-cancel-button, [type=search]::-webkit-search-decoration":{appearance:"none"},"::-webkit-file-upload-button":{appearance:"button",font:"inherit"},"details, menu":{display:"block"},summary:{display:"list-item"},canvas:{display:"inline-block"},template:{display:"none"}};function gve(){return x(I2,{styles:mve})}var yve=Object.defineProperty,e5=Object.getOwnPropertySymbols,vve=Object.prototype.hasOwnProperty,bve=Object.prototype.propertyIsEnumerable,t5=(e,t,n)=>t in e?yve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,wb=(e,t)=>{for(var n in t||(t={}))vve.call(t,n)&&t5(e,n,t[n]);if(e5)for(var n of e5(t))bve.call(t,n)&&t5(e,n,t[n]);return e};const Zk=I.exports.createContext({theme:qM});function Ka(){var e;return((e=I.exports.useContext(Zk))==null?void 0:e.theme)||qM}function wve(e){const t=Ka(),n=r=>{var i,a,s,o;return{styles:((i=t.components[r])==null?void 0:i.styles)||{},classNames:((a=t.components[r])==null?void 0:a.classNames)||{},variants:(s=t.components[r])==null?void 0:s.variants,sizes:(o=t.components[r])==null?void 0:o.sizes}};return Array.isArray(e)?e.map(n):[n(e)]}function Sq(){var e;return(e=I.exports.useContext(Zk))==null?void 0:e.emotionCache}function Ke(e,t,n){var r;const i=Ka(),a=(r=i.components[e])==null?void 0:r.defaultProps,s=typeof a=="function"?a(i):a;return wb(wb(wb({},t),s),kq(n))}function Cq({theme:e,emotionCache:t,withNormalizeCSS:n=!1,withGlobalStyles:r=!1,withCSSVariables:i=!1,inherit:a=!1,children:s}){const o=I.exports.useContext(Zk),l=fve(qM,a?wb(wb({},o.theme),e):e);return x(Yye,{theme:l,children:B(Zk.Provider,{value:{theme:l,emotionCache:t},children:[n&&x(gve,{}),r&&x(sve,{theme:l}),i&&x(ove,{theme:l}),typeof l.globalStyles=="function"&&x(I2,{styles:l.globalStyles(l)}),s]})})}Cq.displayName="@mantine/core/MantineProvider";const xve={app:100,modal:200,popover:300,overlay:400,max:9999};function Sd(e){return xve[e]}function _ve(e,t){const n=I.exports.useRef();return(!n.current||t.length!==n.current.prevDeps.length||n.current.prevDeps.map((r,i)=>r===t[i]).indexOf(!1)>=0)&&(n.current={v:e(),prevDeps:[...t]}),n.current.v}const kve=hq({key:"mantine",prepend:!0});function Sve(){return Sq()||kve}var Cve=Object.defineProperty,n5=Object.getOwnPropertySymbols,Ive=Object.prototype.hasOwnProperty,$ve=Object.prototype.propertyIsEnumerable,r5=(e,t,n)=>t in e?Cve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Tve=(e,t)=>{for(var n in t||(t={}))Ive.call(t,n)&&r5(e,n,t[n]);if(n5)for(var n of n5(t))$ve.call(t,n)&&r5(e,n,t[n]);return e};const CN="ref";function Nve(e){let t;if(e.length!==1)return{args:e,ref:t};const[n]=e;if(!(n instanceof Object))return{args:e,ref:t};if(!(CN in n))return{args:e,ref:t};t=n[CN];const r=Tve({},n);return delete r[CN],{args:[r],ref:t}}const{cssFactory:Eve}=(()=>{function e(n,r,i){const a=[],s=Vye(n,a,i);return a.length<2?i:s+r(a)}function t(n){const{cache:r}=n,i=(...s)=>{const{ref:o,args:l}=Nve(s),u=xq(l,r.registered);return vq(r,u,!1),`${r.key}-${u.name}${o===void 0?"":` ${o}`}`};return{css:i,cx:(...s)=>e(r.registered,i,eq(s))}}return{cssFactory:t}})();function Iq(){const e=Sve();return _ve(()=>Eve({cache:e}),[e])}function Ove({cx:e,classes:t,context:n,classNames:r,name:i,cache:a}){const s=n.reduce((o,l)=>(Object.keys(l.classNames).forEach(u=>{typeof o[u]!="string"?o[u]=`${l.classNames[u]}`:o[u]=`${o[u]} ${l.classNames[u]}`}),o),{});return Object.keys(t).reduce((o,l)=>(o[l]=e(t[l],s[l],r!=null&&r[l],Array.isArray(i)?i.filter(Boolean).map(u=>`${(a==null?void 0:a.key)||"mantine"}-${u}-${l}`).join(" "):i?`${(a==null?void 0:a.key)||"mantine"}-${i}-${l}`:null),o),{})}var Pve=Object.defineProperty,i5=Object.getOwnPropertySymbols,Ave=Object.prototype.hasOwnProperty,Mve=Object.prototype.propertyIsEnumerable,a5=(e,t,n)=>t in e?Pve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,IN=(e,t)=>{for(var n in t||(t={}))Ave.call(t,n)&&a5(e,n,t[n]);if(i5)for(var n of i5(t))Mve.call(t,n)&&a5(e,n,t[n]);return e};function UO(e,t){return t&&Object.keys(t).forEach(n=>{e[n]?e[n]=IN(IN({},e[n]),t[n]):e[n]=IN({},t[n])}),e}function s5(e,t,n,r){const i=a=>typeof a=="function"?a(t,n||{},r):a||{};return Array.isArray(e)?e.map(a=>i(a.styles)).reduce((a,s)=>UO(a,s),{}):i(e)}function Rve({ctx:e,theme:t,params:n,variant:r,size:i}){return e.reduce((a,s)=>(s.variants&&r in s.variants&&UO(a,s.variants[r](t,n,{variant:r,size:i})),s.sizes&&i in s.sizes&&UO(a,s.sizes[i](t,n,{variant:r,size:i})),a),{})}function it(e){const t=typeof e=="function"?e:()=>e;function n(r,i){const a=Ka(),s=wve(i==null?void 0:i.name),o=Sq(),l={variant:i==null?void 0:i.variant,size:i==null?void 0:i.size},{css:u,cx:c}=Iq(),d=t(a,r,l),p=s5(i==null?void 0:i.styles,a,r,l),h=s5(s,a,r,l),m=Rve({ctx:s,theme:a,params:r,variant:i==null?void 0:i.variant,size:i==null?void 0:i.size}),g=Object.fromEntries(Object.keys(d).map(v=>{const y=c({[u(d[v])]:!(i!=null&&i.unstyled)},u(m[v]),u(h[v]),u(p[v]));return[v,y]}));return{classes:Ove({cx:c,classes:g,context:s,classNames:i==null?void 0:i.classNames,name:i==null?void 0:i.name,cache:o}),cx:c,theme:a}}return n}function zo(e){return`___ref-${e||""}`}var Dve=Object.defineProperty,Lve=Object.defineProperties,Fve=Object.getOwnPropertyDescriptors,o5=Object.getOwnPropertySymbols,zve=Object.prototype.hasOwnProperty,Bve=Object.prototype.propertyIsEnumerable,l5=(e,t,n)=>t in e?Dve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,O0=(e,t)=>{for(var n in t||(t={}))zve.call(t,n)&&l5(e,n,t[n]);if(o5)for(var n of o5(t))Bve.call(t,n)&&l5(e,n,t[n]);return e},P0=(e,t)=>Lve(e,Fve(t));const A0={in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${G(10)})`},transitionProperty:"transform, opacity"},Lx={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(-${G(20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(${G(20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${G(20)}) rotate(-5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${G(20)}) rotate(5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:P0(O0({},A0),{common:{transformOrigin:"center center"}}),"pop-bottom-left":P0(O0({},A0),{common:{transformOrigin:"bottom left"}}),"pop-bottom-right":P0(O0({},A0),{common:{transformOrigin:"bottom right"}}),"pop-top-left":P0(O0({},A0),{common:{transformOrigin:"top left"}}),"pop-top-right":P0(O0({},A0),{common:{transformOrigin:"top right"}})},u5=["mousedown","touchstart"];function Wve(e,t,n){const r=I.exports.useRef();return I.exports.useEffect(()=>{const i=a=>{const{target:s}=a!=null?a:{};if(Array.isArray(n)){const o=(s==null?void 0:s.hasAttribute("data-ignore-outside-clicks"))||!document.body.contains(s)&&s.tagName!=="HTML";n.every(u=>!!u&&!a.composedPath().includes(u))&&!o&&e()}else r.current&&!r.current.contains(s)&&e()};return(t||u5).forEach(a=>document.addEventListener(a,i)),()=>{(t||u5).forEach(a=>document.removeEventListener(a,i))}},[r,e,n]),r}function Vve(e,t){try{return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}catch{return e.addListener(t),()=>e.removeListener(t)}}function jve(e,t){return typeof t=="boolean"?t:typeof window<"u"&&"matchMedia"in window?window.matchMedia(e).matches:!1}function Uve(e,t,{getInitialValueInEffect:n}={getInitialValueInEffect:!0}){const[r,i]=I.exports.useState(n?t:jve(e,t)),a=I.exports.useRef();return I.exports.useEffect(()=>{if("matchMedia"in window)return a.current=window.matchMedia(e),i(a.current.matches),Vve(a.current,s=>i(s.matches))},[e]),r}function Ll(e,t,n){return Math.min(Math.max(e,t),n)}const eR=typeof document<"u"?I.exports.useLayoutEffect:I.exports.useEffect;function Xi(e,t){const n=I.exports.useRef(!1);I.exports.useEffect(()=>()=>{n.current=!1},[]),I.exports.useEffect(()=>{if(n.current)return e();n.current=!0},t)}function $q({opened:e,shouldReturnFocus:t=!0}){const n=I.exports.useRef(),r=()=>{var i;n.current&&"focus"in n.current&&typeof n.current.focus=="function"&&((i=n.current)==null||i.focus({preventScroll:!0}))};return Xi(()=>{let i=-1;const a=s=>{s.key==="Tab"&&window.clearTimeout(i)};return document.addEventListener("keydown",a),e?n.current=document.activeElement:t&&(i=window.setTimeout(r,10)),()=>{window.clearTimeout(i),document.removeEventListener("keydown",a)}},[e,t]),r}const Hve=/input|select|textarea|button|object/,Tq="a, input, select, textarea, button, object, [tabindex]";function Gve(e){return e.style.display==="none"}function qve(e){if(e.getAttribute("aria-hidden")||e.getAttribute("hidden")||e.getAttribute("type")==="hidden")return!1;let n=e;for(;n&&!(n===document.body||n.nodeType===11);){if(Gve(n))return!1;n=n.parentNode}return!0}function Nq(e){let t=e.getAttribute("tabindex");return t===null&&(t=void 0),parseInt(t,10)}function HO(e){const t=e.nodeName.toLowerCase(),n=!Number.isNaN(Nq(e));return(Hve.test(t)&&!e.disabled||e instanceof HTMLAnchorElement&&e.href||n)&&qve(e)}function Eq(e){const t=Nq(e);return(Number.isNaN(t)||t>=0)&&HO(e)}function Kve(e){return Array.from(e.querySelectorAll(Tq)).filter(Eq)}function Zve(e,t){const n=Kve(e);if(!n.length){t.preventDefault();return}const r=n[t.shiftKey?0:n.length-1],i=e.getRootNode();if(!(r===i.activeElement||e===i.activeElement))return;t.preventDefault();const s=n[t.shiftKey?n.length-1:0];s&&s.focus()}function vg(){return`mantine-${Math.random().toString(36).slice(2,11)}`}function Xve(e,t="body > :not(script)"){const n=vg(),r=Array.from(document.querySelectorAll(t)).map(i=>{var a;if(((a=i==null?void 0:i.shadowRoot)==null?void 0:a.contains(e))||i.contains(e))return;const s=i.getAttribute("aria-hidden"),o=i.getAttribute("data-hidden"),l=i.getAttribute("data-focus-id");return i.setAttribute("data-focus-id",n),s===null||s==="false"?i.setAttribute("aria-hidden","true"):!o&&!l&&i.setAttribute("data-hidden",s),{node:i,ariaHidden:o||null}});return()=>{r.forEach(i=>{!i||n!==i.node.getAttribute("data-focus-id")||(i.ariaHidden===null?i.node.removeAttribute("aria-hidden"):i.node.setAttribute("aria-hidden",i.ariaHidden),i.node.removeAttribute("data-focus-id"),i.node.removeAttribute("data-hidden"))})}}function Jve(e=!0){const t=I.exports.useRef(),n=I.exports.useRef(null),r=a=>{let s=a.querySelector("[data-autofocus]");if(!s){const o=Array.from(a.querySelectorAll(Tq));s=o.find(Eq)||o.find(HO)||null,!s&&HO(a)&&(s=a)}s&&s.focus({preventScroll:!0})},i=I.exports.useCallback(a=>{if(!!e){if(a===null){n.current&&(n.current(),n.current=null);return}n.current=Xve(a),t.current!==a&&(a?(setTimeout(()=>{a.getRootNode()&&r(a)}),t.current=a):t.current=null)}},[e]);return I.exports.useEffect(()=>{if(!e)return;t.current&&setTimeout(()=>r(t.current));const a=s=>{s.key==="Tab"&&t.current&&Zve(t.current,s)};return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a),n.current&&n.current()}},[e]),i}const Yve=Ni["useId".toString()]||(()=>{});function Qve(){const e=Yve();return e?`mantine-${e.replace(/:/g,"")}`:""}function zu(e){const t=Qve(),[n,r]=I.exports.useState(t);return eR(()=>{r(vg())},[]),typeof e=="string"?e:typeof window>"u"?t:n}function Xk(e,t,n){I.exports.useEffect(()=>(window.addEventListener(e,t,n),()=>window.removeEventListener(e,t,n)),[e,t])}function Oq(e,t){typeof e=="function"?e(t):typeof e=="object"&&e!==null&&"current"in e&&(e.current=t)}function Pq(...e){return t=>{e.forEach(n=>Oq(n,t))}}function Bu(...e){return I.exports.useCallback(Pq(...e),e)}const Aq=e=>({x:Ll(e.x,0,1),y:Ll(e.y,0,1)});function tR(e,t,n="ltr"){const r=I.exports.useRef(),i=I.exports.useRef(!1),a=I.exports.useRef(!1),s=I.exports.useRef(0),[o,l]=I.exports.useState(!1);return I.exports.useEffect(()=>{i.current=!0},[]),I.exports.useEffect(()=>{const u=({x:b,y:_})=>{cancelAnimationFrame(s.current),s.current=requestAnimationFrame(()=>{if(i.current&&r.current){r.current.style.userSelect="none";const k=r.current.getBoundingClientRect();if(k.width&&k.height){const C=Ll((b-k.left)/k.width,0,1);e({x:n==="ltr"?C:1-C,y:Ll((_-k.top)/k.height,0,1)})}}})},c=()=>{document.addEventListener("mousemove",g),document.addEventListener("mouseup",h),document.addEventListener("touchmove",y),document.addEventListener("touchend",h)},d=()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",h),document.removeEventListener("touchmove",y),document.removeEventListener("touchend",h)},p=()=>{!a.current&&i.current&&(a.current=!0,typeof(t==null?void 0:t.onScrubStart)=="function"&&t.onScrubStart(),l(!0),c())},h=()=>{a.current&&i.current&&(a.current=!1,l(!1),d(),setTimeout(()=>{typeof(t==null?void 0:t.onScrubEnd)=="function"&&t.onScrubEnd()},0))},m=b=>{p(),b.preventDefault(),g(b)},g=b=>u({x:b.clientX,y:b.clientY}),v=b=>{b.cancelable&&b.preventDefault(),p(),y(b)},y=b=>{b.cancelable&&b.preventDefault(),u({x:b.changedTouches[0].clientX,y:b.changedTouches[0].clientY})};return r.current.addEventListener("mousedown",m),r.current.addEventListener("touchstart",v,{passive:!1}),()=>{r.current&&(r.current.removeEventListener("mousedown",m),r.current.removeEventListener("touchstart",v))}},[n,e]),{ref:r,active:o}}function qo({value:e,defaultValue:t,finalValue:n,onChange:r=()=>{}}){const[i,a]=I.exports.useState(t!==void 0?t:n),s=o=>{a(o),r==null||r(o)};return e!==void 0?[e,r,!0]:[i,s,!1]}function $2(e,t){return Uve("(prefers-reduced-motion: reduce)",e,t)}const e0e=e=>e<.5?2*e*e:-1+(4-2*e)*e,t0e=({axis:e,target:t,parent:n,alignment:r,offset:i,isList:a})=>{if(!t||!n&&typeof document>"u")return 0;const s=!!n,l=(n||document.body).getBoundingClientRect(),u=t.getBoundingClientRect(),c=d=>u[d]-l[d];if(e==="y"){const d=c("top");if(d===0)return 0;if(r==="start"){const h=d-i;return h<=u.height*(a?0:1)||!a?h:0}const p=s?l.height:window.innerHeight;if(r==="end"){const h=d+i-p+u.height;return h>=-u.height*(a?0:1)||!a?h:0}return r==="center"?d-p/2+u.height/2:0}if(e==="x"){const d=c("left");if(d===0)return 0;if(r==="start"){const h=d-i;return h<=u.width||!a?h:0}const p=s?l.width:window.innerWidth;if(r==="end"){const h=d+i-p+u.width;return h>=-u.width||!a?h:0}return r==="center"?d-p/2+u.width/2:0}return 0},n0e=({axis:e,parent:t})=>{if(!t&&typeof document>"u")return 0;const n=e==="y"?"scrollTop":"scrollLeft";if(t)return t[n];const{body:r,documentElement:i}=document;return r[n]+i[n]},r0e=({axis:e,parent:t,distance:n})=>{if(!t&&typeof document>"u")return;const r=e==="y"?"scrollTop":"scrollLeft";if(t)t[r]=n;else{const{body:i,documentElement:a}=document;i[r]=n,a[r]=n}};function Mq({duration:e=1250,axis:t="y",onScrollFinish:n,easing:r=e0e,offset:i=0,cancelable:a=!0,isList:s=!1}={}){const o=I.exports.useRef(0),l=I.exports.useRef(0),u=I.exports.useRef(!1),c=I.exports.useRef(null),d=I.exports.useRef(null),p=$2(),h=()=>{o.current&&cancelAnimationFrame(o.current)},m=I.exports.useCallback(({alignment:v="start"}={})=>{var y;u.current=!1,o.current&&h();const b=(y=n0e({parent:c.current,axis:t}))!=null?y:0,_=t0e({parent:c.current,target:d.current,axis:t,alignment:v,offset:i,isList:s})-(c.current?0:b);function k(){l.current===0&&(l.current=performance.now());const $=performance.now()-l.current,N=p||e===0?1:$/e,A=b+_*r(N);r0e({parent:c.current,axis:t,distance:A}),!u.current&&N<1?o.current=requestAnimationFrame(k):(typeof n=="function"&&n(),l.current=0,o.current=0,h())}k()},[t,e,r,s,i,n,p]),g=()=>{a&&(u.current=!0)};return Xk("wheel",g,{passive:!0}),Xk("touchmove",g,{passive:!0}),I.exports.useEffect(()=>h,[]),{scrollableRef:c,targetRef:d,scrollIntoView:m,cancel:h}}function c5(){if(typeof window>"u")return"undetermined";const{userAgent:e}=window.navigator,t=/(Macintosh)|(MacIntel)|(MacPPC)|(Mac68K)/i,n=/(Win32)|(Win64)|(Windows)|(WinCE)/i,r=/(iPhone)|(iPad)|(iPod)/i;return t.test(e)?"macos":r.test(e)?"ios":n.test(e)?"windows":/Android/i.test(e)?"android":/Linux/i.test(e)?"linux":"undetermined"}function i0e(e={getValueInEffect:!0}){const[t,n]=I.exports.useState(e.getValueInEffect?"undetermined":c5());return eR(()=>{e.getValueInEffect&&n(c5)},[]),t}function a0e(e){return t=>{if(!t)e(t);else if(typeof t=="function")e(t);else if(typeof t=="object"&&"nativeEvent"in t){const{currentTarget:n}=t;n.type==="checkbox"?e(n.checked):e(n.value)}else e(t)}}function s0e(e){const[t,n]=I.exports.useState(e);return[t,a0e(n)]}function $r(e=!1,t){const{onOpen:n,onClose:r}=t||{},[i,a]=I.exports.useState(e),s=I.exports.useCallback(()=>{a(u=>u||(n==null||n(),!0))},[n]),o=I.exports.useCallback(()=>{a(u=>u&&(r==null||r(),!1))},[r]),l=I.exports.useCallback(()=>{i?o():s()},[o,s,i]);return[i,{open:s,close:o,toggle:l}]}var d5=Object.getOwnPropertySymbols,o0e=Object.prototype.hasOwnProperty,l0e=Object.prototype.propertyIsEnumerable,u0e=(e,t)=>{var n={};for(var r in e)o0e.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&d5)for(var r of d5(e))t.indexOf(r)<0&&l0e.call(e,r)&&(n[r]=e[r]);return n};function Cd(e){const t=e,{m:n,mx:r,my:i,mt:a,mb:s,ml:o,mr:l,p:u,px:c,py:d,pt:p,pb:h,pl:m,pr:g,bg:v,c:y,opacity:b,ff:_,fz:k,fw:C,lts:$,ta:N,lh:A,fs:D,tt:O,td:F,w:E,miw:z,maw:q,h:H,mih:J,mah:ee,bgsz:V,bgp:Q,bgr:X,bga:Y,pos:ce,top:pe,left:fe,bottom:ye,right:_e,inset:Ee,display:Se}=t,Re=u0e(t,["m","mx","my","mt","mb","ml","mr","p","px","py","pt","pb","pl","pr","bg","c","opacity","ff","fz","fw","lts","ta","lh","fs","tt","td","w","miw","maw","h","mih","mah","bgsz","bgp","bgr","bga","pos","top","left","bottom","right","inset","display"]);return{systemStyles:kq({m:n,mx:r,my:i,mt:a,mb:s,ml:o,mr:l,p:u,px:c,py:d,pt:p,pb:h,pl:m,pr:g,bg:v,c:y,opacity:b,ff:_,fz:k,fw:C,lts:$,ta:N,lh:A,fs:D,tt:O,td:F,w:E,miw:z,maw:q,h:H,mih:J,mah:ee,bgsz:V,bgp:Q,bgr:X,bga:Y,pos:ce,top:pe,left:fe,bottom:ye,right:_e,inset:Ee,display:Se}),rest:Re}}function c0e(e,t){const n=Object.keys(e).filter(r=>r!=="base").sort((r,i)=>Go(ke({size:r,sizes:t.breakpoints}))-Go(ke({size:i,sizes:t.breakpoints})));return"base"in e?["base",...n]:n}function d0e({value:e,theme:t,getValue:n,property:r}){if(e==null)return;if(typeof e=="object")return c0e(e,t).reduce((s,o)=>{if(o==="base"&&e.base!==void 0){const u=n(e.base,t);return Array.isArray(r)?(r.forEach(c=>{s[c]=u}),s):(s[r]=u,s)}const l=n(e[o],t);return Array.isArray(r)?(s[t.fn.largerThan(o)]={},r.forEach(u=>{s[t.fn.largerThan(o)][u]=l}),s):(s[t.fn.largerThan(o)]={[r]:l},s)},{});const i=n(e,t);return Array.isArray(r)?r.reduce((a,s)=>(a[s]=i,a),{}):{[r]:i}}function p0e(e,t){return e==="dimmed"?t.colorScheme==="dark"?t.colors.dark[2]:t.colors.gray[6]:t.fn.variant({variant:"filled",color:e,primaryFallback:!1}).background}function h0e(e){return G(e)}function f0e(e){return e}function m0e(e,t){return ke({size:e,sizes:t.fontSizes})}const g0e=["-xs","-sm","-md","-lg","-xl"];function y0e(e,t){return g0e.includes(e)?`calc(${ke({size:e.replace("-",""),sizes:t.spacing})} * -1)`:ke({size:e,sizes:t.spacing})}const v0e={identity:f0e,color:p0e,size:h0e,fontSize:m0e,spacing:y0e},b0e={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},mx:{type:"spacing",property:["marginRight","marginLeft"]},my:{type:"spacing",property:["marginTop","marginBottom"]},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},px:{type:"spacing",property:["paddingRight","paddingLeft"]},py:{type:"spacing",property:["paddingTop","paddingBottom"]},bg:{type:"color",property:"background"},c:{type:"color",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"identity",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"identity",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"identity",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"}};var w0e=Object.defineProperty,p5=Object.getOwnPropertySymbols,x0e=Object.prototype.hasOwnProperty,_0e=Object.prototype.propertyIsEnumerable,h5=(e,t,n)=>t in e?w0e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,f5=(e,t)=>{for(var n in t||(t={}))x0e.call(t,n)&&h5(e,n,t[n]);if(p5)for(var n of p5(t))_0e.call(t,n)&&h5(e,n,t[n]);return e};function m5(e,t,n=b0e){return Object.keys(n).reduce((i,a)=>(a in e&&e[a]!==void 0&&i.push(d0e({value:e[a],getValue:v0e[n[a].type],property:n[a].property,theme:t})),i),[]).reduce((i,a)=>(Object.keys(a).forEach(s=>{typeof a[s]=="object"&&a[s]!==null&&s in i?i[s]=f5(f5({},i[s]),a[s]):i[s]=a[s]}),i),{})}function g5(e,t){return typeof e=="function"?e(t):e}function k0e(e,t,n){const r=Ka(),{css:i,cx:a}=Iq();return Array.isArray(e)?a(n,i(m5(t,r)),e.map(s=>i(g5(s,r)))):a(n,i(g5(e,r)),i(m5(t,r)))}var S0e=Object.defineProperty,Jk=Object.getOwnPropertySymbols,Rq=Object.prototype.hasOwnProperty,Dq=Object.prototype.propertyIsEnumerable,y5=(e,t,n)=>t in e?S0e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,C0e=(e,t)=>{for(var n in t||(t={}))Rq.call(t,n)&&y5(e,n,t[n]);if(Jk)for(var n of Jk(t))Dq.call(t,n)&&y5(e,n,t[n]);return e},I0e=(e,t)=>{var n={};for(var r in e)Rq.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Jk)for(var r of Jk(e))t.indexOf(r)<0&&Dq.call(e,r)&&(n[r]=e[r]);return n};const Lq=I.exports.forwardRef((e,t)=>{var n=e,{className:r,component:i,style:a,sx:s}=n,o=I0e(n,["className","component","style","sx"]);const{systemStyles:l,rest:u}=Cd(o);return x(i||"div",{...C0e({ref:t,className:k0e(s,l,r),style:a},u)})});Lq.displayName="@mantine/core/Box";const wt=Lq;var $0e=Object.defineProperty,T0e=Object.defineProperties,N0e=Object.getOwnPropertyDescriptors,v5=Object.getOwnPropertySymbols,E0e=Object.prototype.hasOwnProperty,O0e=Object.prototype.propertyIsEnumerable,b5=(e,t,n)=>t in e?$0e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,w5=(e,t)=>{for(var n in t||(t={}))E0e.call(t,n)&&b5(e,n,t[n]);if(v5)for(var n of v5(t))O0e.call(t,n)&&b5(e,n,t[n]);return e},P0e=(e,t)=>T0e(e,N0e(t)),A0e=it(e=>({root:P0e(w5(w5({},e.fn.focusStyles()),e.fn.fontStyles()),{cursor:"pointer",border:0,padding:0,appearance:"none",fontSize:e.fontSizes.md,backgroundColor:"transparent",textAlign:"left",color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,textDecoration:"none",boxSizing:"border-box"})}));const M0e=A0e;var R0e=Object.defineProperty,Yk=Object.getOwnPropertySymbols,Fq=Object.prototype.hasOwnProperty,zq=Object.prototype.propertyIsEnumerable,x5=(e,t,n)=>t in e?R0e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,D0e=(e,t)=>{for(var n in t||(t={}))Fq.call(t,n)&&x5(e,n,t[n]);if(Yk)for(var n of Yk(t))zq.call(t,n)&&x5(e,n,t[n]);return e},L0e=(e,t)=>{var n={};for(var r in e)Fq.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Yk)for(var r of Yk(e))t.indexOf(r)<0&&zq.call(e,r)&&(n[r]=e[r]);return n};const Bq=I.exports.forwardRef((e,t)=>{const n=Ke("UnstyledButton",{},e),{className:r,component:i="button",unstyled:a,variant:s}=n,o=L0e(n,["className","component","unstyled","variant"]),{classes:l,cx:u}=M0e(null,{name:"UnstyledButton",unstyled:a,variant:s});return x(wt,{...D0e({component:i,ref:t,className:u(l.root,r),type:i==="button"?"button":void 0},o)})});Bq.displayName="@mantine/core/UnstyledButton";const D1=Bq;var F0e=Object.defineProperty,z0e=Object.defineProperties,B0e=Object.getOwnPropertyDescriptors,Qk=Object.getOwnPropertySymbols,Wq=Object.prototype.hasOwnProperty,Vq=Object.prototype.propertyIsEnumerable,_5=(e,t,n)=>t in e?F0e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,tp=(e,t)=>{for(var n in t||(t={}))Wq.call(t,n)&&_5(e,n,t[n]);if(Qk)for(var n of Qk(t))Vq.call(t,n)&&_5(e,n,t[n]);return e},$N=(e,t)=>z0e(e,B0e(t)),W0e=(e,t)=>{var n={};for(var r in e)Wq.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Qk)for(var r of Qk(e))t.indexOf(r)<0&&Vq.call(e,r)&&(n[r]=e[r]);return n};function V0e(e){if(!e||typeof e=="string")return 0;const t=e/36;return Math.round((4+15*t**.25+t/5)*10)}function TN(e){return e!=null&&e.current?e.current.scrollHeight:"auto"}const Fx=typeof window<"u"&&window.requestAnimationFrame;function j0e({transitionDuration:e,transitionTimingFunction:t="ease",onTransitionEnd:n=()=>{},opened:r}){const i=I.exports.useRef(null),a=0,s={display:"none",height:0,overflow:"hidden"},[o,l]=I.exports.useState(r?{}:s),u=m=>{ql.exports.flushSync(()=>l(m))},c=m=>{u(g=>tp(tp({},g),m))};function d(m){return{transition:`height ${e||V0e(m)}ms ${t}`}}Xi(()=>{Fx(r?()=>{c({willChange:"height",display:"block",overflow:"hidden"}),Fx(()=>{const m=TN(i);c($N(tp({},d(m)),{height:m}))})}:()=>{const m=TN(i);c($N(tp({},d(m)),{willChange:"height",height:m})),Fx(()=>c({height:a,overflow:"hidden"}))})},[r]);const p=m=>{if(!(m.target!==i.current||m.propertyName!=="height"))if(r){const g=TN(i);g===o.height?u({}):c({height:g}),n()}else o.height===a&&(u(s),n())};function h(m={}){var g=m,{style:v={},refKey:y="ref"}=g,b=W0e(g,["style","refKey"]);const _=b[y];return $N(tp({"aria-hidden":!r},b),{[y]:Pq(i,_),onTransitionEnd:p,style:tp(tp({boxSizing:"border-box"},v),o)})}return h}var U0e=Object.defineProperty,eS=Object.getOwnPropertySymbols,jq=Object.prototype.hasOwnProperty,Uq=Object.prototype.propertyIsEnumerable,k5=(e,t,n)=>t in e?U0e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zx=(e,t)=>{for(var n in t||(t={}))jq.call(t,n)&&k5(e,n,t[n]);if(eS)for(var n of eS(t))Uq.call(t,n)&&k5(e,n,t[n]);return e},H0e=(e,t)=>{var n={};for(var r in e)jq.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&eS)for(var r of eS(e))t.indexOf(r)<0&&Uq.call(e,r)&&(n[r]=e[r]);return n};const G0e={transitionDuration:200,transitionTimingFunction:"ease",animateOpacity:!0},T2=I.exports.forwardRef((e,t)=>{const n=Ke("Collapse",G0e,e),{children:r,in:i,transitionDuration:a,transitionTimingFunction:s,style:o,onTransitionEnd:l,animateOpacity:u}=n,c=H0e(n,["children","in","transitionDuration","transitionTimingFunction","style","onTransitionEnd","animateOpacity"]),d=Ka(),p=$2(),m=(d.respectReducedMotion?p:!1)?0:a,{systemStyles:g,rest:v}=Cd(c),y=j0e({opened:i,transitionDuration:m,transitionTimingFunction:s,onTransitionEnd:l});return m===0?i?x(wt,{...zx({},v),children:r}):null:x(wt,{...zx({},y(zx(zx({style:o,ref:t},v),g))),children:x("div",{style:{opacity:i||!u?1:0,transition:u?`opacity ${m}ms ${s}`:"none"},children:r})})});T2.displayName="@mantine/core/Collapse";var q0e=Object.defineProperty,K0e=Object.defineProperties,Z0e=Object.getOwnPropertyDescriptors,S5=Object.getOwnPropertySymbols,X0e=Object.prototype.hasOwnProperty,J0e=Object.prototype.propertyIsEnumerable,C5=(e,t,n)=>t in e?q0e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,GO=(e,t)=>{for(var n in t||(t={}))X0e.call(t,n)&&C5(e,n,t[n]);if(S5)for(var n of S5(t))J0e.call(t,n)&&C5(e,n,t[n]);return e},I5=(e,t)=>K0e(e,Z0e(t));const Y0e=["subtle","filled","outline","light","default","transparent","gradient"],Bx={xs:G(18),sm:G(22),md:G(28),lg:G(34),xl:G(44)};function Q0e({variant:e,theme:t,color:n,gradient:r}){const i=t.fn.variant({color:n,variant:e,gradient:r});return e==="gradient"?{border:0,backgroundImage:i.background,color:i.color,"&:hover":t.fn.hover({backgroundSize:"200%"})}:Y0e.includes(e)?GO({border:`${G(1)} solid ${i.border}`,backgroundColor:i.background,color:i.color},t.fn.hover({backgroundColor:i.hover})):null}var ebe=it((e,{radius:t,color:n,gradient:r},{variant:i,size:a})=>({root:I5(GO({position:"relative",borderRadius:e.fn.radius(t),padding:0,lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",height:ke({size:a,sizes:Bx}),minHeight:ke({size:a,sizes:Bx}),width:ke({size:a,sizes:Bx}),minWidth:ke({size:a,sizes:Bx})},Q0e({variant:i,theme:e,color:n,gradient:r})),{"&:active":e.activeStyles,"& [data-action-icon-loader]":{maxWidth:"70%"},"&:disabled, &[data-disabled]":{color:e.colors.gray[e.colorScheme==="dark"?6:4],cursor:"not-allowed",backgroundColor:i==="transparent"?void 0:e.fn.themeColor("gray",e.colorScheme==="dark"?8:1),borderColor:i==="transparent"?void 0:e.fn.themeColor("gray",e.colorScheme==="dark"?8:1),backgroundImage:"none",pointerEvents:"none","&:active":{transform:"none"}},"&[data-loading]":{pointerEvents:"none","&::before":I5(GO({content:'""'},e.fn.cover(G(-1))),{backgroundColor:e.colorScheme==="dark"?e.fn.rgba(e.colors.dark[7],.5):"rgba(255, 255, 255, .5)",borderRadius:e.fn.radius(t),cursor:"not-allowed"})}})}));const tbe=ebe;var nbe=Object.defineProperty,tS=Object.getOwnPropertySymbols,Hq=Object.prototype.hasOwnProperty,Gq=Object.prototype.propertyIsEnumerable,$5=(e,t,n)=>t in e?nbe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,T5=(e,t)=>{for(var n in t||(t={}))Hq.call(t,n)&&$5(e,n,t[n]);if(tS)for(var n of tS(t))Gq.call(t,n)&&$5(e,n,t[n]);return e},N5=(e,t)=>{var n={};for(var r in e)Hq.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&tS)for(var r of tS(e))t.indexOf(r)<0&&Gq.call(e,r)&&(n[r]=e[r]);return n};function rbe(e){var t=e,{size:n,color:r}=t,i=N5(t,["size","color"]);const a=i,{style:s}=a,o=N5(a,["style"]);return B("svg",{...T5({viewBox:"0 0 135 140",xmlns:"http://www.w3.org/2000/svg",fill:r,style:T5({width:n},s)},o),children:[B("rect",{y:"10",width:"15",height:"120",rx:"6",children:[x("animate",{attributeName:"height",begin:"0.5s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),x("animate",{attributeName:"y",begin:"0.5s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})]}),B("rect",{x:"30",y:"10",width:"15",height:"120",rx:"6",children:[x("animate",{attributeName:"height",begin:"0.25s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),x("animate",{attributeName:"y",begin:"0.25s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})]}),B("rect",{x:"60",width:"15",height:"140",rx:"6",children:[x("animate",{attributeName:"height",begin:"0s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),x("animate",{attributeName:"y",begin:"0s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})]}),B("rect",{x:"90",y:"10",width:"15",height:"120",rx:"6",children:[x("animate",{attributeName:"height",begin:"0.25s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),x("animate",{attributeName:"y",begin:"0.25s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})]}),B("rect",{x:"120",y:"10",width:"15",height:"120",rx:"6",children:[x("animate",{attributeName:"height",begin:"0.5s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),x("animate",{attributeName:"y",begin:"0.5s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})]})]})}var ibe=Object.defineProperty,nS=Object.getOwnPropertySymbols,qq=Object.prototype.hasOwnProperty,Kq=Object.prototype.propertyIsEnumerable,E5=(e,t,n)=>t in e?ibe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,O5=(e,t)=>{for(var n in t||(t={}))qq.call(t,n)&&E5(e,n,t[n]);if(nS)for(var n of nS(t))Kq.call(t,n)&&E5(e,n,t[n]);return e},P5=(e,t)=>{var n={};for(var r in e)qq.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&nS)for(var r of nS(e))t.indexOf(r)<0&&Kq.call(e,r)&&(n[r]=e[r]);return n};function abe(e){var t=e,{size:n,color:r}=t,i=P5(t,["size","color"]);const a=i,{style:s}=a,o=P5(a,["style"]);return x("svg",{...O5({viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:r,style:O5({width:n,height:n},s)},o),children:x("g",{fill:"none",fillRule:"evenodd",children:B("g",{transform:"translate(2.5 2.5)",strokeWidth:"5",children:[x("circle",{strokeOpacity:".5",cx:"16",cy:"16",r:"16"}),x("path",{d:"M32 16c0-9.94-8.06-16-16-16",children:x("animateTransform",{attributeName:"transform",type:"rotate",from:"0 16 16",to:"360 16 16",dur:"1s",repeatCount:"indefinite"})})]})})})}var sbe=Object.defineProperty,rS=Object.getOwnPropertySymbols,Zq=Object.prototype.hasOwnProperty,Xq=Object.prototype.propertyIsEnumerable,A5=(e,t,n)=>t in e?sbe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,M5=(e,t)=>{for(var n in t||(t={}))Zq.call(t,n)&&A5(e,n,t[n]);if(rS)for(var n of rS(t))Xq.call(t,n)&&A5(e,n,t[n]);return e},R5=(e,t)=>{var n={};for(var r in e)Zq.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&rS)for(var r of rS(e))t.indexOf(r)<0&&Xq.call(e,r)&&(n[r]=e[r]);return n};function obe(e){var t=e,{size:n,color:r}=t,i=R5(t,["size","color"]);const a=i,{style:s}=a,o=R5(a,["style"]);return B("svg",{...M5({viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:r,style:M5({width:n},s)},o),children:[B("circle",{cx:"15",cy:"15",r:"15",children:[x("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),x("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]}),B("circle",{cx:"60",cy:"15",r:"9",fillOpacity:"0.3",children:[x("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),x("animate",{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]}),B("circle",{cx:"105",cy:"15",r:"15",children:[x("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),x("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]})]})}var lbe=Object.defineProperty,iS=Object.getOwnPropertySymbols,Jq=Object.prototype.hasOwnProperty,Yq=Object.prototype.propertyIsEnumerable,D5=(e,t,n)=>t in e?lbe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ube=(e,t)=>{for(var n in t||(t={}))Jq.call(t,n)&&D5(e,n,t[n]);if(iS)for(var n of iS(t))Yq.call(t,n)&&D5(e,n,t[n]);return e},cbe=(e,t)=>{var n={};for(var r in e)Jq.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&iS)for(var r of iS(e))t.indexOf(r)<0&&Yq.call(e,r)&&(n[r]=e[r]);return n};const NN={bars:rbe,oval:abe,dots:obe},dbe={xs:G(18),sm:G(22),md:G(36),lg:G(44),xl:G(58)},pbe={size:"md"};function nR(e){const t=Ke("Loader",pbe,e),{size:n,color:r,variant:i}=t,a=cbe(t,["size","color","variant"]),s=Ka(),o=i in NN?i:s.loader;return x(wt,{...ube({role:"presentation",component:NN[o]||NN.bars,size:ke({size:n,sizes:dbe}),color:s.fn.variant({variant:"filled",primaryFallback:!1,color:r||s.primaryColor}).background},a)})}nR.displayName="@mantine/core/Loader";var hbe=Object.defineProperty,aS=Object.getOwnPropertySymbols,Qq=Object.prototype.hasOwnProperty,eK=Object.prototype.propertyIsEnumerable,L5=(e,t,n)=>t in e?hbe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,F5=(e,t)=>{for(var n in t||(t={}))Qq.call(t,n)&&L5(e,n,t[n]);if(aS)for(var n of aS(t))eK.call(t,n)&&L5(e,n,t[n]);return e},fbe=(e,t)=>{var n={};for(var r in e)Qq.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&aS)for(var r of aS(e))t.indexOf(r)<0&&eK.call(e,r)&&(n[r]=e[r]);return n};const mbe={color:"gray",size:"md",variant:"subtle"},tK=I.exports.forwardRef((e,t)=>{const n=Ke("ActionIcon",mbe,e),{className:r,color:i,children:a,radius:s,size:o,variant:l,gradient:u,disabled:c,loaderProps:d,loading:p,unstyled:h,__staticSelector:m}=n,g=fbe(n,["className","color","children","radius","size","variant","gradient","disabled","loaderProps","loading","unstyled","__staticSelector"]),{classes:v,cx:y,theme:b}=tbe({radius:s,color:i,gradient:u},{name:["ActionIcon",m],unstyled:h,size:o,variant:l}),_=x(nR,{...F5({color:b.fn.variant({color:i,variant:l}).color,size:"100%","data-action-icon-loader":!0},d)});return x(D1,{...F5({className:y(v.root,r),ref:t,disabled:c,"data-disabled":c||void 0,"data-loading":p||void 0,unstyled:h},g),children:p?_:a})});tK.displayName="@mantine/core/ActionIcon";const Fe=tK;var gbe=Object.defineProperty,ybe=Object.defineProperties,vbe=Object.getOwnPropertyDescriptors,sS=Object.getOwnPropertySymbols,nK=Object.prototype.hasOwnProperty,rK=Object.prototype.propertyIsEnumerable,z5=(e,t,n)=>t in e?gbe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,bbe=(e,t)=>{for(var n in t||(t={}))nK.call(t,n)&&z5(e,n,t[n]);if(sS)for(var n of sS(t))rK.call(t,n)&&z5(e,n,t[n]);return e},wbe=(e,t)=>ybe(e,vbe(t)),xbe=(e,t)=>{var n={};for(var r in e)nK.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&sS)for(var r of sS(e))t.indexOf(r)<0&&rK.call(e,r)&&(n[r]=e[r]);return n};function iK(e){const t=Ke("Portal",{},e),{children:n,target:r,className:i,innerRef:a}=t,s=xbe(t,["children","target","className","innerRef"]),o=Ka(),[l,u]=I.exports.useState(!1),c=I.exports.useRef();return eR(()=>(u(!0),c.current=r?typeof r=="string"?document.querySelector(r):r:document.createElement("div"),r||document.body.appendChild(c.current),()=>{!r&&document.body.removeChild(c.current)}),[r]),l?ql.exports.createPortal(x("div",{...wbe(bbe({className:i,dir:o.dir},s),{ref:a}),children:n}),c.current):null}iK.displayName="@mantine/core/Portal";var _be=Object.defineProperty,oS=Object.getOwnPropertySymbols,aK=Object.prototype.hasOwnProperty,sK=Object.prototype.propertyIsEnumerable,B5=(e,t,n)=>t in e?_be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,kbe=(e,t)=>{for(var n in t||(t={}))aK.call(t,n)&&B5(e,n,t[n]);if(oS)for(var n of oS(t))sK.call(t,n)&&B5(e,n,t[n]);return e},Sbe=(e,t)=>{var n={};for(var r in e)aK.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&oS)for(var r of oS(e))t.indexOf(r)<0&&sK.call(e,r)&&(n[r]=e[r]);return n};function L1(e){var t=e,{withinPortal:n=!0,children:r}=t,i=Sbe(t,["withinPortal","children"]);return n?x(iK,{...kbe({},i),children:r}):x(ze,{children:r})}L1.displayName="@mantine/core/OptionalPortal";var Cbe=Object.defineProperty,lS=Object.getOwnPropertySymbols,oK=Object.prototype.hasOwnProperty,lK=Object.prototype.propertyIsEnumerable,W5=(e,t,n)=>t in e?Cbe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,V5=(e,t)=>{for(var n in t||(t={}))oK.call(t,n)&&W5(e,n,t[n]);if(lS)for(var n of lS(t))lK.call(t,n)&&W5(e,n,t[n]);return e},Ibe=(e,t)=>{var n={};for(var r in e)oK.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&lS)for(var r of lS(e))t.indexOf(r)<0&&lK.call(e,r)&&(n[r]=e[r]);return n};function uK(e){const t=e,{width:n,height:r,style:i}=t,a=Ibe(t,["width","height","style"]);return x("svg",{...V5({viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:V5({width:n,height:r},i)},a),children:x("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}uK.displayName="@mantine/core/CloseIcon";var $be=Object.defineProperty,uS=Object.getOwnPropertySymbols,cK=Object.prototype.hasOwnProperty,dK=Object.prototype.propertyIsEnumerable,j5=(e,t,n)=>t in e?$be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Tbe=(e,t)=>{for(var n in t||(t={}))cK.call(t,n)&&j5(e,n,t[n]);if(uS)for(var n of uS(t))dK.call(t,n)&&j5(e,n,t[n]);return e},Nbe=(e,t)=>{var n={};for(var r in e)cK.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&uS)for(var r of uS(e))t.indexOf(r)<0&&dK.call(e,r)&&(n[r]=e[r]);return n};const Ebe={xs:G(12),sm:G(16),md:G(20),lg:G(28),xl:G(34)},Obe={size:"sm"},pK=I.exports.forwardRef((e,t)=>{const n=Ke("CloseButton",Obe,e),{iconSize:r,size:i,children:a}=n,s=Nbe(n,["iconSize","size","children"]),o=G(r||Ebe[i]);return x(Fe,{...Tbe({ref:t,__staticSelector:"CloseButton",size:i},s),children:a||x(uK,{width:o,height:o})})});pK.displayName="@mantine/core/CloseButton";const rR=pK;var Pbe=Object.defineProperty,Abe=Object.defineProperties,Mbe=Object.getOwnPropertyDescriptors,U5=Object.getOwnPropertySymbols,Rbe=Object.prototype.hasOwnProperty,Dbe=Object.prototype.propertyIsEnumerable,H5=(e,t,n)=>t in e?Pbe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Wx=(e,t)=>{for(var n in t||(t={}))Rbe.call(t,n)&&H5(e,n,t[n]);if(U5)for(var n of U5(t))Dbe.call(t,n)&&H5(e,n,t[n]);return e},Lbe=(e,t)=>Abe(e,Mbe(t));function Fbe({underline:e,strikethrough:t}){const n=[];return e&&n.push("underline"),t&&n.push("line-through"),n.length>0?n.join(" "):"none"}function zbe({theme:e,color:t}){return t==="dimmed"?e.fn.dimmed():typeof t=="string"&&(t in e.colors||t.split(".")[0]in e.colors)?e.fn.variant({variant:"filled",color:t}).background:t||"inherit"}function Bbe(e){return typeof e=="number"?{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:e,WebkitBoxOrient:"vertical"}:null}function Wbe({theme:e,truncate:t}){return t==="start"?{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",direction:e.dir==="ltr"?"rtl":"ltr",textAlign:e.dir==="ltr"?"right":"left"}:t?{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}:null}var Vbe=it((e,{color:t,lineClamp:n,truncate:r,inline:i,inherit:a,underline:s,gradient:o,weight:l,transform:u,align:c,strikethrough:d,italic:p},{size:h})=>{const m=e.fn.variant({variant:"gradient",gradient:o});return{root:Lbe(Wx(Wx(Wx(Wx({},e.fn.fontStyles()),e.fn.focusStyles()),Bbe(n)),Wbe({theme:e,truncate:r})),{color:zbe({color:t,theme:e}),fontFamily:a?"inherit":e.fontFamily,fontSize:a||h===void 0?"inherit":ke({size:h,sizes:e.fontSizes}),lineHeight:a?"inherit":i?1:e.lineHeight,textDecoration:Fbe({underline:s,strikethrough:d}),WebkitTapHighlightColor:"transparent",fontWeight:a?"inherit":l,textTransform:u,textAlign:c,fontStyle:p?"italic":void 0}),gradient:{backgroundImage:m.background,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}});const jbe=Vbe;var Ube=Object.defineProperty,cS=Object.getOwnPropertySymbols,hK=Object.prototype.hasOwnProperty,fK=Object.prototype.propertyIsEnumerable,G5=(e,t,n)=>t in e?Ube(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Hbe=(e,t)=>{for(var n in t||(t={}))hK.call(t,n)&&G5(e,n,t[n]);if(cS)for(var n of cS(t))fK.call(t,n)&&G5(e,n,t[n]);return e},Gbe=(e,t)=>{var n={};for(var r in e)hK.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&cS)for(var r of cS(e))t.indexOf(r)<0&&fK.call(e,r)&&(n[r]=e[r]);return n};const qbe={variant:"text"},mK=I.exports.forwardRef((e,t)=>{const n=Ke("Text",qbe,e),{className:r,size:i,weight:a,transform:s,color:o,align:l,variant:u,lineClamp:c,truncate:d,gradient:p,inline:h,inherit:m,underline:g,strikethrough:v,italic:y,classNames:b,styles:_,unstyled:k,span:C,__staticSelector:$}=n,N=Gbe(n,["className","size","weight","transform","color","align","variant","lineClamp","truncate","gradient","inline","inherit","underline","strikethrough","italic","classNames","styles","unstyled","span","__staticSelector"]),{classes:A,cx:D}=jbe({color:o,lineClamp:c,truncate:d,inline:h,inherit:m,underline:g,strikethrough:v,italic:y,weight:a,transform:s,align:l,gradient:p},{unstyled:k,name:$||"Text",variant:u,size:i});return x(wt,{...Hbe({ref:t,className:D(A.root,{[A.gradient]:u==="gradient"},r),component:C?"span":"div"},N)})});mK.displayName="@mantine/core/Text";const Te=mK,Kbe=I.exports.createContext({zIndex:1e3,fixed:!1,layout:"default"}),Zbe=Kbe.Provider;var Xbe=Object.defineProperty,q5=Object.getOwnPropertySymbols,Jbe=Object.prototype.hasOwnProperty,Ybe=Object.prototype.propertyIsEnumerable,K5=(e,t,n)=>t in e?Xbe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,gK=(e,t)=>{for(var n in t||(t={}))Jbe.call(t,n)&&K5(e,n,t[n]);if(q5)for(var n of q5(t))Ybe.call(t,n)&&K5(e,n,t[n]);return e};function Qbe(e,t){const n=ke({size:e.padding,sizes:t.spacing}),r=e.navbarOffsetBreakpoint?ke({size:e.navbarOffsetBreakpoint,sizes:t.breakpoints}):null,i=e.asideOffsetBreakpoint?ke({size:e.asideOffsetBreakpoint,sizes:t.breakpoints}):null;if(!e.fixed)return{padding:n};const a=Go(r),s=Go(i);return gK({minHeight:"100vh",paddingTop:`calc(var(--mantine-header-height, 0px) + ${n})`,paddingBottom:`calc(var(--mantine-footer-height, 0px) + ${n})`,paddingLeft:`calc(var(--mantine-navbar-width, 0px) + ${n})`,paddingRight:`calc(var(--mantine-aside-width, 0px) + ${n})`},a===s?{[`@media (max-width: ${Gc(a-1)})`]:{paddingLeft:n,paddingRight:n}}:{[`@media (max-width: ${Gc(a-1)})`]:{paddingLeft:n},[`@media (max-width: ${Gc(s-1)})`]:{paddingRight:n}})}var e1e=it((e,t)=>({root:{boxSizing:"border-box"},body:{display:"flex",boxSizing:"border-box"},main:gK({flex:1,width:"100vw",boxSizing:"border-box"},Qbe(t,e))}));const t1e=e1e;var n1e=Object.defineProperty,dS=Object.getOwnPropertySymbols,yK=Object.prototype.hasOwnProperty,vK=Object.prototype.propertyIsEnumerable,Z5=(e,t,n)=>t in e?n1e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,r1e=(e,t)=>{for(var n in t||(t={}))yK.call(t,n)&&Z5(e,n,t[n]);if(dS)for(var n of dS(t))vK.call(t,n)&&Z5(e,n,t[n]);return e},i1e=(e,t)=>{var n={};for(var r in e)yK.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&dS)for(var r of dS(e))t.indexOf(r)<0&&vK.call(e,r)&&(n[r]=e[r]);return n};const a1e={fixed:!0,padding:"md"},X_=I.exports.forwardRef((e,t)=>{const n=Ke("AppShell",a1e,e),{children:r,navbar:i,header:a,footer:s,aside:o,fixed:l,zIndex:u,padding:c,navbarOffsetBreakpoint:d,asideOffsetBreakpoint:p,className:h,styles:m,classNames:g,unstyled:v,hidden:y,layout:b,variant:_}=n,k=i1e(n,["children","navbar","header","footer","aside","fixed","zIndex","padding","navbarOffsetBreakpoint","asideOffsetBreakpoint","className","styles","classNames","unstyled","hidden","layout","variant"]),{classes:C,cx:$}=t1e({padding:c,fixed:l,navbarOffsetBreakpoint:d,asideOffsetBreakpoint:p},{styles:m,classNames:g,unstyled:v,name:"AppShell",variant:_});return y?x(ze,{children:r}):x(Zbe,{value:{fixed:l,zIndex:u,layout:b},children:B(wt,{...r1e({className:$(C.root,h),ref:t},k),children:[a,B("div",{className:C.body,children:[i,x("main",{className:C.main,children:r}),o]}),s]})})});X_.displayName="@mantine/core/AppShell";const Vx={xs:G(1),sm:G(2),md:G(3),lg:G(4),xl:G(5)};function jx(e,t){const n=e.fn.variant({variant:"outline",color:t}).border;return typeof t=="string"&&(t in e.colors||t.split(".")[0]in e.colors)?n:t===void 0?e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]:t}var s1e=it((e,{color:t},{size:n,variant:r})=>({root:{},withLabel:{borderTop:"0 !important"},left:{"&::before":{display:"none"}},right:{"&::after":{display:"none"}},label:{display:"flex",alignItems:"center","&::before":{content:'""',flex:1,height:G(1),borderTop:`${ke({size:n,sizes:Vx})} ${r} ${jx(e,t)}`,marginRight:e.spacing.xs},"&::after":{content:'""',flex:1,borderTop:`${ke({size:n,sizes:Vx})} ${r} ${jx(e,t)}`,marginLeft:e.spacing.xs}},labelDefaultStyles:{color:t==="dark"?e.colors.dark[1]:e.fn.themeColor(t,e.colorScheme==="dark"?5:e.fn.primaryShade(),!1)},horizontal:{border:0,borderTopWidth:G(ke({size:n,sizes:Vx})),borderTopColor:jx(e,t),borderTopStyle:r,margin:0},vertical:{border:0,alignSelf:"stretch",height:"auto",borderLeftWidth:G(ke({size:n,sizes:Vx})),borderLeftColor:jx(e,t),borderLeftStyle:r}}));const o1e=s1e;var l1e=Object.defineProperty,u1e=Object.defineProperties,c1e=Object.getOwnPropertyDescriptors,pS=Object.getOwnPropertySymbols,bK=Object.prototype.hasOwnProperty,wK=Object.prototype.propertyIsEnumerable,X5=(e,t,n)=>t in e?l1e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,J5=(e,t)=>{for(var n in t||(t={}))bK.call(t,n)&&X5(e,n,t[n]);if(pS)for(var n of pS(t))wK.call(t,n)&&X5(e,n,t[n]);return e},d1e=(e,t)=>u1e(e,c1e(t)),p1e=(e,t)=>{var n={};for(var r in e)bK.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&pS)for(var r of pS(e))t.indexOf(r)<0&&wK.call(e,r)&&(n[r]=e[r]);return n};const h1e={orientation:"horizontal",size:"xs",labelPosition:"left",variant:"solid"},Ds=I.exports.forwardRef((e,t)=>{const n=Ke("Divider",h1e,e),{className:r,color:i,orientation:a,size:s,label:o,labelPosition:l,labelProps:u,variant:c,styles:d,classNames:p,unstyled:h}=n,m=p1e(n,["className","color","orientation","size","label","labelPosition","labelProps","variant","styles","classNames","unstyled"]),{classes:g,cx:v}=o1e({color:i},{classNames:p,styles:d,unstyled:h,name:"Divider",variant:c,size:s}),y=a==="vertical",b=a==="horizontal",_=!!o&&b,k=!(u!=null&&u.color);return x(wt,{...J5({ref:t,className:v(g.root,{[g.vertical]:y,[g.horizontal]:b,[g.withLabel]:_},r),role:"separator"},m),children:_&&x(Te,{...d1e(J5({},u),{size:(u==null?void 0:u.size)||"xs",mt:G(2),className:v(g.label,g[l],{[g.labelDefaultStyles]:k})}),children:o})})});Ds.displayName="@mantine/core/Divider";var f1e=Object.defineProperty,m1e=Object.defineProperties,g1e=Object.getOwnPropertyDescriptors,Y5=Object.getOwnPropertySymbols,y1e=Object.prototype.hasOwnProperty,v1e=Object.prototype.propertyIsEnumerable,Q5=(e,t,n)=>t in e?f1e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,eW=(e,t)=>{for(var n in t||(t={}))y1e.call(t,n)&&Q5(e,n,t[n]);if(Y5)for(var n of Y5(t))v1e.call(t,n)&&Q5(e,n,t[n]);return e},b1e=(e,t)=>m1e(e,g1e(t)),w1e=it((e,t,{size:n})=>({item:b1e(eW({},e.fn.fontStyles()),{boxSizing:"border-box",wordBreak:"break-all",textAlign:"left",width:"100%",padding:`calc(${ke({size:n,sizes:e.spacing})} / 1.5) ${ke({size:n,sizes:e.spacing})}`,cursor:"pointer",fontSize:ke({size:n,sizes:e.fontSizes}),color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,borderRadius:e.fn.radius(),"&[data-hovered]":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[1]},"&[data-selected]":eW({backgroundColor:e.fn.variant({variant:"filled"}).background,color:e.fn.variant({variant:"filled"}).color},e.fn.hover({backgroundColor:e.fn.variant({variant:"filled"}).hover})),"&[data-disabled]":{cursor:"default",color:e.colors.dark[2]}}),nothingFound:{boxSizing:"border-box",color:e.colors.gray[6],paddingTop:`calc(${ke({size:n,sizes:e.spacing})} / 2)`,paddingBottom:`calc(${ke({size:n,sizes:e.spacing})} / 2)`,textAlign:"center"},separator:{boxSizing:"border-box",textAlign:"left",width:"100%",padding:`calc(${ke({size:n,sizes:e.spacing})} / 1.5) ${ke({size:n,sizes:e.spacing})}`},separatorLabel:{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5]}}));const x1e=w1e;var _1e=Object.defineProperty,tW=Object.getOwnPropertySymbols,k1e=Object.prototype.hasOwnProperty,S1e=Object.prototype.propertyIsEnumerable,nW=(e,t,n)=>t in e?_1e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,C1e=(e,t)=>{for(var n in t||(t={}))k1e.call(t,n)&&nW(e,n,t[n]);if(tW)for(var n of tW(t))S1e.call(t,n)&&nW(e,n,t[n]);return e};function iR({data:e,hovered:t,classNames:n,styles:r,isItemSelected:i,uuid:a,__staticSelector:s,onItemHover:o,onItemSelect:l,itemsRefs:u,itemComponent:c,size:d,nothingFound:p,creatable:h,createLabel:m,unstyled:g,variant:v}){const{classes:y}=x1e(null,{classNames:n,styles:r,unstyled:g,name:s,variant:v,size:d}),b=[],_=[];let k=null;const C=(N,A)=>{const D=typeof i=="function"?i(N.value):!1;return x(c,{...C1e({key:N.value,className:y.item,"data-disabled":N.disabled||void 0,"data-hovered":!N.disabled&&t===A||void 0,"data-selected":!N.disabled&&D||void 0,selected:D,onMouseEnter:()=>o(A),id:`${a}-${A}`,role:"option",tabIndex:-1,"aria-selected":t===A,ref:O=>{u&&u.current&&(u.current[N.value]=O)},onMouseDown:N.disabled?null:O=>{O.preventDefault(),l(N)},disabled:N.disabled,variant:v},N)})};let $=null;if(e.forEach((N,A)=>{N.creatable?k=A:N.group?($!==N.group&&($=N.group,_.push(x("div",{className:y.separator,children:x(Ds,{classNames:{label:y.separatorLabel},label:N.group})},`__mantine-divider-${A}`))),_.push(C(N,A))):b.push(C(N,A))}),h){const N=e[k];b.push(x("div",{className:y.item,"data-hovered":t===k||void 0,onMouseEnter:()=>o(k),onMouseDown:A=>{A.preventDefault(),l(N)},tabIndex:-1,ref:A=>{u&&u.current&&(u.current[N.value]=A)},children:m},vg()))}return _.length>0&&b.length>0&&b.unshift(x("div",{className:y.separator,children:x(Ds,{})},"empty-group-separator")),_.length>0||b.length>0?B(ze,{children:[_,b]}):x(Te,{size:d,unstyled:g,className:y.nothingFound,children:p})}iR.displayName="@mantine/core/SelectItems";var I1e=Object.defineProperty,hS=Object.getOwnPropertySymbols,xK=Object.prototype.hasOwnProperty,_K=Object.prototype.propertyIsEnumerable,rW=(e,t,n)=>t in e?I1e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$1e=(e,t)=>{for(var n in t||(t={}))xK.call(t,n)&&rW(e,n,t[n]);if(hS)for(var n of hS(t))_K.call(t,n)&&rW(e,n,t[n]);return e},T1e=(e,t)=>{var n={};for(var r in e)xK.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&hS)for(var r of hS(e))t.indexOf(r)<0&&_K.call(e,r)&&(n[r]=e[r]);return n};const aR=I.exports.forwardRef((e,t)=>{var n=e,{label:r,value:i}=n,a=T1e(n,["label","value"]);return x("div",{...$1e({ref:t},a),children:r||i})});aR.displayName="@mantine/core/DefaultItem";function N1e(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function kK(...e){return t=>e.forEach(n=>N1e(n,t))}function Ih(...e){return I.exports.useCallback(kK(...e),e)}const SK=I.exports.forwardRef((e,t)=>{const{children:n,...r}=e,i=I.exports.Children.toArray(n),a=i.find(O1e);if(a){const s=a.props.children,o=i.map(l=>l===a?I.exports.Children.count(s)>1?I.exports.Children.only(null):I.exports.isValidElement(s)?s.props.children:null:l);return I.exports.createElement(qO,ar({},r,{ref:t}),I.exports.isValidElement(s)?I.exports.cloneElement(s,void 0,o):null)}return I.exports.createElement(qO,ar({},r,{ref:t}),n)});SK.displayName="Slot";const qO=I.exports.forwardRef((e,t)=>{const{children:n,...r}=e;return I.exports.isValidElement(n)?I.exports.cloneElement(n,{...P1e(r,n.props),ref:kK(t,n.ref)}):I.exports.Children.count(n)>1?I.exports.Children.only(null):null});qO.displayName="SlotClone";const E1e=({children:e})=>I.exports.createElement(I.exports.Fragment,null,e);function O1e(e){return I.exports.isValidElement(e)&&e.type===E1e}function P1e(e,t){const n={...t};for(const r in t){const i=e[r],a=t[r];/^on[A-Z]/.test(r)?i&&a?n[r]=(...o)=>{a(...o),i(...o)}:i&&(n[r]=i):r==="style"?n[r]={...i,...a}:r==="className"&&(n[r]=[i,a].filter(Boolean).join(" "))}return{...e,...n}}const A1e=["a","button","div","h2","h3","img","label","li","nav","ol","p","span","svg","ul"],F1=A1e.reduce((e,t)=>{const n=I.exports.forwardRef((r,i)=>{const{asChild:a,...s}=r,o=a?SK:t;return I.exports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),I.exports.createElement(o,ar({},s,{ref:i}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),KO=Boolean(globalThis==null?void 0:globalThis.document)?I.exports.useLayoutEffect:()=>{};function M1e(e,t){return I.exports.useReducer((n,r)=>{const i=t[n][r];return i!=null?i:n},e)}const z1=e=>{const{present:t,children:n}=e,r=R1e(t),i=typeof n=="function"?n({present:r.isPresent}):I.exports.Children.only(n),a=Ih(r.ref,i.ref);return typeof n=="function"||r.isPresent?I.exports.cloneElement(i,{ref:a}):null};z1.displayName="Presence";function R1e(e){const[t,n]=I.exports.useState(),r=I.exports.useRef({}),i=I.exports.useRef(e),a=I.exports.useRef("none"),s=e?"mounted":"unmounted",[o,l]=M1e(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return I.exports.useEffect(()=>{const u=Ux(r.current);a.current=o==="mounted"?u:"none"},[o]),KO(()=>{const u=r.current,c=i.current;if(c!==e){const p=a.current,h=Ux(u);e?l("MOUNT"):h==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&p!==h?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,l]),KO(()=>{if(t){const u=d=>{const h=Ux(r.current).includes(d.animationName);d.target===t&&h&&ql.exports.flushSync(()=>l("ANIMATION_END"))},c=d=>{d.target===t&&(a.current=Ux(r.current))};return t.addEventListener("animationstart",c),t.addEventListener("animationcancel",u),t.addEventListener("animationend",u),()=>{t.removeEventListener("animationstart",c),t.removeEventListener("animationcancel",u),t.removeEventListener("animationend",u)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:I.exports.useCallback(u=>{u&&(r.current=getComputedStyle(u)),n(u)},[])}}function Ux(e){return(e==null?void 0:e.animationName)||"none"}function D1e(e,t=[]){let n=[];function r(a,s){const o=I.exports.createContext(s),l=n.length;n=[...n,s];function u(d){const{scope:p,children:h,...m}=d,g=(p==null?void 0:p[e][l])||o,v=I.exports.useMemo(()=>m,Object.values(m));return I.exports.createElement(g.Provider,{value:v},h)}function c(d,p){const h=(p==null?void 0:p[e][l])||o,m=I.exports.useContext(h);if(m)return m;if(s!==void 0)return s;throw new Error(`\`${d}\` must be used within \`${a}\``)}return u.displayName=a+"Provider",[u,c]}const i=()=>{const a=n.map(s=>I.exports.createContext(s));return function(o){const l=(o==null?void 0:o[e])||a;return I.exports.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return i.scopeName=e,[r,L1e(i,...t)]}function L1e(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(a){const s=r.reduce((o,{useScope:l,scopeName:u})=>{const d=l(a)[`__scope${u}`];return{...o,...d}},{});return I.exports.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return n.scopeName=t.scopeName,n}function dp(e){const t=I.exports.useRef(e);return I.exports.useEffect(()=>{t.current=e}),I.exports.useMemo(()=>(...n)=>{var r;return(r=t.current)===null||r===void 0?void 0:r.call(t,...n)},[])}const F1e=I.exports.createContext(void 0);function z1e(e){const t=I.exports.useContext(F1e);return e||t||"ltr"}function B1e(e,[t,n]){return Math.min(n,Math.max(t,e))}function Op(e,t,{checkForDefaultPrevented:n=!0}={}){return function(i){if(e==null||e(i),n===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function W1e(e,t){return I.exports.useReducer((n,r)=>{const i=t[n][r];return i!=null?i:n},e)}const CK="ScrollArea",[IK,X2t]=D1e(CK),[V1e,mo]=IK(CK),j1e=I.exports.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:i,scrollHideDelay:a=600,...s}=e,[o,l]=I.exports.useState(null),[u,c]=I.exports.useState(null),[d,p]=I.exports.useState(null),[h,m]=I.exports.useState(null),[g,v]=I.exports.useState(null),[y,b]=I.exports.useState(0),[_,k]=I.exports.useState(0),[C,$]=I.exports.useState(!1),[N,A]=I.exports.useState(!1),D=Ih(t,F=>l(F)),O=z1e(i);return I.exports.createElement(V1e,{scope:n,type:r,dir:O,scrollHideDelay:a,scrollArea:o,viewport:u,onViewportChange:c,content:d,onContentChange:p,scrollbarX:h,onScrollbarXChange:m,scrollbarXEnabled:C,onScrollbarXEnabledChange:$,scrollbarY:g,onScrollbarYChange:v,scrollbarYEnabled:N,onScrollbarYEnabledChange:A,onCornerWidthChange:b,onCornerHeightChange:k},I.exports.createElement(F1.div,ar({dir:O},s,{ref:D,style:{position:"relative",["--radix-scroll-area-corner-width"]:y+"px",["--radix-scroll-area-corner-height"]:_+"px",...e.style}})))}),U1e="ScrollAreaViewport",H1e=I.exports.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,...i}=e,a=mo(U1e,n),s=I.exports.useRef(null),o=Ih(t,s,a.onViewportChange);return I.exports.createElement(I.exports.Fragment,null,I.exports.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"}}),I.exports.createElement(F1.div,ar({"data-radix-scroll-area-viewport":""},i,{ref:o,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style}}),I.exports.createElement("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"}},r)))}),Wu="ScrollAreaScrollbar",G1e=I.exports.forwardRef((e,t)=>{const{forceMount:n,...r}=e,i=mo(Wu,e.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:s}=i,o=e.orientation==="horizontal";return I.exports.useEffect(()=>(o?a(!0):s(!0),()=>{o?a(!1):s(!1)}),[o,a,s]),i.type==="hover"?I.exports.createElement(q1e,ar({},r,{ref:t,forceMount:n})):i.type==="scroll"?I.exports.createElement(K1e,ar({},r,{ref:t,forceMount:n})):i.type==="auto"?I.exports.createElement($K,ar({},r,{ref:t,forceMount:n})):i.type==="always"?I.exports.createElement(sR,ar({},r,{ref:t})):null}),q1e=I.exports.forwardRef((e,t)=>{const{forceMount:n,...r}=e,i=mo(Wu,e.__scopeScrollArea),[a,s]=I.exports.useState(!1);return I.exports.useEffect(()=>{const o=i.scrollArea;let l=0;if(o){const u=()=>{window.clearTimeout(l),s(!0)},c=()=>{l=window.setTimeout(()=>s(!1),i.scrollHideDelay)};return o.addEventListener("pointerenter",u),o.addEventListener("pointerleave",c),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",u),o.removeEventListener("pointerleave",c)}}},[i.scrollArea,i.scrollHideDelay]),I.exports.createElement(z1,{present:n||a},I.exports.createElement($K,ar({"data-state":a?"visible":"hidden"},r,{ref:t})))}),K1e=I.exports.forwardRef((e,t)=>{const{forceMount:n,...r}=e,i=mo(Wu,e.__scopeScrollArea),a=e.orientation==="horizontal",s=E2(()=>l("SCROLL_END"),100),[o,l]=W1e("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return I.exports.useEffect(()=>{if(o==="idle"){const u=window.setTimeout(()=>l("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(u)}},[o,i.scrollHideDelay,l]),I.exports.useEffect(()=>{const u=i.viewport,c=a?"scrollLeft":"scrollTop";if(u){let d=u[c];const p=()=>{const h=u[c];d!==h&&(l("SCROLL"),s()),d=h};return u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[i.viewport,a,l,s]),I.exports.createElement(z1,{present:n||o!=="hidden"},I.exports.createElement(sR,ar({"data-state":o==="hidden"?"hidden":"visible"},r,{ref:t,onPointerEnter:Op(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Op(e.onPointerLeave,()=>l("POINTER_LEAVE"))})))}),$K=I.exports.forwardRef((e,t)=>{const n=mo(Wu,e.__scopeScrollArea),{forceMount:r,...i}=e,[a,s]=I.exports.useState(!1),o=e.orientation==="horizontal",l=E2(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,c=n.viewport.offsetHeight<n.viewport.scrollHeight;s(o?u:c)}},10);return Wg(n.viewport,l),Wg(n.content,l),I.exports.createElement(z1,{present:r||a},I.exports.createElement(sR,ar({"data-state":a?"visible":"hidden"},i,{ref:t})))}),sR=I.exports.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,i=mo(Wu,e.__scopeScrollArea),a=I.exports.useRef(null),s=I.exports.useRef(0),[o,l]=I.exports.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=OK(o.viewport,o.content),c={...r,sizes:o,onSizesChange:l,hasThumb:Boolean(u>0&&u<1),onThumbChange:p=>a.current=p,onThumbPointerUp:()=>s.current=0,onThumbPointerDown:p=>s.current=p};function d(p,h){return nwe(p,s.current,o,h)}return n==="horizontal"?I.exports.createElement(Z1e,ar({},c,{ref:t,onThumbPositionChange:()=>{if(i.viewport&&a.current){const p=i.viewport.scrollLeft,h=iW(p,o,i.dir);a.current.style.transform=`translate3d(${h}px, 0, 0)`}},onWheelScroll:p=>{i.viewport&&(i.viewport.scrollLeft=p)},onDragScroll:p=>{i.viewport&&(i.viewport.scrollLeft=d(p,i.dir))}})):n==="vertical"?I.exports.createElement(X1e,ar({},c,{ref:t,onThumbPositionChange:()=>{if(i.viewport&&a.current){const p=i.viewport.scrollTop,h=iW(p,o);a.current.style.transform=`translate3d(0, ${h}px, 0)`}},onWheelScroll:p=>{i.viewport&&(i.viewport.scrollTop=p)},onDragScroll:p=>{i.viewport&&(i.viewport.scrollTop=d(p))}})):null}),Z1e=I.exports.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...i}=e,a=mo(Wu,e.__scopeScrollArea),[s,o]=I.exports.useState(),l=I.exports.useRef(null),u=Ih(t,l,a.onScrollbarXChange);return I.exports.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),I.exports.createElement(NK,ar({"data-orientation":"horizontal"},i,{ref:u,sizes:n,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,["--radix-scroll-area-thumb-width"]:N2(n)+"px",...e.style},onThumbPointerDown:c=>e.onThumbPointerDown(c.x),onDragScroll:c=>e.onDragScroll(c.x),onWheelScroll:(c,d)=>{if(a.viewport){const p=a.viewport.scrollLeft+c.deltaX;e.onWheelScroll(p),AK(p,d)&&c.preventDefault()}},onResize:()=>{l.current&&a.viewport&&s&&r({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:fS(s.paddingLeft),paddingEnd:fS(s.paddingRight)}})}}))}),X1e=I.exports.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...i}=e,a=mo(Wu,e.__scopeScrollArea),[s,o]=I.exports.useState(),l=I.exports.useRef(null),u=Ih(t,l,a.onScrollbarYChange);return I.exports.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),I.exports.createElement(NK,ar({"data-orientation":"vertical"},i,{ref:u,sizes:n,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)",["--radix-scroll-area-thumb-height"]:N2(n)+"px",...e.style},onThumbPointerDown:c=>e.onThumbPointerDown(c.y),onDragScroll:c=>e.onDragScroll(c.y),onWheelScroll:(c,d)=>{if(a.viewport){const p=a.viewport.scrollTop+c.deltaY;e.onWheelScroll(p),AK(p,d)&&c.preventDefault()}},onResize:()=>{l.current&&a.viewport&&s&&r({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:fS(s.paddingTop),paddingEnd:fS(s.paddingBottom)}})}}))}),[J1e,TK]=IK(Wu),NK=I.exports.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:i,onThumbChange:a,onThumbPointerUp:s,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:u,onWheelScroll:c,onResize:d,...p}=e,h=mo(Wu,n),[m,g]=I.exports.useState(null),v=Ih(t,D=>g(D)),y=I.exports.useRef(null),b=I.exports.useRef(""),_=h.viewport,k=r.content-r.viewport,C=dp(c),$=dp(l),N=E2(d,10);function A(D){if(y.current){const O=D.clientX-y.current.left,F=D.clientY-y.current.top;u({x:O,y:F})}}return I.exports.useEffect(()=>{const D=O=>{const F=O.target;(m==null?void 0:m.contains(F))&&C(O,k)};return document.addEventListener("wheel",D,{passive:!1}),()=>document.removeEventListener("wheel",D,{passive:!1})},[_,m,k,C]),I.exports.useEffect($,[r,$]),Wg(m,N),Wg(h.content,N),I.exports.createElement(J1e,{scope:n,scrollbar:m,hasThumb:i,onThumbChange:dp(a),onThumbPointerUp:dp(s),onThumbPositionChange:$,onThumbPointerDown:dp(o)},I.exports.createElement(F1.div,ar({},p,{ref:v,style:{position:"absolute",...p.style},onPointerDown:Op(e.onPointerDown,D=>{D.button===0&&(D.target.setPointerCapture(D.pointerId),y.current=m.getBoundingClientRect(),b.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",A(D))}),onPointerMove:Op(e.onPointerMove,A),onPointerUp:Op(e.onPointerUp,D=>{const O=D.target;O.hasPointerCapture(D.pointerId)&&O.releasePointerCapture(D.pointerId),document.body.style.webkitUserSelect=b.current,y.current=null})})))}),ZO="ScrollAreaThumb",Y1e=I.exports.forwardRef((e,t)=>{const{forceMount:n,...r}=e,i=TK(ZO,e.__scopeScrollArea);return I.exports.createElement(z1,{present:n||i.hasThumb},I.exports.createElement(Q1e,ar({ref:t},r)))}),Q1e=I.exports.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...i}=e,a=mo(ZO,n),s=TK(ZO,n),{onThumbPositionChange:o}=s,l=Ih(t,d=>s.onThumbChange(d)),u=I.exports.useRef(),c=E2(()=>{u.current&&(u.current(),u.current=void 0)},100);return I.exports.useEffect(()=>{const d=a.viewport;if(d){const p=()=>{if(c(),!u.current){const h=rwe(d,o);u.current=h,o()}};return o(),d.addEventListener("scroll",p),()=>d.removeEventListener("scroll",p)}},[a.viewport,c,o]),I.exports.createElement(F1.div,ar({"data-state":s.hasThumb?"visible":"hidden"},i,{ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Op(e.onPointerDownCapture,d=>{const h=d.target.getBoundingClientRect(),m=d.clientX-h.left,g=d.clientY-h.top;s.onThumbPointerDown({x:m,y:g})}),onPointerUp:Op(e.onPointerUp,s.onThumbPointerUp)}))}),EK="ScrollAreaCorner",ewe=I.exports.forwardRef((e,t)=>{const n=mo(EK,e.__scopeScrollArea),r=Boolean(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?I.exports.createElement(twe,ar({},e,{ref:t})):null}),twe=I.exports.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,i=mo(EK,n),[a,s]=I.exports.useState(0),[o,l]=I.exports.useState(0),u=Boolean(a&&o);return Wg(i.scrollbarX,()=>{var c;const d=((c=i.scrollbarX)===null||c===void 0?void 0:c.offsetHeight)||0;i.onCornerHeightChange(d),l(d)}),Wg(i.scrollbarY,()=>{var c;const d=((c=i.scrollbarY)===null||c===void 0?void 0:c.offsetWidth)||0;i.onCornerWidthChange(d),s(d)}),u?I.exports.createElement(F1.div,ar({},r,{ref:t,style:{width:a,height:o,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...e.style}})):null});function fS(e){return e?parseInt(e,10):0}function OK(e,t){const n=e/t;return isNaN(n)?0:n}function N2(e){const t=OK(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function nwe(e,t,n,r="ltr"){const i=N2(n),a=i/2,s=t||a,o=i-s,l=n.scrollbar.paddingStart+s,u=n.scrollbar.size-n.scrollbar.paddingEnd-o,c=n.content-n.viewport,d=r==="ltr"?[0,c]:[c*-1,0];return PK([l,u],d)(e)}function iW(e,t,n="ltr"){const r=N2(t),i=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=t.scrollbar.size-i,s=t.content-t.viewport,o=a-r,l=n==="ltr"?[0,s]:[s*-1,0],u=B1e(e,l);return PK([0,s],[0,o])(u)}function PK(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function AK(e,t){return e>0&&e<t}const rwe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function i(){const a={left:e.scrollLeft,top:e.scrollTop},s=n.left!==a.left,o=n.top!==a.top;(s||o)&&t(),n=a,r=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(r)};function E2(e,t){const n=dp(e),r=I.exports.useRef(0);return I.exports.useEffect(()=>()=>window.clearTimeout(r.current),[]),I.exports.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Wg(e,t){const n=dp(t);KO(()=>{let r=0;if(e){const i=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return i.observe(e),()=>{window.cancelAnimationFrame(r),i.unobserve(e)}}},[e,n])}const iwe=j1e,awe=H1e,aW=G1e,sW=Y1e,swe=ewe;var owe=it((e,{scrollbarSize:t,offsetScrollbars:n,scrollbarHovered:r,hidden:i})=>({root:{overflow:"hidden"},viewport:{width:"100%",height:"100%",paddingRight:n?G(t):void 0,paddingBottom:n?G(t):void 0},scrollbar:{display:i?"none":"flex",userSelect:"none",touchAction:"none",boxSizing:"border-box",padding:`calc(${G(t)}  / 5)`,transition:"background-color 150ms ease, opacity 150ms ease","&:hover":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[8]:e.colors.gray[0],[`& .${zo("thumb")}`]:{backgroundColor:e.colorScheme==="dark"?e.fn.rgba(e.white,.5):e.fn.rgba(e.black,.5)}},'&[data-orientation="vertical"]':{width:G(t)},'&[data-orientation="horizontal"]':{flexDirection:"column",height:G(t)},'&[data-state="hidden"]':{display:"none",opacity:0}},thumb:{ref:zo("thumb"),flex:1,backgroundColor:e.colorScheme==="dark"?e.fn.rgba(e.white,.4):e.fn.rgba(e.black,.4),borderRadius:G(t),position:"relative",transition:"background-color 150ms ease",display:i?"none":void 0,overflow:"hidden","&::before":{content:'""',position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",height:"100%",minWidth:G(44),minHeight:G(44)}},corner:{backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[0],transition:"opacity 150ms ease",opacity:r?1:0,display:i?"none":void 0}}));const lwe=owe;var uwe=Object.defineProperty,cwe=Object.defineProperties,dwe=Object.getOwnPropertyDescriptors,mS=Object.getOwnPropertySymbols,MK=Object.prototype.hasOwnProperty,RK=Object.prototype.propertyIsEnumerable,oW=(e,t,n)=>t in e?uwe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,XO=(e,t)=>{for(var n in t||(t={}))MK.call(t,n)&&oW(e,n,t[n]);if(mS)for(var n of mS(t))RK.call(t,n)&&oW(e,n,t[n]);return e},DK=(e,t)=>cwe(e,dwe(t)),LK=(e,t)=>{var n={};for(var r in e)MK.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&mS)for(var r of mS(e))t.indexOf(r)<0&&RK.call(e,r)&&(n[r]=e[r]);return n};const FK={scrollbarSize:12,scrollHideDelay:1e3,type:"hover",offsetScrollbars:!1},O2=I.exports.forwardRef((e,t)=>{const n=Ke("ScrollArea",FK,e),{children:r,className:i,classNames:a,styles:s,scrollbarSize:o,scrollHideDelay:l,type:u,dir:c,offsetScrollbars:d,viewportRef:p,onScrollPositionChange:h,unstyled:m,variant:g,viewportProps:v}=n,y=LK(n,["children","className","classNames","styles","scrollbarSize","scrollHideDelay","type","dir","offsetScrollbars","viewportRef","onScrollPositionChange","unstyled","variant","viewportProps"]),[b,_]=I.exports.useState(!1),k=Ka(),{classes:C,cx:$}=lwe({scrollbarSize:o,offsetScrollbars:d,scrollbarHovered:b,hidden:u==="never"},{name:"ScrollArea",classNames:a,styles:s,unstyled:m,variant:g});return x(iwe,{type:u==="never"?"always":u,scrollHideDelay:l,dir:c||k.dir,ref:t,asChild:!0,children:B(wt,{...XO({className:$(C.root,i)},y),children:[x(awe,{...DK(XO({},v),{className:C.viewport,ref:p,onScroll:typeof h=="function"?({currentTarget:N})=>h({x:N.scrollLeft,y:N.scrollTop}):void 0}),children:r}),x(aW,{orientation:"horizontal",className:C.scrollbar,forceMount:!0,onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),children:x(sW,{className:C.thumb})}),x(aW,{orientation:"vertical",className:C.scrollbar,forceMount:!0,onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),children:x(sW,{className:C.thumb})}),x(swe,{className:C.corner})]})})}),zK=I.exports.forwardRef((e,t)=>{const n=Ke("ScrollAreaAutosize",FK,e),{children:r,classNames:i,styles:a,scrollbarSize:s,scrollHideDelay:o,type:l,dir:u,offsetScrollbars:c,viewportRef:d,onScrollPositionChange:p,unstyled:h,sx:m,variant:g,viewportProps:v}=n,y=LK(n,["children","classNames","styles","scrollbarSize","scrollHideDelay","type","dir","offsetScrollbars","viewportRef","onScrollPositionChange","unstyled","sx","variant","viewportProps"]);return Ni.createElement(wt,DK(XO({},y),{ref:t,sx:[{display:"flex"},...UM(m)]}),Ni.createElement(wt,{sx:{display:"flex",flexDirection:"column",flex:1}},Ni.createElement(O2,{classNames:i,styles:a,scrollHideDelay:o,scrollbarSize:s,type:l,dir:u,offsetScrollbars:c,viewportRef:d,onScrollPositionChange:p,unstyled:h,variant:g,viewportProps:v},r)))});zK.displayName="@mantine/core/ScrollAreaAutosize";O2.displayName="@mantine/core/ScrollArea";O2.Autosize=zK;const An=O2;var pwe=Object.defineProperty,hwe=Object.defineProperties,fwe=Object.getOwnPropertyDescriptors,gS=Object.getOwnPropertySymbols,BK=Object.prototype.hasOwnProperty,WK=Object.prototype.propertyIsEnumerable,lW=(e,t,n)=>t in e?pwe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,uW=(e,t)=>{for(var n in t||(t={}))BK.call(t,n)&&lW(e,n,t[n]);if(gS)for(var n of gS(t))WK.call(t,n)&&lW(e,n,t[n]);return e},mwe=(e,t)=>hwe(e,fwe(t)),gwe=(e,t)=>{var n={};for(var r in e)BK.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&gS)for(var r of gS(e))t.indexOf(r)<0&&WK.call(e,r)&&(n[r]=e[r]);return n};const P2=I.exports.forwardRef((e,t)=>{var n=e,{style:r}=n,i=gwe(n,["style"]);return x(An,{...mwe(uW({},i),{style:uW({width:"100%"},r),viewportProps:{tabIndex:-1},viewportRef:t}),children:i.children})});P2.displayName="@mantine/core/SelectScrollArea";var ywe=it(()=>({dropdown:{},itemsWrapper:{padding:G(4),display:"flex",width:"100%",boxSizing:"border-box"}}));const vwe=ywe;function Ty(e){return e.split("-")[1]}function oR(e){return e==="y"?"height":"width"}function Ko(e){return e.split("-")[0]}function Id(e){return["top","bottom"].includes(Ko(e))?"x":"y"}function cW(e,t,n){let{reference:r,floating:i}=e;const a=r.x+r.width/2-i.width/2,s=r.y+r.height/2-i.height/2,o=Id(t),l=oR(o),u=r[l]/2-i[l]/2,c=Ko(t),d=o==="x";let p;switch(c){case"top":p={x:a,y:r.y-i.height};break;case"bottom":p={x:a,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:s};break;case"left":p={x:r.x-i.width,y:s};break;default:p={x:r.x,y:r.y}}switch(Ty(t)){case"start":p[o]-=u*(n&&d?-1:1);break;case"end":p[o]+=u*(n&&d?-1:1);break}return p}const bwe=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:a=[],platform:s}=n,o=a.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(t));let u=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:c,y:d}=cW(u,r,l),p=r,h={},m=0;for(let g=0;g<o.length;g++){const{name:v,fn:y}=o[g],{x:b,y:_,data:k,reset:C}=await y({x:c,y:d,initialPlacement:r,placement:p,strategy:i,middlewareData:h,rects:u,platform:s,elements:{reference:e,floating:t}});if(c=b!=null?b:c,d=_!=null?_:d,h={...h,[v]:{...h[v],...k}},C&&m<=50){m++,typeof C=="object"&&(C.placement&&(p=C.placement),C.rects&&(u=C.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:i}):C.rects),{x:c,y:d}=cW(u,p,l)),g=-1;continue}}return{x:c,y:d,placement:p,strategy:i,middlewareData:h}};function Ou(e,t){return typeof e=="function"?e(t):e}function wwe(e){return{top:0,right:0,bottom:0,left:0,...e}}function lR(e){return typeof e!="number"?wwe(e):{top:e,right:e,bottom:e,left:e}}function Vg(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function uR(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:a,rects:s,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:p=!1,padding:h=0}=Ou(t,e),m=lR(h),v=o[p?d==="floating"?"reference":"floating":d],y=Vg(await a.getClippingRect({element:(n=await(a.isElement==null?void 0:a.isElement(v)))==null||n?v:v.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(o.floating)),boundary:u,rootBoundary:c,strategy:l})),b=d==="floating"?{...s.floating,x:r,y:i}:s.reference,_=await(a.getOffsetParent==null?void 0:a.getOffsetParent(o.floating)),k=await(a.isElement==null?void 0:a.isElement(_))?await(a.getScale==null?void 0:a.getScale(_))||{x:1,y:1}:{x:1,y:1},C=Vg(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({rect:b,offsetParent:_,strategy:l}):b);return{top:(y.top-C.top+m.top)/k.y,bottom:(C.bottom-y.bottom+m.bottom)/k.y,left:(y.left-C.left+m.left)/k.x,right:(C.right-y.right+m.right)/k.x}}const rd=Math.min,xl=Math.max;function JO(e,t,n){return xl(e,rd(t,n))}const dW=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:i,rects:a,platform:s,elements:o}=t,{element:l,padding:u=0}=Ou(e,t)||{};if(l==null)return{};const c=lR(u),d={x:n,y:r},p=Id(i),h=oR(p),m=await s.getDimensions(l),g=p==="y",v=g?"top":"left",y=g?"bottom":"right",b=g?"clientHeight":"clientWidth",_=a.reference[h]+a.reference[p]-d[p]-a.floating[h],k=d[p]-a.reference[p],C=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l));let $=C?C[b]:0;(!$||!await(s.isElement==null?void 0:s.isElement(C)))&&($=o.floating[b]||a.floating[h]);const N=_/2-k/2,A=$/2-m[h]/2-1,D=rd(c[v],A),O=rd(c[y],A),F=D,E=$-m[h]-O,z=$/2-m[h]/2+N,q=JO(F,z,E),J=Ty(i)!=null&&z!=q&&a.reference[h]/2-(z<F?D:O)-m[h]/2<0?z<F?F-z:E-z:0;return{[p]:d[p]-J,data:{[p]:q,centerOffset:z-q+J}}}}),xwe={left:"right",right:"left",bottom:"top",top:"bottom"};function yS(e){return e.replace(/left|right|bottom|top/g,t=>xwe[t])}function _we(e,t,n){n===void 0&&(n=!1);const r=Ty(e),i=Id(e),a=oR(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(s=yS(s)),{main:s,cross:yS(s)}}const kwe={start:"end",end:"start"};function YO(e){return e.replace(/start|end/g,t=>kwe[t])}function Swe(e){const t=yS(e);return[YO(e),t,YO(t)]}function Cwe(e,t,n){const r=["left","right"],i=["right","left"],a=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?a:s;default:return[]}}function Iwe(e,t,n,r){const i=Ty(e);let a=Cwe(Ko(e),n==="start",r);return i&&(a=a.map(s=>s+"-"+i),t&&(a=a.concat(a.map(YO)))),a}const VK=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n;const{placement:r,middlewareData:i,rects:a,initialPlacement:s,platform:o,elements:l}=t,{mainAxis:u=!0,crossAxis:c=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:m=!0,...g}=Ou(e,t),v=Ko(r),y=Ko(s)===s,b=await(o.isRTL==null?void 0:o.isRTL(l.floating)),_=d||(y||!m?[yS(s)]:Swe(s));!d&&h!=="none"&&_.push(...Iwe(s,m,h,b));const k=[s,..._],C=await uR(t,g),$=[];let N=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&$.push(C[v]),c){const{main:F,cross:E}=_we(r,a,b);$.push(C[F],C[E])}if(N=[...N,{placement:r,overflows:$}],!$.every(F=>F<=0)){var A,D;const F=(((A=i.flip)==null?void 0:A.index)||0)+1,E=k[F];if(E)return{data:{index:F,overflows:N},reset:{placement:E}};let z=(D=N.filter(q=>q.overflows[0]<=0).sort((q,H)=>q.overflows[1]-H.overflows[1])[0])==null?void 0:D.placement;if(!z)switch(p){case"bestFit":{var O;const q=(O=N.map(H=>[H.placement,H.overflows.filter(J=>J>0).reduce((J,ee)=>J+ee,0)]).sort((H,J)=>H[1]-J[1])[0])==null?void 0:O[0];q&&(z=q);break}case"initialPlacement":z=s;break}if(r!==z)return{reset:{placement:z}}}return{}}}};function jK(e){const t=rd(...e.map(a=>a.left)),n=rd(...e.map(a=>a.top)),r=xl(...e.map(a=>a.right)),i=xl(...e.map(a=>a.bottom));return{x:t,y:n,width:r-t,height:i-n}}function $we(e){const t=e.slice().sort((i,a)=>i.y-a.y),n=[];let r=null;for(let i=0;i<t.length;i++){const a=t[i];!r||a.y-r.y>r.height/2?n.push([a]):n[n.length-1].push(a),r=a}return n.map(i=>Vg(jK(i)))}const UK=function(e){return e===void 0&&(e={}),{name:"inline",options:e,async fn(t){const{placement:n,elements:r,rects:i,platform:a,strategy:s}=t,{padding:o=2,x:l,y:u}=Ou(e,t),c=Array.from(await(a.getClientRects==null?void 0:a.getClientRects(r.reference))||[]),d=$we(c),p=Vg(jK(c)),h=lR(o);function m(){if(d.length===2&&d[0].left>d[1].right&&l!=null&&u!=null)return d.find(v=>l>v.left-h.left&&l<v.right+h.right&&u>v.top-h.top&&u<v.bottom+h.bottom)||p;if(d.length>=2){if(Id(n)==="x"){const O=d[0],F=d[d.length-1],E=Ko(n)==="top",z=O.top,q=F.bottom,H=E?O.left:F.left,J=E?O.right:F.right,ee=J-H,V=q-z;return{top:z,bottom:q,left:H,right:J,width:ee,height:V,x:H,y:z}}const v=Ko(n)==="left",y=xl(...d.map(O=>O.right)),b=rd(...d.map(O=>O.left)),_=d.filter(O=>v?O.left===b:O.right===y),k=_[0].top,C=_[_.length-1].bottom,$=b,N=y,A=N-$,D=C-k;return{top:k,bottom:C,left:$,right:N,width:A,height:D,x:$,y:k}}return p}const g=await a.getElementRects({reference:{getBoundingClientRect:m},floating:r.floating,strategy:s});return i.reference.x!==g.reference.x||i.reference.y!==g.reference.y||i.reference.width!==g.reference.width||i.reference.height!==g.reference.height?{reset:{rects:g}}:{}}}};async function Twe(e,t){const{placement:n,platform:r,elements:i}=e,a=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=Ko(n),o=Ty(n),l=Id(n)==="x",u=["left","top"].includes(s)?-1:1,c=a&&l?-1:1,d=Ou(t,e);let{mainAxis:p,crossAxis:h,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return o&&typeof m=="number"&&(h=o==="end"?m*-1:m),l?{x:h*c,y:p*u}:{x:p*u,y:h*c}}const HK=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){const{x:n,y:r}=t,i=await Twe(t,e);return{x:n+i.x,y:r+i.y,data:i}}}};function GK(e){return e==="x"?"y":"x"}const cR=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:a=!0,crossAxis:s=!1,limiter:o={fn:v=>{let{x:y,y:b}=v;return{x:y,y:b}}},...l}=Ou(e,t),u={x:n,y:r},c=await uR(t,l),d=Id(Ko(i)),p=GK(d);let h=u[d],m=u[p];if(a){const v=d==="y"?"top":"left",y=d==="y"?"bottom":"right",b=h+c[v],_=h-c[y];h=JO(b,h,_)}if(s){const v=p==="y"?"top":"left",y=p==="y"?"bottom":"right",b=m+c[v],_=m-c[y];m=JO(b,m,_)}const g=o.fn({...t,[d]:h,[p]:m});return{...g,data:{x:g.x-n,y:g.y-r}}}}},Nwe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:i,rects:a,middlewareData:s}=t,{offset:o=0,mainAxis:l=!0,crossAxis:u=!0}=Ou(e,t),c={x:n,y:r},d=Id(i),p=GK(d);let h=c[d],m=c[p];const g=Ou(o,t),v=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const _=d==="y"?"height":"width",k=a.reference[d]-a.floating[_]+v.mainAxis,C=a.reference[d]+a.reference[_]-v.mainAxis;h<k?h=k:h>C&&(h=C)}if(u){var y,b;const _=d==="y"?"width":"height",k=["top","left"].includes(Ko(i)),C=a.reference[p]-a.floating[_]+(k&&((y=s.offset)==null?void 0:y[p])||0)+(k?0:v.crossAxis),$=a.reference[p]+a.reference[_]+(k?0:((b=s.offset)==null?void 0:b[p])||0)-(k?v.crossAxis:0);m<C?m=C:m>$&&(m=$)}return{[d]:h,[p]:m}}}},Ewe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:i,elements:a}=t,{apply:s=()=>{},...o}=Ou(e,t),l=await uR(t,o),u=Ko(n),c=Ty(n),p=Id(n)==="x",{width:h,height:m}=r.floating;let g,v;u==="top"||u==="bottom"?(g=u,v=c===(await(i.isRTL==null?void 0:i.isRTL(a.floating))?"start":"end")?"left":"right"):(v=u,g=c==="end"?"top":"bottom");const y=m-l[g],b=h-l[v],_=!t.middlewareData.shift;let k=y,C=b;if(p){const N=h-l.left-l.right;C=c||_?rd(b,N):N}else{const N=m-l.top-l.bottom;k=c||_?rd(y,N):N}if(_&&!c){const N=xl(l.left,0),A=xl(l.right,0),D=xl(l.top,0),O=xl(l.bottom,0);p?C=h-2*(N!==0||A!==0?N+A:xl(l.left,l.right)):k=m-2*(D!==0||O!==0?D+O:xl(l.top,l.bottom))}await s({...t,availableWidth:C,availableHeight:k});const $=await i.getDimensions(a.floating);return h!==$.width||m!==$.height?{reset:{rects:!0}}:{}}}};function oo(e){var t;return((t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Zo(e){return oo(e).getComputedStyle(e)}function qK(e){return e instanceof oo(e).Node}function id(e){return qK(e)?(e.nodeName||"").toLowerCase():"#document"}function Xo(e){return e instanceof oo(e).HTMLElement}function Pu(e){return e instanceof oo(e).Element}function pW(e){return typeof ShadowRoot>"u"?!1:e instanceof oo(e).ShadowRoot||e instanceof ShadowRoot}function B1(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=Zo(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function Owe(e){return["table","td","th"].includes(id(e))}function dR(e){const t=pR(),n=Zo(e);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function pR(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function A2(e){return["html","body","#document"].includes(id(e))}const QO=Math.min,bg=Math.max,vS=Math.round,Hx=Math.floor,Zp=e=>({x:e,y:e});function KK(e){const t=Zo(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=Xo(e),a=i?e.offsetWidth:n,s=i?e.offsetHeight:r,o=vS(n)!==a||vS(r)!==s;return o&&(n=a,r=s),{width:n,height:r,$:o}}function hR(e){return Pu(e)?e:e.contextElement}function wg(e){const t=hR(e);if(!Xo(t))return Zp(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:a}=KK(t);let s=(a?vS(n.width):n.width)/r,o=(a?vS(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!o||!Number.isFinite(o))&&(o=1),{x:s,y:o}}const hW=Zp(0);function ZK(e,t,n){var r,i;if(t===void 0&&(t=!0),!pR())return hW;const a=e?oo(e):window;return!n||t&&n!==a?hW:{x:((r=a.visualViewport)==null?void 0:r.offsetLeft)||0,y:((i=a.visualViewport)==null?void 0:i.offsetTop)||0}}function Xp(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),a=hR(e);let s=Zp(1);t&&(r?Pu(r)&&(s=wg(r)):s=wg(e));const o=ZK(a,n,r);let l=(i.left+o.x)/s.x,u=(i.top+o.y)/s.y,c=i.width/s.x,d=i.height/s.y;if(a){const p=oo(a),h=r&&Pu(r)?oo(r):r;let m=p.frameElement;for(;m&&r&&h!==p;){const g=wg(m),v=m.getBoundingClientRect(),y=getComputedStyle(m),b=v.left+(m.clientLeft+parseFloat(y.paddingLeft))*g.x,_=v.top+(m.clientTop+parseFloat(y.paddingTop))*g.y;l*=g.x,u*=g.y,c*=g.x,d*=g.y,l+=b,u+=_,m=oo(m).frameElement}}return Vg({width:c,height:d,x:l,y:u})}function Vu(e){return((qK(e)?e.ownerDocument:e.document)||window.document).documentElement}function M2(e){return Pu(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Pwe(e){let{rect:t,offsetParent:n,strategy:r}=e;const i=Xo(n),a=Vu(n);if(n===a)return t;let s={scrollLeft:0,scrollTop:0},o=Zp(1);const l=Zp(0);if((i||!i&&r!=="fixed")&&((id(n)!=="body"||B1(a))&&(s=M2(n)),Xo(n))){const u=Xp(n);o=wg(n),l.x=u.x+n.clientLeft,l.y=u.y+n.clientTop}return{width:t.width*o.x,height:t.height*o.y,x:t.x*o.x-s.scrollLeft*o.x+l.x,y:t.y*o.y-s.scrollTop*o.y+l.y}}function XK(e){return Xp(Vu(e)).left+M2(e).scrollLeft}function Awe(e){const t=Vu(e),n=M2(e),r=e.ownerDocument.body,i=bg(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),a=bg(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+XK(e);const o=-n.scrollTop;return Zo(r).direction==="rtl"&&(s+=bg(t.clientWidth,r.clientWidth)-i),{width:i,height:a,x:s,y:o}}function jg(e){if(id(e)==="html")return e;const t=e.assignedSlot||e.parentNode||pW(e)&&e.host||Vu(e);return pW(t)?t.host:t}function JK(e){const t=jg(e);return A2(t)?e.ownerDocument?e.ownerDocument.body:e.body:Xo(t)&&B1(t)?t:JK(t)}function qc(e,t){var n;t===void 0&&(t=[]);const r=JK(e),i=r===((n=e.ownerDocument)==null?void 0:n.body),a=oo(r);return i?t.concat(a,a.visualViewport||[],B1(r)?r:[]):t.concat(r,qc(r))}function Mwe(e,t){const n=oo(e),r=Vu(e),i=n.visualViewport;let a=r.clientWidth,s=r.clientHeight,o=0,l=0;if(i){a=i.width,s=i.height;const u=pR();(!u||u&&t==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:a,height:s,x:o,y:l}}function Rwe(e,t){const n=Xp(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,a=Xo(e)?wg(e):Zp(1),s=e.clientWidth*a.x,o=e.clientHeight*a.y,l=i*a.x,u=r*a.y;return{width:s,height:o,x:l,y:u}}function fW(e,t,n){let r;if(t==="viewport")r=Mwe(e,n);else if(t==="document")r=Awe(Vu(e));else if(Pu(t))r=Rwe(t,n);else{const i=ZK(e);r={...t,x:t.x-i.x,y:t.y-i.y}}return Vg(r)}function YK(e,t){const n=jg(e);return n===t||!Pu(n)||A2(n)?!1:Zo(n).position==="fixed"||YK(n,t)}function Dwe(e,t){const n=t.get(e);if(n)return n;let r=qc(e).filter(o=>Pu(o)&&id(o)!=="body"),i=null;const a=Zo(e).position==="fixed";let s=a?jg(e):e;for(;Pu(s)&&!A2(s);){const o=Zo(s),l=dR(s);!l&&o.position==="fixed"&&(i=null),(a?!l&&!i:!l&&o.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||B1(s)&&!l&&YK(e,s))?r=r.filter(c=>c!==s):i=o,s=jg(s)}return t.set(e,r),r}function Lwe(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const s=[...n==="clippingAncestors"?Dwe(t,this._c):[].concat(n),r],o=s[0],l=s.reduce((u,c)=>{const d=fW(t,c,i);return u.top=bg(d.top,u.top),u.right=QO(d.right,u.right),u.bottom=QO(d.bottom,u.bottom),u.left=bg(d.left,u.left),u},fW(t,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Fwe(e){return KK(e)}function mW(e,t){return!Xo(e)||Zo(e).position==="fixed"?null:t?t(e):e.offsetParent}function zwe(e){let t=jg(e);for(;Xo(t)&&!A2(t);){if(dR(t))return t;t=jg(t)}return null}function gW(e,t){const n=oo(e);if(!Xo(e))return n;let r=mW(e,t);for(;r&&Owe(r)&&Zo(r).position==="static";)r=mW(r,t);return r&&(id(r)==="html"||id(r)==="body"&&Zo(r).position==="static"&&!dR(r))?n:r||zwe(e)||n}function Bwe(e,t,n){const r=Xo(t),i=Vu(t),a=n==="fixed",s=Xp(e,!0,a,t);let o={scrollLeft:0,scrollTop:0};const l=Zp(0);if(r||!r&&!a)if((id(t)!=="body"||B1(i))&&(o=M2(t)),Xo(t)){const u=Xp(t,!0,a,t);l.x=u.x+t.clientLeft,l.y=u.y+t.clientTop}else i&&(l.x=XK(i));return{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}const Wwe={getClippingRect:Lwe,convertOffsetParentRelativeRectToViewportRelativeRect:Pwe,isElement:Pu,getDimensions:Fwe,getOffsetParent:gW,getDocumentElement:Vu,getScale:wg,async getElementRects(e){let{reference:t,floating:n,strategy:r}=e;const i=this.getOffsetParent||gW,a=this.getDimensions;return{reference:Bwe(t,await i(n),r),floating:{x:0,y:0,...await a(n)}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>Zo(e).direction==="rtl"};function Vwe(e,t){let n=null,r;const i=Vu(e);function a(){clearTimeout(r),n&&n.disconnect(),n=null}function s(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),a();const{left:u,top:c,width:d,height:p}=e.getBoundingClientRect();if(o||t(),!d||!p)return;const h=Hx(c),m=Hx(i.clientWidth-(u+d)),g=Hx(i.clientHeight-(c+p)),v=Hx(u),b={rootMargin:-h+"px "+-m+"px "+-g+"px "+-v+"px",threshold:bg(0,QO(1,l))||1};let _=!0;function k(C){const $=C[0].intersectionRatio;if($!==l){if(!_)return s();$?s(!1,$):r=setTimeout(()=>{s(!1,1e-7)},100)}_=!1}try{n=new IntersectionObserver(k,{...b,root:i.ownerDocument})}catch{n=new IntersectionObserver(k,b)}n.observe(e)}return s(!0),a}function jwe(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,u=hR(e),c=i||a?[...u?qc(u):[],...qc(t)]:[];c.forEach(y=>{i&&y.addEventListener("scroll",n,{passive:!0}),a&&y.addEventListener("resize",n)});const d=u&&o?Vwe(u,n):null;let p=-1,h=null;s&&(h=new ResizeObserver(y=>{let[b]=y;b&&b.target===u&&h&&(h.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{h&&h.observe(t)})),n()}),u&&!l&&h.observe(u),h.observe(t));let m,g=l?Xp(e):null;l&&v();function v(){const y=Xp(e);g&&(y.x!==g.x||y.y!==g.y||y.width!==g.width||y.height!==g.height)&&n(),g=y,m=requestAnimationFrame(v)}return n(),()=>{c.forEach(y=>{i&&y.removeEventListener("scroll",n),a&&y.removeEventListener("resize",n)}),d&&d(),h&&h.disconnect(),h=null,l&&cancelAnimationFrame(m)}}const Uwe=(e,t,n)=>{const r=new Map,i={platform:Wwe,...n},a={...i.platform,_c:r};return bwe(e,t,{...i,platform:a})},QK=e=>{const{element:t,padding:n}=e;function r(i){return Object.prototype.hasOwnProperty.call(i,"current")}return{name:"arrow",options:e,fn(i){return r(t)?t.current!=null?dW({element:t.current,padding:n}).fn(i):{}:t?dW({element:t,padding:n}).fn(i):{}}}};var J_=typeof document<"u"?I.exports.useLayoutEffect:I.exports.useEffect;function bS(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!bS(e[r],t[r]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){const a=i[r];if(!(a==="_owner"&&e.$$typeof)&&!bS(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function yW(e){const t=I.exports.useRef(e);return J_(()=>{t.current=e}),t}function Hwe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:i,whileElementsMounted:a,open:s}=e,[o,l]=I.exports.useState({x:null,y:null,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[u,c]=I.exports.useState(r);bS(u,r)||c(r);const d=I.exports.useRef(null),p=I.exports.useRef(null),h=I.exports.useRef(o),m=yW(a),g=yW(i),[v,y]=I.exports.useState(null),[b,_]=I.exports.useState(null),k=I.exports.useCallback(O=>{d.current!==O&&(d.current=O,y(O))},[]),C=I.exports.useCallback(O=>{p.current!==O&&(p.current=O,_(O))},[]),$=I.exports.useCallback(()=>{if(!d.current||!p.current)return;const O={placement:t,strategy:n,middleware:u};g.current&&(O.platform=g.current),Uwe(d.current,p.current,O).then(F=>{const E={...F,isPositioned:!0};N.current&&!bS(h.current,E)&&(h.current=E,ql.exports.flushSync(()=>{l(E)}))})},[u,t,n,g]);J_(()=>{s===!1&&h.current.isPositioned&&(h.current.isPositioned=!1,l(O=>({...O,isPositioned:!1})))},[s]);const N=I.exports.useRef(!1);J_(()=>(N.current=!0,()=>{N.current=!1}),[]),J_(()=>{if(v&&b){if(m.current)return m.current(v,b,$);$()}},[v,b,$,m]);const A=I.exports.useMemo(()=>({reference:d,floating:p,setReference:k,setFloating:C}),[k,C]),D=I.exports.useMemo(()=>({reference:v,floating:b}),[v,b]);return I.exports.useMemo(()=>({...o,update:$,refs:A,elements:D,reference:k,floating:C}),[o,$,A,D,k,C])}var Ug=typeof document<"u"?I.exports.useLayoutEffect:I.exports.useEffect;let EN=!1,Gwe=0;const vW=()=>"floating-ui-"+Gwe++;function qwe(){const[e,t]=I.exports.useState(()=>EN?vW():void 0);return Ug(()=>{e==null&&t(vW())},[]),I.exports.useEffect(()=>{EN||(EN=!0)},[]),e}const Kwe=jp["useId".toString()],bW=Kwe||qwe;function Zwe(){const e=new Map;return{emit(t,n){var r;(r=e.get(t))==null||r.forEach(i=>i(n))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){e.set(t,(e.get(t)||[]).filter(r=>r!==n))}}}const Xwe=I.exports.createContext(null),Jwe=I.exports.createContext(null),eZ=()=>{var e;return((e=I.exports.useContext(Xwe))==null?void 0:e.id)||null},fR=()=>I.exports.useContext(Jwe);function Ec(e){return(e==null?void 0:e.ownerDocument)||document}function Ywe(){const e=navigator.userAgentData;return e!=null&&e.platform?e.platform:navigator.platform}function Qwe(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(t=>{let{brand:n,version:r}=t;return n+"/"+r}).join(" "):navigator.userAgent}function mR(e){return Ec(e).defaultView||window}function Nl(e){return e?e instanceof mR(e).Element:!1}function tZ(e){return e?e instanceof mR(e).HTMLElement:!1}function exe(e){if(typeof ShadowRoot>"u")return!1;const t=mR(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function txe(e){if(e.mozInputSource===0&&e.isTrusted)return!0;const t=/Android/i;return(t.test(Ywe())||t.test(Qwe()))&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function nxe(e){return e.width===0&&e.height===0||e.width===1&&e.height===1&&e.pressure===0&&e.detail===0&&e.pointerType!=="mouse"||e.width<1&&e.height<1&&e.pressure===0&&e.detail===0}function nZ(e,t){const n=["mouse","pen"];return t||n.push("",void 0),n.includes(e)}function wW(e){const t=I.exports.useRef(e);return Ug(()=>{t.current=e}),t}const xW="data-floating-ui-safe-polygon";function Y_(e,t,n){return n&&!nZ(n)?0:typeof e=="number"?e:e==null?void 0:e[t]}const rxe=function(e,t){let{enabled:n=!0,delay:r=0,handleClose:i=null,mouseOnly:a=!1,restMs:s=0,move:o=!0}=t===void 0?{}:t;const{open:l,onOpenChange:u,dataRef:c,events:d,elements:{domReference:p,floating:h},refs:m}=e,g=fR(),v=eZ(),y=wW(i),b=wW(r),_=I.exports.useRef(),k=I.exports.useRef(),C=I.exports.useRef(),$=I.exports.useRef(),N=I.exports.useRef(!0),A=I.exports.useRef(!1),D=I.exports.useRef(()=>{}),O=I.exports.useCallback(()=>{var q;const H=(q=c.current.openEvent)==null?void 0:q.type;return(H==null?void 0:H.includes("mouse"))&&H!=="mousedown"},[c]);I.exports.useEffect(()=>{if(!n)return;function q(){clearTimeout(k.current),clearTimeout($.current),N.current=!0}return d.on("dismiss",q),()=>{d.off("dismiss",q)}},[n,d]),I.exports.useEffect(()=>{if(!n||!y.current||!l)return;function q(){O()&&u(!1)}const H=Ec(h).documentElement;return H.addEventListener("mouseleave",q),()=>{H.removeEventListener("mouseleave",q)}},[h,l,u,n,y,c,O]);const F=I.exports.useCallback(function(q){q===void 0&&(q=!0);const H=Y_(b.current,"close",_.current);H&&!C.current?(clearTimeout(k.current),k.current=setTimeout(()=>u(!1),H)):q&&(clearTimeout(k.current),u(!1))},[b,u]),E=I.exports.useCallback(()=>{D.current(),C.current=void 0},[]),z=I.exports.useCallback(()=>{if(A.current){const q=Ec(m.floating.current).body;q.style.pointerEvents="",q.removeAttribute(xW),A.current=!1}},[m]);return I.exports.useEffect(()=>{if(!n)return;function q(){return c.current.openEvent?["click","mousedown"].includes(c.current.openEvent.type):!1}function H(V){if(clearTimeout(k.current),N.current=!1,a&&!nZ(_.current)||s>0&&Y_(b.current,"open")===0)return;c.current.openEvent=V;const Q=Y_(b.current,"open",_.current);Q?k.current=setTimeout(()=>{u(!0)},Q):u(!0)}function J(V){if(q())return;D.current();const Q=Ec(h);if(clearTimeout($.current),y.current){l||clearTimeout(k.current),C.current=y.current({...e,tree:g,x:V.clientX,y:V.clientY,onClose(){z(),E(),F()}});const X=C.current;Q.addEventListener("mousemove",X),D.current=()=>{Q.removeEventListener("mousemove",X)};return}F()}function ee(V){q()||y.current==null||y.current({...e,tree:g,x:V.clientX,y:V.clientY,onClose(){z(),E(),F()}})(V)}if(Nl(p)){const V=p;return l&&V.addEventListener("mouseleave",ee),h==null||h.addEventListener("mouseleave",ee),o&&V.addEventListener("mousemove",H,{once:!0}),V.addEventListener("mouseenter",H),V.addEventListener("mouseleave",J),()=>{l&&V.removeEventListener("mouseleave",ee),h==null||h.removeEventListener("mouseleave",ee),o&&V.removeEventListener("mousemove",H),V.removeEventListener("mouseenter",H),V.removeEventListener("mouseleave",J)}}},[p,h,n,e,a,s,o,F,E,z,u,l,g,b,y,c]),Ug(()=>{var q;if(!!n&&l&&(q=y.current)!=null&&q.__options.blockPointerEvents&&O()){const ee=Ec(h).body;if(ee.setAttribute(xW,""),ee.style.pointerEvents="none",A.current=!0,Nl(p)&&h){var H,J;const V=p,Q=g==null||(H=g.nodesRef.current.find(X=>X.id===v))==null||(J=H.context)==null?void 0:J.elements.floating;return Q&&(Q.style.pointerEvents=""),V.style.pointerEvents="auto",h.style.pointerEvents="auto",()=>{V.style.pointerEvents="",h.style.pointerEvents=""}}}},[n,l,v,h,p,g,y,c,O]),Ug(()=>{l||(_.current=void 0,E(),z())},[l,E,z]),I.exports.useEffect(()=>()=>{E(),clearTimeout(k.current),clearTimeout($.current),z()},[n,E,z]),I.exports.useMemo(()=>{if(!n)return{};function q(H){_.current=H.pointerType}return{reference:{onPointerDown:q,onPointerEnter:q,onMouseMove(){l||s===0||(clearTimeout($.current),$.current=setTimeout(()=>{N.current||u(!0)},s))}},floating:{onMouseEnter(){clearTimeout(k.current)},onMouseLeave(){d.emit("dismiss",{type:"mouseLeave",data:{returnFocus:!1}}),F(!1)}}}},[d,n,s,l,u,F])},rZ=I.exports.createContext({delay:0,initialDelay:0,timeoutMs:0,currentId:null,setCurrentId:()=>{},setState:()=>{},isInstantPhase:!1}),iZ=()=>I.exports.useContext(rZ),ixe=e=>{let{children:t,delay:n,timeoutMs:r=0}=e;const[i,a]=I.exports.useReducer((l,u)=>({...l,...u}),{delay:n,timeoutMs:r,initialDelay:n,currentId:null,isInstantPhase:!1}),s=I.exports.useRef(null),o=I.exports.useCallback(l=>{a({currentId:l})},[]);return Ug(()=>{i.currentId?s.current===null?s.current=i.currentId:a({isInstantPhase:!0}):(a({isInstantPhase:!1}),s.current=null)},[i.currentId]),x(rZ.Provider,{value:I.exports.useMemo(()=>({...i,setState:a,setCurrentId:o}),[i,a,o]),children:t})},axe=(e,t)=>{let{open:n,onOpenChange:r}=e,{id:i}=t;const{currentId:a,setCurrentId:s,initialDelay:o,setState:l,timeoutMs:u}=iZ();I.exports.useEffect(()=>{a&&(l({delay:{open:1,close:Y_(o,"close")}}),a!==i&&r(!1))},[i,r,l,a,o]),I.exports.useEffect(()=>{function c(){r(!1),l({delay:o,currentId:null})}if(!n&&a===i)if(u){const d=window.setTimeout(c,u);return()=>{clearTimeout(d)}}else c()},[n,l,a,i,r,o,u]),I.exports.useEffect(()=>{n&&s(i)},[n,s,i])};function sxe(e){let t=e.activeElement;for(;((n=t)==null||(r=n.shadowRoot)==null?void 0:r.activeElement)!=null;){var n,r;t=t.shadowRoot.activeElement}return t}function _W(e,t){if(!e||!t)return!1;const n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&exe(n)){let r=t;do{if(r&&e===r)return!0;r=r.parentNode||r.host}while(r)}return!1}function ON(e,t){let n=e.filter(i=>{var a;return i.parentId===t&&((a=i.context)==null?void 0:a.open)})||[],r=n;for(;r.length;)r=e.filter(i=>{var a;return(a=r)==null?void 0:a.some(s=>{var o;return i.parentId===s.id&&((o=i.context)==null?void 0:o.open)})})||[],n=n.concat(r);return n}function oxe(e){return"composedPath"in e?e.composedPath()[0]:e.target}const lxe=jp["useInsertionEffect".toString()],uxe=lxe||(e=>e());function aZ(e){const t=I.exports.useRef(()=>{});return uxe(()=>{t.current=e}),I.exports.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.current==null?void 0:t.current(...r)},[])}function Q_(e,t){if(t==null)return!1;if("composedPath"in e)return e.composedPath().includes(t);const n=e;return n.target!=null&&t.contains(n.target)}const cxe={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},dxe={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},pxe=function(e){var t,n;return e===void 0&&(e=!0),{escapeKeyBubbles:typeof e=="boolean"?e:(t=e.escapeKey)!=null?t:!0,outsidePressBubbles:typeof e=="boolean"?e:(n=e.outsidePress)!=null?n:!0}},hxe=function(e,t){let{open:n,onOpenChange:r,events:i,nodeId:a,elements:{reference:s,domReference:o,floating:l},dataRef:u}=e,{enabled:c=!0,escapeKey:d=!0,outsidePress:p=!0,outsidePressEvent:h="pointerdown",referencePress:m=!1,referencePressEvent:g="pointerdown",ancestorScroll:v=!1,bubbles:y=!0}=t===void 0?{}:t;const b=fR(),_=eZ()!=null,k=aZ(typeof p=="function"?p:()=>!1),C=typeof p=="function"?k:p,$=I.exports.useRef(!1),{escapeKeyBubbles:N,outsidePressBubbles:A}=pxe(y);return I.exports.useEffect(()=>{if(!n||!c)return;u.current.__escapeKeyBubbles=N,u.current.__outsidePressBubbles=A;function D(q){if(q.key==="Escape"){const H=b?ON(b.nodesRef.current,a):[];if(H.length>0){let J=!0;if(H.forEach(ee=>{var V;if((V=ee.context)!=null&&V.open&&!ee.context.dataRef.current.__escapeKeyBubbles){J=!1;return}}),!J)return}i.emit("dismiss",{type:"escapeKey",data:{returnFocus:{preventScroll:!1}}}),r(!1)}}function O(q){const H=$.current;if($.current=!1,H||typeof C=="function"&&!C(q))return;const J=oxe(q);if(tZ(J)&&l){const Q=l.ownerDocument.defaultView||window,X=J.scrollWidth>J.clientWidth,Y=J.scrollHeight>J.clientHeight;let ce=Y&&q.offsetX>J.clientWidth;if(Y&&Q.getComputedStyle(J).direction==="rtl"&&(ce=q.offsetX<=J.offsetWidth-J.clientWidth),ce||X&&q.offsetY>J.clientHeight)return}const ee=b&&ON(b.nodesRef.current,a).some(Q=>{var X;return Q_(q,(X=Q.context)==null?void 0:X.elements.floating)});if(Q_(q,l)||Q_(q,o)||ee)return;const V=b?ON(b.nodesRef.current,a):[];if(V.length>0){let Q=!0;if(V.forEach(X=>{var Y;if((Y=X.context)!=null&&Y.open&&!X.context.dataRef.current.__outsidePressBubbles){Q=!1;return}}),!Q)return}i.emit("dismiss",{type:"outsidePress",data:{returnFocus:_?{preventScroll:!0}:txe(q)||nxe(q)}}),r(!1)}function F(){r(!1)}const E=Ec(l);d&&E.addEventListener("keydown",D),C&&E.addEventListener(h,O);let z=[];return v&&(Nl(o)&&(z=qc(o)),Nl(l)&&(z=z.concat(qc(l))),!Nl(s)&&s&&s.contextElement&&(z=z.concat(qc(s.contextElement)))),z=z.filter(q=>{var H;return q!==((H=E.defaultView)==null?void 0:H.visualViewport)}),z.forEach(q=>{q.addEventListener("scroll",F,{passive:!0})}),()=>{d&&E.removeEventListener("keydown",D),C&&E.removeEventListener(h,O),z.forEach(q=>{q.removeEventListener("scroll",F)})}},[u,l,o,s,d,C,h,i,b,a,n,r,v,c,N,A,_]),I.exports.useEffect(()=>{$.current=!1},[C,h]),I.exports.useMemo(()=>c?{reference:{[cxe[g]]:()=>{m&&(i.emit("dismiss",{type:"referencePress",data:{returnFocus:!1}}),r(!1))}},floating:{[dxe[h]]:()=>{$.current=!0}}}:{},[c,i,m,h,g,r])},fxe=function(e,t){let{open:n,onOpenChange:r,dataRef:i,events:a,refs:s,elements:{floating:o,domReference:l}}=e,{enabled:u=!0,keyboardOnly:c=!0}=t===void 0?{}:t;const d=I.exports.useRef(""),p=I.exports.useRef(!1),h=I.exports.useRef();return I.exports.useEffect(()=>{if(!u)return;const g=Ec(o).defaultView||window;function v(){!n&&tZ(l)&&l===sxe(Ec(l))&&(p.current=!0)}return g.addEventListener("blur",v),()=>{g.removeEventListener("blur",v)}},[o,l,n,u]),I.exports.useEffect(()=>{if(!u)return;function m(g){(g.type==="referencePress"||g.type==="escapeKey")&&(p.current=!0)}return a.on("dismiss",m),()=>{a.off("dismiss",m)}},[a,u]),I.exports.useEffect(()=>()=>{clearTimeout(h.current)},[]),I.exports.useMemo(()=>u?{reference:{onPointerDown(m){let{pointerType:g}=m;d.current=g,p.current=!!(g&&c)},onMouseLeave(){p.current=!1},onFocus(m){var g;p.current||m.type==="focus"&&((g=i.current.openEvent)==null?void 0:g.type)==="mousedown"&&i.current.openEvent&&Q_(i.current.openEvent,l)||(i.current.openEvent=m.nativeEvent,r(!0))},onBlur(m){p.current=!1;const g=m.relatedTarget,v=Nl(g)&&g.hasAttribute("data-floating-ui-focus-guard")&&g.getAttribute("data-type")==="outside";h.current=setTimeout(()=>{_W(s.floating.current,g)||_W(l,g)||v||r(!1)})}}}:{},[u,c,l,s,i,r])},mxe=function(e,t){let{open:n}=e,{enabled:r=!0,role:i="dialog"}=t===void 0?{}:t;const a=bW(),s=bW();return I.exports.useMemo(()=>{const o={id:a,role:i};return r?i==="tooltip"?{reference:{"aria-describedby":n?a:void 0},floating:o}:{reference:{"aria-expanded":n?"true":"false","aria-haspopup":i==="alertdialog"?"dialog":i,"aria-controls":n?a:void 0,...i==="listbox"&&{role:"combobox"},...i==="menu"&&{id:s}},floating:{...o,...i==="menu"&&{"aria-labelledby":s}}}:{}},[r,i,n,a,s])};function gR(e){e===void 0&&(e={});const{open:t=!1,onOpenChange:n,nodeId:r}=e,i=Hwe(e),a=fR(),s=I.exports.useRef(null),o=I.exports.useRef({}),l=I.exports.useState(()=>Zwe())[0],[u,c]=I.exports.useState(null),d=I.exports.useCallback(y=>{const b=Nl(y)?{getBoundingClientRect:()=>y.getBoundingClientRect(),contextElement:y}:y;i.refs.setReference(b)},[i.refs]),p=I.exports.useCallback(y=>{(Nl(y)||y===null)&&(s.current=y,c(y)),(Nl(i.refs.reference.current)||i.refs.reference.current===null||y!==null&&!Nl(y))&&i.refs.setReference(y)},[i.refs]),h=I.exports.useMemo(()=>({...i.refs,setReference:p,setPositionReference:d,domReference:s}),[i.refs,p,d]),m=I.exports.useMemo(()=>({...i.elements,domReference:u}),[i.elements,u]),g=aZ(n),v=I.exports.useMemo(()=>({...i,refs:h,elements:m,dataRef:o,nodeId:r,events:l,open:t,onOpenChange:g}),[i,r,l,t,g,h,m]);return Ug(()=>{const y=a==null?void 0:a.nodesRef.current.find(b=>b.id===r);y&&(y.context=v)}),I.exports.useMemo(()=>({...i,context:v,refs:h,reference:p,positionReference:d}),[i,h,v,p,d])}function PN(e,t,n){const r=new Map;return{...n==="floating"&&{tabIndex:-1},...e,...t.map(i=>i?i[n]:null).concat(e).reduce((i,a)=>(a&&Object.entries(a).forEach(s=>{let[o,l]=s;if(o.indexOf("on")===0){if(r.has(o)||r.set(o,[]),typeof l=="function"){var u;(u=r.get(o))==null||u.push(l),i[o]=function(){for(var c,d=arguments.length,p=new Array(d),h=0;h<d;h++)p[h]=arguments[h];(c=r.get(o))==null||c.forEach(m=>m(...p))}}}else i[o]=l}),i),{})}}const gxe=function(e){e===void 0&&(e=[]);const t=e,n=I.exports.useCallback(a=>PN(a,e,"reference"),t),r=I.exports.useCallback(a=>PN(a,e,"floating"),t),i=I.exports.useCallback(a=>PN(a,e,"item"),e.map(a=>a==null?void 0:a.item));return I.exports.useMemo(()=>({getReferenceProps:n,getFloatingProps:r,getItemProps:i}),[n,r,i])};function sZ({opened:e,floating:t,position:n,positionDependencies:r}){const[i,a]=I.exports.useState(0);I.exports.useEffect(()=>{if(t.refs.reference.current&&t.refs.floating.current)return jwe(t.refs.reference.current,t.refs.floating.current,t.update)},[t.refs.reference.current,t.refs.floating.current,e,i,n]),Xi(()=>{t.update()},r),Xi(()=>{a(s=>s+1)},[e])}function yxe(e){const t=[HK(e.offset)];return e.middlewares.shift&&t.push(cR({limiter:Nwe()})),e.middlewares.flip&&t.push(VK()),e.middlewares.inline&&t.push(UK()),t.push(QK({element:e.arrowRef,padding:e.arrowOffset})),t}function vxe(e){const[t,n]=qo({value:e.opened,defaultValue:e.defaultOpened,finalValue:!1,onChange:e.onChange}),r=()=>{var s;(s=e.onClose)==null||s.call(e),n(!1)},i=()=>{var s,o;t?((s=e.onClose)==null||s.call(e),n(!1)):((o=e.onOpen)==null||o.call(e),n(!0))},a=gR({placement:e.position,middleware:[...yxe(e),...e.width==="target"?[Ewe({apply({rects:s}){var o,l;Object.assign((l=(o=a.refs.floating.current)==null?void 0:o.style)!=null?l:{},{width:`${s.reference.width}px`})}})]:[]]});return sZ({opened:e.opened,position:e.position,positionDependencies:e.positionDependencies,floating:a}),Xi(()=>{var s;(s=e.onPositionChange)==null||s.call(e,a.placement)},[a.placement]),Xi(()=>{var s,o;e.opened?(o=e.onOpen)==null||o.call(e):(s=e.onClose)==null||s.call(e)},[e.opened]),{floating:a,controlled:typeof e.opened=="boolean",opened:t,onClose:r,onToggle:i}}const oZ={context:"Popover component was not found in the tree",children:"Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported"},[bxe,lZ]=Iy(oZ.context);var wxe=Object.defineProperty,xxe=Object.defineProperties,_xe=Object.getOwnPropertyDescriptors,wS=Object.getOwnPropertySymbols,uZ=Object.prototype.hasOwnProperty,cZ=Object.prototype.propertyIsEnumerable,kW=(e,t,n)=>t in e?wxe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Gx=(e,t)=>{for(var n in t||(t={}))uZ.call(t,n)&&kW(e,n,t[n]);if(wS)for(var n of wS(t))cZ.call(t,n)&&kW(e,n,t[n]);return e},kxe=(e,t)=>xxe(e,_xe(t)),Sxe=(e,t)=>{var n={};for(var r in e)uZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&wS)for(var r of wS(e))t.indexOf(r)<0&&cZ.call(e,r)&&(n[r]=e[r]);return n};const Cxe={refProp:"ref",popupType:"dialog",shouldOverrideDefaultTargetId:!0},dZ=I.exports.forwardRef((e,t)=>{const n=Ke("PopoverTarget",Cxe,e),{children:r,refProp:i,popupType:a,shouldOverrideDefaultTargetId:s}=n,o=Sxe(n,["children","refProp","popupType","shouldOverrideDefaultTargetId"]);if(!A1(r))throw new Error(oZ.children);const l=o,u=lZ(),c=Bu(u.reference,r.ref,t),d=u.withRoles?{"aria-haspopup":a,"aria-expanded":u.opened,"aria-controls":u.getDropdownId(),id:s?u.getTargetId():r.props.id}:{};return I.exports.cloneElement(r,Gx(kxe(Gx(Gx(Gx({},l),d),u.targetProps),{className:eq(u.targetProps.className,l.className,r.props.className),[i]:c}),u.controlled?null:{onClick:u.onToggle}))});dZ.displayName="@mantine/core/PopoverTarget";var Ixe=it((e,{radius:t,shadow:n})=>({dropdown:{position:"absolute",backgroundColor:e.white,background:e.colorScheme==="dark"?e.colors.dark[6]:e.white,border:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2]}`,padding:`${e.spacing.sm} ${e.spacing.md}`,boxShadow:e.shadows[n]||n||"none",borderRadius:e.fn.radius(t),"&:focus":{outline:0}},arrow:{backgroundColor:"inherit",border:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2]}`,zIndex:1}}));const $xe=Ixe;var Txe=Object.defineProperty,SW=Object.getOwnPropertySymbols,Nxe=Object.prototype.hasOwnProperty,Exe=Object.prototype.propertyIsEnumerable,CW=(e,t,n)=>t in e?Txe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Em=(e,t)=>{for(var n in t||(t={}))Nxe.call(t,n)&&CW(e,n,t[n]);if(SW)for(var n of SW(t))Exe.call(t,n)&&CW(e,n,t[n]);return e};const IW={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function Oxe({transition:e,state:t,duration:n,timingFunction:r}){const i={transitionDuration:`${n}ms`,transitionTimingFunction:r};return typeof e=="string"?e in Lx?Em(Em(Em({transitionProperty:Lx[e].transitionProperty},i),Lx[e].common),Lx[e][IW[t]]):null:Em(Em(Em({transitionProperty:e.transitionProperty},i),e.common),e[IW[t]])}function Pxe({duration:e,exitDuration:t,timingFunction:n,mounted:r,onEnter:i,onExit:a,onEntered:s,onExited:o}){const l=Ka(),u=$2(),c=l.respectReducedMotion?u:!1,[d,p]=I.exports.useState(c?0:e),[h,m]=I.exports.useState(r?"entered":"exited"),g=I.exports.useRef(-1),v=y=>{const b=y?i:a,_=y?s:o;m(y?"pre-entering":"pre-exiting"),window.clearTimeout(g.current);const k=c?0:y?e:t;if(p(k),k===0)typeof b=="function"&&b(),typeof _=="function"&&_(),m(y?"entered":"exited");else{const C=window.setTimeout(()=>{typeof b=="function"&&b(),m(y?"entering":"exiting")},10);g.current=window.setTimeout(()=>{window.clearTimeout(C),typeof _=="function"&&_(),m(y?"entered":"exited")},k)}};return Xi(()=>{v(r)},[r]),I.exports.useEffect(()=>()=>window.clearTimeout(g.current),[]),{transitionDuration:d,transitionStatus:h,transitionTimingFunction:n||l.transitionTimingFunction}}function _u({keepMounted:e,transition:t,duration:n=250,exitDuration:r=n,mounted:i,children:a,timingFunction:s,onExit:o,onEntered:l,onEnter:u,onExited:c}){const{transitionDuration:d,transitionStatus:p,transitionTimingFunction:h}=Pxe({mounted:i,exitDuration:r,duration:n,timingFunction:s,onExit:o,onEntered:l,onEnter:u,onExited:c});return d===0?i?x(ze,{children:a({})}):e?a({display:"none"}):null:p==="exited"?e?a({display:"none"}):null:x(ze,{children:a(Oxe({transition:t,duration:d,state:p,timingFunction:h}))})}_u.displayName="@mantine/core/Transition";function yR({children:e,active:t=!0,refProp:n="ref"}){const r=Jve(t),i=Bu(r,e==null?void 0:e.ref);return A1(e)?I.exports.cloneElement(e,{[n]:i}):e}yR.displayName="@mantine/core/FocusTrap";var Axe=Object.defineProperty,Mxe=Object.defineProperties,Rxe=Object.getOwnPropertyDescriptors,$W=Object.getOwnPropertySymbols,Dxe=Object.prototype.hasOwnProperty,Lxe=Object.prototype.propertyIsEnumerable,TW=(e,t,n)=>t in e?Axe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,oc=(e,t)=>{for(var n in t||(t={}))Dxe.call(t,n)&&TW(e,n,t[n]);if($W)for(var n of $W(t))Lxe.call(t,n)&&TW(e,n,t[n]);return e},qx=(e,t)=>Mxe(e,Rxe(t));function NW(e,t,n,r){return e==="center"||r==="center"?{top:t}:e==="end"?{bottom:n}:e==="start"?{top:n}:{}}function EW(e,t,n,r,i){return e==="center"||r==="center"?{left:t}:e==="end"?{[i==="ltr"?"right":"left"]:n}:e==="start"?{[i==="ltr"?"left":"right"]:n}:{}}const Fxe={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"};function zxe({position:e,arrowSize:t,arrowOffset:n,arrowRadius:r,arrowPosition:i,arrowX:a,arrowY:s,dir:o}){const[l,u="center"]=e.split("-"),c={width:G(t),height:G(t),transform:"rotate(45deg)",position:"absolute",[Fxe[l]]:G(r)},d=G(-t/2);return l==="left"?qx(oc(oc({},c),NW(u,s,n,i)),{right:d,borderLeftColor:"transparent",borderBottomColor:"transparent"}):l==="right"?qx(oc(oc({},c),NW(u,s,n,i)),{left:d,borderRightColor:"transparent",borderTopColor:"transparent"}):l==="top"?qx(oc(oc({},c),EW(u,a,n,i,o)),{bottom:d,borderTopColor:"transparent",borderLeftColor:"transparent"}):l==="bottom"?qx(oc(oc({},c),EW(u,a,n,i,o)),{top:d,borderBottomColor:"transparent",borderRightColor:"transparent"}):{}}var Bxe=Object.defineProperty,Wxe=Object.defineProperties,Vxe=Object.getOwnPropertyDescriptors,xS=Object.getOwnPropertySymbols,pZ=Object.prototype.hasOwnProperty,hZ=Object.prototype.propertyIsEnumerable,OW=(e,t,n)=>t in e?Bxe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,jxe=(e,t)=>{for(var n in t||(t={}))pZ.call(t,n)&&OW(e,n,t[n]);if(xS)for(var n of xS(t))hZ.call(t,n)&&OW(e,n,t[n]);return e},Uxe=(e,t)=>Wxe(e,Vxe(t)),Hxe=(e,t)=>{var n={};for(var r in e)pZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&xS)for(var r of xS(e))t.indexOf(r)<0&&hZ.call(e,r)&&(n[r]=e[r]);return n};const vR=I.exports.forwardRef((e,t)=>{var n=e,{position:r,arrowSize:i,arrowOffset:a,arrowRadius:s,arrowPosition:o,visible:l,arrowX:u,arrowY:c}=n,d=Hxe(n,["position","arrowSize","arrowOffset","arrowRadius","arrowPosition","visible","arrowX","arrowY"]);const p=Ka();return l?x("div",{...Uxe(jxe({},d),{ref:t,style:zxe({position:r,arrowSize:i,arrowOffset:a,arrowRadius:s,arrowPosition:o,dir:p.dir,arrowX:u,arrowY:c})})}):null});vR.displayName="@mantine/core/FloatingArrow";var Gxe=Object.defineProperty,qxe=Object.defineProperties,Kxe=Object.getOwnPropertyDescriptors,_S=Object.getOwnPropertySymbols,fZ=Object.prototype.hasOwnProperty,mZ=Object.prototype.propertyIsEnumerable,PW=(e,t,n)=>t in e?Gxe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Om=(e,t)=>{for(var n in t||(t={}))fZ.call(t,n)&&PW(e,n,t[n]);if(_S)for(var n of _S(t))mZ.call(t,n)&&PW(e,n,t[n]);return e},Kx=(e,t)=>qxe(e,Kxe(t)),Zxe=(e,t)=>{var n={};for(var r in e)fZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&_S)for(var r of _S(e))t.indexOf(r)<0&&mZ.call(e,r)&&(n[r]=e[r]);return n};const Xxe={};function gZ(e){var t;const n=Ke("PopoverDropdown",Xxe,e),{style:r,className:i,children:a,onKeyDownCapture:s}=n,o=Zxe(n,["style","className","children","onKeyDownCapture"]),l=lZ(),{classes:u,cx:c}=$xe({radius:l.radius,shadow:l.shadow},{name:l.__staticSelector,classNames:l.classNames,styles:l.styles,unstyled:l.unstyled,variant:l.variant}),d=$q({opened:l.opened,shouldReturnFocus:l.returnFocus}),p=l.withRoles?{"aria-labelledby":l.getTargetId(),id:l.getDropdownId(),role:"dialog"}:{};return l.disabled?null:x(L1,{...Kx(Om({},l.portalProps),{withinPortal:l.withinPortal}),children:x(_u,{...Kx(Om({mounted:l.opened},l.transitionProps),{transition:l.transitionProps.transition||"fade",duration:(t=l.transitionProps.duration)!=null?t:150,keepMounted:l.keepMounted,exitDuration:typeof l.transitionProps.exitDuration=="number"?l.transitionProps.exitDuration:l.transitionProps.duration}),children:h=>{var m,g;return x(yR,{active:l.trapFocus,children:B(wt,{...Om(Kx(Om({},p),{tabIndex:-1,ref:l.floating,style:Kx(Om(Om({},r),h),{zIndex:l.zIndex,top:(m=l.y)!=null?m:0,left:(g=l.x)!=null?g:0,width:l.width==="target"?void 0:G(l.width)}),className:c(u.dropdown,i),onKeyDownCapture:Sge(l.onClose,{active:l.closeOnEscape,onTrigger:d,onKeyDown:s}),"data-position":l.placement}),o),children:[a,x(vR,{ref:l.arrowRef,arrowX:l.arrowX,arrowY:l.arrowY,visible:l.withArrow,position:l.placement,arrowSize:l.arrowSize,arrowRadius:l.arrowRadius,arrowOffset:l.arrowOffset,arrowPosition:l.arrowPosition,className:u.arrow})]})})}})})}gZ.displayName="@mantine/core/PopoverDropdown";function yZ(e,t){if(e==="rtl"&&(t.includes("right")||t.includes("left"))){const[n,r]=t.split("-"),i=n==="right"?"left":"right";return r===void 0?i:`${i}-${r}`}return t}var AW=Object.getOwnPropertySymbols,Jxe=Object.prototype.hasOwnProperty,Yxe=Object.prototype.propertyIsEnumerable,Qxe=(e,t)=>{var n={};for(var r in e)Jxe.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&AW)for(var r of AW(e))t.indexOf(r)<0&&Yxe.call(e,r)&&(n[r]=e[r]);return n};const e_e={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!1,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,clickOutsideEvents:["mousedown","touchstart"],zIndex:Sd("popover"),__staticSelector:"Popover",width:"max-content"};function Da(e){var t,n,r,i,a,s;const o=I.exports.useRef(null),l=Ke("Popover",e_e,e),{children:u,position:c,offset:d,onPositionChange:p,positionDependencies:h,opened:m,transitionProps:g,width:v,middlewares:y,withArrow:b,arrowSize:_,arrowOffset:k,arrowRadius:C,arrowPosition:$,unstyled:N,classNames:A,styles:D,closeOnClickOutside:O,withinPortal:F,portalProps:E,closeOnEscape:z,clickOutsideEvents:q,trapFocus:H,onClose:J,onOpen:ee,onChange:V,zIndex:Q,radius:X,shadow:Y,id:ce,defaultOpened:pe,__staticSelector:fe,withRoles:ye,disabled:_e,returnFocus:Ee,variant:Se,keepMounted:Re}=l,Ze=Qxe(l,["children","position","offset","onPositionChange","positionDependencies","opened","transitionProps","width","middlewares","withArrow","arrowSize","arrowOffset","arrowRadius","arrowPosition","unstyled","classNames","styles","closeOnClickOutside","withinPortal","portalProps","closeOnEscape","clickOutsideEvents","trapFocus","onClose","onOpen","onChange","zIndex","radius","shadow","id","defaultOpened","__staticSelector","withRoles","disabled","returnFocus","variant","keepMounted"]),[at,Je]=I.exports.useState(null),[st,He]=I.exports.useState(null),xt=zu(ce),gt=Ka(),ft=vxe({middlewares:y,width:v,position:yZ(gt.dir,c),offset:typeof d=="number"?d+(b?_/2:0):d,arrowRef:o,arrowOffset:k,onPositionChange:p,positionDependencies:h,opened:m,defaultOpened:pe,onChange:V,onOpen:ee,onClose:J});Wve(()=>ft.opened&&O&&ft.onClose(),q,[at,st]);const Ft=I.exports.useCallback(_t=>{Je(_t),ft.floating.reference(_t)},[ft.floating.reference]),Hn=I.exports.useCallback(_t=>{He(_t),ft.floating.floating(_t)},[ft.floating.floating]);return x(bxe,{value:{returnFocus:Ee,disabled:_e,controlled:ft.controlled,reference:Ft,floating:Hn,x:ft.floating.x,y:ft.floating.y,arrowX:(r=(n=(t=ft.floating)==null?void 0:t.middlewareData)==null?void 0:n.arrow)==null?void 0:r.x,arrowY:(s=(a=(i=ft.floating)==null?void 0:i.middlewareData)==null?void 0:a.arrow)==null?void 0:s.y,opened:ft.opened,arrowRef:o,transitionProps:g,width:v,withArrow:b,arrowSize:_,arrowOffset:k,arrowRadius:C,arrowPosition:$,placement:ft.floating.placement,trapFocus:H,withinPortal:F,portalProps:E,zIndex:Q,radius:X,shadow:Y,closeOnEscape:z,onClose:ft.onClose,onToggle:ft.onToggle,getTargetId:()=>`${xt}-target`,getDropdownId:()=>`${xt}-dropdown`,withRoles:ye,targetProps:Ze,__staticSelector:fe,classNames:A,styles:D,unstyled:N,variant:Se,keepMounted:Re},children:u})}Da.Target=dZ;Da.Dropdown=gZ;Da.displayName="@mantine/core/Popover";var t_e=Object.defineProperty,kS=Object.getOwnPropertySymbols,vZ=Object.prototype.hasOwnProperty,bZ=Object.prototype.propertyIsEnumerable,MW=(e,t,n)=>t in e?t_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,n_e=(e,t)=>{for(var n in t||(t={}))vZ.call(t,n)&&MW(e,n,t[n]);if(kS)for(var n of kS(t))bZ.call(t,n)&&MW(e,n,t[n]);return e},r_e=(e,t)=>{var n={};for(var r in e)vZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&kS)for(var r of kS(e))t.indexOf(r)<0&&bZ.call(e,r)&&(n[r]=e[r]);return n};function i_e(e){var t=e,{children:n,component:r="div",maxHeight:i=220,direction:a="column",id:s,innerRef:o,__staticSelector:l,styles:u,classNames:c,unstyled:d}=t,p=r_e(t,["children","component","maxHeight","direction","id","innerRef","__staticSelector","styles","classNames","unstyled"]);const{classes:h}=vwe(null,{name:l,styles:u,classNames:c,unstyled:d});return x(Da.Dropdown,{...n_e({p:0,onMouseDown:m=>m.preventDefault()},p),children:x("div",{style:{maxHeight:G(i),display:"flex"},children:x(wt,{component:r||"div",id:`${s}-items`,"aria-labelledby":`${s}-label`,role:"listbox",onMouseDown:m=>m.preventDefault(),style:{flex:1,overflowY:r!==P2?"auto":void 0},"data-combobox-popover":!0,tabIndex:-1,ref:o,children:x("div",{className:h.itemsWrapper,style:{flexDirection:a},children:n})})})})}function Kc({opened:e,transitionProps:t={transition:"fade",duration:0},shadow:n,withinPortal:r,portalProps:i,children:a,__staticSelector:s,onDirectionChange:o,switchDirectionOnFlip:l,zIndex:u,dropdownPosition:c,positionDependencies:d=[],classNames:p,styles:h,unstyled:m,readOnly:g,variant:v}){return x(Da,{unstyled:m,classNames:p,styles:h,width:"target",withRoles:!1,opened:e,middlewares:{flip:c==="flip",shift:!1},position:c==="flip"?"bottom":c,positionDependencies:d,zIndex:u,__staticSelector:s,withinPortal:r,portalProps:i,transitionProps:t,shadow:n,disabled:g,onPositionChange:y=>l&&(o==null?void 0:o(y==="top"?"column-reverse":"column")),variant:v,children:a})}Kc.Target=Da.Target;Kc.Dropdown=i_e;var a_e=Object.defineProperty,s_e=Object.defineProperties,o_e=Object.getOwnPropertyDescriptors,SS=Object.getOwnPropertySymbols,wZ=Object.prototype.hasOwnProperty,xZ=Object.prototype.propertyIsEnumerable,RW=(e,t,n)=>t in e?a_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Zx=(e,t)=>{for(var n in t||(t={}))wZ.call(t,n)&&RW(e,n,t[n]);if(SS)for(var n of SS(t))xZ.call(t,n)&&RW(e,n,t[n]);return e},l_e=(e,t)=>s_e(e,o_e(t)),u_e=(e,t)=>{var n={};for(var r in e)wZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&SS)for(var r of SS(e))t.indexOf(r)<0&&xZ.call(e,r)&&(n[r]=e[r]);return n};function _Z(e,t,n){const r=Ke(e,t,n),{label:i,description:a,error:s,required:o,classNames:l,styles:u,className:c,unstyled:d,__staticSelector:p,sx:h,errorProps:m,labelProps:g,descriptionProps:v,wrapperProps:y,id:b,size:_,style:k,inputContainer:C,inputWrapperOrder:$,withAsterisk:N,variant:A}=r,D=u_e(r,["label","description","error","required","classNames","styles","className","unstyled","__staticSelector","sx","errorProps","labelProps","descriptionProps","wrapperProps","id","size","style","inputContainer","inputWrapperOrder","withAsterisk","variant"]),O=zu(b),{systemStyles:F,rest:E}=Cd(D),z=Zx({label:i,description:a,error:s,required:o,classNames:l,className:c,__staticSelector:p,sx:h,errorProps:m,labelProps:g,descriptionProps:v,unstyled:d,styles:u,id:O,size:_,style:k,inputContainer:C,inputWrapperOrder:$,withAsterisk:N,variant:A},y);return l_e(Zx({},E),{classNames:l,styles:u,unstyled:d,wrapperProps:Zx(Zx({},z),F),inputProps:{required:o,classNames:l,styles:u,unstyled:d,id:O,size:_,__staticSelector:p,error:s,variant:A}})}var c_e=it((e,t,{size:n})=>({label:{display:"inline-block",fontSize:ke({size:n,sizes:e.fontSizes}),fontWeight:500,color:e.colorScheme==="dark"?e.colors.dark[0]:e.colors.gray[9],wordBreak:"break-word",cursor:"default",WebkitTapHighlightColor:"transparent"},required:{color:e.fn.variant({variant:"filled",color:"red"}).background}}));const d_e=c_e;var p_e=Object.defineProperty,CS=Object.getOwnPropertySymbols,kZ=Object.prototype.hasOwnProperty,SZ=Object.prototype.propertyIsEnumerable,DW=(e,t,n)=>t in e?p_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,h_e=(e,t)=>{for(var n in t||(t={}))kZ.call(t,n)&&DW(e,n,t[n]);if(CS)for(var n of CS(t))SZ.call(t,n)&&DW(e,n,t[n]);return e},f_e=(e,t)=>{var n={};for(var r in e)kZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&CS)for(var r of CS(e))t.indexOf(r)<0&&SZ.call(e,r)&&(n[r]=e[r]);return n};const m_e={labelElement:"label",size:"sm"},bR=I.exports.forwardRef((e,t)=>{const n=Ke("InputLabel",m_e,e),{labelElement:r,children:i,required:a,size:s,classNames:o,styles:l,unstyled:u,className:c,htmlFor:d,__staticSelector:p,variant:h,onMouseDown:m}=n,g=f_e(n,["labelElement","children","required","size","classNames","styles","unstyled","className","htmlFor","__staticSelector","variant","onMouseDown"]),{classes:v,cx:y}=d_e(null,{name:["InputWrapper",p],classNames:o,styles:l,unstyled:u,variant:h,size:s});return B(wt,{...h_e({component:r,ref:t,className:y(v.label,c),htmlFor:r==="label"?d:void 0,onMouseDown:b=>{m==null||m(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault()}},g),children:[i,a&&x("span",{className:v.required,"aria-hidden":!0,children:" *"})]})});bR.displayName="@mantine/core/InputLabel";var g_e=it((e,t,{size:n})=>({error:{wordBreak:"break-word",color:e.fn.variant({variant:"filled",color:"red"}).background,fontSize:`calc(${ke({size:n,sizes:e.fontSizes})} - ${G(2)})`,lineHeight:1.2,display:"block"}}));const y_e=g_e;var v_e=Object.defineProperty,IS=Object.getOwnPropertySymbols,CZ=Object.prototype.hasOwnProperty,IZ=Object.prototype.propertyIsEnumerable,LW=(e,t,n)=>t in e?v_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,b_e=(e,t)=>{for(var n in t||(t={}))CZ.call(t,n)&&LW(e,n,t[n]);if(IS)for(var n of IS(t))IZ.call(t,n)&&LW(e,n,t[n]);return e},w_e=(e,t)=>{var n={};for(var r in e)CZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&IS)for(var r of IS(e))t.indexOf(r)<0&&IZ.call(e,r)&&(n[r]=e[r]);return n};const x_e={size:"sm"},wR=I.exports.forwardRef((e,t)=>{const n=Ke("InputError",x_e,e),{children:r,className:i,classNames:a,styles:s,unstyled:o,size:l,__staticSelector:u,variant:c}=n,d=w_e(n,["children","className","classNames","styles","unstyled","size","__staticSelector","variant"]),{classes:p,cx:h}=y_e(null,{name:["InputWrapper",u],classNames:a,styles:s,unstyled:o,variant:c,size:l});return x(Te,{...b_e({className:h(p.error,i),ref:t},d),children:r})});wR.displayName="@mantine/core/InputError";var __e=it((e,t,{size:n})=>({description:{wordBreak:"break-word",color:e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[6],fontSize:`calc(${ke({size:n,sizes:e.fontSizes})} - ${G(2)})`,lineHeight:1.2,display:"block"}}));const k_e=__e;var S_e=Object.defineProperty,$S=Object.getOwnPropertySymbols,$Z=Object.prototype.hasOwnProperty,TZ=Object.prototype.propertyIsEnumerable,FW=(e,t,n)=>t in e?S_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,C_e=(e,t)=>{for(var n in t||(t={}))$Z.call(t,n)&&FW(e,n,t[n]);if($S)for(var n of $S(t))TZ.call(t,n)&&FW(e,n,t[n]);return e},I_e=(e,t)=>{var n={};for(var r in e)$Z.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&$S)for(var r of $S(e))t.indexOf(r)<0&&TZ.call(e,r)&&(n[r]=e[r]);return n};const $_e={size:"sm"},xR=I.exports.forwardRef((e,t)=>{const n=Ke("InputDescription",$_e,e),{children:r,className:i,classNames:a,styles:s,unstyled:o,size:l,__staticSelector:u,variant:c}=n,d=I_e(n,["children","className","classNames","styles","unstyled","size","__staticSelector","variant"]),{classes:p,cx:h}=k_e(null,{name:["InputWrapper",u],classNames:a,styles:s,unstyled:o,variant:c,size:l});return x(Te,{...C_e({color:"dimmed",className:h(p.description,i),ref:t,unstyled:o},d),children:r})});xR.displayName="@mantine/core/InputDescription";const NZ=I.exports.createContext({offsetBottom:!1,offsetTop:!1,describedBy:void 0}),T_e=NZ.Provider,N_e=()=>I.exports.useContext(NZ);function E_e(e,{hasDescription:t,hasError:n}){const r=e.findIndex(l=>l==="input"),i=e[r-1],a=e[r+1];return{offsetBottom:t&&a==="description"||n&&a==="error",offsetTop:t&&i==="description"||n&&i==="error"}}var O_e=Object.defineProperty,P_e=Object.defineProperties,A_e=Object.getOwnPropertyDescriptors,zW=Object.getOwnPropertySymbols,M_e=Object.prototype.hasOwnProperty,R_e=Object.prototype.propertyIsEnumerable,BW=(e,t,n)=>t in e?O_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,D_e=(e,t)=>{for(var n in t||(t={}))M_e.call(t,n)&&BW(e,n,t[n]);if(zW)for(var n of zW(t))R_e.call(t,n)&&BW(e,n,t[n]);return e},L_e=(e,t)=>P_e(e,A_e(t)),F_e=it(e=>({root:L_e(D_e({},e.fn.fontStyles()),{lineHeight:e.lineHeight})}));const z_e=F_e;var B_e=Object.defineProperty,W_e=Object.defineProperties,V_e=Object.getOwnPropertyDescriptors,TS=Object.getOwnPropertySymbols,EZ=Object.prototype.hasOwnProperty,OZ=Object.prototype.propertyIsEnumerable,WW=(e,t,n)=>t in e?B_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lc=(e,t)=>{for(var n in t||(t={}))EZ.call(t,n)&&WW(e,n,t[n]);if(TS)for(var n of TS(t))OZ.call(t,n)&&WW(e,n,t[n]);return e},VW=(e,t)=>W_e(e,V_e(t)),j_e=(e,t)=>{var n={};for(var r in e)EZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&TS)for(var r of TS(e))t.indexOf(r)<0&&OZ.call(e,r)&&(n[r]=e[r]);return n};const U_e={labelElement:"label",size:"sm",inputContainer:e=>e,inputWrapperOrder:["label","description","input","error"]},PZ=I.exports.forwardRef((e,t)=>{const n=Ke("InputWrapper",U_e,e),{className:r,label:i,children:a,required:s,id:o,error:l,description:u,labelElement:c,labelProps:d,descriptionProps:p,errorProps:h,classNames:m,styles:g,size:v,inputContainer:y,__staticSelector:b,unstyled:_,inputWrapperOrder:k,withAsterisk:C,variant:$}=n,N=j_e(n,["className","label","children","required","id","error","description","labelElement","labelProps","descriptionProps","errorProps","classNames","styles","size","inputContainer","__staticSelector","unstyled","inputWrapperOrder","withAsterisk","variant"]),{classes:A,cx:D}=z_e(null,{classNames:m,styles:g,name:["InputWrapper",b],unstyled:_,variant:$,size:v}),O={classNames:m,styles:g,unstyled:_,size:v,variant:$,__staticSelector:b},F=typeof C=="boolean"?C:s,E=o?`${o}-error`:h==null?void 0:h.id,z=o?`${o}-description`:p==null?void 0:p.id,H=`${!!l&&typeof l!="boolean"?E:""} ${u?z:""}`,J=H.trim().length>0?H.trim():void 0,ee=i&&x(bR,{...lc(lc({key:"label",labelElement:c,id:o?`${o}-label`:void 0,htmlFor:o,required:F},O),d),children:i}),V=u&&x(xR,{...VW(lc(lc({key:"description"},p),O),{size:(p==null?void 0:p.size)||O.size,id:(p==null?void 0:p.id)||z}),children:u}),Q=x(I.exports.Fragment,{children:y(a)},"input"),X=typeof l!="boolean"&&l&&x(wR,{...VW(lc(lc({},h),O),{size:(h==null?void 0:h.size)||O.size,key:"error",id:(h==null?void 0:h.id)||E}),children:l}),Y=k.map(ce=>{switch(ce){case"label":return ee;case"input":return Q;case"description":return V;case"error":return X;default:return null}});return x(T_e,{value:lc({describedBy:J},E_e(k,{hasDescription:!!V,hasError:!!X})),children:x(wt,{...lc({className:D(A.root,r),ref:t},N),children:Y})})});PZ.displayName="@mantine/core/InputWrapper";var H_e=Object.defineProperty,NS=Object.getOwnPropertySymbols,AZ=Object.prototype.hasOwnProperty,MZ=Object.prototype.propertyIsEnumerable,jW=(e,t,n)=>t in e?H_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,G_e=(e,t)=>{for(var n in t||(t={}))AZ.call(t,n)&&jW(e,n,t[n]);if(NS)for(var n of NS(t))MZ.call(t,n)&&jW(e,n,t[n]);return e},q_e=(e,t)=>{var n={};for(var r in e)AZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&NS)for(var r of NS(e))t.indexOf(r)<0&&MZ.call(e,r)&&(n[r]=e[r]);return n};const K_e={},RZ=I.exports.forwardRef((e,t)=>{const n=Ke("InputPlaceholder",K_e,e),{sx:r}=n,i=q_e(n,["sx"]);return x(wt,{...G_e({component:"span",sx:[a=>a.fn.placeholderStyles(),...UM(r)],ref:t},i)})});RZ.displayName="@mantine/core/InputPlaceholder";var Z_e=Object.defineProperty,X_e=Object.defineProperties,J_e=Object.getOwnPropertyDescriptors,UW=Object.getOwnPropertySymbols,Y_e=Object.prototype.hasOwnProperty,Q_e=Object.prototype.propertyIsEnumerable,HW=(e,t,n)=>t in e?Z_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Xx=(e,t)=>{for(var n in t||(t={}))Y_e.call(t,n)&&HW(e,n,t[n]);if(UW)for(var n of UW(t))Q_e.call(t,n)&&HW(e,n,t[n]);return e},AN=(e,t)=>X_e(e,J_e(t));const Ui={xs:G(30),sm:G(36),md:G(42),lg:G(50),xl:G(60)},eke=["default","filled","unstyled"];function tke({theme:e,variant:t}){return eke.includes(t)?t==="default"?{border:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.white,transition:"border-color 100ms ease","&:focus, &:focus-within":e.focusRingStyles.inputStyles(e)}:t==="filled"?{border:`${G(1)} solid transparent`,backgroundColor:e.colorScheme==="dark"?e.colors.dark[5]:e.colors.gray[1],"&:focus, &:focus-within":e.focusRingStyles.inputStyles(e)}:{borderWidth:0,color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,backgroundColor:"transparent",minHeight:G(28),outline:0,"&:focus, &:focus-within":{outline:"none",borderColor:"transparent"},"&:disabled":{backgroundColor:"transparent","&:focus, &:focus-within":{outline:"none",borderColor:"transparent"}}}:null}var nke=it((e,{multiline:t,radius:n,invalid:r,rightSectionWidth:i,withRightSection:a,iconWidth:s,offsetBottom:o,offsetTop:l,pointer:u},{variant:c,size:d})=>{const p=e.fn.variant({variant:"filled",color:"red"}).background,h=c==="default"||c==="filled"?{minHeight:ke({size:d,sizes:Ui}),paddingLeft:`calc(${ke({size:d,sizes:Ui})}  / 3)`,paddingRight:a?i||ke({size:d,sizes:Ui}):`calc(${ke({size:d,sizes:Ui})}  / 3)`,borderRadius:e.fn.radius(n)}:c==="unstyled"&&a?{paddingRight:i||ke({size:d,sizes:Ui})}:null;return{wrapper:{position:"relative",marginTop:l?`calc(${e.spacing.xs} / 2)`:void 0,marginBottom:o?`calc(${e.spacing.xs} / 2)`:void 0,"&:has(input:disabled)":{"& .mantine-Input-rightSection":{display:"none"}}},input:AN(Xx(Xx(AN(Xx({},e.fn.fontStyles()),{height:t?c==="unstyled"?void 0:"auto":ke({size:d,sizes:Ui}),WebkitTapHighlightColor:"transparent",lineHeight:t?e.lineHeight:`calc(${ke({size:d,sizes:Ui})} - ${G(2)})`,appearance:"none",resize:"none",boxSizing:"border-box",fontSize:ke({size:d,sizes:e.fontSizes}),width:"100%",color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,display:"block",textAlign:"left",cursor:u?"pointer":void 0}),tke({theme:e,variant:c})),h),{"&:disabled, &[data-disabled]":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[1],color:e.colors.dark[2],opacity:.6,cursor:"not-allowed",pointerEvents:"none","&::placeholder":{color:e.colors.dark[2]}},"&[data-invalid]":{color:p,borderColor:p,"&::placeholder":{opacity:1,color:p}},"&[data-with-icon]":{paddingLeft:typeof s=="number"?G(s):ke({size:d,sizes:Ui})},"&::placeholder":AN(Xx({},e.fn.placeholderStyles()),{opacity:1}),"&::-webkit-inner-spin-button, &::-webkit-outer-spin-button, &::-webkit-search-decoration, &::-webkit-search-cancel-button, &::-webkit-search-results-button, &::-webkit-search-results-decoration":{appearance:"none"},"&[type=number]":{MozAppearance:"textfield"}}),icon:{pointerEvents:"none",position:"absolute",zIndex:1,left:0,top:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",width:s?G(s):ke({size:d,sizes:Ui}),color:r?e.colors.red[e.colorScheme==="dark"?6:7]:e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[5]},rightSection:{position:"absolute",top:0,bottom:0,right:0,display:"flex",alignItems:"center",justifyContent:"center",width:i||ke({size:d,sizes:Ui})}}});const rke=nke;var ike=Object.defineProperty,ake=Object.defineProperties,ske=Object.getOwnPropertyDescriptors,ES=Object.getOwnPropertySymbols,DZ=Object.prototype.hasOwnProperty,LZ=Object.prototype.propertyIsEnumerable,GW=(e,t,n)=>t in e?ike(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Jx=(e,t)=>{for(var n in t||(t={}))DZ.call(t,n)&&GW(e,n,t[n]);if(ES)for(var n of ES(t))LZ.call(t,n)&&GW(e,n,t[n]);return e},qW=(e,t)=>ake(e,ske(t)),oke=(e,t)=>{var n={};for(var r in e)DZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&ES)for(var r of ES(e))t.indexOf(r)<0&&LZ.call(e,r)&&(n[r]=e[r]);return n};const lke={size:"sm",variant:"default"},$h=I.exports.forwardRef((e,t)=>{const n=Ke("Input",lke,e),{className:r,error:i,required:a,disabled:s,variant:o,icon:l,style:u,rightSectionWidth:c,iconWidth:d,rightSection:p,rightSectionProps:h,radius:m,size:g,wrapperProps:v,classNames:y,styles:b,__staticSelector:_,multiline:k,sx:C,unstyled:$,pointer:N}=n,A=oke(n,["className","error","required","disabled","variant","icon","style","rightSectionWidth","iconWidth","rightSection","rightSectionProps","radius","size","wrapperProps","classNames","styles","__staticSelector","multiline","sx","unstyled","pointer"]),{offsetBottom:D,offsetTop:O,describedBy:F}=N_e(),{classes:E,cx:z}=rke({radius:m,multiline:k,invalid:!!i,rightSectionWidth:c?G(c):void 0,iconWidth:d,withRightSection:!!p,offsetBottom:D,offsetTop:O,pointer:N},{classNames:y,styles:b,name:["Input",_],unstyled:$,variant:o,size:g}),{systemStyles:q,rest:H}=Cd(A);return B(wt,{...Jx(Jx({className:z(E.wrapper,r),sx:C,style:u},q),v),children:[l&&x("div",{className:E.icon,children:l}),x(wt,{...qW(Jx({component:"input"},H),{ref:t,required:a,"aria-invalid":!!i,"aria-describedby":F,disabled:s,"data-disabled":s||void 0,"data-with-icon":!!l||void 0,"data-invalid":!!i||void 0,className:E.input})}),p&&x("div",{...qW(Jx({},h),{className:E.rightSection}),children:p})]})});$h.displayName="@mantine/core/Input";$h.Wrapper=PZ;$h.Label=bR;$h.Description=xR;$h.Error=wR;$h.Placeholder=RZ;const As=$h;var uke=Object.defineProperty,OS=Object.getOwnPropertySymbols,FZ=Object.prototype.hasOwnProperty,zZ=Object.prototype.propertyIsEnumerable,KW=(e,t,n)=>t in e?uke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,cke=(e,t)=>{for(var n in t||(t={}))FZ.call(t,n)&&KW(e,n,t[n]);if(OS)for(var n of OS(t))zZ.call(t,n)&&KW(e,n,t[n]);return e},dke=(e,t)=>{var n={};for(var r in e)FZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&OS)for(var r of OS(e))t.indexOf(r)<0&&zZ.call(e,r)&&(n[r]=e[r]);return n};function pke(e){const t=e,{style:n}=t,r=dke(t,["style"]);return x("svg",{...cke({viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:n},r),children:x("path",{d:"M0.877014 7.49988C0.877014 3.84219 3.84216 0.877045 7.49985 0.877045C11.1575 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1575 14.1227 7.49985 14.1227C3.84216 14.1227 0.877014 11.1575 0.877014 7.49988ZM7.49985 1.82704C4.36683 1.82704 1.82701 4.36686 1.82701 7.49988C1.82701 8.97196 2.38774 10.3131 3.30727 11.3213C4.19074 9.94119 5.73818 9.02499 7.50023 9.02499C9.26206 9.02499 10.8093 9.94097 11.6929 11.3208C12.6121 10.3127 13.1727 8.97172 13.1727 7.49988C13.1727 4.36686 10.6328 1.82704 7.49985 1.82704ZM10.9818 11.9787C10.2839 10.7795 8.9857 9.97499 7.50023 9.97499C6.01458 9.97499 4.71624 10.7797 4.01845 11.9791C4.97952 12.7272 6.18765 13.1727 7.49985 13.1727C8.81227 13.1727 10.0206 12.727 10.9818 11.9787ZM5.14999 6.50487C5.14999 5.207 6.20212 4.15487 7.49999 4.15487C8.79786 4.15487 9.84999 5.207 9.84999 6.50487C9.84999 7.80274 8.79786 8.85487 7.49999 8.85487C6.20212 8.85487 5.14999 7.80274 5.14999 6.50487ZM7.49999 5.10487C6.72679 5.10487 6.09999 5.73167 6.09999 6.50487C6.09999 7.27807 6.72679 7.90487 7.49999 7.90487C8.27319 7.90487 8.89999 7.27807 8.89999 6.50487C8.89999 5.73167 8.27319 5.10487 7.49999 5.10487Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}var hke=Object.defineProperty,fke=Object.defineProperties,mke=Object.getOwnPropertyDescriptors,ZW=Object.getOwnPropertySymbols,gke=Object.prototype.hasOwnProperty,yke=Object.prototype.propertyIsEnumerable,XW=(e,t,n)=>t in e?hke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,vke=(e,t)=>{for(var n in t||(t={}))gke.call(t,n)&&XW(e,n,t[n]);if(ZW)for(var n of ZW(t))yke.call(t,n)&&XW(e,n,t[n]);return e},bke=(e,t)=>fke(e,mke(t));const BZ=I.exports.createContext(null);function wke({spacing:e,children:t}){return x(BZ.Provider,{value:{spacing:e},children:t})}function xke(){const e=I.exports.useContext(BZ);return e?bke(vke({},e),{withinGroup:!0}):{spacing:null,withinGroup:!1}}var _ke=it((e,{spacing:t})=>({root:{display:"flex",paddingLeft:ke({size:t,sizes:e.spacing})}}));const kke=_ke;var Ske=Object.defineProperty,PS=Object.getOwnPropertySymbols,WZ=Object.prototype.hasOwnProperty,VZ=Object.prototype.propertyIsEnumerable,JW=(e,t,n)=>t in e?Ske(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Cke=(e,t)=>{for(var n in t||(t={}))WZ.call(t,n)&&JW(e,n,t[n]);if(PS)for(var n of PS(t))VZ.call(t,n)&&JW(e,n,t[n]);return e},Ike=(e,t)=>{var n={};for(var r in e)WZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&PS)for(var r of PS(e))t.indexOf(r)<0&&VZ.call(e,r)&&(n[r]=e[r]);return n};const $ke={},jZ=I.exports.forwardRef((e,t)=>{const n=Ke("AvatarGroup",$ke,e),{children:r,spacing:i="sm",unstyled:a,className:s,variant:o}=n,l=Ike(n,["children","spacing","unstyled","className","variant"]),{classes:u,cx:c}=kke({spacing:i},{name:"AvatarGroup",unstyled:a,variant:o});return x(wke,{spacing:i,children:x(wt,{...Cke({ref:t,className:c(u.root,s)},l),children:r})})});jZ.displayName="@mantine/core/AvatarGroup";var Tke=Object.defineProperty,Nke=Object.defineProperties,Eke=Object.getOwnPropertyDescriptors,YW=Object.getOwnPropertySymbols,Oke=Object.prototype.hasOwnProperty,Pke=Object.prototype.propertyIsEnumerable,QW=(e,t,n)=>t in e?Tke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,M0=(e,t)=>{for(var n in t||(t={}))Oke.call(t,n)&&QW(e,n,t[n]);if(YW)for(var n of YW(t))Pke.call(t,n)&&QW(e,n,t[n]);return e},eV=(e,t)=>Nke(e,Eke(t));const Ake=["filled","light","gradient","outline"],Yx={xs:G(16),sm:G(26),md:G(38),lg:G(56),xl:G(84)};function Mke({withinGroup:e,spacing:t,theme:n}){return e?{marginLeft:`calc(${ke({size:t,sizes:n.spacing})} * -1)`,backgroundColor:`${n.colorScheme==="dark"?n.colors.dark[7]:n.white}`,border:`${G(2)} solid ${n.colorScheme==="dark"?n.colors.dark[7]:n.white}`}:null}function Rke({theme:e,variant:t,color:n,gradient:r}){const i=e.fn.variant({variant:t,color:n,gradient:r});return Ake.includes(t)?{placeholder:{color:i.color,backgroundColor:i.background,backgroundImage:t==="gradient"?i.background:void 0,border:`${G(t==="gradient"?0:1)} solid ${i.border}`},placeholderIcon:{color:i.color}}:{}}var Dke=it((e,{radius:t,withinGroup:n,spacing:r,color:i,gradient:a},{variant:s,size:o})=>{const l=Rke({theme:e,color:i,gradient:a,variant:s});return{root:M0(eV(M0({},e.fn.focusStyles()),{WebkitTapHighlightColor:"transparent",boxSizing:"border-box",position:"relative",display:"block",userSelect:"none",overflow:"hidden",borderRadius:e.fn.radius(t),textDecoration:"none",border:0,backgroundColor:"transparent",padding:0,width:ke({size:o,sizes:Yx}),minWidth:ke({size:o,sizes:Yx}),height:ke({size:o,sizes:Yx})}),Mke({withinGroup:n,spacing:r,theme:e})),image:{objectFit:"cover",width:"100%",height:"100%",display:"block"},placeholder:M0(eV(M0({},e.fn.fontStyles()),{fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",userSelect:"none",borderRadius:e.fn.radius(t),fontSize:`calc(${ke({size:o,sizes:Yx})} / 2.5)`}),l.placeholder),placeholderIcon:M0({width:"70%",height:"70%"},l.placeholderIcon)}});const Lke=Dke;var Fke=Object.defineProperty,zke=Object.defineProperties,Bke=Object.getOwnPropertyDescriptors,AS=Object.getOwnPropertySymbols,UZ=Object.prototype.hasOwnProperty,HZ=Object.prototype.propertyIsEnumerable,tV=(e,t,n)=>t in e?Fke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nV=(e,t)=>{for(var n in t||(t={}))UZ.call(t,n)&&tV(e,n,t[n]);if(AS)for(var n of AS(t))HZ.call(t,n)&&tV(e,n,t[n]);return e},Wke=(e,t)=>zke(e,Bke(t)),Vke=(e,t)=>{var n={};for(var r in e)UZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&AS)for(var r of AS(e))t.indexOf(r)<0&&HZ.call(e,r)&&(n[r]=e[r]);return n};const jke={size:"md",color:"gray",variant:"light"},_R=I.exports.forwardRef((e,t)=>{const n=Ke("Avatar",jke,e),{className:r,size:i,src:a,alt:s,radius:o,children:l,color:u,variant:c,gradient:d,classNames:p,styles:h,imageProps:m,unstyled:g}=n,v=Vke(n,["className","size","src","alt","radius","children","color","variant","gradient","classNames","styles","imageProps","unstyled"]),y=xke(),[b,_]=I.exports.useState(!a),{classes:k,cx:C}=Lke({color:u,radius:o,withinGroup:y.withinGroup,spacing:y.spacing,gradient:d},{classNames:p,styles:h,unstyled:g,name:"Avatar",variant:c,size:i});return I.exports.useEffect(()=>{_(!a)},[a]),x(wt,{...nV({component:"div",className:C(k.root,r),ref:t},v),children:b?x("div",{className:k.placeholder,title:s,children:l||x(pke,{className:k.placeholderIcon})}):x("img",{...Wke(nV({},m),{className:k.image,src:a,alt:s,onError:()=>_(!0)})})})});_R.displayName="@mantine/core/Avatar";_R.Group=jZ;const er=_R;var Uke=Object.defineProperty,Hke=Object.defineProperties,Gke=Object.getOwnPropertyDescriptors,rV=Object.getOwnPropertySymbols,qke=Object.prototype.hasOwnProperty,Kke=Object.prototype.propertyIsEnumerable,iV=(e,t,n)=>t in e?Uke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,MN=(e,t)=>{for(var n in t||(t={}))qke.call(t,n)&&iV(e,n,t[n]);if(rV)for(var n of rV(t))Kke.call(t,n)&&iV(e,n,t[n]);return e},Zke=(e,t)=>Hke(e,Gke(t));const Xke=["light","filled","outline","dot","gradient"],RN={xs:{fontSize:G(9),height:G(16)},sm:{fontSize:G(10),height:G(18)},md:{fontSize:G(11),height:G(20)},lg:{fontSize:G(13),height:G(26)},xl:{fontSize:G(16),height:G(32)}},Jke={xs:G(4),sm:G(4),md:G(6),lg:G(8),xl:G(10)};function Yke({theme:e,variant:t,color:n,size:r,gradient:i}){if(!Xke.includes(t))return null;if(t==="dot"){const s=ke({size:r,sizes:Jke});return{backgroundColor:"transparent",color:e.colorScheme==="dark"?e.colors.dark[0]:e.colors.gray[7],border:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[3]}`,paddingLeft:`calc(${ke({size:r,sizes:e.spacing})} / 1.5 - ${s} / 2)`,"&::before":{content:'""',display:"block",width:s,height:s,borderRadius:s,backgroundColor:e.fn.themeColor(n,e.colorScheme==="dark"?4:e.fn.primaryShade("light"),!0),marginRight:s}}}const a=e.fn.variant({color:n,variant:t,gradient:i});return{background:a.background,color:a.color,border:`${G(t==="gradient"?0:1)} solid ${a.border}`}}var Qke=it((e,{color:t,radius:n,gradient:r,fullWidth:i},{variant:a,size:s})=>{const{fontSize:o,height:l}=s in RN?RN[s]:RN.md;return{leftSection:{marginRight:`calc(${e.spacing.xs} / 2)`},rightSection:{marginLeft:`calc(${e.spacing.xs} / 2)`},inner:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},root:MN(Zke(MN(MN({},e.fn.focusStyles()),e.fn.fontStyles()),{fontSize:o,height:l,WebkitTapHighlightColor:"transparent",lineHeight:`calc(${l} - ${G(2)})`,textDecoration:"none",padding:`0 calc(${ke({size:s,sizes:e.spacing})} / 1.5)`,boxSizing:"border-box",display:i?"flex":"inline-flex",alignItems:"center",justifyContent:"center",width:i?"100%":"auto",textTransform:"uppercase",borderRadius:e.fn.radius(n),fontWeight:700,letterSpacing:G(.25),cursor:"inherit",textOverflow:"ellipsis",overflow:"hidden"}),Yke({theme:e,variant:a,color:t,size:s,gradient:r}))}});const eSe=Qke;var tSe=Object.defineProperty,MS=Object.getOwnPropertySymbols,GZ=Object.prototype.hasOwnProperty,qZ=Object.prototype.propertyIsEnumerable,aV=(e,t,n)=>t in e?tSe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nSe=(e,t)=>{for(var n in t||(t={}))GZ.call(t,n)&&aV(e,n,t[n]);if(MS)for(var n of MS(t))qZ.call(t,n)&&aV(e,n,t[n]);return e},rSe=(e,t)=>{var n={};for(var r in e)GZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&MS)for(var r of MS(e))t.indexOf(r)<0&&qZ.call(e,r)&&(n[r]=e[r]);return n};const iSe={variant:"light",size:"md",radius:"xl"},KZ=I.exports.forwardRef((e,t)=>{const n=Ke("Badge",iSe,e),{className:r,color:i,variant:a,fullWidth:s,children:o,size:l,leftSection:u,rightSection:c,radius:d,gradient:p,classNames:h,styles:m,unstyled:g}=n,v=rSe(n,["className","color","variant","fullWidth","children","size","leftSection","rightSection","radius","gradient","classNames","styles","unstyled"]),{classes:y,cx:b}=eSe({fullWidth:s,color:i,radius:d,gradient:p},{classNames:h,styles:m,name:"Badge",unstyled:g,variant:a,size:l});return B(wt,{...nSe({className:b(y.root,r),ref:t},v),children:[u&&x("span",{className:y.leftSection,children:u}),x("span",{className:y.inner,children:o}),c&&x("span",{className:y.rightSection,children:c})]})});KZ.displayName="@mantine/core/Badge";const bt=KZ;var aSe=it((e,{orientation:t,buttonBorderWidth:n})=>({root:{display:"flex",flexDirection:t==="vertical"?"column":"row","& [data-button]":{"&:first-of-type:not(:last-of-type)":{borderBottomRightRadius:0,[t==="vertical"?"borderBottomLeftRadius":"borderTopRightRadius"]:0,[t==="vertical"?"borderBottomWidth":"borderRightWidth"]:`calc(${G(n)} / 2)`},"&:last-of-type:not(:first-of-type)":{borderTopLeftRadius:0,[t==="vertical"?"borderTopRightRadius":"borderBottomLeftRadius"]:0,[t==="vertical"?"borderTopWidth":"borderLeftWidth"]:`calc(${G(n)} / 2)`},"&:not(:first-of-type):not(:last-of-type)":{borderRadius:0,[t==="vertical"?"borderTopWidth":"borderLeftWidth"]:`calc(${G(n)} / 2)`,[t==="vertical"?"borderBottomWidth":"borderRightWidth"]:`calc(${G(n)} / 2)`},"& + [data-button]":{[t==="vertical"?"marginTop":"marginLeft"]:`calc(${n} * -1)`,"@media (min-resolution: 192dpi)":{[t==="vertical"?"marginTop":"marginLeft"]:0}}}}}));const sSe=aSe;var oSe=Object.defineProperty,RS=Object.getOwnPropertySymbols,ZZ=Object.prototype.hasOwnProperty,XZ=Object.prototype.propertyIsEnumerable,sV=(e,t,n)=>t in e?oSe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lSe=(e,t)=>{for(var n in t||(t={}))ZZ.call(t,n)&&sV(e,n,t[n]);if(RS)for(var n of RS(t))XZ.call(t,n)&&sV(e,n,t[n]);return e},uSe=(e,t)=>{var n={};for(var r in e)ZZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&RS)for(var r of RS(e))t.indexOf(r)<0&&XZ.call(e,r)&&(n[r]=e[r]);return n};const cSe={orientation:"horizontal",buttonBorderWidth:1},JZ=I.exports.forwardRef((e,t)=>{const n=Ke("ButtonGroup",cSe,e),{className:r,orientation:i,buttonBorderWidth:a,unstyled:s}=n,o=uSe(n,["className","orientation","buttonBorderWidth","unstyled"]),{classes:l,cx:u}=sSe({orientation:i,buttonBorderWidth:a},{name:"ButtonGroup",unstyled:s});return x(wt,{...lSe({className:u(l.root,r),ref:t},o)})});JZ.displayName="@mantine/core/ButtonGroup";var dSe=Object.defineProperty,pSe=Object.defineProperties,hSe=Object.getOwnPropertyDescriptors,oV=Object.getOwnPropertySymbols,fSe=Object.prototype.hasOwnProperty,mSe=Object.prototype.propertyIsEnumerable,lV=(e,t,n)=>t in e?dSe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,fu=(e,t)=>{for(var n in t||(t={}))fSe.call(t,n)&&lV(e,n,t[n]);if(oV)for(var n of oV(t))mSe.call(t,n)&&lV(e,n,t[n]);return e},ek=(e,t)=>pSe(e,hSe(t));const gSe=["filled","outline","light","white","default","subtle","gradient"],eP={xs:{height:Ui.xs,paddingLeft:G(14),paddingRight:G(14)},sm:{height:Ui.sm,paddingLeft:G(18),paddingRight:G(18)},md:{height:Ui.md,paddingLeft:G(22),paddingRight:G(22)},lg:{height:Ui.lg,paddingLeft:G(26),paddingRight:G(26)},xl:{height:Ui.xl,paddingLeft:G(32),paddingRight:G(32)},"compact-xs":{height:G(22),paddingLeft:G(7),paddingRight:G(7)},"compact-sm":{height:G(26),paddingLeft:G(8),paddingRight:G(8)},"compact-md":{height:G(30),paddingLeft:G(10),paddingRight:G(10)},"compact-lg":{height:G(34),paddingLeft:G(12),paddingRight:G(12)},"compact-xl":{height:G(40),paddingLeft:G(14),paddingRight:G(14)}};function ySe({compact:e,size:t,withLeftIcon:n,withRightIcon:r}){if(e)return eP[`compact-${t}`];const i=eP[t];return i?ek(fu({},i),{paddingLeft:n?`calc(${i.paddingLeft}  / 1.5)`:i.paddingLeft,paddingRight:r?`calc(${i.paddingRight}  / 1.5)`:i.paddingRight}):{}}const vSe=e=>({display:e?"block":"inline-block",width:e?"100%":"auto"});function bSe({variant:e,theme:t,color:n,gradient:r}){if(!gSe.includes(e))return null;const i=t.fn.variant({color:n,variant:e,gradient:r});return e==="gradient"?fu({border:0,backgroundImage:i.background,color:i.color},t.fn.hover({backgroundSize:"200%"})):fu({border:`${G(1)} solid ${i.border}`,backgroundColor:i.background,color:i.color},t.fn.hover({backgroundColor:i.hover}))}var wSe=it((e,{radius:t,fullWidth:n,compact:r,withLeftIcon:i,withRightIcon:a,color:s,gradient:o},{variant:l,size:u})=>({root:ek(fu(ek(fu(fu(fu(fu({},ySe({compact:r,size:u,withLeftIcon:i,withRightIcon:a})),e.fn.fontStyles()),e.fn.focusStyles()),vSe(n)),{borderRadius:e.fn.radius(t),fontWeight:600,position:"relative",lineHeight:1,fontSize:ke({size:u,sizes:e.fontSizes}),userSelect:"none",cursor:"pointer"}),bSe({variant:l,theme:e,color:s,gradient:o})),{"&:active":e.activeStyles,"&:disabled, &[data-disabled]":{borderColor:"transparent",backgroundColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2],color:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[5],cursor:"not-allowed",backgroundImage:"none",pointerEvents:"none","&:active":{transform:"none"}},"&[data-loading]":{pointerEvents:"none","&::before":ek(fu({content:'""'},e.fn.cover(G(-1))),{backgroundColor:e.colorScheme==="dark"?e.fn.rgba(e.colors.dark[7],.5):"rgba(255, 255, 255, .5)",borderRadius:e.fn.radius(t),cursor:"not-allowed"})}}),icon:{display:"flex",alignItems:"center"},leftIcon:{marginRight:e.spacing.xs},rightIcon:{marginLeft:e.spacing.xs},centerLoader:{position:"absolute",left:"50%",transform:"translateX(-50%)",opacity:.5},inner:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",overflow:"visible"},label:{whiteSpace:"nowrap",height:"100%",overflow:"hidden",display:"flex",alignItems:"center"}}));const xSe=wSe;var _Se=Object.defineProperty,DS=Object.getOwnPropertySymbols,YZ=Object.prototype.hasOwnProperty,QZ=Object.prototype.propertyIsEnumerable,uV=(e,t,n)=>t in e?_Se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,cV=(e,t)=>{for(var n in t||(t={}))YZ.call(t,n)&&uV(e,n,t[n]);if(DS)for(var n of DS(t))QZ.call(t,n)&&uV(e,n,t[n]);return e},kSe=(e,t)=>{var n={};for(var r in e)YZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&DS)for(var r of DS(e))t.indexOf(r)<0&&QZ.call(e,r)&&(n[r]=e[r]);return n};const SSe={size:"sm",type:"button",variant:"filled",loaderPosition:"left"},kR=I.exports.forwardRef((e,t)=>{const n=Ke("Button",SSe,e),{className:r,size:i,color:a,type:s,disabled:o,children:l,leftIcon:u,rightIcon:c,fullWidth:d,variant:p,radius:h,uppercase:m,compact:g,loading:v,loaderPosition:y,loaderProps:b,gradient:_,classNames:k,styles:C,unstyled:$}=n,N=kSe(n,["className","size","color","type","disabled","children","leftIcon","rightIcon","fullWidth","variant","radius","uppercase","compact","loading","loaderPosition","loaderProps","gradient","classNames","styles","unstyled"]),{classes:A,cx:D,theme:O}=xSe({radius:h,color:a,fullWidth:d,compact:g,gradient:_,withLeftIcon:!!u,withRightIcon:!!c},{name:"Button",unstyled:$,classNames:k,styles:C,variant:p,size:i}),F=O.fn.variant({color:a,variant:p}),E=x(nR,{...cV({color:F.color,size:`calc(${ke({size:i,sizes:eP}).height} / 2)`},b)});return x(D1,{...cV({className:D(A.root,r),type:s,disabled:o,"data-button":!0,"data-disabled":o||void 0,"data-loading":v||void 0,ref:t,unstyled:$},N),children:B("div",{className:A.inner,children:[(u||v&&y==="left")&&x("span",{className:D(A.icon,A.leftIcon),children:v&&y==="left"?E:u}),v&&y==="center"&&x("span",{className:A.centerLoader,children:E}),x("span",{className:A.label,style:{textTransform:m?"uppercase":void 0},children:l}),(c||v&&y==="right")&&x("span",{className:D(A.icon,A.rightIcon),children:v&&y==="right"?E:c})]})})});kR.displayName="@mantine/core/Button";kR.Group=JZ;const Ct=kR;var CSe=it((e,{radius:t,shadow:n})=>({root:{outline:0,WebkitTapHighlightColor:"transparent",display:"block",textDecoration:"none",color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,backgroundColor:e.colorScheme==="dark"?e.colors.dark[7]:e.white,boxSizing:"border-box",borderRadius:e.fn.radius(t),boxShadow:e.shadows[n]||n||"none","&[data-with-border]":{border:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]}`}}}));const ISe=CSe;var $Se=Object.defineProperty,LS=Object.getOwnPropertySymbols,eX=Object.prototype.hasOwnProperty,tX=Object.prototype.propertyIsEnumerable,dV=(e,t,n)=>t in e?$Se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,TSe=(e,t)=>{for(var n in t||(t={}))eX.call(t,n)&&dV(e,n,t[n]);if(LS)for(var n of LS(t))tX.call(t,n)&&dV(e,n,t[n]);return e},NSe=(e,t)=>{var n={};for(var r in e)eX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&LS)for(var r of LS(e))t.indexOf(r)<0&&tX.call(e,r)&&(n[r]=e[r]);return n};const ESe={},nX=I.exports.forwardRef((e,t)=>{const n=Ke("Paper",ESe,e),{className:r,children:i,radius:a,withBorder:s,shadow:o,unstyled:l,variant:u}=n,c=NSe(n,["className","children","radius","withBorder","shadow","unstyled","variant"]),{classes:d,cx:p}=ISe({radius:a,shadow:o},{name:"Paper",unstyled:l,variant:u});return x(wt,{...TSe({className:p(d.root,r),"data-with-border":s||void 0,ref:t},c),children:i})});nX.displayName="@mantine/core/Paper";const Bt=nX;var OSe=it((e,{inline:t})=>({root:{display:t?"inline-flex":"flex",alignItems:"center",justifyContent:"center"}}));const PSe=OSe;var ASe=Object.defineProperty,FS=Object.getOwnPropertySymbols,rX=Object.prototype.hasOwnProperty,iX=Object.prototype.propertyIsEnumerable,pV=(e,t,n)=>t in e?ASe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,MSe=(e,t)=>{for(var n in t||(t={}))rX.call(t,n)&&pV(e,n,t[n]);if(FS)for(var n of FS(t))iX.call(t,n)&&pV(e,n,t[n]);return e},RSe=(e,t)=>{var n={};for(var r in e)rX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&FS)for(var r of FS(e))t.indexOf(r)<0&&iX.call(e,r)&&(n[r]=e[r]);return n};const aX=I.exports.forwardRef((e,t)=>{const n=Ke("Center",{},e),{inline:r,className:i,unstyled:a,variant:s}=n,o=RSe(n,["inline","className","unstyled","variant"]),{classes:l,cx:u}=PSe({inline:r},{name:"Center",unstyled:a,variant:s});return x(wt,{...MSe({ref:t,className:u(l.root,i)},o)})});aX.displayName="@mantine/core/Center";const SR=aX,sX=I.exports.createContext(null),DSe=sX.Provider,LSe=()=>I.exports.useContext(sX);var FSe=Object.defineProperty,zS=Object.getOwnPropertySymbols,oX=Object.prototype.hasOwnProperty,lX=Object.prototype.propertyIsEnumerable,hV=(e,t,n)=>t in e?FSe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,fV=(e,t)=>{for(var n in t||(t={}))oX.call(t,n)&&hV(e,n,t[n]);if(zS)for(var n of zS(t))lX.call(t,n)&&hV(e,n,t[n]);return e},zSe=(e,t)=>{var n={};for(var r in e)oX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&zS)for(var r of zS(e))t.indexOf(r)<0&&lX.call(e,r)&&(n[r]=e[r]);return n};const BSe={size:"sm"},uX=I.exports.forwardRef((e,t)=>{const n=Ke("CheckboxGroup",BSe,e),{children:r,value:i,defaultValue:a,onChange:s,size:o,wrapperProps:l}=n,u=zSe(n,["children","value","defaultValue","onChange","size","wrapperProps"]),[c,d]=qo({value:i,defaultValue:a,finalValue:[],onChange:s});return x(DSe,{value:{value:c,onChange:h=>{const m=h.currentTarget.value;d(c.includes(m)?c.filter(g=>g!==m):[...c,m])},size:o},children:x(As.Wrapper,{...fV(fV({labelElement:"div",size:o,__staticSelector:"CheckboxGroup",ref:t},l),u),children:r})})});uX.displayName="@mantine/core/CheckboxGroup";var WSe=Object.defineProperty,BS=Object.getOwnPropertySymbols,cX=Object.prototype.hasOwnProperty,dX=Object.prototype.propertyIsEnumerable,mV=(e,t,n)=>t in e?WSe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,WS=(e,t)=>{for(var n in t||(t={}))cX.call(t,n)&&mV(e,n,t[n]);if(BS)for(var n of BS(t))dX.call(t,n)&&mV(e,n,t[n]);return e},pX=(e,t)=>{var n={};for(var r in e)cX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&BS)for(var r of BS(e))t.indexOf(r)<0&&dX.call(e,r)&&(n[r]=e[r]);return n};function VSe(e){const t=e,{width:n,height:r,style:i}=t,a=pX(t,["width","height","style"]);return x("svg",{...WS({viewBox:"0 0 10 7",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:WS({width:n,height:r},i)},a),children:x("path",{d:"M4 4.586L1.707 2.293A1 1 0 1 0 .293 3.707l3 3a.997.997 0 0 0 1.414 0l5-5A1 1 0 1 0 8.293.293L4 4.586z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function jSe(e){var t=e,{indeterminate:n}=t,r=pX(t,["indeterminate"]);return n?x("svg",{...WS({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 32 6"},r),children:x("rect",{width:"32",height:"6",fill:"currentColor",rx:"3"})}):x(VSe,{...WS({},r)})}var USe=Object.defineProperty,HSe=Object.defineProperties,GSe=Object.getOwnPropertyDescriptors,gV=Object.getOwnPropertySymbols,qSe=Object.prototype.hasOwnProperty,KSe=Object.prototype.propertyIsEnumerable,yV=(e,t,n)=>t in e?USe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,vV=(e,t)=>{for(var n in t||(t={}))qSe.call(t,n)&&yV(e,n,t[n]);if(gV)for(var n of gV(t))KSe.call(t,n)&&yV(e,n,t[n]);return e},bV=(e,t)=>HSe(e,GSe(t));const ZSe={xs:G(16),sm:G(20),md:G(24),lg:G(30),xl:G(36)};var XSe=it((e,{radius:t,color:n,transitionDuration:r,labelPosition:i,error:a,indeterminate:s},{size:o})=>{const l=ke({size:o,sizes:ZSe}),u=e.fn.variant({variant:"filled",color:n});return{icon:bV(vV({},e.fn.cover()),{ref:zo("icon"),color:s?"inherit":e.white,transform:s?"none":`translateY(${G(5)}) scale(0.5)`,opacity:s?1:0,transitionProperty:"opacity, transform",transitionTimingFunction:"ease",transitionDuration:`${r}ms`,pointerEvents:"none",width:"60%",position:"absolute",zIndex:1,margin:"auto","@media (prefers-reduced-motion)":{transitionDuration:e.respectReducedMotion?"0ms":void 0}}),inner:{position:"relative",width:l,height:l,order:i==="left"?2:1},input:bV(vV({},e.fn.focusStyles()),{appearance:"none",backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.white,border:`${G(1)} solid ${a?e.fn.variant({variant:"filled",color:"red"}).background:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,width:l,height:l,borderRadius:e.fn.radius(t),padding:0,display:"block",margin:0,transition:`border-color ${r}ms ease, background-color ${r}ms ease`,cursor:e.cursorType,"&:checked":{backgroundColor:u.background,borderColor:u.background,[`& + .${zo("icon")}`]:{opacity:1,color:e.white,transform:"translateY(0) scale(1)"}},"&:disabled":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2],borderColor:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[3],cursor:"not-allowed",pointerEvents:"none",[`& + .${zo("icon")}`]:{color:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[5]}}})}});const JSe=XSe;var YSe=Object.defineProperty,QSe=Object.defineProperties,eCe=Object.getOwnPropertyDescriptors,wV=Object.getOwnPropertySymbols,tCe=Object.prototype.hasOwnProperty,nCe=Object.prototype.propertyIsEnumerable,xV=(e,t,n)=>t in e?YSe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rCe=(e,t)=>{for(var n in t||(t={}))tCe.call(t,n)&&xV(e,n,t[n]);if(wV)for(var n of wV(t))nCe.call(t,n)&&xV(e,n,t[n]);return e},iCe=(e,t)=>QSe(e,eCe(t));const DN={xs:G(16),sm:G(20),md:G(24),lg:G(30),xl:G(36)};var aCe=it((e,{labelPosition:t},{size:n})=>({root:{},body:{display:"flex","&:has(input:disabled) label":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5]}},labelWrapper:iCe(rCe({},e.fn.fontStyles()),{display:"inline-flex",flexDirection:"column",WebkitTapHighlightColor:"transparent",fontSize:n in DN?ke({size:n,sizes:e.fontSizes}):void 0,lineHeight:n in DN?ke({size:n,sizes:DN}):void 0,color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,cursor:e.cursorType,order:t==="left"?1:2}),description:{marginTop:`calc(${e.spacing.xs} / 2)`,[t==="left"?"paddingRight":"paddingLeft"]:e.spacing.sm},error:{marginTop:`calc(${e.spacing.xs} / 2)`,[t==="left"?"paddingRight":"paddingLeft"]:e.spacing.sm},label:{cursor:e.cursorType,[t==="left"?"paddingRight":"paddingLeft"]:e.spacing.sm,"&:disabled, &[data-disabled]":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5]}}}));const sCe=aCe;var oCe=Object.defineProperty,VS=Object.getOwnPropertySymbols,hX=Object.prototype.hasOwnProperty,fX=Object.prototype.propertyIsEnumerable,_V=(e,t,n)=>t in e?oCe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lCe=(e,t)=>{for(var n in t||(t={}))hX.call(t,n)&&_V(e,n,t[n]);if(VS)for(var n of VS(t))fX.call(t,n)&&_V(e,n,t[n]);return e},uCe=(e,t)=>{var n={};for(var r in e)hX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&VS)for(var r of VS(e))t.indexOf(r)<0&&fX.call(e,r)&&(n[r]=e[r]);return n};const CR=I.exports.forwardRef((e,t)=>{var n=e,{__staticSelector:r,className:i,classNames:a,styles:s,unstyled:o,children:l,label:u,description:c,id:d,disabled:p,error:h,size:m,labelPosition:g,variant:v}=n,y=uCe(n,["__staticSelector","className","classNames","styles","unstyled","children","label","description","id","disabled","error","size","labelPosition","variant"]);const{classes:b,cx:_}=sCe({labelPosition:g},{name:r,styles:s,classNames:a,unstyled:o,variant:v,size:m});return x(wt,{...lCe({className:_(b.root,i),ref:t},y),children:B("div",{className:_(b.body),children:[l,B("div",{className:b.labelWrapper,children:[u!=null&&x("label",{className:b.label,"data-disabled":p||void 0,htmlFor:d,children:u}),c&&x(As.Description,{className:b.description,children:c}),h&&h!=="boolean"&&x(As.Error,{className:b.error,children:h})]})]})})});CR.displayName="@mantine/core/InlineInput";var cCe=Object.defineProperty,jS=Object.getOwnPropertySymbols,mX=Object.prototype.hasOwnProperty,gX=Object.prototype.propertyIsEnumerable,kV=(e,t,n)=>t in e?cCe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Qx=(e,t)=>{for(var n in t||(t={}))mX.call(t,n)&&kV(e,n,t[n]);if(jS)for(var n of jS(t))gX.call(t,n)&&kV(e,n,t[n]);return e},dCe=(e,t)=>{var n={};for(var r in e)mX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&jS)for(var r of jS(e))t.indexOf(r)<0&&gX.call(e,r)&&(n[r]=e[r]);return n};const pCe={size:"sm",transitionDuration:100,icon:jSe,labelPosition:"right"},Hg=I.exports.forwardRef((e,t)=>{const n=Ke("Checkbox",pCe,e),{className:r,style:i,sx:a,checked:s,disabled:o,color:l,label:u,indeterminate:c,id:d,size:p,radius:h,wrapperProps:m,children:g,classNames:v,styles:y,transitionDuration:b,icon:_,unstyled:k,labelPosition:C,description:$,error:N,variant:A}=n,D=dCe(n,["className","style","sx","checked","disabled","color","label","indeterminate","id","size","radius","wrapperProps","children","classNames","styles","transitionDuration","icon","unstyled","labelPosition","description","error","variant"]),O=LSe(),F=zu(d),{systemStyles:E,rest:z}=Cd(D),{classes:q}=JSe({radius:h,color:l,transitionDuration:b,labelPosition:C,error:!!N,indeterminate:c},{name:"Checkbox",classNames:v,styles:y,unstyled:k,variant:A,size:(O==null?void 0:O.size)||p}),H=O?{checked:O.value.includes(z.value),onChange:O.onChange}:{};return x(CR,{...Qx(Qx({className:r,sx:a,style:i,id:F,size:(O==null?void 0:O.size)||p,labelPosition:C,label:u,description:$,error:N,disabled:o,__staticSelector:"Checkbox",classNames:v,styles:y,unstyled:k,"data-checked":H.checked||void 0,variant:A},E),m),children:B("div",{className:q.inner,children:[x("input",{...Qx(Qx({id:F,ref:t,type:"checkbox",className:q.input,checked:s,disabled:o},z),H)}),x(_,{indeterminate:c,className:q.icon})]})})});Hg.displayName="@mantine/core/Checkbox";Hg.Group=uX;var hCe=Object.defineProperty,fCe=Object.defineProperties,mCe=Object.getOwnPropertyDescriptors,SV=Object.getOwnPropertySymbols,gCe=Object.prototype.hasOwnProperty,yCe=Object.prototype.propertyIsEnumerable,CV=(e,t,n)=>t in e?hCe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,IV=(e,t)=>{for(var n in t||(t={}))gCe.call(t,n)&&CV(e,n,t[n]);if(SV)for(var n of SV(t))yCe.call(t,n)&&CV(e,n,t[n]);return e},$V=(e,t)=>fCe(e,mCe(t)),vCe=it((e,{radius:t},{size:n})=>{const r=e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3];return{root:$V(IV({},e.fn.focusStyles()),{width:G(n),height:G(n),WebkitTapHighlightColor:"transparent",border:0,borderRadius:e.fn.radius(t),appearance:"none",WebkitAppearance:"none",padding:0,position:"relative",overflow:"hidden"}),overlay:$V(IV({},e.fn.cover()),{position:"absolute",borderRadius:e.fn.radius(t)}),children:{display:"inline-flex",justifyContent:"center",alignItems:"center"},shadowOverlay:{boxShadow:`rgba(0, 0, 0, .1) 0 0 0 ${G(1)} inset, rgb(0, 0, 0, .15) 0 0 ${G(4)} inset`,zIndex:1},alphaOverlay:{backgroundImage:`linear-gradient(45deg, ${r} 25%, transparent 25%), linear-gradient(-45deg, ${r} 25%, transparent 25%), linear-gradient(45deg, transparent 75%, ${r} 75%), linear-gradient(-45deg, ${e.colorScheme==="dark"?e.colors.dark[7]:e.white} 75%, ${r} 75%)`,backgroundSize:`${G(8)} ${G(8)}`,backgroundPosition:`0 0, 0 ${G(4)}, ${G(4)} -${G(4)}, -${G(4)} 0`}}});const bCe=vCe;var wCe=Object.defineProperty,US=Object.getOwnPropertySymbols,yX=Object.prototype.hasOwnProperty,vX=Object.prototype.propertyIsEnumerable,TV=(e,t,n)=>t in e?wCe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xCe=(e,t)=>{for(var n in t||(t={}))yX.call(t,n)&&TV(e,n,t[n]);if(US)for(var n of US(t))vX.call(t,n)&&TV(e,n,t[n]);return e},_Ce=(e,t)=>{var n={};for(var r in e)yX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&US)for(var r of US(e))t.indexOf(r)<0&&vX.call(e,r)&&(n[r]=e[r]);return n};const kCe={size:G(25),radius:G(25),withShadow:!0},bX=I.exports.forwardRef((e,t)=>{const n=Ke("ColorSwatch",kCe,e),{color:r,size:i,radius:a,className:s,children:o,classNames:l,styles:u,unstyled:c,withShadow:d,variant:p}=n,h=_Ce(n,["color","size","radius","className","children","classNames","styles","unstyled","withShadow","variant"]),{classes:m,cx:g}=bCe({radius:a},{classNames:l,styles:u,unstyled:c,name:"ColorSwatch",size:i,variant:p});return B(wt,{...xCe({className:g(m.root,s),ref:t},h),children:[x("div",{className:g(m.alphaOverlay,m.overlay)}),d&&x("div",{className:g(m.shadowOverlay,m.overlay)}),x("div",{className:m.overlay,style:{backgroundColor:r}}),x("div",{className:g(m.children,m.overlay),children:o})]})});bX.displayName="@mantine/core/ColorSwatch";const Yb=bX,$l={xs:G(8),sm:G(12),md:G(16),lg:G(20),xl:G(22)};var SCe=it((e,t,{size:n})=>{const r=ke({size:n,sizes:$l});return{thumb:{overflow:"hidden",boxSizing:"border-box",position:"absolute",boxShadow:`0 0 ${G(1)} rgba(0, 0, 0, .6)`,border:`${G(2)} solid ${e.white}`,backgroundColor:"transparent",width:r,height:r,borderRadius:r}}});const CCe=SCe;var ICe=Object.defineProperty,NV=Object.getOwnPropertySymbols,$Ce=Object.prototype.hasOwnProperty,TCe=Object.prototype.propertyIsEnumerable,EV=(e,t,n)=>t in e?ICe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,NCe=(e,t)=>{for(var n in t||(t={}))$Ce.call(t,n)&&EV(e,n,t[n]);if(NV)for(var n of NV(t))TCe.call(t,n)&&EV(e,n,t[n]);return e};function IR({position:e,className:t,styles:n,classNames:r,style:i,size:a,__staticSelector:s,unstyled:o,variant:l}){const{classes:u,cx:c}=CCe(null,{classNames:r,styles:n,name:s,unstyled:o,size:a,variant:l});return x("div",{className:c(u.thumb,t),style:NCe({left:`calc(${e.x*100}% - ${$l[a]} / 2)`,top:`calc(${e.y*100}% - ${$l[a]} / 2)`},i)})}IR.displayName="@mantine/core/Thumb";var ECe=Object.defineProperty,OV=Object.getOwnPropertySymbols,OCe=Object.prototype.hasOwnProperty,PCe=Object.prototype.propertyIsEnumerable,PV=(e,t,n)=>t in e?ECe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,AV=(e,t)=>{for(var n in t||(t={}))OCe.call(t,n)&&PV(e,n,t[n]);if(OV)for(var n of OV(t))PCe.call(t,n)&&PV(e,n,t[n]);return e},ACe=it((e,t,{size:n})=>({sliderThumb:{ref:zo("sliderThumb")},slider:{position:"relative",height:`calc(${ke({size:n,sizes:$l})} + ${G(2)})`,boxSizing:"border-box",marginLeft:`calc(${ke({size:n,sizes:$l})} / 2)`,marginRight:`calc(${ke({size:n,sizes:$l})} / 2)`,outline:0,[`&:focus .${zo("sliderThumb")}`]:AV({},e.focusRing==="always"||e.focusRing==="auto"?e.focusRingStyles.styles(e):e.focusRingStyles.resetStyles(e)),[`&:focus:not(:focus-visible) .${zo("sliderThumb")}`]:AV({},e.focusRing==="auto"||e.focusRing==="never"?e.focusRingStyles.resetStyles(e):null)},sliderOverlay:{position:"absolute",boxSizing:"border-box",top:0,bottom:0,left:`calc(${ke({size:n,sizes:$l})} * -1 / 2 - ${G(1)})`,right:`calc(${ke({size:n,sizes:$l})} * -1 / 2 - ${G(1)})`,borderRadius:1e3}}));const MCe=ACe;var RCe=Object.defineProperty,DCe=Object.defineProperties,LCe=Object.getOwnPropertyDescriptors,HS=Object.getOwnPropertySymbols,wX=Object.prototype.hasOwnProperty,xX=Object.prototype.propertyIsEnumerable,MV=(e,t,n)=>t in e?RCe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,FCe=(e,t)=>{for(var n in t||(t={}))wX.call(t,n)&&MV(e,n,t[n]);if(HS)for(var n of HS(t))xX.call(t,n)&&MV(e,n,t[n]);return e},zCe=(e,t)=>DCe(e,LCe(t)),BCe=(e,t)=>{var n={};for(var r in e)wX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&HS)for(var r of HS(e))t.indexOf(r)<0&&xX.call(e,r)&&(n[r]=e[r]);return n};const $R=I.exports.forwardRef((e,t)=>{var n=e,{value:r,onChange:i,onChangeEnd:a,maxValue:s,round:o,size:l="md",thumbColor:u="transparent",__staticSelector:c="ColorSlider",focusable:d=!0,overlays:p,classNames:h,styles:m,className:g,unstyled:v,variant:y}=n,b=BCe(n,["value","onChange","onChangeEnd","maxValue","round","size","thumbColor","__staticSelector","focusable","overlays","classNames","styles","className","unstyled","variant"]);const{classes:_,cx:k}=MCe(null,{classNames:h,styles:m,name:c,unstyled:v,variant:y,size:l}),[C,$]=I.exports.useState({y:0,x:r/s}),N=I.exports.useRef(C),A=z=>o?Math.round(z*s):z*s,{ref:D}=tR(({x:z,y:q})=>{N.current={x:z,y:q},i(A(z))},{onScrubEnd:()=>{const{x:z}=N.current;a(A(z))}});Xi(()=>{$({y:0,x:r/s})},[r]);const O=(z,q)=>{z.preventDefault();const H=Aq(q);i(A(H.x)),a(A(H.x))},F=z=>{switch(z.key){case"ArrowRight":{O(z,{x:C.x+.05,y:C.y});break}case"ArrowLeft":{O(z,{x:C.x-.05,y:C.y});break}}},E=p.map((z,q)=>x("div",{className:_.sliderOverlay,style:z},q));return B(wt,{...zCe(FCe({},b),{ref:Bu(D,t),className:k(_.slider,g),role:"slider","aria-valuenow":r,"aria-valuemax":s,"aria-valuemin":0,tabIndex:d?0:-1,onKeyDown:F}),children:[E,x(IR,{__staticSelector:c,classNames:h,styles:m,position:C,style:{top:G(1),backgroundColor:u},className:_.sliderThumb,size:l})]})});$R.displayName="@mantine/core/ColorSlider";var WCe=Object.defineProperty,VCe=Object.defineProperties,jCe=Object.getOwnPropertyDescriptors,GS=Object.getOwnPropertySymbols,_X=Object.prototype.hasOwnProperty,kX=Object.prototype.propertyIsEnumerable,RV=(e,t,n)=>t in e?WCe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,UCe=(e,t)=>{for(var n in t||(t={}))_X.call(t,n)&&RV(e,n,t[n]);if(GS)for(var n of GS(t))kX.call(t,n)&&RV(e,n,t[n]);return e},HCe=(e,t)=>VCe(e,jCe(t)),GCe=(e,t)=>{var n={};for(var r in e)_X.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&GS)for(var r of GS(e))t.indexOf(r)<0&&kX.call(e,r)&&(n[r]=e[r]);return n};const qCe={},SX=I.exports.forwardRef((e,t)=>{const n=Ke("HueSlider",qCe,e),{value:r,onChange:i,onChangeEnd:a,__staticSelector:s}=n,o=GCe(n,["value","onChange","onChangeEnd","__staticSelector"]);return x($R,{...HCe(UCe({},o),{ref:t,value:r,onChange:i,onChangeEnd:a,maxValue:360,thumbColor:`hsl(${r}, 100%, 50%)`,round:!0,__staticSelector:s||"HueSlider",overlays:[{backgroundImage:"linear-gradient(to right,hsl(0,100%,50%),hsl(60,100%,50%),hsl(120,100%,50%),hsl(170,100%,50%),hsl(240,100%,50%),hsl(300,100%,50%),hsl(360,100%,50%))"},{boxShadow:`rgba(0, 0, 0, .1) 0 0 0 ${G(1)} inset, rgb(0, 0, 0, .15) 0 0 ${G(4)} inset`}]})})});SX.displayName="@mantine/core/HueSlider";var KCe=Object.defineProperty,ZCe=Object.defineProperties,XCe=Object.getOwnPropertyDescriptors,DV=Object.getOwnPropertySymbols,JCe=Object.prototype.hasOwnProperty,YCe=Object.prototype.propertyIsEnumerable,LV=(e,t,n)=>t in e?KCe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,FV=(e,t)=>{for(var n in t||(t={}))JCe.call(t,n)&&LV(e,n,t[n]);if(DV)for(var n of DV(t))YCe.call(t,n)&&LV(e,n,t[n]);return e},zV=(e,t)=>ZCe(e,XCe(t));function io(e,t=0,n=10**t){return Math.round(n*e)/n}function QCe({h:e,s:t,l:n,a:r}){const i=t*((n<50?n:100-n)/100);return{h:e,s:i>0?2*i/(n+i)*100:0,v:n+i,a:r}}const eIe={grad:360/400,turn:360,rad:360/(Math.PI*2)};function tIe(e,t="deg"){return Number(e)*(eIe[t]||1)}const nIe=/hsla?\(?\s*(-?\d*\.?\d+)(deg|rad|grad|turn)?[,\s]+(-?\d*\.?\d+)%?[,\s]+(-?\d*\.?\d+)%?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i;function BV(e){const t=nIe.exec(e);return t?QCe({h:tIe(t[1],t[2]),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)}):{h:0,s:0,v:0,a:1}}function tP({r:e,g:t,b:n,a:r}){const i=Math.max(e,t,n),a=i-Math.min(e,t,n),s=a?i===e?(t-n)/a:i===t?2+(n-e)/a:4+(e-t)/a:0;return{h:io(60*(s<0?s+6:s),3),s:io(i?a/i*100:0,3),v:io(i/255*100,3),a:r}}function nP(e){const t=e[0]==="#"?e.slice(1):e;return t.length===3?tP({r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:1}):tP({r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16),a:1})}function rIe(e){const t=e[0]==="#"?e.slice(1):e,n=s=>io(parseInt(s,16)/255,3);if(t.length===4){const s=t.slice(0,3),o=n(t[3]+t[3]);return zV(FV({},nP(s)),{a:o})}const r=t.slice(0,6),i=n(t.slice(6,8));return zV(FV({},nP(r)),{a:i})}const iIe=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i;function WV(e){const t=iIe.exec(e);return t?tP({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):{h:0,s:0,v:0,a:1}}const CX={hex:/^#?([0-9A-F]{3}){1,2}$/i,hexa:/^#?([0-9A-F]{4}){1,2}$/i,rgb:/^rgb\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/i,rgba:/^rgba\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/i,hsl:/hsl\(\s*(\d+)\s*,\s*(\d+(?:\.\d+)?%)\s*,\s*(\d+(?:\.\d+)?%)\)/i,hsla:/^hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*(\d*(?:\.\d+)?)\)$/i},aIe={hex:nP,hexa:rIe,rgb:WV,rgba:WV,hsl:BV,hsla:BV};function sIe(e){for(const[,t]of Object.entries(CX))if(t.test(e))return!0;return!1}function e_(e){if(typeof e!="string")return{h:0,s:0,v:0,a:1};if(e==="transparent")return{h:0,s:0,v:0,a:0};const t=e.trim();for(const[n,r]of Object.entries(CX))if(r.test(t))return aIe[n](t);return{h:0,s:0,v:0,a:1}}var oIe=Object.defineProperty,lIe=Object.defineProperties,uIe=Object.getOwnPropertyDescriptors,qS=Object.getOwnPropertySymbols,IX=Object.prototype.hasOwnProperty,$X=Object.prototype.propertyIsEnumerable,VV=(e,t,n)=>t in e?oIe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,cIe=(e,t)=>{for(var n in t||(t={}))IX.call(t,n)&&VV(e,n,t[n]);if(qS)for(var n of qS(t))$X.call(t,n)&&VV(e,n,t[n]);return e},dIe=(e,t)=>lIe(e,uIe(t)),pIe=(e,t)=>{var n={};for(var r in e)IX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&qS)for(var r of qS(e))t.indexOf(r)<0&&$X.call(e,r)&&(n[r]=e[r]);return n};const hIe={},TX=I.exports.forwardRef((e,t)=>{const n=Ke("AlphaSlider",hIe,e),{value:r,onChange:i,onChangeEnd:a,color:s,__staticSelector:o}=n,l=pIe(n,["value","onChange","onChangeEnd","color","__staticSelector"]),u=Ka(),c=u.colorScheme==="dark"?u.colors.dark[4]:u.colors.gray[3];return x($R,{...dIe(cIe({},l),{ref:t,value:r,onChange:d=>i(io(d,2)),onChangeEnd:d=>a(io(d,2)),maxValue:1,round:!1,__staticSelector:o||"AlphaSlider",overlays:[{backgroundImage:`linear-gradient(45deg, ${c} 25%, transparent 25%), linear-gradient(-45deg, ${c} 25%, transparent 25%), linear-gradient(45deg, transparent 75%, ${c} 75%), linear-gradient(-45deg, ${u.colorScheme==="dark"?u.colors.dark[7]:u.white} 75%, ${c} 75%)`,backgroundSize:`${G(8)} ${G(8)}`,backgroundPosition:`0 0, 0 ${G(4)}, ${G(4)} -${G(4)}, -${G(4)} 0`},{backgroundImage:`linear-gradient(90deg, transparent, ${s})`},{boxShadow:`rgba(0, 0, 0, .1) 0 0 0 ${G(1)} inset, rgb(0, 0, 0, .15) 0 0 ${G(4)} inset`}]})})});TX.displayName="@mantine/core/AlphaSlider";var fIe=Object.defineProperty,jV=Object.getOwnPropertySymbols,mIe=Object.prototype.hasOwnProperty,gIe=Object.prototype.propertyIsEnumerable,UV=(e,t,n)=>t in e?fIe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,LN=(e,t)=>{for(var n in t||(t={}))mIe.call(t,n)&&UV(e,n,t[n]);if(jV)for(var n of jV(t))gIe.call(t,n)&&UV(e,n,t[n]);return e};const yIe={xs:G(100),sm:G(110),md:G(120),lg:G(140),xl:G(160)};var vIe=it((e,t,{size:n})=>({saturationThumb:{ref:zo("saturationThumb")},saturation:{boxSizing:"border-box",position:"relative",height:ke({size:n,sizes:yIe}),borderRadius:e.radius.sm,margin:`calc(${ke({size:n,sizes:$l})} / 2)`,WebkitTapHighlightColor:"transparent",[`&:focus .${zo("saturationThumb")}`]:LN({},e.focusRing==="always"||e.focusRing==="auto"?e.focusRingStyles.styles(e):e.focusRingStyles.resetStyles(e)),[`&:focus:not(:focus-visible) .${zo("saturationThumb")}`]:LN({},e.focusRing==="auto"||e.focusRing==="never"?e.focusRingStyles.resetStyles(e):null)},saturationOverlay:LN({boxSizing:"border-box",borderRadius:e.radius.sm},e.fn.cover(`calc(${ke({size:n,sizes:$l})} * -1 / 2 - ${G(1)})`))}));const bIe=vIe;function NX({h:e,s:t,v:n,a:r}){const i=e/360*6,a=t/100,s=n/100,o=Math.floor(i),l=s*(1-a),u=s*(1-(i-o)*a),c=s*(1-(1-i+o)*a),d=o%6;return{r:io([s,u,l,l,c,s][d]*255),g:io([c,s,s,u,l,l][d]*255),b:io([l,l,c,s,s,u][d]*255),a:io(r,2)}}function HV(e,t){const{r:n,g:r,b:i,a}=NX(e);return t?`rgba(${n}, ${r}, ${i}, ${io(a,2)})`:`rgb(${n}, ${r}, ${i})`}function GV({h:e,s:t,v:n,a:r},i){const a=(200-t)*n/100,s={h:Math.round(e),s:Math.round(a>0&&a<200?t*n/100/(a<=100?a:200-a)*100:0),l:Math.round(a/2)};return i?`hsla(${s.h}, ${s.s}%, ${s.l}%, ${io(r,2)})`:`hsl(${s.h}, ${s.s}%, ${s.l}%)`}function tk(e){const t=e.toString(16);return t.length<2?`0${t}`:t}function EX(e){const{r:t,g:n,b:r}=NX(e);return`#${tk(t)}${tk(n)}${tk(r)}`}function wIe(e){const t=Math.round(e.a*255);return`${EX(e)}${tk(t)}`}const FN={hex:EX,hexa:e=>wIe(e),rgb:e=>HV(e,!1),rgba:e=>HV(e,!0),hsl:e=>GV(e,!1),hsla:e=>GV(e,!0)};function dc(e,t){return t?e in FN?FN[e](t):FN.hex(t):"#000000"}function OX({value:e,onChange:t,onChangeEnd:n,focusable:r=!0,__staticSelector:i="saturation",size:a,color:s,saturationLabel:o,classNames:l,styles:u,unstyled:c,variant:d}){const{classes:p}=bIe(null,{classNames:l,styles:u,name:i,unstyled:c,variant:d,size:a}),[h,m]=I.exports.useState({x:e.s/100,y:1-e.v/100}),g=I.exports.useRef(h),{ref:v}=tR(({x:_,y:k})=>{g.current={x:_,y:k},t({s:Math.round(_*100),v:Math.round((1-k)*100)})},{onScrubEnd:()=>{const{x:_,y:k}=g.current;n({s:Math.round(_*100),v:Math.round((1-k)*100)})}});I.exports.useEffect(()=>{m({x:e.s/100,y:1-e.v/100})},[e.s,e.v]);const y=(_,k)=>{_.preventDefault();const C=Aq(k);t({s:Math.round(C.x*100),v:Math.round((1-C.y)*100)}),n({s:Math.round(C.x*100),v:Math.round((1-C.y)*100)})},b=_=>{switch(_.key){case"ArrowUp":{y(_,{y:h.y-.05,x:h.x});break}case"ArrowDown":{y(_,{y:h.y+.05,x:h.x});break}case"ArrowRight":{y(_,{x:h.x+.05,y:h.y});break}case"ArrowLeft":{y(_,{x:h.x-.05,y:h.y});break}}};return B("div",{className:p.saturation,ref:v,role:"slider","aria-label":o,"aria-valuenow":h.x,"aria-valuetext":dc("rgba",e),tabIndex:r?0:-1,onKeyDown:b,children:[x("div",{className:p.saturationOverlay,style:{backgroundColor:`hsl(${e.h}, 100%, 50%)`}}),x("div",{className:p.saturationOverlay,style:{backgroundImage:"linear-gradient(90deg, #fff, transparent)"}}),x("div",{className:p.saturationOverlay,style:{backgroundImage:"linear-gradient(0deg, #000, transparent)"}}),x(IR,{__staticSelector:i,classNames:l,styles:u,position:h,className:p.saturationThumb,style:{backgroundColor:s},size:a})]})}OX.displayName="@mantine/core/Saturation";var xIe=it((e,{swatchesPerRow:t})=>({swatch:{width:`calc(${100/t}% - ${G(4)})`,height:0,paddingBottom:`calc(${100/t}% - ${G(4)})`,margin:G(2),boxSizing:"content-box"},swatches:{boxSizing:"border-box",marginLeft:G(-2),marginRight:G(-2),display:"flex",flexWrap:"wrap"}}));const _Ie=xIe;var kIe=Object.defineProperty,KS=Object.getOwnPropertySymbols,PX=Object.prototype.hasOwnProperty,AX=Object.prototype.propertyIsEnumerable,qV=(e,t,n)=>t in e?kIe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,SIe=(e,t)=>{for(var n in t||(t={}))PX.call(t,n)&&qV(e,n,t[n]);if(KS)for(var n of KS(t))AX.call(t,n)&&qV(e,n,t[n]);return e},CIe=(e,t)=>{var n={};for(var r in e)PX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&KS)for(var r of KS(e))t.indexOf(r)<0&&AX.call(e,r)&&(n[r]=e[r]);return n};function MX(e){var t=e,{data:n,swatchesPerRow:r=10,focusable:i=!0,classNames:a,styles:s,__staticSelector:o="color-picker",unstyled:l,setValue:u,onChangeEnd:c,variant:d,size:p}=t,h=CIe(t,["data","swatchesPerRow","focusable","classNames","styles","__staticSelector","unstyled","setValue","onChangeEnd","variant","size"]);const{classes:m}=_Ie({swatchesPerRow:r},{classNames:a,styles:s,name:o,unstyled:l,variant:d,size:p}),g=n.map((v,y)=>x(Yb,{className:m.swatch,component:"button",type:"button",color:v,radius:"sm",onClick:()=>{u(v),c==null||c(v)},style:{cursor:"pointer"},"aria-label":v,tabIndex:i?0:-1},y));return x("div",{...SIe({className:m.swatches},h),children:g})}MX.displayName="@mantine/core/Swatches";const IIe={xs:G(180),sm:G(200),md:G(240),lg:G(280),xl:G(320)};var $Ie=it((e,{fullWidth:t},{size:n})=>({preview:{},wrapper:{boxSizing:"border-box",width:t?"100%":ke({size:n,sizes:IIe}),padding:G(1)},body:{display:"flex",boxSizing:"border-box",paddingTop:`calc(${ke({size:n,sizes:e.spacing})} / 2)`},sliders:{flex:1,boxSizing:"border-box","&:not(:only-child)":{marginRight:e.spacing.xs}},slider:{boxSizing:"border-box","& + &":{marginTop:G(5)}},swatch:{cursor:"pointer"}}));const TIe=$Ie;var NIe=Object.defineProperty,EIe=Object.defineProperties,OIe=Object.getOwnPropertyDescriptors,ZS=Object.getOwnPropertySymbols,RX=Object.prototype.hasOwnProperty,DX=Object.prototype.propertyIsEnumerable,KV=(e,t,n)=>t in e?NIe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pm=(e,t)=>{for(var n in t||(t={}))RX.call(t,n)&&KV(e,n,t[n]);if(ZS)for(var n of ZS(t))DX.call(t,n)&&KV(e,n,t[n]);return e},zN=(e,t)=>EIe(e,OIe(t)),PIe=(e,t)=>{var n={};for(var r in e)RX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&ZS)for(var r of ZS(e))t.indexOf(r)<0&&DX.call(e,r)&&(n[r]=e[r]);return n};const AIe={xs:26,sm:34,md:42,lg:50,xl:54},MIe={swatchesPerRow:10,size:"sm",withPicker:!0,focusable:!0,__staticSelector:"ColorPicker"},TR=I.exports.forwardRef((e,t)=>{const n=Ke("ColorPicker",MIe,e),{value:r,defaultValue:i,onChange:a,onChangeEnd:s,format:o,swatches:l,swatchesPerRow:u,size:c,withPicker:d,fullWidth:p,focusable:h,__staticSelector:m,saturationLabel:g,hueLabel:v,alphaLabel:y,className:b,styles:_,classNames:k,unstyled:C,onColorSwatchClick:$,variant:N}=n,A=PIe(n,["value","defaultValue","onChange","onChangeEnd","format","swatches","swatchesPerRow","size","withPicker","fullWidth","focusable","__staticSelector","saturationLabel","hueLabel","alphaLabel","className","styles","classNames","unstyled","onColorSwatchClick","variant"]),{classes:D,cx:O}=TIe({fullWidth:p},{classNames:k,styles:_,name:m,unstyled:C,variant:N,size:c}),F=I.exports.useRef(o),E=I.exports.useRef(null),z=I.exports.useRef(!0),q=o==="hexa"||o==="rgba"||o==="hsla",[H,J,ee]=qo({value:r,defaultValue:i,finalValue:"#FFFFFF",onChange:a}),[V,Q]=I.exports.useState(e_(H)),X=Y=>{z.current=!1,Q(ce=>{const pe=Pm(Pm({},ce),Y);return E.current=dc(F.current,pe),pe}),J(E.current),setTimeout(()=>{z.current=!0},0)};return Xi(()=>{sIe(r)&&z.current&&(Q(e_(r)),z.current=!0)},[r]),Xi(()=>{F.current=o,J(dc(o,V))},[o]),B(wt,{...Pm({className:O(D.wrapper,b),ref:t},A),children:[d&&B(ze,{children:[x(OX,{value:V,onChange:X,onChangeEnd:({s:Y,v:ce})=>s==null?void 0:s(dc(F.current,zN(Pm({},V),{s:Y,v:ce}))),color:H,styles:_,classNames:k,size:c,focusable:h,saturationLabel:g,__staticSelector:m}),B("div",{className:D.body,children:[B("div",{className:D.sliders,children:[x(SX,{value:V.h,onChange:Y=>X({h:Y}),onChangeEnd:Y=>s==null?void 0:s(dc(F.current,zN(Pm({},V),{h:Y}))),size:c,styles:_,classNames:k,focusable:h,"aria-label":v,__staticSelector:m}),q&&x(TX,{value:V.a,onChange:Y=>X({a:Y}),onChangeEnd:Y=>{s==null||s(dc(F.current,zN(Pm({},V),{a:Y})))},size:c,color:dc("hex",V),style:{marginTop:G(6)},styles:_,classNames:k,focusable:h,"aria-label":y,__staticSelector:m})]}),q&&x(Yb,{color:H,radius:"sm",size:ke({size:c,sizes:AIe}),className:D.preview})]})]}),Array.isArray(l)&&x(MX,{data:l,style:{marginTop:G(5)},swatchesPerRow:u,focusable:h,classNames:k,styles:_,__staticSelector:m,setValue:J,onChangeEnd:Y=>{const ce=dc(o,e_(Y));$==null||$(ce),s==null||s(ce),ee||Q(e_(Y))}})]})});TR.displayName="@mantine/core/ColorPicker";const[RIe,Ny]=Iy("ModalBase component was not found in tree");var DIe=it(()=>({close:{marginLeft:"auto",marginRight:0}}));const LIe=DIe;var FIe=Object.defineProperty,XS=Object.getOwnPropertySymbols,LX=Object.prototype.hasOwnProperty,FX=Object.prototype.propertyIsEnumerable,ZV=(e,t,n)=>t in e?FIe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zIe=(e,t)=>{for(var n in t||(t={}))LX.call(t,n)&&ZV(e,n,t[n]);if(XS)for(var n of XS(t))FX.call(t,n)&&ZV(e,n,t[n]);return e},BIe=(e,t)=>{var n={};for(var r in e)LX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&XS)for(var r of XS(e))t.indexOf(r)<0&&FX.call(e,r)&&(n[r]=e[r]);return n};const WIe={size:"sm"},VIe=I.exports.forwardRef((e,t)=>{const n=Ny(),r=Ke(`${n.__staticSelector}CloseButton`,WIe,e),{className:i}=r,a=BIe(r,["className"]),{classes:s,cx:o}=LIe(null,n.stylesApi);return x(rR,{...zIe({className:o(s.close,i),ref:t,onClick:n.onClose},a)})});var jIe=it(()=>({overlay:{}}));const UIe=jIe;var HIe=Object.defineProperty,GIe=Object.defineProperties,qIe=Object.getOwnPropertyDescriptors,XV=Object.getOwnPropertySymbols,KIe=Object.prototype.hasOwnProperty,ZIe=Object.prototype.propertyIsEnumerable,JV=(e,t,n)=>t in e?HIe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,XIe=(e,t)=>{for(var n in t||(t={}))KIe.call(t,n)&&JV(e,n,t[n]);if(XV)for(var n of XV(t))ZIe.call(t,n)&&JV(e,n,t[n]);return e},JIe=(e,t)=>GIe(e,qIe(t)),YIe=it((e,{color:t,opacity:n,blur:r,radius:i,gradient:a,fixed:s,zIndex:o})=>({root:JIe(XIe({},e.fn.cover(0)),{position:s?"fixed":"absolute",backgroundColor:a?void 0:e.fn.rgba(t,n),backgroundImage:a,backdropFilter:r?`blur(${G(r)})`:void 0,borderRadius:e.fn.radius(i),zIndex:o,"&[data-center]":{display:"flex",alignItems:"center",justifyContent:"center"}})}));const QIe=YIe;var e2e=Object.defineProperty,JS=Object.getOwnPropertySymbols,zX=Object.prototype.hasOwnProperty,BX=Object.prototype.propertyIsEnumerable,YV=(e,t,n)=>t in e?e2e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,t2e=(e,t)=>{for(var n in t||(t={}))zX.call(t,n)&&YV(e,n,t[n]);if(JS)for(var n of JS(t))BX.call(t,n)&&YV(e,n,t[n]);return e},n2e=(e,t)=>{var n={};for(var r in e)zX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&JS)for(var r of JS(e))t.indexOf(r)<0&&BX.call(e,r)&&(n[r]=e[r]);return n};const r2e={opacity:.6,color:"#000",zIndex:Sd("modal"),radius:0},WX=I.exports.forwardRef((e,t)=>{const n=Ke("Overlay",r2e,e),{variant:r,opacity:i,color:a,blur:s,gradient:o,zIndex:l,radius:u,children:c,className:d,classNames:p,styles:h,unstyled:m,center:g,fixed:v}=n,y=n2e(n,["variant","opacity","color","blur","gradient","zIndex","radius","children","className","classNames","styles","unstyled","center","fixed"]),{classes:b,cx:_}=QIe({color:a,opacity:i,blur:s,radius:u,gradient:o,fixed:v,zIndex:l},{name:"Overlay",classNames:p,styles:h,unstyled:m,variant:r});return x(wt,{...t2e({ref:t,className:_(b.root,d),"data-center":g||void 0},y),children:c})});WX.displayName="@mantine/core/Overlay";const i2e=WX;var a2e=Object.defineProperty,s2e=Object.defineProperties,o2e=Object.getOwnPropertyDescriptors,YS=Object.getOwnPropertySymbols,VX=Object.prototype.hasOwnProperty,jX=Object.prototype.propertyIsEnumerable,QV=(e,t,n)=>t in e?a2e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,R0=(e,t)=>{for(var n in t||(t={}))VX.call(t,n)&&QV(e,n,t[n]);if(YS)for(var n of YS(t))jX.call(t,n)&&QV(e,n,t[n]);return e},l2e=(e,t)=>s2e(e,o2e(t)),u2e=(e,t)=>{var n={};for(var r in e)VX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&YS)for(var r of YS(e))t.indexOf(r)<0&&jX.call(e,r)&&(n[r]=e[r]);return n};const c2e={},d2e=I.exports.forwardRef((e,t)=>{const n=Ny(),r=Ke(`${n.__staticSelector}Overlay`,c2e,e),{onClick:i,transitionProps:a,style:s,className:o}=r,l=u2e(r,["onClick","transitionProps","style","className"]),{classes:u,cx:c}=UIe(null,n.stylesApi),d=p=>{i==null||i(p),n.closeOnClickOutside&&n.onClose()};return x(_u,{...l2e(R0(R0({mounted:n.opened},n.transitionProps),a),{transition:"fade"}),children:p=>x(i2e,{...R0({ref:t,onClick:d,fixed:!0,style:R0(R0({},s),p),className:c(u.overlay,o),zIndex:n.zIndex},l)})})});var p2e=it((e,{zIndex:t})=>({inner:{position:"fixed",width:"100%",top:0,bottom:0,maxHeight:"100%",zIndex:t,pointerEvents:"none"},content:{pointerEvents:"all"}}));const h2e=p2e;var f2e=Object.defineProperty,QS=Object.getOwnPropertySymbols,UX=Object.prototype.hasOwnProperty,HX=Object.prototype.propertyIsEnumerable,e6=(e,t,n)=>t in e?f2e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,D0=(e,t)=>{for(var n in t||(t={}))UX.call(t,n)&&e6(e,n,t[n]);if(QS)for(var n of QS(t))HX.call(t,n)&&e6(e,n,t[n]);return e},m2e=(e,t)=>{var n={};for(var r in e)UX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&QS)for(var r of QS(e))t.indexOf(r)<0&&HX.call(e,r)&&(n[r]=e[r]);return n};const g2e={},y2e=I.exports.forwardRef((e,t)=>{const n=Ny(),r=Ke(`${n.__staticSelector}Content`,g2e,e),{className:i,transitionProps:a,style:s,onKeyDown:o}=r,l=m2e(r,["className","transitionProps","style","onKeyDown"]),{classes:u,cx:c}=h2e({zIndex:n.zIndex},n.stylesApi),d=p=>{var h;((h=p.target)==null?void 0:h.getAttribute("data-mantine-stop-propagation"))!=="true"&&p.key==="Escape"&&n.closeOnEscape&&n.onClose(),o==null||o(p)};return x(_u,{...D0(D0({mounted:n.opened,transition:"pop"},n.transitionProps),a),children:p=>x("div",{className:c(u.inner),children:x(yR,{active:n.opened&&n.trapFocus,children:x(Bt,{...D0({component:"section",role:"dialog",tabIndex:-1,"aria-modal":!0,"aria-describedby":n.bodyMounted?n.getBodyId():void 0,"aria-labelledby":n.titleMounted?n.getTitleId():void 0,onKeyDown:d,ref:t,className:c(u.content,i),style:D0(D0({},s),p),shadow:n.shadow},l),children:l.children})})})})});var v2e=it((e,{padding:t})=>{const n=ke({size:t,sizes:e.spacing});return{header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:n,paddingRight:`calc(${n} - ${G(5)})`,position:"sticky",top:0,backgroundColor:e.colorScheme==="dark"?e.colors.dark[7]:e.white,zIndex:1e3}}});const b2e=v2e;var w2e=Object.defineProperty,eC=Object.getOwnPropertySymbols,GX=Object.prototype.hasOwnProperty,qX=Object.prototype.propertyIsEnumerable,t6=(e,t,n)=>t in e?w2e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,x2e=(e,t)=>{for(var n in t||(t={}))GX.call(t,n)&&t6(e,n,t[n]);if(eC)for(var n of eC(t))qX.call(t,n)&&t6(e,n,t[n]);return e},_2e=(e,t)=>{var n={};for(var r in e)GX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&eC)for(var r of eC(e))t.indexOf(r)<0&&qX.call(e,r)&&(n[r]=e[r]);return n};const k2e={},S2e=I.exports.forwardRef((e,t)=>{const n=Ny(),r=Ke(`${n.__staticSelector}Header`,k2e,e),{className:i}=r,a=_2e(r,["className"]),{classes:s,cx:o}=b2e({padding:n.padding},n.stylesApi);return x(wt,{...x2e({ref:t,className:o(s.header,i)},a)})});var C2e=it(e=>({title:{lineHeight:1,padding:0,margin:0,fontWeight:400,fontSize:e.fontSizes.md}}));const I2e=C2e;var $2e=Object.defineProperty,tC=Object.getOwnPropertySymbols,KX=Object.prototype.hasOwnProperty,ZX=Object.prototype.propertyIsEnumerable,n6=(e,t,n)=>t in e?$2e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,T2e=(e,t)=>{for(var n in t||(t={}))KX.call(t,n)&&n6(e,n,t[n]);if(tC)for(var n of tC(t))ZX.call(t,n)&&n6(e,n,t[n]);return e},N2e=(e,t)=>{var n={};for(var r in e)KX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&tC)for(var r of tC(e))t.indexOf(r)<0&&ZX.call(e,r)&&(n[r]=e[r]);return n};const E2e={},O2e=I.exports.forwardRef((e,t)=>{const n=Ny(),r=Ke(`${n.__staticSelector}Title`,E2e,e),{className:i}=r,a=N2e(r,["className"]),{classes:s,cx:o}=I2e(null,n.stylesApi);return I.exports.useEffect(()=>(n.setTitleMounted(!0),()=>n.setTitleMounted(!1)),[]),x(wt,{...T2e({component:"h2",id:n.getTitleId(),className:o(s.title,i),ref:t},a)})});var P2e=it((e,{padding:t})=>({body:{padding:ke({size:t,sizes:e.spacing}),"&:not(:only-child)":{paddingTop:0}}}));const A2e=P2e;var M2e=Object.defineProperty,nC=Object.getOwnPropertySymbols,XX=Object.prototype.hasOwnProperty,JX=Object.prototype.propertyIsEnumerable,r6=(e,t,n)=>t in e?M2e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,R2e=(e,t)=>{for(var n in t||(t={}))XX.call(t,n)&&r6(e,n,t[n]);if(nC)for(var n of nC(t))JX.call(t,n)&&r6(e,n,t[n]);return e},D2e=(e,t)=>{var n={};for(var r in e)XX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&nC)for(var r of nC(e))t.indexOf(r)<0&&JX.call(e,r)&&(n[r]=e[r]);return n};const L2e={},F2e=I.exports.forwardRef((e,t)=>{const n=Ny(),r=Ke(`${n.__staticSelector}Body`,L2e,e),{className:i}=r,a=D2e(r,["className"]),{classes:s,cx:o}=A2e({padding:n.padding},n.stylesApi);return I.exports.useEffect(()=>(n.setBodyMounted(!0),()=>n.setBodyMounted(!1)),[]),x(wt,{...R2e({id:n.getBodyId(),className:o(s.body,i),ref:t},a)})});function z2e({children:e}){return x(ze,{children:e})}function B2e({opened:e,transitionDuration:t}){const[n,r]=I.exports.useState(e),i=I.exports.useRef(),s=$2()?0:t;return I.exports.useEffect(()=>(e?(r(!0),window.clearTimeout(i.current)):s===0?r(!1):i.current=window.setTimeout(()=>r(!1),s),()=>window.clearTimeout(i.current)),[e,s]),n}var W2e=it(()=>({root:{}}));const V2e=W2e;var j2e=Object.defineProperty,U2e=Object.defineProperties,H2e=Object.getOwnPropertyDescriptors,rC=Object.getOwnPropertySymbols,YX=Object.prototype.hasOwnProperty,QX=Object.prototype.propertyIsEnumerable,i6=(e,t,n)=>t in e?j2e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,BN=(e,t)=>{for(var n in t||(t={}))YX.call(t,n)&&i6(e,n,t[n]);if(rC)for(var n of rC(t))QX.call(t,n)&&i6(e,n,t[n]);return e},a6=(e,t)=>U2e(e,H2e(t)),G2e=(e,t)=>{var n={};for(var r in e)YX.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&rC)for(var r of rC(e))t.indexOf(r)<0&&QX.call(e,r)&&(n[r]=e[r]);return n};const NR={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:Sd("modal"),padding:"md",size:"md",shadow:"xl"};function Fr(e){const t=Ke("ModalBase",NR,e),{opened:n,onClose:r,children:i,closeOnClickOutside:a,__staticSelector:s,transitionProps:o,withinPortal:l,portalProps:u,keepMounted:c,target:d,zIndex:p,lockScroll:h,trapFocus:m,closeOnEscape:g,returnFocus:v,padding:y,shadow:b,id:_,size:k,variant:C,classNames:$,unstyled:N,styles:A,className:D}=t,O=G2e(t,["opened","onClose","children","closeOnClickOutside","__staticSelector","transitionProps","withinPortal","portalProps","keepMounted","target","zIndex","lockScroll","trapFocus","closeOnEscape","returnFocus","padding","shadow","id","size","variant","classNames","unstyled","styles","className"]),{classes:F,cx:E}=V2e(null,{name:s,classNames:$,styles:A,unstyled:N,variant:C,size:k}),z=zu(_),[q,H]=I.exports.useState(!1),[J,ee]=I.exports.useState(!1),V=typeof(o==null?void 0:o.duration)=="number"?o==null?void 0:o.duration:200,Q=B2e({opened:n,transitionDuration:V});return Xk("keydown",X=>{!m&&X.key==="Escape"&&g&&r()}),$q({opened:n,shouldReturnFocus:m&&v}),x(L1,{...a6(BN({},u),{withinPortal:l,target:d}),children:x(RIe,{value:{__staticSelector:s,opened:n,onClose:r,closeOnClickOutside:a,transitionProps:a6(BN({},o),{duration:V,keepMounted:c}),zIndex:p,padding:y,id:z,getTitleId:()=>`${z}-title`,getBodyId:()=>`${z}-body`,titleMounted:q,bodyMounted:J,setTitleMounted:H,setBodyMounted:ee,trapFocus:m,closeOnEscape:g,shadow:b,stylesApi:{name:s,size:k,variant:C,classNames:$,styles:A,unstyled:N}},children:x(vge,{enabled:Q&&h,children:x(wt,{...BN({className:E(F.root,D)},O),children:i})})})})}Fr.CloseButton=VIe;Fr.Overlay=d2e;Fr.Content=y2e;Fr.Header=S2e;Fr.Title=O2e;Fr.Body=F2e;Fr.NativeScrollArea=z2e;function q2e(e){return I.exports.Children.toArray(e).filter(Boolean)}const eJ={left:"flex-start",center:"center",right:"flex-end",apart:"space-between"};var K2e=it((e,{spacing:t,position:n,noWrap:r,grow:i,align:a,count:s})=>({root:{boxSizing:"border-box",display:"flex",flexDirection:"row",alignItems:a||"center",flexWrap:r?"nowrap":"wrap",justifyContent:eJ[n],gap:ke({size:t,sizes:e.spacing}),"& > *":{boxSizing:"border-box",maxWidth:i?`calc(${100/s}% - (${G(ke({size:t,sizes:e.spacing}))} - ${ke({size:t,sizes:e.spacing})} / ${s}))`:void 0,flexGrow:i?1:0}}}));const Z2e=K2e;var X2e=Object.defineProperty,iC=Object.getOwnPropertySymbols,tJ=Object.prototype.hasOwnProperty,nJ=Object.prototype.propertyIsEnumerable,s6=(e,t,n)=>t in e?X2e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,J2e=(e,t)=>{for(var n in t||(t={}))tJ.call(t,n)&&s6(e,n,t[n]);if(iC)for(var n of iC(t))nJ.call(t,n)&&s6(e,n,t[n]);return e},Y2e=(e,t)=>{var n={};for(var r in e)tJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&iC)for(var r of iC(e))t.indexOf(r)<0&&nJ.call(e,r)&&(n[r]=e[r]);return n};const Q2e={position:"left",spacing:"md"},me=I.exports.forwardRef((e,t)=>{const n=Ke("Group",Q2e,e),{className:r,position:i,align:a,children:s,noWrap:o,grow:l,spacing:u,unstyled:c,variant:d}=n,p=Y2e(n,["className","position","align","children","noWrap","grow","spacing","unstyled","variant"]),h=q2e(s),{classes:m,cx:g}=Z2e({align:a,grow:l,noWrap:o,spacing:u,position:i,count:h.length},{unstyled:c,name:"Group",variant:d});return x(wt,{...J2e({className:g(m.root,r),ref:t},p),children:h})});me.displayName="@mantine/core/Group";const rJ={context:"HoverCard component was not found in the tree",children:"HoverCard.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported"},[e$e,iJ]=Iy(rJ.context);var t$e=Object.defineProperty,aC=Object.getOwnPropertySymbols,aJ=Object.prototype.hasOwnProperty,sJ=Object.prototype.propertyIsEnumerable,o6=(e,t,n)=>t in e?t$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,n$e=(e,t)=>{for(var n in t||(t={}))aJ.call(t,n)&&o6(e,n,t[n]);if(aC)for(var n of aC(t))sJ.call(t,n)&&o6(e,n,t[n]);return e},r$e=(e,t)=>{var n={};for(var r in e)aJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&aC)for(var r of aC(e))t.indexOf(r)<0&&sJ.call(e,r)&&(n[r]=e[r]);return n};const i$e={};function oJ(e){const t=Ke("HoverCardDropdown",i$e,e),{children:n,onMouseEnter:r,onMouseLeave:i}=t,a=r$e(t,["children","onMouseEnter","onMouseLeave"]),s=iJ(),o=qk(r,s.openDropdown),l=qk(i,s.closeDropdown);return x(Da.Dropdown,{...n$e({onMouseEnter:o,onMouseLeave:l},a),children:n})}oJ.displayName="@mantine/core/HoverCardDropdown";var a$e=Object.defineProperty,sC=Object.getOwnPropertySymbols,lJ=Object.prototype.hasOwnProperty,uJ=Object.prototype.propertyIsEnumerable,l6=(e,t,n)=>t in e?a$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,s$e=(e,t)=>{for(var n in t||(t={}))lJ.call(t,n)&&l6(e,n,t[n]);if(sC)for(var n of sC(t))uJ.call(t,n)&&l6(e,n,t[n]);return e},o$e=(e,t)=>{var n={};for(var r in e)lJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&sC)for(var r of sC(e))t.indexOf(r)<0&&uJ.call(e,r)&&(n[r]=e[r]);return n};const l$e={refProp:"ref"},cJ=I.exports.forwardRef((e,t)=>{const n=Ke("HoverCardTarget",l$e,e),{children:r,refProp:i}=n,a=o$e(n,["children","refProp"]);if(!A1(r))throw new Error(rJ.children);const s=iJ(),o=qk(r.props.onMouseEnter,s.openDropdown),l=qk(r.props.onMouseLeave,s.closeDropdown);return x(Da.Target,{...s$e({refProp:i,ref:t},a),children:I.exports.cloneElement(r,{onMouseEnter:o,onMouseLeave:l})})});cJ.displayName="@mantine/core/HoverCardTarget";function u$e({open:e,close:t,openDelay:n,closeDelay:r}){const i=I.exports.useRef(-1),a=I.exports.useRef(-1),s=()=>{window.clearTimeout(i.current),window.clearTimeout(a.current)},o=()=>{s(),n===0?e():i.current=window.setTimeout(e,n)},l=()=>{s(),r===0?t():a.current=window.setTimeout(t,r)};return I.exports.useEffect(()=>s,[]),{openDropdown:o,closeDropdown:l}}var c$e=Object.defineProperty,oC=Object.getOwnPropertySymbols,dJ=Object.prototype.hasOwnProperty,pJ=Object.prototype.propertyIsEnumerable,u6=(e,t,n)=>t in e?c$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,d$e=(e,t)=>{for(var n in t||(t={}))dJ.call(t,n)&&u6(e,n,t[n]);if(oC)for(var n of oC(t))pJ.call(t,n)&&u6(e,n,t[n]);return e},p$e=(e,t)=>{var n={};for(var r in e)dJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&oC)for(var r of oC(e))t.indexOf(r)<0&&pJ.call(e,r)&&(n[r]=e[r]);return n};const h$e={openDelay:0,closeDelay:150,initiallyOpened:!1};function xg(e){const t=Ke("HoverCard",h$e,e),{children:n,onOpen:r,onClose:i,openDelay:a,closeDelay:s,initiallyOpened:o}=t,l=p$e(t,["children","onOpen","onClose","openDelay","closeDelay","initiallyOpened"]),[u,{open:c,close:d}]=$r(o,{onClose:i,onOpen:r}),{openDropdown:p,closeDropdown:h}=u$e({open:c,close:d,openDelay:a,closeDelay:s});return x(e$e,{value:{openDropdown:p,closeDropdown:h},children:x(Da,{...d$e({opened:u,__staticSelector:"HoverCard"},l),children:n})})}xg.displayName="@mantine/core/HoverCard";xg.Target=cJ;xg.Dropdown=oJ;var f$e=Object.defineProperty,lC=Object.getOwnPropertySymbols,hJ=Object.prototype.hasOwnProperty,fJ=Object.prototype.propertyIsEnumerable,c6=(e,t,n)=>t in e?f$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,d6=(e,t)=>{for(var n in t||(t={}))hJ.call(t,n)&&c6(e,n,t[n]);if(lC)for(var n of lC(t))fJ.call(t,n)&&c6(e,n,t[n]);return e},m$e=(e,t)=>{var n={};for(var r in e)hJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&lC)for(var r of lC(e))t.indexOf(r)<0&&fJ.call(e,r)&&(n[r]=e[r]);return n};function g$e(e){const t=e,{width:n,height:r,style:i}=t,a=m$e(t,["width","height","style"]);return x("svg",{...d6({viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:d6({width:n,height:r},i)},a),children:x("path",{d:"M2.5 1H12.5C13.3284 1 14 1.67157 14 2.5V12.5C14 13.3284 13.3284 14 12.5 14H2.5C1.67157 14 1 13.3284 1 12.5V2.5C1 1.67157 1.67157 1 2.5 1ZM2.5 2C2.22386 2 2 2.22386 2 2.5V8.3636L3.6818 6.6818C3.76809 6.59551 3.88572 6.54797 4.00774 6.55007C4.12975 6.55216 4.24568 6.60372 4.32895 6.69293L7.87355 10.4901L10.6818 7.6818C10.8575 7.50607 11.1425 7.50607 11.3182 7.6818L13 9.3636V2.5C13 2.22386 12.7761 2 12.5 2H2.5ZM2 12.5V9.6364L3.98887 7.64753L7.5311 11.4421L8.94113 13H2.5C2.22386 13 2 12.7761 2 12.5ZM12.5 13H10.155L8.48336 11.153L11 8.6364L13 10.6364V12.5C13 12.7761 12.7761 13 12.5 13ZM6.64922 5.5C6.64922 5.03013 7.03013 4.64922 7.5 4.64922C7.96987 4.64922 8.35078 5.03013 8.35078 5.5C8.35078 5.96987 7.96987 6.35078 7.5 6.35078C7.03013 6.35078 6.64922 5.96987 6.64922 5.5ZM7.5 3.74922C6.53307 3.74922 5.74922 4.53307 5.74922 5.5C5.74922 6.46693 6.53307 7.25078 7.5 7.25078C8.46693 7.25078 9.25078 6.46693 9.25078 5.5C9.25078 4.53307 8.46693 3.74922 7.5 3.74922Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}var y$e=Object.defineProperty,v$e=Object.defineProperties,b$e=Object.getOwnPropertyDescriptors,p6=Object.getOwnPropertySymbols,w$e=Object.prototype.hasOwnProperty,x$e=Object.prototype.propertyIsEnumerable,h6=(e,t,n)=>t in e?y$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,f6=(e,t)=>{for(var n in t||(t={}))w$e.call(t,n)&&h6(e,n,t[n]);if(p6)for(var n of p6(t))x$e.call(t,n)&&h6(e,n,t[n]);return e},m6=(e,t)=>v$e(e,b$e(t)),_$e=it((e,{radius:t})=>({root:{},imageWrapper:{position:"relative"},figure:{margin:0},image:m6(f6({},e.fn.fontStyles()),{display:"block",width:"100%",height:"100%",border:0,borderRadius:e.fn.radius(t)}),caption:{color:e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[7],marginTop:e.spacing.xs},placeholder:m6(f6({},e.fn.cover()),{display:"flex",alignItems:"center",justifyContent:"center",color:e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[6],backgroundColor:e.colorScheme==="dark"?e.colors.dark[8]:e.colors.gray[0],borderRadius:e.fn.radius(t)})}));const k$e=_$e;var S$e=Object.defineProperty,C$e=Object.defineProperties,I$e=Object.getOwnPropertyDescriptors,uC=Object.getOwnPropertySymbols,mJ=Object.prototype.hasOwnProperty,gJ=Object.prototype.propertyIsEnumerable,g6=(e,t,n)=>t in e?S$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,L0=(e,t)=>{for(var n in t||(t={}))mJ.call(t,n)&&g6(e,n,t[n]);if(uC)for(var n of uC(t))gJ.call(t,n)&&g6(e,n,t[n]);return e},$$e=(e,t)=>C$e(e,I$e(t)),T$e=(e,t)=>{var n={};for(var r in e)mJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&uC)for(var r of uC(e))t.indexOf(r)<0&&gJ.call(e,r)&&(n[r]=e[r]);return n};const N$e={fit:"cover",width:"100%",height:"auto",radius:0},il=I.exports.forwardRef((e,t)=>{const n=Ke("Image",N$e,e),{className:r,alt:i,src:a,fit:s,width:o,height:l,radius:u,imageProps:c,withPlaceholder:d,placeholder:p,imageRef:h,classNames:m,styles:g,caption:v,unstyled:y,style:b,variant:_}=n,k=T$e(n,["className","alt","src","fit","width","height","radius","imageProps","withPlaceholder","placeholder","imageRef","classNames","styles","caption","unstyled","style","variant"]),{classes:C,cx:$}=k$e({radius:u},{classNames:m,styles:g,unstyled:y,name:"Image",variant:_}),[N,A]=I.exports.useState(!a),D=d&&N;return Xi(()=>{A(!a)},[a]),x(wt,{...L0({className:$(C.root,r),style:L0({width:G(o)},b),ref:t},k),children:B("figure",{className:C.figure,children:[B("div",{className:C.imageWrapper,children:[x("img",{...$$e(L0({src:a,alt:i,ref:h},c),{className:$(C.image,c==null?void 0:c.className),onError:O=>{A(!0),typeof(c==null?void 0:c.onError)=="function"&&c.onError(O)},style:L0(L0({objectFit:s,width:G(o),height:G(l)},D&&{overflow:"hidden"}),c==null?void 0:c.style)})}),D&&x("div",{className:C.placeholder,title:i,children:p||x("div",{children:x(g$e,{width:G(40),height:G(40)})})})]}),!!v&&x(Te,{component:"figcaption",size:"sm",align:"center",className:C.caption,children:v})]})})});il.displayName="@mantine/core/Image";function E$e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var O$e=I.exports.useLayoutEffect,P$e=function(t){var n=I.exports.useRef(t);return O$e(function(){n.current=t}),n},y6=function(t,n){if(typeof t=="function"){t(n);return}t.current=n},A$e=function(t,n){var r=I.exports.useRef();return I.exports.useCallback(function(i){t.current=i,r.current&&y6(r.current,null),r.current=n,n&&y6(n,i)},[n])},v6={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},b6=function(t){Object.keys(v6).forEach(function(n){t.style.setProperty(n,v6[n],"important")})},ks=null,M$e=function(t,n){var r=t.scrollHeight;return n.sizingStyle.boxSizing==="border-box"?r+n.borderSize:r-n.paddingSize};function R$e(e,t,n,r){n===void 0&&(n=1),r===void 0&&(r=1/0),ks||(ks=document.createElement("textarea"),ks.setAttribute("tabindex","-1"),ks.setAttribute("aria-hidden","true"),b6(ks)),ks.parentNode===null&&document.body.appendChild(ks);var i=e.paddingSize,a=e.borderSize,s=e.sizingStyle,o=s.boxSizing;Object.keys(s).forEach(function(p){var h=p;ks.style[h]=s[h]}),b6(ks),ks.value=t;var l=M$e(ks,e);ks.value="x";var u=ks.scrollHeight-i,c=u*n;o==="border-box"&&(c=c+i+a),l=Math.max(c,l);var d=u*r;return o==="border-box"&&(d=d+i+a),l=Math.min(d,l),[l,u]}var w6=function(){},D$e=function(t,n){return t.reduce(function(r,i){return r[i]=n[i],r},{})},L$e=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],F$e=!!document.documentElement.currentStyle,z$e=function(t){var n=window.getComputedStyle(t);if(n===null)return null;var r=D$e(L$e,n),i=r.boxSizing;if(i==="")return null;F$e&&i==="border-box"&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var a=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),s=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:a,borderSize:s}},B$e=function(t){var n=P$e(t);I.exports.useLayoutEffect(function(){var r=function(a){n.current(a)};return window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}},[])},W$e=function(t,n){var r=t.cacheMeasurements,i=t.maxRows,a=t.minRows,s=t.onChange,o=s===void 0?w6:s,l=t.onHeightChange,u=l===void 0?w6:l,c=E$e(t,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]),d=c.value!==void 0,p=I.exports.useRef(null),h=A$e(p,n),m=I.exports.useRef(0),g=I.exports.useRef(),v=function(){var _=p.current,k=r&&g.current?g.current:z$e(_);if(!!k){g.current=k;var C=R$e(k,_.value||_.placeholder||"x",a,i),$=C[0],N=C[1];m.current!==$&&(m.current=$,_.style.setProperty("height",$+"px","important"),u($,{rowHeight:N}))}},y=function(_){d||v(),o(_)};return I.exports.useLayoutEffect(v),B$e(v),I.exports.createElement("textarea",ar({},c,{onChange:y,ref:h}))},V$e=I.exports.forwardRef(W$e);const j$e=V$e;var U$e=it(e=>({input:{paddingTop:e.spacing.xs,paddingBottom:e.spacing.xs}}));const H$e=U$e;var G$e=Object.defineProperty,q$e=Object.defineProperties,K$e=Object.getOwnPropertyDescriptors,cC=Object.getOwnPropertySymbols,yJ=Object.prototype.hasOwnProperty,vJ=Object.prototype.propertyIsEnumerable,x6=(e,t,n)=>t in e?G$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Am=(e,t)=>{for(var n in t||(t={}))yJ.call(t,n)&&x6(e,n,t[n]);if(cC)for(var n of cC(t))vJ.call(t,n)&&x6(e,n,t[n]);return e},WN=(e,t)=>q$e(e,K$e(t)),Z$e=(e,t)=>{var n={};for(var r in e)yJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&cC)for(var r of cC(e))t.indexOf(r)<0&&vJ.call(e,r)&&(n[r]=e[r]);return n};const X$e={autosize:!1,size:"sm",__staticSelector:"Textarea"},bs=I.exports.forwardRef((e,t)=>{const n=Ke("Textarea",X$e,e),{autosize:r,maxRows:i,minRows:a,label:s,error:o,description:l,id:u,className:c,required:d,style:p,wrapperProps:h,classNames:m,styles:g,size:v,__staticSelector:y,sx:b,errorProps:_,descriptionProps:k,labelProps:C,inputWrapperOrder:$,inputContainer:N,unstyled:A,withAsterisk:D,variant:O}=n,F=Z$e(n,["autosize","maxRows","minRows","label","error","description","id","className","required","style","wrapperProps","classNames","styles","size","__staticSelector","sx","errorProps","descriptionProps","labelProps","inputWrapperOrder","inputContainer","unstyled","withAsterisk","variant"]),E=zu(u),{classes:z,cx:q}=H$e(),{systemStyles:H,rest:J}=Cd(F),ee=Am({required:d,ref:t,error:o,id:E,classNames:WN(Am({},m),{input:q(z.input,m==null?void 0:m.input)}),styles:g,__staticSelector:y,size:v,multiline:!0,unstyled:A,variant:O},J);return x(As.Wrapper,{...Am(Am({label:s,error:o,id:E,description:l,required:d,style:p,className:c,classNames:m,styles:g,size:v,__staticSelector:y,sx:b,errorProps:_,labelProps:C,descriptionProps:k,inputContainer:N,inputWrapperOrder:$,unstyled:A,withAsterisk:D,variant:O},H),h),children:r?x(As,{...WN(Am({},ee),{component:j$e,maxRows:i,minRows:a})}):x(As,{...WN(Am({},ee),{component:"textarea",rows:a})})})});bs.displayName="@mantine/core/Textarea";const[J$e,Y$e]=Iy("Modal component was not found in tree"),Q$e={xs:G(320),sm:G(380),md:G(440),lg:G(620),xl:G(780)};var eTe=it((e,{yOffset:t,xOffset:n,centered:r,fullScreen:i},{size:a})=>({content:{flex:i?"0 0 100%":`0 0 ${ke({size:a,sizes:Q$e})}`,maxWidth:"100%",maxHeight:i?void 0:`calc(100dvh - (${G(t)} * 2))`,height:i?"100vh":void 0,borderRadius:i?0:void 0,overflowY:"auto"},inner:{paddingTop:i?0:t,paddingBottom:i?0:t,paddingLeft:i?0:n,paddingRight:i?0:n,display:"flex",justifyContent:"center",alignItems:r?"center":"flex-start"}}));const tTe=eTe;var nTe=Object.defineProperty,rTe=Object.defineProperties,iTe=Object.getOwnPropertyDescriptors,dC=Object.getOwnPropertySymbols,bJ=Object.prototype.hasOwnProperty,wJ=Object.prototype.propertyIsEnumerable,_6=(e,t,n)=>t in e?nTe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rP=(e,t)=>{for(var n in t||(t={}))bJ.call(t,n)&&_6(e,n,t[n]);if(dC)for(var n of dC(t))wJ.call(t,n)&&_6(e,n,t[n]);return e},xJ=(e,t)=>rTe(e,iTe(t)),aTe=(e,t)=>{var n={};for(var r in e)bJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&dC)for(var r of dC(e))t.indexOf(r)<0&&wJ.call(e,r)&&(n[r]=e[r]);return n};const sTe=xJ(rP({},NR),{yOffset:"5dvh",xOffset:"5vw"});function _J(e){const t=Ke("ModalRoot",sTe,e),{classNames:n,variant:r,size:i,yOffset:a,xOffset:s,scrollAreaComponent:o,radius:l,centered:u,fullScreen:c}=t,d=aTe(t,["classNames","variant","size","yOffset","xOffset","scrollAreaComponent","radius","centered","fullScreen"]),{classes:p,cx:h}=tTe({yOffset:a,xOffset:s,centered:u,fullScreen:c},{name:"Modal",variant:r,size:i});return x(J$e,{value:{yOffset:a,scrollAreaComponent:o,radius:l},children:x(Fr,{...rP({__staticSelector:"Modal",size:i,variant:r,classNames:xJ(rP({},n),{content:h(p.content,n==null?void 0:n.content),inner:h(p.inner,n==null?void 0:n.inner)})},d)})})}var oTe=Object.defineProperty,pC=Object.getOwnPropertySymbols,kJ=Object.prototype.hasOwnProperty,SJ=Object.prototype.propertyIsEnumerable,k6=(e,t,n)=>t in e?oTe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lTe=(e,t)=>{for(var n in t||(t={}))kJ.call(t,n)&&k6(e,n,t[n]);if(pC)for(var n of pC(t))SJ.call(t,n)&&k6(e,n,t[n]);return e},uTe=(e,t)=>{var n={};for(var r in e)kJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&pC)for(var r of pC(e))t.indexOf(r)<0&&SJ.call(e,r)&&(n[r]=e[r]);return n};const cTe={shadow:"xl"},CJ=I.exports.forwardRef((e,t)=>{const n=Ke("ModalContent",cTe,e),{children:r,scrollAreaComponent:i}=n,a=uTe(n,["children","scrollAreaComponent"]),s=Y$e(),o=i||s.scrollAreaComponent||Fr.NativeScrollArea;return x(Fr.Content,{...lTe({ref:t,radius:s.radius},a),children:x(o,{style:{maxHeight:`calc(100dvh - (${G(s.yOffset)} * 2))`},children:r})})});var dTe=Object.defineProperty,pTe=Object.defineProperties,hTe=Object.getOwnPropertyDescriptors,hC=Object.getOwnPropertySymbols,IJ=Object.prototype.hasOwnProperty,$J=Object.prototype.propertyIsEnumerable,S6=(e,t,n)=>t in e?dTe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nk=(e,t)=>{for(var n in t||(t={}))IJ.call(t,n)&&S6(e,n,t[n]);if(hC)for(var n of hC(t))$J.call(t,n)&&S6(e,n,t[n]);return e},fTe=(e,t)=>pTe(e,hTe(t)),mTe=(e,t)=>{var n={};for(var r in e)IJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&hC)for(var r of hC(e))t.indexOf(r)<0&&$J.call(e,r)&&(n[r]=e[r]);return n};const gTe=fTe(nk({},NR),{transitionProps:{duration:200,transition:"pop"},withOverlay:!0,withCloseButton:!0});function sr(e){const t=Ke("Modal",gTe,e),{title:n,withOverlay:r,overlayProps:i,withCloseButton:a,closeButtonProps:s,children:o}=t,l=mTe(t,["title","withOverlay","overlayProps","withCloseButton","closeButtonProps","children"]),u=!!n||a;return B(_J,{...nk({},l),children:[r&&x(Fr.Overlay,{...nk({},i)}),B(CJ,{children:[u&&B(Fr.Header,{children:[n&&x(Fr.Title,{children:n}),a&&x(Fr.CloseButton,{...nk({},s)})]}),x(Fr.Body,{children:o})]})]})}sr.Root=_J;sr.CloseButton=Fr.CloseButton;sr.Overlay=Fr.Overlay;sr.Content=CJ;sr.Header=Fr.Header;sr.Title=Fr.Title;sr.Body=Fr.Body;sr.NativeScrollArea=Fr.NativeScrollArea;const TJ={xs:G(16),sm:G(22),md:G(26),lg:G(30),xl:G(36)},yTe={xs:G(10),sm:G(12),md:G(14),lg:G(16),xl:G(18)};var vTe=it((e,{disabled:t,radius:n,readOnly:r},{size:i,variant:a})=>({defaultValue:{display:"flex",alignItems:"center",backgroundColor:t?e.colorScheme==="dark"?e.colors.dark[5]:e.colors.gray[3]:e.colorScheme==="dark"?e.colors.dark[7]:a==="filled"?e.white:e.colors.gray[1],color:t?e.colorScheme==="dark"?e.colors.dark[1]:e.colors.gray[7]:e.colorScheme==="dark"?e.colors.dark[0]:e.colors.gray[7],height:ke({size:i,sizes:TJ}),paddingLeft:`calc(${ke({size:i,sizes:e.spacing})} / 1.5)`,paddingRight:t||r?ke({size:i,sizes:e.spacing}):0,fontWeight:500,fontSize:ke({size:i,sizes:yTe}),borderRadius:ke({size:n,sizes:e.radius}),cursor:t?"not-allowed":"default",userSelect:"none",maxWidth:`calc(100% - ${G(10)})`},defaultValueRemove:{color:e.colorScheme==="dark"?e.colors.dark[0]:e.colors.gray[7],marginLeft:`calc(${ke({size:i,sizes:e.spacing})} / 6)`},defaultValueLabel:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}));const bTe=vTe;var wTe=Object.defineProperty,fC=Object.getOwnPropertySymbols,NJ=Object.prototype.hasOwnProperty,EJ=Object.prototype.propertyIsEnumerable,C6=(e,t,n)=>t in e?wTe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xTe=(e,t)=>{for(var n in t||(t={}))NJ.call(t,n)&&C6(e,n,t[n]);if(fC)for(var n of fC(t))EJ.call(t,n)&&C6(e,n,t[n]);return e},_Te=(e,t)=>{var n={};for(var r in e)NJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&fC)for(var r of fC(e))t.indexOf(r)<0&&EJ.call(e,r)&&(n[r]=e[r]);return n};const kTe={xs:16,sm:22,md:24,lg:26,xl:30};function OJ(e){var t=e,{label:n,classNames:r,styles:i,className:a,onRemove:s,disabled:o,readOnly:l,size:u,radius:c="sm",variant:d,unstyled:p}=t,h=_Te(t,["label","classNames","styles","className","onRemove","disabled","readOnly","size","radius","variant","unstyled"]);const{classes:m,cx:g}=bTe({disabled:o,readOnly:l,radius:c},{name:"MultiSelect",classNames:r,styles:i,unstyled:p,size:u,variant:d});return B("div",{...xTe({className:g(m.defaultValue,a)},h),children:[x("span",{className:m.defaultValueLabel,children:n}),!o&&!l&&x(rR,{"aria-hidden":!0,onMouseDown:s,size:kTe[u],radius:2,color:"blue",variant:"transparent",iconSize:"70%",className:m.defaultValueRemove,tabIndex:-1,unstyled:p})]})}OJ.displayName="@mantine/core/MultiSelect/DefaultValue";function STe({data:e,searchable:t,limit:n,searchValue:r,filter:i,value:a,disableSelectedItemFiltering:s}){if(!t&&a.length===0)return e;if(!t){const l=[];for(let u=0;u<e.length;u+=1)(!!s||!a.some(c=>c===e[u].value&&!e[u].disabled))&&l.push(e[u]);return l}const o=[];for(let l=0;l<e.length&&(i(r,!s&&a.some(u=>u===e[l].value&&!e[l].disabled),e[l])&&o.push(e[l]),!(o.length>=n));l+=1);return o}var CTe=Object.defineProperty,mC=Object.getOwnPropertySymbols,PJ=Object.prototype.hasOwnProperty,AJ=Object.prototype.propertyIsEnumerable,I6=(e,t,n)=>t in e?CTe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$6=(e,t)=>{for(var n in t||(t={}))PJ.call(t,n)&&I6(e,n,t[n]);if(mC)for(var n of mC(t))AJ.call(t,n)&&I6(e,n,t[n]);return e},ITe=(e,t)=>{var n={};for(var r in e)PJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&mC)for(var r of mC(e))t.indexOf(r)<0&&AJ.call(e,r)&&(n[r]=e[r]);return n};const $Te={xs:G(14),sm:G(18),md:G(20),lg:G(24),xl:G(28)};function TTe(e){var t=e,{size:n,error:r,style:i}=t,a=ITe(t,["size","error","style"]);const s=Ka(),o=ke({size:n,sizes:$Te});return x("svg",{...$6({viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:$6({color:r?s.colors.red[6]:s.colors.gray[6],width:o,height:o},i),"data-chevron":!0},a),children:x("path",{d:"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}var NTe=Object.defineProperty,ETe=Object.defineProperties,OTe=Object.getOwnPropertyDescriptors,T6=Object.getOwnPropertySymbols,PTe=Object.prototype.hasOwnProperty,ATe=Object.prototype.propertyIsEnumerable,N6=(e,t,n)=>t in e?NTe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,MTe=(e,t)=>{for(var n in t||(t={}))PTe.call(t,n)&&N6(e,n,t[n]);if(T6)for(var n of T6(t))ATe.call(t,n)&&N6(e,n,t[n]);return e},RTe=(e,t)=>ETe(e,OTe(t));function MJ({shouldClear:e,clearButtonProps:t,onClear:n,size:r,error:i}){return e?x(rR,{...RTe(MTe({},t),{variant:"transparent",onClick:n,size:r,onMouseDown:a=>a.preventDefault()})}):x(TTe,{error:i,size:r})}MJ.displayName="@mantine/core/SelectRightSection";var DTe=Object.defineProperty,LTe=Object.defineProperties,FTe=Object.getOwnPropertyDescriptors,gC=Object.getOwnPropertySymbols,RJ=Object.prototype.hasOwnProperty,DJ=Object.prototype.propertyIsEnumerable,E6=(e,t,n)=>t in e?DTe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,VN=(e,t)=>{for(var n in t||(t={}))RJ.call(t,n)&&E6(e,n,t[n]);if(gC)for(var n of gC(t))DJ.call(t,n)&&E6(e,n,t[n]);return e},O6=(e,t)=>LTe(e,FTe(t)),zTe=(e,t)=>{var n={};for(var r in e)RJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&gC)for(var r of gC(e))t.indexOf(r)<0&&DJ.call(e,r)&&(n[r]=e[r]);return n};function LJ(e){var t=e,{styles:n,rightSection:r,rightSectionWidth:i,theme:a}=t,s=zTe(t,["styles","rightSection","rightSectionWidth","theme"]);if(r)return{rightSection:r,rightSectionWidth:i,styles:n};const o=typeof n=="function"?n(a):n;return{rightSection:!s.readOnly&&!(s.disabled&&s.shouldClear)&&x(MJ,{...VN({},s)}),styles:O6(VN({},o),{rightSection:O6(VN({},o==null?void 0:o.rightSection),{pointerEvents:s.shouldClear?void 0:"none"})})}}var BTe=Object.defineProperty,WTe=Object.defineProperties,VTe=Object.getOwnPropertyDescriptors,P6=Object.getOwnPropertySymbols,jTe=Object.prototype.hasOwnProperty,UTe=Object.prototype.propertyIsEnumerable,A6=(e,t,n)=>t in e?BTe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,HTe=(e,t)=>{for(var n in t||(t={}))jTe.call(t,n)&&A6(e,n,t[n]);if(P6)for(var n of P6(t))UTe.call(t,n)&&A6(e,n,t[n]);return e},GTe=(e,t)=>WTe(e,VTe(t)),qTe=it((e,{invalid:t},{size:n})=>({wrapper:{position:"relative","&:has(input:disabled)":{cursor:"not-allowed",pointerEvents:"none","& .mantine-MultiSelect-input":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[1],color:e.colors.dark[2],opacity:.6,"&::placeholder":{color:e.colors.dark[2]}},"& .mantine-MultiSelect-defaultValue":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[5]:e.colors.gray[3],color:e.colorScheme==="dark"?e.colors.dark[1]:e.colors.gray[7]}}},values:{minHeight:`calc(${ke({size:n,sizes:Ui})} - ${G(2)})`,display:"flex",alignItems:"center",flexWrap:"wrap",marginLeft:`calc(-${e.spacing.xs} / 2)`,boxSizing:"border-box","&[data-clearable]":{marginRight:ke({size:n,sizes:Ui})}},value:{margin:`calc(${e.spacing.xs} / 2 - ${G(2)}) calc(${e.spacing.xs} / 2)`},searchInput:GTe(HTe({},e.fn.fontStyles()),{flex:1,minWidth:G(60),backgroundColor:"transparent",border:0,outline:0,fontSize:ke({size:n,sizes:e.fontSizes}),padding:0,marginLeft:`calc(${e.spacing.xs} / 2)`,appearance:"none",color:"inherit",maxHeight:ke({size:n,sizes:TJ}),"&::placeholder":{opacity:1,color:t?e.colors.red[e.fn.primaryShade()]:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5]},"&:disabled":{cursor:"not-allowed",pointerEvents:"none"}}),searchInputEmpty:{width:"100%"},searchInputInputHidden:{flex:0,width:0,minWidth:0,margin:0,overflow:"hidden"},searchInputPointer:{cursor:"pointer","&:disabled":{cursor:"not-allowed",pointerEvents:"none"}},input:{cursor:"pointer","&:disabled":{cursor:"not-allowed",pointerEvents:"none"}}}));const KTe=qTe;var ZTe=Object.defineProperty,XTe=Object.defineProperties,JTe=Object.getOwnPropertyDescriptors,yC=Object.getOwnPropertySymbols,FJ=Object.prototype.hasOwnProperty,zJ=Object.prototype.propertyIsEnumerable,M6=(e,t,n)=>t in e?ZTe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Mm=(e,t)=>{for(var n in t||(t={}))FJ.call(t,n)&&M6(e,n,t[n]);if(yC)for(var n of yC(t))zJ.call(t,n)&&M6(e,n,t[n]);return e},R6=(e,t)=>XTe(e,JTe(t)),YTe=(e,t)=>{var n={};for(var r in e)FJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&yC)for(var r of yC(e))t.indexOf(r)<0&&zJ.call(e,r)&&(n[r]=e[r]);return n};function QTe(e,t,n){return t?!1:n.label.toLowerCase().trim().includes(e.toLowerCase().trim())}function eNe(e,t){return!!e&&!t.some(n=>n.value.toLowerCase()===e.toLowerCase())}function D6(e,t){if(!Array.isArray(e))return;if(t.length===0)return[];const n=t.map(r=>typeof r=="object"?r.value:r);return e.filter(r=>n.includes(r))}const tNe={size:"sm",valueComponent:OJ,itemComponent:aR,transitionProps:{transition:"fade",duration:0},maxDropdownHeight:220,shadow:"sm",searchable:!1,filter:QTe,limit:1/0,clearSearchOnChange:!0,clearable:!1,clearSearchOnBlur:!1,disabled:!1,initiallyOpened:!1,creatable:!1,shouldCreate:eNe,switchDirectionOnFlip:!1,zIndex:Sd("popover"),selectOnBlur:!1,positionDependencies:[],dropdownPosition:"flip"},Au=I.exports.forwardRef((e,t)=>{const n=Ke("MultiSelect",tNe,e),{className:r,style:i,required:a,label:s,description:o,size:l,error:u,classNames:c,styles:d,wrapperProps:p,value:h,defaultValue:m,data:g,onChange:v,valueComponent:y,itemComponent:b,id:_,transitionProps:k,maxDropdownHeight:C,shadow:$,nothingFound:N,onFocus:A,onBlur:D,searchable:O,placeholder:F,filter:E,limit:z,clearSearchOnChange:q,clearable:H,clearSearchOnBlur:J,variant:ee,onSearchChange:V,searchValue:Q,disabled:X,initiallyOpened:Y,radius:ce,icon:pe,rightSection:fe,rightSectionWidth:ye,creatable:_e,getCreateLabel:Ee,shouldCreate:Se,onCreate:Re,sx:Ze,dropdownComponent:at,onDropdownClose:Je,onDropdownOpen:st,maxSelectedValues:He,withinPortal:xt,portalProps:gt,switchDirectionOnFlip:ft,zIndex:Ft,selectOnBlur:Hn,name:_t,dropdownPosition:bn,errorProps:Jt,labelProps:Mt,descriptionProps:Rn,form:Gn,positionDependencies:wn,onKeyDown:$n,unstyled:cn,inputContainer:Nr,inputWrapperOrder:wi,readOnly:tr,withAsterisk:$a,clearButtonProps:yn,hoverOnSearchChange:Ge,disableSelectedItemFiltering:rt}=n,xi=YTe(n,["className","style","required","label","description","size","error","classNames","styles","wrapperProps","value","defaultValue","data","onChange","valueComponent","itemComponent","id","transitionProps","maxDropdownHeight","shadow","nothingFound","onFocus","onBlur","searchable","placeholder","filter","limit","clearSearchOnChange","clearable","clearSearchOnBlur","variant","onSearchChange","searchValue","disabled","initiallyOpened","radius","icon","rightSection","rightSectionWidth","creatable","getCreateLabel","shouldCreate","onCreate","sx","dropdownComponent","onDropdownClose","onDropdownOpen","maxSelectedValues","withinPortal","portalProps","switchDirectionOnFlip","zIndex","selectOnBlur","name","dropdownPosition","errorProps","labelProps","descriptionProps","form","positionDependencies","onKeyDown","unstyled","inputContainer","inputWrapperOrder","readOnly","withAsterisk","clearButtonProps","hoverOnSearchChange","disableSelectedItemFiltering"]),{classes:Tn,cx:qn,theme:ii}=KTe({invalid:!!u},{name:"MultiSelect",classNames:c,styles:d,unstyled:cn,size:l,variant:ee}),{systemStyles:Rr,rest:Kn}=Cd(xi),Dn=I.exports.useRef(),se=I.exports.useRef({}),Xn=zu(_),[nr,ve]=I.exports.useState(Y),[Ie,Ye]=I.exports.useState(-1),[Le,Lt]=I.exports.useState("column"),[Zt,$t]=qo({value:Q,defaultValue:"",finalValue:void 0,onChange:V}),[St,an]=I.exports.useState(!1),{scrollIntoView:Ue,targetRef:Li,scrollableRef:xo}=Mq({duration:0,offset:5,cancelable:!1,isList:!0}),_s=_e&&typeof Ee=="function";let nt=null;const Et=g.map(vt=>typeof vt=="string"?{label:vt,value:vt}:vt),Ln=Y9({data:Et}),[Ot,_o]=qo({value:D6(h,g),defaultValue:D6(m,g),finalValue:[],onChange:v}),Fi=I.exports.useRef(!!He&&He<Ot.length),ym=vt=>{if(!tr){const xn=Ot.filter(Hr=>Hr!==vt);_o(xn),!!He&&xn.length<He&&(Fi.current=!1)}},s0=vt=>{$t(vt.currentTarget.value),!X&&!Fi.current&&O&&ve(!0)},o0=vt=>{typeof A=="function"&&A(vt),!X&&!Fi.current&&O&&ve(!0)},rr=STe({data:Ln,searchable:O,searchValue:Zt,limit:z,filter:E,value:Ot,disableSelectedItemFiltering:rt});_s&&Se(Zt,Ln)&&(nt=Ee(Zt),rr.push({label:Zt,value:Zt,creatable:!0}));const ko=Math.min(Ie,rr.length-1),Ql=(vt,xn,Hr)=>{let Wt=vt;for(;Hr(Wt);)if(Wt=xn(Wt),!rr[Wt].disabled)return Wt;return vt};Xi(()=>{Ye(Ge&&Zt?0:-1)},[Zt,Ge]),Xi(()=>{!X&&Ot.length>g.length&&ve(!1),!!He&&Ot.length<He&&(Fi.current=!1),!!He&&Ot.length>=He&&(Fi.current=!0,ve(!1))},[Ot]);const eu=vt=>{if(!tr)if(q&&$t(""),Ot.includes(vt.value))ym(vt.value);else{if(vt.creatable&&typeof Re=="function"){const xn=Re(vt.value);typeof xn<"u"&&xn!==null&&_o(typeof xn=="string"?[...Ot,xn]:[...Ot,xn.value])}else _o([...Ot,vt.value]);Ot.length===He-1&&(Fi.current=!0,ve(!1)),rr.length===1&&ve(!1)}},l0=vt=>{typeof D=="function"&&D(vt),Hn&&rr[ko]&&nr&&eu(rr[ko]),J&&$t(""),ve(!1)},Zd=vt=>{if(St||($n==null||$n(vt),tr)||vt.key!=="Backspace"&&!!He&&Fi.current)return;const xn=Le==="column",Hr=()=>{Ye(fn=>{var Bi;const Ta=Ql(fn,ra=>ra+1,ra=>ra<rr.length-1);return nr&&(Li.current=se.current[(Bi=rr[Ta])==null?void 0:Bi.value],Ue({alignment:xn?"end":"start"})),Ta})},Wt=()=>{Ye(fn=>{var Bi;const Ta=Ql(fn,ra=>ra-1,ra=>ra>0);return nr&&(Li.current=se.current[(Bi=rr[Ta])==null?void 0:Bi.value],Ue({alignment:xn?"start":"end"})),Ta})};switch(vt.key){case"ArrowUp":{vt.preventDefault(),ve(!0),xn?Wt():Hr();break}case"ArrowDown":{vt.preventDefault(),ve(!0),xn?Hr():Wt();break}case"Enter":{vt.preventDefault(),rr[ko]&&nr?eu(rr[ko]):ve(!0);break}case" ":{O||(vt.preventDefault(),rr[ko]&&nr?eu(rr[ko]):ve(!0));break}case"Backspace":{Ot.length>0&&Zt.length===0&&(_o(Ot.slice(0,-1)),ve(!0),He&&(Fi.current=!1));break}case"Home":{if(!O){vt.preventDefault(),nr||ve(!0);const fn=rr.findIndex(Bi=>!Bi.disabled);Ye(fn),Ue({alignment:xn?"end":"start"})}break}case"End":{if(!O){vt.preventDefault(),nr||ve(!0);const fn=rr.map(Bi=>!!Bi.disabled).lastIndexOf(!1);Ye(fn),Ue({alignment:xn?"end":"start"})}break}case"Escape":ve(!1)}},u0=Ot.map(vt=>{let xn=Ln.find(Hr=>Hr.value===vt&&!Hr.disabled);return!xn&&_s&&(xn={value:vt,label:vt}),xn}).filter(vt=>!!vt).map((vt,xn)=>x(y,{...R6(Mm({},vt),{variant:ee,disabled:X,className:Tn.value,readOnly:tr,onRemove:Hr=>{Hr.preventDefault(),Hr.stopPropagation(),ym(vt.value)},key:vt.value,size:l,styles:d,classNames:c,radius:ce,index:xn})})),c0=vt=>Ot.includes(vt),Xd=()=>{var vt;$t(""),_o([]),(vt=Dn.current)==null||vt.focus(),He&&(Fi.current=!1)},zi=!tr&&(rr.length>0?nr:nr&&!!N);return Xi(()=>{const vt=zi?st:Je;typeof vt=="function"&&vt()},[zi]),x(As.Wrapper,{...Mm(Mm({required:a,id:Xn,label:s,error:u,description:o,size:l,className:r,style:i,classNames:c,styles:d,__staticSelector:"MultiSelect",sx:Ze,errorProps:Jt,descriptionProps:Rn,labelProps:Mt,inputContainer:Nr,inputWrapperOrder:wi,unstyled:cn,withAsterisk:$a,variant:ee},Rr),p),children:B(Kc,{opened:zi,transitionProps:k,shadow:"sm",withinPortal:xt,portalProps:gt,__staticSelector:"MultiSelect",onDirectionChange:Lt,switchDirectionOnFlip:ft,zIndex:Ft,dropdownPosition:bn,positionDependencies:[...wn,Zt],classNames:c,styles:d,unstyled:cn,variant:ee,children:[x(Kc.Target,{children:B("div",{className:Tn.wrapper,role:"combobox","aria-haspopup":"listbox","aria-owns":nr&&zi?`${Xn}-items`:null,"aria-controls":Xn,"aria-expanded":nr,onMouseLeave:()=>Ye(-1),tabIndex:-1,children:[x("input",{type:"hidden",name:_t,value:Ot.join(","),form:Gn,disabled:X}),x(As,{...Mm({__staticSelector:"MultiSelect",style:{overflow:"hidden"},component:"div",multiline:!0,size:l,variant:ee,disabled:X,error:u,required:a,radius:ce,icon:pe,unstyled:cn,onMouseDown:vt=>{var xn;vt.preventDefault(),!X&&!Fi.current&&ve(!nr),(xn=Dn.current)==null||xn.focus()},classNames:R6(Mm({},c),{input:qn({[Tn.input]:!O},c==null?void 0:c.input)})},LJ({theme:ii,rightSection:fe,rightSectionWidth:ye,styles:d,size:l,shouldClear:H&&Ot.length>0,onClear:Xd,error:u,disabled:X,clearButtonProps:yn,readOnly:tr})),children:B("div",{className:Tn.values,"data-clearable":H||void 0,children:[u0,x("input",{...Mm({ref:Bu(t,Dn),type:"search",id:Xn,className:qn(Tn.searchInput,{[Tn.searchInputPointer]:!O,[Tn.searchInputInputHidden]:!nr&&Ot.length>0||!O&&Ot.length>0,[Tn.searchInputEmpty]:Ot.length===0}),onKeyDown:Zd,value:Zt,onChange:s0,onFocus:o0,onBlur:l0,readOnly:!O||Fi.current||tr,placeholder:Ot.length===0?F:void 0,disabled:X,"data-mantine-stop-propagation":nr,autoComplete:"off",onCompositionStart:()=>an(!0),onCompositionEnd:()=>an(!1)},Kn)})]})})]})}),x(Kc.Dropdown,{component:at||P2,maxHeight:C,direction:Le,id:Xn,innerRef:xo,__staticSelector:"MultiSelect",classNames:c,styles:d,children:x(iR,{data:rr,hovered:ko,classNames:c,styles:d,uuid:Xn,__staticSelector:"MultiSelect",onItemHover:Ye,onItemSelect:eu,itemsRefs:se,itemComponent:b,size:l,nothingFound:N,isItemSelected:c0,creatable:_e&&!!nt,createLabel:nt,unstyled:cn,variant:ee})})]})})});Au.displayName="@mantine/core/MultiSelect";const nNe=(e,t,n)=>Number.isInteger(e)&&e>=0&&t===0?"numeric":!Number.isInteger(e)&&e>=0&&t!==0?"decimal":Number.isInteger(e)&&e<0&&t===0||!Number.isInteger(e)&&e<0&&t!==0?n==="ios"?"text":"decimal":"numeric";function L6({direction:e,size:t}){return x("svg",{style:{width:G(t),height:G(t),transform:e==="up"?"rotate(180deg)":void 0},viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:x("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}const BJ={xs:G(20),sm:G(24),md:G(30),lg:G(34),xl:G(36)};var rNe=it((e,{radius:t},{size:n})=>({rightSection:{display:"flex",flexDirection:"column",height:`calc(100% - ${G(2)})`,margin:G(1),overflow:"hidden",borderTopRightRadius:e.fn.radius(t),borderBottomRightRadius:e.fn.radius(t)},control:{margin:0,position:"relative",flex:"0 0 50%",display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",width:ke({size:n,sizes:BJ}),padding:0,WebkitTapHighlightColor:"transparent",borderBottom:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,borderLeft:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,borderTop:0,borderRight:0,backgroundColor:"transparent",marginRight:G(1),color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,"&:not(:disabled):hover":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[5]:e.colors.gray[0]},"&:disabled":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[4]}},controlUp:{},controlDown:{borderBottom:0}}));const iNe=rNe;var aNe=Object.defineProperty,sNe=Object.defineProperties,oNe=Object.getOwnPropertyDescriptors,vC=Object.getOwnPropertySymbols,WJ=Object.prototype.hasOwnProperty,VJ=Object.prototype.propertyIsEnumerable,F6=(e,t,n)=>t in e?aNe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,jN=(e,t)=>{for(var n in t||(t={}))WJ.call(t,n)&&F6(e,n,t[n]);if(vC)for(var n of vC(t))VJ.call(t,n)&&F6(e,n,t[n]);return e},lNe=(e,t)=>sNe(e,oNe(t)),uNe=(e,t)=>{var n={};for(var r in e)WJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&vC)for(var r of vC(e))t.indexOf(r)<0&&VJ.call(e,r)&&(n[r]=e[r]);return n};const cNe={type:"text",size:"sm",__staticSelector:"TextInput"},Xe=I.exports.forwardRef((e,t)=>{const n=_Z("TextInput",cNe,e),{inputProps:r,wrapperProps:i}=n,a=uNe(n,["inputProps","wrapperProps"]);return x(As.Wrapper,{...jN({},i),children:x(As,{...lNe(jN(jN({},r),a),{ref:t})})})});Xe.displayName="@mantine/core/TextInput";var dNe=Object.defineProperty,pNe=Object.defineProperties,hNe=Object.getOwnPropertyDescriptors,bC=Object.getOwnPropertySymbols,jJ=Object.prototype.hasOwnProperty,UJ=Object.prototype.propertyIsEnumerable,z6=(e,t,n)=>t in e?dNe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,fNe=(e,t)=>{for(var n in t||(t={}))jJ.call(t,n)&&z6(e,n,t[n]);if(bC)for(var n of bC(t))UJ.call(t,n)&&z6(e,n,t[n]);return e},mNe=(e,t)=>pNe(e,hNe(t)),gNe=(e,t)=>{var n={};for(var r in e)jJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&bC)for(var r of bC(e))t.indexOf(r)<0&&UJ.call(e,r)&&(n[r]=e[r]);return n};const yNe=e=>e||"",vNe=e=>{if(e==="-")return e;let t=e;t[0]==="."&&(t=`0${e}`);const n=parseFloat(t);return Number.isNaN(n)?"":e},B6={xs:G(10),sm:G(14),md:G(16),lg:G(18),xl:G(20)},bNe={step:1,hideControls:!1,size:"sm",precision:0,noClampOnBlur:!1,removeTrailingZeros:!1,decimalSeparator:".",formatter:yNe,parser:vNe,type:"text"},cu=I.exports.forwardRef((e,t)=>{const n=Ke("NumberInput",bNe,e),{readOnly:r,disabled:i,value:a,onChange:s,decimalSeparator:o,thousandsSeparator:l,min:u,max:c,startValue:d,step:p,stepHoldInterval:h,stepHoldDelay:m,onFocus:g,onBlur:v,onKeyDown:y,onKeyUp:b,hideControls:_,radius:k,variant:C,precision:$,removeTrailingZeros:N,defaultValue:A,noClampOnBlur:D,handlersRef:O,classNames:F,styles:E,size:z,rightSection:q,rightSectionWidth:H,formatter:J,parser:ee,inputMode:V,unstyled:Q,type:X}=n,Y=gNe(n,["readOnly","disabled","value","onChange","decimalSeparator","thousandsSeparator","min","max","startValue","step","stepHoldInterval","stepHoldDelay","onFocus","onBlur","onKeyDown","onKeyUp","hideControls","radius","variant","precision","removeTrailingZeros","defaultValue","noClampOnBlur","handlersRef","classNames","styles","size","rightSection","rightSectionWidth","formatter","parser","inputMode","unstyled","type"]),{classes:ce,cx:pe}=iNe({radius:k},{classNames:F,styles:E,unstyled:Q,name:"NumberInput",variant:C,size:z}),fe=Ge=>{if(Ge==="")return"";let rt=Ge.toFixed($);return N&&$>0&&(rt=rt.replace(new RegExp(`[0]{0,${$}}$`),""),rt.endsWith(".")&&(rt=rt.slice(0,-1))),rt},ye=Ge=>{let rt=Ge;return o&&(rt=rt.replace(".",o)),J(rt)},_e=Ge=>{let rt=Ge;return o&&(rt=rt.replaceAll(l,"").replace(o,".")),ee(rt)},Ee=Ge=>ye(fe(Ge)),[Se,Re]=I.exports.useState(typeof a=="number"?a:typeof A=="number"?A:""),[Ze,at]=I.exports.useState(()=>Ee(Se)),Je=I.exports.useRef(),[st,He]=I.exports.useState(!1),xt=(Ge,rt)=>{if(!st||rt){const xi=Ee(Ge);xi!==Ze&&at(xi)}Ge!==Se&&Re(Ge)},gt=typeof u=="number"?u:-1/0,ft=typeof c=="number"?c:1/0,Ft=I.exports.useRef();Ft.current=()=>{var Ge;let rt;Se===""?rt=(Ge=d!=null?d:u)!=null?Ge:0:rt=parseFloat(fe(Ll(Se+p,gt,ft))),xt(rt,!0),s==null||s(rt)};const Hn=I.exports.useRef();Hn.current=()=>{var Ge;let rt;Se===""?rt=(Ge=d!=null?d:u)!=null?Ge:0:rt=parseFloat(fe(Ll(Se-p,gt,ft))),xt(rt,!0),s==null||s(rt)},Oq(O,{increment:Ft.current,decrement:Hn.current}),I.exports.useEffect(()=>{st||xt(a===void 0?Se:a,!0)},[a,st]);const _t=m!==void 0&&h!==void 0,bn=I.exports.useRef(null),Jt=I.exports.useRef(0),Mt=()=>{bn.current&&window.clearTimeout(bn.current),bn.current=null,Jt.current=0},Rn=Ge=>{Ge?Ft.current():Hn.current(),Jt.current+=1},Gn=Ge=>{if(Rn(Ge),_t){const rt=typeof h=="number"?h:h(Jt.current);bn.current=window.setTimeout(()=>Gn(Ge),rt)}},wn=(Ge,rt)=>{Ge.preventDefault(),Je.current.focus(),Rn(rt),_t&&(bn.current=window.setTimeout(()=>Gn(rt),m))};I.exports.useEffect(()=>(Mt(),Mt),[]);const $n=B("div",{className:ce.rightSection,children:[x("button",{type:"button",tabIndex:-1,"aria-hidden":!0,disabled:Se>=c,className:pe(ce.control,ce.controlUp),onPointerDown:Ge=>{wn(Ge,!0)},onPointerUp:Mt,onPointerLeave:Mt,children:x(L6,{size:ke({size:z,sizes:B6}),direction:"up"})}),x("button",{type:"button",tabIndex:-1,"aria-hidden":!0,disabled:Se<=u,className:pe(ce.control,ce.controlDown),onPointerDown:Ge=>{wn(Ge,!1)},onPointerUp:Mt,onPointerLeave:Mt,children:x(L6,{size:ke({size:z,sizes:B6}),direction:"down"})})]}),cn=Ge=>{let rt=Ge;(rt[0]===`${o}`||rt[0]===".")&&(rt=`0${rt}`);const xi=parseFloat(fe(parseFloat(_e(rt)))),Tn=D?xi:Ll(xi,gt,ft),qn=Number.isNaN(Tn)?"":Tn,ii=Se!==qn;at(Ge),xt(qn),ii&&(s==null||s(qn))},Nr=Ge=>{Ge.nativeEvent.isComposing||cn(Ge.target.value)},wi=Ge=>{He(!0),g==null||g(Ge)},tr=Ge=>{He(!1),v==null||v(Ge)},$a=Ge=>{if(typeof y=="function"&&y(Ge),Ge.repeat&&_t&&(Ge.key==="ArrowUp"||Ge.key==="ArrowDown")){Ge.preventDefault();return}r||(Ge.key==="ArrowUp"?wn(Ge,!0):Ge.key==="ArrowDown"&&wn(Ge,!1))},yn=Ge=>{typeof b=="function"&&b(Ge),(Ge.key==="ArrowUp"||Ge.key==="ArrowDown")&&Mt()};return x(Xe,{...mNe(fNe({},Y),{type:X,variant:C,value:Ze,disabled:i,readOnly:r,ref:Bu(Je,t),onChange:Nr,onFocus:wi,onBlur:tr,onKeyDown:$a,onKeyUp:yn,rightSection:q||(i||r||_||C==="unstyled"?null:$n),rightSectionWidth:H!=null?H:`calc(${ke({size:z,sizes:BJ})} + ${G(1)})`,radius:k,max:c,min:u,step:p,size:z,styles:E,classNames:F,inputMode:V||nNe(p,$,i0e()),__staticSelector:"NumberInput",unstyled:Q})})});cu.displayName="@mantine/core/NumberInput";const HJ=I.exports.createContext(!1),wNe=HJ.Provider,xNe=()=>I.exports.useContext(HJ);function GJ({children:e,openDelay:t=0,closeDelay:n=0}){return x(wNe,{value:!0,children:x(ixe,{delay:{open:t,close:n},children:e})})}GJ.displayName="@mantine/core/TooltipGroup";var _Ne=Object.defineProperty,kNe=Object.defineProperties,SNe=Object.getOwnPropertyDescriptors,W6=Object.getOwnPropertySymbols,CNe=Object.prototype.hasOwnProperty,INe=Object.prototype.propertyIsEnumerable,V6=(e,t,n)=>t in e?_Ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,j6=(e,t)=>{for(var n in t||(t={}))CNe.call(t,n)&&V6(e,n,t[n]);if(W6)for(var n of W6(t))INe.call(t,n)&&V6(e,n,t[n]);return e},$Ne=(e,t)=>kNe(e,SNe(t));function TNe(e,t){if(!t)return{backgroundColor:e.colorScheme==="dark"?e.colors.gray[2]:e.colors.gray[9],color:e.colorScheme==="dark"?e.black:e.white};const n=e.fn.variant({variant:"filled",color:t,primaryFallback:!1});return{backgroundColor:n.background,color:n.color}}var NNe=it((e,{color:t,radius:n,width:r,multiline:i})=>({tooltip:$Ne(j6(j6({},e.fn.fontStyles()),TNe(e,t)),{lineHeight:e.lineHeight,fontSize:e.fontSizes.sm,borderRadius:e.fn.radius(n),padding:`calc(${e.spacing.xs} / 2) ${e.spacing.xs}`,position:"absolute",whiteSpace:i?"unset":"nowrap",pointerEvents:"none",width:r}),arrow:{backgroundColor:"inherit",border:0,zIndex:1}}));const qJ=NNe,KJ={children:"Tooltip component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported"};function ENe({offset:e,position:t}){const[n,r]=I.exports.useState(!1),i=I.exports.useRef(),{x:a,y:s,reference:o,floating:l,refs:u,update:c,placement:d}=gR({placement:t,middleware:[cR({crossAxis:!0,padding:5,rootBoundary:"document"})]}),p=d.includes("right")?e:t.includes("left")?e*-1:0,h=d.includes("bottom")?e:t.includes("top")?e*-1:0,m=I.exports.useCallback(({clientX:g,clientY:v})=>{o({getBoundingClientRect(){return{width:0,height:0,x:g,y:v,left:g+p,top:v+h,right:g,bottom:v}}})},[o]);return I.exports.useEffect(()=>{if(u.floating.current){const g=i.current;g.addEventListener("mousemove",m);const v=qc(u.floating.current);return v.forEach(y=>{y.addEventListener("scroll",c)}),()=>{g.removeEventListener("mousemove",m),v.forEach(y=>{y.removeEventListener("scroll",c)})}}},[o,u.floating.current,c,m,n]),{handleMouseMove:m,x:a,y:s,opened:n,setOpened:r,boundaryRef:i,floating:l}}var ONe=Object.defineProperty,PNe=Object.defineProperties,ANe=Object.getOwnPropertyDescriptors,wC=Object.getOwnPropertySymbols,ZJ=Object.prototype.hasOwnProperty,XJ=Object.prototype.propertyIsEnumerable,U6=(e,t,n)=>t in e?ONe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,t_=(e,t)=>{for(var n in t||(t={}))ZJ.call(t,n)&&U6(e,n,t[n]);if(wC)for(var n of wC(t))XJ.call(t,n)&&U6(e,n,t[n]);return e},n_=(e,t)=>PNe(e,ANe(t)),MNe=(e,t)=>{var n={};for(var r in e)ZJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&wC)for(var r of wC(e))t.indexOf(r)<0&&XJ.call(e,r)&&(n[r]=e[r]);return n};const RNe={refProp:"ref",withinPortal:!0,offset:10,position:"right",zIndex:Sd("popover")};function JJ(e){var t;const n=Ke("TooltipFloating",RNe,e),{children:r,refProp:i,withinPortal:a,portalProps:s,style:o,className:l,classNames:u,styles:c,unstyled:d,radius:p,color:h,label:m,offset:g,position:v,multiline:y,width:b,zIndex:_,disabled:k,variant:C}=n,$=MNe(n,["children","refProp","withinPortal","portalProps","style","className","classNames","styles","unstyled","radius","color","label","offset","position","multiline","width","zIndex","disabled","variant"]),{handleMouseMove:N,x:A,y:D,opened:O,boundaryRef:F,floating:E,setOpened:z}=ENe({offset:g,position:v}),{classes:q,cx:H}=qJ({radius:p,color:h,multiline:y,width:b},{name:"TooltipFloating",classNames:u,styles:c,unstyled:d,variant:C});if(!A1(r))throw new Error(KJ.children);const J=Bu(F,r.ref),ee=Q=>{var X,Y;(Y=(X=r.props).onMouseEnter)==null||Y.call(X,Q),N(Q),z(!0)},V=Q=>{var X,Y;(Y=(X=r.props).onMouseLeave)==null||Y.call(X,Q),z(!1)};return B(ze,{children:[x(L1,{...n_(t_({},s),{withinPortal:a}),children:x(wt,{...n_(t_({},$),{ref:E,className:H(q.tooltip,l),style:n_(t_({},o),{zIndex:_,display:!k&&O?"block":"none",top:D!=null?D:"",left:(t=Math.round(A))!=null?t:""})}),children:m})}),I.exports.cloneElement(r,n_(t_({},r.props),{[i]:J,onMouseEnter:ee,onMouseLeave:V}))]})}JJ.displayName="@mantine/core/TooltipFloating";function DNe(e){const[t,n]=I.exports.useState(!1),i=typeof e.opened=="boolean"?e.opened:t,a=xNe(),s=zu(),{delay:o,currentId:l,setCurrentId:u}=iZ(),c=I.exports.useCallback(A=>{n(A),A&&u(s)},[u,s]),{x:d,y:p,reference:h,floating:m,context:g,refs:v,update:y,placement:b,middlewareData:{arrow:{x:_,y:k}={}}}=gR({placement:e.position,open:i,onOpenChange:c,middleware:[HK(e.offset),cR({padding:8}),VK(),QK({element:e.arrowRef,padding:e.arrowOffset}),...e.inline?[UK()]:[]]}),{getReferenceProps:C,getFloatingProps:$}=gxe([rxe(g,{enabled:e.events.hover,delay:a?o:{open:e.openDelay,close:e.closeDelay},mouseOnly:!e.events.touch}),fxe(g,{enabled:e.events.focus,keyboardOnly:!0}),mxe(g,{role:"tooltip"}),hxe(g,{enabled:typeof e.opened===void 0}),axe(g,{id:s})]);return sZ({opened:i,position:e.position,positionDependencies:e.positionDependencies,floating:{refs:v,update:y}}),Xi(()=>{var A;(A=e.onPositionChange)==null||A.call(e,b)},[b]),{x:d,y:p,arrowX:_,arrowY:k,reference:h,floating:m,getFloatingProps:$,getReferenceProps:C,isGroupPhase:i&&l&&l!==s,opened:i,placement:b}}var LNe=Object.defineProperty,FNe=Object.defineProperties,zNe=Object.getOwnPropertyDescriptors,xC=Object.getOwnPropertySymbols,YJ=Object.prototype.hasOwnProperty,QJ=Object.prototype.propertyIsEnumerable,H6=(e,t,n)=>t in e?LNe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,np=(e,t)=>{for(var n in t||(t={}))YJ.call(t,n)&&H6(e,n,t[n]);if(xC)for(var n of xC(t))QJ.call(t,n)&&H6(e,n,t[n]);return e},UN=(e,t)=>FNe(e,zNe(t)),BNe=(e,t)=>{var n={};for(var r in e)YJ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&xC)for(var r of xC(e))t.indexOf(r)<0&&QJ.call(e,r)&&(n[r]=e[r]);return n};const WNe={position:"top",refProp:"ref",withinPortal:!1,inline:!1,arrowSize:4,arrowOffset:5,arrowRadius:0,arrowPosition:"side",offset:5,transitionProps:{duration:100,transition:"fade"},width:"auto",events:{hover:!0,focus:!1,touch:!1},zIndex:Sd("popover"),positionDependencies:[]},R2=I.exports.forwardRef((e,t)=>{var n;const r=I.exports.useRef(null),i=Ke("Tooltip",WNe,e),{children:a,position:s,refProp:o,label:l,openDelay:u,closeDelay:c,onPositionChange:d,opened:p,withinPortal:h,portalProps:m,radius:g,color:v,classNames:y,styles:b,unstyled:_,style:k,className:C,withArrow:$,arrowSize:N,arrowOffset:A,arrowRadius:D,arrowPosition:O,offset:F,transitionProps:E,multiline:z,width:q,events:H,zIndex:J,disabled:ee,positionDependencies:V,onClick:Q,onMouseEnter:X,onMouseLeave:Y,inline:ce,variant:pe,keepMounted:fe}=i,ye=BNe(i,["children","position","refProp","label","openDelay","closeDelay","onPositionChange","opened","withinPortal","portalProps","radius","color","classNames","styles","unstyled","style","className","withArrow","arrowSize","arrowOffset","arrowRadius","arrowPosition","offset","transitionProps","multiline","width","events","zIndex","disabled","positionDependencies","onClick","onMouseEnter","onMouseLeave","inline","variant","keepMounted"]),{classes:_e,cx:Ee,theme:Se}=qJ({radius:g,color:v,width:q,multiline:z},{name:"Tooltip",classNames:y,styles:b,unstyled:_,variant:pe}),Re=DNe({position:yZ(Se.dir,s),closeDelay:c,openDelay:u,onPositionChange:d,opened:p,events:H,arrowRef:r,arrowOffset:A,offset:F+($?N/2:0),positionDependencies:[...V,a],inline:ce});if(!A1(a))throw new Error(KJ.children);const Ze=Bu(Re.reference,a.ref,t);return B(ze,{children:[x(L1,{...UN(np({},m),{withinPortal:h}),children:x(_u,{...UN(np({keepMounted:fe,mounted:!ee&&Re.opened},E),{transition:E.transition||"fade",duration:Re.isGroupPhase?10:(n=E.duration)!=null?n:100}),children:at=>{var Je,st;return B(wt,{...np(np({},ye),Re.getFloatingProps({ref:Re.floating,className:_e.tooltip,style:UN(np(np({},k),at),{zIndex:J,top:(Je=Re.y)!=null?Je:0,left:(st=Re.x)!=null?st:0})})),children:[l,x(vR,{ref:r,arrowX:Re.arrowX,arrowY:Re.arrowY,visible:$,position:Re.placement,arrowSize:N,arrowOffset:A,arrowRadius:D,arrowPosition:O,className:_e.arrow})]})}})}),I.exports.cloneElement(a,Re.getReferenceProps(np({onClick:Q,onMouseEnter:X,onMouseLeave:Y,onMouseMove:e.onMouseMove,onPointerDown:e.onPointerDown,onPointerEnter:e.onPointerEnter,[o]:Ze,className:Ee(C,a.props.className)},a.props)))]})});R2.Group=GJ;R2.Floating=JJ;R2.displayName="@mantine/core/Tooltip";const rs=R2;function VNe({data:e,searchable:t,limit:n,searchValue:r,filter:i,value:a,filterDataOnExactSearchMatch:s}){if(!t)return e;const o=a!=null&&e.find(u=>u.value===a)||null;if(o&&!s&&(o==null?void 0:o.label)===r){if(n){if(n>=e.length)return e;const u=e.indexOf(o),c=u+n,d=c-e.length;return d>0?e.slice(u-d):e.slice(u,c)}return e}const l=[];for(let u=0;u<e.length&&(i(r,e[u])&&l.push(e[u]),!(l.length>=n));u+=1);return l}var jNe=it(()=>({input:{"&:not(:disabled)":{cursor:"pointer","&::selection":{backgroundColor:"transparent"}}}}));const UNe=jNe;var HNe=Object.defineProperty,GNe=Object.defineProperties,qNe=Object.getOwnPropertyDescriptors,_C=Object.getOwnPropertySymbols,eY=Object.prototype.hasOwnProperty,tY=Object.prototype.propertyIsEnumerable,G6=(e,t,n)=>t in e?HNe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,F0=(e,t)=>{for(var n in t||(t={}))eY.call(t,n)&&G6(e,n,t[n]);if(_C)for(var n of _C(t))tY.call(t,n)&&G6(e,n,t[n]);return e},HN=(e,t)=>GNe(e,qNe(t)),KNe=(e,t)=>{var n={};for(var r in e)eY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&_C)for(var r of _C(e))t.indexOf(r)<0&&tY.call(e,r)&&(n[r]=e[r]);return n};function ZNe(e,t){return t.label.toLowerCase().trim().includes(e.toLowerCase().trim())}function XNe(e,t){return!!e&&!t.some(n=>n.label.toLowerCase()===e.toLowerCase())}const JNe={required:!1,size:"sm",shadow:"sm",itemComponent:aR,transitionProps:{transition:"fade",duration:0},initiallyOpened:!1,filter:ZNe,maxDropdownHeight:220,searchable:!1,clearable:!1,limit:1/0,disabled:!1,creatable:!1,shouldCreate:XNe,selectOnBlur:!1,switchDirectionOnFlip:!1,filterDataOnExactSearchMatch:!1,zIndex:Sd("popover"),positionDependencies:[],dropdownPosition:"flip"},ER=I.exports.forwardRef((e,t)=>{const n=_Z("Select",JNe,e),{inputProps:r,wrapperProps:i,shadow:a,data:s,value:o,defaultValue:l,onChange:u,itemComponent:c,onKeyDown:d,onBlur:p,onFocus:h,transitionProps:m,initiallyOpened:g,unstyled:v,classNames:y,styles:b,filter:_,maxDropdownHeight:k,searchable:C,clearable:$,nothingFound:N,limit:A,disabled:D,onSearchChange:O,searchValue:F,rightSection:E,rightSectionWidth:z,creatable:q,getCreateLabel:H,shouldCreate:J,selectOnBlur:ee,onCreate:V,dropdownComponent:Q,onDropdownClose:X,onDropdownOpen:Y,withinPortal:ce,portalProps:pe,switchDirectionOnFlip:fe,zIndex:ye,name:_e,dropdownPosition:Ee,allowDeselect:Se,placeholder:Re,filterDataOnExactSearchMatch:Ze,form:at,positionDependencies:Je,readOnly:st,clearButtonProps:He,hoverOnSearchChange:xt}=n,gt=KNe(n,["inputProps","wrapperProps","shadow","data","value","defaultValue","onChange","itemComponent","onKeyDown","onBlur","onFocus","transitionProps","initiallyOpened","unstyled","classNames","styles","filter","maxDropdownHeight","searchable","clearable","nothingFound","limit","disabled","onSearchChange","searchValue","rightSection","rightSectionWidth","creatable","getCreateLabel","shouldCreate","selectOnBlur","onCreate","dropdownComponent","onDropdownClose","onDropdownOpen","withinPortal","portalProps","switchDirectionOnFlip","zIndex","name","dropdownPosition","allowDeselect","placeholder","filterDataOnExactSearchMatch","form","positionDependencies","readOnly","clearButtonProps","hoverOnSearchChange"]),{classes:ft,cx:Ft,theme:Hn}=UNe(),[_t,bn]=I.exports.useState(g),[Jt,Mt]=I.exports.useState(-1),Rn=I.exports.useRef(),Gn=I.exports.useRef({}),[wn,$n]=I.exports.useState("column"),cn=wn==="column",{scrollIntoView:Nr,targetRef:wi,scrollableRef:tr}=Mq({duration:0,offset:5,cancelable:!1,isList:!0}),$a=Se===void 0?$:Se,yn=nt=>{if(_t!==nt){bn(nt);const Et=nt?Y:X;typeof Et=="function"&&Et()}},Ge=q&&typeof H=="function";let rt=null;const xi=s.map(nt=>typeof nt=="string"?{label:nt,value:nt}:nt),Tn=Y9({data:xi}),[qn,ii,Rr]=qo({value:o,defaultValue:l,finalValue:null,onChange:u}),Kn=Tn.find(nt=>nt.value===qn),[Dn,se]=qo({value:F,defaultValue:(Kn==null?void 0:Kn.label)||"",finalValue:void 0,onChange:O}),Xn=nt=>{se(nt),C&&typeof O=="function"&&O(nt)},nr=()=>{var nt;st||(ii(null),Rr||Xn(""),(nt=Rn.current)==null||nt.focus())};I.exports.useEffect(()=>{const nt=Tn.find(Et=>Et.value===qn);nt?Xn(nt.label):(!Ge||!qn)&&Xn("")},[qn]),I.exports.useEffect(()=>{Kn&&(!C||!_t)&&Xn(Kn.label)},[Kn==null?void 0:Kn.label]);const ve=nt=>{if(!st)if($a&&(Kn==null?void 0:Kn.value)===nt.value)ii(null),yn(!1);else{if(nt.creatable&&typeof V=="function"){const Et=V(nt.value);typeof Et<"u"&&Et!==null&&ii(typeof Et=="string"?Et:Et.value)}else ii(nt.value);Rr||Xn(nt.label),Mt(-1),yn(!1),Rn.current.focus()}},Ie=VNe({data:Tn,searchable:C,limit:A,searchValue:Dn,filter:_,filterDataOnExactSearchMatch:Ze,value:qn});Ge&&J(Dn,Ie)&&(rt=H(Dn),Ie.push({label:Dn,value:Dn,creatable:!0}));const Ye=(nt,Et,Ln)=>{let Ot=nt;for(;Ln(Ot);)if(Ot=Et(Ot),!Ie[Ot].disabled)return Ot;return nt};Xi(()=>{Mt(xt&&Dn?0:-1)},[Dn,xt]);const Le=qn?Ie.findIndex(nt=>nt.value===qn):0,Lt=!st&&(Ie.length>0?_t:_t&&!!N),Zt=()=>{Mt(nt=>{var Et;const Ln=Ye(nt,Ot=>Ot-1,Ot=>Ot>0);return wi.current=Gn.current[(Et=Ie[Ln])==null?void 0:Et.value],Lt&&Nr({alignment:cn?"start":"end"}),Ln})},$t=()=>{Mt(nt=>{var Et;const Ln=Ye(nt,Ot=>Ot+1,Ot=>Ot<Ie.length-1);return wi.current=Gn.current[(Et=Ie[Ln])==null?void 0:Et.value],Lt&&Nr({alignment:cn?"end":"start"}),Ln})},St=()=>window.setTimeout(()=>{var nt;wi.current=Gn.current[(nt=Ie[Le])==null?void 0:nt.value],Nr({alignment:cn?"end":"start"})},50);Xi(()=>{Lt&&St()},[Lt]);const an=nt=>{switch(typeof d=="function"&&d(nt),nt.key){case"ArrowUp":{nt.preventDefault(),_t?cn?Zt():$t():(Mt(Le),yn(!0),St());break}case"ArrowDown":{nt.preventDefault(),_t?cn?$t():Zt():(Mt(Le),yn(!0),St());break}case"Home":{if(!C){nt.preventDefault(),_t||yn(!0);const Et=Ie.findIndex(Ln=>!Ln.disabled);Mt(Et),Lt&&Nr({alignment:cn?"end":"start"})}break}case"End":{if(!C){nt.preventDefault(),_t||yn(!0);const Et=Ie.map(Ln=>!!Ln.disabled).lastIndexOf(!1);Mt(Et),Lt&&Nr({alignment:cn?"end":"start"})}break}case"Escape":{nt.preventDefault(),yn(!1),Mt(-1);break}case" ":{C||(nt.preventDefault(),Ie[Jt]&&_t?ve(Ie[Jt]):(yn(!0),Mt(Le),St()));break}case"Enter":C||nt.preventDefault(),Ie[Jt]&&_t&&(nt.preventDefault(),ve(Ie[Jt]))}},Ue=nt=>{typeof p=="function"&&p(nt);const Et=Tn.find(Ln=>Ln.value===qn);ee&&Ie[Jt]&&_t&&ve(Ie[Jt]),Xn((Et==null?void 0:Et.label)||""),yn(!1)},Li=nt=>{typeof h=="function"&&h(nt),C&&yn(!0)},xo=nt=>{st||(Xn(nt.currentTarget.value),$&&nt.currentTarget.value===""&&ii(null),Mt(-1),yn(!0))},_s=()=>{st||(yn(!_t),qn&&!_t&&Mt(Le))};return x(As.Wrapper,{...HN(F0({},i),{__staticSelector:"Select"}),children:B(Kc,{opened:Lt,transitionProps:m,shadow:a,withinPortal:ce,portalProps:pe,__staticSelector:"Select",onDirectionChange:$n,switchDirectionOnFlip:fe,zIndex:ye,dropdownPosition:Ee,positionDependencies:[...Je,Dn],classNames:y,styles:b,unstyled:v,variant:r.variant,children:[x(Kc.Target,{children:B("div",{role:"combobox","aria-haspopup":"listbox","aria-owns":Lt?`${r.id}-items`:null,"aria-controls":r.id,"aria-expanded":Lt,onMouseLeave:()=>Mt(-1),tabIndex:-1,children:[x("input",{type:"hidden",name:_e,value:qn||"",form:at,disabled:D}),x(As,{...F0(HN(F0(F0({autoComplete:"off",type:"search"},r),gt),{ref:Bu(t,Rn),onKeyDown:an,__staticSelector:"Select",value:Dn,placeholder:Re,onChange:xo,"aria-autocomplete":"list","aria-controls":Lt?`${r.id}-items`:null,"aria-activedescendant":Jt>=0?`${r.id}-${Jt}`:null,onMouseDown:_s,onBlur:Ue,onFocus:Li,readOnly:!C||st,disabled:D,"data-mantine-stop-propagation":Lt,name:null,classNames:HN(F0({},y),{input:Ft({[ft.input]:!C},y==null?void 0:y.input)})}),LJ({theme:Hn,rightSection:E,rightSectionWidth:z,styles:b,size:r.size,shouldClear:$&&!!Kn,onClear:nr,error:i.error,clearButtonProps:He,disabled:D,readOnly:st}))})]})}),x(Kc.Dropdown,{component:Q||P2,maxHeight:k,direction:wn,id:r.id,innerRef:tr,__staticSelector:"Select",classNames:y,styles:b,children:x(iR,{data:Ie,hovered:Jt,classNames:y,styles:b,isItemSelected:nt=>nt===qn,uuid:r.id,__staticSelector:"Select",onItemHover:Mt,onItemSelect:ve,itemsRefs:Gn,itemComponent:c,size:r.size,nothingFound:N,creatable:Ge&&!!rt,createLabel:rt,"aria-label":i.label,unstyled:v,variant:r.variant})})]})})});ER.displayName="@mantine/core/Select";function YNe(e,t){if(t.length===0)return t;const n="maxWidth"in t[0]?"maxWidth":"minWidth",r=[...t].sort((i,a)=>Go(ke({size:a[n],sizes:e.breakpoints}))-Go(ke({size:i[n],sizes:e.breakpoints})));return n==="minWidth"?r.reverse():r}var QNe=Object.defineProperty,q6=Object.getOwnPropertySymbols,eEe=Object.prototype.hasOwnProperty,tEe=Object.prototype.propertyIsEnumerable,K6=(e,t,n)=>t in e?QNe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nEe=(e,t)=>{for(var n in t||(t={}))eEe.call(t,n)&&K6(e,n,t[n]);if(q6)for(var n of q6(t))tEe.call(t,n)&&K6(e,n,t[n]);return e},rEe=it((e,{spacing:t,breakpoints:n,cols:r,verticalSpacing:i})=>{const a=i!=null,s=YNe(e,n).reduce((o,l)=>{var u,c;const d="maxWidth"in l?"max-width":"min-width",p=ke({size:d==="max-width"?l.maxWidth:l.minWidth,sizes:e.breakpoints,units:"em"}),h=Go(p)-(d==="max-width"?1:0);return o[`@media (${d}: ${Gc(h)})`]={gridTemplateColumns:`repeat(${l.cols}, minmax(0, 1fr))`,gap:`${ke({size:(u=l.verticalSpacing)!=null?u:a?i:t,sizes:e.spacing})} ${ke({size:(c=l.spacing)!=null?c:t,sizes:e.spacing})}`},o},{});return{root:nEe({boxSizing:"border-box",display:"grid",gridTemplateColumns:`repeat(${r}, minmax(0, 1fr))`,gap:`${ke({size:a?i:t,sizes:e.spacing})} ${ke({size:t,sizes:e.spacing})}`},s)}});const iEe=rEe;var aEe=Object.defineProperty,kC=Object.getOwnPropertySymbols,nY=Object.prototype.hasOwnProperty,rY=Object.prototype.propertyIsEnumerable,Z6=(e,t,n)=>t in e?aEe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,sEe=(e,t)=>{for(var n in t||(t={}))nY.call(t,n)&&Z6(e,n,t[n]);if(kC)for(var n of kC(t))rY.call(t,n)&&Z6(e,n,t[n]);return e},oEe=(e,t)=>{var n={};for(var r in e)nY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&kC)for(var r of kC(e))t.indexOf(r)<0&&rY.call(e,r)&&(n[r]=e[r]);return n};const lEe={breakpoints:[],cols:1,spacing:"md"},iY=I.exports.forwardRef((e,t)=>{const n=Ke("SimpleGrid",lEe,e),{className:r,breakpoints:i,cols:a,spacing:s,verticalSpacing:o,children:l,unstyled:u,variant:c}=n,d=oEe(n,["className","breakpoints","cols","spacing","verticalSpacing","children","unstyled","variant"]),{classes:p,cx:h}=iEe({breakpoints:i,cols:a,spacing:s,verticalSpacing:o},{name:"SimpleGrid",unstyled:u,variant:c});return x(wt,{...sEe({className:h(p.root,r),ref:t},d),children:l})});iY.displayName="@mantine/core/SimpleGrid";function aY({value:e,min:t,max:n}){const r=(e-t)/(n-t)*100;return Math.min(Math.max(r,0),100)}function uEe({value:e,containerWidth:t,min:n,max:r,step:i,precision:a}){const o=(t?Math.min(Math.max(e,0),t)/t:e)*(r-n),l=(o!==0?Math.round(o/i)*i:0)+n,u=Math.max(l,n);return a!==void 0?Number(u.toFixed(a)):u}var cEe=Object.defineProperty,dEe=Object.defineProperties,pEe=Object.getOwnPropertyDescriptors,X6=Object.getOwnPropertySymbols,hEe=Object.prototype.hasOwnProperty,fEe=Object.prototype.propertyIsEnumerable,J6=(e,t,n)=>t in e?cEe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mEe=(e,t)=>{for(var n in t||(t={}))hEe.call(t,n)&&J6(e,n,t[n]);if(X6)for(var n of X6(t))fEe.call(t,n)&&J6(e,n,t[n]);return e},gEe=(e,t)=>dEe(e,pEe(t));const ca={xs:G(4),sm:G(6),md:G(8),lg:G(10),xl:G(12)};var yEe=it(e=>({root:gEe(mEe({},e.fn.fontStyles()),{WebkitTapHighlightColor:"transparent",outline:0,display:"flex",flexDirection:"column",alignItems:"center",touchAction:"none",position:"relative"})}));const vEe=yEe;var bEe=Object.defineProperty,wEe=Object.defineProperties,xEe=Object.getOwnPropertyDescriptors,Y6=Object.getOwnPropertySymbols,_Ee=Object.prototype.hasOwnProperty,kEe=Object.prototype.propertyIsEnumerable,Q6=(e,t,n)=>t in e?bEe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,SEe=(e,t)=>{for(var n in t||(t={}))_Ee.call(t,n)&&Q6(e,n,t[n]);if(Y6)for(var n of Y6(t))kEe.call(t,n)&&Q6(e,n,t[n]);return e},CEe=(e,t)=>wEe(e,xEe(t)),IEe=it((e,{color:t,disabled:n,thumbSize:r},{size:i})=>({label:{position:"absolute",top:G(-36),backgroundColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[9],fontSize:e.fontSizes.xs,color:e.white,padding:`calc(${e.spacing.xs} / 2)`,borderRadius:e.radius.sm,whiteSpace:"nowrap",pointerEvents:"none",userSelect:"none",touchAction:"none"},thumb:CEe(SEe({},e.fn.focusStyles()),{boxSizing:"border-box",position:"absolute",display:n?"none":"flex",height:r?G(r):`calc(${ke({sizes:ca,size:i})} * 2)`,width:r?G(r):`calc(${ke({sizes:ca,size:i})} * 2)`,backgroundColor:e.colorScheme==="dark"?e.fn.themeColor(t,e.fn.primaryShade()):e.white,border:`${G(4)} solid ${e.colorScheme==="dark"?e.white:e.fn.themeColor(t,e.fn.primaryShade())}`,color:e.colorScheme==="dark"?e.white:e.fn.themeColor(t,e.fn.primaryShade()),transform:"translate(-50%, -50%)",top:"50%",cursor:"pointer",borderRadius:1e3,alignItems:"center",justifyContent:"center",transitionDuration:"100ms",transitionProperty:"box-shadow, transform",transitionTimingFunction:e.transitionTimingFunction,zIndex:3,userSelect:"none",touchAction:"none"}),dragging:{transform:"translate(-50%, -50%) scale(1.05)",boxShadow:e.shadows.sm}}));const $Ee=IEe,sY=I.exports.forwardRef(({max:e,min:t,value:n,position:r,label:i,dragging:a,onMouseDown:s,onKeyDownCapture:o,color:l,classNames:u,styles:c,size:d,labelTransition:p,labelTransitionDuration:h,labelTransitionTimingFunction:m,labelAlwaysOn:g,thumbLabel:v,onFocus:y,onBlur:b,showLabelOnHover:_,isHovered:k,children:C=null,disabled:$,unstyled:N,thumbSize:A,variant:D},O)=>{const{classes:F,cx:E,theme:z}=$Ee({color:l,disabled:$,thumbSize:A},{name:"Slider",classNames:u,styles:c,unstyled:N,variant:D,size:d}),[q,H]=I.exports.useState(!1),J=g||a||q||_&&k;return B(wt,{tabIndex:0,role:"slider","aria-label":v,"aria-valuemax":e,"aria-valuemin":t,"aria-valuenow":n,ref:O,className:E(F.thumb,{[F.dragging]:a}),onFocus:()=>{H(!0),typeof y=="function"&&y()},onBlur:()=>{H(!1),typeof b=="function"&&b()},onTouchStart:s,onMouseDown:s,onKeyDownCapture:o,onClick:ee=>ee.stopPropagation(),style:{[z.dir==="rtl"?"right":"left"]:`${r}%`},children:[C,x(_u,{mounted:i!=null&&J,duration:h,transition:p,timingFunction:m||z.transitionTimingFunction,children:ee=>x("div",{style:ee,className:F.label,children:i})})]})});sY.displayName="@mantine/core/SliderThumb";function TEe({mark:e,offset:t,value:n,inverted:r=!1}){return r?typeof t=="number"&&e.value<=t||e.value>=n:typeof t=="number"?e.value>=t&&e.value<=n:e.value<=n}var NEe=it((e,{color:t,disabled:n,thumbSize:r},{size:i})=>({marksContainer:{position:"absolute",right:r?G(r/2):ke({sizes:ca,size:i}),left:r?G(r/2):ke({sizes:ca,size:i}),"&:has(~ input:disabled)":{"& .mantine-Slider-markFilled":{border:`${G(2)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2]}`,borderColor:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[4]}}},markWrapper:{position:"absolute",top:`calc(${G(ke({sizes:ca,size:i}))} / 2)`,zIndex:2,height:0},mark:{boxSizing:"border-box",border:`${G(2)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2]}`,height:ke({sizes:ca,size:i}),width:ke({sizes:ca,size:i}),borderRadius:1e3,transform:`translateX(calc(-${ke({sizes:ca,size:i})} / 2))`,backgroundColor:e.white,pointerEvents:"none"},markFilled:{borderColor:n?e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[4]:e.fn.variant({variant:"filled",color:t}).background},markLabel:{transform:`translate(-50%, calc(${e.spacing.xs} / 2))`,fontSize:e.fontSizes.sm,color:e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[6],whiteSpace:"nowrap",cursor:"pointer",userSelect:"none"}}));const EEe=NEe;function oY({marks:e,color:t,size:n,thumbSize:r,min:i,max:a,value:s,classNames:o,styles:l,offset:u,onChange:c,disabled:d,unstyled:p,inverted:h,variant:m}){const{classes:g,cx:v}=EEe({color:t,disabled:d,thumbSize:r},{name:"Slider",classNames:o,styles:l,unstyled:p,variant:m,size:n}),y=e.map((b,_)=>B(wt,{className:g.markWrapper,sx:{left:`${aY({value:b.value,min:i,max:a})}%`},children:[x("div",{className:v(g.mark,{[g.markFilled]:TEe({mark:b,value:s,offset:u,inverted:h})})}),b.label&&x("div",{className:g.markLabel,onMouseDown:k=>{k.stopPropagation(),!d&&c(b.value)},onTouchStart:k=>{k.stopPropagation(),!d&&c(b.value)},children:b.label})]},_));return x("div",{className:g.marksContainer,children:y})}oY.displayName="@mantine/core/SliderMarks";var OEe=it((e,{radius:t,color:n,disabled:r,inverted:i,thumbSize:a},{size:s})=>({trackContainer:{display:"flex",alignItems:"center",width:"100%",height:`calc(${ke({sizes:ca,size:s})} * 2)`,cursor:"pointer","&:has(~ input:disabled)":{"&":{pointerEvents:"none"},"& .mantine-Slider-thumb":{display:"none"},"& .mantine-Slider-track::before":{content:'""',backgroundColor:i?e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[4]:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2]},"& .mantine-Slider-bar":{backgroundColor:i?e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2]:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[4]}}},track:{position:"relative",height:ke({sizes:ca,size:s}),width:"100%",marginRight:a?G(a/2):ke({size:s,sizes:ca}),marginLeft:a?G(a/2):ke({size:s,sizes:ca}),"&::before":{content:'""',position:"absolute",top:0,bottom:0,borderRadius:e.fn.radius(t),right:`calc(${a?G(a/2):ke({size:s,sizes:ca})} * -1)`,left:`calc(${a?G(a/2):ke({size:s,sizes:ca})} * -1)`,backgroundColor:i?r?e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[4]:e.fn.variant({variant:"filled",color:n}).background:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2],zIndex:0}},bar:{position:"absolute",zIndex:1,top:0,bottom:0,backgroundColor:i?e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2]:r?e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[4]:e.fn.variant({variant:"filled",color:n}).background,borderRadius:e.fn.radius(t)}}));const PEe=OEe;var AEe=Object.defineProperty,MEe=Object.defineProperties,REe=Object.getOwnPropertyDescriptors,SC=Object.getOwnPropertySymbols,lY=Object.prototype.hasOwnProperty,uY=Object.prototype.propertyIsEnumerable,ej=(e,t,n)=>t in e?AEe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,tj=(e,t)=>{for(var n in t||(t={}))lY.call(t,n)&&ej(e,n,t[n]);if(SC)for(var n of SC(t))uY.call(t,n)&&ej(e,n,t[n]);return e},DEe=(e,t)=>MEe(e,REe(t)),LEe=(e,t)=>{var n={};for(var r in e)lY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&SC)for(var r of SC(e))t.indexOf(r)<0&&uY.call(e,r)&&(n[r]=e[r]);return n};function cY(e){var t=e,{filled:n,size:r,thumbSize:i,color:a,classNames:s,styles:o,radius:l,children:u,offset:c,disabled:d,marksOffset:p,unstyled:h,inverted:m,variant:g,containerProps:v}=t,y=LEe(t,["filled","size","thumbSize","color","classNames","styles","radius","children","offset","disabled","marksOffset","unstyled","inverted","variant","containerProps"]);const{classes:b}=PEe({color:a,radius:l,disabled:d,inverted:m,thumbSize:i},{name:"Slider",classNames:s,styles:o,unstyled:h,variant:g,size:r});return B(ze,{children:[x("div",{...tj({className:b.trackContainer},v),children:B("div",{className:b.track,children:[x(wt,{className:b.bar,sx:{left:`calc(${c}% - ${i?G(i/2):ke({size:r,sizes:ca})})`,width:`calc(${n}% + 2 * ${i?G(i/2):ke({size:r,sizes:ca})})`}}),u]})}),x(oY,{...DEe(tj({},y),{size:r,thumbSize:i,color:a,offset:p,classNames:s,styles:o,disabled:d,unstyled:h,inverted:m,variant:g})})]})}cY.displayName="@mantine/core/SliderTrack";var FEe=Object.defineProperty,zEe=Object.defineProperties,BEe=Object.getOwnPropertyDescriptors,CC=Object.getOwnPropertySymbols,dY=Object.prototype.hasOwnProperty,pY=Object.prototype.propertyIsEnumerable,nj=(e,t,n)=>t in e?FEe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,WEe=(e,t)=>{for(var n in t||(t={}))dY.call(t,n)&&nj(e,n,t[n]);if(CC)for(var n of CC(t))pY.call(t,n)&&nj(e,n,t[n]);return e},VEe=(e,t)=>zEe(e,BEe(t)),jEe=(e,t)=>{var n={};for(var r in e)dY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&CC)for(var r of CC(e))t.indexOf(r)<0&&pY.call(e,r)&&(n[r]=e[r]);return n};const hY=I.exports.forwardRef((e,t)=>{var n=e,{className:r,size:i,classNames:a,styles:s,disabled:o,unstyled:l,variant:u}=n,c=jEe(n,["className","size","classNames","styles","disabled","unstyled","variant"]);const{classes:d,cx:p}=vEe(null,{name:"Slider",classNames:a,styles:s,unstyled:l,variant:u,size:i});return x(wt,{...VEe(WEe({},c),{tabIndex:-1,className:p(d.root,r),ref:t})})});hY.displayName="@mantine/core/SliderRoot";function r_(e,t){return parseFloat(e.toFixed(t))}function UEe(e){if(!e)return 0;const t=e.toString().split(".");return t.length>1?t[1].length:0}var HEe=Object.defineProperty,GEe=Object.defineProperties,qEe=Object.getOwnPropertyDescriptors,IC=Object.getOwnPropertySymbols,fY=Object.prototype.hasOwnProperty,mY=Object.prototype.propertyIsEnumerable,rj=(e,t,n)=>t in e?HEe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,KEe=(e,t)=>{for(var n in t||(t={}))fY.call(t,n)&&rj(e,n,t[n]);if(IC)for(var n of IC(t))mY.call(t,n)&&rj(e,n,t[n]);return e},ZEe=(e,t)=>GEe(e,qEe(t)),XEe=(e,t)=>{var n={};for(var r in e)fY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&IC)for(var r of IC(e))t.indexOf(r)<0&&mY.call(e,r)&&(n[r]=e[r]);return n};const JEe={size:"md",radius:"xl",min:0,max:100,step:1,marks:[],label:e=>e,labelTransition:"skew-down",labelTransitionDuration:0,labelAlwaysOn:!1,thumbLabel:"",showLabelOnHover:!0,disabled:!1,scale:e=>e},$C=I.exports.forwardRef((e,t)=>{const n=Ke("Slider",JEe,e),{classNames:r,styles:i,color:a,value:s,onChange:o,onChangeEnd:l,size:u,radius:c,min:d,max:p,step:h,precision:m,defaultValue:g,name:v,marks:y,label:b,labelTransition:_,labelTransitionDuration:k,labelTransitionTimingFunction:C,labelAlwaysOn:$,thumbLabel:N,showLabelOnHover:A,thumbChildren:D,disabled:O,unstyled:F,thumbSize:E,scale:z,inverted:q,variant:H}=n,J=XEe(n,["classNames","styles","color","value","onChange","onChangeEnd","size","radius","min","max","step","precision","defaultValue","name","marks","label","labelTransition","labelTransitionDuration","labelTransitionTimingFunction","labelAlwaysOn","thumbLabel","showLabelOnHover","thumbChildren","disabled","unstyled","thumbSize","scale","inverted","variant"]),ee=m!=null?m:UEe(h),V=Ka(),[Q,X]=I.exports.useState(!1),[Y,ce]=qo({value:typeof s=="number"?Ll(s,d,p):s,defaultValue:typeof g=="number"?Ll(g,d,p):g,finalValue:Ll(0,d,p),onChange:o}),pe=I.exports.useRef(Y),fe=I.exports.useRef(),ye=I.exports.useRef(),_e=aY({value:Y,min:d,max:p}),Ee=z(Y),Se=typeof b=="function"?b(Ee):b,Re=I.exports.useCallback(({x:st})=>{if(!O){const He=uEe({value:st,min:d,max:p,step:h,precision:ee});ce(He),pe.current=He}},[O,d,p,h,ee,ce]),{ref:Ze,active:at}=tR(Re,{onScrubEnd:()=>l==null?void 0:l(pe.current)},V.dir),Je=st=>{if(!O)switch(st.key){case"ArrowUp":{st.preventDefault(),ye.current.focus();const He=r_(Math.min(Math.max(Y+h,d),p),ee);l==null||l(He),ce(He);break}case"ArrowRight":{st.preventDefault(),ye.current.focus();const He=r_(Math.min(Math.max(V.dir==="rtl"?Y-h:Y+h,d),p),ee);l==null||l(He),ce(He);break}case"ArrowDown":{st.preventDefault(),ye.current.focus();const He=r_(Math.min(Math.max(Y-h,d),p),ee);l==null||l(He),ce(He);break}case"ArrowLeft":{st.preventDefault(),ye.current.focus();const He=r_(Math.min(Math.max(V.dir==="rtl"?Y+h:Y-h,d),p),ee);l==null||l(He),ce(He);break}case"Home":{st.preventDefault(),ye.current.focus(),l==null||l(d),ce(d);break}case"End":{st.preventDefault(),ye.current.focus(),l==null||l(p),ce(p);break}}};return B(hY,{...ZEe(KEe({},J),{ref:Bu(t,fe),onKeyDownCapture:Je,onMouseDownCapture:()=>{var st;return(st=fe.current)==null?void 0:st.focus()},size:u,classNames:r,styles:i,disabled:O,unstyled:F,variant:H}),children:[x(cY,{inverted:q,offset:0,filled:_e,marks:y,size:u,thumbSize:E,radius:c,color:a,min:d,max:p,value:Ee,onChange:ce,classNames:r,styles:i,disabled:O,unstyled:F,variant:H,containerProps:{ref:Ze,onMouseEnter:A?()=>X(!0):void 0,onMouseLeave:A?()=>X(!1):void 0},children:x(sY,{max:p,min:d,value:Ee,position:_e,dragging:at,color:a,size:u,label:Se,ref:ye,labelTransition:_,labelTransitionDuration:k,labelTransitionTimingFunction:C,labelAlwaysOn:$,classNames:r,styles:i,thumbLabel:N,showLabelOnHover:A,isHovered:Q,disabled:O,unstyled:F,thumbSize:E,variant:H,children:D})}),x("input",{type:"hidden",name:v,value:Ee})]})});$C.displayName="@mantine/core/Slider";var YEe=it((e,{spacing:t,align:n,justify:r})=>({root:{display:"flex",flexDirection:"column",alignItems:n,justifyContent:r,gap:ke({size:t,sizes:e.spacing})}}));const QEe=YEe;var eOe=Object.defineProperty,TC=Object.getOwnPropertySymbols,gY=Object.prototype.hasOwnProperty,yY=Object.prototype.propertyIsEnumerable,ij=(e,t,n)=>t in e?eOe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,tOe=(e,t)=>{for(var n in t||(t={}))gY.call(t,n)&&ij(e,n,t[n]);if(TC)for(var n of TC(t))yY.call(t,n)&&ij(e,n,t[n]);return e},nOe=(e,t)=>{var n={};for(var r in e)gY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&TC)for(var r of TC(e))t.indexOf(r)<0&&yY.call(e,r)&&(n[r]=e[r]);return n};const rOe={spacing:"md",align:"stretch",justify:"flex-start"},Ce=I.exports.forwardRef((e,t)=>{const n=Ke("Stack",rOe,e),{spacing:r,className:i,align:a,justify:s,unstyled:o,variant:l}=n,u=nOe(n,["spacing","className","align","justify","unstyled","variant"]),{classes:c,cx:d}=QEe({spacing:r,align:a,justify:s},{name:"Stack",unstyled:o,variant:l});return x(wt,{...tOe({className:d(c.root,i),ref:t},u)})});Ce.displayName="@mantine/core/Stack";const vY=I.exports.createContext(null),iOe=vY.Provider,aOe=()=>I.exports.useContext(vY);var sOe=Object.defineProperty,NC=Object.getOwnPropertySymbols,bY=Object.prototype.hasOwnProperty,wY=Object.prototype.propertyIsEnumerable,aj=(e,t,n)=>t in e?sOe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,sj=(e,t)=>{for(var n in t||(t={}))bY.call(t,n)&&aj(e,n,t[n]);if(NC)for(var n of NC(t))wY.call(t,n)&&aj(e,n,t[n]);return e},oOe=(e,t)=>{var n={};for(var r in e)bY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&NC)for(var r of NC(e))t.indexOf(r)<0&&wY.call(e,r)&&(n[r]=e[r]);return n};const lOe={size:"sm"},xY=I.exports.forwardRef((e,t)=>{const n=Ke("SwitchGroup",lOe,e),{children:r,value:i,defaultValue:a,onChange:s,size:o,wrapperProps:l}=n,u=oOe(n,["children","value","defaultValue","onChange","size","wrapperProps"]),[c,d]=qo({value:i,defaultValue:a,finalValue:[],onChange:s});return x(iOe,{value:{value:c,onChange:h=>{const m=h.currentTarget.value;d(c.includes(m)?c.filter(g=>g!==m):[...c,m])},size:o},children:x(As.Wrapper,{...sj(sj({labelElement:"div",size:o,__staticSelector:"SwitchGroup",ref:t},l),u),children:r})})});xY.displayName="@mantine/core/SwitchGroup";var uOe=Object.defineProperty,cOe=Object.defineProperties,dOe=Object.getOwnPropertyDescriptors,oj=Object.getOwnPropertySymbols,pOe=Object.prototype.hasOwnProperty,hOe=Object.prototype.propertyIsEnumerable,lj=(e,t,n)=>t in e?uOe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,fOe=(e,t)=>{for(var n in t||(t={}))pOe.call(t,n)&&lj(e,n,t[n]);if(oj)for(var n of oj(t))hOe.call(t,n)&&lj(e,n,t[n]);return e},mOe=(e,t)=>cOe(e,dOe(t));const gOe={xs:G(16),sm:G(20),md:G(24),lg:G(30),xl:G(36)},yOe={xs:G(32),sm:G(38),md:G(46),lg:G(56),xl:G(72)},vOe={xs:G(12),sm:G(14),md:G(18),lg:G(22),xl:G(28)},bOe={xs:G(5),sm:G(6),md:G(7),lg:G(9),xl:G(11)},wOe={xs:G(4),sm:G(5),md:G(6),lg:G(8),xl:G(10)};var xOe=it((e,{radius:t,color:n,labelPosition:r,error:i},{size:a})=>{const s=ke({size:a,sizes:vOe}),o=ke({size:t,sizes:e.radius}),l=e.fn.variant({variant:"filled",color:n}),u=ke({size:a,sizes:yOe}),c=G(a==="xs"?1:2),d=e.fn.variant({variant:"filled",color:"red"}).background;return{root:{position:"relative"},input:{height:0,width:0,overflow:"hidden",whiteSpace:"nowrap",padding:0,WebkitClipPath:"inset(50%)",clipPath:"inset(50%)",position:"absolute"},track:mOe(fOe({},e.fn.focusStyles("input:focus + &")),{cursor:e.cursorType,overflow:"hidden",WebkitTapHighlightColor:"transparent",position:"relative",borderRadius:o,backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[2],border:`${G(1)} solid ${i?d:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]}`,height:ke({size:a,sizes:gOe}),minWidth:u,margin:0,transitionProperty:"background-color, border-color",transitionTimingFunction:e.transitionTimingFunction,transitionDuration:"150ms",boxSizing:"border-box",appearance:"none",display:"flex",alignItems:"center",fontSize:ke({size:a,sizes:bOe}),fontWeight:600,order:r==="left"?2:1,userSelect:"none",zIndex:0,lineHeight:0,color:e.colorScheme==="dark"?e.colors.dark[1]:e.colors.gray[6],transition:`color 150ms ${e.transitionTimingFunction}`,"input:checked + &":{backgroundColor:l.background,borderColor:l.background,color:e.white,transition:`color 150ms ${e.transitionTimingFunction}`},"input:disabled + &":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2],borderColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2],cursor:"not-allowed",pointerEvents:"none"}}),thumb:{position:"absolute",zIndex:1,borderRadius:o,boxSizing:"border-box",display:"flex",backgroundColor:e.white,height:s,width:s,border:`${G(1)} solid ${e.colorScheme==="dark"?e.white:e.colors.gray[3]}`,left:c,transition:`left 150ms ${e.transitionTimingFunction}`,"& > *":{margin:"auto"},"@media (prefers-reduced-motion)":{transitionDuration:e.respectReducedMotion?"0ms":""},"input:checked + * > &":{left:`calc(100% - ${s} - ${c})`,borderColor:e.white},"input:disabled + * > &":{borderColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2],backgroundColor:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[0]}},trackLabel:{height:"100%",display:"grid",placeContent:"center",minWidth:`calc(${u} - ${s})`,paddingInline:ke({size:a,sizes:wOe}),marginLeft:`calc(${s} + ${c})`,transition:`margin 150ms ${e.transitionTimingFunction}`,"input:checked + * > &":{marginLeft:0,marginRight:`calc(${s} + ${c})`}}}});const _Oe=xOe;var kOe=Object.defineProperty,SOe=Object.defineProperties,COe=Object.getOwnPropertyDescriptors,EC=Object.getOwnPropertySymbols,_Y=Object.prototype.hasOwnProperty,kY=Object.prototype.propertyIsEnumerable,uj=(e,t,n)=>t in e?kOe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,GN=(e,t)=>{for(var n in t||(t={}))_Y.call(t,n)&&uj(e,n,t[n]);if(EC)for(var n of EC(t))kY.call(t,n)&&uj(e,n,t[n]);return e},IOe=(e,t)=>SOe(e,COe(t)),$Oe=(e,t)=>{var n={};for(var r in e)_Y.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&EC)for(var r of EC(e))t.indexOf(r)<0&&kY.call(e,r)&&(n[r]=e[r]);return n};const TOe={offLabel:"",onLabel:"",size:"sm",radius:"xl",error:!1},_g=I.exports.forwardRef((e,t)=>{var n;const r=Ke("Switch",TOe,e),{className:i,color:a,label:s,offLabel:o,onLabel:l,id:u,style:c,size:d,radius:p,wrapperProps:h,children:m,unstyled:g,styles:v,classNames:y,thumbIcon:b,sx:_,checked:k,defaultChecked:C,onChange:$,labelPosition:N,description:A,error:D,disabled:O,variant:F}=r,E=$Oe(r,["className","color","label","offLabel","onLabel","id","style","size","radius","wrapperProps","children","unstyled","styles","classNames","thumbIcon","sx","checked","defaultChecked","onChange","labelPosition","description","error","disabled","variant"]),z=aOe(),q=(z==null?void 0:z.size)||d,{classes:H,cx:J}=_Oe({color:a,radius:p,labelPosition:N,error:!!D},{name:"Switch",classNames:y,styles:v,unstyled:g,size:q,variant:F}),{systemStyles:ee,rest:V}=Cd(E),Q=zu(u),X=z?{checked:z.value.includes(V.value),onChange:z.onChange}:{},[Y,ce]=qo({value:(n=X.checked)!=null?n:k,defaultValue:C,finalValue:!1});return B(CR,{...GN(GN({className:J(i,H.root),sx:_,style:c,id:Q,size:(z==null?void 0:z.size)||d,labelPosition:N,label:s,description:A,error:D,disabled:O,__staticSelector:"Switch",classNames:y,styles:v,unstyled:g,"data-checked":X.checked||void 0,variant:F},ee),h),children:[x("input",{...IOe(GN({},V),{disabled:O,checked:Y,onChange:pe=>{z?X.onChange(pe):$==null||$(pe),ce(pe.currentTarget.checked)},id:Q,ref:t,type:"checkbox",className:H.input})}),B("label",{htmlFor:Q,className:H.track,children:[x("div",{className:H.thumb,children:b}),x("div",{className:H.trackLabel,children:Y?l:o})]})]})});_g.displayName="@mantine/core/Switch";_g.Group=xY;var NOe=Object.defineProperty,EOe=Object.defineProperties,OOe=Object.getOwnPropertyDescriptors,cj=Object.getOwnPropertySymbols,POe=Object.prototype.hasOwnProperty,AOe=Object.prototype.propertyIsEnumerable,dj=(e,t,n)=>t in e?NOe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,MOe=(e,t)=>{for(var n in t||(t={}))POe.call(t,n)&&dj(e,n,t[n]);if(cj)for(var n of cj(t))AOe.call(t,n)&&dj(e,n,t[n]);return e},ROe=(e,t)=>EOe(e,OOe(t)),DOe=it((e,{captionSide:t,horizontalSpacing:n,verticalSpacing:r,fontSize:i,withBorder:a,withColumnBorders:s})=>{const o=`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]}`;return{root:ROe(MOe({},e.fn.fontStyles()),{width:"100%",borderCollapse:"collapse",captionSide:t,color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,lineHeight:e.lineHeight,border:a?o:void 0,"& > caption":{marginTop:t==="top"?0:e.spacing.xs,marginBottom:t==="bottom"?0:e.spacing.xs,fontSize:e.fontSizes.sm,color:e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[6]},"& > thead > tr > th, & > tfoot > tr > th, & > tbody > tr > th":{textAlign:"left",fontWeight:"bold",color:e.colorScheme==="dark"?e.colors.dark[0]:e.colors.gray[7],fontSize:ke({size:i,sizes:e.fontSizes}),padding:`${ke({size:r,sizes:e.spacing})} ${ke({size:n,sizes:e.spacing})}`},"& > thead > tr > th":{borderBottom:o},"& > tfoot > tr > th, & > tbody > tr > th":{borderTop:o},"& > tbody > tr > td":{padding:`${ke({size:r,sizes:e.spacing})} ${ke({size:n,sizes:e.spacing})}`,borderTop:o,fontSize:ke({size:i,sizes:e.fontSizes})},"& > tbody > tr:first-of-type > td, & > tbody > tr:first-of-type > th":{borderTop:"none"},"& > thead > tr > th, & > tbody > tr > td":{borderRight:s?o:"none","&:last-of-type":{borderRight:"none",borderLeft:s?o:"none"}},"& > tbody > tr > th":{borderRight:s?o:"none"},"&[data-striped] > tbody > tr:nth-of-type(odd)":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[0]},"&[data-hover] > tbody > tr":e.fn.hover({backgroundColor:e.colorScheme==="dark"?e.colors.dark[5]:e.colors.gray[1]})})}});const LOe=DOe;var FOe=Object.defineProperty,zOe=Object.defineProperties,BOe=Object.getOwnPropertyDescriptors,OC=Object.getOwnPropertySymbols,SY=Object.prototype.hasOwnProperty,CY=Object.prototype.propertyIsEnumerable,pj=(e,t,n)=>t in e?FOe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,WOe=(e,t)=>{for(var n in t||(t={}))SY.call(t,n)&&pj(e,n,t[n]);if(OC)for(var n of OC(t))CY.call(t,n)&&pj(e,n,t[n]);return e},VOe=(e,t)=>zOe(e,BOe(t)),jOe=(e,t)=>{var n={};for(var r in e)SY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&OC)for(var r of OC(e))t.indexOf(r)<0&&CY.call(e,r)&&(n[r]=e[r]);return n};const UOe={striped:!1,highlightOnHover:!1,captionSide:"top",horizontalSpacing:"xs",fontSize:"sm",verticalSpacing:7,withBorder:!1,withColumnBorders:!1},IY=I.exports.forwardRef((e,t)=>{const n=Ke("Table",UOe,e),{className:r,children:i,striped:a,highlightOnHover:s,captionSide:o,horizontalSpacing:l,verticalSpacing:u,fontSize:c,unstyled:d,withBorder:p,withColumnBorders:h,variant:m}=n,g=jOe(n,["className","children","striped","highlightOnHover","captionSide","horizontalSpacing","verticalSpacing","fontSize","unstyled","withBorder","withColumnBorders","variant"]),{classes:v,cx:y}=LOe({captionSide:o,verticalSpacing:u,horizontalSpacing:l,fontSize:c,withBorder:p,withColumnBorders:h},{unstyled:d,name:"Table",variant:m});return x(wt,{...VOe(WOe({},g),{component:"table",ref:t,className:y(v.root,r),"data-striped":a||void 0,"data-hover":s||void 0}),children:i})});IY.displayName="@mantine/core/Table";const iP={context:"Tabs component was not found in the tree",value:"Tabs.Tab or Tabs.Panel component was rendered with invalid value or without value"},[HOe,OR]=Iy(iP.context);var GOe=Object.defineProperty,hj=Object.getOwnPropertySymbols,qOe=Object.prototype.hasOwnProperty,KOe=Object.prototype.propertyIsEnumerable,fj=(e,t,n)=>t in e?GOe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ZOe=(e,t)=>{for(var n in t||(t={}))qOe.call(t,n)&&fj(e,n,t[n]);if(hj)for(var n of hj(t))KOe.call(t,n)&&fj(e,n,t[n]);return e};function XOe({orientation:e,inverted:t,placement:n},r,i){const a=e==="vertical";return i==="default"?{[a?n==="left"?"borderRight":"borderLeft":t?"borderTop":"borderBottom"]:`${G(2)} solid ${r.colorScheme==="dark"?r.colors.dark[4]:r.colors.gray[3]}`}:i==="outline"?{[a?n==="left"?"borderRight":"borderLeft":t?"borderTop":"borderBottom"]:`${G(1)} solid ${r.colorScheme==="dark"?r.colors.dark[4]:r.colors.gray[3]}`}:i==="pills"?{gap:`calc(${r.spacing.sm} / 2)`}:{}}var JOe=it((e,t,{variant:n})=>{const r=t.orientation==="vertical";return{tabsList:ZOe({display:"flex",flexWrap:"wrap",flexDirection:r?"column":"row",justifyContent:eJ[t.position],'& [role="tab"]':{flex:t.grow?1:void 0}},XOe(t,e,n))}});const YOe=JOe;var QOe=Object.defineProperty,ePe=Object.defineProperties,tPe=Object.getOwnPropertyDescriptors,PC=Object.getOwnPropertySymbols,$Y=Object.prototype.hasOwnProperty,TY=Object.prototype.propertyIsEnumerable,mj=(e,t,n)=>t in e?QOe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nPe=(e,t)=>{for(var n in t||(t={}))$Y.call(t,n)&&mj(e,n,t[n]);if(PC)for(var n of PC(t))TY.call(t,n)&&mj(e,n,t[n]);return e},rPe=(e,t)=>ePe(e,tPe(t)),iPe=(e,t)=>{var n={};for(var r in e)$Y.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&PC)for(var r of PC(e))t.indexOf(r)<0&&TY.call(e,r)&&(n[r]=e[r]);return n};const aPe={grow:!1,position:"left"},NY=I.exports.forwardRef((e,t)=>{const n=Ke("TabsList",aPe,e),{children:r,className:i,grow:a,position:s}=n,o=iPe(n,["children","className","grow","position"]),{orientation:l,variant:u,color:c,radius:d,inverted:p,placement:h,classNames:m,styles:g,unstyled:v}=OR(),{classes:y,cx:b}=YOe({orientation:l,grow:a,color:c,position:s,radius:d,inverted:p,placement:h},{name:"Tabs",unstyled:v,classNames:m,styles:g,variant:u});return x(wt,{...rPe(nPe({},o),{className:b(y.tabsList,i),ref:t,role:"tablist","aria-orientation":l}),children:r})});NY.displayName="@mantine/core/TabsList";var sPe=it((e,{orientation:t})=>({panel:{flex:t==="vertical"?1:void 0}}));const oPe=sPe;var lPe=Object.defineProperty,uPe=Object.defineProperties,cPe=Object.getOwnPropertyDescriptors,AC=Object.getOwnPropertySymbols,EY=Object.prototype.hasOwnProperty,OY=Object.prototype.propertyIsEnumerable,gj=(e,t,n)=>t in e?lPe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,dPe=(e,t)=>{for(var n in t||(t={}))EY.call(t,n)&&gj(e,n,t[n]);if(AC)for(var n of AC(t))OY.call(t,n)&&gj(e,n,t[n]);return e},pPe=(e,t)=>uPe(e,cPe(t)),hPe=(e,t)=>{var n={};for(var r in e)EY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&AC)for(var r of AC(e))t.indexOf(r)<0&&OY.call(e,r)&&(n[r]=e[r]);return n};const fPe={},PY=I.exports.forwardRef((e,t)=>{const n=Ke("TabsPanel",fPe,e),{value:r,children:i,sx:a,className:s}=n,o=hPe(n,["value","children","sx","className"]),l=OR(),{classes:u,cx:c}=oPe({orientation:l.orientation,color:l.color,radius:l.radius,inverted:l.inverted,placement:l.placement},{name:"Tabs",unstyled:l.unstyled,classNames:l.classNames,styles:l.styles,variant:l.variant}),d=l.getPanelId(r),p=l.value===r,h=l.keepMounted||p?i:null;return I.exports.useEffect(()=>(l.setMountedPanelIds(m=>[...m,d]),l.setMountedPanelIds(m=>m.filter(g=>g!==d))),[d]),x(wt,{...pPe(dPe({},o),{ref:t,sx:[{display:p?void 0:"none"},...UM(a)],className:c(u.panel,s),role:"tabpanel",id:d,"aria-labelledby":l.getTabId(r)}),children:h})});PY.displayName="@mantine/core/TabsPanel";var mPe=Object.defineProperty,gPe=Object.defineProperties,yPe=Object.getOwnPropertyDescriptors,yj=Object.getOwnPropertySymbols,vPe=Object.prototype.hasOwnProperty,bPe=Object.prototype.propertyIsEnumerable,vj=(e,t,n)=>t in e?mPe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,sg=(e,t)=>{for(var n in t||(t={}))vPe.call(t,n)&&vj(e,n,t[n]);if(yj)for(var n of yj(t))bPe.call(t,n)&&vj(e,n,t[n]);return e},bj=(e,t)=>gPe(e,yPe(t));function wPe(e,{orientation:t,color:n,radius:r,inverted:i,placement:a},s){const o=t==="vertical",l=e.fn.variant({color:n,variant:"filled"}),u=G(e.fn.radius(r)),c=t==="vertical"?a==="left"?`${u} 0 0 ${u}`:` 0 ${u} ${u} 0`:i?`0 0 ${u} ${u}`:`${u} ${u} 0 0`;return s==="default"?bj(sg({[o?a==="left"?"borderRight":"borderLeft":i?"borderTop":"borderBottom"]:`${G(2)} solid transparent`,[o?a==="left"?"marginRight":"marginLeft":i?"marginTop":"marginBottom"]:G(-2),borderRadius:c},e.fn.hover({backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[0],borderColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]})),{"&[data-active]":sg({borderColor:l.background,color:e.colorScheme==="dark"?e.white:e.black},e.fn.hover({borderColor:l.background}))}):s==="outline"?{borderRadius:c,border:`${G(1)} solid transparent`,[o?a==="left"?"borderRight":"borderLeft":i?"borderTop":"borderBottom"]:"none","&[data-active]":{borderColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3],"&::before":{content:'""',backgroundColor:e.colorScheme==="dark"?e.colors.dark[7]:e.white,position:"absolute",bottom:o?0:i?"unset":G(-1),top:o?0:i?G(-1):"unset",[o?"width":"height"]:G(1),right:o?a==="left"?G(-1):"unset":0,left:o?a==="left"?"unset":G(-1):0}}}:s==="pills"?bj(sg({borderRadius:e.fn.radius(r)},e.fn.hover({backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[0]})),{"&[data-active]":sg({backgroundColor:l.background,color:e.white},e.fn.hover({backgroundColor:l.background}))}):{}}var xPe=it((e,t,{variant:n})=>({tabLabel:{},tab:sg({position:"relative",padding:`${e.spacing.xs} ${e.spacing.md}`,paddingLeft:t.withIcon?e.spacing.xs:void 0,paddingRight:t.withRightSection?e.spacing.xs:void 0,fontSize:e.fontSizes.sm,whiteSpace:"nowrap",zIndex:0,display:"flex",alignItems:"center",justifyContent:t.orientation==="horizontal"?"center":void 0,lineHeight:1,"&:disabled":sg({opacity:.5,cursor:"not-allowed"},e.fn.hover({backgroundColor:"transparent"})),"&:focus":{zIndex:1}},wPe(e,t,n)),tabRightSection:{display:"flex",justifyContent:"center",alignItems:"center","&:not(:only-child)":{marginLeft:G(7)}},tabIcon:{display:"flex",justifyContent:"center",alignItems:"center","&:not(:only-child)":{marginRight:G(7)}}}));const _Pe=xPe;var kPe=Object.defineProperty,SPe=Object.defineProperties,CPe=Object.getOwnPropertyDescriptors,MC=Object.getOwnPropertySymbols,AY=Object.prototype.hasOwnProperty,MY=Object.prototype.propertyIsEnumerable,wj=(e,t,n)=>t in e?kPe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,IPe=(e,t)=>{for(var n in t||(t={}))AY.call(t,n)&&wj(e,n,t[n]);if(MC)for(var n of MC(t))MY.call(t,n)&&wj(e,n,t[n]);return e},$Pe=(e,t)=>SPe(e,CPe(t)),TPe=(e,t)=>{var n={};for(var r in e)AY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&MC)for(var r of MC(e))t.indexOf(r)<0&&MY.call(e,r)&&(n[r]=e[r]);return n};const NPe={},RY=I.exports.forwardRef((e,t)=>{const n=Ke("TabsTab",NPe,e),{value:r,children:i,onKeyDown:a,onClick:s,className:o,icon:l,rightSection:u,color:c}=n,d=TPe(n,["value","children","onKeyDown","onClick","className","icon","rightSection","color"]),p=OR(),h=!!l,m=!!u,{theme:g,classes:v,cx:y}=_Pe({withIcon:h||m&&!i,withRightSection:m||h&&!i,orientation:p.orientation,color:c||p.color,radius:p.radius,inverted:p.inverted,placement:p.placement},{name:"Tabs",unstyled:p.unstyled,classNames:p.classNames,styles:p.styles,variant:p.variant}),b=r===p.value,_=p.getPanelId(r),k=p.mountedPanelIds.includes(r)?_:void 0,C=$=>{p.onTabChange(p.allowTabDeactivation&&r===p.value?null:r),s==null||s($)};return B(D1,{...$Pe(IPe({},d),{unstyled:p.unstyled,className:y(v.tab,o),"data-active":b||void 0,ref:t,type:"button",role:"tab",id:p.getTabId(r),"aria-selected":b,tabIndex:b||p.value===null?0:-1,"aria-controls":k,onClick:C,onKeyDown:_ge({siblingSelector:'[role="tab"]',parentSelector:'[role="tablist"]',activateOnFocus:p.activateTabWithKeyboard,loop:p.loop,dir:g.dir,orientation:p.orientation,onKeyDown:a})}),children:[l&&x("span",{className:v.tabIcon,children:l}),i&&x("span",{className:v.tabLabel,children:i}),u&&x("span",{className:v.tabRightSection,children:u})]})});RY.displayName="@mantine/core/Tab";function DY({defaultValue:e,value:t,onTabChange:n,orientation:r,children:i,loop:a,id:s,activateTabWithKeyboard:o,allowTabDeactivation:l,variant:u,color:c,radius:d,inverted:p,placement:h,keepMounted:m=!0,classNames:g,styles:v,unstyled:y}){const b=zu(s),[_,k]=I.exports.useState([]),[C,$]=qo({value:t,defaultValue:e,finalValue:null,onChange:n});return x(HOe,{value:{placement:h,value:C,orientation:r,id:b,loop:a,activateTabWithKeyboard:o,getTabId:D4(`${b}-tab`,iP.value),getPanelId:D4(`${b}-panel`,iP.value),onTabChange:$,setMountedPanelIds:k,mountedPanelIds:_,allowTabDeactivation:l,variant:u,color:c,radius:d,inverted:p,keepMounted:m,classNames:g,styles:v,unstyled:y},children:i})}DY.displayName="@mantine/core/TabsProvider";var EPe=it((e,{orientation:t,placement:n})=>({root:{display:t==="vertical"?"flex":void 0,flexDirection:n==="right"?"row-reverse":"row"}}));const OPe=EPe;var PPe=Object.defineProperty,APe=Object.defineProperties,MPe=Object.getOwnPropertyDescriptors,RC=Object.getOwnPropertySymbols,LY=Object.prototype.hasOwnProperty,FY=Object.prototype.propertyIsEnumerable,xj=(e,t,n)=>t in e?PPe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,RPe=(e,t)=>{for(var n in t||(t={}))LY.call(t,n)&&xj(e,n,t[n]);if(RC)for(var n of RC(t))FY.call(t,n)&&xj(e,n,t[n]);return e},DPe=(e,t)=>APe(e,MPe(t)),LPe=(e,t)=>{var n={};for(var r in e)LY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&RC)for(var r of RC(e))t.indexOf(r)<0&&FY.call(e,r)&&(n[r]=e[r]);return n};const FPe={orientation:"horizontal",loop:!0,activateTabWithKeyboard:!0,allowTabDeactivation:!1,unstyled:!1,inverted:!1,variant:"default",placement:"left"},gi=I.exports.forwardRef((e,t)=>{const n=Ke("Tabs",FPe,e),{defaultValue:r,value:i,orientation:a,loop:s,activateTabWithKeyboard:o,allowTabDeactivation:l,children:u,id:c,onTabChange:d,variant:p,color:h,className:m,unstyled:g,classNames:v,styles:y,radius:b,inverted:_,keepMounted:k,placement:C}=n,$=LPe(n,["defaultValue","value","orientation","loop","activateTabWithKeyboard","allowTabDeactivation","children","id","onTabChange","variant","color","className","unstyled","classNames","styles","radius","inverted","keepMounted","placement"]),{classes:N,cx:A}=OPe({orientation:a,color:h,radius:b,inverted:_,placement:C},{unstyled:g,name:"Tabs",classNames:v,styles:y,variant:p});return x(DY,{activateTabWithKeyboard:o,defaultValue:r,orientation:a,onTabChange:d,value:i,id:c,loop:s,allowTabDeactivation:l,color:h,variant:p,radius:b,inverted:_,keepMounted:k,placement:C,classNames:v,styles:y,unstyled:g,children:x(wt,{...DPe(RPe({},$),{className:A(N.root,m),id:c,ref:t}),children:u})})});gi.List=NY;gi.Tab=RY;gi.Panel=PY;gi.displayName="@mantine/core/Tabs";var zPe=Object.defineProperty,BPe=Object.defineProperties,WPe=Object.getOwnPropertyDescriptors,_j=Object.getOwnPropertySymbols,VPe=Object.prototype.hasOwnProperty,jPe=Object.prototype.propertyIsEnumerable,kj=(e,t,n)=>t in e?zPe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,UPe=(e,t)=>{for(var n in t||(t={}))VPe.call(t,n)&&kj(e,n,t[n]);if(_j)for(var n of _j(t))jPe.call(t,n)&&kj(e,n,t[n]);return e},HPe=(e,t)=>BPe(e,WPe(t));function GPe(e,t,n){return typeof e<"u"?e in n.headings.sizes?n.headings.sizes[e].fontSize:G(e):n.headings.sizes[t].fontSize}function qPe(e,t,n){return typeof e<"u"&&e in n.headings.sizes?n.headings.sizes[e].lineHeight:n.headings.sizes[t].lineHeight}var KPe=it((e,{element:t,weight:n,inline:r},{size:i})=>({root:HPe(UPe({},e.fn.fontStyles()),{fontFamily:e.headings.fontFamily,fontWeight:n||e.headings.sizes[t].fontWeight||e.headings.fontWeight,fontSize:GPe(i,t,e),lineHeight:r?1:qPe(i,t,e),margin:0})}));const ZPe=KPe;var XPe=Object.defineProperty,DC=Object.getOwnPropertySymbols,zY=Object.prototype.hasOwnProperty,BY=Object.prototype.propertyIsEnumerable,Sj=(e,t,n)=>t in e?XPe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,JPe=(e,t)=>{for(var n in t||(t={}))zY.call(t,n)&&Sj(e,n,t[n]);if(DC)for(var n of DC(t))BY.call(t,n)&&Sj(e,n,t[n]);return e},YPe=(e,t)=>{var n={};for(var r in e)zY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&DC)for(var r of DC(e))t.indexOf(r)<0&&BY.call(e,r)&&(n[r]=e[r]);return n};const QPe={order:1},D2=I.exports.forwardRef((e,t)=>{const n=Ke("Title",QPe,e),{className:r,order:i,children:a,unstyled:s,size:o,weight:l,inline:u,variant:c}=n,d=YPe(n,["className","order","children","unstyled","size","weight","inline","variant"]),{classes:p,cx:h}=ZPe({element:`h${i}`,weight:l,inline:u},{name:"Title",unstyled:s,variant:c,size:o});return[1,2,3,4,5,6].includes(i)?x(Te,{...JPe({variant:c,component:`h${i}`,ref:t,className:h(p.root,r)},d),children:a}):null});D2.displayName="@mantine/core/Title";var eAe=Object.defineProperty,tAe=Object.defineProperties,nAe=Object.getOwnPropertyDescriptors,Cj=Object.getOwnPropertySymbols,rAe=Object.prototype.hasOwnProperty,iAe=Object.prototype.propertyIsEnumerable,Ij=(e,t,n)=>t in e?eAe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,i_=(e,t)=>{for(var n in t||(t={}))rAe.call(t,n)&&Ij(e,n,t[n]);if(Cj)for(var n of Cj(t))iAe.call(t,n)&&Ij(e,n,t[n]);return e},a_=(e,t)=>tAe(e,nAe(t)),aAe=it(e=>{const t=Cge(e.headings.sizes).reduce((n,r)=>{const i=e.headings.sizes[r];return n[`& ${r}`]=a_(i_({fontFamily:e.headings.fontFamily,fontWeight:i.fontWeight||e.headings.fontWeight,marginTop:typeof i.lineHeight=="number"?`calc(${e.spacing.xl} * ${i.lineHeight})`:e.spacing.xl,marginBottom:e.spacing.sm},i),{[e.fn.smallerThan("sm")]:{fontSize:`calc(${G(i.fontSize)} / 1.3)`}}),n},{});return{root:a_(i_(a_(i_({},e.fn.fontStyles()),{color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,lineHeight:e.lineHeight,fontSize:e.fontSizes.md,[e.fn.smallerThan("sm")]:{fontSize:e.fontSizes.sm}}),t),{"& img":{maxWidth:"100%",marginBottom:e.spacing.xs},"& p":{marginTop:0,marginBottom:e.spacing.lg},"& mark":{backgroundColor:e.fn.themeColor("yellow",e.colorScheme==="dark"?5:2),color:e.colorScheme==="dark"?e.colors.dark[9]:"inherit"},"& hr":{marginTop:e.spacing.md,marginBottom:e.spacing.sm,borderBottom:0,borderLeft:0,borderRight:0,borderTop:`${G(1)} dashed ${e.colors.gray[e.colorScheme==="dark"?4:6]}`},"& a":a_(i_({},e.fn.focusStyles()),{color:e.colors[e.primaryColor][e.colorScheme==="dark"?4:6],textDecoration:"none","&:hover":{textDecoration:"underline"}}),"& pre":{padding:e.spacing.xs,lineHeight:e.lineHeight,margin:0,marginTop:e.spacing.md,marginBottom:e.spacing.md,overflowX:"auto",fontFamily:e.fontFamilyMonospace,fontSize:e.fontSizes.sm,borderRadius:e.radius.sm,backgroundColor:e.colorScheme==="dark"?e.colors.dark[8]:e.colors.gray[0],"& code":{backgroundColor:"transparent",padding:0,borderRadius:0,color:"inherit",border:0}},"& code":{lineHeight:e.lineHeight,padding:`${G(1)} ${G(5)}`,borderRadius:e.radius.sm,color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,backgroundColor:e.colorScheme==="dark"?e.colors.dark[9]:e.colors.gray[0],fontFamily:e.fontFamilyMonospace,fontSize:e.fontSizes.xs,border:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[9]:e.colors.gray[3]}`},"& ul, & ol":{marginBottom:e.spacing.md,paddingLeft:38,"& li":{marginTop:e.spacing.xs}},"& table":{width:"100%",borderCollapse:"collapse",captionSide:"bottom",marginBottom:e.spacing.md,"& caption":{marginTop:e.spacing.xs,fontSize:e.fontSizes.sm,color:e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[6]},"& th":{textAlign:"left",fontWeight:"bold",color:e.colorScheme==="dark"?e.colors.dark[0]:e.colors.gray[7],fontSize:14,padding:`${G(7)} ${G(10)}`},"& thead th":{borderBottom:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]}`},"& tfoot th":{borderTop:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]}`},"& td":{padding:`${G(7)} ${G(10)}`,borderBottom:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]}`,fontSize:14},"& tr:last-of-type td":{borderBottom:"none"}},"& blockquote":{fontSize:e.fontSizes.lg,lineHeight:e.lineHeight,margin:`${e.spacing.md} 0`,borderTopRightRadius:e.radius.sm,borderBottomRightRadius:e.radius.sm,padding:`${e.spacing.md} ${e.spacing.lg}`,color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,borderLeft:`${G(6)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]}`,"& cite":{display:"block",fontSize:e.fontSizes.sm,marginTop:e.spacing.xs,color:e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[6],overflow:"hidden",textOverflow:"ellipsis"}}})}});const sAe=aAe;var oAe=Object.defineProperty,LC=Object.getOwnPropertySymbols,WY=Object.prototype.hasOwnProperty,VY=Object.prototype.propertyIsEnumerable,$j=(e,t,n)=>t in e?oAe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lAe=(e,t)=>{for(var n in t||(t={}))WY.call(t,n)&&$j(e,n,t[n]);if(LC)for(var n of LC(t))VY.call(t,n)&&$j(e,n,t[n]);return e},uAe=(e,t)=>{var n={};for(var r in e)WY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&LC)for(var r of LC(e))t.indexOf(r)<0&&VY.call(e,r)&&(n[r]=e[r]);return n};const jY=I.exports.forwardRef((e,t)=>{const n=Ke("TypographyStylesProvider",{},e),{className:r,unstyled:i,variant:a}=n,s=uAe(n,["className","unstyled","variant"]),{classes:o,cx:l}=sAe(null,{name:"TypographyStylesProvider",unstyled:i,variant:a});return x(wt,{...lAe({className:l(o.root,r),ref:t},s)})});jY.displayName="@mantine/core/TypographyStylesProvider";const PR=()=>!window.invokeNative,cAe=()=>{},kt=(e,t)=>{const n=I.exports.useRef(cAe);I.exports.useEffect(()=>{n.current=t},[t]),I.exports.useEffect(()=>{const r=i=>{const{action:a,data:s}=i.data;n.current&&a===e&&n.current(s)};return window.addEventListener("message",r),()=>window.removeEventListener("message",r)},[e])};async function Ne(e,t,n){const r={method:"post",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(t)};if(PR()&&n)return n;const i=window.GetParentResourceName?window.GetParentResourceName():"nui-frame-app";return await(await fetch(`https://${i}/${e}`,r)).json()}const UY=I.exports.createContext(null),dAe=({children:e})=>{const[t,n]=I.exports.useState(!1),[r,i]=I.exports.useState("");return kt("setVisible",a=>{i(a.page),n(a.visible)}),I.exports.useEffect(()=>{if(!t)return;const a=s=>{["Escape"].includes(s.code)&&(PR()?n(!t):Ne("hideUI"))};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t]),x(UY.Provider,{value:{visible:t,page:r,setVisible:n},children:x("div",{style:{visibility:t?"visible":"hidden",height:"100%"},children:e})})},pAe=()=>I.exports.useContext(UY),Tj=e=>{let t;const n=new Set,r=(c,d)=>{const p=typeof c=="function"?c(t):c;if(!Object.is(p,t)){const h=t;t=(d!=null?d:typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(m=>m(t,h))}},i=()=>t,l={setState:r,getState:i,getInitialState:()=>u,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{n.clear()}},u=t=e(r,i,l);return l},hAe=e=>e?Tj(e):Tj;var HY={exports:{}},GY={},qY={exports:{}},KY={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gg=I.exports;function fAe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var mAe=typeof Object.is=="function"?Object.is:fAe,gAe=Gg.useState,yAe=Gg.useEffect,vAe=Gg.useLayoutEffect,bAe=Gg.useDebugValue;function wAe(e,t){var n=t(),r=gAe({inst:{value:n,getSnapshot:t}}),i=r[0].inst,a=r[1];return vAe(function(){i.value=n,i.getSnapshot=t,qN(i)&&a({inst:i})},[e,n,t]),yAe(function(){return qN(i)&&a({inst:i}),e(function(){qN(i)&&a({inst:i})})},[e]),bAe(n),n}function qN(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!mAe(e,n)}catch{return!0}}function xAe(e,t){return t()}var _Ae=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?xAe:wAe;KY.useSyncExternalStore=Gg.useSyncExternalStore!==void 0?Gg.useSyncExternalStore:_Ae;(function(e){e.exports=KY})(qY);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L2=I.exports,kAe=qY.exports;function SAe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var CAe=typeof Object.is=="function"?Object.is:SAe,IAe=kAe.useSyncExternalStore,$Ae=L2.useRef,TAe=L2.useEffect,NAe=L2.useMemo,EAe=L2.useDebugValue;GY.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var a=$Ae(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=NAe(function(){function l(h){if(!u){if(u=!0,c=h,h=r(h),i!==void 0&&s.hasValue){var m=s.value;if(i(m,h))return d=m}return d=h}if(m=d,CAe(c,h))return m;var g=r(h);return i!==void 0&&i(m,g)?m:(c=h,d=g)}var u=!1,c,d,p=n===void 0?null:n;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,n,r,i]);var o=IAe(e,a[0],a[1]);return TAe(function(){s.hasValue=!0,s.value=o},[o]),EAe(o),o};(function(e){e.exports=GY})(HY);const OAe=ZA(HY.exports),{useDebugValue:PAe}=Ni,{useSyncExternalStoreWithSelector:AAe}=OAe;const MAe=e=>e;function RAe(e,t=MAe,n){const r=AAe(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return PAe(r),r}const Nj=e=>{const t=typeof e=="function"?hAe(e):e,n=(r,i)=>RAe(t,r,i);return Object.assign(n,t),n},Tr=e=>e?Nj(e):Nj;var AR=e=>Tr(e);const tn=Tr(e=>({loading:!0,copiedCharges:[],identifier:"",playerJob:"",playerGrade:0,isBoss:!1,name:"",phoneNumber:"",sidebarOrder:["warrants","bolos","tags","owners","paramedics","patients","officers","criminals","suspects","civilians","employees","vehicles","licenses","properties","jobs","weapons","evidence","charges","linkedIncidents","linkedReports","linkedPoliceReports","linkedProfiles","photos"],policePages:["home","profiles","vehicles","properties","businesses","incidents","reports","trainingReports","policeReports","evidence","weapons","map","charges","legislation","employees"],emsPages:["home","profiles","reports","trainingReports","map","employees"],citizenPages:["profiles","charges","legislation"],dateFormat:{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"},lastEmployeeIdentifier:void 0,setDateFormat:t=>e({dateFormat:t}),setPolicePages:t=>e({policePages:t}),setEMSPages:t=>e({emsPages:t}),setCitizenPages:t=>e({citizenPages:t}),setSidebarOrder:t=>e({sidebarOrder:t}),setName:t=>e({name:t}),setPhoneNumber:t=>e({phoneNumber:t}),setIdentifier:t=>e({identifier:t}),setPlayerJob:t=>e({playerJob:t}),setPlayerGrade:t=>e({playerGrade:t}),setIsBoss:t=>e({isBoss:t}),setLoading:t=>e({loading:t}),setCopiedCharges:t=>e({copiedCharges:t}),setLastEmployeeIdentifier:t=>e({lastEmployeeIdentifier:t})})),K={};String.prototype.format=function(...e){let t=this;for(let n=0;n<e.length;n++)t=t.replace("%s",e[n]);return t};function Ej(e){for(const t in K)K[t]=t;for(const[t,n]of Object.entries(e))K[t]=n}const js=Tr(e=>({profiles:[],addProfile:t=>e(n=>({profiles:[...n.profiles,t]})),updateProfile:(t,n)=>e(r=>({profiles:r.profiles.map(a=>{if(a.identifier===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a})})),setProfiles:t=>e({profiles:t}),toggleWarrant:(t,n)=>e(r=>({profiles:r.profiles.map(a=>{var s;if(a.identifier===t){const o={...a},l=((s=o.sideBarData)==null?void 0:s.warrants)||[],u=l.some(c=>c.incidentId===n.incidentId);return o.sideBarData={...o.sideBarData,warrants:u?l.filter(c=>c.incidentId!==n.incidentId):[...l,n]},o}return a})}))})),Th=Tr(e=>({vehicles:[],addVehicle:t=>e(n=>({vehicles:[...n.vehicles,t]})),updateVehicle:(t,n)=>e(r=>{const i=r.vehicles.map(a=>{if(a.plate===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a});return{...r,vehicles:i}}),setVehicles:t=>e({vehicles:t}),toggleBOLO:(t,n)=>e(r=>({vehicles:r.vehicles.map(a=>{var s;if(a.plate===t){const o={...a},l=((s=o.sideBarData)==null?void 0:s.bolos)||[],u=l.some(c=>c.id===n.id);return o.sideBarData={...o.sideBarData,bolos:u?l.filter(c=>c.id!==n.id):[...l,n]},o}return a})}))})),MR=Tr(e=>({businesses:[],addBusiness:t=>e(n=>({businesses:[...n.businesses,t]})),updateBusiness:(t,n)=>e(r=>{const i=r.businesses.map(a=>{if(a.name===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a});return{...r,businesses:i}}),setBusinesses:t=>e({businesses:t})})),F2=Tr(e=>({properties:[],addProperty:t=>e(n=>({properties:[...n.properties,t]})),updateProperty:(t,n)=>e(r=>{const i=r.properties.map(a=>{if(a.id===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a});return{...r,properties:i}}),setProperties:t=>e({properties:t})})),$d=Tr(e=>({incidents:[],addIncident:t=>e(n=>({incidents:[...n.incidents.filter(i=>i.id!==t.id),t]})),removeIncident:t=>e(n=>({incidents:n.incidents.filter(i=>i.id!==t)})),updateIncident:(t,n)=>e(r=>({incidents:r.incidents.map(a=>{if(a.id===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a})})),updateCriminalFine:(t,n,r)=>e(i=>{const a=i.incidents.map(o=>{if(o.id===t){let l={...o};return l.sideBarData.criminals?(l.sideBarData.criminals=l.sideBarData.criminals.map(u=>(u.identifier===n&&(u.fine=r),u)),l):o}return o}),s=a.find(o=>o.id===t);return{incidents:a,updatedIncident:s}}),updateCriminalSentence:(t,n,r)=>e(i=>{const a=i.incidents.map(o=>{if(o.id===t){let l={...o};return l.sideBarData.criminals?(l.sideBarData.criminals=l.sideBarData.criminals.map(u=>(u.identifier===n&&(u.sentence=r),u)),l):o}return o}),s=a.find(o=>o.id===t);return{incidents:a,updatedIncident:s}}),updateCriminalPoints:(t,n,r)=>e(i=>{const a=i.incidents.map(o=>{if(o.id===t){let l={...o};return l.sideBarData.criminals?(l.sideBarData.criminals=l.sideBarData.criminals.map(u=>(u.identifier===n&&(u.points=r),u)),l):o}return o}),s=a.find(o=>o.id===t);return{incidents:a,updatedIncident:s}}),updateCharges:(t,n,r)=>e(i=>{const a=i.incidents.map(o=>{if(o.id===t){let l={...o};return l.sideBarData.criminals?(l.sideBarData.criminals=l.sideBarData.criminals.map(u=>(u.identifier===n&&(u.charges=r),u)),l):o}return o}),s=a.find(o=>o.id===t);return{incidents:a,updatedIncident:s}}),removeChargeWithId:(t,n,r)=>e(i=>({incidents:i.incidents.map(s=>{var o;return s.id===t?{...s,sideBarData:{...s.sideBarData,criminals:(o=s.sideBarData.criminals)==null?void 0:o.map(u=>{var c;if(u.identifier===n){const d=(c=u.charges)==null?void 0:c.map(p=>{if(p.id===r){const h=p.amount-1;return h>0?{...p,amount:h}:null}return p}).filter(p=>p!==null);return{...u,charges:d}}return u})}}:s})})),setIncidents:t=>e({incidents:t})})),ju=Tr(e=>({reports:[],addReport:t=>e(n=>({reports:[...n.reports,t]})),updateReport:(t,n)=>e(r=>({reports:r.reports.map(a=>{if(a.id===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a})})),setReports:t=>e({reports:t}),removeReport:t=>e(n=>({reports:n.reports.filter(r=>r.id!==t)}))})),Qb=Tr(e=>({policeReports:[],addPoliceReport:t=>e(n=>({policeReports:[...n.policeReports,t]})),updatePoliceReport:(t,n)=>e(r=>({policeReports:r.policeReports.map(a=>{if(a.id===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a})})),setPoliceReports:t=>e({policeReports:t}),removePoliceReport:t=>e(n=>({policeReports:n.policeReports.filter(r=>r.id!==t)}))})),W1=Tr(e=>({trainingReports:[],addTrainingReport:t=>e(n=>({trainingReports:[...n.trainingReports,t]})),updateTrainingReport:(t,n)=>e(r=>({trainingReports:r.trainingReports.map(a=>{if(a.id===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a})})),setTrainingReports:t=>e({trainingReports:t}),removeTrainingReport:t=>e(n=>({trainingReports:n.trainingReports.filter(r=>r.id!==t)}))})),V1=Tr(e=>({evidence:[],addEvidence:t=>e(n=>({evidence:[...n.evidence,t]})),updateEvidence:(t,n)=>e(r=>({evidence:r.evidence.map(a=>{if(a.id===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a})})),setEvidence:t=>e({evidence:t}),removeEvidence:t=>e(n=>({evidence:n.evidence.filter(r=>r.id!==t)}))})),z2=Tr(e=>({charges:[],addCharge:t=>e(n=>({charges:[...n.charges,t]})),updateCharge:(t,n)=>e(r=>({charges:r.charges.map(a=>{if(a.id===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a})})),setCharges:t=>e({charges:t}),removeCharge:t=>e(n=>({charges:n.charges.filter(r=>r.id!==t)}))})),Jo=Tr(e=>({employees:[],licenses:[],status:[],minTrainingReportGrade:0,maxTraineeGrade:0,setMinTrainingReportGrade:t=>e({minTrainingReportGrade:t}),setMaxTraineeGrade:t=>e({maxTraineeGrade:t}),setEmployeeLicenses:t=>e({licenses:t}),setStatus:t=>e({status:t}),addEmployee:t=>e(n=>{const r=n.employees.findIndex(i=>i.identifier===t.identifier);return r!==-1?{employees:n.employees.map((a,s)=>s===r?t:a)}:{employees:[...n.employees,t]}}),updateEmployee:(t,n)=>e(r=>({employees:r.employees.map(a=>{if(a.identifier===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a})})),setEmployees:t=>e({employees:t})})),j1=Tr(e=>({weapons:[],addWeapon:t=>e(n=>({weapons:[...n.weapons,t]})),updateWeapon:(t,n)=>e(r=>({weapons:r.weapons.map(a=>{if(a.id===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a})})),setWeapons:t=>e({weapons:t}),removeWeapon:t=>e(n=>({weapons:n.weapons.filter(r=>r.id!==t)}))})),RR=Tr(e=>({players:[],addPlayer:t=>e(n=>({players:[...n.players,t]})),setPlayers:t=>e({players:t})})),Ey=Tr(e=>({tags:[],addTag:t=>e(n=>({tags:[...n.tags,{name:t.name,color:t.color,minGrade:t.minGrade,grades:t.grades}]})),setTags:t=>e({tags:t})})),DR=Tr(e=>({messages:[],addMessage:t=>e(n=>({messages:[...n.messages,t]})),setMessages:t=>e({messages:t})})),LR=Tr(e=>({announcements:[],addAnnouncement:t=>e(n=>({announcements:[...n.announcements,t]})),setAnnouncements:t=>e({announcements:t}),togglePin:(t,n)=>e(r=>({announcements:r.announcements.map(i=>i.id===t?{...i,pinned:n}:i)})),removeAnnouncement:t=>e(n=>({announcements:n.announcements.filter(r=>r.id!==t)}))})),FR=Tr(e=>({calls:[],addCall:t=>e(n=>({calls:[...n.calls,t]})),removeCall:t=>e(n=>({calls:n.calls.filter(r=>r.id!==t)})),setCalls:t=>e({calls:t})}));function DAe(){const{name:e,phoneNumber:t}=tn(),[n,r]=I.exports.useState(""),[i,a]=I.exports.useState(!1),[s,o]=I.exports.useState(""),[l,u]=I.exports.useState(!1),c=()=>{!n||!s||(Ne("createPoliceReport",{title:n,content:s,hideName:i,hidePhoneNumber:l}),Ne("hideUI"))};return x(sr,{title:K.police_report,opened:!0,centered:!0,onClose:()=>Ne("hideUI"),children:B(Ce,{spacing:20,children:[B(Ce,{spacing:10,children:[x(Xe,{label:K.report_name,placeholder:K.report_name,value:e,readOnly:!0,disabled:i}),x(Hg,{label:K.hide_name,checked:i,onChange:d=>a(d.currentTarget.checked)})]}),B(Ce,{spacing:10,children:[x(Xe,{label:K.phone_number,placeholder:K.phone_number,value:t,readOnly:!0,disabled:l}),x(Hg,{label:K.hide_phone_number,checked:l,onChange:d=>u(d.currentTarget.checked)})]}),x(Xe,{label:K.title,placeholder:K.title,required:!0,value:n,onChange:d=>r(d.currentTarget.value)}),x(bs,{label:K.content,placeholder:K.content,required:!0,value:s,onChange:d=>o(d.currentTarget.value)}),x(me,{position:"right",children:x(Ct,{onClick:c,children:K.confirm})})]})})}var pc={exports:{}},LAe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",FAe=LAe,zAe=FAe;function ZY(){}function XY(){}XY.resetWarningCache=ZY;var BAe=function(){function e(r,i,a,s,o,l){if(l!==zAe){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:XY,resetWarningCache:ZY};return n.PropTypes=n,n};pc.exports=BAe();var WAe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},VAe=Object.defineProperty,jAe=Object.defineProperties,UAe=Object.getOwnPropertyDescriptors,FC=Object.getOwnPropertySymbols,JY=Object.prototype.hasOwnProperty,YY=Object.prototype.propertyIsEnumerable,Oj=(e,t,n)=>t in e?VAe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pj=(e,t)=>{for(var n in t||(t={}))JY.call(t,n)&&Oj(e,n,t[n]);if(FC)for(var n of FC(t))YY.call(t,n)&&Oj(e,n,t[n]);return e},HAe=(e,t)=>jAe(e,UAe(t)),GAe=(e,t)=>{var n={};for(var r in e)JY.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&FC)for(var r of FC(e))t.indexOf(r)<0&&YY.call(e,r)&&(n[r]=e[r]);return n},ct=(e,t,n)=>{const r=I.exports.forwardRef((i,a)=>{var s=i,{color:o="currentColor",size:l=24,stroke:u=2,children:c}=s,d=GAe(s,["color","size","stroke","children"]);return I.exports.createElement("svg",Pj(HAe(Pj({ref:a},WAe),{width:l,height:l,stroke:o,strokeWidth:u,className:`tabler-icon tabler-icon-${e}`}),d),[...n.map(([p,h])=>I.exports.createElement(p,h)),...c||[]])});return r.propTypes={color:pc.exports.string,size:pc.exports.oneOfType([pc.exports.string,pc.exports.number]),stroke:pc.exports.oneOfType([pc.exports.string,pc.exports.number])},r.displayName=`${t}`,r},qAe=ct("alert-triangle","IconAlertTriangle",[["path",{d:"M10.24 3.957l-8.422 14.06a1.989 1.989 0 0 0 1.7 2.983h16.845a1.989 1.989 0 0 0 1.7 -2.983l-8.423 -14.06a1.989 1.989 0 0 0 -3.4 0z",key:"svg-0"}],["path",{d:"M12 9v4",key:"svg-1"}],["path",{d:"M12 17h.01",key:"svg-2"}]]),KAe=ct("align-center","IconAlignCenter",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M8 12l8 0",key:"svg-1"}],["path",{d:"M6 18l12 0",key:"svg-2"}]]),ZAe=ct("align-justified","IconAlignJustified",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M4 12l16 0",key:"svg-1"}],["path",{d:"M4 18l12 0",key:"svg-2"}]]),XAe=ct("align-left","IconAlignLeft",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M4 12l10 0",key:"svg-1"}],["path",{d:"M4 18l14 0",key:"svg-2"}]]),JAe=ct("align-right","IconAlignRight",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M10 12l10 0",key:"svg-1"}],["path",{d:"M6 18l14 0",key:"svg-2"}]]),ws=ct("arrow-back","IconArrowBack",[["path",{d:"M9 11l-4 4l4 4m-4 -4h11a4 4 0 0 0 0 -8h-1",key:"svg-0"}]]),YAe=ct("blockquote","IconBlockquote",[["path",{d:"M6 15h15",key:"svg-0"}],["path",{d:"M21 19h-15",key:"svg-1"}],["path",{d:"M15 11h6",key:"svg-2"}],["path",{d:"M21 7h-6",key:"svg-3"}],["path",{d:"M9 9h1a1 1 0 1 1 -1 1v-2.5a2 2 0 0 1 2 -2",key:"svg-4"}],["path",{d:"M3 9h1a1 1 0 1 1 -1 1v-2.5a2 2 0 0 1 2 -2",key:"svg-5"}]]),QAe=ct("bold","IconBold",[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]]),eMe=ct("businessplan","IconBusinessplan",[["path",{d:"M16 6m-5 0a5 3 0 1 0 10 0a5 3 0 1 0 -10 0",key:"svg-0"}],["path",{d:"M11 6v4c0 1.657 2.239 3 5 3s5 -1.343 5 -3v-4",key:"svg-1"}],["path",{d:"M11 10v4c0 1.657 2.239 3 5 3s5 -1.343 5 -3v-4",key:"svg-2"}],["path",{d:"M11 14v4c0 1.657 2.239 3 5 3s5 -1.343 5 -3v-4",key:"svg-3"}],["path",{d:"M7 9h-2.5a1.5 1.5 0 0 0 0 3h1a1.5 1.5 0 0 1 0 3h-2.5",key:"svg-4"}],["path",{d:"M5 15v1m0 -8v1",key:"svg-5"}]]),Kl=ct("camera","IconCamera",[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]]),QY=ct("car","IconCar",[["path",{d:"M7 17m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M17 17m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M5 17h-2v-6l2 -5h9l4 5h1a2 2 0 0 1 2 2v4h-2m-4 0h-6m-6 -6h15m-6 0v-5",key:"svg-2"}]]),tMe=ct("check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),nMe=ct("chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]),rMe=ct("chevron-up","IconChevronUp",[["path",{d:"M6 15l6 -6l6 6",key:"svg-0"}]]),eQ=ct("circle-off","IconCircleOff",[["path",{d:"M20.042 16.045a9 9 0 0 0 -12.087 -12.087m-2.318 1.677a9 9 0 1 0 12.725 12.73",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]]),iMe=ct("clear-formatting","IconClearFormatting",[["path",{d:"M17 15l4 4m0 -4l-4 4",key:"svg-0"}],["path",{d:"M7 6v-1h11v1",key:"svg-1"}],["path",{d:"M7 19l4 0",key:"svg-2"}],["path",{d:"M13 5l-4 14",key:"svg-3"}]]),aMe=ct("clipboard","IconClipboard",[["path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2",key:"svg-0"}],["path",{d:"M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}]]),tQ=ct("code","IconCode",[["path",{d:"M7 8l-4 4l4 4",key:"svg-0"}],["path",{d:"M17 8l4 4l-4 4",key:"svg-1"}],["path",{d:"M14 4l-4 16",key:"svg-2"}]]),sMe=ct("color-picker","IconColorPicker",[["path",{d:"M11 7l6 6",key:"svg-0"}],["path",{d:"M4 16l11.7 -11.7a1 1 0 0 1 1.4 0l2.6 2.6a1 1 0 0 1 0 1.4l-11.7 11.7h-4v-4z",key:"svg-1"}]]),oMe=ct("copy","IconCopy",[["path",{d:"M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2",key:"svg-1"}]]),Us=ct("device-floppy","IconDeviceFloppy",[["path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M14 4l0 4l-6 0l0 -4",key:"svg-2"}]]),lMe=ct("external-link","IconExternalLink",[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]]),uMe=ct("face-id","IconFaceId",[["path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2",key:"svg-0"}],["path",{d:"M4 16v2a2 2 0 0 0 2 2h2",key:"svg-1"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"svg-2"}],["path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2",key:"svg-3"}],["path",{d:"M9 10l.01 0",key:"svg-4"}],["path",{d:"M15 10l.01 0",key:"svg-5"}],["path",{d:"M9.5 15a3.5 3.5 0 0 0 5 0",key:"svg-6"}]]),zC=ct("file-invoice","IconFileInvoice",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M9 7l1 0",key:"svg-2"}],["path",{d:"M9 13l6 0",key:"svg-3"}],["path",{d:"M13 17l2 0",key:"svg-4"}]]),cMe=ct("filter","IconFilter",[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]]),nQ=ct("gavel","IconGavel",[["path",{d:"M13 10l7.383 7.418c.823 .82 .823 2.148 0 2.967a2.11 2.11 0 0 1 -2.976 0l-7.407 -7.385",key:"svg-0"}],["path",{d:"M6 9l4 4",key:"svg-1"}],["path",{d:"M13 10l-4 -4",key:"svg-2"}],["path",{d:"M3 21h7",key:"svg-3"}],["path",{d:"M6.793 15.793l-3.586 -3.586a1 1 0 0 1 0 -1.414l2.293 -2.293l.5 .5l3 -3l-.5 -.5l2.293 -2.293a1 1 0 0 1 1.414 0l3.586 3.586a1 1 0 0 1 0 1.414l-2.293 2.293l-.5 -.5l-3 3l.5 .5l-2.293 2.293a1 1 0 0 1 -1.414 0z",key:"svg-4"}]]),dMe=ct("gender-male","IconGenderMale",[["path",{d:"M10 14m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0",key:"svg-0"}],["path",{d:"M19 5l-5.4 5.4",key:"svg-1"}],["path",{d:"M19 5h-5",key:"svg-2"}],["path",{d:"M19 5v5",key:"svg-3"}]]),pMe=ct("h-1","IconH1",[["path",{d:"M19 18v-8l-2 2",key:"svg-0"}],["path",{d:"M4 6v12",key:"svg-1"}],["path",{d:"M12 6v12",key:"svg-2"}],["path",{d:"M11 18h2",key:"svg-3"}],["path",{d:"M3 18h2",key:"svg-4"}],["path",{d:"M4 12h8",key:"svg-5"}],["path",{d:"M3 6h2",key:"svg-6"}],["path",{d:"M11 6h2",key:"svg-7"}]]),hMe=ct("h-2","IconH2",[["path",{d:"M17 12a2 2 0 1 1 4 0c0 .591 -.417 1.318 -.816 1.858l-3.184 4.143l4 0",key:"svg-0"}],["path",{d:"M4 6v12",key:"svg-1"}],["path",{d:"M12 6v12",key:"svg-2"}],["path",{d:"M11 18h2",key:"svg-3"}],["path",{d:"M3 18h2",key:"svg-4"}],["path",{d:"M4 12h8",key:"svg-5"}],["path",{d:"M3 6h2",key:"svg-6"}],["path",{d:"M11 6h2",key:"svg-7"}]]),fMe=ct("h-3","IconH3",[["path",{d:"M19 14a2 2 0 1 0 -2 -2",key:"svg-0"}],["path",{d:"M17 16a2 2 0 1 0 2 -2",key:"svg-1"}],["path",{d:"M4 6v12",key:"svg-2"}],["path",{d:"M12 6v12",key:"svg-3"}],["path",{d:"M11 18h2",key:"svg-4"}],["path",{d:"M3 18h2",key:"svg-5"}],["path",{d:"M4 12h8",key:"svg-6"}],["path",{d:"M3 6h2",key:"svg-7"}],["path",{d:"M11 6h2",key:"svg-8"}]]),mMe=ct("h-4","IconH4",[["path",{d:"M20 18v-8l-4 6h5",key:"svg-0"}],["path",{d:"M4 6v12",key:"svg-1"}],["path",{d:"M12 6v12",key:"svg-2"}],["path",{d:"M11 18h2",key:"svg-3"}],["path",{d:"M3 18h2",key:"svg-4"}],["path",{d:"M4 12h8",key:"svg-5"}],["path",{d:"M3 6h2",key:"svg-6"}],["path",{d:"M11 6h2",key:"svg-7"}]]),gMe=ct("h-5","IconH5",[["path",{d:"M17 18h2a2 2 0 1 0 0 -4h-2v-4h4",key:"svg-0"}],["path",{d:"M4 6v12",key:"svg-1"}],["path",{d:"M12 6v12",key:"svg-2"}],["path",{d:"M11 18h2",key:"svg-3"}],["path",{d:"M3 18h2",key:"svg-4"}],["path",{d:"M4 12h8",key:"svg-5"}],["path",{d:"M3 6h2",key:"svg-6"}],["path",{d:"M11 6h2",key:"svg-7"}]]),yMe=ct("h-6","IconH6",[["path",{d:"M19 14a2 2 0 1 0 0 4a2 2 0 0 0 0 -4z",key:"svg-0"}],["path",{d:"M21 12a2 2 0 1 0 -4 0v4",key:"svg-1"}],["path",{d:"M4 6v12",key:"svg-2"}],["path",{d:"M12 6v12",key:"svg-3"}],["path",{d:"M11 18h2",key:"svg-4"}],["path",{d:"M3 18h2",key:"svg-5"}],["path",{d:"M4 12h8",key:"svg-6"}],["path",{d:"M3 6h2",key:"svg-7"}],["path",{d:"M11 6h2",key:"svg-8"}]]),vMe=ct("highlight","IconHighlight",[["path",{d:"M3 19h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M12.5 5.5l4 4",key:"svg-1"}],["path",{d:"M4.5 13.5l4 4",key:"svg-2"}],["path",{d:"M21 15v4h-8l4 -4z",key:"svg-3"}]]),aP=ct("home","IconHome",[["path",{d:"M5 12l-2 0l9 -9l9 9l-2 0",key:"svg-0"}],["path",{d:"M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7",key:"svg-1"}],["path",{d:"M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6",key:"svg-2"}]]),bMe=ct("italic","IconItalic",[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]]),wMe=ct("line-dashed","IconLineDashed",[["path",{d:"M5 12h2",key:"svg-0"}],["path",{d:"M17 12h2",key:"svg-1"}],["path",{d:"M11 12h2",key:"svg-2"}]]),xMe=ct("link","IconLink",[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]]),_Me=ct("list-numbers","IconListNumbers",[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]]),kMe=ct("list","IconList",[["path",{d:"M9 6l11 0",key:"svg-0"}],["path",{d:"M9 12l11 0",key:"svg-1"}],["path",{d:"M9 18l11 0",key:"svg-2"}],["path",{d:"M5 6l0 .01",key:"svg-3"}],["path",{d:"M5 12l0 .01",key:"svg-4"}],["path",{d:"M5 18l0 .01",key:"svg-5"}]]),SMe=ct("location","IconLocation",[["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-0"}]]),CMe=ct("map-2","IconMap2",[["path",{d:"M12 18.5l-3 -1.5l-6 3v-13l6 -3l6 3l6 -3v7.5",key:"svg-0"}],["path",{d:"M9 4v13",key:"svg-1"}],["path",{d:"M15 7v5.5",key:"svg-2"}],["path",{d:"M21.121 20.121a3 3 0 1 0 -4.242 0c.418 .419 1.125 1.045 2.121 1.879c1.051 -.89 1.759 -1.516 2.121 -1.879z",key:"svg-3"}],["path",{d:"M19 18v.01",key:"svg-4"}]]),rQ=ct("map","IconMap",[["path",{d:"M3 7l6 -3l6 3l6 -3l0 13l-6 3l-6 -3l-6 3l0 -13",key:"svg-0"}],["path",{d:"M9 4l0 13",key:"svg-1"}],["path",{d:"M15 7l0 13",key:"svg-2"}]]),IMe=ct("message-report","IconMessageReport",[["path",{d:"M4 21v-13a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v6a3 3 0 0 1 -3 3h-9l-4 4",key:"svg-0"}],["path",{d:"M12 8l0 3",key:"svg-1"}],["path",{d:"M12 14l0 .01",key:"svg-2"}]]),$Me=ct("microscope","IconMicroscope",[["path",{d:"M5 21h14",key:"svg-0"}],["path",{d:"M6 18h2",key:"svg-1"}],["path",{d:"M7 18v3",key:"svg-2"}],["path",{d:"M9 11l3 3l6 -6l-3 -3z",key:"svg-3"}],["path",{d:"M10.5 12.5l-1.5 1.5",key:"svg-4"}],["path",{d:"M17 3l3 3",key:"svg-5"}],["path",{d:"M12 21a6 6 0 0 0 3.715 -10.712",key:"svg-6"}]]),iQ=ct("notebook","IconNotebook",[["path",{d:"M6 4h11a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-11a1 1 0 0 1 -1 -1v-14a1 1 0 0 1 1 -1m3 0v18",key:"svg-0"}],["path",{d:"M13 8l2 0",key:"svg-1"}],["path",{d:"M13 12l2 0",key:"svg-2"}]]),TMe=ct("palette","IconPalette",[["path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25",key:"svg-0"}],["path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}]]),NMe=ct("pencil","IconPencil",[["path",{d:"M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}]]),aQ=ct("pin","IconPin",[["path",{d:"M15 4.5l-4 4l-4 1.5l-1.5 1.5l7 7l1.5 -1.5l1.5 -4l4 -4",key:"svg-0"}],["path",{d:"M9 15l-4.5 4.5",key:"svg-1"}],["path",{d:"M14.5 4l5.5 5.5",key:"svg-2"}]]),Oy=ct("plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),EMe=ct("prison","IconPrison",[["path",{d:"M18 4v16",key:"svg-0"}],["path",{d:"M14 4v16",key:"svg-1"}],["path",{d:"M6 4v5",key:"svg-2"}],["path",{d:"M6 15v5",key:"svg-3"}],["path",{d:"M10 4v5",key:"svg-4"}],["path",{d:"M11 9h-6v6h6z",key:"svg-5"}],["path",{d:"M10 15v5",key:"svg-6"}],["path",{d:"M8 12h-.01",key:"svg-7"}]]),sQ=ct("report-analytics","IconReportAnalytics",[["path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2",key:"svg-0"}],["path",{d:"M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}],["path",{d:"M9 17v-5",key:"svg-2"}],["path",{d:"M12 17v-1",key:"svg-3"}],["path",{d:"M15 17v-3",key:"svg-4"}]]),B2=ct("search","IconSearch",[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]]),W2=ct("send","IconSend",[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]]),OMe=ct("strikethrough","IconStrikethrough",[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]]),PMe=ct("subscript","IconSubscript",[["path",{d:"M5 7l8 10m-8 0l8 -10",key:"svg-0"}],["path",{d:"M21 20h-4l3.5 -4a1.73 1.73 0 0 0 -3.5 -2",key:"svg-1"}]]),AMe=ct("superscript","IconSuperscript",[["path",{d:"M5 7l8 10m-8 0l8 -10",key:"svg-0"}],["path",{d:"M21 11h-4l3.5 -4a1.73 1.73 0 0 0 -3.5 -2",key:"svg-1"}]]),MMe=ct("swords","IconSwords",[["path",{d:"M21 3v5l-11 9l-4 4l-3 -3l4 -4l9 -11z",key:"svg-0"}],["path",{d:"M5 13l6 6",key:"svg-1"}],["path",{d:"M14.32 17.32l3.68 3.68l3 -3l-3.365 -3.365",key:"svg-2"}],["path",{d:"M10 5.5l-2 -2.5h-5v5l3 2.5",key:"svg-3"}]]),go=ct("trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]),RMe=ct("underline","IconUnderline",[["path",{d:"M7 5v5a5 5 0 0 0 10 0v-5",key:"svg-0"}],["path",{d:"M5 19h14",key:"svg-1"}]]),DMe=ct("unlink","IconUnlink",[["path",{d:"M17 22v-2",key:"svg-0"}],["path",{d:"M9 15l6 -6",key:"svg-1"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-2"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-3"}],["path",{d:"M20 17h2",key:"svg-4"}],["path",{d:"M2 7h2",key:"svg-5"}],["path",{d:"M7 2v2",key:"svg-6"}]]),zR=ct("user","IconUser",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",key:"svg-1"}]]),oQ=ct("users","IconUsers",[["path",{d:"M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",key:"svg-1"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"svg-2"}],["path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85",key:"svg-3"}]]),ui=ct("x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]),LMe=ct("zoom-exclamation","IconZoomExclamation",[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}],["path",{d:"M10 13v.01",key:"svg-2"}],["path",{d:"M10 7v3",key:"svg-3"}]]);function FMe(){const{messages:e}=DR(),[t,n]=I.exports.useState(""),r=I.exports.useRef(null),{employees:i}=Jo(),a=()=>{t.trim()!==""&&(Ne("addChatMessage",t),n(""))};return I.exports.useEffect(()=>{r.current&&r.current.scrollTo({top:r.current.scrollHeight,behavior:"smooth"})},[e]),x(Bt,{w:450,h:"100%",shadow:"sm",p:"sm",children:B(Ce,{p:20,pt:0,h:"100%",children:[x(Te,{fw:700,size:20,align:"center",children:K.chat}),x(Bt,{h:"72vh",p:20,bg:"dark.8",withBorder:!0,children:B(Ce,{h:"100%",justify:"flex-end",spacing:10,children:[x(An,{h:"100%",scrollbarSize:0,viewportRef:r,children:x(Ce,{justify:"flex-end",spacing:15,h:"100%",children:!e||e.length===0&&x(Te,{fw:450,size:14,align:"center",color:"gray.6",mt:"30vh",children:K.no_messages_yet})||x(ze,{children:e.map((s,o)=>{const l=i.find(u=>u.identifier===s.from);return B(Ce,{w:"100%",spacing:1,children:[B(me,{spacing:8,sx:{alignItems:"end"},children:[x(er,{src:l==null?void 0:l.image,size:28,radius:"md"}),x(Te,{fw:650,size:15,children:l==null?void 0:l.name}),x(Te,{fw:400,size:10,color:"gray.6",children:new Date(s.timestamp*1e3).toLocaleString([],{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})})]}),x(Te,{size:13,style:{wordBreak:"break-all"},children:s.message})]},o)})})})}),x(me,{align:"center",w:"100%",children:x(Xe,{w:"100%",placeholder:K.write,value:t,onChange:s=>n(s.target.value),onKeyDown:s=>{s.key==="Enter"&&a()},rightSection:x(Fe,{variant:"subtle",color:"blue",onClick:a,children:x(W2,{size:20})})})})]})})]})})}function zMe(){const{announcements:e}=LR(),{isBoss:t,dateFormat:n}=tn(),[r,i]=I.exports.useState(""),a=I.exports.useRef(null),s=()=>{if(r.trim()!==""){const c=r.replace(/\n/g,"<br>");Ne("createAnnouncement",c),i("")}},o=I.exports.useCallback(c=>{const d=e.find(p=>p.id===c);d&&Ne("toggleAnnouncementPin",{id:c,pinned:!d.pinned,page:"police"})},[e]),l=I.exports.useCallback(c=>{Ne("removeAnnouncement",{id:c,page:"police"})},[]),u=[...e].sort((c,d)=>c.pinned&&!d.pinned?-1:!c.pinned&&d.pinned?1:new Date(d.date).getTime()-new Date(c.date).getTime());return x(Bt,{w:450,h:"100%",shadow:"sm",p:"sm",children:B(Ce,{p:20,pt:0,h:"100%",children:[x(Te,{fw:700,size:20,align:"center",children:K.announcements}),x(Bt,{h:"72vh",p:20,bg:"dark.8",withBorder:!0,children:B(Ce,{h:"100%",justify:"flex-end",spacing:10,children:[x(An,{h:"100%",scrollbarSize:0,viewportRef:a,children:x(Ce,{justify:"flex-end",spacing:15,h:"100%",children:!u||u.length===0?x(Te,{fw:450,size:14,align:"center",color:"gray.6",mt:"30vh",children:K.no_announcements_yet}):x(ze,{children:u.map((c,d)=>B(Ce,{w:"100%",spacing:1,children:[B(me,{spacing:8,sx:{alignItems:"end"},children:[t&&B(ze,{children:[x(Fe,{variant:"light",color:"red",onClick:()=>l(c.id),children:x(go,{size:20})}),x(Fe,{variant:c.pinned?"filled":"light",color:"blue",onClick:()=>o(c.id),children:x(aQ,{size:20})})]}),x(er,{size:28,radius:"md"}),x(Te,{fw:650,size:15,children:c.creator}),x(Te,{fw:400,size:10,color:"gray.6",children:new Date(c.date*1e3).toLocaleString([],n||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]}),x(Te,{size:13,style:{wordBreak:"break-all"},dangerouslySetInnerHTML:{__html:c.message.replace(/\n/g,"<br>")}}),x(Ds,{mt:15,w:"80%",ml:"10%",color:"dark.5"})]},d))})})}),x(me,{align:"center",w:"100%",children:x(bs,{w:"100%",placeholder:K.write,rightSection:x(Fe,{variant:"subtle",color:"blue",onClick:s,children:x(W2,{size:20})}),disabled:!t,autosize:!0,rows:2,minRows:1,maxRows:4,value:r,onChange:c=>i(c.target.value),onKeyDown:c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),s())}})})]})})]})})}let Mu=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");const gn=AR((e,t)=>({tabs:[],initialTab:null,activeTab:null,setInitialTab:n=>e({initialTab:n}),setTabs:n=>e({tabs:n}),addTab:n=>{if(!t().initialTab&&!n)return;const i=Mu();e(a=>{var s;return{tabs:[...a.tabs,{id:i,title:(n==null?void 0:n.title)||((s=a.initialTab)==null?void 0:s.title)||"",component:(n==null?void 0:n.component)||a.initialTab&&a.initialTab.component}],activeTab:i}})},removeTab:n=>{const r=t();if(!!r.initialTab){if(r.tabs.length===1){r.updateTab({title:r.initialTab.title,component:r.initialTab.component});return}e(i=>{const a=i.tabs.filter(o=>o.id!==n),s=i.activeTab===n&&a.length>0?a[0].id:i.activeTab;return{tabs:a,activeTab:s}})}},setActiveTab:n=>e({activeTab:n}),updateTab:n=>{const r=Mu();e(i=>({tabs:i.tabs.map(a=>a.id===i.activeTab?{...n,id:r}:a),activeTab:r}))}}));function BMe(e,t,n){var r=this,i=I.exports.useRef(null),a=I.exports.useRef(0),s=I.exports.useRef(null),o=I.exports.useRef([]),l=I.exports.useRef(),u=I.exports.useRef(),c=I.exports.useRef(e),d=I.exports.useRef(!0);c.current=e;var p=typeof window<"u",h=!t&&t!==0&&p;if(typeof e!="function")throw new TypeError("Expected a function");t=+t||0;var m=!!(n=n||{}).leading,g=!("trailing"in n)||!!n.trailing,v="maxWait"in n,y="debounceOnServer"in n&&!!n.debounceOnServer,b=v?Math.max(+n.maxWait||0,t):null;I.exports.useEffect(function(){return d.current=!0,function(){d.current=!1}},[]);var _=I.exports.useMemo(function(){var k=function(O){var F=o.current,E=l.current;return o.current=l.current=null,a.current=O,u.current=c.current.apply(E,F)},C=function(O,F){h&&cancelAnimationFrame(s.current),s.current=h?requestAnimationFrame(O):setTimeout(O,F)},$=function(O){if(!d.current)return!1;var F=O-i.current;return!i.current||F>=t||F<0||v&&O-a.current>=b},N=function(O){return s.current=null,g&&o.current?k(O):(o.current=l.current=null,u.current)},A=function O(){var F=Date.now();if($(F))return N(F);if(d.current){var E=t-(F-i.current),z=v?Math.min(E,b-(F-a.current)):E;C(O,z)}},D=function(){if(p||y){var O=Date.now(),F=$(O);if(o.current=[].slice.call(arguments),l.current=r,i.current=O,F){if(!s.current&&d.current)return a.current=i.current,C(A,t),m?k(i.current):u.current;if(v)return C(A,t),k(i.current)}return s.current||C(A,t),u.current}};return D.cancel=function(){s.current&&(h?cancelAnimationFrame(s.current):clearTimeout(s.current)),a.current=0,o.current=i.current=l.current=s.current=null},D.isPending=function(){return!!s.current},D.flush=function(){return s.current?N(Date.now()):u.current},D},[m,v,t,b,g,h,p,y]);return _}function WMe(e,t){return e===t}function VMe(e,t){return t}function Kt(e,t,n){var r=n&&n.equalityFn||WMe,i=I.exports.useReducer(VMe,e),a=i[0],s=i[1],o=BMe(I.exports.useCallback(function(u){return s(u)},[s]),t,n),l=I.exports.useRef(e);return r(l.current,e)||(o(e),l.current=e),[a,o]}function Aj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sP(e,t){return sP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},sP(e,t)}function jMe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,sP(e,t)}var Mj=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function UMe(e,t){return!!(e===t||Mj(e)&&Mj(t))}function HMe(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!UMe(e[n],t[n]))return!1;return!0}function KN(e,t){t===void 0&&(t=HMe);var n,r=[],i,a=!1;function s(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];return a&&n===this&&t(o,r)||(i=e.apply(this,o),a=!0,n=this,r=o),i}return s}var GMe=typeof performance=="object"&&typeof performance.now=="function",Rj=GMe?function(){return performance.now()}:function(){return Date.now()};function Dj(e){cancelAnimationFrame(e.id)}function qMe(e,t){var n=Rj();function r(){Rj()-n>=t?e.call(null):i.id=requestAnimationFrame(r)}var i={id:requestAnimationFrame(r)};return i}var ZN=-1;function Lj(e){if(e===void 0&&(e=!1),ZN===-1||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(t),ZN=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return ZN}var Rm=null;function Fj(e){if(e===void 0&&(e=!1),Rm===null||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var r=document.createElement("div"),i=r.style;return i.width="100px",i.height="100px",t.appendChild(r),document.body.appendChild(t),t.scrollLeft>0?Rm="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?Rm="negative":Rm="positive-ascending"),document.body.removeChild(t),Rm}return Rm}var KMe=150,ZMe=function(t,n){return t};function XMe(e){var t,n=e.getItemOffset,r=e.getEstimatedTotalSize,i=e.getItemSize,a=e.getOffsetForIndexAndAlignment,s=e.getStartIndexForOffset,o=e.getStopIndexForStartIndex,l=e.initInstanceProps,u=e.shouldResetStyleCacheOnItemSizeChange,c=e.validateProps;return t=function(d){jMe(p,d);function p(m){var g;return g=d.call(this,m)||this,g._instanceProps=l(g.props,Aj(g)),g._outerRef=void 0,g._resetIsScrollingTimeoutId=null,g.state={instance:Aj(g),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof g.props.initialScrollOffset=="number"?g.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},g._callOnItemsRendered=void 0,g._callOnItemsRendered=KN(function(v,y,b,_){return g.props.onItemsRendered({overscanStartIndex:v,overscanStopIndex:y,visibleStartIndex:b,visibleStopIndex:_})}),g._callOnScroll=void 0,g._callOnScroll=KN(function(v,y,b){return g.props.onScroll({scrollDirection:v,scrollOffset:y,scrollUpdateWasRequested:b})}),g._getItemStyle=void 0,g._getItemStyle=function(v){var y=g.props,b=y.direction,_=y.itemSize,k=y.layout,C=g._getItemStyleCache(u&&_,u&&k,u&&b),$;if(C.hasOwnProperty(v))$=C[v];else{var N=n(g.props,v,g._instanceProps),A=i(g.props,v,g._instanceProps),D=b==="horizontal"||k==="horizontal",O=b==="rtl",F=D?N:0;C[v]=$={position:"absolute",left:O?void 0:F,right:O?F:void 0,top:D?0:N,height:D?"100%":A,width:D?A:"100%"}}return $},g._getItemStyleCache=void 0,g._getItemStyleCache=KN(function(v,y,b){return{}}),g._onScrollHorizontal=function(v){var y=v.currentTarget,b=y.clientWidth,_=y.scrollLeft,k=y.scrollWidth;g.setState(function(C){if(C.scrollOffset===_)return null;var $=g.props.direction,N=_;if($==="rtl")switch(Fj()){case"negative":N=-_;break;case"positive-descending":N=k-b-_;break}return N=Math.max(0,Math.min(N,k-b)),{isScrolling:!0,scrollDirection:C.scrollOffset<N?"forward":"backward",scrollOffset:N,scrollUpdateWasRequested:!1}},g._resetIsScrollingDebounced)},g._onScrollVertical=function(v){var y=v.currentTarget,b=y.clientHeight,_=y.scrollHeight,k=y.scrollTop;g.setState(function(C){if(C.scrollOffset===k)return null;var $=Math.max(0,Math.min(k,_-b));return{isScrolling:!0,scrollDirection:C.scrollOffset<$?"forward":"backward",scrollOffset:$,scrollUpdateWasRequested:!1}},g._resetIsScrollingDebounced)},g._outerRefSetter=function(v){var y=g.props.outerRef;g._outerRef=v,typeof y=="function"?y(v):y!=null&&typeof y=="object"&&y.hasOwnProperty("current")&&(y.current=v)},g._resetIsScrollingDebounced=function(){g._resetIsScrollingTimeoutId!==null&&Dj(g._resetIsScrollingTimeoutId),g._resetIsScrollingTimeoutId=qMe(g._resetIsScrolling,KMe)},g._resetIsScrolling=function(){g._resetIsScrollingTimeoutId=null,g.setState({isScrolling:!1},function(){g._getItemStyleCache(-1,null)})},g}p.getDerivedStateFromProps=function(g,v){return JMe(g,v),c(g),null};var h=p.prototype;return h.scrollTo=function(g){g=Math.max(0,g),this.setState(function(v){return v.scrollOffset===g?null:{scrollDirection:v.scrollOffset<g?"forward":"backward",scrollOffset:g,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},h.scrollToItem=function(g,v){v===void 0&&(v="auto");var y=this.props,b=y.itemCount,_=y.layout,k=this.state.scrollOffset;g=Math.max(0,Math.min(g,b-1));var C=0;if(this._outerRef){var $=this._outerRef;_==="vertical"?C=$.scrollWidth>$.clientWidth?Lj():0:C=$.scrollHeight>$.clientHeight?Lj():0}this.scrollTo(a(this.props,g,v,k,this._instanceProps,C))},h.componentDidMount=function(){var g=this.props,v=g.direction,y=g.initialScrollOffset,b=g.layout;if(typeof y=="number"&&this._outerRef!=null){var _=this._outerRef;v==="horizontal"||b==="horizontal"?_.scrollLeft=y:_.scrollTop=y}this._callPropsCallbacks()},h.componentDidUpdate=function(){var g=this.props,v=g.direction,y=g.layout,b=this.state,_=b.scrollOffset,k=b.scrollUpdateWasRequested;if(k&&this._outerRef!=null){var C=this._outerRef;if(v==="horizontal"||y==="horizontal")if(v==="rtl")switch(Fj()){case"negative":C.scrollLeft=-_;break;case"positive-ascending":C.scrollLeft=_;break;default:var $=C.clientWidth,N=C.scrollWidth;C.scrollLeft=N-$-_;break}else C.scrollLeft=_;else C.scrollTop=_}this._callPropsCallbacks()},h.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&Dj(this._resetIsScrollingTimeoutId)},h.render=function(){var g=this.props,v=g.children,y=g.className,b=g.direction,_=g.height,k=g.innerRef,C=g.innerElementType,$=g.innerTagName,N=g.itemCount,A=g.itemData,D=g.itemKey,O=D===void 0?ZMe:D,F=g.layout,E=g.outerElementType,z=g.outerTagName,q=g.style,H=g.useIsScrolling,J=g.width,ee=this.state.isScrolling,V=b==="horizontal"||F==="horizontal",Q=V?this._onScrollHorizontal:this._onScrollVertical,X=this._getRangeToRender(),Y=X[0],ce=X[1],pe=[];if(N>0)for(var fe=Y;fe<=ce;fe++)pe.push(I.exports.createElement(v,{data:A,key:O(fe,A),index:fe,isScrolling:H?ee:void 0,style:this._getItemStyle(fe)}));var ye=r(this.props,this._instanceProps);return I.exports.createElement(E||z||"div",{className:y,onScroll:Q,ref:this._outerRefSetter,style:ar({position:"relative",height:_,width:J,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:b},q)},I.exports.createElement(C||$||"div",{children:pe,ref:k,style:{height:V?"100%":ye,pointerEvents:ee?"none":void 0,width:V?ye:"100%"}}))},h._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var g=this.props.itemCount;if(g>0){var v=this._getRangeToRender(),y=v[0],b=v[1],_=v[2],k=v[3];this._callOnItemsRendered(y,b,_,k)}}if(typeof this.props.onScroll=="function"){var C=this.state,$=C.scrollDirection,N=C.scrollOffset,A=C.scrollUpdateWasRequested;this._callOnScroll($,N,A)}},h._getRangeToRender=function(){var g=this.props,v=g.itemCount,y=g.overscanCount,b=this.state,_=b.isScrolling,k=b.scrollDirection,C=b.scrollOffset;if(v===0)return[0,0,0,0];var $=s(this.props,C,this._instanceProps),N=o(this.props,$,C,this._instanceProps),A=!_||k==="backward"?Math.max(1,y):1,D=!_||k==="forward"?Math.max(1,y):1;return[Math.max(0,$-A),Math.max(0,Math.min(v-1,N+D)),$,N]},p}(I.exports.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var JMe=function(t,n){t.children,t.direction,t.height,t.layout,t.innerTagName,t.outerTagName,t.width,n.instance},ta=XMe({getItemOffset:function(t,n){var r=t.itemSize;return n*r},getItemSize:function(t,n){var r=t.itemSize;return r},getEstimatedTotalSize:function(t){var n=t.itemCount,r=t.itemSize;return r*n},getOffsetForIndexAndAlignment:function(t,n,r,i,a,s){var o=t.direction,l=t.height,u=t.itemCount,c=t.itemSize,d=t.layout,p=t.width,h=o==="horizontal"||d==="horizontal",m=h?p:l,g=Math.max(0,u*c-m),v=Math.min(g,n*c),y=Math.max(0,n*c-m+c+s);switch(r==="smart"&&(i>=y-m&&i<=v+m?r="auto":r="center"),r){case"start":return v;case"end":return y;case"center":{var b=Math.round(y+(v-y)/2);return b<Math.ceil(m/2)?0:b>g+Math.floor(m/2)?g:b}case"auto":default:return i>=y&&i<=v?i:i<y?y:v}},getStartIndexForOffset:function(t,n){var r=t.itemCount,i=t.itemSize;return Math.max(0,Math.min(r-1,Math.floor(n/i)))},getStopIndexForStartIndex:function(t,n,r){var i=t.direction,a=t.height,s=t.itemCount,o=t.itemSize,l=t.layout,u=t.width,c=i==="horizontal"||l==="horizontal",d=n*o,p=c?u:a,h=Math.ceil((p+r-d)/o);return Math.max(0,Math.min(s-1,n+h-1))},initInstanceProps:function(t){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(t){t.itemSize}});function kg(e,t){const{tags:n}=Ey.getState(),{playerJob:r,playerGrade:i}=tn.getState();return e.filter(a=>{var c,d,p;let s=(c=a==null?void 0:a.sideBarData)==null?void 0:c.tags;if((!s||s.length===0)&&(s=(p=(d=t==null?void 0:t.find(h=>h.id===a.id))==null?void 0:d.sideBarData)==null?void 0:p.tags,!s||s.length===0))return!0;const o=n.filter(h=>s.includes(h.name)),l=Math.max(...o.map(h=>h.minGrade||0));return o.some(h=>{var m;return(m=h.grades)==null?void 0:m.some(g=>g.job===r&&g.id===i)})||i>=l})}function YMe(e){var l;const{tags:t}=Ey.getState(),{playerJob:n,playerGrade:r}=tn.getState();let i=(l=e==null?void 0:e.sideBarData)==null?void 0:l.tags;if(!i||i.length===0)return!0;const a=t.filter(u=>i.includes(u.name)),s=Math.max(...a.map(u=>u.minGrade||0));return a.some(u=>{var c;return(c=u.grades)==null?void 0:c.some(d=>d.job===n&&d.id===r)})||r>=s}function QMe({searchQuery:e,filters:t}){const{incidents:n,updateIncident:r}=$d(),{updateTab:i}=gn(),{dateFormat:a}=tn(),s=I.exports.useMemo(()=>n.filter(l=>{var d,p,h,m,g,v,y,b;if(!YMe(l))return!1;const u=((d=l.title)==null?void 0:d.toLowerCase().includes(e.toLowerCase()))||((p=l.id)==null?void 0:p.toString())===e||l.sideBarData&&(((m=(h=l.sideBarData)==null?void 0:h.officers)==null?void 0:m.some(_=>_.name.toLowerCase().includes(e.toLowerCase())))||((v=(g=l.sideBarData)==null?void 0:g.criminals)==null?void 0:v.some(_=>_.name.toLowerCase().includes(e.toLowerCase())))||((b=(y=l.sideBarData)==null?void 0:y.civilians)==null?void 0:b.some(_=>_.name.toLowerCase().includes(e.toLowerCase()))));if(!t)return u;const c=t.every(_=>{if(!l.sideBarData)return!1;let k;if(_.type in l.sideBarData?k=l.sideBarData[_.type]:k=l[_.type],Array.isArray(k)&&k.length>0){if(typeof k[0]=="object")return k.some(C=>Object.values(C).some($=>typeof $=="string"?$.toLowerCase().includes(_.value.toLowerCase()):!1));if(typeof k[0]=="string")return k.some(C=>C.toLowerCase().includes(_.value.toLowerCase()))}return typeof k=="string"?k.toLowerCase().includes(_.value.toLowerCase()):!1});return u&&c}).sort((l,u)=>u.id-l.id),[e,t,n]),o=({index:l,style:u})=>{var d,p;const c=s[l];return c.id<=-1?null:x("div",{style:{...u},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getIncident",c.id).then(h=>{!h||!c.id||r(c.id,h)}),i({title:"incidents",component:x(tx,{incidentId:c.id})})},p:10,children:x(me,{spacing:15,children:B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:c.title}),B(bt,{radius:"sm",children:["ID: ",c.id]})]}),((d=c.sideBarData)==null?void 0:d.officers)&&c.sideBarData.officers.length>0&&B(Te,{w:700,fw:500,size:13,color:"gray.4",style:{overflow:"hidden",wordBreak:"break-all",textOverflow:"ellipsis"},children:[K.officers_list," ",c.sideBarData.officers.map(h=>h.name).join(", ")]}),((p=c.sideBarData)==null?void 0:p.criminals)&&c.sideBarData.criminals.length>0&&B(Te,{w:700,fw:500,size:13,color:"gray.4",style:{overflow:"hidden",wordBreak:"break-all",textOverflow:"ellipsis"},children:[K.criminals_list," ",c.sideBarData.criminals.map(h=>h.name).join(", ")]}),x(Te,{fw:500,size:12,color:"gray.5",children:new Date(c.date*1e3).toLocaleString([],a||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]})})})})};return x(ta,{height:window.innerHeight*.77,itemCount:s.length,itemSize:110,width:"100%",children:o})}function xa({title:e,searchQuery:t,filterInputs:n,filters:r,setFilterInputs:i,setSearchQuery:a,setFilters:s,createNew:o,openFacialRecognition:l}){const[u,{open:c,close:d}]=$r(!1),p=(v,y)=>{if(!n||!i)return;const b=[...n];b[v].value=y,i(b)},h=()=>{!n||!s||(s(n.filter(v=>v.value!=="")),d())},m=()=>{if(!n||!s||!i)return;const v=n.map(y=>({...y,value:""}));i(v),s([]),d()};I.exports.useEffect(()=>{!i||!n||i(n.map(v=>{var y;return{...v,value:((y=r==null?void 0:r.find(b=>b.type===v.type))==null?void 0:y.value)||""}}))},[u]);const g=(r==null?void 0:r.filter(v=>v.value!=="").length)||0;return B(ze,{children:[x(Bt,{w:"100%",color:"dark.6",radius:"xs",py:5,px:10,shadow:"xs",mb:10,children:B(me,{position:"apart",h:"100%",children:[x(Te,{fw:650,size:24,children:e}),B(me,{spacing:10,children:[o&&x(Ct,{variant:"subtle",leftIcon:x(Oy,{}),onClick:o,children:K.create_new}),n&&B(Ct,{variant:"subtle",leftIcon:x(cMe,{}),onClick:c,children:[K.filters," ",g>0&&`(${g})`]}),l&&x(Ct,{variant:"subtle",leftIcon:x(uMe,{}),onClick:l,children:K.facial_recognition}),x(Xe,{placeholder:K.search,rightSection:x(B2,{}),w:400,value:t,onChange:v=>a(v.currentTarget.value)})]})]})}),n&&x(sr,{title:K.advanced_filters,opened:u,onClose:d,size:"xs",centered:!0,children:B(Ce,{spacing:20,w:"100%",children:[n.map((v,y)=>x(Xe,{placeholder:K[v.type],value:v.value,onChange:b=>p(y,b.currentTarget.value)},v.type)),B(me,{position:"center",grow:!0,children:[x(Ct,{variant:"outline",onClick:m,children:K.clear_filters}),x(Ct,{variant:"outline",onClick:h,children:K.apply_filters})]})]})})]})}function oP(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200),[r,i]=I.exports.useState(),[a,s]=I.exports.useState([{type:"creator",value:""},{type:"tags",value:""},{type:"officers",value:""},{type:"criminals",value:""},{type:"civilians",value:""}]),{updateTab:o}=gn(),l=()=>{Ne("createIncident").then(u=>{!u||o({title:"incidents",component:x(tx,{incidentId:u.id})})})};return B(ze,{children:[x(xa,{title:K.incidents,searchQuery:e,filterInputs:a,filters:r,setFilterInputs:s,setSearchQuery:t,setFilters:i,createNew:l}),x(QMe,{searchQuery:n,filters:r})]})}const BR=I.exports.createContext(null);BR.displayName="@mantine/modals/ModalsContext";function eRe(){const e=I.exports.useContext(BR);if(!e)throw new Error("[@mantine/modals] useModals hook was called outside of context, wrap your app with ModalsProvider component");return e}var tRe=Object.defineProperty,nRe=Object.defineProperties,rRe=Object.getOwnPropertyDescriptors,zj=Object.getOwnPropertySymbols,iRe=Object.prototype.hasOwnProperty,aRe=Object.prototype.propertyIsEnumerable,Bj=(e,t,n)=>t in e?tRe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,XN=(e,t)=>{for(var n in t||(t={}))iRe.call(t,n)&&Bj(e,n,t[n]);if(zj)for(var n of zj(t))aRe.call(t,n)&&Bj(e,n,t[n]);return e},Wj=(e,t)=>nRe(e,rRe(t));function sRe({id:e,cancelProps:t,confirmProps:n,labels:r={cancel:"",confirm:""},closeOnConfirm:i=!0,closeOnCancel:a=!0,groupProps:s,onCancel:o,onConfirm:l,children:u}){const{cancel:c,confirm:d}=r,p=eRe(),h=g=>{typeof(t==null?void 0:t.onClick)=="function"&&(t==null||t.onClick(g)),typeof o=="function"&&o(),a&&p.closeModal(e)},m=g=>{typeof(n==null?void 0:n.onClick)=="function"&&(n==null||n.onClick(g)),typeof l=="function"&&l(),i&&p.closeModal(e)};return B(ze,{children:[u&&x(wt,{mb:"md",children:u}),B(me,{...XN({position:"right"},s),children:[x(Ct,{...Wj(XN({variant:"default"},t),{onClick:h}),children:(t==null?void 0:t.children)||c}),x(Ct,{...Wj(XN({},n),{onClick:m}),children:(n==null?void 0:n.children)||d})]})]})}function Vj(e,t){var n,r,i,a;t&&e.type==="confirm"&&((r=(n=e.props).onCancel)==null||r.call(n)),(a=(i=e.props).onClose)==null||a.call(i)}function oRe(e,t){switch(t.type){case"OPEN":return{current:t.modal,modals:[...e.modals,t.modal]};case"CLOSE":{const n=e.modals.find(i=>i.id===t.modalId);if(!n)return e;Vj(n,t.canceled);const r=e.modals.filter(i=>i.id!==t.modalId);return{current:r[r.length-1]||e.current,modals:r}}case"CLOSE_ALL":return e.modals.length?(e.modals.concat().reverse().forEach(n=>{Vj(n,t.canceled)}),{current:e.current,modals:[]}):e;default:return e}}const[lRe,U1]=Tge("mantine-modals"),uRe=U1("openModal"),cRe=U1("closeModal"),dRe=U1("closeAllModals"),pRe=U1("openConfirmModal"),hRe=e=>U1("openContextModal")(e),In={open:uRe,close:cRe,closeAll:dRe,openConfirmModal:pRe,openContextModal:hRe};var fRe=Object.defineProperty,mRe=Object.defineProperties,gRe=Object.getOwnPropertyDescriptors,BC=Object.getOwnPropertySymbols,lQ=Object.prototype.hasOwnProperty,uQ=Object.prototype.propertyIsEnumerable,jj=(e,t,n)=>t in e?fRe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rk=(e,t)=>{for(var n in t||(t={}))lQ.call(t,n)&&jj(e,n,t[n]);if(BC)for(var n of BC(t))uQ.call(t,n)&&jj(e,n,t[n]);return e},Uj=(e,t)=>mRe(e,gRe(t)),op=(e,t)=>{var n={};for(var r in e)lQ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&BC)for(var r of BC(e))t.indexOf(r)<0&&uQ.call(e,r)&&(n[r]=e[r]);return n};function yRe(e){if(!e)return{confirmProps:{},modalProps:{}};const t=e,{id:n,children:r,onCancel:i,onConfirm:a,closeOnConfirm:s,closeOnCancel:o,cancelProps:l,confirmProps:u,groupProps:c,labels:d}=t,p=op(t,["id","children","onCancel","onConfirm","closeOnConfirm","closeOnCancel","cancelProps","confirmProps","groupProps","labels"]);return{confirmProps:{id:n,children:r,onCancel:i,onConfirm:a,closeOnConfirm:s,closeOnCancel:o,cancelProps:l,confirmProps:u,groupProps:c,labels:d},modalProps:rk({id:n},p)}}function vRe({children:e,modalProps:t,labels:n,modals:r}){const[i,a]=I.exports.useReducer(oRe,{modals:[],current:null}),s=I.exports.useRef(i);s.current=i;const o=I.exports.useCallback(v=>{a({type:"CLOSE_ALL",canceled:v})},[s,a]),l=I.exports.useCallback(v=>{var y=v,{modalId:b}=y,_=op(y,["modalId"]);const k=b||vg();return a({type:"OPEN",modal:{id:k,type:"content",props:_}}),k},[a]),u=I.exports.useCallback(v=>{var y=v,{modalId:b}=y,_=op(y,["modalId"]);const k=b||vg();return a({type:"OPEN",modal:{id:k,type:"confirm",props:_}}),k},[a]),c=I.exports.useCallback((v,y)=>{var b=y,{modalId:_}=b,k=op(b,["modalId"]);const C=_||vg();return a({type:"OPEN",modal:{id:C,type:"context",props:k,ctx:v}}),C},[a]),d=I.exports.useCallback((v,y)=>{a({type:"CLOSE",modalId:v,canceled:y})},[s,a]);lRe({openModal:l,openConfirmModal:u,openContextModal:v=>{var y=v,{modal:b}=y,_=op(y,["modal"]);return c(b,_)},closeModal:d,closeContextModal:d,closeAllModals:o});const p={modals:i.modals,openModal:l,openConfirmModal:u,openContextModal:c,closeModal:d,closeContextModal:d,closeAll:o},h=()=>{const v=s.current.current;switch(v==null?void 0:v.type){case"context":{const y=v.props,{innerProps:b}=y,_=op(y,["innerProps"]),k=r[v.ctx];return{modalProps:_,content:x(k,{innerProps:b,context:p,id:v.id})}}case"confirm":{const{modalProps:y,confirmProps:b}=yRe(v.props);return{modalProps:y,content:x(sRe,{...Uj(rk({},b),{id:v.id,labels:v.props.labels||n})})}}case"content":{const y=v.props,{children:b}=y;return{modalProps:op(y,["children"]),content:x(ze,{children:b})}}default:return{modalProps:{},content:null}}},{modalProps:m,content:g}=h();return B(BR.Provider,{value:p,children:[x(sr,{...Uj(rk(rk({zIndex:Sd("modal")+1},t),m),{opened:i.modals.length>0,onClose:()=>d(i.current.id)}),children:g}),e]})}const cQ=Tr(e=>({grades:[],addGrade:(t,n,r,i)=>e(a=>({grades:[...a.grades,{id:t,job:n,jobLabel:r,gradeLabel:i}]})),setGrades:t=>e({grades:t})}));function dQ({currentTags:e,pageId:t,updateData:n}){const[r,i]=I.exports.useState([]),{tags:a}=Ey(),[s,o]=I.exports.useState("#FFFFFF"),[l,u]=I.exports.useState(""),[c,d]=I.exports.useState(""),[p,h]=I.exports.useState(!1),[m,g]=I.exports.useState([]),{grades:v}=cQ(),{playerGrade:y,isBoss:b}=tn();return I.exports.useEffect(()=>{i([...r,...e])},[]),I.exports.useEffect(()=>{var k;const _=(k=a.find(C=>C.name===r[0]))==null?void 0:k.grades;!_||g([...m,..._.map(C=>`${C.job}-${C.id}`)])},[]),x(ze,{children:B(Ce,{spacing:20,children:[p?B(ze,{children:[x(Xe,{label:K.tag_name,placeholder:K.tag_name,variant:"filled",value:l,onChange:_=>u(_.currentTarget.value),required:!0}),x(TR,{w:"100%",color:s,onChange:_=>{o(_)},format:"hex",swatches:["#25262b","#868e96","#fa5252","#e64980","#be4bdb","#7950f2","#4c6ef5","#228be6","#15aabf","#12b886","#40c057","#82c91e","#fab005","#fd7e14"]}),x(cu,{label:K.minimum_grade,placeholder:K.minimum_grade,variant:"filled",value:c,min:0,max:y,onChange:d}),x(Au,{label:K.grades,placeholder:K.select_grades,searchable:!0,clearable:!0,data:v.sort((_,k)=>_.id<k.id?-1:1).map(_=>({value:`${_.job}-${_.id}`,label:`${_.jobLabel} - ${_.gradeLabel} (ID: ${_.id})`})),value:m,onChange:g,limit:25})]}):x(Au,{data:kg(a).map(_=>({value:_.name,label:_.name})),value:r,onChange:i,placeholder:K.select_tags,searchable:!0,clearable:!0,withinPortal:!0,nothingFound:K.nothing_found,limit:25}),B(me,{position:"apart",children:[x(Hg,{disabled:!b,label:K.create_new,checked:p,onChange:_=>h(_.currentTarget.checked)}),x(Ct,{onClick:()=>{if(p){if(!l||a.find(k=>k.name===l))return;const _=m.length>0&&m.map(k=>({job:k.split("-")[0],id:parseInt(k.split("-")[1],10)}))||void 0;Ne("addTag",{name:l,color:s,minGrade:typeof c=="number"?c:null,grades:_}).then(k=>{!k||n(t,{sideBarData:{tags:[...e,l]}})})}else n(t,{sideBarData:{tags:r.map(_=>_)}});In.closeAll()},children:K.confirm})]})]})})}const pQ=Tr(e=>({licenses:[],setLicenses:t=>e({licenses:t})}));function bRe({currentLicenses:e,pageId:t,updateData:n}){const[r,i]=I.exports.useState([]),{licenses:a}=pQ();return I.exports.useEffect(()=>{i([...r,...e.map(s=>s)])},[]),x(ze,{children:B(Ce,{spacing:20,children:[x(Au,{data:a.map(s=>({value:s,label:K[s]||s})),value:r,onChange:i,placeholder:K.select_licenses,searchable:!0,clearable:!0,withinPortal:!0,nothingFound:K.nothing_found,limit:25}),x(me,{position:"right",children:x(Ct,{onClick:()=>{n(t,{sideBarData:{licenses:r.map(s=>s)}}),In.closeAll()},children:K.confirm})})]})})}const Hj=({label:e,...t})=>{const[n,r]=e.split(" (ID: "),i=r.slice(0,-1);return B("div",{...t,children:[x("div",{children:n}),B("div",{style:{fontSize:"small",color:"gray"},children:["ID: ",i]})]})};function qg({title:e,allPlayers:t,currentPlayers:n,pageId:r,includeReason:i,setTrainee:a,updateData:s}){const[o,l]=I.exports.useState(I.exports.useMemo(()=>(n==null?void 0:n.map(m=>m.identifier))||[],[n])),[u,c]=I.exports.useState(""),[d,p]=I.exports.useState(""),h=I.exports.useMemo(()=>{const m=new Set(n==null?void 0:n.map(g=>g.identifier));return t.filter(g=>g.identifier!==r&&!m.has(g.identifier)).map(g=>({value:g.identifier,label:`${g.name} (ID: ${g.identifier})`}))},[t,n,r]);return x(ze,{children:B(Ce,{spacing:20,children:[i||a?B(ze,{children:[x(ER,{data:h,value:u,onChange:m=>c(m),placeholder:K.select_player,searchable:!0,clearable:!0,withinPortal:!0,nothingFound:K.nothing_found,itemComponent:Hj,limit:25}),i&&x(Xe,{placeholder:K.reason,label:K.reason,value:d,onChange:m=>p(m.currentTarget.value)})]}):x(Au,{data:t.map(m=>({value:m.identifier,label:`${m.name} (ID: ${m.identifier})`})),value:o,onChange:l,placeholder:K.select_players,searchable:!0,clearable:!0,withinPortal:!0,nothingFound:K.nothing_found,itemComponent:Hj,limit:25}),x(me,{position:"right",children:x(Ct,{onClick:()=>{var m;if(!r||!n||!e||!s){a&&a(u);return}if(i){if(!u||!d)return;s(r,{sideBarData:{[e]:[...n,{name:(m=t.find(g=>g.identifier===u))==null?void 0:m.name,identifier:u,reason:d}]}})}else s(r,{sideBarData:{[e]:o.map(g=>{const v=t.find(_=>_.identifier===g),y=n.find(_=>_.identifier===g);return{...v,...y}})}});In.closeAll()},children:K.confirm})})]})})}function wRe({currentEvidence:e,pageId:t,updateData:n}){const[r,i]=I.exports.useState([]),{evidence:a}=V1();I.exports.useEffect(()=>{i(e.map(o=>o.toString()))},[]);const s=()=>{const o=r.map(l=>parseInt(l,10));n(t,{sideBarData:{evidence:o}}),In.closeAll()};return x(ze,{children:B(Ce,{spacing:20,children:[x(Au,{data:a.map(o=>({value:o.id.toString(),label:`${o.name} (ID: ${o.id})`})),value:r,onChange:i,placeholder:K.select_evidence,searchable:!0,clearable:!0,withinPortal:!0,nothingFound:K.nothing_found,limit:25}),x(me,{position:"right",children:x(Ct,{onClick:s,children:K.confirm})})]})})}function xRe({currentVehicles:e,pageId:t,updateData:n}){const[r,i]=I.exports.useState([]),{vehicles:a}=Th();I.exports.useEffect(()=>{i(e.map(o=>o.plate))},[]);const s=()=>{const o=r.map(l=>{const u=a.find(c=>c.plate===l);return{plate:l,name:u==null?void 0:u.name}});n(t,{sideBarData:{vehicles:o}}),In.closeAll()};return x(ze,{children:B(Ce,{spacing:20,children:[x(Au,{data:a.map(o=>({value:o.plate,label:`${o.name} [${o.plate}]`})),value:r,onChange:i,placeholder:K.select_vehicles,searchable:!0,clearable:!0,withinPortal:!0,nothingFound:K.nothing_found,limit:25}),x(me,{position:"right",children:x(Ct,{onClick:s,children:K.confirm})})]})})}function ik({title:e,allReports:t,currentReports:n,pageId:r,updateData:i}){const[a,s]=I.exports.useState([]);I.exports.useEffect(()=>{n=kg(n,t),t=kg(t),s(n.map(l=>l.toString()))},[]);const o=()=>{const l=a.map(u=>parseInt(u,10));i(r,{sideBarData:{[e]:l}}),In.closeAll()};return x(ze,{children:B(Ce,{spacing:20,children:[x(Au,{data:kg(t).filter(l=>l.id!==r).map(l=>({value:l.id.toString(),label:`${l.title} (ID: ${l.id})`})),value:a,onChange:s,placeholder:K.select_reports,searchable:!0,clearable:!0,withinPortal:!0,nothingFound:K.nothing_found,limit:25}),x(me,{position:"right",children:x(Ct,{onClick:o,children:K.confirm})})]})})}function hQ({opened:e,chargeId:t,close:n}){const{charges:r}=z2(),[i,a]=I.exports.useState({id:0,name:"",class:"",fine:{default:0},sentence:{default:0},points:0});I.exports.useEffect(()=>{if(!!e&&(a({id:0,name:"",class:"",fine:{default:0},sentence:{default:0},points:0}),t)){const o=r.find(l=>l.id===t);if(!o)return;a(o)}},[e]);const s=()=>{if(!(!i.name||!i.class)){if(n(),t){Ne("updateCharge",i);return}Ne("createCharge",i)}};return x(sr,{size:"30%",centered:!0,title:K.create_charge,opened:e,onClose:n,children:B(Ce,{spacing:30,children:[x(Xe,{label:K.charge_name,placeholder:K.charge_name,value:i==null?void 0:i.name,onChange:o=>a({...i,name:o.currentTarget.value}),required:!0}),x(Xe,{label:K.class,placeholder:K.class,value:i==null?void 0:i.class,onChange:o=>a({...i,class:o.currentTarget.value}),required:!0}),x(bs,{label:K.description,placeholder:K.description,value:i==null?void 0:i.description,onChange:o=>a({...i,description:o.currentTarget.value})}),B(me,{w:"100%",spacing:20,grow:!0,children:[x(cu,{label:K.fine,value:i==null?void 0:i.fine.default,onChange:o=>a({...i,fine:{...i.fine,default:Number(o)}}),required:!0}),x(cu,{label:K.fine_min,value:i==null?void 0:i.fine.min,onChange:o=>a({...i,fine:{...i.fine,min:Number(o)}})}),x(cu,{label:K.fine_max,value:i==null?void 0:i.fine.max,onChange:o=>a({...i,fine:{...i.fine,max:Number(o)}})})]}),B(me,{w:"100%",spacing:20,grow:!0,children:[x(cu,{label:K.sentence,value:i==null?void 0:i.sentence.default,onChange:o=>a({...i,sentence:{...i.sentence,default:Number(o)}}),required:!0}),x(cu,{label:K.sentence_min,value:i==null?void 0:i.sentence.min,onChange:o=>a({...i,sentence:{...i.sentence,min:Number(o)}})}),x(cu,{label:K.sentence_max,value:i==null?void 0:i.sentence.max,onChange:o=>a({...i,sentence:{...i.sentence,max:Number(o)}})})]}),x(me,{w:"100%",spacing:10,grow:!0,children:x(cu,{label:K.license_points,value:i==null?void 0:i.points,onChange:o=>a({...i,points:Number(o)})})}),x(Ct,{onClick:s,children:"Confirm"})]})})}function _Re({isCitizen:e,searchQuery:t,incidentId:n,identifier:r,addCharge:i}){const{charges:a}=z2(),{incidents:s,removeChargeWithId:o}=$d(),[l,{open:u,close:c}]=$r(!1),[d,p]=I.exports.useState(),{isBoss:h}=tn(),m=new Intl.NumberFormat,g=!e&&h,v=I.exports.useMemo(()=>{const _=a.filter(C=>C.name.toLowerCase().includes(t.toLowerCase())||C.class.toLowerCase().includes(t.toLowerCase())).sort((C,$)=>C.name.localeCompare($.name)),k={};return _.forEach(C=>{k[C.class]||(k[C.class]=[]),k[C.class].push(C)}),k},[a,t]),y=_=>{Ne("removeCharge",_)},b=I.exports.useMemo(()=>{var _,k,C,$;return(($=(C=(k=(_=s.find(N=>N.id===n))==null?void 0:_.sideBarData)==null?void 0:k.criminals)==null?void 0:C.find(N=>N.identifier===r))==null?void 0:$.charges)||[]},[s,n,r]);return B(ze,{children:[b.length>0&&x(me,{spacing:10,w:"100%",my:20,children:b.map(_=>{const{id:k,amount:C}=_,$=a.find(N=>N.id===k);return $?B(bt,{color:"gray",rightSection:x(Fe,{size:14,variant:"transparent",onClick:()=>{!n||!r||o(n,r,k)},children:x(ui,{})}),children:[$.name," x",C]},k):null}).filter(Boolean)}),x(An,{w:"100%",h:"75vh",scrollHideDelay:0,scrollbarSize:5,children:x(Ce,{spacing:15,children:Object.keys(v).map((_,k)=>B(Ce,{spacing:5,children:[x(Te,{fw:600,size:20,children:_}),x(me,{spacing:10,children:v[_].map(C=>B(xg,{width:280,shadow:"md",disabled:!C.description,position:"top",withArrow:!0,withinPortal:!0,openDelay:400,children:[x(xg.Target,{children:x(Bt,{w:"19%",radius:"xs",p:10,shadow:"xs",bg:"dark.7",style:{cursor:i?"pointer":"default"},onClick:()=>{!i||i(C)},children:B(Ce,{align:"center",spacing:10,children:[B(Ce,{spacing:2,children:[x(Te,{fw:550,size:15,lineClamp:1,children:C.name}),g&&!n&&B(me,{spacing:5,children:[x(Fe,{variant:"subtle",size:18,onClick:$=>{$.stopPropagation(),p(C.id),u()},children:x(NMe,{})}),x(Fe,{variant:"subtle",size:18,onClick:$=>{$.stopPropagation(),y(C.id)},children:x(go,{})})]})]}),x(Xe,{readOnly:!0,variant:"filled",label:K.fine,value:C.points&&C.points>0?K.charge_fine_points.format(m.format(C.fine.default),m.format(C.fine.min),m.format(C.fine.max),C.points):K.charge_fine.format(m.format(C.fine.default),m.format(C.fine.min),m.format(C.fine.max)),w:"100%"}),x(Xe,{readOnly:!0,variant:"filled",label:K.sentence,value:K.charge_sentence.format(C.sentence.default,C.sentence.min,C.sentence.max),w:"100%"})]})},C.id)}),x(xg.Dropdown,{children:x(Te,{size:"sm",style:{userSelect:"text"},children:C.description})})]}))})]}))})}),x(hQ,{opened:l,chargeId:d,close:c})]})}function WR({incidentId:e,identifier:t,isCitizen:n,addCharge:r}){const[i,a]=I.exports.useState(""),[s]=Kt(i,200),{isBoss:o}=tn(),[l,{open:u,close:c}]=$r(!1),d=()=>{u()};return B(ze,{children:[x(xa,{title:K.charges,searchQuery:i,setSearchQuery:a,createNew:!e&&!n&&o?d:void 0}),x(_Re,{isCitizen:n,searchQuery:s,incidentId:e,identifier:t,addCharge:r}),x(hQ,{opened:l,close:c})]})}function kRe({index:e,incidentId:t,item:n,handleBadgeRemove:r}){if(typeof t=="string")return null;const{incidents:i,updateIncident:a,updateCriminalFine:s,updateCriminalSentence:o,updateCriminalPoints:l,removeChargeWithId:u,updateCharges:c}=$d(),{charges:d}=z2(),{toggleWarrant:p}=js(),{copiedCharges:h,setCopiedCharges:m}=tn(),[g,v]=I.exports.useState((n==null?void 0:n.fine)||0),[y,b]=I.exports.useState((n==null?void 0:n.sentence)||0),[_]=Kt(g,500),[k]=Kt(y,500),C=I.exports.useCallback((H,J)=>{var Q,X,Y,ce;const ee=i.find(pe=>pe.id===t);if(!ee)return 0;const V=(X=(Q=ee.sideBarData)==null?void 0:Q.criminals)==null?void 0:X.find(pe=>pe.identifier===n.identifier);return V?H==="points"?((Y=V.charges)==null?void 0:Y.reduce((pe,fe)=>{const ye=d.find(_e=>_e.id===fe.id);return ye&&ye[H]?pe+ye[H]*fe.amount:pe*fe.amount},0))||0:((ce=V.charges)==null?void 0:ce.reduce((pe,fe)=>{const ye=d.find(_e=>_e.id===fe.id);return ye&&ye[H]?pe+ye[H][J]*fe.amount:pe*fe.amount},0))||0:0},[i,t,d,n]),$=I.exports.useCallback(H=>C("fine",H),[C]),N=I.exports.useCallback(H=>C("sentence",H),[C]),A=I.exports.useCallback(()=>C("points",""),[C]);I.exports.useEffect(()=>{o(t,n.identifier,k)},[k]),I.exports.useEffect(()=>{s(t,n.identifier,_)},[_]),I.exports.useEffect(()=>{v((n==null?void 0:n.fine)||0),b((n==null?void 0:n.sentence)||0)},[n]);const D=I.exports.useCallback(H=>{var ee,V,Q,X;const J=((X=(Q=(V=(ee=i.find(Y=>Y.id===t))==null?void 0:ee.sideBarData)==null?void 0:V.criminals)==null?void 0:Q.find(Y=>Y.identifier===H))==null?void 0:X.charges)||[];m(J)},[t,i,m]),O=I.exports.useCallback(H=>{c(t,H,h)},[t,c,h]),F=I.exports.useCallback((H,J)=>{var V,Q,X;if(typeof t!="number"||!(n!=null&&n.identifier))return;const ee=(X=(Q=(V=i.find(Y=>Y.id===t))==null?void 0:V.sideBarData)==null?void 0:Q.criminals)==null?void 0:X.map(Y=>Y.identifier===n.identifier?{...Y,[H]:J}:Y);if(a(t,{sideBarData:{criminals:ee}}),H==="hasWarrant"){const Y=i.find(ce=>ce.id===t);Y&&p(n.identifier,{incidentTitle:Y.title,incidentId:t})}},[i,t,n,a,p]),E=I.exports.useCallback((H,J)=>{var Q,X,Y,ce;if(typeof t!="number")return;const ee=((ce=(Y=(X=(Q=i.find(pe=>pe.id===t))==null?void 0:Q.sideBarData)==null?void 0:X.criminals)==null?void 0:Y.find(pe=>pe.identifier===J))==null?void 0:ce.charges)||[],V=ee.findIndex(pe=>pe.id===H);if(V!==-1){const pe=[...ee];pe[V]={id:H,amount:pe[V].amount+1},c(t,J,pe)}else{const pe=[...ee,{id:H,amount:1}];c(t,J,pe)}l(t,J,A())},[t,i,c,l,A]),z=()=>{Ne("finePlayer",{targetIdentifier:n.identifier,amount:g})},q=()=>{Ne("jailPlayer",{targetIdentifier:n.identifier,time:y})};return x(Bt,{bg:"dark.6",w:"100%",px:10,py:10,radius:"xs",children:B(Ce,{children:[B(me,{position:"apart",children:[B(Ce,{spacing:0,children:[x(Te,{children:n.name}),B(Te,{size:"xs",color:"gray.5",children:["ID: ",n.identifier]})]}),B(me,{position:"right",spacing:10,children:[x(rs,{withArrow:!0,withinPortal:!0,color:"dark",label:K.handle_charges,children:x(Fe,{variant:"subtle",onClick:H=>{In.open({size:"80%",centered:!0,title:K.choose_charges,children:x(wt,{p:20,bg:"dark.8",children:x(WR,{incidentId:t,identifier:n.identifier,addCharge:J=>E(J.id,n.identifier)})})})},children:x(zC,{})})}),x(rs,{withArrow:!0,withinPortal:!0,color:"dark",label:K.paste_charges,children:x(Fe,{variant:"subtle",onClick:()=>O(n.identifier),children:x(aMe,{})})}),x(rs,{withArrow:!0,withinPortal:!0,color:"dark",label:K.copy_charges,children:x(Fe,{variant:"subtle",onClick:()=>D(n.identifier),children:x(oMe,{})})}),x(rs,{withArrow:!0,withinPortal:!0,color:"dark",label:K.remove,children:x(Fe,{variant:"subtle",onClick:H=>{r(n.identifier)},children:x(ui,{})})})]})]}),x($C,{w:"80%",ml:"10%",label:H=>K.fine_value.format(H),min:$("min"),max:$("max"),step:10,value:g,onChange:H=>{v(H)},marks:[{value:$("default"),label:K.default_fine.format($("default"))}],mb:15}),x($C,{w:"80%",ml:"10%",label:H=>K.sentence_value.format(H),min:N("min"),max:N("max"),step:1,value:y,onChange:H=>{b(H)},marks:[{value:N("default"),label:K.default_sentence.format(N("default"))}],mb:15}),x(Te,{children:K.license_points_value.format(A())}),(()=>{var J,ee,V,Q;const H=((Q=(V=(ee=(J=i.find(X=>X.id===t))==null?void 0:J.sideBarData)==null?void 0:ee.criminals)==null?void 0:V.find(X=>X.identifier===n.identifier))==null?void 0:Q.charges)||[];return H.length===0?null:x(me,{spacing:10,w:"100%",children:H.map(X=>{const{id:Y,amount:ce}=X,pe=d.find(fe=>fe.id===Y);return pe?B(bt,{rightSection:x(Fe,{size:14,variant:"transparent",onClick:()=>{!t||!n.identifier||(u(t,n.identifier,Y),l(t,n.identifier,A()))},children:x(ui,{})}),children:[pe.name," x",ce]},Y):null}).filter(Boolean)})})(),B(me,{position:"apart",children:[B(Ce,{spacing:5,children:[x(_g,{label:K.warrant,checked:n.hasWarrant,onChange:H=>F("hasWarrant",H.currentTarget.checked)}),x(_g,{label:K.processed,checked:n.processed,onChange:H=>F("processed",H.currentTarget.checked)}),x(_g,{label:K.plead_guilty,checked:n.pleadGuilty,onChange:H=>F("pleadGuilty",H.currentTarget.checked)})]}),B(Ce,{spacing:5,children:[x(rs,{color:"dark",withArrow:!0,label:K.send_to_jail,children:x(Fe,{onClick:q,children:x(EMe,{})})}),x(rs,{color:"dark",withArrow:!0,label:K.send_fine,children:x(Fe,{onClick:z,children:x(zC,{})})})]})]})]})},e)}function SRe({searchQuery:e,filters:t}){const{vehicles:n,updateVehicle:r}=Th(),{updateTab:i}=gn(),a=I.exports.useMemo(()=>n.filter(o=>{const l=o.name.toLowerCase().includes(e.toLowerCase())||o.plate.toLowerCase().includes(e.toLowerCase());if(!t)return l;const u=t.every(c=>{if(!o.sideBarData)return!1;let d;if(c.type in o.sideBarData?d=o.sideBarData[c.type]:d=o[c.type],Array.isArray(d)&&d.length>0){if(typeof d[0]=="object")return d.some(p=>Object.values(p).some(h=>typeof h=="string"?h.toLowerCase().includes(c.value.toLowerCase()):!1));if(typeof d[0]=="string")return d.some(p=>p.toLowerCase().includes(c.value.toLowerCase()))}return typeof d=="string"?d.toLowerCase().includes(c.value.toLowerCase()):!1});return l&&u}).sort((o,l)=>o.plate.localeCompare(l.plate)),[e,t,n]),s=({index:o,style:l})=>{const u=a[o];return x("div",{style:{...l},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getVehicle",u.plate).then(c=>{!c||!u.plate||r(u.plate,c)}),i({title:"vehicles",component:x(VR,{vehiclePlate:u.plate})})},p:10,children:B(me,{spacing:15,children:[x(er,{size:80,src:u.image}),B(Ce,{spacing:1,children:[B(Te,{fw:600,size:16,children:[u.name," [",u.plate,"]"]}),x(Te,{fw:500,size:12,color:"gray.5",children:u.owner})]})]})})})};return x(ta,{height:window.innerHeight*.77,itemCount:a.length,itemSize:110,width:"100%",children:s})}function fQ(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200),[r,i]=I.exports.useState(),[a,s]=I.exports.useState([{type:"name",value:""},{type:"plate",value:""},{type:"tags",value:""}]);return B(ze,{children:[x(xa,{title:K.vehicles,searchQuery:e,filterInputs:a,filters:r,setFilterInputs:s,setSearchQuery:t,setFilters:i}),x(SRe,{searchQuery:n,filters:r})]})}function VR({vehiclePlate:e}){const{vehicles:t,updateVehicle:n}=Th(),{updateTab:r}=gn(),[i,a]=I.exports.useState(t.find(y=>y.plate===e)),[s,{open:o,close:l}]=$r(!1),[u,c]=I.exports.useState(i==null?void 0:i.image),[d,p]=I.exports.useState(i==null?void 0:i.notes),[h]=Kt(d,1e3);I.exports.useEffect(()=>{a(t.find(y=>y.plate===e))},[t]),I.exports.useEffect(()=>{c(i==null?void 0:i.image)},[i]),I.exports.useEffect(()=>{i&&h&&n(i.plate,{notes:h})},[h]);const m=I.exports.useCallback(()=>{r({title:"vehicles",component:x(fQ,{})})},[i,r]),g=I.exports.useCallback(()=>{const y={...i,notes:d};Ne("saveVehicle",y)},[i,d]),v=()=>{l(),Ne("hideUI"),Ne("takePhoto","vehicle")};return kt("photoTaken",y=>{y.page==="vehicle"&&(o(),c(y.url))}),B(ze,{children:[i&&B(me,{spacing:20,children:[x(Bt,{w:"60%",h:"81vh",color:"dark.6",radius:"xs",p:20,shadow:"xs",children:B(Ce,{w:"100%",spacing:25,children:[B(me,{w:"100%",position:"apart",children:[B(me,{w:"90%",children:[x(er,{size:160,src:i.image,onClick:o,sx:{cursor:"pointer"}}),x(An,{w:"75%",h:160,scrollHideDelay:0,scrollbarSize:5,children:B(me,{w:"100%",spacing:10,children:[x(Xe,{label:K.model,variant:"filled",readOnly:!0,value:i.name,size:"xs"}),x(Xe,{label:K.plate,variant:"filled",readOnly:!0,value:i.plate,size:"xs"}),x(Xe,{label:K.owner,variant:"filled",readOnly:!0,value:i.owner,size:"xs"}),x(Xe,{label:K.color,variant:"filled",readOnly:!0,value:i.color,size:"xs"}),x(Xe,{label:K.garage,variant:"filled",readOnly:!0,value:i.garage,size:"xs"})]})})]}),x(Ce,{h:160,justify:"flex-start",children:B(me,{spacing:10,children:[x(Fe,{variant:"subtle",color:"blue",onClick:m,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:g,children:x(Us,{})})]})})]}),x(bs,{w:"100%",label:K.notes,minRows:28,maxLength:5e4,value:d,onChange:y=>p(y.currentTarget.value)})]})}),x(ol,{page:"vehicle",sidebar:i.sideBarData,pageId:i.plate,updateData:n})]}),x(sr,{size:"40%",centered:!0,title:i==null?void 0:i.name,opened:s,onClose:l,withinPortal:!0,children:B(Ce,{children:[x(il,{radius:"md",src:i==null?void 0:i.image}),x(Xe,{label:K.image_url,placeholder:K.url,variant:"filled",value:u,onChange:y=>c(y.currentTarget.value),rightSection:x(Fe,{onClick:v,children:x(Kl,{})})}),x(me,{position:"right",children:x(Ct,{onClick:()=>{!i||(l(),n(i.plate,{image:u}))},children:K.confirm})})]})})]})}function Kg(e){if(!e)return!1;try{return new URL(e),!0}catch{return!1}}function CRe({pageTitle:e,index:t,pageId:n,item:r,canAddBOLO:i,handleBadgeRemove:a}){const{incidents:s,updateIncident:o}=$d(),{reports:l,updateReport:u}=ju(),{toggleBOLO:c,updateVehicle:d}=Th(),{addTab:p}=gn(),h=(m,g)=>{var _,k,C;if(typeof n!="number"||!(r!=null&&r.plate))return;const v=e==="report"?l:s,y=e==="report"?u:o,b=(C=(k=(_=v.find($=>$.id===n))==null?void 0:_.sideBarData)==null?void 0:k.vehicles)==null?void 0:C.map($=>$.plate===r.plate?{...$,[m]:g}:$);if(y(n,{sideBarData:{vehicles:b}}),m==="hasBOLO"){const $=v.find(N=>N.id===n);$&&c(r.plate,{title:$.title,id:n,isReport:e==="report"})}};return x(rs,{p:5,label:x("img",{src:r.image,width:250}),position:"left",color:"dark.6",hidden:!Kg(r.image),withArrow:!0,withinPortal:!0,children:x(bt,{h:30,leftSection:i&&x(_g,{onLabel:K.bolo,offLabel:K.bolo,checked:r.hasBOLO,onChange:m=>{h("hasBOLO",m.currentTarget.checked)}}),rightSection:i&&x(Fe,{size:14,variant:"transparent",onClick:m=>{a(r.plate)},children:x(ui,{})}),children:B(Te,{fw:600,style:{cursor:"pointer"},onClick:()=>{Ne("getVehicle",r.plate).then(m=>{!m||!r.plate||d(r.plate,m)}),p({title:"vehicles",component:x(VR,{vehiclePlate:r.plate})})},children:[r.name," [",r.plate,"]"]})},t)},t)}const IRe=[{value:0,label:"1"},{value:25,label:"2"},{value:50,label:"3"},{value:75,label:"4"},{value:100,label:"5"}];function mQ({sidebar:e,pageId:t,updateData:n}){const[r,i]=I.exports.useState(e.data),[a]=Kt(r,500);return I.exports.useEffect(()=>{n(t,{sideBarData:{[e.title]:a}})},[a]),x($C,{label:null,defaultValue:e.data,w:"80%",mx:"auto",min:0,max:100,step:25,marks:IRe,value:r,onChange:i,pb:25,pt:10})}function $Re({searchQuery:e,filters:t}){const{profiles:n,updateProfile:r}=js(),{updateTab:i}=gn(),a=I.exports.useMemo(()=>n.filter(o=>{var c,d,p;const l=((c=o.name)==null?void 0:c.toLowerCase().includes(e.toLowerCase()))||((d=o.identifier)==null?void 0:d.toLowerCase().includes(e.toLowerCase()))||((p=o.fingerprint)==null?void 0:p.toLowerCase().includes(e.toLowerCase()));if(!t)return l;const u=t.every(h=>{if(!o.sideBarData)return!1;let m;if(h.type in o.sideBarData?m=o.sideBarData[h.type]:m=o[h.type],Array.isArray(m)&&m.length>0){if(typeof m[0]=="object")return m.some(g=>Object.values(g).some(v=>typeof v=="string"?v.toLowerCase().includes(h.value.toLowerCase()):!1));if(typeof m[0]=="string")return m.some(g=>g.toLowerCase().includes(h.value.toLowerCase()))}return typeof m=="string"?m.toLowerCase().includes(h.value.toLowerCase()):!1});return l&&u}),[e,t,n]),s=({index:o,style:l})=>{const u=a[o];return x("div",{style:{...l},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getProfile",u.identifier).then(c=>{!c||!u.identifier||r(u.identifier,c)}),i({title:"profiles",component:x(u3,{profileId:u.identifier})})},p:10,children:B(me,{spacing:15,children:[x(er,{size:80,src:u.image}),B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:u.name}),B(bt,{radius:"sm",children:["ID: ",u.identifier]})]}),x(Te,{fw:500,size:12,color:"gray.5",children:u.dob})]})]})})})};return x(ta,{height:window.innerHeight*.77,itemCount:a.length,itemSize:110,width:"100%",children:s})}var TRe=Object.defineProperty,NRe=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),jR=(e,t)=>{for(var n in t)TRe(e,n,{get:t[n],enumerable:!0})},ERe={};jR(ERe,{Abs:()=>Ay,Acos:()=>Eh,Acosh:()=>Oh,AdadeltaOptimizer:()=>cL,AdagradOptimizer:()=>dL,AdamOptimizer:()=>pL,AdamaxOptimizer:()=>hL,Add:()=>Nd,AddN:()=>Ph,All:()=>My,Any:()=>Ry,ArgMax:()=>Dy,ArgMin:()=>Ly,Asin:()=>Ah,Asinh:()=>Mh,Atan:()=>Rh,Atan2:()=>Lh,Atanh:()=>Dh,AvgPool:()=>Fh,AvgPool3D:()=>Fy,AvgPool3DGrad:()=>K1,AvgPoolGrad:()=>q1,BackendWasm:()=>_le,BatchMatMul:()=>zh,BatchToSpaceND:()=>zy,Bincount:()=>By,BitwiseAnd:()=>Wy,BroadcastArgs:()=>Z1,BroadcastTo:()=>EQ,Callback:()=>xre,CallbackList:()=>gne,Cast:()=>Bh,Ceil:()=>Wh,ClipByValue:()=>Ed,Complex:()=>G2,ComplexAbs:()=>X1,Concat:()=>Vy,Conv2D:()=>Vh,Conv2DBackpropFilter:()=>q2,Conv2DBackpropInput:()=>jh,Conv3D:()=>Uh,Conv3DBackpropFilterV2:()=>jy,Conv3DBackpropInputV2:()=>Uy,Cos:()=>Hh,Cosh:()=>Gh,CropAndResize:()=>Gy,Cumprod:()=>Hy,Cumsum:()=>qh,CustomCallback:()=>vne,DataStorage:()=>j2,DenseBincount:()=>J1,DepthToSpace:()=>qy,DepthwiseConv2dNative:()=>Kh,DepthwiseConv2dNativeBackpropFilter:()=>K2,DepthwiseConv2dNativeBackpropInput:()=>Z2,Diag:()=>Y1,Dilation2D:()=>Zh,Dilation2DBackpropFilter:()=>Jg,Dilation2DBackpropInput:()=>Xg,Draw:()=>X2,ENV:()=>KR,EarlyStopping:()=>_re,Einsum:()=>J2,Elu:()=>Jh,EluGrad:()=>Ky,Environment:()=>TQ,Equal:()=>Zy,Erf:()=>Yh,Exp:()=>Qh,ExpandDims:()=>Xy,Expm1:()=>ef,FFT:()=>Y2,Fill:()=>Q1,FlipLeftRight:()=>Jy,Floor:()=>tf,FloorDiv:()=>nf,FromPixels:()=>UC,FusedBatchNorm:()=>rf,FusedConv2D:()=>Yp,FusedDepthwiseConv2D:()=>Qp,GPGPUContext:()=>pk,GatherNd:()=>Qy,GatherV2:()=>Yy,GraphModel:()=>QF,Greater:()=>ev,GreaterEqual:()=>af,History:()=>yne,IFFT:()=>Q2,Identity:()=>sf,Imag:()=>e$,InputSpec:()=>zr,IsFinite:()=>of,IsInf:()=>lf,IsNan:()=>uf,KernelBackend:()=>H1,LRN:()=>hf,LRNGrad:()=>ov,LayerVariable:()=>lne,LayersModel:()=>Su,LeakyRelu:()=>cf,Less:()=>tv,LessEqual:()=>nv,LinSpace:()=>rv,Log:()=>df,Log1p:()=>pf,LogSoftmax:()=>PQ,LogicalAnd:()=>iv,LogicalNot:()=>av,LogicalOr:()=>sv,LogicalXor:()=>OQ,LowerBound:()=>xDe,MathBackendCPU:()=>nz,MathBackendWebGL:()=>Ez,MatrixBandPart:()=>_De,Max:()=>ff,MaxPool:()=>gf,MaxPool3D:()=>lv,MaxPool3DGrad:()=>tw,MaxPoolGrad:()=>ew,MaxPoolWithArgmax:()=>nw,Maximum:()=>mf,Mean:()=>yf,Min:()=>vf,Minimum:()=>bf,MirrorPad:()=>wf,Mod:()=>xf,MomentumOptimizer:()=>fL,Multinomial:()=>uv,Multiply:()=>_f,Neg:()=>cv,NonMaxSuppressionV3:()=>pv,NonMaxSuppressionV4:()=>hv,NonMaxSuppressionV5:()=>fv,NotEqual:()=>dv,OP_SCOPE_SUFFIX:()=>QR,OneHot:()=>kf,OnesLike:()=>mv,Optimizer:()=>Zu,OptimizerConstructors:()=>Wte,Pack:()=>gv,PadV2:()=>Sf,Pool:()=>kDe,Pow:()=>Cf,Prelu:()=>If,Prod:()=>$f,RMSPropOptimizer:()=>mL,RNN:()=>Xu,RaggedGather:()=>t$,RaggedRange:()=>n$,RaggedTensorToTensor:()=>r$,Range:()=>rw,Rank:()=>cP,Real:()=>i$,RealDiv:()=>Xh,Reciprocal:()=>Tf,Reduction:()=>pa,Relu:()=>Nf,Relu6:()=>Pf,Reshape:()=>yv,ResizeBilinear:()=>Of,ResizeBilinearGrad:()=>bv,ResizeNearestNeighbor:()=>Ef,ResizeNearestNeighborGrad:()=>vv,Reverse:()=>Af,RotateWithOffset:()=>Mv,Round:()=>Mf,Rsqrt:()=>Rf,SGDOptimizer:()=>z$,ScatterNd:()=>wv,SearchSorted:()=>_v,Select:()=>kv,Selu:()=>Df,Sequential:()=>Y$,Sigmoid:()=>Bf,Sign:()=>zf,Sin:()=>Lf,Sinh:()=>Ff,Slice:()=>Sv,Softmax:()=>Uf,Softplus:()=>Wf,SpaceToBatchND:()=>Cv,SparseFillEmptyRows:()=>iw,SparseReshape:()=>$v,SparseSegmentMean:()=>aw,SparseSegmentSum:()=>sw,SparseToDense:()=>Tv,SplitV:()=>Iv,Sqrt:()=>Vf,Square:()=>ow,SquaredDifference:()=>Hf,StaticRegexReplace:()=>lw,Step:()=>Pd,StridedSlice:()=>Nv,StringNGrams:()=>uw,StringSplit:()=>cw,StringToHashBucketFast:()=>dw,Sub:()=>Gf,Sum:()=>jf,SymbolicTensor:()=>el,Tan:()=>qf,Tanh:()=>Kf,Tensor:()=>zt,TensorBuffer:()=>Br,TensorScatterUpdate:()=>xv,Tile:()=>Od,TopK:()=>Ev,Transform:()=>Ov,Transpose:()=>ku,Unique:()=>pw,Unpack:()=>Pv,UnsortedSegmentSum:()=>hw,UpperBound:()=>SDe,Variable:()=>eh,ZerosLike:()=>Av,_FusedMatMul:()=>Jp,abs:()=>Dr,acos:()=>iD,acosh:()=>aD,add:()=>we,addN:()=>see,all:()=>u$,any:()=>a1,argMax:()=>ih,argMin:()=>sD,asin:()=>oD,asinh:()=>lD,atan:()=>uD,atan2:()=>cD,atanh:()=>dD,avgPool:()=>Gu,avgPool3d:()=>hD,backend:()=>eD,backend_util:()=>W,basicLSTMCell:()=>cee,batchNorm:()=>Zf,batchNorm2d:()=>fD,batchNorm3d:()=>mD,batchNorm4d:()=>gD,batchToSpaceND:()=>ww,bincount:()=>yD,bitwiseAnd:()=>dee,booleanMaskAsync:()=>ete,broadcastArgs:()=>pee,broadcastTo:()=>Pp,broadcast_util:()=>Rv,browser:()=>Aw,buffer:()=>Gt,callbacks:()=>yGe,cast:()=>Me,ceil:()=>vD,clipByValue:()=>Yi,clone:()=>Fl,complex:()=>Ru,concat:()=>Wn,concat1d:()=>bD,concat2d:()=>wD,concat3d:()=>xD,concat4d:()=>_D,constraints:()=>pne,conv1d:()=>c$,conv2d:()=>ga,conv2dTranspose:()=>d$,conv3d:()=>SD,conv3dTranspose:()=>CD,copyRegisteredKernels:()=>TDe,cos:()=>xw,cosh:()=>p$,cosineWindow:()=>M$,cumprod:()=>l1,cumsum:()=>h$,customGrad:()=>jl,data:()=>Gre,denseBincount:()=>KC,deprecationWarn:()=>GQ,depthToSpace:()=>ID,depthwiseConv2d:()=>Xf,deregisterOp:()=>wGe,device_util:()=>yw,diag:()=>fee,dilation2d:()=>$D,disableDeprecationWarnings:()=>iLe,dispose:()=>Rt,disposeVariables:()=>aLe,div:()=>et,divNoNan:()=>TD,dot:()=>ND,dropout:()=>aL,einsum:()=>hp,elu:()=>Dv,enableDebugMode:()=>rLe,enableProdMode:()=>nLe,enclosingPowerOfTwo:()=>sL,engine:()=>Ys,ensureShape:()=>gee,env:()=>he,equal:()=>ms,erf:()=>ED,euclideanNorm:()=>AD,exp:()=>Qi,expandDims:()=>hi,expm1:()=>MD,eye:()=>f$,fft:()=>Ow,fill:()=>ds,findBackend:()=>dLe,findBackendFactory:()=>pLe,floor:()=>Fv,floorDiv:()=>l$,forceHalfFloat:()=>gse,fused:()=>ay,gather:()=>zv,gatherND:()=>ite,gather_util:()=>vL,getBackend:()=>qQ,getGradient:()=>lP,getKernel:()=>n1,getKernelsForBackend:()=>HC,getThreadsCount:()=>Igt,gpgpu_util:()=>qae,grad:()=>Uze,grads:()=>Hze,greater:()=>Sa,greaterEqual:()=>qu,ifft:()=>iy,imag:()=>_w,image:()=>$s,inTopKAsync:()=>ate,initializers:()=>hne,input:()=>Pne,io:()=>Ti,irfft:()=>$$,isFinite:()=>RD,isInf:()=>DD,isNaN:()=>LD,keep:()=>Jr,kernel_impls:()=>Jl,layers:()=>fne,leakyRelu:()=>kw,less:()=>ey,lessEqual:()=>Md,linalg:()=>uL,linspace:()=>xee,loadGraphModel:()=>I7e,loadGraphModelSync:()=>$7e,loadLayersModel:()=>hHe,localResponseNormalization:()=>FD,log:()=>gs,log1p:()=>Sw,logSigmoid:()=>zD,logSoftmax:()=>g$,logSumExp:()=>Cw,logicalAnd:()=>ho,logicalNot:()=>Iw,logicalOr:()=>y$,logicalXor:()=>BD,losses:()=>yte,lowerBound:()=>kee,matMul:()=>jt,math:()=>Tte,max:()=>Ms,maxPool:()=>oi,maxPool3d:()=>WD,maxPoolWithArgmax:()=>See,maximum:()=>Xl,mean:()=>vr,memory:()=>qC,meshgrid:()=>Cee,metrics:()=>vre,min:()=>Qg,minimum:()=>cd,mirrorPad:()=>VD,mod:()=>jD,model:()=>gHe,models:()=>bre,moments:()=>$w,movingAverage:()=>tte,mul:()=>ae,multiRNNCell:()=>Iee,multinomial:()=>$ee,neg:()=>Yn,nextFrame:()=>bL,norm:()=>Lv,notEqual:()=>lh,oneHot:()=>ty,ones:()=>Aa,onesLike:()=>ys,op:()=>re,outerProduct:()=>Tee,pad:()=>al,pad1d:()=>Nee,pad2d:()=>Eee,pad3d:()=>Oee,pad4d:()=>Pee,pool:()=>UD,pow:()=>Du,prelu:()=>Nw,print:()=>rD,prod:()=>HD,profile:()=>sLe,raggedGather:()=>Aee,raggedRange:()=>Mee,raggedTensorToTensor:()=>Ree,rand:()=>Dee,randomGamma:()=>Bee,randomNormal:()=>b$,randomStandardNormal:()=>Wee,randomUniform:()=>Rd,randomUniformInt:()=>Vee,range:()=>uh,ready:()=>uLe,real:()=>ny,reciprocal:()=>XD,registerBackend:()=>o$,registerCallbackConstructor:()=>vHe,registerGradient:()=>AQ,registerKernel:()=>fw,registerOp:()=>bGe,regularizers:()=>wre,relu:()=>On,relu6:()=>w$,removeBackend:()=>cLe,reshape:()=>oe,reverse:()=>zs,reverse1d:()=>jee,reverse2d:()=>Uee,reverse3d:()=>Hee,reverse4d:()=>Gee,rfft:()=>Pw,round:()=>x$,rsqrt:()=>_$,scalar:()=>yt,scatterND:()=>nte,scatter_util:()=>E$,searchSorted:()=>v$,selu:()=>k$,separableConv2d:()=>Bv,sequential:()=>yHe,serialization:()=>$e,setBackend:()=>lLe,setPlatform:()=>hLe,setThreadsCount:()=>Cgt,setWasmPath:()=>kgt,setWasmPaths:()=>Sgt,setWebGLContext:()=>yae,setdiff1dAsync:()=>qee,shared:()=>rz,sigmoid:()=>lo,sign:()=>JD,signal:()=>gte,sin:()=>S$,sinh:()=>C$,slice:()=>nn,slice1d:()=>Ew,slice2d:()=>I$,slice3d:()=>Wv,slice4d:()=>ry,slice_util:()=>ei,softmax:()=>Dd,softplus:()=>Jf,spaceToBatchND:()=>Tw,sparse:()=>vte,sparseToDense:()=>rte,spectral:()=>mte,split:()=>La,sqrt:()=>Ai,square:()=>zn,squaredDifference:()=>T$,squeeze:()=>Ld,stack:()=>Wr,step:()=>Yf,stridedSlice:()=>YD,string:()=>bte,sub:()=>Ve,sum:()=>lt,sumOutType:()=>s$,tan:()=>QD,tanh:()=>sh,tensor:()=>fa,tensor1d:()=>Cn,tensor2d:()=>zl,tensor3d:()=>N$,tensor4d:()=>dd,tensor5d:()=>Kee,tensor6d:()=>Zee,tensorScatterUpdate:()=>Jee,tensor_util:()=>Bo,test_util:()=>Lee,tidy:()=>le,tile:()=>ss,time:()=>oLe,topk:()=>tL,train:()=>up,transpose:()=>Ut,truncatedNormal:()=>P$,unique:()=>nL,unregisterGradient:()=>$De,unregisterKernel:()=>IDe,unsortedSegmentSum:()=>A$,unstack:()=>Ir,upcastType:()=>Ls,upperBound:()=>Yee,util:()=>P,valueAndGrad:()=>Gze,valueAndGrads:()=>qze,variable:()=>rL,variableGrads:()=>_ee,version:()=>Agt,version_converter:()=>N7e,version_core:()=>yWe,version_cpu:()=>Eqe,version_layers:()=>VL,version_wasm:()=>$gt,version_webgl:()=>xtt,webgl:()=>_tt,webgl_util:()=>gae,where:()=>yi,whereAsync:()=>iL,zeros:()=>br,zerosLike:()=>sn});var ORe=Object.create,UR=Object.defineProperty,PRe=Object.getOwnPropertyDescriptor,ARe=Object.getOwnPropertyNames,MRe=Object.getPrototypeOf,RRe=Object.prototype.hasOwnProperty,jr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Dt=(e,t)=>{for(var n in t)UR(e,n,{get:t[n],enumerable:!0})},DRe=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ARe(t))!RRe.call(e,i)&&i!==n&&UR(e,i,{get:()=>t[i],enumerable:!(r=PRe(t,i))||r.enumerable});return e},Td=(e,t,n)=>(n=e!=null?ORe(MRe(e)):{},DRe(t||!e||!e.__esModule?UR(n,"default",{value:e,enumerable:!0}):n,e)),LRe=jr((e,t)=>{t.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(E,z,q){this.low=E|0,this.high=z|0,this.unsigned=!!q}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0});function i(E){return(E&&E.__isLong__)===!0}r.isLong=i;var a={},s={};function o(E,z){var q,H,J;return z?(E>>>=0,(J=0<=E&&E<256)&&(H=s[E],H)?H:(q=u(E,(E|0)<0?-1:0,!0),J&&(s[E]=q),q)):(E|=0,(J=-128<=E&&E<128)&&(H=a[E],H)?H:(q=u(E,E<0?-1:0,!1),J&&(a[E]=q),q))}r.fromInt=o;function l(E,z){if(isNaN(E))return z?k:_;if(z){if(E<0)return k;if(E>=v)return D}else{if(E<=-y)return O;if(E+1>=y)return A}return E<0?l(-E,z).neg():u(E%g|0,E/g|0,z)}r.fromNumber=l;function u(E,z,q){return new r(E,z,q)}r.fromBits=u;var c=Math.pow;function d(E,z,q){if(E.length===0)throw Error("empty string");if(E==="NaN"||E==="Infinity"||E==="+Infinity"||E==="-Infinity")return _;if(typeof z=="number"?(q=z,z=!1):z=!!z,q=q||10,q<2||36<q)throw RangeError("radix");var H;if((H=E.indexOf("-"))>0)throw Error("interior hyphen");if(H===0)return d(E.substring(1),z,q).neg();for(var J=l(c(q,8)),ee=_,V=0;V<E.length;V+=8){var Q=Math.min(8,E.length-V),X=parseInt(E.substring(V,V+Q),q);if(Q<8){var Y=l(c(q,Q));ee=ee.mul(Y).add(l(X))}else ee=ee.mul(J),ee=ee.add(l(X))}return ee.unsigned=z,ee}r.fromString=d;function p(E,z){return typeof E=="number"?l(E,z):typeof E=="string"?d(E,z):u(E.low,E.high,typeof z=="boolean"?z:E.unsigned)}r.fromValue=p;var h=65536,m=1<<24,g=h*h,v=g*g,y=v/2,b=o(m),_=o(0);r.ZERO=_;var k=o(0,!0);r.UZERO=k;var C=o(1);r.ONE=C;var $=o(1,!0);r.UONE=$;var N=o(-1);r.NEG_ONE=N;var A=u(-1,2147483647,!1);r.MAX_VALUE=A;var D=u(-1,-1,!0);r.MAX_UNSIGNED_VALUE=D;var O=u(0,-2147483648,!1);r.MIN_VALUE=O;var F=r.prototype;F.toInt=function(){return this.unsigned?this.low>>>0:this.low},F.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},F.toString=function(E){if(E=E||10,E<2||36<E)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(O)){var z=l(E),q=this.div(z),H=q.mul(z).sub(this);return q.toString(E)+H.toInt().toString(E)}else return"-"+this.neg().toString(E);for(var J=l(c(E,6),this.unsigned),ee=this,V="";;){var Q=ee.div(J),X=ee.sub(Q.mul(J)).toInt()>>>0,Y=X.toString(E);if(ee=Q,ee.isZero())return Y+V;for(;Y.length<6;)Y="0"+Y;V=""+Y+V}},F.getHighBits=function(){return this.high},F.getHighBitsUnsigned=function(){return this.high>>>0},F.getLowBits=function(){return this.low},F.getLowBitsUnsigned=function(){return this.low>>>0},F.getNumBitsAbs=function(){if(this.isNegative())return this.eq(O)?64:this.neg().getNumBitsAbs();for(var E=this.high!=0?this.high:this.low,z=31;z>0&&!(E&1<<z);z--);return this.high!=0?z+33:z+1},F.isZero=function(){return this.high===0&&this.low===0},F.eqz=F.isZero,F.isNegative=function(){return!this.unsigned&&this.high<0},F.isPositive=function(){return this.unsigned||this.high>=0},F.isOdd=function(){return(this.low&1)===1},F.isEven=function(){return(this.low&1)===0},F.equals=function(E){return i(E)||(E=p(E)),this.unsigned!==E.unsigned&&this.high>>>31===1&&E.high>>>31===1?!1:this.high===E.high&&this.low===E.low},F.eq=F.equals,F.notEquals=function(E){return!this.eq(E)},F.neq=F.notEquals,F.ne=F.notEquals,F.lessThan=function(E){return this.comp(E)<0},F.lt=F.lessThan,F.lessThanOrEqual=function(E){return this.comp(E)<=0},F.lte=F.lessThanOrEqual,F.le=F.lessThanOrEqual,F.greaterThan=function(E){return this.comp(E)>0},F.gt=F.greaterThan,F.greaterThanOrEqual=function(E){return this.comp(E)>=0},F.gte=F.greaterThanOrEqual,F.ge=F.greaterThanOrEqual,F.compare=function(E){if(i(E)||(E=p(E)),this.eq(E))return 0;var z=this.isNegative(),q=E.isNegative();return z&&!q?-1:!z&&q?1:this.unsigned?E.high>>>0>this.high>>>0||E.high===this.high&&E.low>>>0>this.low>>>0?-1:1:this.sub(E).isNegative()?-1:1},F.comp=F.compare,F.negate=function(){return!this.unsigned&&this.eq(O)?O:this.not().add(C)},F.neg=F.negate,F.add=function(E){i(E)||(E=p(E));var z=this.high>>>16,q=this.high&65535,H=this.low>>>16,J=this.low&65535,ee=E.high>>>16,V=E.high&65535,Q=E.low>>>16,X=E.low&65535,Y=0,ce=0,pe=0,fe=0;return fe+=J+X,pe+=fe>>>16,fe&=65535,pe+=H+Q,ce+=pe>>>16,pe&=65535,ce+=q+V,Y+=ce>>>16,ce&=65535,Y+=z+ee,Y&=65535,u(pe<<16|fe,Y<<16|ce,this.unsigned)},F.subtract=function(E){return i(E)||(E=p(E)),this.add(E.neg())},F.sub=F.subtract,F.multiply=function(E){if(this.isZero())return _;if(i(E)||(E=p(E)),n){var z=n.mul(this.low,this.high,E.low,E.high);return u(z,n.get_high(),this.unsigned)}if(E.isZero())return _;if(this.eq(O))return E.isOdd()?O:_;if(E.eq(O))return this.isOdd()?O:_;if(this.isNegative())return E.isNegative()?this.neg().mul(E.neg()):this.neg().mul(E).neg();if(E.isNegative())return this.mul(E.neg()).neg();if(this.lt(b)&&E.lt(b))return l(this.toNumber()*E.toNumber(),this.unsigned);var q=this.high>>>16,H=this.high&65535,J=this.low>>>16,ee=this.low&65535,V=E.high>>>16,Q=E.high&65535,X=E.low>>>16,Y=E.low&65535,ce=0,pe=0,fe=0,ye=0;return ye+=ee*Y,fe+=ye>>>16,ye&=65535,fe+=J*Y,pe+=fe>>>16,fe&=65535,fe+=ee*X,pe+=fe>>>16,fe&=65535,pe+=H*Y,ce+=pe>>>16,pe&=65535,pe+=J*X,ce+=pe>>>16,pe&=65535,pe+=ee*Q,ce+=pe>>>16,pe&=65535,ce+=q*Y+H*X+J*Q+ee*V,ce&=65535,u(fe<<16|ye,ce<<16|pe,this.unsigned)},F.mul=F.multiply,F.divide=function(E){if(i(E)||(E=p(E)),E.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&E.low===-1&&E.high===-1)return this;var z=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,E.low,E.high);return u(z,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?k:_;var q,H,J;if(this.unsigned){if(E.unsigned||(E=E.toUnsigned()),E.gt(this))return k;if(E.gt(this.shru(1)))return $;J=k}else{if(this.eq(O)){if(E.eq(C)||E.eq(N))return O;if(E.eq(O))return C;var ee=this.shr(1);return q=ee.div(E).shl(1),q.eq(_)?E.isNegative()?C:N:(H=this.sub(E.mul(q)),J=q.add(H.div(E)),J)}else if(E.eq(O))return this.unsigned?k:_;if(this.isNegative())return E.isNegative()?this.neg().div(E.neg()):this.neg().div(E).neg();if(E.isNegative())return this.div(E.neg()).neg();J=_}for(H=this;H.gte(E);){q=Math.max(1,Math.floor(H.toNumber()/E.toNumber()));for(var V=Math.ceil(Math.log(q)/Math.LN2),Q=V<=48?1:c(2,V-48),X=l(q),Y=X.mul(E);Y.isNegative()||Y.gt(H);)q-=Q,X=l(q,this.unsigned),Y=X.mul(E);X.isZero()&&(X=C),J=J.add(X),H=H.sub(Y)}return J},F.div=F.divide,F.modulo=function(E){if(i(E)||(E=p(E)),n){var z=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,E.low,E.high);return u(z,n.get_high(),this.unsigned)}return this.sub(this.div(E).mul(E))},F.mod=F.modulo,F.rem=F.modulo,F.not=function(){return u(~this.low,~this.high,this.unsigned)},F.and=function(E){return i(E)||(E=p(E)),u(this.low&E.low,this.high&E.high,this.unsigned)},F.or=function(E){return i(E)||(E=p(E)),u(this.low|E.low,this.high|E.high,this.unsigned)},F.xor=function(E){return i(E)||(E=p(E)),u(this.low^E.low,this.high^E.high,this.unsigned)},F.shiftLeft=function(E){return i(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?u(this.low<<E,this.high<<E|this.low>>>32-E,this.unsigned):u(0,this.low<<E-32,this.unsigned)},F.shl=F.shiftLeft,F.shiftRight=function(E){return i(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?u(this.low>>>E|this.high<<32-E,this.high>>E,this.unsigned):u(this.high>>E-32,this.high>=0?0:-1,this.unsigned)},F.shr=F.shiftRight,F.shiftRightUnsigned=function(E){if(i(E)&&(E=E.toInt()),E&=63,E===0)return this;var z=this.high;if(E<32){var q=this.low;return u(q>>>E|z<<32-E,z>>>E,this.unsigned)}else return E===32?u(z,0,this.unsigned):u(z>>>E-32,0,this.unsigned)},F.shru=F.shiftRightUnsigned,F.shr_u=F.shiftRightUnsigned,F.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},F.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},F.toBytes=function(E){return E?this.toBytesLE():this.toBytesBE()},F.toBytesLE=function(){var E=this.high,z=this.low;return[z&255,z>>>8&255,z>>>16&255,z>>>24,E&255,E>>>8&255,E>>>16&255,E>>>24]},F.toBytesBE=function(){var E=this.high,z=this.low;return[E>>>24,E>>>16&255,E>>>8&255,E&255,z>>>24,z>>>16&255,z>>>8&255,z&255]},r.fromBytes=function(E,z,q){return q?r.fromBytesLE(E,z):r.fromBytesBE(E,z)},r.fromBytesLE=function(E,z){return new r(E[0]|E[1]<<8|E[2]<<16|E[3]<<24,E[4]|E[5]<<8|E[6]<<16|E[7]<<24,z)},r.fromBytesBE=function(E,z){return new r(E[4]<<24|E[5]<<16|E[6]<<8|E[7],E[0]<<24|E[1]<<16|E[2]<<8|E[3],z)}}),FRe=jr(()=>{}),zRe=jr(()=>{}),BRe=jr((e,t)=>{(function(n,r,i){function a(u){var c=this,d=l();c.next=function(){var p=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=p-(c.c=p|0)},c.c=1,c.s0=d(" "),c.s1=d(" "),c.s2=d(" "),c.s0-=d(u),c.s0<0&&(c.s0+=1),c.s1-=d(u),c.s1<0&&(c.s1+=1),c.s2-=d(u),c.s2<0&&(c.s2+=1),d=null}function s(u,c){return c.c=u.c,c.s0=u.s0,c.s1=u.s1,c.s2=u.s2,c}function o(u,c){var d=new a(u),p=c&&c.state,h=d.next;return h.int32=function(){return d.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,p&&(typeof p=="object"&&s(p,d),h.state=function(){return s(d,{})}),h}function l(){var u=4022871197,c=function(d){d=String(d);for(var p=0;p<d.length;p++){u+=d.charCodeAt(p);var h=.02519603282416938*u;u=h>>>0,h-=u,h*=u,u=h>>>0,h-=u,u+=h*4294967296}return(u>>>0)*23283064365386963e-26};return c}r&&r.exports?r.exports=o:i&&i.amd?i(function(){return o}):this.alea=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),WRe=jr((e,t)=>{(function(n,r,i){function a(l){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var p=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^p^p>>>8},l===(l|0)?u.x=l:c+=l;for(var d=0;d<c.length+64;d++)u.x^=c.charCodeAt(d)|0,u.next()}function s(l,u){return u.x=l.x,u.y=l.y,u.z=l.z,u.w=l.w,u}function o(l,u){var c=new a(l),d=u&&u.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var h=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(h+m)/(1<<21);while(g===0);return g},p.int32=c.next,p.quick=p,d&&(typeof d=="object"&&s(d,c),p.state=function(){return s(c,{})}),p}r&&r.exports?r.exports=o:i&&i.amd?i(function(){return o}):this.xor128=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),VRe=jr((e,t)=>{(function(n,r,i){function a(l){var u=this,c="";u.next=function(){var p=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(p^p<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,l===(l|0)?u.x=l:c+=l;for(var d=0;d<c.length+64;d++)u.x^=c.charCodeAt(d)|0,d==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function s(l,u){return u.x=l.x,u.y=l.y,u.z=l.z,u.w=l.w,u.v=l.v,u.d=l.d,u}function o(l,u){var c=new a(l),d=u&&u.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var h=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(h+m)/(1<<21);while(g===0);return g},p.int32=c.next,p.quick=p,d&&(typeof d=="object"&&s(d,c),p.state=function(){return s(c,{})}),p}r&&r.exports?r.exports=o:i&&i.amd?i(function(){return o}):this.xorwow=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),jRe=jr((e,t)=>{(function(n,r,i){function a(l){var u=this;u.next=function(){var d=u.x,p=u.i,h,m;return h=d[p],h^=h>>>7,m=h^h<<24,h=d[p+1&7],m^=h^h>>>10,h=d[p+3&7],m^=h^h>>>3,h=d[p+4&7],m^=h^h<<7,h=d[p+7&7],h=h^h<<13,m^=h^h<<9,d[p]=m,u.i=p+1&7,m};function c(d,p){var h,m=[];if(p===(p|0))m[0]=p;else for(p=""+p,h=0;h<p.length;++h)m[h&7]=m[h&7]<<15^p.charCodeAt(h)+m[h+1&7]<<13;for(;m.length<8;)m.push(0);for(h=0;h<8&&m[h]===0;++h);for(h==8?m[7]=-1:m[h],d.x=m,d.i=0,h=256;h>0;--h)d.next()}c(u,l)}function s(l,u){return u.x=l.x.slice(),u.i=l.i,u}function o(l,u){l==null&&(l=+new Date);var c=new a(l),d=u&&u.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var h=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(h+m)/(1<<21);while(g===0);return g},p.int32=c.next,p.quick=p,d&&(d.x&&s(d,c),p.state=function(){return s(c,{})}),p}r&&r.exports?r.exports=o:i&&i.amd?i(function(){return o}):this.xorshift7=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),URe=jr((e,t)=>{(function(n,r,i){function a(l){var u=this;u.next=function(){var d=u.w,p=u.X,h=u.i,m,g;return u.w=d=d+1640531527|0,g=p[h+34&127],m=p[h=h+1&127],g^=g<<13,m^=m<<17,g^=g>>>15,m^=m>>>12,g=p[h]=g^m,u.i=h,g+(d^d>>>16)|0};function c(d,p){var h,m,g,v,y,b=[],_=128;for(p===(p|0)?(m=p,p=null):(p=p+"\0",m=0,_=Math.max(_,p.length)),g=0,v=-32;v<_;++v)p&&(m^=p.charCodeAt((v+32)%p.length)),v===0&&(y=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,v>=0&&(y=y+1640531527|0,h=b[v&127]^=m+y,g=h==0?g+1:0);for(g>=128&&(b[(p&&p.length||0)&127]=-1),g=127,v=4*128;v>0;--v)m=b[g+34&127],h=b[g=g+1&127],m^=m<<13,h^=h<<17,m^=m>>>15,h^=h>>>12,b[g]=m^h;d.w=y,d.X=b,d.i=g}c(u,l)}function s(l,u){return u.i=l.i,u.w=l.w,u.X=l.X.slice(),u}function o(l,u){l==null&&(l=+new Date);var c=new a(l),d=u&&u.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var h=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(h+m)/(1<<21);while(g===0);return g},p.int32=c.next,p.quick=p,d&&(d.X&&s(d,c),p.state=function(){return s(c,{})}),p}r&&r.exports?r.exports=o:i&&i.amd?i(function(){return o}):this.xor4096=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),HRe=jr((e,t)=>{(function(n,r,i){function a(l){var u=this,c="";u.next=function(){var p=u.b,h=u.c,m=u.d,g=u.a;return p=p<<25^p>>>7^h,h=h-m|0,m=m<<24^m>>>8^g,g=g-p|0,u.b=p=p<<20^p>>>12^h,u.c=h=h-m|0,u.d=m<<16^h>>>16^g,u.a=g-p|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,l===Math.floor(l)?(u.a=l/4294967296|0,u.b=l|0):c+=l;for(var d=0;d<c.length+20;d++)u.b^=c.charCodeAt(d)|0,u.next()}function s(l,u){return u.a=l.a,u.b=l.b,u.c=l.c,u.d=l.d,u}function o(l,u){var c=new a(l),d=u&&u.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var h=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(h+m)/(1<<21);while(g===0);return g},p.int32=c.next,p.quick=p,d&&(typeof d=="object"&&s(d,c),p.state=function(){return s(c,{})}),p}r&&r.exports?r.exports=o:i&&i.amd?i(function(){return o}):this.tychei=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),GRe=jr(()=>{}),qRe=jr((e,t)=>{(function(n,r,i){var a=256,s=6,o=52,l="random",u=i.pow(a,s),c=i.pow(2,o),d=c*2,p=a-1,h;function m(C,$,N){var A=[];$=$==!0?{entropy:!0}:$||{};var D=b(y($.entropy?[C,k(r)]:C==null?_():C,3),A),O=new g(A),F=function(){for(var E=O.g(s),z=u,q=0;E<c;)E=(E+q)*a,z*=a,q=O.g(1);for(;E>=d;)E/=2,z/=2,q>>>=1;return(E+q)/z};return F.int32=function(){return O.g(4)|0},F.quick=function(){return O.g(4)/4294967296},F.double=F,b(k(O.S),r),($.pass||N||function(E,z,q,H){return H&&(H.S&&v(H,O),E.state=function(){return v(O,{})}),q?(i[l]=E,z):E})(F,D,"global"in $?$.global:this==i,$.state)}function g(C){var $,N=C.length,A=this,D=0,O=A.i=A.j=0,F=A.S=[];for(N||(C=[N++]);D<a;)F[D]=D++;for(D=0;D<a;D++)F[D]=F[O=p&O+C[D%N]+($=F[D])],F[O]=$;(A.g=function(E){for(var z,q=0,H=A.i,J=A.j,ee=A.S;E--;)z=ee[H=p&H+1],q=q*a+ee[p&(ee[H]=ee[J=p&J+z])+(ee[J]=z)];return A.i=H,A.j=J,q})(a)}function v(C,$){return $.i=C.i,$.j=C.j,$.S=C.S.slice(),$}function y(C,$){var N=[],A=typeof C,D;if($&&A=="object")for(D in C)try{N.push(y(C[D],$-1))}catch{}return N.length?N:A=="string"?C:C+"\0"}function b(C,$){for(var N=C+"",A,D=0;D<N.length;)$[p&D]=p&(A^=$[p&D]*19)+N.charCodeAt(D++);return k($)}function _(){try{var C;return h&&(C=h.randomBytes)?C=C(a):(C=new Uint8Array(a),(n.crypto||n.msCrypto).getRandomValues(C)),k(C)}catch{var $=n.navigator,N=$&&$.plugins;return[+new Date,n,N,n.screen,k(r)]}}function k(C){return String.fromCharCode.apply(0,C)}if(b(i.random(),r),typeof t=="object"&&t.exports){t.exports=m;try{h=GRe()}catch{}}else typeof define=="function"&&define.amd?define(function(){return m}):i["seed"+l]=m})(typeof self<"u"?self:e,[],Math)}),V2=jr((e,t)=>{var n=BRe(),r=WRe(),i=VRe(),a=jRe(),s=URe(),o=HRe(),l=qRe();l.alea=n,l.xor128=r,l.xorwow=i,l.xorshift7=a,l.xor4096=s,l.tychei=o,t.exports=l}),gQ=jr(()=>{}),HR=jr(()=>{}),yQ=jr(()=>{}),KRe=jr(()=>{}),ZRe=jr(()=>{}),XRe=jr(()=>{}),JRe=jr((e,t)=>{var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(i){i=i||{};function a(){return V.buffer!=Se&&He(V.buffer),Re}function s(){return V.buffer!=Se&&He(V.buffer),Ze}function o(){return V.buffer!=Se&&He(V.buffer),at}function l(){return V.buffer!=Se&&He(V.buffer),Je}function u(){return V.buffer!=Se&&He(V.buffer),st}var c=typeof i<"u"?i:{},d,p;c.ready=new Promise(function(te,ue){d=te,p=ue});var h;typeof process<"u"&&process.listeners&&(h={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var m=Object.assign({},c),g=(te,ue)=>{throw ue},v=typeof window=="object",y=typeof importScripts=="function",b=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",_=c.ENVIRONMENT_IS_PTHREAD||!1,k="";function C(te){return c.locateFile?c.locateFile(te,k):k+te}var $,N,A;function D(te){te instanceof Rr||H("exiting due to exception: "+te)}if(b){var O=HR(),F=yQ();y?k=F.dirname(k)+"/":k=__dirname+"/",$=(ue,Pe)=>(ue=Ge(ue)?new URL(ue):F.normalize(ue),O.readFileSync(ue,Pe?void 0:"utf8")),A=ue=>{var Pe=$(ue,!0);return Pe.buffer||(Pe=new Uint8Array(Pe)),Pe},N=(ue,Pe,je)=>{ue=Ge(ue)?new URL(ue):F.normalize(ue),O.readFile(ue,function(Pt,At){Pt?je(Pt):Pe(At.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(ue){if(!(ue instanceof Rr))throw ue}),process.on("unhandledRejection",function(ue){throw ue}),g=(ue,Pe)=>{if(_t())throw process.exitCode=ue,Pe;D(Pe),process.exit(ue)},c.inspect=function(){return"[Emscripten Module object]"};let te;try{te=KRe()}catch(ue){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),ue}global.Worker=te.Worker}else(v||y)&&(y?k=self.location.href:typeof document<"u"&&document.currentScript&&(k=document.currentScript.src),typeof r<"u"&&r&&(k=r),k.indexOf("blob:")!==0?k=k.substr(0,k.replace(/[?#].*/,"").lastIndexOf("/")+1):k="",b||($=te=>{var ue=new XMLHttpRequest;return ue.open("GET",te,!1),ue.send(null),ue.responseText},y&&(A=te=>{var ue=new XMLHttpRequest;return ue.open("GET",te,!1),ue.responseType="arraybuffer",ue.send(null),new Uint8Array(ue.response)}),N=(te,ue,Pe)=>{var je=new XMLHttpRequest;je.open("GET",te,!0),je.responseType="arraybuffer",je.onload=()=>{if(je.status==200||je.status==0&&je.response){ue(je.response);return}Pe()},je.onerror=Pe,je.send(null)}));b&&typeof performance>"u"&&(global.performance=ZRe().performance);var E=console.log.bind(console),z=console.warn.bind(console);b&&(E=te=>O.writeSync(1,te+`
`),z=te=>O.writeSync(2,te+`
`));var q=c.print||E,H=c.printErr||z;Object.assign(c,m),m=null,c.arguments&&c.arguments,c.thisProgram&&c.thisProgram,c.quit&&(g=c.quit);var J;c.wasmBinary&&(J=c.wasmBinary);var ee=c.noExitRuntime||!0;typeof WebAssembly!="object"&&tr("no native wasm support detected");var V,Q,X=!1,Y;function ce(te,ue){te||tr(ue)}var pe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function fe(te,ue,Pe){ue>>>=0;for(var je=ue+Pe,Pt=ue;te[Pt]&&!(Pt>=je);)++Pt;if(Pt-ue>16&&te.buffer&&pe)return pe.decode(te.buffer instanceof SharedArrayBuffer?te.slice(ue,Pt):te.subarray(ue,Pt));for(var At="";ue<Pt;){var qe=te[ue++];if(!(qe&128)){At+=String.fromCharCode(qe);continue}var mt=te[ue++]&63;if((qe&224)==192){At+=String.fromCharCode((qe&31)<<6|mt);continue}var vn=te[ue++]&63;if((qe&240)==224?qe=(qe&15)<<12|mt<<6|vn:qe=(qe&7)<<18|mt<<12|vn<<6|te[ue++]&63,qe<65536)At+=String.fromCharCode(qe);else{var Wi=qe-65536;At+=String.fromCharCode(55296|Wi>>10,56320|Wi&1023)}}return At}function ye(te,ue){return te>>>=0,te?fe(s(),te,ue):""}function _e(te,ue,Pe,je){if(Pe>>>=0,!(je>0))return 0;for(var Pt=Pe,At=Pe+je-1,qe=0;qe<te.length;++qe){var mt=te.charCodeAt(qe);if(mt>=55296&&mt<=57343){var vn=te.charCodeAt(++qe);mt=65536+((mt&1023)<<10)|vn&1023}if(mt<=127){if(Pe>=At)break;ue[Pe++>>>0]=mt}else if(mt<=2047){if(Pe+1>=At)break;ue[Pe++>>>0]=192|mt>>6,ue[Pe++>>>0]=128|mt&63}else if(mt<=65535){if(Pe+2>=At)break;ue[Pe++>>>0]=224|mt>>12,ue[Pe++>>>0]=128|mt>>6&63,ue[Pe++>>>0]=128|mt&63}else{if(Pe+3>=At)break;ue[Pe++>>>0]=240|mt>>18,ue[Pe++>>>0]=128|mt>>12&63,ue[Pe++>>>0]=128|mt>>6&63,ue[Pe++>>>0]=128|mt&63}}return ue[Pe>>>0]=0,Pe-Pt}function Ee(te,ue,Pe){return _e(te,s(),ue,Pe)}var Se,Re,Ze,at,Je,st;_&&(Se=c.buffer);function He(te){Se=te,c.HEAP8=Re=new Int8Array(te),c.HEAP16=new Int16Array(te),c.HEAP32=at=new Int32Array(te),c.HEAPU8=Ze=new Uint8Array(te),c.HEAPU16=new Uint16Array(te),c.HEAPU32=Je=new Uint32Array(te),c.HEAPF32=new Float32Array(te),c.HEAPF64=st=new Float64Array(te)}var xt=c.INITIAL_MEMORY||16777216;if(_)V=c.wasmMemory,Se=c.buffer;else if(c.wasmMemory)V=c.wasmMemory;else if(V=new WebAssembly.Memory({initial:xt/65536,maximum:65536,shared:!0}),!(V.buffer instanceof SharedArrayBuffer))throw H("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),b&&H("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");V&&(Se=V.buffer),xt=Se.byteLength,He(Se);var gt,ft=[],Ft=[],Hn=[];function _t(){return ee}function bn(){if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)Rn(c.preRun.shift());Lt(ft)}function Jt(){!_&&Lt(Ft)}function Mt(){if(!_){if(c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;)wn(c.postRun.shift());Lt(Hn)}}function Rn(te){ft.unshift(te)}function Gn(te){Ft.unshift(te)}function wn(te){Hn.unshift(te)}var $n=0,cn=null;function Nr(te){$n++,c.monitorRunDependencies&&c.monitorRunDependencies($n)}function wi(te){if($n--,c.monitorRunDependencies&&c.monitorRunDependencies($n),$n==0&&cn){var ue=cn;cn=null,ue()}}function tr(te){c.onAbort&&c.onAbort(te),te="Aborted("+te+")",H(te),X=!0,Y=1,te+=". Build with -sASSERTIONS for more info.";var ue=new WebAssembly.RuntimeError(te);throw p(ue),ue}var $a="data:application/octet-stream;base64,";function yn(te){return te.startsWith($a)}function Ge(te){return te.startsWith("file://")}var rt;rt="tfjs-backend-wasm-threaded-simd.wasm",yn(rt)||(rt=C(rt));function xi(te){try{if(te==rt&&J)return new Uint8Array(J);if(A)return A(te);throw"both async and sync fetching of the wasm failed"}catch(ue){tr(ue)}}function Tn(){if(!J&&(v||y)){if(typeof fetch=="function"&&!Ge(rt))return fetch(rt,{credentials:"same-origin"}).then(function(te){if(!te.ok)throw"failed to load wasm binary file at '"+rt+"'";return te.arrayBuffer()}).catch(function(){return xi(rt)});if(N)return new Promise(function(te,ue){N(rt,function(Pe){te(new Uint8Array(Pe))},ue)})}return Promise.resolve().then(function(){return xi(rt)})}function qn(){var te={env:Jd,wasi_snapshot_preview1:Jd};function ue(qe,mt){var vn=qe.exports;if(c.asm=vn,Li(c.asm._emscripten_tls_init),gt=c.asm.__indirect_function_table,Gn(c.asm.__wasm_call_ctors),Q=mt,!_){var Wi=Le.unusedWorkers.length;Le.unusedWorkers.forEach(function(Na){Le.loadWasmModuleToWorker(Na,function(){--Wi||wi()})})}}_||Nr();function Pe(qe){ue(qe.instance,qe.module)}function je(qe){return Tn().then(function(mt){return WebAssembly.instantiate(mt,te)}).then(function(mt){return mt}).then(qe,function(mt){H("failed to asynchronously prepare wasm: "+mt),tr(mt)})}function Pt(){return!J&&typeof WebAssembly.instantiateStreaming=="function"&&!yn(rt)&&!Ge(rt)&&!b&&typeof fetch=="function"?fetch(rt,{credentials:"same-origin"}).then(function(qe){var mt=WebAssembly.instantiateStreaming(qe,te);return mt.then(Pe,function(vn){return H("wasm streaming compile failed: "+vn),H("falling back to ArrayBuffer instantiation"),je(Pe)})}):je(Pe)}if(c.instantiateWasm)try{var At=c.instantiateWasm(te,ue);return At}catch(qe){H("Module.instantiateWasm callback failed with error: "+qe),p(qe)}return Pt().catch(p),{}}var ii={};function Rr(te){this.name="ExitStatus",this.message="Program terminated with exit("+te+")",this.status=te}function Kn(te){var ue=Le.pthreads[te];delete Le.pthreads[te],ue.terminate(),tu(te),Le.runningWorkers.splice(Le.runningWorkers.indexOf(ue),1),ue.pthread_ptr=0}function Dn(te){var ue=Le.pthreads[te];ue.postMessage({cmd:"cancel"})}function se(te){var ue=Le.pthreads[te];ce(ue),Le.returnWorkerToPool(ue)}function Xn(te){var ue=Le.getNewWorker();if(!ue)return 6;Le.runningWorkers.push(ue),Le.pthreads[te.pthread_ptr]=ue,ue.pthread_ptr=te.pthread_ptr;var Pe={cmd:"run",start_routine:te.startRoutine,arg:te.arg,pthread_ptr:te.pthread_ptr};return ue.runPthread=()=>{b&&ue.ref(),ue.postMessage(Pe,te.transferList),delete ue.runPthread},ue.loaded&&ue.runPthread(),0}function nr(te){if(_)return zi(1,1,te);Y=te,_t()||(Le.terminateAllThreads(),c.onExit&&c.onExit(te),X=!0),g(te,new Rr(te))}function ve(te,ue){if(Y=te,!ue&&_)throw $t(te),"unwind";nr(te)}var Ie=ve;function Ye(te){if(te instanceof Rr||te=="unwind")return Y;g(1,te)}var Le={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){_?Le.initWorker():Le.initMainThread()},initMainThread:function(){for(var te=8;te--;)Le.allocateUnusedWorker()},initWorker:function(){ee=!1},setExitStatus:function(te){Y=te},terminateAllThreads:function(){for(var te of Object.values(Le.pthreads))Le.returnWorkerToPool(te);for(var te of Le.unusedWorkers)te.terminate();Le.unusedWorkers=[]},returnWorkerToPool:function(te){var ue=te.pthread_ptr;delete Le.pthreads[ue],Le.unusedWorkers.push(te),Le.runningWorkers.splice(Le.runningWorkers.indexOf(te),1),te.pthread_ptr=0,b&&te.unref(),tu(ue)},receiveObjectTransfer:function(te){},threadInitTLS:function(){Le.tlsInitFunctions.forEach(te=>te())},loadWasmModuleToWorker:function(te,ue){te.onmessage=At=>{var qe=At.data,mt=qe.cmd;if(te.pthread_ptr&&(Le.currentProxiedOperationCallerThread=te.pthread_ptr),qe.targetThread&&qe.targetThread!=qs()){var vn=Le.pthreads[qe.targetThread];vn?vn.postMessage(qe,qe.transferList):H('Internal error! Worker sent a message "'+mt+'" to target pthread '+qe.targetThread+", but that thread no longer exists!"),Le.currentProxiedOperationCallerThread=void 0;return}mt==="processProxyingQueue"?Fi(qe.queue):mt==="spawnThread"?Xn(qe):mt==="cleanupThread"?se(qe.thread):mt==="killThread"?Kn(qe.thread):mt==="cancelThread"?Dn(qe.thread):mt==="loaded"?(te.loaded=!0,b&&te.unref(),ue&&ue(te),te.runPthread&&te.runPthread()):mt==="print"?q("Thread "+qe.threadId+": "+qe.text):mt==="printErr"?H("Thread "+qe.threadId+": "+qe.text):mt==="alert"?alert("Thread "+qe.threadId+": "+qe.text):qe.target==="setimmediate"?te.postMessage(qe):mt==="callHandler"?c[qe.handler](...qe.args):mt&&H("worker sent an unknown command "+mt),Le.currentProxiedOperationCallerThread=void 0},te.onerror=At=>{var qe="worker sent an error!";throw H(qe+" "+At.filename+":"+At.lineno+": "+At.message),At},b&&(te.on("message",function(At){te.onmessage({data:At})}),te.on("error",function(At){te.onerror(At)}),te.on("detachedExit",function(){}));var Pe=[],je=["onExit","onAbort","print","printErr"];for(var Pt of je)c.hasOwnProperty(Pt)&&Pe.push(Pt);te.postMessage({cmd:"load",handlers:Pe,urlOrBlob:c.mainScriptUrlOrBlob||r,wasmMemory:V,wasmModule:Q})},allocateUnusedWorker:function(){var te,ue=C("tfjs-backend-wasm-threaded-simd.worker.js");te=new Worker(ue),Le.unusedWorkers.push(te)},getNewWorker:function(){return Le.unusedWorkers.length==0&&(Le.allocateUnusedWorker(),Le.loadWasmModuleToWorker(Le.unusedWorkers[0])),Le.unusedWorkers.pop()}};c.PThread=Le;function Lt(te){for(;te.length>0;)te.shift()(c)}function Zt(){var te=qs(),ue=o()[te+52>>>2],Pe=o()[te+56>>>2],je=ue-Pe;ec(ue,je),tc(ue)}c.establishStackSpace=Zt;function $t(te){if(_)return zi(2,0,te);try{Ie(te)}catch(ue){Ye(ue)}}var St=[];function an(te){var ue=St[te];return ue||(te>=St.length&&(St.length=te+1),St[te]=ue=gt.get(te)),ue}function Ue(te,ue){var Pe=an(te)(ue);_t()?Le.setExitStatus(Pe):bm(Pe)}c.invokeEntryPoint=Ue;function Li(te){Le.tlsInitFunctions.push(te)}function xo(te){_r(te,!y,1,!v),Le.threadInitTLS()}function _s(te){_?postMessage({cmd:"cleanupThread",thread:te}):se(te)}function nt(te,ue,Pe,je){return _?zi(3,1,te,ue,Pe,je):Et(te,ue,Pe,je)}function Et(te,ue,Pe,je){if(typeof SharedArrayBuffer>"u")return H("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var Pt=[],At=0;if(_&&(Pt.length===0||At))return nt(te,ue,Pe,je);var qe={startRoutine:Pe,pthread_ptr:te,arg:je,transferList:Pt};return _?(qe.cmd="spawnThread",postMessage(qe,Pt),0):Xn(qe)}function Ln(){return 65536}var Ot=!0;function _o(){return Ot}function Fi(te){Atomics.store(o(),te>>2,1),qs()&&Qu(te),Atomics.compareExchange(o(),te>>2,1,0)}c.executeNotifiedProxyingQueue=Fi;function ym(te,ue,Pe,je){if(te==ue)setTimeout(()=>Fi(je));else if(_)postMessage({targetThread:te,cmd:"processProxyingQueue",queue:je});else{var Pt=Le.pthreads[te];if(!Pt)return;Pt.postMessage({cmd:"processProxyingQueue",queue:je})}return 1}function s0(te,ue,Pe){return-1}function o0(){tr("")}function rr(te){rr.shown||(rr.shown={}),rr.shown[te]||(rr.shown[te]=1,b&&(te="warning: "+te),H(te))}function ko(){b||y||rr("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")}function Ql(){return Date.now()}function eu(){return 4294901760}function l0(){return eu()}var Zd;b?Zd=()=>{var te=process.hrtime();return te[0]*1e3+te[1]/1e6}:Zd=()=>performance.timeOrigin+performance.now();function u0(te,ue,Pe){s().copyWithin(te>>>0,ue>>>0,ue+Pe>>>0)}function c0(){return b?XRe().cpus().length:navigator.hardwareConcurrency}function Xd(te){var ue=Yd(),Pe=te();return tc(ue),Pe}function zi(te,ue){var Pe=arguments.length-2,je=arguments;return Xd(()=>{for(var Pt=Pe,At=nu(Pt*8),qe=At>>3,mt=0;mt<Pe;mt++){var vn=je[2+mt];u()[qe+mt>>>0]=vn}return ll(te,Pt,At,ue)})}var vt=[];function xn(te,ue,Pe){vt.length=ue;for(var je=Pe>>3,Pt=0;Pt<ue;Pt++)vt[Pt]=u()[je+Pt>>>0];var At=te<0,qe=At?ii[-te-1]:DT[te];return qe.apply(null,vt)}function Hr(te){try{return V.grow(te-Se.byteLength+65535>>>16),He(V.buffer),1}catch{}}function Wt(te){var ue=s().length;if(te=te>>>0,te<=ue)return!1;var Pe=eu();if(te>Pe)return!1;let je=(vn,Wi)=>vn+(Wi-vn%Wi)%Wi;for(var Pt=1;Pt<=4;Pt*=2){var At=ue*(1+.2/Pt);At=Math.min(At,te+100663296);var qe=Math.min(Pe,je(Math.max(te,At),65536)),mt=Hr(qe);if(mt)return!0}return!1}function fn(){throw"unwind"}function Bi(te){return _?zi(4,1,te):52}function Ta(te,ue,Pe,je,Pt){return _?zi(5,1,te,ue,Pe,je,Pt):70}var ra=[null,[],[]];function d0(te,ue){var Pe=ra[te];ue===0||ue===10?((te===1?q:H)(fe(Pe,0)),Pe.length=0):Pe.push(ue)}function Vt(te,ue,Pe,je){if(_)return zi(6,1,te,ue,Pe,je);for(var Pt=0,At=0;At<Pe;At++){var qe=l()[ue>>>2],mt=l()[ue+4>>>2];ue+=8;for(var vn=0;vn<mt;vn++)d0(te,s()[qe+vn>>>0]);Pt+=mt}return l()[je>>>2]=Pt,0}function gr(te){var ue=c["_"+te];return ue}function p0(te,ue){a().set(te,ue>>>0)}function vm(te,ue,Pe,je,Pt){var At={string:ia=>{var rc=0;if(ia!=null&&ia!==0){var f0=(ia.length<<2)+1;rc=nu(f0),Ee(ia,rc,f0)}return rc},array:ia=>{var rc=nu(ia.length);return p0(ia,rc),rc}};function qe(ia){return ue==="string"?ye(ia):ue==="boolean"?!!ia:ia}var mt=gr(te),vn=[],Wi=0;if(je)for(var Na=0;Na<je.length;Na++){var Gr=At[Pe[Na]];Gr?(Wi===0&&(Wi=Yd()),vn[Na]=Gr(je[Na])):vn[Na]=je[Na]}var So=mt.apply(null,vn);function ix(ia){return Wi!==0&&tc(Wi),qe(ia)}return So=ix(So),So}function Xa(te,ue,Pe,je){Pe=Pe||[];var Pt=Pe.every(qe=>qe==="number"||qe==="boolean"),At=ue!=="string";return At&&Pt&&!je?gr(te):function(){return vm(te,ue,Pe,arguments)}}Le.init();var DT=[null,nr,$t,nt,Bi,Ta,Vt],Jd={__emscripten_init_main_thread_js:xo,__emscripten_thread_cleanup:_s,__pthread_create_js:Et,_emscripten_default_pthread_stack_size:Ln,_emscripten_get_now_is_monotonic:_o,_emscripten_notify_task_queue:ym,_emscripten_set_offscreencanvas_size:s0,abort:o0,emscripten_check_blocking_allowed:ko,emscripten_date_now:Ql,emscripten_get_heap_max:l0,emscripten_get_now:Zd,emscripten_memcpy_big:u0,emscripten_num_logical_cores:c0,emscripten_receive_on_main_thread_js:xn,emscripten_resize_heap:Wt,emscripten_unwind_to_js_event_loop:fn,exit:Ie,fd_close:Bi,fd_seek:Ta,fd_write:Vt,memory:V||c.wasmMemory};qn(),c.___wasm_call_ctors=function(){return(c.___wasm_call_ctors=c.asm.__wasm_call_ctors).apply(null,arguments)},c._init=function(){return(c._init=c.asm.init).apply(null,arguments)},c._init_with_threads_count=function(){return(c._init_with_threads_count=c.asm.init_with_threads_count).apply(null,arguments)},c._get_threads_count=function(){return(c._get_threads_count=c.asm.get_threads_count).apply(null,arguments)},c._register_tensor=function(){return(c._register_tensor=c.asm.register_tensor).apply(null,arguments)},c._dispose_data=function(){return(c._dispose_data=c.asm.dispose_data).apply(null,arguments)},c._dispose=function(){return(c._dispose=c.asm.dispose).apply(null,arguments)},c._Abs=function(){return(c._Abs=c.asm.Abs).apply(null,arguments)},c._Acos=function(){return(c._Acos=c.asm.Acos).apply(null,arguments)},c._Acosh=function(){return(c._Acosh=c.asm.Acosh).apply(null,arguments)},c._Add=function(){return(c._Add=c.asm.Add).apply(null,arguments)},c._AddN=function(){return(c._AddN=c.asm.AddN).apply(null,arguments)},c._All=function(){return(c._All=c.asm.All).apply(null,arguments)},c._Any=function(){return(c._Any=c.asm.Any).apply(null,arguments)},c._ArgMax=function(){return(c._ArgMax=c.asm.ArgMax).apply(null,arguments)},c._ArgMin=function(){return(c._ArgMin=c.asm.ArgMin).apply(null,arguments)},c._Asin=function(){return(c._Asin=c.asm.Asin).apply(null,arguments)},c._Asinh=function(){return(c._Asinh=c.asm.Asinh).apply(null,arguments)},c._Atan=function(){return(c._Atan=c.asm.Atan).apply(null,arguments)},c._Atan2=function(){return(c._Atan2=c.asm.Atan2).apply(null,arguments)},c._Atanh=function(){return(c._Atanh=c.asm.Atanh).apply(null,arguments)},c._AvgPool=function(){return(c._AvgPool=c.asm.AvgPool).apply(null,arguments)},c._AvgPool3D=function(){return(c._AvgPool3D=c.asm.AvgPool3D).apply(null,arguments)},c._AvgPool3DGrad=function(){return(c._AvgPool3DGrad=c.asm.AvgPool3DGrad).apply(null,arguments)},c._AvgPoolGrad=function(){return(c._AvgPoolGrad=c.asm.AvgPoolGrad).apply(null,arguments)},c._BatchMatMul=function(){return(c._BatchMatMul=c.asm.BatchMatMul).apply(null,arguments)},c._Bincount=function(){return(c._Bincount=c.asm.Bincount).apply(null,arguments)},c._BitwiseAnd=function(){return(c._BitwiseAnd=c.asm.BitwiseAnd).apply(null,arguments)},c._Ceil=function(){return(c._Ceil=c.asm.Ceil).apply(null,arguments)},c._ClipByValue=function(){return(c._ClipByValue=c.asm.ClipByValue).apply(null,arguments)},c._Conv2D=function(){return(c._Conv2D=c.asm.Conv2D).apply(null,arguments)},c._Conv2DBackpropInput=function(){return(c._Conv2DBackpropInput=c.asm.Conv2DBackpropInput).apply(null,arguments)},c._Conv3D=function(){return(c._Conv3D=c.asm.Conv3D).apply(null,arguments)},c._Conv3DBackpropFilterV2=function(){return(c._Conv3DBackpropFilterV2=c.asm.Conv3DBackpropFilterV2).apply(null,arguments)},c._Conv3DBackpropInputV2=function(){return(c._Conv3DBackpropInputV2=c.asm.Conv3DBackpropInputV2).apply(null,arguments)},c._Cos=function(){return(c._Cos=c.asm.Cos).apply(null,arguments)},c._Cosh=function(){return(c._Cosh=c.asm.Cosh).apply(null,arguments)},c._CropAndResize=function(){return(c._CropAndResize=c.asm.CropAndResize).apply(null,arguments)},c._Cumprod=function(){return(c._Cumprod=c.asm.Cumprod).apply(null,arguments)},c._Cumsum=function(){return(c._Cumsum=c.asm.Cumsum).apply(null,arguments)},c._DenseBincount=function(){return(c._DenseBincount=c.asm.DenseBincount).apply(null,arguments)},c._DepthToSpace=function(){return(c._DepthToSpace=c.asm.DepthToSpace).apply(null,arguments)},c._DepthwiseConv2dNative=function(){return(c._DepthwiseConv2dNative=c.asm.DepthwiseConv2dNative).apply(null,arguments)},c._Diag=function(){return(c._Diag=c.asm.Diag).apply(null,arguments)},c._Dilation2D=function(){return(c._Dilation2D=c.asm.Dilation2D).apply(null,arguments)},c._Dilation2DBackpropFilter=function(){return(c._Dilation2DBackpropFilter=c.asm.Dilation2DBackpropFilter).apply(null,arguments)},c._Dilation2DBackpropInput=function(){return(c._Dilation2DBackpropInput=c.asm.Dilation2DBackpropInput).apply(null,arguments)},c._Elu=function(){return(c._Elu=c.asm.Elu).apply(null,arguments)},c._EluGrad=function(){return(c._EluGrad=c.asm.EluGrad).apply(null,arguments)},c._Equal=function(){return(c._Equal=c.asm.Equal).apply(null,arguments)},c._Erf=function(){return(c._Erf=c.asm.Erf).apply(null,arguments)},c._Exp=function(){return(c._Exp=c.asm.Exp).apply(null,arguments)},c._Expm1=function(){return(c._Expm1=c.asm.Expm1).apply(null,arguments)},c._FlipLeftRight=function(){return(c._FlipLeftRight=c.asm.FlipLeftRight).apply(null,arguments)},c._Floor=function(){return(c._Floor=c.asm.Floor).apply(null,arguments)},c._FloorDiv=function(){return(c._FloorDiv=c.asm.FloorDiv).apply(null,arguments)},c._FusedBatchNorm=function(){return(c._FusedBatchNorm=c.asm.FusedBatchNorm).apply(null,arguments)},c._FusedConv2D=function(){return(c._FusedConv2D=c.asm.FusedConv2D).apply(null,arguments)},c._FusedDepthwiseConv2D=function(){return(c._FusedDepthwiseConv2D=c.asm.FusedDepthwiseConv2D).apply(null,arguments)},c._Gather=function(){return(c._Gather=c.asm.Gather).apply(null,arguments)},c._GatherNd=function(){return(c._GatherNd=c.asm.GatherNd).apply(null,arguments)},c._Greater=function(){return(c._Greater=c.asm.Greater).apply(null,arguments)},c._GreaterEqual=function(){return(c._GreaterEqual=c.asm.GreaterEqual).apply(null,arguments)},c._IsFinite=function(){return(c._IsFinite=c.asm.IsFinite).apply(null,arguments)},c._IsInf=function(){return(c._IsInf=c.asm.IsInf).apply(null,arguments)},c._IsNan=function(){return(c._IsNan=c.asm.IsNan).apply(null,arguments)},c._LRN=function(){return(c._LRN=c.asm.LRN).apply(null,arguments)},c._LRNGrad=function(){return(c._LRNGrad=c.asm.LRNGrad).apply(null,arguments)},c._LeakyRelu=function(){return(c._LeakyRelu=c.asm.LeakyRelu).apply(null,arguments)},c._Less=function(){return(c._Less=c.asm.Less).apply(null,arguments)},c._LessEqual=function(){return(c._LessEqual=c.asm.LessEqual).apply(null,arguments)},c._LinSpace=function(){return(c._LinSpace=c.asm.LinSpace).apply(null,arguments)},c._Log=function(){return(c._Log=c.asm.Log).apply(null,arguments)},c._Log1p=function(){return(c._Log1p=c.asm.Log1p).apply(null,arguments)},c._LogicalAnd=function(){return(c._LogicalAnd=c.asm.LogicalAnd).apply(null,arguments)},c._LogicalNot=function(){return(c._LogicalNot=c.asm.LogicalNot).apply(null,arguments)},c._LogicalOr=function(){return(c._LogicalOr=c.asm.LogicalOr).apply(null,arguments)},c._LogicalXor=function(){return(c._LogicalXor=c.asm.LogicalXor).apply(null,arguments)},c._Max=function(){return(c._Max=c.asm.Max).apply(null,arguments)},c._MaxPool=function(){return(c._MaxPool=c.asm.MaxPool).apply(null,arguments)},c._MaxPool3D=function(){return(c._MaxPool3D=c.asm.MaxPool3D).apply(null,arguments)},c._MaxPool3DGrad=function(){return(c._MaxPool3DGrad=c.asm.MaxPool3DGrad).apply(null,arguments)},c._MaxPoolGrad=function(){return(c._MaxPoolGrad=c.asm.MaxPoolGrad).apply(null,arguments)},c._MaxPoolWithArgmax=function(){return(c._MaxPoolWithArgmax=c.asm.MaxPoolWithArgmax).apply(null,arguments)},c._Maximum=function(){return(c._Maximum=c.asm.Maximum).apply(null,arguments)},c._Mean=function(){return(c._Mean=c.asm.Mean).apply(null,arguments)},c._Min=function(){return(c._Min=c.asm.Min).apply(null,arguments)},c._Minimum=function(){return(c._Minimum=c.asm.Minimum).apply(null,arguments)},c._MirrorPad=function(){return(c._MirrorPad=c.asm.MirrorPad).apply(null,arguments)},c._Mod=function(){return(c._Mod=c.asm.Mod).apply(null,arguments)},c._Multinomial=function(){return(c._Multinomial=c.asm.Multinomial).apply(null,arguments)},c._Multiply=function(){return(c._Multiply=c.asm.Multiply).apply(null,arguments)},c._Neg=function(){return(c._Neg=c.asm.Neg).apply(null,arguments)},c._NonMaxSuppressionV3=function(){return(c._NonMaxSuppressionV3=c.asm.NonMaxSuppressionV3).apply(null,arguments)},c._NonMaxSuppressionV4=function(){return(c._NonMaxSuppressionV4=c.asm.NonMaxSuppressionV4).apply(null,arguments)},c._NonMaxSuppressionV5=function(){return(c._NonMaxSuppressionV5=c.asm.NonMaxSuppressionV5).apply(null,arguments)},c._NotEqual=function(){return(c._NotEqual=c.asm.NotEqual).apply(null,arguments)},c._OneHot=function(){return(c._OneHot=c.asm.OneHot).apply(null,arguments)},c._PadV2=function(){return(c._PadV2=c.asm.PadV2).apply(null,arguments)},c._Pow=function(){return(c._Pow=c.asm.Pow).apply(null,arguments)},c._Prelu=function(){return(c._Prelu=c.asm.Prelu).apply(null,arguments)},c._Prod=function(){return(c._Prod=c.asm.Prod).apply(null,arguments)},c._RealDiv=function(){return(c._RealDiv=c.asm.RealDiv).apply(null,arguments)},c._Reciprocal=function(){return(c._Reciprocal=c.asm.Reciprocal).apply(null,arguments)},c._Relu=function(){return(c._Relu=c.asm.Relu).apply(null,arguments)},c._Relu6=function(){return(c._Relu6=c.asm.Relu6).apply(null,arguments)},c._ResizeBilinear=function(){return(c._ResizeBilinear=c.asm.ResizeBilinear).apply(null,arguments)},c._ResizeBilinearGrad=function(){return(c._ResizeBilinearGrad=c.asm.ResizeBilinearGrad).apply(null,arguments)},c._ResizeNearestNeighbor=function(){return(c._ResizeNearestNeighbor=c.asm.ResizeNearestNeighbor).apply(null,arguments)},c._ResizeNearestNeighborGrad=function(){return(c._ResizeNearestNeighborGrad=c.asm.ResizeNearestNeighborGrad).apply(null,arguments)},c._Reverse=function(){return(c._Reverse=c.asm.Reverse).apply(null,arguments)},c._RotateWithOffset=function(){return(c._RotateWithOffset=c.asm.RotateWithOffset).apply(null,arguments)},c._Round=function(){return(c._Round=c.asm.Round).apply(null,arguments)},c._Rsqrt=function(){return(c._Rsqrt=c.asm.Rsqrt).apply(null,arguments)},c._ScatterNd=function(){return(c._ScatterNd=c.asm.ScatterNd).apply(null,arguments)},c._SearchSorted=function(){return(c._SearchSorted=c.asm.SearchSorted).apply(null,arguments)},c._SelectV2=function(){return(c._SelectV2=c.asm.SelectV2).apply(null,arguments)},c._Selu=function(){return(c._Selu=c.asm.Selu).apply(null,arguments)},c._Sigmoid=function(){return(c._Sigmoid=c.asm.Sigmoid).apply(null,arguments)},c._Sign=function(){return(c._Sign=c.asm.Sign).apply(null,arguments)},c._Sin=function(){return(c._Sin=c.asm.Sin).apply(null,arguments)},c._Sinh=function(){return(c._Sinh=c.asm.Sinh).apply(null,arguments)},c._Softmax=function(){return(c._Softmax=c.asm.Softmax).apply(null,arguments)},c._Softplus=function(){return(c._Softplus=c.asm.Softplus).apply(null,arguments)},c._SparseFillEmptyRows=function(){return(c._SparseFillEmptyRows=c.asm.SparseFillEmptyRows).apply(null,arguments)},c._SparseReshape=function(){return(c._SparseReshape=c.asm.SparseReshape).apply(null,arguments)},c._SparseSegmentReduction=function(){return(c._SparseSegmentReduction=c.asm.SparseSegmentReduction).apply(null,arguments)},c._SparseToDense=function(){return(c._SparseToDense=c.asm.SparseToDense).apply(null,arguments)},c._Sqrt=function(){return(c._Sqrt=c.asm.Sqrt).apply(null,arguments)},c._Square=function(){return(c._Square=c.asm.Square).apply(null,arguments)},c._SquaredDifference=function(){return(c._SquaredDifference=c.asm.SquaredDifference).apply(null,arguments)},c._Step=function(){return(c._Step=c.asm.Step).apply(null,arguments)},c._StridedSlice=function(){return(c._StridedSlice=c.asm.StridedSlice).apply(null,arguments)},c._Sub=function(){return(c._Sub=c.asm.Sub).apply(null,arguments)},c._Sum=function(){return(c._Sum=c.asm.Sum).apply(null,arguments)},c._Tan=function(){return(c._Tan=c.asm.Tan).apply(null,arguments)},c._Tanh=function(){return(c._Tanh=c.asm.Tanh).apply(null,arguments)},c._TensorScatterUpdate=function(){return(c._TensorScatterUpdate=c.asm.TensorScatterUpdate).apply(null,arguments)},c._Tile=function(){return(c._Tile=c.asm.Tile).apply(null,arguments)},c._TopK=function(){return(c._TopK=c.asm.TopK).apply(null,arguments)},c._Transform=function(){return(c._Transform=c.asm.Transform).apply(null,arguments)},c._Transpose=function(){return(c._Transpose=c.asm.Transpose).apply(null,arguments)},c.__FusedMatMul=function(){return(c.__FusedMatMul=c.asm._FusedMatMul).apply(null,arguments)},c._malloc=function(){return(c._malloc=c.asm.malloc).apply(null,arguments)},c._free=function(){return(c._free=c.asm.free).apply(null,arguments)},c.__emscripten_tls_init=function(){return(c.__emscripten_tls_init=c.asm._emscripten_tls_init).apply(null,arguments)};var qs=c._pthread_self=function(){return(qs=c._pthread_self=c.asm.pthread_self).apply(null,arguments)};c.___errno_location=function(){return(c.___errno_location=c.asm.__errno_location).apply(null,arguments)};var _r=c.__emscripten_thread_init=function(){return(_r=c.__emscripten_thread_init=c.asm._emscripten_thread_init).apply(null,arguments)};c.__emscripten_thread_crashed=function(){return(c.__emscripten_thread_crashed=c.asm._emscripten_thread_crashed).apply(null,arguments)},c._emscripten_main_thread_process_queued_calls=function(){return(c._emscripten_main_thread_process_queued_calls=c.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},c._emscripten_main_browser_thread_id=function(){return(c._emscripten_main_browser_thread_id=c.asm.emscripten_main_browser_thread_id).apply(null,arguments)};var ll=c._emscripten_run_in_main_runtime_thread_js=function(){return(ll=c._emscripten_run_in_main_runtime_thread_js=c.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)};c._emscripten_dispatch_to_thread_=function(){return(c._emscripten_dispatch_to_thread_=c.asm.emscripten_dispatch_to_thread_).apply(null,arguments)};var Qu=c.__emscripten_proxy_execute_task_queue=function(){return(Qu=c.__emscripten_proxy_execute_task_queue=c.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)},tu=c.__emscripten_thread_free_data=function(){return(tu=c.__emscripten_thread_free_data=c.asm._emscripten_thread_free_data).apply(null,arguments)},bm=c.__emscripten_thread_exit=function(){return(bm=c.__emscripten_thread_exit=c.asm._emscripten_thread_exit).apply(null,arguments)},ec=c._emscripten_stack_set_limits=function(){return(ec=c._emscripten_stack_set_limits=c.asm.emscripten_stack_set_limits).apply(null,arguments)},Yd=c.stackSave=function(){return(Yd=c.stackSave=c.asm.stackSave).apply(null,arguments)},tc=c.stackRestore=function(){return(tc=c.stackRestore=c.asm.stackRestore).apply(null,arguments)},nu=c.stackAlloc=function(){return(nu=c.stackAlloc=c.asm.stackAlloc).apply(null,arguments)};c.dynCall_iijjiiii=function(){return(c.dynCall_iijjiiii=c.asm.dynCall_iijjiiii).apply(null,arguments)},c.dynCall_jiji=function(){return(c.dynCall_jiji=c.asm.dynCall_jiji).apply(null,arguments)},c.keepRuntimeAlive=_t,c.wasmMemory=V,c.cwrap=Xa,c.ExitStatus=Rr,c.PThread=Le;var nc;cn=function te(){nc||wm(),nc||(cn=te)};function wm(te){if($n>0)return;if(_){d(c),Jt(),startWorker(c);return}if(bn(),$n>0)return;function ue(){nc||(nc=!0,c.calledRun=!0,!X&&(Jt(),d(c),c.onRuntimeInitialized&&c.onRuntimeInitialized(),Mt()))}c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1),ue()},1)):ue()}if(c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);c.preInit.length>0;)c.preInit.pop()();wm();var ru;h&&(ru={uncaughtException:process.listeners("uncaughtException").filter(function(te){return!h.uncaughtException.indexOf(te)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(te){return!h.unhandledRejection.indexOf(te)>-1})});var Qd;if(typeof WasmBackendModule<"u")Qd=WasmBackendModule;else if(typeof i<"u")Qd=i;else throw new Error("Could not find wasm module in post.js");if(ru){var h0=Qd._dispose;Qd._dispose=function(){h0(),ru.uncaughtException.forEach(function(te){process.removeListener("uncaughtException",te)}),ru.unhandledRejection.forEach(function(te){process.removeListener("unhandledRejection",te)})}}return i.ready}})();typeof e=="object"&&typeof t=="object"?t.exports=n:typeof define=="function"&&define.amd?define([],function(){return n}):typeof e=="object"&&(e.WasmBackendModuleThreadedSimd=n)}),YRe=jr((e,t)=>{t.exports.wasmWorkerContents=`"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",data=>onmessage({data:data}));var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8")+"//# sourceURL="+f)},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}var initializedJS=false;var pendingNotifiedProxyingQueues=[];function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"
");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=(info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onunhandledrejection=e=>{throw e.reason??e};self.startWorker=instance=>{Module=instance;postMessage({"cmd":"loaded"})};self.onmessage=e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;for(const handler of e.data.handlers){Module[handler]=function(){postMessage({cmd:"callHandler",handler:handler,args:[...arguments]})}}Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob=="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module)}else if(e.data.cmd==="run"){Module["__emscripten_thread_init"](e.data.pthread_ptr,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInitTLS();if(!initializedJS){pendingNotifiedProxyingQueues.forEach(queue=>{Module["executeNotifiedProxyingQueue"](queue)});pendingNotifiedProxyingQueues=[];initializedJS=true}try{Module["invokeEntryPoint"](e.data.start_routine,e.data.arg)}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processProxyingQueue"){if(initializedJS){Module["executeNotifiedProxyingQueue"](e.data.queue)}else{pendingNotifiedProxyingQueues.push(e.data.queue)}}else if(e.data.cmd){err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}};`}),QRe=jr((e,t)=>{var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(i){i=i||{};var a=typeof i<"u"?i:{},s,o;a.ready=new Promise(function(ve,Ie){s=ve,o=Ie});var l;typeof process<"u"&&process.listeners&&(l={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var u=Object.assign({},a),c=typeof window=="object",d=typeof importScripts=="function",p=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="";function m(ve){return a.locateFile?a.locateFile(ve,h):h+ve}var g,v,y;if(p){var b=HR(),_=yQ();d?h=_.dirname(h)+"/":h=__dirname+"/",g=(ve,Ie)=>(ve=xt(ve)?new URL(ve):_.normalize(ve),b.readFileSync(ve,Ie?void 0:"utf8")),y=ve=>{var Ie=g(ve,!0);return Ie.buffer||(Ie=new Uint8Array(Ie)),Ie},v=(ve,Ie,Ye)=>{ve=xt(ve)?new URL(ve):_.normalize(ve),b.readFile(ve,function(Le,Lt){Le?Ye(Le):Ie(Lt.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(ve){if(!(ve instanceof _t))throw ve}),process.on("unhandledRejection",function(ve){throw ve}),a.inspect=function(){return"[Emscripten Module object]"}}else(c||d)&&(d?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),r&&(h=r),h.indexOf("blob:")!==0?h=h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):h="",g=ve=>{var Ie=new XMLHttpRequest;return Ie.open("GET",ve,!1),Ie.send(null),Ie.responseText},d&&(y=ve=>{var Ie=new XMLHttpRequest;return Ie.open("GET",ve,!1),Ie.responseType="arraybuffer",Ie.send(null),new Uint8Array(Ie.response)}),v=(ve,Ie,Ye)=>{var Le=new XMLHttpRequest;Le.open("GET",ve,!0),Le.responseType="arraybuffer",Le.onload=()=>{if(Le.status==200||Le.status==0&&Le.response){Ie(Le.response);return}Ye()},Le.onerror=Ye,Le.send(null)});var k=a.print||console.log.bind(console),C=a.printErr||console.warn.bind(console);Object.assign(a,u),u=null,a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.quit&&a.quit;var $;a.wasmBinary&&($=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&Je("no native wasm support detected");var N,A=!1,D=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function O(ve,Ie,Ye){Ie>>>=0;for(var Le=Ie+Ye,Lt=Ie;ve[Lt]&&!(Lt>=Le);)++Lt;if(Lt-Ie>16&&ve.buffer&&D)return D.decode(ve.subarray(Ie,Lt));for(var Zt="";Ie<Lt;){var $t=ve[Ie++];if(!($t&128)){Zt+=String.fromCharCode($t);continue}var St=ve[Ie++]&63;if(($t&224)==192){Zt+=String.fromCharCode(($t&31)<<6|St);continue}var an=ve[Ie++]&63;if(($t&240)==224?$t=($t&15)<<12|St<<6|an:$t=($t&7)<<18|St<<12|an<<6|ve[Ie++]&63,$t<65536)Zt+=String.fromCharCode($t);else{var Ue=$t-65536;Zt+=String.fromCharCode(55296|Ue>>10,56320|Ue&1023)}}return Zt}function F(ve,Ie){return ve>>>=0,ve?O(J,ve,Ie):""}function E(ve,Ie,Ye,Le){if(Ye>>>=0,!(Le>0))return 0;for(var Lt=Ye,Zt=Ye+Le-1,$t=0;$t<ve.length;++$t){var St=ve.charCodeAt($t);if(St>=55296&&St<=57343){var an=ve.charCodeAt(++$t);St=65536+((St&1023)<<10)|an&1023}if(St<=127){if(Ye>=Zt)break;Ie[Ye++>>>0]=St}else if(St<=2047){if(Ye+1>=Zt)break;Ie[Ye++>>>0]=192|St>>6,Ie[Ye++>>>0]=128|St&63}else if(St<=65535){if(Ye+2>=Zt)break;Ie[Ye++>>>0]=224|St>>12,Ie[Ye++>>>0]=128|St>>6&63,Ie[Ye++>>>0]=128|St&63}else{if(Ye+3>=Zt)break;Ie[Ye++>>>0]=240|St>>18,Ie[Ye++>>>0]=128|St>>12&63,Ie[Ye++>>>0]=128|St>>6&63,Ie[Ye++>>>0]=128|St&63}}return Ie[Ye>>>0]=0,Ye-Lt}function z(ve,Ie,Ye){return E(ve,J,Ie,Ye)}var q,H,J,ee;function V(ve){q=ve,a.HEAP8=H=new Int8Array(ve),a.HEAP16=new Int16Array(ve),a.HEAP32=new Int32Array(ve),a.HEAPU8=J=new Uint8Array(ve),a.HEAPU16=new Uint16Array(ve),a.HEAPU32=ee=new Uint32Array(ve),a.HEAPF32=new Float32Array(ve),a.HEAPF64=new Float64Array(ve)}a.INITIAL_MEMORY;var Q=[],X=[],Y=[];function ce(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)ye(a.preRun.shift());bn(Q)}function pe(){bn(X)}function fe(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)Ee(a.postRun.shift());bn(Y)}function ye(ve){Q.unshift(ve)}function _e(ve){X.unshift(ve)}function Ee(ve){Y.unshift(ve)}var Se=0,Re=null;function Ze(ve){Se++,a.monitorRunDependencies&&a.monitorRunDependencies(Se)}function at(ve){if(Se--,a.monitorRunDependencies&&a.monitorRunDependencies(Se),Se==0&&Re){var Ie=Re;Re=null,Ie()}}function Je(ve){a.onAbort&&a.onAbort(ve),ve="Aborted("+ve+")",C(ve),A=!0,ve+=". Build with -sASSERTIONS for more info.";var Ie=new WebAssembly.RuntimeError(ve);throw o(Ie),Ie}var st="data:application/octet-stream;base64,";function He(ve){return ve.startsWith(st)}function xt(ve){return ve.startsWith("file://")}var gt;gt="tfjs-backend-wasm.wasm",He(gt)||(gt=m(gt));function ft(ve){try{if(ve==gt&&$)return new Uint8Array($);if(y)return y(ve);throw"both async and sync fetching of the wasm failed"}catch(Ie){Je(Ie)}}function Ft(){if(!$&&(c||d)){if(typeof fetch=="function"&&!xt(gt))return fetch(gt,{credentials:"same-origin"}).then(function(ve){if(!ve.ok)throw"failed to load wasm binary file at '"+gt+"'";return ve.arrayBuffer()}).catch(function(){return ft(gt)});if(v)return new Promise(function(ve,Ie){v(gt,function(Ye){ve(new Uint8Array(Ye))},Ie)})}return Promise.resolve().then(function(){return ft(gt)})}function Hn(){var ve={env:Tn,wasi_snapshot_preview1:Tn};function Ie($t,St){var an=$t.exports;a.asm=an,N=a.asm.memory,V(N.buffer),a.asm.__indirect_function_table,_e(a.asm.__wasm_call_ctors),at()}Ze();function Ye($t){Ie($t.instance)}function Le($t){return Ft().then(function(St){return WebAssembly.instantiate(St,ve)}).then(function(St){return St}).then($t,function(St){C("failed to asynchronously prepare wasm: "+St),Je(St)})}function Lt(){return!$&&typeof WebAssembly.instantiateStreaming=="function"&&!He(gt)&&!xt(gt)&&!p&&typeof fetch=="function"?fetch(gt,{credentials:"same-origin"}).then(function($t){var St=WebAssembly.instantiateStreaming($t,ve);return St.then(Ye,function(an){return C("wasm streaming compile failed: "+an),C("falling back to ArrayBuffer instantiation"),Le(Ye)})}):Le(Ye)}if(a.instantiateWasm)try{var Zt=a.instantiateWasm(ve,Ie);return Zt}catch($t){C("Module.instantiateWasm callback failed with error: "+$t),o($t)}return Lt().catch(o),{}}function _t(ve){this.name="ExitStatus",this.message="Program terminated with exit("+ve+")",this.status=ve}function bn(ve){for(;ve.length>0;)ve.shift()(a)}function Jt(){Je("")}function Mt(){return 4294901760}function Rn(){return Mt()}function Gn(ve,Ie,Ye){J.copyWithin(ve>>>0,Ie>>>0,Ie+Ye>>>0)}function wn(ve){try{return N.grow(ve-q.byteLength+65535>>>16),V(N.buffer),1}catch{}}function $n(ve){var Ie=J.length;ve=ve>>>0;var Ye=Mt();if(ve>Ye)return!1;let Le=(an,Ue)=>an+(Ue-an%Ue)%Ue;for(var Lt=1;Lt<=4;Lt*=2){var Zt=Ie*(1+.2/Lt);Zt=Math.min(Zt,ve+100663296);var $t=Math.min(Ye,Le(Math.max(ve,Zt),65536)),St=wn($t);if(St)return!0}return!1}function cn(ve){return 52}function Nr(ve,Ie,Ye,Le,Lt){return 70}var wi=[null,[],[]];function tr(ve,Ie){var Ye=wi[ve];Ie===0||Ie===10?((ve===1?k:C)(O(Ye,0)),Ye.length=0):Ye.push(Ie)}function $a(ve,Ie,Ye,Le){for(var Lt=0,Zt=0;Zt<Ye;Zt++){var $t=ee[Ie>>>2],St=ee[Ie+4>>>2];Ie+=8;for(var an=0;an<St;an++)tr(ve,J[$t+an>>>0]);Lt+=St}return ee[Le>>>2]=Lt,0}function yn(ve){var Ie=a["_"+ve];return Ie}function Ge(ve,Ie){H.set(ve,Ie>>>0)}function rt(ve,Ie,Ye,Le,Lt){var Zt={string:Et=>{var Ln=0;if(Et!=null&&Et!==0){var Ot=(Et.length<<2)+1;Ln=Rr(Ot),z(Et,Ln,Ot)}return Ln},array:Et=>{var Ln=Rr(Et.length);return Ge(Et,Ln),Ln}};function $t(Et){return Ie==="string"?F(Et):Ie==="boolean"?!!Et:Et}var St=yn(ve),an=[],Ue=0;if(Le)for(var Li=0;Li<Le.length;Li++){var xo=Zt[Ye[Li]];xo?(Ue===0&&(Ue=qn()),an[Li]=xo(Le[Li])):an[Li]=Le[Li]}var _s=St.apply(null,an);function nt(Et){return Ue!==0&&ii(Ue),$t(Et)}return _s=nt(_s),_s}function xi(ve,Ie,Ye,Le){Ye=Ye||[];var Lt=Ye.every($t=>$t==="number"||$t==="boolean"),Zt=Ie!=="string";return Zt&&Lt&&!Le?yn(ve):function(){return rt(ve,Ie,Ye,arguments)}}var Tn={abort:Jt,emscripten_get_heap_max:Rn,emscripten_memcpy_big:Gn,emscripten_resize_heap:$n,fd_close:cn,fd_seek:Nr,fd_write:$a};Hn(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.__wasm_call_ctors).apply(null,arguments)},a._init=function(){return(a._init=a.asm.init).apply(null,arguments)},a._init_with_threads_count=function(){return(a._init_with_threads_count=a.asm.init_with_threads_count).apply(null,arguments)},a._get_threads_count=function(){return(a._get_threads_count=a.asm.get_threads_count).apply(null,arguments)},a._register_tensor=function(){return(a._register_tensor=a.asm.register_tensor).apply(null,arguments)},a._dispose_data=function(){return(a._dispose_data=a.asm.dispose_data).apply(null,arguments)},a._dispose=function(){return(a._dispose=a.asm.dispose).apply(null,arguments)},a._Abs=function(){return(a._Abs=a.asm.Abs).apply(null,arguments)},a._Acos=function(){return(a._Acos=a.asm.Acos).apply(null,arguments)},a._Acosh=function(){return(a._Acosh=a.asm.Acosh).apply(null,arguments)},a._Add=function(){return(a._Add=a.asm.Add).apply(null,arguments)},a._AddN=function(){return(a._AddN=a.asm.AddN).apply(null,arguments)},a._All=function(){return(a._All=a.asm.All).apply(null,arguments)},a._Any=function(){return(a._Any=a.asm.Any).apply(null,arguments)},a._ArgMax=function(){return(a._ArgMax=a.asm.ArgMax).apply(null,arguments)},a._ArgMin=function(){return(a._ArgMin=a.asm.ArgMin).apply(null,arguments)},a._Asin=function(){return(a._Asin=a.asm.Asin).apply(null,arguments)},a._Asinh=function(){return(a._Asinh=a.asm.Asinh).apply(null,arguments)},a._Atan=function(){return(a._Atan=a.asm.Atan).apply(null,arguments)},a._Atan2=function(){return(a._Atan2=a.asm.Atan2).apply(null,arguments)},a._Atanh=function(){return(a._Atanh=a.asm.Atanh).apply(null,arguments)},a._AvgPool=function(){return(a._AvgPool=a.asm.AvgPool).apply(null,arguments)},a._AvgPool3D=function(){return(a._AvgPool3D=a.asm.AvgPool3D).apply(null,arguments)},a._AvgPool3DGrad=function(){return(a._AvgPool3DGrad=a.asm.AvgPool3DGrad).apply(null,arguments)},a._AvgPoolGrad=function(){return(a._AvgPoolGrad=a.asm.AvgPoolGrad).apply(null,arguments)},a._BatchMatMul=function(){return(a._BatchMatMul=a.asm.BatchMatMul).apply(null,arguments)},a._Bincount=function(){return(a._Bincount=a.asm.Bincount).apply(null,arguments)},a._BitwiseAnd=function(){return(a._BitwiseAnd=a.asm.BitwiseAnd).apply(null,arguments)},a._Ceil=function(){return(a._Ceil=a.asm.Ceil).apply(null,arguments)},a._ClipByValue=function(){return(a._ClipByValue=a.asm.ClipByValue).apply(null,arguments)},a._Conv2D=function(){return(a._Conv2D=a.asm.Conv2D).apply(null,arguments)},a._Conv2DBackpropInput=function(){return(a._Conv2DBackpropInput=a.asm.Conv2DBackpropInput).apply(null,arguments)},a._Conv3D=function(){return(a._Conv3D=a.asm.Conv3D).apply(null,arguments)},a._Conv3DBackpropFilterV2=function(){return(a._Conv3DBackpropFilterV2=a.asm.Conv3DBackpropFilterV2).apply(null,arguments)},a._Conv3DBackpropInputV2=function(){return(a._Conv3DBackpropInputV2=a.asm.Conv3DBackpropInputV2).apply(null,arguments)},a._Cos=function(){return(a._Cos=a.asm.Cos).apply(null,arguments)},a._Cosh=function(){return(a._Cosh=a.asm.Cosh).apply(null,arguments)},a._CropAndResize=function(){return(a._CropAndResize=a.asm.CropAndResize).apply(null,arguments)},a._Cumprod=function(){return(a._Cumprod=a.asm.Cumprod).apply(null,arguments)},a._Cumsum=function(){return(a._Cumsum=a.asm.Cumsum).apply(null,arguments)},a._DenseBincount=function(){return(a._DenseBincount=a.asm.DenseBincount).apply(null,arguments)},a._DepthToSpace=function(){return(a._DepthToSpace=a.asm.DepthToSpace).apply(null,arguments)},a._DepthwiseConv2dNative=function(){return(a._DepthwiseConv2dNative=a.asm.DepthwiseConv2dNative).apply(null,arguments)},a._Diag=function(){return(a._Diag=a.asm.Diag).apply(null,arguments)},a._Dilation2D=function(){return(a._Dilation2D=a.asm.Dilation2D).apply(null,arguments)},a._Dilation2DBackpropFilter=function(){return(a._Dilation2DBackpropFilter=a.asm.Dilation2DBackpropFilter).apply(null,arguments)},a._Dilation2DBackpropInput=function(){return(a._Dilation2DBackpropInput=a.asm.Dilation2DBackpropInput).apply(null,arguments)},a._Elu=function(){return(a._Elu=a.asm.Elu).apply(null,arguments)},a._EluGrad=function(){return(a._EluGrad=a.asm.EluGrad).apply(null,arguments)},a._Equal=function(){return(a._Equal=a.asm.Equal).apply(null,arguments)},a._Erf=function(){return(a._Erf=a.asm.Erf).apply(null,arguments)},a._Exp=function(){return(a._Exp=a.asm.Exp).apply(null,arguments)},a._Expm1=function(){return(a._Expm1=a.asm.Expm1).apply(null,arguments)},a._FlipLeftRight=function(){return(a._FlipLeftRight=a.asm.FlipLeftRight).apply(null,arguments)},a._Floor=function(){return(a._Floor=a.asm.Floor).apply(null,arguments)},a._FloorDiv=function(){return(a._FloorDiv=a.asm.FloorDiv).apply(null,arguments)},a._FusedBatchNorm=function(){return(a._FusedBatchNorm=a.asm.FusedBatchNorm).apply(null,arguments)},a._FusedConv2D=function(){return(a._FusedConv2D=a.asm.FusedConv2D).apply(null,arguments)},a._FusedDepthwiseConv2D=function(){return(a._FusedDepthwiseConv2D=a.asm.FusedDepthwiseConv2D).apply(null,arguments)},a._Gather=function(){return(a._Gather=a.asm.Gather).apply(null,arguments)},a._GatherNd=function(){return(a._GatherNd=a.asm.GatherNd).apply(null,arguments)},a._Greater=function(){return(a._Greater=a.asm.Greater).apply(null,arguments)},a._GreaterEqual=function(){return(a._GreaterEqual=a.asm.GreaterEqual).apply(null,arguments)},a._IsFinite=function(){return(a._IsFinite=a.asm.IsFinite).apply(null,arguments)},a._IsInf=function(){return(a._IsInf=a.asm.IsInf).apply(null,arguments)},a._IsNan=function(){return(a._IsNan=a.asm.IsNan).apply(null,arguments)},a._LRN=function(){return(a._LRN=a.asm.LRN).apply(null,arguments)},a._LRNGrad=function(){return(a._LRNGrad=a.asm.LRNGrad).apply(null,arguments)},a._LeakyRelu=function(){return(a._LeakyRelu=a.asm.LeakyRelu).apply(null,arguments)},a._Less=function(){return(a._Less=a.asm.Less).apply(null,arguments)},a._LessEqual=function(){return(a._LessEqual=a.asm.LessEqual).apply(null,arguments)},a._LinSpace=function(){return(a._LinSpace=a.asm.LinSpace).apply(null,arguments)},a._Log=function(){return(a._Log=a.asm.Log).apply(null,arguments)},a._Log1p=function(){return(a._Log1p=a.asm.Log1p).apply(null,arguments)},a._LogicalAnd=function(){return(a._LogicalAnd=a.asm.LogicalAnd).apply(null,arguments)},a._LogicalNot=function(){return(a._LogicalNot=a.asm.LogicalNot).apply(null,arguments)},a._LogicalOr=function(){return(a._LogicalOr=a.asm.LogicalOr).apply(null,arguments)},a._LogicalXor=function(){return(a._LogicalXor=a.asm.LogicalXor).apply(null,arguments)},a._Max=function(){return(a._Max=a.asm.Max).apply(null,arguments)},a._MaxPool=function(){return(a._MaxPool=a.asm.MaxPool).apply(null,arguments)},a._MaxPool3D=function(){return(a._MaxPool3D=a.asm.MaxPool3D).apply(null,arguments)},a._MaxPool3DGrad=function(){return(a._MaxPool3DGrad=a.asm.MaxPool3DGrad).apply(null,arguments)},a._MaxPoolGrad=function(){return(a._MaxPoolGrad=a.asm.MaxPoolGrad).apply(null,arguments)},a._MaxPoolWithArgmax=function(){return(a._MaxPoolWithArgmax=a.asm.MaxPoolWithArgmax).apply(null,arguments)},a._Maximum=function(){return(a._Maximum=a.asm.Maximum).apply(null,arguments)},a._Mean=function(){return(a._Mean=a.asm.Mean).apply(null,arguments)},a._Min=function(){return(a._Min=a.asm.Min).apply(null,arguments)},a._Minimum=function(){return(a._Minimum=a.asm.Minimum).apply(null,arguments)},a._MirrorPad=function(){return(a._MirrorPad=a.asm.MirrorPad).apply(null,arguments)},a._Mod=function(){return(a._Mod=a.asm.Mod).apply(null,arguments)},a._Multinomial=function(){return(a._Multinomial=a.asm.Multinomial).apply(null,arguments)},a._Multiply=function(){return(a._Multiply=a.asm.Multiply).apply(null,arguments)},a._Neg=function(){return(a._Neg=a.asm.Neg).apply(null,arguments)},a._NonMaxSuppressionV3=function(){return(a._NonMaxSuppressionV3=a.asm.NonMaxSuppressionV3).apply(null,arguments)},a._NonMaxSuppressionV4=function(){return(a._NonMaxSuppressionV4=a.asm.NonMaxSuppressionV4).apply(null,arguments)},a._NonMaxSuppressionV5=function(){return(a._NonMaxSuppressionV5=a.asm.NonMaxSuppressionV5).apply(null,arguments)},a._NotEqual=function(){return(a._NotEqual=a.asm.NotEqual).apply(null,arguments)},a._OneHot=function(){return(a._OneHot=a.asm.OneHot).apply(null,arguments)},a._PadV2=function(){return(a._PadV2=a.asm.PadV2).apply(null,arguments)},a._Pow=function(){return(a._Pow=a.asm.Pow).apply(null,arguments)},a._Prelu=function(){return(a._Prelu=a.asm.Prelu).apply(null,arguments)},a._Prod=function(){return(a._Prod=a.asm.Prod).apply(null,arguments)},a._RealDiv=function(){return(a._RealDiv=a.asm.RealDiv).apply(null,arguments)},a._Reciprocal=function(){return(a._Reciprocal=a.asm.Reciprocal).apply(null,arguments)},a._Relu=function(){return(a._Relu=a.asm.Relu).apply(null,arguments)},a._Relu6=function(){return(a._Relu6=a.asm.Relu6).apply(null,arguments)},a._ResizeBilinear=function(){return(a._ResizeBilinear=a.asm.ResizeBilinear).apply(null,arguments)},a._ResizeBilinearGrad=function(){return(a._ResizeBilinearGrad=a.asm.ResizeBilinearGrad).apply(null,arguments)},a._ResizeNearestNeighbor=function(){return(a._ResizeNearestNeighbor=a.asm.ResizeNearestNeighbor).apply(null,arguments)},a._ResizeNearestNeighborGrad=function(){return(a._ResizeNearestNeighborGrad=a.asm.ResizeNearestNeighborGrad).apply(null,arguments)},a._Reverse=function(){return(a._Reverse=a.asm.Reverse).apply(null,arguments)},a._RotateWithOffset=function(){return(a._RotateWithOffset=a.asm.RotateWithOffset).apply(null,arguments)},a._Round=function(){return(a._Round=a.asm.Round).apply(null,arguments)},a._Rsqrt=function(){return(a._Rsqrt=a.asm.Rsqrt).apply(null,arguments)},a._ScatterNd=function(){return(a._ScatterNd=a.asm.ScatterNd).apply(null,arguments)},a._SearchSorted=function(){return(a._SearchSorted=a.asm.SearchSorted).apply(null,arguments)},a._SelectV2=function(){return(a._SelectV2=a.asm.SelectV2).apply(null,arguments)},a._Selu=function(){return(a._Selu=a.asm.Selu).apply(null,arguments)},a._Sigmoid=function(){return(a._Sigmoid=a.asm.Sigmoid).apply(null,arguments)},a._Sign=function(){return(a._Sign=a.asm.Sign).apply(null,arguments)},a._Sin=function(){return(a._Sin=a.asm.Sin).apply(null,arguments)},a._Sinh=function(){return(a._Sinh=a.asm.Sinh).apply(null,arguments)},a._Softmax=function(){return(a._Softmax=a.asm.Softmax).apply(null,arguments)},a._Softplus=function(){return(a._Softplus=a.asm.Softplus).apply(null,arguments)},a._SparseFillEmptyRows=function(){return(a._SparseFillEmptyRows=a.asm.SparseFillEmptyRows).apply(null,arguments)},a._SparseReshape=function(){return(a._SparseReshape=a.asm.SparseReshape).apply(null,arguments)},a._SparseSegmentReduction=function(){return(a._SparseSegmentReduction=a.asm.SparseSegmentReduction).apply(null,arguments)},a._SparseToDense=function(){return(a._SparseToDense=a.asm.SparseToDense).apply(null,arguments)},a._Sqrt=function(){return(a._Sqrt=a.asm.Sqrt).apply(null,arguments)},a._Square=function(){return(a._Square=a.asm.Square).apply(null,arguments)},a._SquaredDifference=function(){return(a._SquaredDifference=a.asm.SquaredDifference).apply(null,arguments)},a._Step=function(){return(a._Step=a.asm.Step).apply(null,arguments)},a._StridedSlice=function(){return(a._StridedSlice=a.asm.StridedSlice).apply(null,arguments)},a._Sub=function(){return(a._Sub=a.asm.Sub).apply(null,arguments)},a._Sum=function(){return(a._Sum=a.asm.Sum).apply(null,arguments)},a._Tan=function(){return(a._Tan=a.asm.Tan).apply(null,arguments)},a._Tanh=function(){return(a._Tanh=a.asm.Tanh).apply(null,arguments)},a._TensorScatterUpdate=function(){return(a._TensorScatterUpdate=a.asm.TensorScatterUpdate).apply(null,arguments)},a._Tile=function(){return(a._Tile=a.asm.Tile).apply(null,arguments)},a._TopK=function(){return(a._TopK=a.asm.TopK).apply(null,arguments)},a._Transform=function(){return(a._Transform=a.asm.Transform).apply(null,arguments)},a._Transpose=function(){return(a._Transpose=a.asm.Transpose).apply(null,arguments)},a.__FusedMatMul=function(){return(a.__FusedMatMul=a.asm._FusedMatMul).apply(null,arguments)},a._malloc=function(){return(a._malloc=a.asm.malloc).apply(null,arguments)},a._free=function(){return(a._free=a.asm.free).apply(null,arguments)},a.___errno_location=function(){return(a.___errno_location=a.asm.__errno_location).apply(null,arguments)};var qn=a.stackSave=function(){return(qn=a.stackSave=a.asm.stackSave).apply(null,arguments)},ii=a.stackRestore=function(){return(ii=a.stackRestore=a.asm.stackRestore).apply(null,arguments)},Rr=a.stackAlloc=function(){return(Rr=a.stackAlloc=a.asm.stackAlloc).apply(null,arguments)};a.dynCall_iijjiiii=function(){return(a.dynCall_iijjiiii=a.asm.dynCall_iijjiiii).apply(null,arguments)},a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.dynCall_jiji).apply(null,arguments)},a.cwrap=xi;var Kn;Re=function ve(){Kn||Dn(),Kn||(Re=ve)};function Dn(ve){if(Se>0||(ce(),Se>0))return;function Ie(){Kn||(Kn=!0,a.calledRun=!0,!A&&(pe(),s(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),fe()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),Ie()},1)):Ie()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();Dn();var se;l&&(se={uncaughtException:process.listeners("uncaughtException").filter(function(ve){return!l.uncaughtException.indexOf(ve)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(ve){return!l.unhandledRejection.indexOf(ve)>-1})});var Xn;if(typeof i<"u")Xn=i;else if(typeof WasmBackendModuleThreadedSimd<"u")Xn=WasmBackendModuleThreadedSimd;else throw new Error("Could not find wasm module in post.js");if(se){var nr=Xn._dispose;Xn._dispose=function(){nr(),se.uncaughtException.forEach(function(ve){process.removeListener("uncaughtException",ve)}),se.unhandledRejection.forEach(function(ve){process.removeListener("unhandledRejection",ve)})}}return i.ready}})();typeof e=="object"&&typeof t=="object"?t.exports=n:typeof define=="function"&&define.amd?define([],function(){return n}):typeof e=="object"&&(e.WasmBackendModule=n)}),j2=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},H1=class{refCount(e){return Ya("refCount")}incRef(e){return Ya("incRef")}timerAvailable(){return!0}time(e){return Ya("time")}read(e){return Ya("read")}readSync(e){return Ya("readSync")}readToGPU(e,t){return Ya("readToGPU")}numDataIds(){return Ya("numDataIds")}disposeData(e,t){return Ya("disposeData")}write(e,t,n){return Ya("write")}move(e,t,n,r,i){return Ya("move")}createTensorFromGPUData(e,t,n){return Ya("createTensorFromGPUData")}memory(){return Ya("memory")}floatPrecision(){return Ya("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return Ya("dispose")}};function Ya(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function vQ(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,WC(e,t,n)}function eDe(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,WC(e,n,r),WC(t,n,r)}function e1(e,t,n){return Math.max(e,Math.min(t,n))}function tDe(e){return e%2===0?e:e+1}function WC(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function nDe(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function rDe(e,t){let n=Math.random();return t*n+(1-n)*e}function iDe(e,t){let n=0;for(let r=0;r<e.length;r++){let i=Number(e[r])-Number(t[r]);n+=i*i}return n}function Z(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function _a(e,t,n=""){Z(Uu(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function Nh(e){Z(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Pn(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function aDe(e){return e.length===0}function bQ(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function Uu(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Zg(e){return e%1===0}function sDe(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function oDe(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function lDe(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return vQ(t),t}function xb(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function uDe(e,t=i=>0,n,r){return new Promise((i,a)=>{let s=0,o=()=>{if(e()){i();return}s++;let l=t(s);if(n!=null&&s>=n){a();return}r!=null?r(o,l):setTimeout(o,l)};o()})}function cDe(e,t){let n=1,r=-1;for(let a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(e[a]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${a}`);r=a}else if(e[a]<0)throw Error(`Shapes can not be < 0. Found ${e[a]} at dim ${a}`);if(r===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);let i=e.slice();return i[r]=t/n,i}function yo(e,t){let n=t.length;return e=e==null?t.map((r,i)=>i):[].concat(e),Z(e.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),Z(e.every(r=>Zg(r)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(r=>r<0?n+r:r)}function wQ(e,t){let n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:yo(t,e).sort(),s=0;for(let o=0;o<e.length;++o){if(a!=null){if(a[s]===o&&e[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${e[o]}' is not 1`);(a[s]==null||a[s]>o)&&e[o]===1&&(n.push(e[o]),r.push(o)),a[s]<=o&&s++}e[o]!==1&&(n.push(e[o]),r.push(o))}return{newShape:n,keptDims:r}}function xQ(e,t){return GR(e,t)}function GR(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function _Q(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function kQ(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function dDe(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function VC(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function SQ(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function Oc(e){return typeof e=="string"||e instanceof String}function CQ(e){return typeof e=="boolean"}function IQ(e){return typeof e=="number"}function G1(e){return Array.isArray(e)?G1(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":IQ(e)?"float32":Oc(e)?"string":CQ(e)?"bool":"float32"}function ad(e){return!!(e&&e.constructor&&e.call&&e.apply)}function jC(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function Py(e){let t=e.length;if(t<2)return[];let n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function $Q(e,t,n,r=!1){let i=new Array;if(t.length===1){let a=t[0]*(r?2:1);for(let s=0;s<a;s++)i[s]=n[e+s]}else{let a=t[0],s=t.slice(1),o=s.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<a;l++)i[l]=$Q(e+l*o,s,n,r)}return i}function Sg(e,t,n=!1){if(e.length===0)return t[0];let r=e.reduce((i,a)=>i*a)*(n?2:1);if(r===0)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return $Q(0,e,t,n)}function pDe(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function qR(e,t){let n=U2(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function U2(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function hDe(e,t){let n=e.reduce((r,i)=>r*i,1);if(t==null||t==="float32")return Sg(e,new Float32Array(n));if(t==="int32")return Sg(e,new Int32Array(n));if(t==="bool")return Sg(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function xs(e){e.forEach(t=>{Z(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function fDe(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function mDe(e,t,n){if(t===0)return[];if(t===1)return[e];let r=new Array(t);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}function H2(e){return e&&e.then&&typeof e.then=="function"}var Gj="tfjsflags",TQ=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=gDe,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(he().getBool("IS_TEST")||he().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){let r=this.urlFlags[e];he().getBool("IS_TEST")||he().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(H2(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;let e=this.getQueryParams(this.global.location.search);Gj in e&&e[Gj].split(",").forEach(t=>{let[n,r]=t.split(":");this.urlFlags[n]=vDe(n,r)})}};function gDe(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(yDe(t,r[0],r[1]),r.join("="))),t}function yDe(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function vDe(e,t){let n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function he(){return KR}var KR=null;function bDe(e){KR=e}var JN;function NQ(){if(JN==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");JN=e}return JN}function wDe(){let e=NQ();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function ZR(e,t){let n=wDe();if(n.has(e))return n.get(e);{let r=t();return n.set(e,r),n.get(e)}}var Ay="Abs",Eh="Acos",Oh="Acosh",Nd="Add",Ph="AddN",My="All",Ry="Any",Dy="ArgMax",Ly="ArgMin",Ah="Asin",Mh="Asinh",Rh="Atan",Dh="Atanh",Lh="Atan2",Fh="AvgPool",q1="AvgPoolGrad",Fy="AvgPool3D",K1="AvgPool3DGrad",zh="BatchMatMul",zy="BatchToSpaceND",By="Bincount",Wy="BitwiseAnd",EQ="BroadcastTo",Z1="BroadcastArgs",Bh="Cast",Wh="Ceil",Ed="ClipByValue",G2="Complex",X1="ComplexAbs",Vy="Concat",Vh="Conv2D",q2="Conv2DBackpropFilter",jh="Conv2DBackpropInput",Uh="Conv3D",jy="Conv3DBackpropFilterV2",Uy="Conv3DBackpropInputV2",Hh="Cos",Gh="Cosh",Hy="Cumprod",qh="Cumsum",Gy="CropAndResize",J1="DenseBincount",qy="DepthToSpace",Kh="DepthwiseConv2dNative",K2="DepthwiseConv2dNativeBackpropFilter",Z2="DepthwiseConv2dNativeBackpropInput",Y1="Diag",Zh="Dilation2D",Xg="Dilation2DBackpropInput",Jg="Dilation2DBackpropFilter",X2="Draw",Xh="RealDiv",J2="Einsum",Jh="Elu",Ky="EluGrad",Yh="Erf",Zy="Equal",Qh="Exp",Xy="ExpandDims",ef="Expm1",Y2="FFT",Q1="Fill",Jy="FlipLeftRight",tf="Floor",nf="FloorDiv",rf="FusedBatchNorm",Yy="GatherV2",Qy="GatherNd",ev="Greater",af="GreaterEqual",sf="Identity",Q2="IFFT",e$="Imag",of="IsFinite",lf="IsInf",uf="IsNan",cf="LeakyRelu",tv="Less",nv="LessEqual",rv="LinSpace",df="Log",pf="Log1p",iv="LogicalAnd",av="LogicalNot",sv="LogicalOr",OQ="LogicalXor",PQ="LogSoftmax",xDe="LowerBound",hf="LRN",ov="LRNGrad",_De="MatrixBandPart",ff="Max",mf="Maximum",gf="MaxPool",ew="MaxPoolGrad",lv="MaxPool3D",tw="MaxPool3DGrad",nw="MaxPoolWithArgmax",yf="Mean",vf="Min",bf="Minimum",wf="MirrorPad",xf="Mod",uv="Multinomial",_f="Multiply",cv="Neg",dv="NotEqual",pv="NonMaxSuppressionV3",hv="NonMaxSuppressionV4",fv="NonMaxSuppressionV5",mv="OnesLike",kf="OneHot",gv="Pack",Sf="PadV2",kDe="Pool",Cf="Pow",If="Prelu",$f="Prod",t$="RaggedGather",n$="RaggedRange",r$="RaggedTensorToTensor",rw="Range",i$="Real",Tf="Reciprocal",Nf="Relu",yv="Reshape",Ef="ResizeNearestNeighbor",vv="ResizeNearestNeighborGrad",Of="ResizeBilinear",bv="ResizeBilinearGrad",Pf="Relu6",Af="Reverse",Mf="Round",Rf="Rsqrt",wv="ScatterNd",xv="TensorScatterUpdate",_v="SearchSorted",kv="Select",Df="Selu",Sv="Slice",Lf="Sin",Ff="Sinh",zf="Sign",Bf="Sigmoid",Wf="Softplus",Vf="Sqrt",jf="Sum",Cv="SpaceToBatchND",Iv="SplitV",Uf="Softmax",iw="SparseFillEmptyRows",$v="SparseReshape",aw="SparseSegmentMean",sw="SparseSegmentSum",Tv="SparseToDense",Hf="SquaredDifference",ow="Square",lw="StaticRegexReplace",Nv="StridedSlice",uw="StringNGrams",cw="StringSplit",dw="StringToHashBucketFast",Gf="Sub",qf="Tan",Kf="Tanh",Od="Tile",Ev="TopK",Ov="Transform",ku="Transpose",pw="Unique",Pv="Unpack",hw="UnsortedSegmentSum",SDe="UpperBound",Av="ZerosLike",Pd="Step",UC="FromPixels",Mv="RotateWithOffset",Jp="_FusedMatMul",Yp="FusedConv2D",Qp="FusedDepthwiseConv2D";function Ic(...e){he().getBool("IS_TEST")||he().getBool("PROD")||console.warn(...e)}function CDe(...e){he().getBool("IS_TEST")||he().getBool("PROD")||console.log(...e)}var Yg=ZR("kernelRegistry",()=>new Map),t1=ZR("gradRegistry",()=>new Map);function n1(e,t){let n=XR(e,t);return Yg.get(n)}function lP(e){return t1.get(e)}function HC(e){let t=Yg.entries(),n=[];for(;;){let{done:r,value:i}=t.next();if(r)break;let[a,s]=i,[o]=a.split("_");o===e&&n.push(s)}return n}function fw(e){let{kernelName:t,backendName:n}=e,r=XR(t,n);Yg.has(r)&&Ic(`The kernel '${t}' for backend '${n}' is already registered`),Yg.set(r,e)}function AQ(e){let{kernelName:t}=e;t1.has(t)&&he().getBool("DEBUG")&&Ic(`Overriding the gradient for '${t}'`),t1.set(t,e)}function IDe(e,t){let n=XR(e,t);if(!Yg.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);Yg.delete(n)}function $De(e){if(!t1.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);t1.delete(e)}function TDe(e,t){HC(e).forEach(n=>{let r=Object.assign({},n,{backendName:t});fw(r)})}function XR(e,t){return`${t}_${e}`}var P={};Dt(P,{arraysEqual:()=>Uu,arraysEqualWithNull:()=>bQ,assert:()=>Z,assertNonNegativeIntegerDimensions:()=>xs,assertNonNull:()=>Nh,assertShapesMatch:()=>_a,bytesFromStringArray:()=>SQ,bytesPerElement:()=>VC,checkConversionForErrors:()=>_Q,clamp:()=>e1,computeStrides:()=>Py,convertBackendValuesAndArrayBuffer:()=>pDe,createScalarValue:()=>MDe,createShuffledIndices:()=>lDe,decodeString:()=>GC,distSquared:()=>iDe,encodeString:()=>gw,fetch:()=>DDe,fingerPrint64:()=>ADe,flatten:()=>sd,getArrayFromDType:()=>GR,getTypedArrayFromDType:()=>xQ,hasEncodingLoss:()=>dDe,hexToLong:()=>mw,indexToLoc:()=>mDe,inferDtype:()=>G1,inferFromImplicitShape:()=>cDe,isBoolean:()=>CQ,isFunction:()=>ad,isInt:()=>Zg,isNumber:()=>IQ,isPromise:()=>H2,isScalarShape:()=>aDe,isString:()=>Oc,isTypedArray:()=>pi,isValidDtype:()=>kQ,locToIndex:()=>fDe,makeOnesTypedArray:()=>qR,makeZerosNestedTypedArray:()=>hDe,makeZerosTypedArray:()=>U2,nearestDivisor:()=>jC,nearestLargerEven:()=>tDe,now:()=>r1,parseAxisParam:()=>yo,randUniform:()=>rDe,repeatedTry:()=>uDe,rightPad:()=>xb,shuffle:()=>vQ,shuffleCombo:()=>eDe,sizeFromShape:()=>Pn,sizeToSquarishShape:()=>oDe,squeezeShape:()=>wQ,sum:()=>nDe,swap:()=>WC,tanh:()=>sDe,toNestedArray:()=>Sg,toTypedArray:()=>a$});function MQ(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var qj=Td(LRe()),pp=qj.default||qj;function mw(e){return pp.fromString(e,!0,16)}var RQ=mw("c3a5c85c97cb3127"),lp=mw("b492b66fbe98f273"),da=mw("9ae16a3b2f90404f");function uP(e){return e.xor(e.shru(47))}function DQ(e,t,n){let r=e.slice(t,t+n);return pp.fromBytes(Array.from(r),!0,!0)}function Jn(e,t){return DQ(e,t,8)}function Kj(e,t){return DQ(e,t,4)}function di(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function Zc(e,t,n=mw("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function NDe(e,t,n,r,i,a){i=i.add(e),a=di(a.add(i).add(r),21);let s=i;return i=i.add(t),i=i.add(n),a=a.add(di(i,44)),[i.add(r),a.add(s)]}function s_(e,t,n,r){return NDe(Jn(e,t),Jn(e,t+8),Jn(e,t+16),Jn(e,t+24),n,r)}function EDe(e,t=e.length){if(t>=8){let n=da.add(t*2),r=Jn(e,0).add(da),i=Jn(e,t-8),a=di(i,37).mul(n).add(r),s=di(r,25).add(i).mul(n);return Zc(a,s,n)}if(t>=4){let n=da.add(t*2),r=Kj(e,0);return Zc(r.shl(3).add(t),Kj(e,t-4),n)}if(t>0){let n=e[0],r=e[t>>1],i=e[t-1],a=n+(r<<8),s=t+(i<<2);return uP(da.mul(a).xor(RQ.mul(s))).mul(da)}return da}function ODe(e,t=e.length){let n=da.add(t*2),r=Jn(e,0).mul(lp),i=Jn(e,8),a=Jn(e,t-8).mul(n),s=Jn(e,t-16).mul(da);return Zc(di(r.add(i),43).add(di(a,30)).add(s),r.add(di(i.add(da),18)).add(a),n)}function PDe(e,t=e.length){let n=da.add(t*2),r=Jn(e,0).mul(da),i=Jn(e,8),a=Jn(e,t-8).mul(n),s=Jn(e,t-16).mul(da),o=di(r.add(i),43).add(di(a,30)).add(s),l=Zc(o,r.add(di(i.add(da),18)).add(a),n),u=Jn(e,16).mul(n),c=Jn(e,24),d=o.add(Jn(e,t-32)).mul(n),p=l.add(Jn(e,t-24)).mul(n);return Zc(di(u.add(c),43).add(di(d,30)).add(p),u.add(di(c.add(r),18)).add(d),n)}function ADe(e,t=e.length){let n=pp.fromNumber(81,!0);if(t<=32)return t<=16?EDe(e,t):ODe(e,t);if(t<=64)return PDe(e,t);let r=n,i=n.mul(lp).add(113),a=uP(i.mul(da).add(113)).mul(da),s=[pp.UZERO,pp.UZERO],o=[pp.UZERO,pp.UZERO];r=r.mul(da).add(Jn(e,0));let l=0,u=(t-1>>6)*64,c=u+(t-1&63)-63;do r=di(r.add(i).add(s[0]).add(Jn(e,l+8)),37).mul(lp),i=di(i.add(s[1]).add(Jn(e,l+48)),42).mul(lp),r=r.xor(o[1]),i=i.add(s[0]).add(Jn(e,l+40)),a=di(a.add(o[0]),33).mul(lp),s=s_(e,l,s[1].mul(lp),r.add(o[0])),o=s_(e,l+32,a.add(o[1]),i.add(Jn(e,l+16))),[a,r]=[r,a],l+=64;while(l!==u);let d=lp.add(a.and(255).shl(1));return l=c,o[0]=o[0].add(t-1&63),s[0]=s[0].add(o[0]),o[0]=o[0].add(s[0]),r=di(r.add(i).add(s[0]).add(Jn(e,l+8)),37).mul(d),i=di(i.add(s[1]).add(Jn(e,l+48)),42).mul(d),r=r.xor(o[1].mul(9)),i=i.add(s[0].mul(9).add(Jn(e,l+40))),a=di(a.add(o[0]),33).mul(d),s=s_(e,l,s[1].mul(d),r.add(o[0])),o=s_(e,l+32,a.add(o[1]),i.add(Jn(e,l+16))),[a,r]=[r,a],Zc(Zc(s[0],o[0],d).add(uP(i).mul(RQ)).add(a),Zc(s[1],o[1],d).add(r),d)}function MDe(e,t){return t==="string"?gw(e):a$([e],t)}function RDe(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function a$(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=sd(e)),he().getBool("DEBUG")&&_Q(e,t),RDe(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){let n=new Uint8Array(e.length);for(let r=0;r<n.length;++r)Math.round(e[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${t}`)}function r1(){return he().platform.now()}function DDe(e,t){return he().platform.fetch(e,t)}function gw(e,t="utf-8"){return t=t||"utf-8",he().platform.encode(e,t)}function GC(e,t="utf-8"){return t=t||"utf-8",he().platform.decode(e,t)}function pi(e){return he().platform.isTypedArray!=null?he().platform.isTypedArray(e):MQ(e)}function sd(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||H2(e)||e==null||pi(e)&&n)t.push(e);else if(Array.isArray(e)||pi(e))for(let r=0;r<e.length;++r)sd(e[r],t,n);else{let r=-1;for(let i of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)sd(e[i],t,n)}return t}var LDe=class{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new zDe)}profileKernel(e,t,n){let r,i=()=>{r=n()},a,s=r1();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(let o of r)o.dataSync();a=Promise.resolve({kernelMs:r1()-s})}if(he().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let o=0;o<r.length;o++){let l=r[o];l.data().then(u=>{FDe(u,l.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then(o=>o.kernelMs),extraInfo:a.then(o=>o.getExtraProfileInfo!=null?o.getExtraProfileInfo():"")}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:r,inputs:i,extraInfo:a}=e;n.forEach(s=>{Promise.all([s.data(),r,a]).then(o=>{this.logger.logKernelProfile(t,s,o[0],o[1],i,o[2])})})}};function FDe(e,t,n){if(t!=="float32")return!1;for(let r=0;r<e.length;r++){let i=e[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${n}'`),!0}return!1}var zDe=class{logKernelProfile(e,t,n,r,i,a){let s=typeof r=="number"?xb(`${r}ms`,9):r.error,o=xb(e,25),l=t.rank,u=t.size,c=xb(t.shape.toString(),14),d="";for(let p in i){let h=i[p];if(h!=null){let m=h.shape||t.shape,g=m.length;d+=`${p}: ${g}D ${g>0?m:""} `}}console.log(`%c${o}	%c${s}	%c${l}D ${c}	%c${u}	%c${d}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function BDe(e,t,n){let r={},i={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){let u=e[l],c=u.inputs;for(let d in c){let p=c[d],h=!1;for(let m=0;m<t.length;m++)if(r[p.id]){u.outputs.forEach(g=>r[g.id]=!0),h=!0,i[u.id]=!0;break}if(h)break}}let a={};a[n.id]=!0;let s={};for(let l=e.length-1;l>=0;l--){let u=e[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(a[u.outputs[d].id]){for(let p in c)a[c[p].id]=!0,s[u.id]=!0;break}}let o=[];for(let l=0;l<e.length;l++){let u=e[l];if(i[u.id]&&s[u.id]){let c={};for(let p in u.inputs){let h=u.inputs[p];r[h.id]&&(c[p]=h)}let d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,o.push(d)}}return o}function WDe(e,t,n,r){for(let i=t.length-1;i>=0;i--){let a=t[i],s=[];if(a.outputs.forEach(l=>{let u=e[l.id];u!=null?s.push(u):s.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);let o=a.gradient(s);for(let l in a.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);let u=n(()=>o[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);let c=a.inputs[l];if(!Uu(u.shape,c.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(e[c.id]==null)e[c.id]=u;else{let d=e[c.id];e[c.id]=r(d,u),d.dispose()}}}}var Zj=20,z0=3,YN=7;function VDe(e,t,n,r){let i=Py(t),a=jDe(e,t,n,i),s=t.length,o=ak(e,t,n,i,a),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${s}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(o.map(u=>"    "+u).join(`
`)),l.join(`
`)}function jDe(e,t,n,r){let i=Pn(t),a=r[r.length-1],s=new Array(a).fill(0),o=t.length,l=n==="complex64"?Y0(e):e;if(o>1)for(let u=0;u<i/a;u++){let c=u*a;for(let d=0;d<a;d++)s[d]=Math.max(s[d],J0(l[c+d],0,n).length)}return s}function J0(e,t,n){let r;return Array.isArray(e)?r=`${parseFloat(e[0].toFixed(YN))} + ${parseFloat(e[1].toFixed(YN))}j`:Oc(e)?r=`'${e}'`:n==="bool"?r=LQ(e):r=parseFloat(e.toFixed(YN)).toString(),xb(r,t)}function LQ(e){return e===0?"false":"true"}function ak(e,t,n,r,i,a=!0){let s=n==="complex64"?2:1,o=t[0],l=t.length;if(l===0){if(n==="complex64"){let g=Y0(e);return[J0(g[0],0,n)]}return n==="bool"?[LQ(e[0])]:[e[0].toString()]}if(l===1){if(o>Zj){let g=z0*s,v=Array.from(e.slice(0,g)),y=Array.from(e.slice((o-z0)*s,o*s));return n==="complex64"&&(v=Y0(v),y=Y0(y)),["["+v.map((b,_)=>J0(b,i[_],n)).join(", ")+", ..., "+y.map((b,_)=>J0(b,i[o-z0+_],n)).join(", ")+"]"]}return["["+(n==="complex64"?Y0(e):Array.from(e)).map((g,v)=>J0(g,i[v],n)).join(", ")+"]"]}let u=t.slice(1),c=r.slice(1),d=r[0]*s,p=[];if(o>Zj){for(let g=0;g<z0;g++){let v=g*d,y=v+d;p.push(...ak(e.slice(v,y),u,n,c,i,!1))}p.push("...");for(let g=o-z0;g<o;g++){let v=g*d,y=v+d;p.push(...ak(e.slice(v,y),u,n,c,i,g===o-1))}}else for(let g=0;g<o;g++){let v=g*d,y=v+d;p.push(...ak(e.slice(v,y),u,n,c,i,g===o-1))}let h=l===2?",":"";p[0]="["+(o>0?p[0]+h:"");for(let g=1;g<p.length-1;g++)p[g]=" "+p[g]+h;let m=`,
`;for(let g=2;g<l;g++)m+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(a?"":m),p}function Y0(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Br=class{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=Pn(e),n!=null){let r=n.length;Z(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||GR(t,this.size),this.strides=Py(e)}set(e,...t){t.length===0&&(t=[0]),Z(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);let n=this.locToIndex(t);this.values[n]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(let r of e){if(r<0||r>=this.shape[t]){let i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.values[n]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];let t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Mo().makeTensor(this.values,this.shape,this.dtype)}},Mo=null,jm=null;function UDe(e){Mo=e}function HDe(e){jm=e}var zt=class{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Pn(e),this.strides=Py(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){let e=await this.data();return jm.buffer(this.shape,this.dtype,e)}bufferSync(){return jm.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return Sg(this.shape,e,this.dtype==="complex64")}arraySync(){return Sg(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();let e=Mo().read(this.dataId);if(this.dtype==="string"){let t=await e;try{return t.map(n=>GC(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Mo().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=Mo().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>GC(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await Mo().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Mo().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return jm.print(this,e)}clone(){return this.throwIfDisposed(),jm.clone(this)}toString(e=!1){let t=this.dataSync();return VDe(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),jm.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),Mo().makeVariable(this,e,t,n)}};Object.defineProperty(zt,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function xe(){return ZR("Tensor",()=>zt)}xe();var eh=class extends zt{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Uu(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Mo().disposeTensor(this),this.dataId=e.dataId,Mo().incRef(this,null)}dispose(){Mo().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(eh,Symbol.hasInstance,{value:e=>e instanceof zt&&e.assign!=null&&e.assign instanceof Function});var Bo={};Dt(Bo,{assertTypesMatch:()=>BQ,getTensorsInContainer:()=>JR,isTensorInList:()=>qDe,makeTypesMatch:()=>xr});var cP;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(cP||(cP={}));var dP;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(dP||(dP={}));var pP;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(pP||(pP={}));var hP;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(hP||(hP={}));var fP;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(fP||(fP={}));var GDe={float32:hP,int32:dP,bool:pP,complex64:fP};function Ls(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return GDe[e][t]}function s$(e){return Ls(e,"int32")}function FQ(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function zQ(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}function xr(e,t){if(e.dtype===t.dtype)return[e,t];let n=Ls(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function BQ(e,t){Z(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function qDe(e,t){return t.some(n=>n.id===e.id)}function JR(e){let t=[];return WQ(e,t,new Set),t}function WQ(e,t,n){if(e==null)return;if(e instanceof zt){t.push(e);return}if(!KDe(e))return;let r=e;for(let i in r){let a=r[i];n.has(a)||(n.add(a),WQ(a,t,n))}}function KDe(e){return Array.isArray(e)||typeof e=="object"}function QN(e){return e.kernelName!=null}var Xj=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}},YR=class mP{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Xj}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let t=this.getSortedBackends();for(let n=0;n<t.length;n++){let r=t[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){let{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,r=1){return t in this.registryFactory?(Ic(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:r},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;let{success:n,asyncInit:r}=this.initializeBackend(t);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new LDe(this.backendInstance),!0}setupRegisteredKernels(){HC(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){HC(t).forEach(n=>{n.disposeFunc!=null&&n.disposeFunc(this.registry[t])})}initializeBackend(t){let n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{let r=n.factory();if(r&&!(r instanceof H1)&&typeof r.then=="function"){let i=++this.pendingBackendInitId,a=r.then(s=>i<this.pendingBackendInitId?!1:(this.registry[t]=s,this.pendingBackendInit=null,!0)).catch(s=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,Ic(`Initialization of backend ${t} failed`),Ic(s.stack||s.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(r){return Ic(`Initialization of backend ${t} failed`),Ic(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){let t=this.getSortedBackends();for(let n=0;n<t.length;n++){let r=t[n],{success:i,asyncInit:a}=this.initializeBackend(r);if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){let r=this.state.tensorInfo.get(n),i=r.backend,a=this.readSync(n),s=i.refCount(n);i.disposeData(n,!0),r.backend=t,t.move(n,a,r.shape,r.dtype,s),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let r=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}let i;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(i),()=>(i=n(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(t,n,r){t();try{let i=r();return n(),i}catch(i){throw n(),i}}nextTensorId(){return mP.nextTensorId++}nextVariableId(){return mP.nextVariableId++}clone(t){let n=ne.runKernel(sf,{x:t}),r={x:t},i=s=>({x:()=>{let o="float32",l={x:s},u={dtype:o};return ne.runKernel(Bh,l,u)}}),a=[];return this.addTapeNode(this.state.activeScope.name,r,[n],i,a,{}),n}runKernel(t,n,r){if(this.backendName==null&&this.backend,n1(t,this.backendName)==null)throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,r){let i=this.backend.numDataIds(),a=0;r.forEach(l=>{a+=l.dtype==="complex64"?3:1});let s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=i-n-a-s;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t){let n,r=[],i=this.isTapeOn(),a=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l,u=QN(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(QN(t)){let{kernelName:m,inputs:g,attrs:v}=t;this.backendName==null&&this.backend;let y=n1(m,this.backendName);Z(y!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),o=()=>{let b=this.backend.numDataIds();l=y.kernelFunc({inputs:g,attrs:v,backend:this.backend});let _=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,b,_);let k=_.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(i){let C=this.getTensorsForGradient(m,g,k);r=this.saveTensorsForBackwardMode(C)}return k}}else{let{forwardFunc:m}=t,g=v=>{i&&(r=v.map(y=>this.keep(this.clone(y))))};o=()=>{let v=this.backend.numDataIds();l=this.tidy(()=>m(this.backend,g));let y=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,v,y),y}}let{inputs:c,attrs:d}=t,p=QN(t)?null:t.backwardsFunc,h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=o():(h=this.profiler.profileKernel(u,c,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),n=h.outputs)}),i&&this.addTapeNode(u,c,n,p,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(m=>c[m]!=null?c[m].shape:null),outputShapes:n.map(m=>m.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(n=>this.keep(this.clone(n)))}getTensorsForGradient(t,n,r){let i=lP(t);if(i!=null){let a=i.inputsToSave||[],s=i.outputsToSave||[],o;i.saveAllInputs?(Z(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(n).map(u=>n[u])):o=a.map(u=>n[u]);let l=r.filter((u,c)=>s[c]);return o.concat(l)}return[]}makeTensor(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;let a=t;r==="string"&&Oc(t[0])&&(a=t.map(l=>gw(l)));let s=i.write(a,n,r),o=new zt(n,r,s,this.nextTensorId());if(this.trackTensor(o,i),r==="string"){let l=this.state.tensorInfo.get(s),u=SQ(a);this.state.numBytes+=u-l.bytes,l.bytes=u}return o}makeTensorFromDataId(t,n,r,i){r=r||"float32";let a={dataId:t,shape:n,dtype:r};return this.makeTensorFromTensorInfo(a,i)}makeTensorFromTensorInfo(t,n){let{dataId:r,shape:i,dtype:a}=t,s=new zt(i,a,r,this.nextTensorId());return this.trackTensor(s,n),s}makeVariable(t,n=!0,r,i){r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.cast(i));let a=new eh(t,n,r,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let r=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(r=t.size*VC(t.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:r})),t instanceof eh||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;let n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){let r=t.size*VC(t.dtype);this.state.numBytes-=r}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(let t in this.state.registeredVariables){let n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){let t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;let n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(let i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,r,i,a,s){let o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:a},l=lP(t);l!=null&&(i=l.gradFunc),i!=null&&(o.gradient=u=>(u=u.map((c,d)=>{if(c==null){let p=r[d],h=U2(p.size,p.dtype);return this.makeTensor(h,p.shape,p.dtype)}return c}),i(u.length>1?u:u[0],a,s))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){let n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){let n=JR(t),r=new Set(n.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){let s=this.state.activeScope.track[a];!s.kept&&!r.has(s.id)&&s.dispose()}let i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(a=>{!a.kept&&a.scopeId===i.id&&this.track(a)})}gradients(t,n,r,i=!1){if(Z(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);let a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));Z(a instanceof zt,()=>"The result y returned by f() must be a tensor.");let s=BDe(this.state.activeTape,n,a);if(!i&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let o={};o[a.id]=r==null?ZDe(a.shape):r,WDe(o,s,u=>this.tidy(u),XDe);let l=n.map(u=>o[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(let c of u.saved)c.dispose()}),this.state.activeTape=null),{value:a,grads:l}})}customGrad(t){return Z(ad(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{Z(n.every(o=>o instanceof zt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r,i={};n.forEach((o,l)=>{i[l]=o});let a=(o,l)=>(r=t(...n,l),Z(r.value instanceof zt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Z(ad(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),s=(o,l)=>{let u=r.gradFunc(o,l),c=Array.isArray(u)?u:[u];Z(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Z(c.every(p=>p instanceof zt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let d={};return c.forEach((p,h)=>{d[h]=()=>p}),d};return this.runKernelFunc({forwardFunc:a,backwardsFunc:s,inputs:i})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){let n=r1(),r=await this.backend.time(t);return r.wallMs=r1()-n,r}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Xj;for(let t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};YR.nextTensorId=0;YR.nextVariableId=0;function ZDe(e){let t=qR(Pn(e),"float32");return ne.makeTensor(t,e,"float32")}function VQ(){let e=NQ();if(e._tfengine==null){let t=new TQ(e);e._tfengine=new YR(t)}return bDe(e._tfengine.ENV),UDe(()=>e._tfengine),e._tfengine}var ne=VQ();function XDe(e,t){let n={a:e,b:t};return ne.runKernel(Nd,n)}var yw={};Dt(yw,{isBrowser:()=>jQ,isMobile:()=>QDe,mockIsMobile:()=>YDe});function JDe(){return typeof navigator<"u"&&navigator!=null}var gP;function YDe(e){gP=e}function QDe(e){if(gP!==void 0)return gP;if(e||JDe()){if(e||(e=navigator),e.product==="ReactNative")return!0;let t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){let n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function jQ(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var za=he();za.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});za.registerFlag("IS_BROWSER",()=>jQ());za.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");za.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));za.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));za.registerFlag("PROD",()=>!1);za.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>za.getBool("DEBUG"));za.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);za.registerFlag("IS_TEST",()=>!1);za.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>za.getBool("DEBUG"));za.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);za.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);za.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function Vl(e,t){let n=e;if(pi(e))return t==="string"?[]:[e.length];if(FQ(e)){let i=e.channels||"RGBA";return[e.height,e.width*i.length]}else if(zQ(e))return[e.buffer.size/(t==null?4:VC(t))];if(!Array.isArray(e))return[];let r=[];for(;Array.isArray(n)||pi(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&he().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&UQ(e,r,[]),r}function UQ(e,t,n){if(n=n||[],!Array.isArray(e)&&!pi(e)){Z(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}Z(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),Z(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);let r=t.slice(1);for(let i=0;i<e.length;++i)UQ(e[i],r,n.concat(i))}function Jj(e,t,n,r){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function U(e,t,n,r="numeric"){if(e instanceof xe())return Jj(r,e.dtype,t,n),e;let i=G1(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Jj(r,i,t,n),e==null||!pi(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){let o=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${o}'`)}let a=Vl(e,i);!pi(e)&&!Array.isArray(e)&&(e=[e]);let s=i!=="string"?a$(e,i):sd(e,[],!0);return ne.makeTensor(s,a,i)}function i1(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((i,a)=>U(i,`${t}[${a}]`,n,r))}var QR="__op";function re(e){let t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+QR;let i=(...a)=>{ne.startScope(n);try{let s=r(...a);return H2(s)&&console.error("Cannot return a Promise inside of tidy."),ne.endScope(s),s}catch(s){throw ne.endScope(null),s}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}function eLe(e,t){let n=U(e,"real","complex"),r=U(t,"imag","complex");_a(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);let i={real:n,imag:r};return ne.runKernel(G2,i)}var Ru=re({complex_:eLe});function Ad(e,t,n,r){if(r==null)r=G1(e);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(zQ(e)||FQ(e)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return ne.backend.createTensorFromGPUData(e,t||n,r)}if(!pi(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){xs(t);let i=Pn(t),a=Pn(n);Z(i===a,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${a}`);for(let s=0;s<n.length;++s){let o=n[s],l=s===n.length-1?o!==Pn(t.slice(s)):!0;Z(n[s]===t[s]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!pi(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=r!=="string"?a$(e,r):sd(e,[],!0),ne.makeTensor(e,t,r)}function fa(e,t,n){let r=Vl(e,n);return Ad(e,t,r,n)}var th={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},Hu=class HQ{static join(t){return new HQ(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(r=>pi(r)?r.buffer:r),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let r=0;r<t.length;r++){let i=t[r];r!==t.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let a=n+i.byteLength;this.shards.push({buffer:i,start:n,end:a}),n=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);let r=this.findShardForByte(t);if(r===-1)throw new Error(`Could not find start shard for byte ${t}`);let i=n-t,a=new ArrayBuffer(i),s=new Uint8Array(a),o=0;for(let l=r;l<this.shards.length;l++){let u=this.shards[l],c=t+o-u.start,d=o,p=Math.min(n,u.end)-u.start,h=new Uint8Array(u.buffer,c,p-c);if(s.set(h,d),o+=h.length,n<u.end)break}return a}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(i){return t<i.start?-1:t>=i.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;let r=tLe(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}};function tLe(e,t){let n=0,r=e.length;for(;n<=r;){let i=Math.floor((r-n)/2)+n,a=t(e[i]);if(a===0)return i;a<0?r=i:n=i+1}return-1}function nLe(){he().set("PROD",!0)}function rLe(){he().set("DEBUG",!0)}function iLe(){he().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function GQ(e){he().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function aLe(){ne.disposeVariables()}function Ys(){return ne}function qC(){return ne.memory()}function sLe(e){return ne.profile(e)}function le(e,t){return ne.tidy(e,t)}function Rt(e){JR(e).forEach(t=>t.dispose())}function Jr(e){return ne.keep(e)}function oLe(e){return ne.time(e)}function lLe(e){return ne.setBackend(e)}function uLe(){return ne.ready()}function qQ(){return ne.backendName}function cLe(e){ne.removeBackend(e)}function dLe(e){return ne.findBackend(e)}function pLe(e){return ne.findBackendFactory(e)}function o$(e,t,n=1){return ne.registerBackend(e,t,n)}function eD(){return ne.backend}function hLe(e,t){he().setPlatform(e,t)}var od=4;async function fLe(e,t){let n=[],r=[],i=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);for(let s=0;s<i.length;++s){let o=i[s],l=Array.isArray(e)?e[s].tensor:e[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);let u={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){let c=new Promise(async d=>{let p=await l.bytes(),h=p.reduce((v,y)=>v+y.length,0)+od*p.length,m=new Uint8Array(h),g=0;for(let v=0;v<p.length;v++){let y=p[v],b=new Uint8Array(new Uint32Array([y.length]).buffer);m.set(b,g),g+=od,m.set(y,g),g+=y.length}d(m)});r.push(c)}else r.push(l.data());t!=null&&(u.group=t),n.push(u)}let a=await Promise.all(r);return{data:yLe(a),specs:n}}function KQ(e,t){let n=new Hu(e),r={},i=0;for(let a of t){let s=mLe(a,(o,l)=>n.slice(i+o,i+l));r[a.name]=ZQ(a,n.slice(i,i+s)),i+=s}return r}function mLe(e,t){let n=Pn(e.shape),r;if("quantization"in e){let i=e.quantization;r=th[i.dtype]}else if(e.dtype==="string"){let i=0;for(let a=0;a<n;a++)i+=od+new Uint32Array(t(i,i+od))[0];return i}else r=th[e.dtype];return n*r}async function gLe(e,t){let n=Pn(e.shape),r;if("quantization"in e){let i=e.quantization;r=th[i.dtype]}else if(e.dtype==="string"){let i=0;for(let a=0;a<n;a++)i+=od+new Uint32Array(await t(i,i+od))[0];return i}else r=th[e.dtype];return n*r}function ZQ(e,t){let n=e.name,r=e.dtype,i=e.shape,a=Pn(i),s,o=0;if("quantization"in e){let l=e.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${e.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${e.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${e.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let u=th[l.dtype],c=l.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){s=new Float32Array(c.length);for(let d=0;d<c.length;d++){let p=c[d];s[d]=p*l.scale+l.min}}else if(l.dtype==="float16")s=SLe()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);s=new Int32Array(c.length);for(let d=0;d<c.length;d++){let p=c[d];s[d]=Math.round(p*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);o+=a*u}else if(r==="string"){let l=Pn(e.shape);s=[];for(let u=0;u<l;u++){let c=new Uint32Array(t.slice(o,o+od))[0];o+=od;let d=new Uint8Array(t.slice(o,o+c));s.push(d),o+=c}}else{let l=th[r];if(r==="float32")s=new Float32Array(t);else if(r==="int32")s=new Int32Array(t);else if(r==="bool")s=new Uint8Array(t);else if(r==="complex64"){s=new Float32Array(t);let u=new Float32Array(s.length/2),c=new Float32Array(s.length/2);for(let m=0;m<u.length;m++)u[m]=s[m*2],c[m]=s[m*2+1];let d=fa(u,i,"float32"),p=fa(c,i,"float32"),h=Ru(d,p);return d.dispose(),p.dispose(),h}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);o+=a*l}return fa(s,i,r)}async function Yj(e,t,n){let r=new Uint8Array(t);for(;r.byteLength<n;){let{done:i,value:a}=await e.read();if(i&&a==null){let o=n-r.byteLength;throw new Error(`Reader is done but ${o} bytes are still expected`)}let s=new Uint8Array(r.length+a.byteLength);s.set(r,0),s.set(new Uint8Array(a),r.length),r=s}return r.buffer}async function XQ(e,t){let n={},r=e.getReader(),i=new ArrayBuffer(0);for(let a of t){let s=await gLe(a,async(u,c)=>(i=await Yj(r,i,c),i.slice(u,c)));i=await Yj(r,i,s);let o=i.slice(0,s);i=i.slice(s);let l=ZQ(a,o);if(n[a.name]=l,qQ()==="webgpu"){let u=eD();"uploadToGPU"in u&&Pn(l.shape)>=he().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n}function yLe(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0,n=[];e.forEach(a=>{if(t+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});let r=new Uint8Array(t),i=0;return n.forEach(a=>{r.set(new Uint8Array(a.buffer),i),i+=a.byteLength}),r.buffer}var tD=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Qj(e){return tD?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function vLe(e){if(tD)return Buffer.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let r=0,i=t.length;r<i;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function bLe(e){if(tD){let r=Buffer.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}function wLe(e){return Hu.join(e)}function eU(e){let t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);let n=e.split(t);return n[n.length-1]}function JQ(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function YQ(e,t,n){let r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),r}async function nD(e,t){let n,r;return e.weightsManifest!=null&&([n,r]=await t(e.weightsManifest)),YQ(e,n,r)}function vw(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:Qj(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:Qj(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new Hu(e.weightData).byteLength}}function yP(e){let t=[];for(let n of e)t.push(...n.weights);return t}function xLe(){let e=n=>{let r=n<<13,i=0;for(;!(r&8388608);)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function _Le(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function kLe(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function SLe(){let e=xLe(),t=_Le(),n=kLe();return r=>{let i=new ArrayBuffer(4*r.length),a=new Uint32Array(i);for(let s=0;s<r.length;s++){let o=r[s],l=e[n[o>>10]+(o&1023)]+t[o>>10];a[s]=l}return new Float32Array(i)}}var Fs=class No{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return No.instance==null&&(No.instance=new No),No.instance}static registerSaveRouter(t){No.getInstance().saveRouters.push(t)}static registerLoadRouter(t){No.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return No.getHandlers(t,"save")}static getLoadHandlers(t,n){return No.getHandlers(t,"load",n)}static getHandlers(t,n,r){let i=[];return(n==="load"?No.getInstance().loadRouters:No.getInstance().saveRouters).forEach(a=>{let s=a(t,r);s!==null&&i.push(s)}),i}},CLe=e=>Fs.registerSaveRouter(e),ILe=e=>Fs.registerLoadRouter(e),$Le=e=>Fs.getSaveHandlers(e),TLe=(e,t)=>Fs.getLoadHandlers(e,t),vP="tensorflowjs",bP=1,_p="models_store",Pc="model_info_store";function QQ(){if(!he().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function wP(e){let t=e.result;t.createObjectStore(_p,{keyPath:"modelPath"}),t.createObjectStore(Pc,{keyPath:"modelPath"})}var nh=class{constructor(e){if(this.indexedDB=QQ(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((n,r)=>{let i=this.indexedDB.open(vP,bP);i.onupgradeneeded=()=>wP(i),i.onsuccess=()=>{let a=i.result;if(t==null){let s=a.transaction(_p,"readonly"),o=s.objectStore(_p).get(this.modelPath);o.onsuccess=()=>{if(o.result==null)return a.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));n(o.result.modelArtifacts)},o.onerror=l=>(a.close(),r(o.error)),s.oncomplete=()=>a.close()}else{t.weightData=Hu.join(t.weightData);let s=vw(t),o=a.transaction(Pc,"readwrite"),l=o.objectStore(Pc),u;try{u=l.put({modelPath:this.modelPath,modelArtifactsInfo:s})}catch(d){return r(d)}let c;u.onsuccess=()=>{c=a.transaction(_p,"readwrite");let d=c.objectStore(_p),p;try{p=d.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:s})}catch(h){return r(h)}p.onsuccess=()=>n({modelArtifactsInfo:s}),p.onerror=h=>{l=o.objectStore(Pc);let m=l.delete(this.modelPath);m.onsuccess=()=>(a.close(),r(p.error)),m.onerror=g=>(a.close(),r(p.error))}},u.onerror=d=>(a.close(),r(u.error)),o.oncomplete=()=>{c==null?a.close():c.oncomplete=()=>a.close()}}},i.onerror=a=>r(i.error)})}};nh.URL_SCHEME="indexeddb://";var eee=e=>he().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(nh.URL_SCHEME)?NLe(e.slice(nh.URL_SCHEME.length)):null;Fs.registerSaveRouter(eee);Fs.registerLoadRouter(eee);function NLe(e){return new nh(e)}function ELe(e){return e.startsWith(nh.URL_SCHEME)?e.slice(nh.URL_SCHEME.length):e}var OLe=class{constructor(){this.indexedDB=QQ()}async listModels(){return new Promise((e,t)=>{let n=this.indexedDB.open(vP,bP);n.onupgradeneeded=()=>wP(n),n.onsuccess=()=>{let r=n.result,i=r.transaction(Pc,"readonly"),a=i.objectStore(Pc).getAll();a.onsuccess=()=>{let s={};for(let o of a.result)s[o.modelPath]=o.modelArtifactsInfo;e(s)},a.onerror=s=>(r.close(),t(a.error)),i.oncomplete=()=>r.close()},n.onerror=r=>t(n.error)})}async removeModel(e){return e=ELe(e),new Promise((t,n)=>{let r=this.indexedDB.open(vP,bP);r.onupgradeneeded=()=>wP(r),r.onsuccess=()=>{let i=r.result,a=i.transaction(Pc,"readwrite"),s=a.objectStore(Pc),o=s.get(e),l;o.onsuccess=()=>{if(o.result==null)return i.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{let u=s.delete(e),c=()=>{l=i.transaction(_p,"readwrite");let d=l.objectStore(_p).delete(e);d.onsuccess=()=>t(o.result.modelArtifactsInfo),d.onerror=p=>n(o.error)};u.onsuccess=c,u.onerror=d=>(c(),i.close(),n(o.error))}},o.onerror=u=>(i.close(),n(o.error)),a.oncomplete=()=>{l==null?i.close():l.oncomplete=()=>i.close()}},r.onerror=i=>n(r.error)})}},vu="/",Um="tensorflowjs_models",tee="info",PLe="model_topology",ALe="weight_specs",MLe="weight_data",RLe="model_metadata";function nee(e){return{info:[Um,e,tee].join(vu),topology:[Um,e,PLe].join(vu),weightSpecs:[Um,e,ALe].join(vu),weightData:[Um,e,MLe].join(vu),modelMetadata:[Um,e,RLe].join(vu)}}function ree(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}function DLe(e){let t=e.split(vu);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(vu)}function LLe(e){return e.startsWith(rh.URL_SCHEME)?e.slice(rh.URL_SCHEME.length):e}var rh=class{constructor(e){if(!he().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=nee(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=vw(e),i=Hu.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,vLe(i));let a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:r}}catch{throw ree(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;let r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;let i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){let s=JSON.parse(i);t.format=s.format,t.generatedBy=s.generatedBy,t.convertedBy=s.convertedBy,s.signature!=null&&(t.signature=s.signature),s.userDefinedMetadata!=null&&(t.userDefinedMetadata=s.userDefinedMetadata),s.modelInitializer!=null&&(t.modelInitializer=s.modelInitializer),s.initializerSignature!=null&&(t.initializerSignature=s.initializerSignature),s.trainingConfig!=null&&(t.trainingConfig=s.trainingConfig)}let a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=bLe(a),t}};rh.URL_SCHEME="localstorage://";var iee=e=>he().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(rh.URL_SCHEME)?FLe(e.slice(rh.URL_SCHEME.length)):null;Fs.registerSaveRouter(iee);Fs.registerLoadRouter(iee);function FLe(e){return new rh(e)}var zLe=class{constructor(){Z(he().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Z(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){let e={},t=Um+vu,n=vu+tee;for(let r=0;r<this.LS.length;++r){let i=this.LS.key(r);if(i.startsWith(t)&&i.endsWith(n)){let a=DLe(i);e[a]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=LLe(e);let t=nee(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);let n=JSON.parse(this.LS.getItem(t.info));return ree(t),n}},Cg="://",ld=class hc{constructor(){this.managers={}}static getInstance(){return hc.instance==null&&(hc.instance=new hc),hc.instance}static registerManager(t,n){Z(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(Cg)&&(t=t.slice(0,t.indexOf(Cg))),Z(t.length>0,()=>"scheme must not be an empty string.");let r=hc.getInstance();Z(r.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=n}static getManager(t){let n=hc.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(hc.getInstance().managers)}};function sk(e){if(e.indexOf(Cg)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ld.getSchemes().join(",")}`);return{scheme:e.split(Cg)[0],path:e.split(Cg)[1]}}async function aee(e,t,n=!1){Z(e!==t,()=>`Old path and new path are the same: '${e}'`);let r=Fs.getLoadHandlers(e);Z(r.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),Z(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`);let i=r[0],a=Fs.getSaveHandlers(t);Z(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),Z(a.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);let s=a[0],o=sk(e).scheme,l=sk(e).path,u=o===sk(e).scheme,c=await i.load();n&&u&&await ld.getManager(o).removeModel(l);let d=await s.save(c);return n&&!u&&await ld.getManager(o).removeModel(l),d.modelArtifactsInfo}async function BLe(){let e=ld.getSchemes(),t={};for(let n of e){let r=await ld.getManager(n).listModels();for(let i in r){let a=n+Cg+i;t[a]=r[i]}}return t}async function WLe(e){let t=sk(e);return ld.getManager(t.scheme).removeModel(t.path)}async function VLe(e,t){return aee(e,t,!1)}async function jLe(e,t){return aee(e,t,!0)}var ULe=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!he().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",n=>{if(n.source===window&&n.data.name===this.messageName){n.stopPropagation();let r=this.functionRefs[n.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return MQ(e)}};if(he().get("IS_BROWSER")){he().setPlatform("browser",new ULe);try{ld.registerManager(rh.URL_SCHEME,new zLe)}catch{}try{ld.registerManager(nh.URL_SCHEME,new OLe)}catch{}}var HLe={importFetch:()=>FRe()},eE,GLe=class{constructor(){this.util=zRe(),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return he().global.fetch!=null?he().global.fetch(e,t):(eE==null&&(eE=HLe.importFetch()),eE(e,t))}now(){let e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}};he().get("IS_NODE")&&!he().get("IS_BROWSER")&&he().setPlatform("node",new GLe);function Gt(e,t="float32",n){return t=t||"float32",xs(e),new Br(e,t,n)}function qLe(e,t){let n=U(e,"x","cast");if(!kQ(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");let r={x:n},i={dtype:t};return ne.runKernel(Bh,r,i)}var Me=re({cast_:qLe});function KLe(e){let t={x:U(e,"x","clone","string_or_numeric")};return ne.runKernel(sf,t)}var Fl=re({clone_:KLe});function rD(e,t=!1){console.log(e.toString(t))}VQ();var ZLe={buffer:Gt,cast:Me,clone:Fl,print:rD};HDe(ZLe);function XLe(e,t){let n=U(e,"a","add"),r=U(t,"b","add");[n,r]=xr(n,r);let i={a:n,b:r};return ne.runKernel(Nd,i)}var we=re({add_:XLe});function JLe(e,t){let n=U(e,"a","floorDiv"),r=U(t,"b","floorDiv");[n,r]=xr(n,r);let i={a:n,b:r};return ne.runKernel(nf,i)}var l$=re({floorDiv_:JLe});function YLe(e,t){let n=U(e,"a","div"),r=U(t,"b","div");if([n,r]=xr(n,r),n.dtype==="int32"&&r.dtype==="int32")return l$(n,r);let i={a:n,b:r},a={};return ne.runKernel(Xh,i,a)}var et=re({div_:YLe});function QLe(e,t){let n=U(e,"a","mul"),r=U(t,"b","mul");[n,r]=xr(n,r);let i={a:n,b:r};return ne.runKernel(_f,i)}var ae=re({mul_:QLe});function eFe(e){let t=U(e,"x","abs");if(t.dtype==="complex64"){let n={x:t};return ne.runKernel(X1,n)}else{let n={x:t};return ne.runKernel(Ay,n)}}var Dr=re({abs_:eFe});function tFe(e){let t={x:U(e,"x","acos")};return ne.runKernel(Eh,t)}var iD=re({acos_:tFe});function nFe(e){let t={x:U(e,"x","acosh")};return ne.runKernel(Oh,t)}var aD=re({acosh_:nFe});function rFe(e){Z(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),Z(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);let t=e.map((i,a)=>U(i,`tensors${a}`,"addN")),n=t[0];t.forEach(i=>{if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(i=>{if(!Uu(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});let r=t;return ne.runKernel(Ph,r)}var see=re({addN_:rFe});function iFe(e,t=null,n=!1){let r={x:U(e,"x","all","bool")},i={axis:t,keepDims:n};return ne.runKernel(My,r,i)}var u$=re({all_:iFe});function aFe(e,t=null,n=!1){let r={x:U(e,"x","any","bool")},i={axis:t,keepDims:n};return ne.runKernel(Ry,r,i)}var a1=re({any_:aFe});function sFe(e,t=0){let n={x:U(e,"x","argMax")},r={axis:t};return ne.runKernel(Dy,n,r)}var ih=re({argMax_:sFe});function oFe(e,t=0){let n={x:U(e,"x","argMin")},r={axis:t};return ne.runKernel(Ly,n,r)}var sD=re({argMin_:oFe});function lFe(e){let t={x:U(e,"x","asin")};return ne.runKernel(Ah,t)}var oD=re({asin_:lFe});function uFe(e){let t={x:U(e,"x","asinh")};return ne.runKernel(Mh,t)}var lD=re({asinh_:uFe});function cFe(e){let t={x:U(e,"x","atan")};return ne.runKernel(Rh,t)}var uD=re({atan_:cFe});function dFe(e,t){let n=U(e,"a","atan2"),r=U(t,"b","atan2");[n,r]=xr(n,r);let i={a:n,b:r};return ne.runKernel(Lh,i)}var cD=re({atan2_:dFe});function pFe(e){let t={x:U(e,"x","atanh")};return ne.runKernel(Dh,t)}var dD=re({atanh_:pFe});function hFe(e,t,n,r,i="NHWC",a){let s=e[3],o=[...t,s],l=uee(i);return bw(e,o,n,a,r,null,null,l)}function oee(e,t,n,r,i,a,s="channelsLast"){let[o,l]=s1(t),u;if(s==="channelsLast")u=[o,l,e[3],e[3]];else if(s==="channelsFirst")u=[o,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${s}`);return bw(e,u,n,r,i,a,!1,s)}function fFe(e,t,n,r,i,a,s="NDHWC"){let[o,l,u]=xP(t),c,d;if(s==="NDHWC")d="channelsLast",c=[o,l,u,e[4],e[4]];else if(s==="NCDHW")d="channelsFirst",c=[o,l,u,e[1],e[1]];else throw new Error(`Unknown dataFormat ${s}`);return lee(e,c,n,r,i,!1,d,a)}function bw(e,t,n,r,i,a,s=!1,o="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,d]=e;else if(o==="channelsFirst")[l,d,u,c]=e;else throw new Error(`Unknown dataFormat ${o}`);let[p,h,,m]=t,[g,v]=s1(n),[y,b]=s1(r),_=Ig(p,y),k=Ig(h,b),{padInfo:C,outHeight:$,outWidth:N}=yFe(i,u,c,g,v,_,k,a,o),A=s?m*d:m,D;return o==="channelsFirst"?D=[l,A,$,N]:o==="channelsLast"&&(D=[l,$,N,A]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:c,inChannels:d,outHeight:$,outWidth:N,outChannels:A,padInfo:C,strideHeight:g,strideWidth:v,filterHeight:p,filterWidth:h,effectiveFilterHeight:_,effectiveFilterWidth:k,dilationHeight:y,dilationWidth:b,inShape:e,outShape:D,filterShape:t}}function lee(e,t,n,r,i,a=!1,s="channelsLast",o){let[l,u,c,d,p]=[-1,-1,-1,-1,-1];if(s==="channelsLast")[l,u,c,d,p]=e;else if(s==="channelsFirst")[l,p,u,c,d]=e;else throw new Error(`Unknown dataFormat ${s}`);let[h,m,g,,v]=t,[y,b,_]=xP(n),[k,C,$]=xP(r),N=Ig(h,k),A=Ig(m,C),D=Ig(g,$),{padInfo:O,outDepth:F,outHeight:E,outWidth:z}=vFe(i,u,c,d,y,b,_,N,A,D,o),q=a?v*p:v,H;return s==="channelsFirst"?H=[l,q,F,E,z]:s==="channelsLast"&&(H=[l,F,E,z,q]),{batchSize:l,dataFormat:s,inDepth:u,inHeight:c,inWidth:d,inChannels:p,outDepth:F,outHeight:E,outWidth:z,outChannels:q,padInfo:O,strideDepth:y,strideHeight:b,strideWidth:_,filterDepth:h,filterHeight:m,filterWidth:g,effectiveFilterDepth:N,effectiveFilterHeight:A,effectiveFilterWidth:D,dilationDepth:k,dilationHeight:C,dilationWidth:$,inShape:e,outShape:H,filterShape:t}}function mFe(e,t,n,r,i){r==null&&(r=pD(e,t,n));let a=e[0],s=e[1],o=o1((a-t+2*r)/n+1,i),l=o1((s-t+2*r)/n+1,i);return[o,l]}function gFe(e,t,n,r,i,a){i==null&&(i=pD(e,t[0],r[0]));let s=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*i>=t[o]&&(s[o]=o1((e[o]-t[o]+2*i)/r[o]+1,a));return s}function pD(e,t,n,r=1){let i=Ig(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function s1(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function xP(e){return typeof e=="number"?[e,e,e]:e}function Ig(e,t){return t<=1?e:e+(e-1)*(t-1)}function yFe(e,t,n,r,i,a,s,o,l){let u,c,d;if(typeof e=="number"){u={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};let p=mFe([t,n],a,r,e,o);c=p[0],d=p[1]}else if(e==="same"){c=Math.ceil(t/r),d=Math.ceil(n/i);let p=Math.max(0,(c-1)*r+a-t),h=Math.max(0,(d-1)*i+s-n),m=Math.floor(p/2),g=p-m,v=Math.floor(h/2),y=h-v;u={top:m,bottom:g,left:v,right:y,type:"SAME"}}else if(e==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-a+1)/r),d=Math.ceil((n-s+1)/i);else if(typeof e=="object"){let p=l==="channelsLast"?e[1][0]:e[2][0],h=l==="channelsLast"?e[1][1]:e[2][1],m=l==="channelsLast"?e[2][0]:e[3][0],g=l==="channelsLast"?e[2][1]:e[3][1];u={top:p,bottom:h,left:m,right:g,type:p===0&&h===0&&m===0&&g===0?"VALID":"EXPLICIT"},c=o1((t-a+p+h)/r+1,o),d=o1((n-s+m+g)/i+1,o)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:u,outHeight:c,outWidth:d}}function vFe(e,t,n,r,i,a,s,o,l,u,c){let d,p,h,m;if(e==="valid"&&(e=0),typeof e=="number"){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};let g=gFe([t,n,r,1],[o,l,u],1,[i,a,s],e,c);p=g[0],h=g[1],m=g[2]}else if(e==="same"){p=Math.ceil(t/i),h=Math.ceil(n/a),m=Math.ceil(r/s);let g=(p-1)*i+o-t,v=(h-1)*a+l-n,y=(m-1)*s+u-r,b=Math.floor(g/2),_=g-b,k=Math.floor(v/2),C=v-k,$=Math.floor(y/2),N=y-$;d={top:k,bottom:C,left:$,right:N,front:b,back:_,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:d,outDepth:p,outHeight:h,outWidth:m}}function o1(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function ud(e){let[t,n,r]=s1(e);return t===1&&n===1&&r===1}function Zl(e,t){return ud(e)||ud(t)}function ah(e){return s1(e).every(t=>t>0)}function uee(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function ka(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")Z(Zg(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(r=>{r.forEach(i=>{Z(Zg(i),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${i}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}function bFe(e,t){let n={x:U(e,"x","reshape","string_or_numeric")},r={shape:t};return ne.runKernel(yv,n,r)}var oe=re({reshape_:bFe});function wFe(e,t,n,r,i){let a=U(e,"x","avgPool","float32"),s=1;Z(Zl(n,s),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);let o=a,l=!1;a.rank===3&&(l=!0,o=oe(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Z(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),ka("avgPool",r,i);let u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i},d=ne.runKernel(Fh,u,c);return d=Me(d,a.dtype),l?oe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var Gu=re({avgPool_:wFe});function xFe(e,t,n,r,i,a="NDHWC"){let s=U(e,"x","avgPool3d","float32"),o=s,l=!1;s.rank===4&&(l=!0,o=oe(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Z(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),Z(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),Z(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),ka("avgPool3d",r,i);let u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},d=ne.runKernel(Fy,u,c);return d=Me(d,o.dtype),l?oe(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var hD=re({avgPool3d_:xFe});function _Fe(e,t=0){Z(e.length>=1,()=>"Pass at least one tensor to concat");let n=i1(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),n.length===1)return Fl(n[0]);let r=n,i={axis:t};return ne.runKernel(Vy,r,i)}var Wn=re({concat_:_Fe});function kFe(e,t,n=!1,r=!1){let i=U(e,"a","matMul"),a=U(t,"b","matMul");[i,a]=xr(i,a);let s={a:i,b:a},o={transposeA:n,transposeB:r};return ne.runKernel(zh,s,o)}var jt=re({matMul_:kFe});function SFe(e){let t={x:U(e,"x","sigmoid","float32")};return ne.runKernel(Bf,t)}var lo=re({sigmoid_:SFe});function CFe(e,t,n){let r=U(e,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");let i={x:r},a={begin:t,size:n};return ne.runKernel(Sv,i,a)}var nn=re({slice_:CFe});function IFe(e){let t={x:U(e,"x","tanh","float32")};return ne.runKernel(Kf,t)}var sh=re({tanh_:IFe});function $Fe(e,t,n,r,i,a){let s=U(e,"forgetBias","basicLSTMCell"),o=U(t,"lstmKernel","basicLSTMCell"),l=U(n,"lstmBias","basicLSTMCell"),u=U(r,"data","basicLSTMCell"),c=U(i,"c","basicLSTMCell"),d=U(a,"h","basicLSTMCell"),p=Wn([u,d],1),h=jt(p,o),m=we(h,l),g=m.shape[0],v=m.shape[1]/4,y=[g,v],b=nn(m,[0,0],y),_=nn(m,[0,v],y),k=nn(m,[0,v*2],y),C=nn(m,[0,v*3],y),$=we(ae(lo(b),sh(_)),ae(c,lo(we(s,k)))),N=ae(sh($),lo(C));return[$,N]}var cee=re({basicLSTMCell_:$Fe});function TFe(e,t,n){let r=U(e,"x","batchToSpaceND"),i=t.reduce((o,l)=>o*l);Z(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),Z(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),Z(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`);let a={x:r},s={blockShape:t,crops:n};return ne.runKernel(zy,a,s)}var ww=re({batchToSpaceND_:TFe});function NFe(e){let t;return e.rank===0||e.rank===1?t=oe(e,[1,1,1,e.size]):e.rank===2?t=oe(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=oe(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}function EFe(e,t,n,r,i,a){a==null&&(a=.001);let s=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm"),u;i!=null&&(u=U(i,"scale","batchNorm"));let c;r!=null&&(c=U(r,"offset","batchNorm")),Z(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Z(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Z(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let d={x:NFe(s),scale:u,offset:c,mean:o,variance:l},p={varianceEpsilon:a},h=ne.runKernel(rf,d,p);return oe(h,s.shape)}var Zf=re({batchNorm_:EFe});function OFe(e,t,n,r,i,a){let s=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm"),u;i!=null&&(u=U(i,"scale","batchNorm"));let c;return r!=null&&(c=U(r,"offset","batchNorm")),Z(s.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${s.rank}.`),Z(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),Z(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&Z(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&Z(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Zf(s,o,l,c,u,a)}var fD=re({batchNorm2d_:OFe});function PFe(e,t,n,r,i,a){let s=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm"),u;i!=null&&(u=U(i,"scale","batchNorm"));let c;return r!=null&&(c=U(r,"offset","batchNorm")),Z(s.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${s.rank}.`),Z(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),Z(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&Z(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&Z(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Zf(s,o,l,c,u,a)}var mD=re({batchNorm3d_:PFe});function AFe(e,t,n,r,i,a){let s=U(e,"x","batchNorm"),o=U(t,"mean","batchNorm"),l=U(n,"variance","batchNorm"),u;i!=null&&(u=U(i,"scale","batchNorm"));let c;return r!=null&&(c=U(r,"offset","batchNorm")),Z(s.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${s.rank}.`),Z(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),Z(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&Z(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&Z(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Zf(s,o,l,c,u,a)}var gD=re({batchNorm4d_:AFe});function MFe(e,t,n){let r=U(e,"x","bincount"),i=U(t,"weights","bincount");Z(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),Z(n>=0,()=>`size must be non-negative, but got ${n}.`),Z(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);let a={x:r,weights:i},s={size:n};return ne.runKernel(By,a,s)}var yD=re({bincount_:MFe});function RFe(e,t){let n=U(e,"x","bitwiseAnd"),r=U(t,"y","bitwiseAnd");if(!Uu(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);let i={a:n,b:r};return ne.runKernel(Wy,i)}var dee=re({bitwiseAnd_:RFe});function DFe(e,t){let n=U(e,"s0","broadcastArgs","int32"),r=U(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);let i={s0:n,s1:r};return ne.runKernel(Z1,i)}var pee=re({broadcastArgs_:DFe});function LFe(e,t){let n=U(e,"broadcastTo","x"),r=n.shape;if(xs(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){let l=n.shape.slice();for(;l.length<t.length;)l.unshift(1);n=oe(n,l)}let i=n.shape,a=Array.from(t);for(let l=t.length-1;l>=0;l--)if(i[l]===t[l])a[l]=1;else if(n.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(a.map((l,u)=>l>1?u:-1).filter(l=>l>=0).length===0)return Fl(n);let s={x:n},o={reps:a};return ne.runKernel(Od,s,o)}var Pp=re({broadcastTo_:LFe});function FFe(e){let t={x:U(e,"x","ceil","float32")};return ne.runKernel(Wh,t)}var vD=re({ceil_:FFe});function ds(e,t,n){xs(e),n=n||G1(t);let r={shape:e,value:t,dtype:n};return ne.runKernel(Q1,{},r)}function zFe(e,t,n){let r=U(e,"x","clipByValue");if(Z(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return ds(r.shape,t,r.dtype);let i={x:r},a={clipValueMin:t,clipValueMax:n};return ne.runKernel(Ed,i,a)}var Yi=re({clipByValue_:zFe});function BFe(e){return Wn(e,0)}var bD=re({concat1d_:BFe});function WFe(e,t){return Wn(e,t)}var wD=re({concat2d_:WFe});function VFe(e,t){return Wn(e,t)}var xD=re({concat3d_:VFe});function jFe(e,t){return Wn(e,t)}var _D=re({concat4d_:jFe});function UFe(e,t,n,r,i="NHWC",a=[1,1],s){let o=U(e,"x","conv2d","float32"),l=U(t,"filter","conv2d","float32"),u=o,c=!1;o.rank===3&&(c=!0,u=oe(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Z(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),Z(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),ka("conv2d",r,s);let d=i==="NHWC"?u.shape[3]:u.shape[1];Z(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),Z(Zl(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),Z(ah(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),Z(ah(n),()=>"Error in conv2D: Strides should be larger than 0.");let p={x:u,filter:l},h={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s},m=ne.runKernel(Vh,p,h);return c?oe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var ga=re({conv2d_:UFe});function HFe(e,t,n,r,i="NWC",a=1,s){let o=U(e,"x","conv1d"),l=U(t,"filter","conv1d"),u=o,c=!1;o.rank===2&&(c=!0,u=oe(o,[1,o.shape[0],o.shape[1]])),Z(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),Z(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),ka("conv1d",r,s),Z(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),Z(Zl(n,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`),Z(ah(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),Z(ah(n),()=>"Error in conv1D: Stride should be larger than 0."),Z(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);let d=oe(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=oe(u,[u.shape[0],1,u.shape[1],u.shape[2]]),h=ga(p,d,[1,n],r,"NHWC",[1,a],s);return c?oe(h,[h.shape[2],h.shape[3]]):oe(h,[h.shape[0],h.shape[2],h.shape[3]])}var c$=re({conv1d_:HFe});function GFe(e,t,n,r,i,a="NHWC",s){Z(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let o=e,l=t,u=!1;t.rank===3&&(u=!0,l=oe(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),Z(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),Z(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),Z(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);let c=a==="NHWC"?o[3]:o[1],d=a==="NHWC"?l.shape[3]:l.shape[1];Z(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),Z(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),ka("conv2dDerInput",i,s);let p={dy:l,filter:n},h={strides:r,pad:i,dataFormat:a,dimRoundingMode:s,inputShape:o},m=ne.runKernel(jh,p,h);return u?oe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var kD=re({conv2DBackpropInput_:GFe});function qFe(e,t,n,r,i,a){let s=U(e,"x","conv2dTranspose"),o=U(t,"filter","conv2dTranspose");return kD(n,s,o,r,i,"NHWC",a)}var d$=re({conv2dTranspose_:qFe});function KFe(e,t,n,r,i="NDHWC",a=[1,1,1]){let s=U(e,"x","conv3d"),o=U(t,"filter","conv3d"),l=s,u=!1;s.rank===4&&(u=!0,l=oe(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Z(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),Z(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),Z(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),Z(Zl(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),Z(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),Z(ah(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),Z(ah(n),()=>"Error in conv3D: Strides should be larger than 0.");let c={x:l,filter:o},d={strides:n,pad:r,dataFormat:i,dilations:a},p=ne.runKernel(Uh,c,d);return u?oe(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var SD=re({conv3d_:KFe});function ZFe(e,t,n,r,i){Z(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let a=e,s=t,o=!1;t.rank===4&&(o=!0,s=oe(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),a=[1,e[0],e[1],e[2],e[3]]);let l=a[4],u=s.shape[4];Z(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),Z(s.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${s.rank}`),Z(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),Z(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),Z(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);let c={dy:s,filter:n},d={pad:i,strides:r,inputShape:a},p=ne.runKernel(Uy,c,d);return o?oe(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var hee=re({conv3DBackpropInput_:ZFe});function XFe(e,t,n,r,i){let a=U(e,"x","conv3dTranspose"),s=U(t,"filter","conv3dTranspose");return hee(n,a,s,r,i)}var CD=re({conv3dTranspose_:XFe});function JFe(e){let t={x:U(e,"x","cos","float32")};return ne.runKernel(Hh,t)}var xw=re({cos_:JFe});function YFe(e){let t={x:U(e,"x","cosh","float32")};return ne.runKernel(Gh,t)}var p$=re({cosh_:YFe});function QFe(e,t=0,n=!1,r=!1){let i={x:U(e,"x","cumprod")},a={axis:t,exclusive:n,reverse:r};return ne.runKernel(Hy,i,a)}var l1=re({cumprod_:QFe});function eze(e,t=0,n=!1,r=!1){let i={x:U(e,"x","cumsum")},a={axis:t,exclusive:n,reverse:r};return ne.runKernel(qh,i,a)}var h$=re({cumsum_:eze});function tze(e,t,n,r=!1){let i=U(e,"x","denseBincount"),a=U(t,"weights","denseBincount");Z(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),Z(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),Z(n>=0,()=>`size must be non-negative, but got ${n}.`),Z(a.size===i.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${a.shape}.`);let s={x:i,weights:a},o={size:n,binaryOutput:r};return ne.runKernel(J1,s,o)}var KC=re({denseBincount_:tze});function nze(e,t,n="NHWC"){let r=U(e,"x","depthToSpace","float32"),i=n==="NHWC"?r.shape[1]:r.shape[2],a=n==="NHWC"?r.shape[2]:r.shape[3],s=n==="NHWC"?r.shape[3]:r.shape[1];Z(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),Z(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t}  for depthToSpace with input shape
    ${r.shape}`),Z(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t} for depthToSpace with input shape
        ${r.shape}`),Z(s%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${s} for depthToSpace with input shape ${r.shape}`);let o={x:r},l={blockSize:t,dataFormat:n};return ne.runKernel(qy,o,l)}var ID=re({depthToSpace_:nze});function rze(e,t,n,r,i="NHWC",a=[1,1],s){let o=U(e,"x","depthwiseConv2d","float32"),l=U(t,"filter","depthwiseConv2d","float32"),u=o,c=!1;o.rank===3&&(c=!0,u=oe(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Z(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),Z(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);let d=i==="NHWC"?u.shape[3]:u.shape[1];Z(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),ka("depthwiseConv2d",r,s);let p={x:u,filter:l},h={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s},m=ne.runKernel(Kh,p,h);return c?oe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var Xf=re({depthwiseConv2d_:rze});function ize(e){let t={x:U(e,"x","diag")};return ne.runKernel(Y1,t)}var fee=re({diag_:ize});function aze(e,t,n,r,i=[1,1],a="NHWC"){let s=U(e,"x","dilation2d"),o=U(t,"filter","dilation2d");Z(s.rank===3||s.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`),Z(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),Z(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let l=s,u=!1;s.rank===3&&(l=oe(s,[1,s.shape[0],s.shape[1],s.shape[2]]),u=!0),Z(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);let c={x:l,filter:o},d={strides:n,pad:r,dilations:i},p=ne.runKernel(Zh,c,d);return u?oe(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var $D=re({dilation2d_:aze}),Rv={};Dt(Rv,{assertAndGetBroadcastShape:()=>Vn,getBroadcastDims:()=>mee,getReductionAxes:()=>Vr});function mee(e,t){let n=e.length,r=[];for(let i=0;i<n;i++){let a=n-1-i,s=e[a]||1;(t[t.length-1-i]||1)>1&&s===1&&r.unshift(a)}return r}function Vr(e,t){let n=[];for(let r=0;r<t.length;r++){let i=e[e.length-r-1],a=t.length-r-1,s=t[a];(i==null||i===1&&s>1)&&n.unshift(a)}return n}function Vn(e,t){let n=Math.max(e.length,t.length),r=new Array(n);for(let i=0;i<n;i++){let a=e[e.length-i-1];a==null&&(a=1);let s=t[t.length-i-1];if(s==null&&(s=1),a===1)r[n-i-1]=s;else if(s===1)r[n-i-1]=a;else if(a!==s){let o=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(o)}else r[n-i-1]=a}return r}function sze(e,t){let n=U(e,"a","equal","string_or_numeric"),r=U(t,"b","equal","string_or_numeric");[n,r]=xr(n,r),Vn(n.shape,r.shape);let i={a:n,b:r};return ne.runKernel(Zy,i)}var ms=re({equal_:sze});function oze(e,t,n){let r=U(t,"a","where"),i=U(n,"b","where"),a=U(e,"condition","where","bool"),s=Vn(Vn(a.shape,r.shape),i.shape),o=Pp(a,s),l=Pp(r,s),u=Pp(i,s),c={condition:o,t:l,e:u};return ne.runKernel(kv,c)}var yi=re({where_:oze});function lze(e){let t={x:U(e,"x","zerosLike")};return ne.runKernel(Av,t)}var sn=re({zerosLike_:lze});function uze(e,t){let n=U(e,"a","div"),r=U(t,"b","div");[n,r]=xr(n,r);let i=et(n,r),a=sn(i),s=ms(r,a);return yi(s,a,i)}var TD=re({divNoNan_:uze});function cze(e,t){let n=U(e,"t1","dot"),r=U(t,"t2","dot");Z((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);let i=n.rank===1?n.size:n.shape[1],a=r.rank===1?r.size:r.shape[0];if(Z(i===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${a}.`),n.rank===1&&r.rank===1){let s=oe(n,[1,-1]),o=oe(r,[-1,1]),l=jt(s,o);return oe(l,[])}else if(n.rank===1&&r.rank===2){let s=oe(n,[1,-1]),o=oe(r,[r.shape[0],r.shape[1]]),l=jt(s,o);return oe(l,[l.size])}else if(n.rank===2&&r.rank===1){let s=oe(r,[-1,1]),o=jt(n,s);return oe(o,[o.size])}else{let s=oe(r,[r.shape[0],r.shape[1]]);return jt(n,s)}}var ND=re({dot_:cze});function dze(e,...t){let n=t.map((i,a)=>U(i,`tensors${a}`,"einsum")),r={equation:e};return ne.runKernel(J2,n,r)}var hp=re({einsum_:dze});function pze(e){let t={x:U(e,"x","elu","float32")};return ne.runKernel(Jh,t)}var Dv=re({elu_:pze});function hze(e,t){let n=U(e,"x","ensureShape","string_or_numeric");if(!bQ(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}var gee=re({ensureShape_:hze});function fze(e){let t=U(e,"x","erf");Z(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=Me(t,"float32"));let n={x:t};return ne.runKernel(Yh,n)}var ED=re({erf_:fze});function OD(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function yee(e,t,n){let r=e.length+t.length,i=[],a=0,s=0;for(let o=0;o<r;o++)n.indexOf(o)===-1?i.push(e[a++]):i.push(t[s++]);return i}function vee(e,t){let n=[],r=e.length;for(let a=0;a<r;a++)t.indexOf(a)===-1&&n.push(e[a]);let i=t.map(a=>e[a]);return[n,i]}function oh(e,t){let n=t.map(r=>1);return yee(e,n,t)}function mze(e,t,n){Z(OD(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function bee(e,t){if(OD(e,t))return null;let n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(r=>n.push(r)),n}function PD(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function gze(e,t){let n=[];for(let r=t-e;r<t;++r)n.push(r);return n}function yze(e,t=null,n=!1){let r={x:U(e,"x","max")},i={reductionIndices:t,keepDims:n};return ne.runKernel(ff,r,i)}var Ms=re({max_:yze});function vze(e,t=null,n=!1){let r={x:U(e,"x","min")},i={axis:t,keepDims:n};return ne.runKernel(vf,r,i)}var Qg=re({min_:vze});function bze(e,t){let n=U(e,"base","pow"),r=U(t,"exp","pow");[n,r]=xr(n,r);let i={a:n,b:r};return ne.runKernel(Cf,i)}var Du=re({pow_:bze});function yt(e,t){if((pi(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&pi(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ad(e,[],[],t)}function wze(e){let t={x:U(e,"x","sqrt","float32")};return ne.runKernel(Vf,t)}var Ai=re({sqrt_:wze});function xze(e){let t=U(e,"x","square"),n={};return ne.runKernel("Square",{x:t},n)}var zn=re({square_:xze});function _ze(e,t=null,n=!1){let r=U(e,"x","sum");r.dtype==="bool"&&(r=Me(r,"int32"));let i={x:r},a={axis:t,keepDims:n};return ne.runKernel(jf,i,a)}var lt=re({sum_:_ze});function kze(e,t="euclidean",n=null,r=!1){e=U(e,"x","norm");let i=wee(e,t,n),a=i.shape;if(r){let s=yo(n,e.shape);a=oh(i.shape,s)}return oe(i,a)}function wee(e,t,n=null){if(e.rank===0)return Dr(e);if(e.rank!==1&&n===null)return wee(oe(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return lt(Dr(e),n);if(t===1/0)return Ms(Dr(e),n);if(t===-1/0)return Qg(Dr(e),n);if(t==="euclidean"||t===2)return Ai(lt(Du(Dr(e),yt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return Ms(lt(Dr(e),n[0]),n[1]-1);if(t===1/0)return Ms(lt(Dr(e),n[1]),n[0]);if(t===-1/0)return Qg(lt(Dr(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Ai(lt(zn(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}var Lv=re({norm_:kze});function Sze(e,t=null,n=!1){return Lv(e,"euclidean",t,n)}var AD=re({euclideanNorm_:Sze});function Cze(e){let t={x:U(e,"x","exp")};return ne.runKernel(Qh,t)}var Qi=re({exp_:Cze});function Ize(e,t=0){let n=U(e,"x","expandDims","string_or_numeric");Z(t<=n.rank,()=>"Axis must be <= rank of the tensor");let r={input:n},i={dim:t};return ne.runKernel(Xy,r,i)}var hi=re({expandDims_:Ize});function $ze(e){let t={x:U(e,"x","expm1")};return ne.runKernel(ef,t)}var MD=re({expm1_:$ze});function Tze(e,t){let n=U(e,"x","tile","string_or_numeric");Z(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);let r={x:n},i={reps:t};return ne.runKernel(Od,r,i)}var ss=re({tile_:Tze});function Nze(e,t,n,r="float32"){t==null&&(t=e);let i=Gt([e,t],r),a=e<=t?e:t;for(let o=0;o<a;++o)i.set(1,o,o);let s=oe(i.toTensor(),[e,t]);if(n==null)return s;if(n.length===1)return ss(hi(s,0),[n[0],1,1]);if(n.length===2)return ss(hi(hi(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return ss(hi(hi(hi(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}var f$=re({eye_:Nze});function Eze(e){let t={x:U(e,"x","floor","float32")};return ne.runKernel(tf,t)}var Fv=re({floor_:Eze});function Oze(e,t,n=0,r=0){let i=U(e,"x","gather"),a=U(t,"indices","gather","int32"),s={x:i,indices:a},o={axis:n,batchDims:r};return ne.runKernel(Yy,s,o)}var zv=re({gather_:Oze});function Pze(e,t){let n=U(e,"a","greater","string_or_numeric"),r=U(t,"b","greater","string_or_numeric");[n,r]=xr(n,r),Vn(n.shape,r.shape);let i={a:n,b:r};return ne.runKernel(ev,i)}var Sa=re({greater_:Pze});function Aze(e,t){let n=U(e,"a","greaterEqual","string_or_numeric"),r=U(t,"b","greaterEqual","string_or_numeric");[n,r]=xr(n,r),Vn(n.shape,r.shape);let i={a:n,b:r};return ne.runKernel(af,i)}var qu=re({greaterEqual_:Aze});function Mze(e){let t={input:U(e,"input","imag")};return ne.runKernel(e$,t)}var _w=re({imag_:Mze});function Rze(e){let t={x:U(e,"x","isFinite")};return ne.runKernel(of,t)}var RD=re({isFinite_:Rze});function Dze(e){let t={x:U(e,"x","isInf")};return ne.runKernel(lf,t)}var DD=re({isInf_:Dze});function Lze(e){let t={x:U(e,"x","isNaN")};return ne.runKernel(uf,t)}var LD=re({isNaN_:Lze});function Fze(e,t=.2){let n={x:U(e,"x","leakyRelu")},r={alpha:t};return ne.runKernel(cf,n,r)}var kw=re({leakyRelu_:Fze});function zze(e,t){let n=U(e,"a","less","string_or_numeric"),r=U(t,"b","less","string_or_numeric");[n,r]=xr(n,r),Vn(n.shape,r.shape);let i={a:n,b:r};return ne.runKernel(tv,i)}var ey=re({less_:zze});function Bze(e,t){let n=U(e,"a","lessEqual","string_or_numeric"),r=U(t,"b","lessEqual","string_or_numeric");[n,r]=xr(n,r),Vn(n.shape,r.shape);let i={a:n,b:r};return ne.runKernel(nv,i)}var Md=re({lessEqual_:Bze});function xee(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");let r={start:e,stop:t,num:n};return ne.runKernel(rv,{},r)}function Wze(e,t=5,n=1,r=1,i=.5){let a=U(e,"x","localResponseNormalization");Z(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),Z(Zg(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let s=a,o=!1;a.rank===3&&(o=!0,s=oe(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let l={x:s},u={depthRadius:t,bias:n,alpha:r,beta:i},c=ne.runKernel(hf,l,u);return o?oe(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var FD=re({localResponseNormalization_:Wze});function Vze(e){let t={x:U(e,"x","log","float32")};return ne.runKernel(df,t)}var gs=re({log_:Vze});function jze(e){let t={x:U(e,"x","log1p")};return ne.runKernel(pf,t)}var Sw=re({log1p_:jze});function Uze(e){return Z(ad(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{let r=U(t,"x","tf.grad","string_or_numeric"),i=n!=null?U(n,"dy","tf.grad"):null;return ne.tidy(()=>{let{value:a,grads:s}=ne.gradients(()=>e(r),[r],i);return i!=null&&_a(a.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),m$(s),s[0]})}}function Hze(e){return Z(ad(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{Z(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let r=i1(t,"args","tf.grads","string_or_numeric"),i=n!=null?U(n,"dy","tf.grads"):null;return ne.tidy(()=>{let{value:a,grads:s}=ne.gradients(()=>e(...r),r,i);return i!=null&&_a(a.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),m$(s),s})}}function Gze(e){return Z(ad(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{Z(t instanceof zt,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),Z(n==null||n instanceof zt,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:r,value:i}=ne.gradients(()=>e(t),[t],n);return m$(r),{grad:r[0],value:i}}}function qze(e){return Z(ad(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{Z(Array.isArray(t)&&t.every(i=>i instanceof zt),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),Z(n==null||n instanceof zt,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let r=ne.gradients(()=>e(...t),t,n);return n!=null&&_a(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),m$(r.grads),r}}function _ee(e,t){Z(ad(e),()=>"The f passed in variableGrads(f) must be a function"),Z(t==null||Array.isArray(t)&&t.every(u=>u instanceof eh),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let n=t!=null;if(!n){t=[];for(let u in ne.registeredVariables)t.push(ne.registeredVariables[u])}let r=n?t.filter(u=>!u.trainable):null,i=t.length;t=t.filter(u=>u.trainable),Z(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);let a=!0,{value:s,grads:o}=ne.gradients(e,t,null,a);Z(o.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),Z(s.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${s.rank} tensor`);let l={};return t.forEach((u,c)=>{o[c]!=null&&(l[u.name]=o[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:s,grads:l}}function jl(e){return ne.customGrad(e)}function m$(e){if(e.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}function Kze(e){let t={x:U(e,"x","neg")};return ne.runKernel(cv,t)}var Yn=re({neg_:Kze});function Zze(e){let t={x:U(e,"x","softplus")};return ne.runKernel(Wf,t)}var Jf=re({softplus_:Zze});function Xze(e){let t=U(e,"x","logSigmoid");return jl(n=>({value:Yn(Jf(Yn(n))),gradFunc:r=>ae(r,lo(Yn(n)))}))(t)}var zD=re({logSigmoid_:Xze});function Jze(e,t){let n=U(e,"a","sub"),r=U(t,"b","sub");[n,r]=xr(n,r);let i={a:n,b:r};return ne.runKernel(Gf,i)}var Ve=re({sub_:Jze});function Yze(e,t=-1){let n=U(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return jl((r,i)=>{let a=Ms(r,t,!0),s=Ve(r,a),o=Ve(Me(s,"float32"),gs(lt(Qi(s),t,!0)));return i([o]),{value:o,gradFunc:(l,u)=>{let[c]=u,d=!0,p=Qi(c);return Ve(l,ae(lt(l,t,d),p))}}})(n)}var g$=re({logSoftmax_:Yze});function Qze(e,t=null,n=!1){let r=U(e,"x","logSumExp"),i=yo(t,r.shape),a=Ms(r,i,!0),s=Ve(r,a),o=Qi(s),l=lt(o,i),u=gs(l),c=we(oe(a,u.shape),u);if(n){let d=oh(c.shape,i);return oe(c,d)}return c}var Cw=re({logSumExp_:Qze});function e3e(e,t){let n=U(e,"a","logicalAnd","bool"),r=U(t,"b","logicalAnd","bool");Vn(n.shape,r.shape);let i={a:n,b:r};return ne.runKernel(iv,i)}var ho=re({logicalAnd_:e3e});function t3e(e){let t={x:U(e,"x","logicalNot","bool")};return ne.runKernel(av,t)}var Iw=re({logicalNot_:t3e});function n3e(e,t){let n=U(e,"a","logicalOr","bool"),r=U(t,"b","logicalOr","bool");Vn(n.shape,r.shape);let i={a:n,b:r};return ne.runKernel(sv,i)}var y$=re({logicalOr_:n3e});function r3e(e,t){let n=U(e,"a","logicalXor","bool"),r=U(t,"b","logicalXor","bool");return Vn(n.shape,r.shape),ho(y$(e,t),Iw(ho(e,t)))}var BD=re({logicalXor_:r3e}),o_=2147483648;function i3e(e,t,n="left"){let r=U(e,"sortedSequence","searchSorted"),i=U(t,"values","searchSorted"),a=r.shape[r.shape.length-1],s=i.shape[i.shape.length-1],o=oe(r,[-1,a]),l=oe(i,[-1,s]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Pn(l.shape)>=o_)throw new Error(`values tensor size must less than ${o_}`);if(o.shape[1]>=o_)throw new Error(`trailing dim_size must less than ${o_} for int32 output type, was ${o.shape[1]}`);let u={sortedSequence:o,values:l},c={side:n};return ne.runKernel(_v,u,c)}var v$=re({searchSorted_:i3e});function kee(e,t){return v$(e,t,"left")}function a3e(e,t,n,r,i){let a=U(e,"x","maxPool"),s=1,o=a,l=!1;a.rank===3&&(l=!0,o=oe(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Z(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),Z(Zl(n,s),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),ka("maxPool",r,i);let u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i},d=ne.runKernel(gf,u,c);return l?oe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var oi=re({maxPool_:a3e});function s3e(e,t=[1,1,1],n,r,i,a="NDHWC"){let s=U(e,"x","maxPool3d"),o=s,l=!1;s.rank===4&&(l=!0,o=oe(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Z(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),Z(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),ka("maxPool3d",r,i);let u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},d=ne.runKernel(lv,u,c);return l?oe(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var WD=re({maxPool3d_:s3e});function o3e(e,t,n,r,i=!1){let a={x:U(e,"x","maxPoolWithArgmax")},s={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},o=ne.runKernel(nw,a,s);return{result:o[0],indexes:o[1]}}var See=re({maxPoolWithArgmax_:o3e});function l3e(e,t){let n=U(e,"a","maximum"),r=U(t,"b","maximum");[n,r]=xr(n,r),n.dtype==="bool"&&(n=Me(n,"int32"),r=Me(r,"int32")),Vn(n.shape,r.shape);let i={a:n,b:r};return ne.runKernel(mf,i)}var Xl=re({maximum_:l3e});function u3e(e,t=null,n=!1){let r={x:U(e,"x","mean")},i={axis:t,keepDims:n};return ne.runKernel(yf,r,i)}var vr=re({mean_:u3e});function br(e,t="float32"){if(xs(e),t==="complex64"){let r=br(e,"float32"),i=br(e,"float32");return Ru(r,i)}let n=U2(Pn(e),t);return ne.makeTensor(n,e,t)}function Aa(e,t="float32"){if(xs(e),t==="complex64"){let r=Aa(e,"float32"),i=br(e,"float32");return Ru(r,i)}let n=qR(Pn(e),t);return ne.makeTensor(n,e,t)}function Cee(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let r=U(e,"x","meshgrid",e instanceof zt?e.dtype:"float32");if(t===void 0)return[r];let i=U(t,"y","meshgrid",t instanceof zt?t.dtype:"float32"),a=Pn(r.shape),s=Pn(i.shape);return n==="xy"?(r=oe(r,[1,-1]),i=oe(i,[-1,1]),[jt(Aa([s,1],r.dtype),r),jt(i,Aa([1,a],i.dtype))]):(r=oe(r,[-1,1]),i=oe(i,[1,-1]),[jt(r,Aa([1,s],r.dtype)),jt(Aa([a,1],i.dtype),i)])}function c3e(e,t){let n=U(e,"a","minimum"),r=U(t,"b","minimum");[n,r]=xr(n,r),n.dtype==="bool"&&(n=Me(n,"int32"),r=Me(r,"int32")),Vn(n.shape,r.shape);let i={a:n,b:r};return ne.runKernel(bf,i)}var cd=re({minimum_:c3e});function d3e(e,t,n){Z(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);let r=U(e,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Z(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);let i=n==="reflect"?1:0;for(let o=0;o<r.rank;o++)Z(t[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Z(t[o][0]>=0&&t[o][0]<=r.shape[o]-i&&t[o][1]>=0&&t[o][1]<=r.shape[o]-i,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-i} or less than 0 for input of shape ${r.shape}`);let a={paddings:t,mode:n},s={x:r};return ne.runKernel(wf,s,a)}var VD=re({mirrorPad_:d3e});function p3e(e,t){let n=U(e,"a","mod"),r=U(t,"b","mod");[n,r]=xr(n,r);let i={a:n,b:r};return ne.runKernel(xf,i)}var jD=re({mod_:p3e});function h3e(e,t=null,n=!1){e=U(e,"x","moments");let r=yo(t,e.shape),i=vr(e,r,n),a=i.shape;n||(a=oh(i.shape,r));let s=zn(Ve(Me(e,"float32"),oe(i,a))),o=vr(s,r,n);return{mean:i,variance:o}}var $w=re({moments_:h3e});function f3e(e,t,n,r){let i=U(t,"data","multiRNNCell"),a=i1(n,"c","multiRNNCell"),s=i1(r,"h","multiRNNCell"),o=i,l=[];for(let d=0;d<e.length;d++){let p=e[d](o,a[d],s[d]);l.push(p[0]),l.push(p[1]),o=p[1]}let u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}var Iee=re({multiRNNCell_:f3e});function m3e(e,t,n,r=!1){let i=U(e,"logits","multinomial"),a=i.size,s=i.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(s>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${s}`);n=n||Math.random();let o={logits:s===1?oe(i,[1,-1]):i},l={numSamples:t,seed:n,normalized:r},u=ne.runKernel(uv,o,l);return s===1?oe(u,[u.size]):u}var $ee=re({multinomial_:m3e});function g3e(e,t){let n=U(e,"a","notEqual","string_or_numeric"),r=U(t,"b","notEqual","string_or_numeric");[n,r]=xr(n,r),Vn(n.shape,r.shape);let i={a:n,b:r};return ne.runKernel(dv,i)}var lh=re({notEqual_:g3e});function y3e(e,t,n=1,r=0,i="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);let a={indices:U(e,"indices","oneHot","int32")},s={dtype:i,depth:t,onValue:n,offValue:r};return ne.runKernel(kf,a,s)}var ty=re({oneHot_:y3e});function v3e(e){let t={x:U(e,"x","onesLike")};return ne.runKernel(mv,t)}var ys=re({onesLike_:v3e});function b3e(e,t){let n=U(e,"v1","outerProduct"),r=U(t,"v2","outerProduct");Z(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);let i=oe(n,[-1,1]),a=oe(r,[1,-1]);return jt(i,a)}var Tee=re({outerProduct_:b3e});function w3e(e,t,n=0){let r=U(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let i={paddings:t,constantValue:n},a={x:r};return ne.runKernel(Sf,a,i)}var al=re({pad_:w3e});function x3e(e,t,n=0){return Z(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),al(e,[t],n)}var Nee=re({pad1d_:x3e});function _3e(e,t,n=0){return Z(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),al(e,t,n)}var Eee=re({pad2d_:_3e});function k3e(e,t,n=0){return Z(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),al(e,t,n)}var Oee=re({pad3d_:k3e});function S3e(e,t,n=0){return Z(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),al(e,t,n)}var Pee=re({pad4d_:S3e});function C3e(e,t,n){let r=U(e,"x","spaceToBatchND");Z(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),Z(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),Z(r.shape.reduce((s,o,l)=>l>0&&l<=t.length?s&&(o+n[l-1][0]+n[l-1][1])%t[l-1]===0:s,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);let i={x:r},a={blockShape:t,paddings:n};return ne.runKernel(Cv,i,a)}var Tw=re({spaceToBatchND_:C3e});function I3e(e,t,n,r,i,a,s){i==null&&(i=[1,1]),a==null&&(a=1),r===0&&(r="valid");let o=U(e,"x","maxPool"),l=o,u=!1;o.rank===3&&(u=!0,l=oe(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Z(Zl(a,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${i}'`);let c=oee(l.shape,t,a,i,r),d=[c.dilationHeight,c.dilationWidth],p;r==="same"?p=T3e([c.filterHeight,c.filterWidth],d):p=[[0,0],[0,0]];let h=d[0]===1&&d[1]===1,[m,g]=$3e([c.inHeight,c.inWidth],d,p),v=h?r:"valid",y=h?l:Tw(l,d,m),b=(n==="avg"?()=>Gu(y,t,a,v,s):()=>oi(y,t,a,v,s))(),_=h?b:ww(b,d,g);return u?oe(_,[_.shape[1],_.shape[2],_.shape[3]]):_}function $3e(e,t,n){let r=n.map(c=>c[0]),i=n.map(c=>c[1]),a=e.concat(r,i),s=t.map((c,d)=>(c-a[d]%c)%c),o=i.map((c,d)=>c+s[d]),l=t.map((c,d)=>[r[d],o[d]]),u=t.map((c,d)=>[0,s[d]]);return[l,u]}function T3e(e,t){let n=e.map((a,s)=>a+(a-1)*(t[s]-1)).map(a=>a-1),r=n.map(a=>Math.floor(a/2)),i=n.map((a,s)=>a-r[s]);return n.map((a,s)=>[r[s],i[s]])}var UD=re({pool_:I3e});function N3e(e,t){let n=U(e,"x","prelu"),r=U(t,"alpha","prelu"),i={x:n,alpha:r};return ne.runKernel(If,i)}var Nw=re({prelu_:N3e});function E3e(e,t=null,n=!1){let r=U(e,"x","prod");r.dtype==="bool"&&(r=Me(r,"int32"));let i={x:r},a={axis:t,keepDims:n};return ne.runKernel($f,i,a)}var HD=re({prod_:E3e});function O3e(e,t,n,r){let i=e.map((c,d)=>U(c,`tensors${d}`,"raggedGather","int32")),a=U(t,"paramsDenseValues","raggedGather"),s=U(n,"indices","raggedGather","int32"),o={paramsNestedSplits:i,paramsDenseValues:a,indices:s},l={outputRaggedRank:r},u=ne.runKernel(t$,o,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}var Aee=re({raggedGather_:O3e});function P3e(e,t,n){let r=U(e,"starts","raggedRange"),i=U(t,"limits","raggedRange",r.dtype),a=U(n,"deltas","raggedRange",r.dtype),s={starts:r,limits:i,deltas:a},o=ne.runKernel(n$,s);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}var Mee=re({raggedRange_:P3e});function A3e(e,t,n,r,i){let a=U(e,"shape","raggedTensorToTensor","int32"),s=U(t,"values","raggedTensorToTensor"),o=U(n,"defaultValue","raggedTensorToTensor",s.dtype),l=r.map((d,p)=>U(d,`tensors${p}`,"raggedTensorToTensor","int32")),u={shape:a,values:s,defaultValue:o,rowPartitionTensors:l},c={rowPartitionTypes:i};return ne.runKernel(r$,u,c)}var Ree=re({raggedTensorToTensor_:A3e});function M3e(e,t,n){xs(e);let r=Pn(e),i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else if(n==="bool")i=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let a=0;a<r;a++)i[a]=t();return ne.makeTensor(i,e,n)}var Dee=re({rand_:M3e}),GD=Td(V2()),Lee={};Dt(Lee,{TEST_EPSILON_FLOAT16:()=>Fee,createVideoElement:()=>V3e,encodeStrings:()=>zee,expectArrayBuffersEqual:()=>W3e,expectArraysClose:()=>D3e,expectArraysEqual:()=>F3e,expectNumbersClose:()=>z3e,expectPromiseToFail:()=>L3e,expectValuesInRange:()=>B3e,play:()=>j3e,testEpsilon:()=>qD});var R3e=.001,Fee=.1;function D3e(e,t,n){return n==null&&(n=qD()),_P(e,t,(r,i)=>KD(r,i,n))}function qD(){return ne.backend.floatPrecision()===32?R3e:Fee}function _P(e,t,n){let r=!0;if((pi(e)||pi(t))&&(r=!1),pi(e)&&pi(t)&&(r=!0),r){let s=e.constructor.name,o=t.constructor.name;if(s!==o)throw new Error(`Arrays are of different type. Actual: ${s}. Expected: ${o}`)}if(Array.isArray(e)&&Array.isArray(t)){let s=Vl(e),o=Vl(t);if(!Uu(s,o))throw new Error(`Arrays have different shapes. Actual: [${s}]. Expected: [${o}]`)}let i=pi(e)?e:sd(e),a=pi(t)?t:sd(t);if(i.length!==a.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${a.length}.
Actual:   ${i}.
Expected: ${a}.`);for(let s=0;s<a.length;++s){let o=i[s],l=a[s];if(!n(o,l))throw new Error(`Arrays differ: actual[${s}] = ${o}, expected[${s}] = ${l}.
Actual:   ${i}.
Expected: ${a}.`)}typeof expect<"u"&&expect().nothing()}function L3e(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function F3e(e,t){let n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Oc(e)||Oc(e[0])||Oc(t)||Oc(t[0])?_P(e,n,(r,i)=>r==i):_P(e,t,(r,i)=>KD(r,i,0))}function z3e(e,t,n){if(n==null&&(n=qD()),!KD(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function KD(e,t,n){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function B3e(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function W3e(e,t){let n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let i=0;i<r.length;i++)if(n[i]!==r[i])throw new Error(`Expected ArrayBuffer value at ${i} to be ${r[i]} but got ${n[i]} instead`)}function zee(e){for(let t=0;t<e.length;t++){let n=e[t];Array.isArray(n)?zee(n):e[t]=gw(n)}return e}function V3e(e){let t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(n=>{t.addEventListener("loadeddata",r=>n(t)),t.load()})}async function j3e(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}var ZD=class{constructor(e,t,n,r,i){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);let a=i||Math.random();this.random=GD.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){let r=this.nextVal;return this.nextVal=NaN,r}let e,t,n=!1;for(;!n;){let r,i,a;do r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i;while(a>=1||a===0);let s=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*r*s,t=this.mean+this.stdDev*i*s,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}},U3e=class{constructor(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;let i=r||Math.random();this.randu=GD.alea(i.toString()),this.randn=new ZD(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,r,i,a;for(;;){do r=this.randn.nextValue(),a=1+this.c*r;while(a<=0);if(a*=a*a,e=r*r,t=1-.331*e*e,n=.5*e+this.d*(1-a+Math.log(a)),i=this.randu(),i<t||Math.log(i)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}},H3e=class{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=n,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=GD.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};function G3e(e,t,n=1,r="float32",i){if(xs(e),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);let a=new U3e(t,n,r,i),s=Gt(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}var Bee=re({randomGamma_:G3e});function q3e(e,t=0,n=1,r,i){if(xs(e),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);let a=new ZD(t,n,r,!1,i),s=Gt(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}var b$=re({randomNormal_:q3e});function K3e(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return b$(e,0,1,t,n)}var Wee=re({randomStandardNormal_:K3e});function Z3e(e,t=0,n=1,r="float32",i){xs(e);let a=Gt(e,r),s=new H3e(t,n,null,i);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}var Rd=re({randomUniform_:Z3e});function X3e(e,t,n,r){return Rd(e,t,n,"int32",r)}var Vee=re({randomUniformInt_:X3e});function uh(e,t,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");let i={start:e,stop:t,step:n,dtype:r};return ne.runKernel(rw,{},i)}function J3e(e){let t={input:U(e,"input","real")};return ne.runKernel(i$,t)}var ny=re({real_:J3e});function Y3e(e){let t={x:U(e,"x","reciprocal")};return ne.runKernel(Tf,t)}var XD=re({reciprocal_:Y3e});function Q3e(e){let t={x:U(e,"x","relu")};return ne.runKernel(Nf,t)}var On=re({relu_:Q3e});function eBe(e){let t={x:U(e,"x","relu6")};return ne.runKernel(Pf,t)}var w$=re({relu6_:eBe});function tBe(e,t){let n={x:U(e,"x","reverse")},r={dims:t};return ne.runKernel(Af,n,r)}var zs=re({reverse_:tBe});function nBe(e){let t=U(e,"x","reverse");return Z(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),zs(t,0)}var jee=re({reverse1d_:nBe});function rBe(e,t){let n=U(e,"x","reverse");return Z(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),zs(n,t)}var Uee=re({reverse2d_:rBe});function iBe(e,t){let n=U(e,"x","reverse");return Z(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),zs(n,t)}var Hee=re({reverse3d_:iBe});function aBe(e,t){let n=U(e,"x","reverse");return Z(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),zs(n,t)}var Gee=re({reverse4d_:aBe});function sBe(e){let t={x:U(e,"x","round")};return ne.runKernel(Mf,t)}var x$=re({round_:sBe});function oBe(e){let t={x:U(e,"x","rsqrt","float32")};return ne.runKernel(Rf,t)}var _$=re({rsqrt_:oBe});function lBe(e){let t={x:U(e,"x","selu")};return ne.runKernel(Df,t)}var k$=re({selu_:lBe});function uBe(e,t,n,r,i,a=[1,1],s="NHWC"){let o=U(e,"x","separableConv2d"),l=U(t,"depthwiseFilter","separableConv2d"),u=U(n,"pointwiseFilter","separableConv2d"),c=o,d=!1;if(o.rank===3&&(d=!0,c=oe(o,[1,o.shape[0],o.shape[1],o.shape[2]])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Z(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),Z(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),Z(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),Z(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),Z(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);let p=l.shape[2],h=l.shape[3];Z(u.shape[2]===p*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*h}, but got ${u.shape[2]}.`);let m=Xf(c,l,r,i,s,a),g=ga(m,u,1,"valid",s);return d?oe(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var Bv=re({separableConv2d_:uBe});async function cBe(e,t){let n=U(e,"x","setdiff1d"),r=U(t,"y","setdiff1d");Z(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),Z(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),Z(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);let i=await n.data(),a=await r.data(),s=new Set(a),o=0;for(let c=0;c<i.length;c++)s.has(i[c])||o++;let l=new Br([o],n.dtype),u=new Br([o],"int32");for(let c=0,d=0;c<i.length;c++)s.has(i[c])||(l.values[d]=i[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}var qee=cBe;function dBe(e){let t={x:U(e,"x","sign")};return ne.runKernel(zf,t)}var JD=re({sign_:dBe});function pBe(e){let t={x:U(e,"x","sin","float32")};return ne.runKernel(Lf,t)}var S$=re({sin_:pBe});function hBe(e){let t={x:U(e,"x","sinh")};return ne.runKernel(Ff,t)}var C$=re({sinh_:hBe});function fBe(e,t,n){let r=U(e,"x","slice1d");return Z(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),nn(r,[t],[n])}var Ew=re({slice1d_:fBe});function mBe(e,t,n){let r=U(e,"x","slice2d");return Z(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),nn(r,t,n)}var I$=re({slice2d_:mBe});function gBe(e,t,n){let r=U(e,"x","slice3d");return Z(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),nn(r,t,n)}var Wv=re({slice3d_:gBe});function yBe(e,t,n){let r=U(e,"x","slice4d");return Z(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),nn(r,t,n)}var ry=re({slice4d_:yBe});function vBe(e,t=-1){let n=U(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);let r={logits:n},i={dim:t};return ne.runKernel(Uf,r,i)}var Dd=re({softmax_:vBe});function bBe(e){Z(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);let t={input:e};return ne.runKernel(Y2,t)}var Ow=re({fft_:bBe});function wBe(e){Z(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);let t={input:e};return ne.runKernel(Q2,t)}var iy=re({ifft_:wBe});function xBe(e){let t=e.shape[e.shape.length-1],n=e.size/t,r;if(t<=2){let i=oe(e,[n,t]);r=iy(i)}else{let i=[n,2*(t-1)],a=oe(ny(e),[n,t]),s=oe(_w(e),[n,t]),o=zs(nn(a,[0,1],[n,t-2]),1),l=ae(zs(nn(s,[0,1],[n,t-2]),1),yt(-1)),u=Wn([a,o],1),c=Wn([s,l],1),d=oe(Ru(u,c),[i[0],i[1]]);r=iy(d)}if(r=ny(r),e.rank===3&&e.shape[0]!==0){let i=r,a=e.shape[0];r=oe(r,[a,r.shape[0]/a,r.shape[1]]),i.dispose()}return r}var $$=re({irfft_:xBe});function _Be(e,t,n=0){let r={x:U(e,"x","split")},i={numOrSizeSplits:t,axis:n};return ne.runKernel(Iv,r,i)}var La=re({split_:_Be});function kBe(e,t){Z(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1],r=e.size/n,i;if(t!=null&&t<n){let m=e.shape.map(v=>0),g=e.shape.map(v=>v);g[e.shape.length-1]=t,i=nn(e,m,g),n=t}else if(t!=null&&t>n){let m=e.shape.map(g=>g);m[e.shape.length-1]=t-n,i=Wn([e,br(m)],e.shape.length-1),n=t}else i=e;let a=sn(i),s=oe(Ru(i,a),[r,n]),o=Ow(s),l=Math.floor(n/2)+1,u=ny(o),c=_w(o),d=La(u,[l,n-l],u.shape.length-1),p=La(c,[l,n-l],c.shape.length-1),h=i.shape.slice();return h[i.shape.length-1]=l,oe(Ru(d[0],p[0]),h)}var Pw=re({rfft_:kBe});function SBe(e,t){let n=U(e,"a","squaredDifference"),r=U(t,"b","squaredDifference");[n,r]=xr(n,r),Vn(n.shape,r.shape);let i={a:n,b:r},a={};return ne.runKernel(Hf,i,a)}var T$=re({squaredDifference_:SBe});function CBe(e,t){let n=U(e,"x","squeeze","string_or_numeric");return oe(n,wQ(n.shape,t).newShape)}var Ld=re({squeeze_:CBe});function IBe(e,t=0){let n=i1(e,"tensors","stack","string_or_numeric");Z(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&Z(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");let r=n,i={axis:t};return ne.runKernel(gv,r,i)}var Wr=re({stack_:IBe});function $Be(e,t=0){let n={x:U(e,"x","step")},r={alpha:t};return ne.runKernel(Pd,n,r)}var Yf=re({step_:$Be});function TBe(e,t,n,r,i=0,a=0,s=0,o=0,l=0){let u={x:U(e,"x","stridedSlice","string_or_numeric")},c={begin:t,end:n,strides:r,beginMask:i,endMask:a,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};return ne.runKernel(Nv,u,c)}var YD=re({stridedSlice_:TBe});function NBe(e){let t={x:U(e,"x","tan","float32")};return ne.runKernel(qf,t)}var QD=re({tan_:NBe});function Cn(e,t){Nh(e);let n=Vl(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ad(e,null,n,t)}function zl(e,t,n){if(Nh(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");let r=Vl(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ad(e,t,r,n)}function N$(e,t,n){if(Nh(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");let r=Vl(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ad(e,t,r,n)}function dd(e,t,n){if(Nh(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");let r=Vl(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ad(e,t,r,n)}function Kee(e,t,n){if(Nh(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");let r=Vl(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ad(e,t,r,n)}function Zee(e,t,n){if(Nh(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");let r=Vl(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,Ad(e,t,r,n)}var E$={};Dt(E$,{calculateShapes:()=>Xee,validateInput:()=>O$,validateUpdateShape:()=>eL});function eL(e,t,n){let r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(a+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw new Error(a+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw new Error(a+` update.rank != ${i+e.length-r}`);for(let s=0;s<i;++s)if(n.shape[s]!==t.shape[s])throw new Error(a+` updates.shape[${s}] (${n.shape[s]}) != indices.shape[${s}] (${t.shape[s]}).`);for(let s=0;s<n.rank-i;++s)if(n.shape[s+i]!==e[s+r])throw new Error(a+` updates.shape[${s+i}] (${n.shape[s+i]}) != shape[${s+i}] (${e[s+i]})`)}function O$(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}eL(n,t,e)}function Xee(e,t,n){let r=t.shape.length,i=r>1?t.shape[r-1]:1,a=n.length,s=1;for(let d=i;d<a;++d)s*=n[d];let o=i<1?1:i,l=Pn(t.shape)/o,u=[...Py(n.slice(0,i)),1],c=Pn(n);return{sliceRank:i,numUpdates:l,sliceSize:s,strides:u,outputSize:c}}function EBe(e,t,n){let r=U(e,"tensor","tensorScatterupdate"),i=U(t,"indices","tensorScatterupdate","int32"),a=U(n,"updates","tensorScatterupdate");if(O$(a,i,r.shape),r.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${a.dtype}.`);let s={tensor:r,indices:i,updates:a},o={};return ne.runKernel(xv,s,o)}var Jee=re({tensorScatterUpdate_:EBe});function OBe(e,t=1,n=!0){let r=U(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");let i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);let a={x:r},s={k:t,sorted:n},[o,l]=ne.runKernel(Ev,a,s);return{values:o,indices:l}}var tL=re({topk_:OBe});function PBe(e,t=0,n=1,r,i){if(xs(e),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");let a=new ZD(t,n,r,!0,i),s=Gt(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}var P$=re({truncatedNormal_:PBe});function ABe(e,t=0){let n=U(e,"x","unique","string_or_numeric");Z(n.rank>0,()=>"The input tensor must be at least 1D");let r={x:n},i={axis:t},[a,s]=ne.runKernel(pw,r,i);return{values:a,indices:s}}var nL=re({unique_:ABe});function MBe(e,t,n){let r=U(e,"x","unsortedSegmentSum"),i=U(t,"segmentIds","unsortedSegmentSum","int32");Z(Zg(n),()=>"numSegments must be of dtype int");let a={x:r,segmentIds:i},s={numSegments:n};return ne.runKernel(hw,a,s)}var A$=re({unsortedSegmentSum_:MBe});function RBe(e,t=0){let n=U(e,"x","unstack","string_or_numeric");Z(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);let r={value:n},i={axis:t};return ne.runKernel(Pv,r,i)}var Ir=re({unstack_:RBe});function Yee(e,t){return v$(e,t,"right")}function rL(e,t=!0,n,r){return ne.makeVariable(e,t,n,r)}function Qee(e,t){let n=[];for(let a=0;a<t.length;a++)t[a]&&n.push(a);let r=Gt(e,"int32"),i=Gt([n.length,e.length],"int32");for(let a=0;a<n.length;a++){let s=r.indexToLoc(n[a]),o=a*e.length;i.values.set(s,o)}return i.toTensor()}async function DBe(e){let t=U(e,"condition","whereAsync","bool"),n=await t.data(),r=Qee(t.shape,n);return e!==t&&t.dispose(),r}var iL=DBe;async function LBe(e,t,n){let r=U(e,"tensor","boolMask"),i=U(t,"mask","boolMask","bool"),a=n==null?0:n,s=i.rank,o=r.shape;Z(s>0,()=>"mask cannot be scalar"),_a(o.slice(a,a+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=a;g<a+s;g++)l*=o[g];let u=o.slice(0,a).concat([l],o.slice(a+s)),c=oe(r,u),d=oe(i,[-1]),p=await iL(d),h=Ld(p,[1]),m=zv(c,h,a);return e!==r&&r.dispose(),t!==i&&i.dispose(),h.dispose(),c.dispose(),d.dispose(),p.dispose(),m}var ete=LBe;function FBe(e,t,n){let r=U(e,"x","transpose");if(t==null&&(t=r.shape.map((s,o)=>o).reverse()),Z(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(s=>{Z(s>=0&&s<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();let i={x:r},a={perm:t};return r.dtype==="complex64"?le(()=>{let s=ny(r),o=_w(r);return s=ne.runKernel(ku,{x:s},a),o=ne.runKernel(ku,{x:o},a),n&&(o=Yn(o)),Ru(s,o)}):ne.runKernel(ku,i,a)}var Ut=re({transpose_:FBe});function zBe(e,t,n,r,i=!0){let a=U(e,"v","movingAverage"),s=U(t,"x","movingAverage"),o=U(n,"decay","movingAverage");BQ(a,s),Z(Uu(a.shape,s.shape),()=>"Shape mismatch in v and x");let l=yt(1),u=Ve(l,o),c=ae(Ve(s,a),u);if(i){Z(r!=null,()=>"When using zeroDebias: true, step is required.");let d=U(r,"step","movingAverage");c=et(c,Ve(l,Du(o,d)))}return we(a,c)}var tte=re({movingAverage_:zBe});function BBe(e,t,n){xs(n);let r=U(e,"indices","scatterND","int32"),i=U(t,"updates","scatterND");O$(i,r,n);let a={indices:r,updates:i},s={shape:n};return ne.runKernel(wv,a,s)}var nte=re({scatterND_:BBe});function WBe(e,t,n,r){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);let i=e.rank>0?e.shape[0]:1,a=e.rank>1?e.shape[1]:1;if(n.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${a}.`);let s=t.size;if(!(t.rank===0||t.rank===1&&s===i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}function VBe(e,t,n,r=0){xs(n);let i=U(e,"sparseIndices","sparseToDense","int32"),a=U(t,"sparseValues","sparseToDense","string_or_numeric"),s=U(r,"defaultValue","sparseToDense",a.dtype);WBe(i,a,n,s);let o={sparseIndices:i,sparseValues:a,defaultValue:s},l={outputShape:n};return ne.runKernel(Tv,o,l)}var rte=re({sparseToDense_:VBe});function jBe(e,t){let n=U(t,"indices","gatherND","int32"),r={params:U(e,"x","gatherND","string_or_numeric"),indices:n};return ne.runKernel(Qy,r)}var ite=re({gatherND_:jBe});function UBe(e,t){if(t==null)return e.shape.slice();if(Uu(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}function HBe(e,t,n,r){let i=U(e,"x","dropout");if(Z(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),Z(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof zt?i.clone():i;let a=UBe(i,n),s=1-t,o=et(Fv(we(Rd(a,0,1,"float32",r),s)),s);return ae(i,o)}var aL=re({dropout_:HBe});function sL(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function M$(e,t,n){let r=1-e%2,i=new Float32Array(e);for(let a=0;a<e;++a){let s=2*Math.PI*a/(e+r-1);i[a]=t-n*Math.cos(s)}return Cn(i,"float32")}async function GBe(e,t,n=1){let r=U(e,"predictions","inTopK"),i=U(t,"targets","inTopK");Z(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),Z(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),_a(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let a=r.shape[r.shape.length-1];Z(n>0&&n<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${n}`);let s=await r.data(),o=await i.data(),[l,u]=[s.length/a,a],c=xQ("bool",l);for(let d=0;d<l;d++){let p=d*u,h=s.subarray(p,p+u),m=[];for(let g=0;g<h.length;g++)m.push({value:h[g],index:g});m.sort((g,v)=>v.value-g.value),c[d]=0;for(let g=0;g<n;g++)if(m[g].index===o[d]){c[d]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),fa(c,i.shape,"bool")}var ate=GBe,ay={};Dt(ay,{conv2d:()=>ZBe,depthwiseConv2d:()=>QBe,matMul:()=>t4e});function qBe(e,t,n,r,i,a="NHWC",s){let o=e;e.rank===3&&(o=oe(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=oe(t,[1,t.shape[0],t.shape[1],t.shape[2]])),Z(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),Z(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),Z(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);let u=a==="NHWC"?o.shape[3]:o.shape[1],c=a==="NHWC"?l.shape[3]:l.shape[1];Z(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),Z(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),ka("conv2dDerFilter",i,s);let d={x:o,dy:l},p={strides:r,pad:i,dataFormat:a,dimRoundingMode:s,filterShape:n};return ne.runKernel(q2,d,p)}var oL=re({conv2DBackpropFilter_:qBe});function R$(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return ae(e,Yf(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function D$(e,t){let n=t,r=Vr(e.shape,t.shape);return r.length>0&&(n=lt(n,r)),oe(n,e.shape)}function L$(e,t,n,r){if(t==="linear")return e;if(t==="relu")return On(e);if(t==="elu")return Dv(e);if(t==="relu6")return w$(e);if(t==="prelu")return Nw(e,n);if(t==="leakyrelu")return kw(e,r);if(t==="sigmoid")return lo(e);throw new Error(`Unknown fused activation ${t}.`)}var F$=(e,t)=>!(e>0)||t==="linear";function KBe({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",F$(ne.state.gradientDepth,l)===!1){Z(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let $=ga(e,t,n,r,i,a,s);return o!=null&&($=we($,o)),L$($,l,u,c)}let d=U(e,"x","conv2d","float32"),p=U(t,"filter","conv2d","float32"),h=d,m=!1;d.rank===3&&(m=!0,h=oe(d,[1,d.shape[0],d.shape[1],d.shape[2]])),Z(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),Z(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),ka("fused conv2d",r,s);let g=i==="NHWC"?h.shape[3]:h.shape[1];Z(p.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${p.shape[2]}.`),Z(Zl(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);let v=bw(h.shape,p.shape,n,a,r,s),y;o!=null&&(y=U(o,"bias","fused conv2d"),[y]=xr(y,d),i==="NHWC"?Vn(v.outShape,y.shape):(Z(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),Z(y.shape.length===0||y.shape[0]===v.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let b;if(u!=null){let $=u.shape;if(Z($.length<=1||$.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${$.length}.`),$.length===1)Z($[0]===1||$[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${$}) is not compatible with the number of output channels (${v.outChannels}).`);else if($.length===3)try{Vn($,v.outShape)}catch{let A=`Error in fused conv2d: PReLU activation weights (${$}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(A)}b=U(u,"prelu weights","fused conv2d")}let _=($,N)=>{Z(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);let[A,D,O,F]=N,E=R$($,O,l);Z(ud(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);let z=kD(D.shape,E,A,n,r),q=oL(D,E,A.shape,n,r),H=[z,q];if(F!=null){let J=D$(F,E);H.push(J)}return H},k={x:h,filter:p,bias:y,preluActivationWeights:b},C={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s,activation:l,leakyreluAlpha:c};return o==null?jl(($,N,A)=>{let D=ne.runKernel(Yp,k,C);return A([N,$,D]),m&&(D=oe(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:_}})(h,p):jl(($,N,A,D)=>{let O=ne.runKernel(Yp,k,C);return D([N,$,O,A]),m&&(O=oe(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:_}})(h,p,y)}var ZBe=re({fusedConv2d_:KBe});function XBe(e,t,n,r,i,a=[1,1],s){let o=e;e.rank===3&&(o=oe(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=oe(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u={x:o,dy:l},c={strides:r,pad:i,dimRoundingMode:s,dilations:a,filterShape:n};return ne.runKernel(K2,u,c)}var ste=re({depthwiseConv2dNativeBackpropFilter_:XBe});function JBe(e,t,n,r,i,a=[1,1],s){let o=t,l=!1;t.rank===3&&(l=!0,o=oe(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u={dy:o,filter:n},c={strides:r,pad:i,dimRoundingMode:s,dilations:a,inputShape:e},d=ne.runKernel(Z2,u,c);return l?oe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var ote=re({depthwiseConv2dNativeBackpropInput_:JBe});function YBe({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(F$(ne.state.gradientDepth,l)===!1){let C=Xf(e,t,n,r,i,a,s);return o!=null&&(C=we(C,o)),L$(C,l,u,c)}let d=U(e,"x","depthwiseConv2d","float32"),p=U(t,"filter","depthwiseConv2d","float32"),h=d,m=!1;d.rank===3&&(m=!0,h=oe(d,[1,d.shape[0],d.shape[1],d.shape[2]])),Z(h.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),Z(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),Z(h.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),a==null&&(a=[1,1]),Z(Zl(n,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),ka("fused depthwiseConv2d",r,s);let g=bw(h.shape,p.shape,n,a,r,s,!0),v;o!=null&&(v=U(o,"bias","fused conv2d"),[v]=xr(v,d),Vn(g.outShape,v.shape));let y;u!=null&&(y=U(u,"prelu weights","fused depthwiseConv2d"));let b=(C,$)=>{Z(ud(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);let[N,A,D,O]=$,F=R$(C,D,l),E=ote(A.shape,F,N,n,r,a,s),z=ste(A,F,N.shape,n,r,a,s);if(O!=null){let q=D$(v,F);return[E,z,q]}return[E,z]},_={x:h,filter:p,bias:v,preluActivationWeights:y},k={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s,activation:l,leakyreluAlpha:c};return o==null?jl((C,$,N)=>{let A=ne.runKernel(Qp,_,k);return N([$,C,A]),m&&(A=oe(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:b}})(h,p):jl((C,$,N,A)=>{let D=ne.runKernel(Qp,_,k);return A([$,C,D,N]),m&&(D=oe(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:b}})(h,p,v)}var QBe=re({fusedDepthwiseConv2d_:YBe});function e4e({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:a="linear",preluActivationWeights:s,leakyreluAlpha:o=.2}){if(F$(ne.state.gradientDepth,a)===!1){let O=jt(e,t,n,r);return i!=null&&(O=we(O,i)),L$(O,a,s,o)}let l=U(e,"a","fused matMul"),u=U(t,"b","fused matMul");[l,u]=xr(l,u);let c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],h=r?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),g=u.shape.slice(0,-2),v=Pn(m),y=Pn(g);Z(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);let b=Vn(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,h]),_=n?oe(l,[v,c,p]):oe(l,[v,p,c]),k=r?oe(u,[y,h,d]):oe(u,[y,d,h]),C;i!=null&&(C=U(i,"bias","fused matMul"),[C]=xr(C,l),Vn(b,C.shape));let $;s!=null&&($=U(s,"prelu weights","fused matMul"));let N=(O,F)=>{let[E,z,q,H]=F,J=R$(oe(O,q.shape),q,a),ee,V;if(!n&&!r?(ee=jt(J,z,!1,!0),V=jt(E,J,!0,!1)):!n&&r?(ee=jt(J,z,!1,!1),V=jt(J,E,!0,!1)):n&&!r?(ee=jt(z,J,!1,!0),V=jt(E,J,!1,!1)):(ee=jt(z,J,!0,!0),V=jt(J,E,!0,!0)),i!=null){let Q=D$(H,J);return[ee,V,Q]}else return[ee,V]},A={a:_,b:k,bias:C,preluActivationWeights:$},D={transposeA:n,transposeB:r,activation:a,leakyreluAlpha:o};return i==null?jl((O,F,E)=>{let z=ne.runKernel(Jp,A,D);return E([O,F,z]),{value:oe(z,b),gradFunc:N}})(_,k):jl((O,F,E,z)=>{let q=ne.runKernel(Jp,A,D);return z([O,F,q,E]),{value:oe(q,b),gradFunc:N}})(_,k,C)}var t4e=re({fusedMatMul_:e4e});function n4e(e){return M$(e,.54,.46)}var r4e=re({hammingWindow_:n4e});function i4e(e){return M$(e,.5,.5)}var lte=re({hannWindow_:i4e});function a4e(e,t,n,r=!1,i=0){let a=0,s=[];for(;a+t<=e.size;)s.push(nn(e,a,t)),a+=n;if(r)for(;a<e.size;){let o=a+t-e.size,l=Wn([nn(e,a,t-o),ds([o],i)]);s.push(l),a+=n}return s.length===0?zl([],[0,t]):oe(Wn(s),[s.length,t])}var ute=re({frame_:a4e});function s4e(e,t,n,r,i=lte){r==null&&(r=sL(t));let a=ute(e,t,n),s=ae(a,i(t));return Pw(s,r)}var o4e=re({stft_:s4e});function l4e(e,t,n,r,i="bilinear",a=0){let s=U(e,"image","cropAndResize"),o=U(t,"boxes","cropAndResize","float32"),l=U(n,"boxInd","cropAndResize","int32"),u=o.shape[0];Z(s.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`),Z(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`),Z(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`),Z(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),Z(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),Z(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);let c={image:s,boxes:o,boxInd:l},d={method:i,extrapolationValue:a,cropSize:r};return ne.runKernel(Gy,c,d)}var u4e=re({cropAndResize_:l4e});function c4e(e){let t=U(e,"image","flipLeftRight","float32");Z(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);let n={image:t};return ne.runKernel(Jy,n,{})}var d4e=re({flipLeftRight_:c4e});function p4e(e){let t=U(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];Z(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),Z(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);let i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,ss(t,i)}var h4e=re({grayscaleToRGB_:p4e});function f4e(e){let t=U(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];Z(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),Z(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);let i=t.dtype,a=Me(t,"float32"),s=Cn([.2989,.587,.114]),o;switch(t.rank){case 2:o=hp("ij,j->i",a,s);break;case 3:o=hp("ijk,k->ij",a,s);break;case 4:o=hp("ijkl,l->ijk",a,s);break;case 5:o=hp("ijklm,m->ijkl",a,s);break;case 6:o=hp("ijklmn,n->ijklm",a,s);break;default:throw new Error("Not a valid tensor rank.")}return o=hi(o,-1),Me(o,i)}var m4e=re({rgbToGrayscale_:f4e});function g4e(e,t,n=0,r=.5){let i=U(e,"image","rotateWithOffset","float32");Z(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);let a={image:i},s={radians:t,fillValue:n,center:r};return ne.runKernel(Mv,a,s)}var y4e=re({rotateWithOffset_:g4e});function Vv(e,t,n,r,i,a){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),a==null&&(a=0);let s=e.shape[0];return n=Math.min(n,s),Z(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),Z(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),Z(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),Z(t.rank===1,()=>"scores must be a 1D tensor"),Z(t.shape[0]===s,()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${t.shape[0]}`),Z(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}function v4e(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){let a=U(e,"boxes","nonMaxSuppression","float32"),s=U(t,"scores","nonMaxSuppression","float32"),o=Vv(a,s,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;let l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return ne.runKernel(pv,{boxes:a,scores:s},l)}var b4e=re({nonMaxSuppression_:v4e});function w4e(e,t,n){let r=x4e(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function x4e(e,t,n){return k4e(e,t,n||_4e)}function _4e(e,t){return e>t?1:e<t?-1:0}function k4e(e,t,n){let r=0,i=e.length,a=0,s=!1;for(;r<i;){a=r+(i-r>>>1);let o=n(t,e[a]);o>0?r=a+1:(i=a,s=!o)}return s?r:-r-1}function cte(e,t,n,r,i){return lL(e,t,n,r,i,0)}function dte(e,t,n,r,i,a){return lL(e,t,n,r,i,0,!1,a,!0)}function pte(e,t,n,r,i,a){return lL(e,t,n,r,i,a,!0)}function lL(e,t,n,r,i,a,s=!1,o=!1,l=!1){let u=[];for(let v=0;v<t.length;v++)t[v]>i&&u.push({score:t[v],boxIndex:v,suppressBeginIndex:0});u.sort(tU);let c=a>0?-.5/a:0,d=[],p=[];for(;d.length<n&&u.length>0;){let v=u.pop(),{score:y,boxIndex:b,suppressBeginIndex:_}=v;if(y<i)break;let k=!1;for(let C=d.length-1;C>=_;--C){let $=S4e(e,b,d[C]);if($>=r){k=!0;break}if(v.score=v.score*C4e(r,c,$),v.score<=i)break}v.suppressBeginIndex=d.length,k||(v.score===y?(d.push(b),p.push(v.score)):v.score>i&&w4e(u,v,tU))}let h=d.length,m=n-h;o&&m>0&&(d.push(...new Array(m).fill(0)),p.push(...new Array(m).fill(0)));let g={selectedIndices:d};return s&&(g.selectedScores=p),l&&(g.validOutputs=h),g}function S4e(e,t,n){let r=e.subarray(t*4,t*4+4),i=e.subarray(n*4,n*4+4),a=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),h=(o-a)*(l-s),m=(d-u)*(p-c);if(h<=0||m<=0)return 0;let g=Math.max(a,u),v=Math.max(s,c),y=Math.min(o,d),b=Math.min(l,p),_=Math.max(y-g,0)*Math.max(b-v,0);return _/(h+m-_)}function C4e(e,t,n){let r=Math.exp(t*n*n);return n<=e?r:0}function tU(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}async function I4e(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){let a=U(e,"boxes","nonMaxSuppressionAsync"),s=U(t,"scores","nonMaxSuppressionAsync"),o=Vv(a,s,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;let l=await Promise.all([a.data(),s.data()]),u=l[0],c=l[1],{selectedIndices:d}=cte(u,c,n,r,i);return a!==e&&a.dispose(),s!==t&&s.dispose(),Cn(d,"int32")}var $4e=I4e;function T4e(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){let s=U(e,"boxes","nonMaxSuppression"),o=U(t,"scores","nonMaxSuppression"),l=Vv(s,o,n,r,i,a);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;let u={boxes:s,scores:o},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a},d=ne.runKernel(fv,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}var N4e=re({nonMaxSuppressionWithScore_:T4e});async function E4e(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){let s=U(e,"boxes","nonMaxSuppressionAsync"),o=U(t,"scores","nonMaxSuppressionAsync"),l=Vv(s,o,n,r,i,a);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;let u=await Promise.all([s.data(),o.data()]),c=u[0],d=u[1],{selectedIndices:p,selectedScores:h}=pte(c,d,n,r,i,a);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:Cn(p,"int32"),selectedScores:Cn(h)}}var O4e=E4e;function P4e(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){let s=U(e,"boxes","nonMaxSuppression"),o=U(t,"scores","nonMaxSuppression"),l=Vv(s,o,n,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,p={boxes:s,scores:o},h={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:a},m=ne.runKernel(hv,p,h);return{selectedIndices:m[0],validOutputs:m[1]}}var A4e=re({nonMaxSuppressionPadded_:P4e});async function M4e(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){let s=U(e,"boxes","nonMaxSuppressionAsync"),o=U(t,"scores","nonMaxSuppressionAsync"),l=Vv(s,o,n,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[p,h]=await Promise.all([s.data(),o.data()]),{selectedIndices:m,validOutputs:g}=dte(p,h,u,c,d,a);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:Cn(m,"int32"),validOutputs:yt(g,"int32")}}var R4e=M4e;function D4e(e,t,n=!1,r=!1){let i=U(e,"images","resizeBilinear");Z(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),Z(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),Z(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=i,s=!1;i.rank===3&&(s=!0,a=oe(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let o={images:a},l={alignCorners:n,halfPixelCenters:r,size:t},u=ne.runKernel(Of,o,l);return s?oe(u,[u.shape[1],u.shape[2],u.shape[3]]):u}var hte=re({resizeBilinear_:D4e});function L4e(e,t,n=!1,r=!1){let i=U(e,"images","resizeNearestNeighbor");Z(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),Z(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),Z(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),Z(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=i,s=!1;i.rank===3&&(s=!0,a=oe(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let o={images:a},l={alignCorners:n,halfPixelCenters:r,size:t},u=ne.runKernel(Ef,o,l);return s?oe(u,[u.shape[1],u.shape[2],u.shape[3]]):u}var fte=re({resizeNearestNeighbor_:L4e});function F4e(e,t="binary",n=!1,r=.5){let i=U(e,"image","threshold"),a=.2989,s=.587,o=.114,l=i.shape[0]*i.shape[1],u=ae(Cn([r]),255),c,d,p,h;if(Z(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),Z(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),Z(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),Z(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),i.shape[2]===3){[c,d,p]=La(i,[1,1,1],-1);let g=ae(c,a),v=ae(d,s),y=ae(p,o);h=we(we(g,v),y)}else h=e;if(t==="otsu"){let g=yD(Me(x$(h),"int32"),fa([]),256);u=z4e(g,l)}let m=n?Md(h,u):Sa(h,u);return Me(ae(m,255),"int32")}function z4e(e,t){let n=Cn([-1]),r=Cn([0]),i=Cn([0]),a,s,o,l,u,c;for(let d=0;d<e.size-1;d++){a=nn(e,0,d+1),s=nn(e,d+1),u=et(lt(a),t),c=et(lt(s),t);let p=lt(ae(a,uh(0,a.size)));o=et(p,lt(a));let h=ds(s.shape,a.size),m=we(uh(0,s.size),h),g=ae(s,m);l=et(lt(g),lt(s));let v=Ve(o,l),y=Ve(o,l),b=ae(u,c);i=ae(ae(b,v),y);let _=Sa(i,r);r=yi(_,i,r),n=yi(_,Cn([d]),n)}return n}var B4e=re({threshold_:F4e});function W4e(e,t,n="nearest",r="constant",i=0,a){let s=U(e,"image","transform","float32"),o=U(t,"transforms","transform","float32");Z(s.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`),Z(o.rank===2&&(o.shape[0]===s.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),Z(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);let l={image:s,transforms:o},u={interpolation:n,fillMode:r,fillValue:i,outputShape:a};return ne.runKernel(Ov,l,u)}var V4e=re({transform_:W4e});function j4e(e,t,n){let r=U(e,"a","bandPart");Z(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);let i=r.shape,[a,s]=r.shape.slice(-2),o,l;typeof t=="number"?(Z(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),Z(t<=a,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${a}).`),o=U(t<0?a:t,"numLower","bandPart")):(Z(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=yi(ey(t,0),a,cd(t,a))),typeof n=="number"?(Z(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),Z(n<=s,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${s}).`),l=U(n<0?s:n,"numUpper","bandPart")):(Z(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=yi(ey(n,0),s,cd(n,s)));let u=oe(uh(0,a,1,"int32"),[-1,1]),c=uh(0,s,1,"int32"),d=Ve(u,c),p=ho(Md(d,o),qu(d,Yn(l))),h=br([a,s],r.dtype);return oe(Wr(Ir(oe(r,[-1,a,s])).map(m=>yi(p,m,h))),i)}var U4e=re({bandPart_:j4e});function H4e(e){let t;if(Array.isArray(e)){t=!1,Z(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let i=e[0].shape[0];for(let a=1;a<e.length;++a)Z(e[a].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[a].shape[0]} vs. ${i})`)}else t=!0,e=La(e,e.shape[0],0).map(i=>Ld(i,[0]));Z(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);let n=[],r=e;for(let i=0;i<e.length;++i)n.push(ne.tidy(()=>{let a=r[i];if(i>0)for(let s=0;s<i;++s){let o=ae(lt(ae(n[s],a)),n[s]);a=Ve(a,o)}return et(a,Lv(a,"euclidean"))}));return t?Wr(n,0):n}var G4e=re({gramSchmidt_:H4e});function q4e(e,t=!1){if(Z(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return nU(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((l,u)=>l*u),r=Ir(oe(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],a=[];r.forEach(l=>{let[u,c]=nU(l,t);i.push(u),a.push(c)});let s=oe(Wr(i,0),e.shape),o=oe(Wr(a,0),e.shape);return[s,o]}}function nU(e,t=!1){return ne.tidy(()=>{Z(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);let n=e.shape[0],r=e.shape[1],i=f$(n),a=Fl(e),s=zl([[1]],[1,1]),o=Fl(s),l=n>=r?r:n;for(let u=0;u<l;++u){let c=a,d=o,p=i;[o,a,i]=ne.tidy(()=>{let h=nn(a,[u,u],[n-u,1]),m=Lv(h),g=nn(a,[u,u],[1,1]),v=yi(Sa(g,0),zl([[-1]]),zl([[1]])),y=Ve(g,ae(v,m)),b=et(h,y);b.shape[0]===1?o=Fl(s):o=Wn([s,nn(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);let _=Yn(et(jt(v,y),m)),k=nn(a,[u,0],[n-u,r]),C=ae(_,o),$=Ut(o);if(u===0)a=Ve(k,jt(C,jt($,k)));else{let D=Ve(k,jt(C,jt($,k)));a=Wn([nn(a,[0,0],[u,r]),D],0)}let N=Ut(C),A=nn(i,[0,u],[n,i.shape[1]-u]);if(u===0)i=Ve(A,jt(jt(A,o),N));else{let D=Ve(A,jt(jt(A,o),N));i=Wn([nn(i,[0,0],[n,u]),D],1)}return[o,a,i]}),Rt([c,d,p])}return!t&&n>r&&(i=nn(i,[0,0],[n,r]),a=nn(a,[0,0],[r,r])),[i,a]})}var K4e=re({qr_:q4e}),pa;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(pa||(pa={}));function Z4e(e,t,n=pa.SUM_BY_NONZERO_WEIGHTS){let r=U(e,"losses","computeWeightedLoss"),i=null;t!=null&&(i=U(t,"weights","computeWeightedLoss"));let a=i==null?r:ae(r,i);if(n===pa.NONE)return a;if(n===pa.SUM)return lt(a);if(n===pa.MEAN){if(i==null)return vr(a);{let s=r.size/i.size,o=et(lt(a),lt(i));return s>1?et(o,yt(s)):o}}if(n===pa.SUM_BY_NONZERO_WEIGHTS){if(i==null)return et(lt(a),yt(r.size));{let s=ae(i,Aa(r.shape)),o=Me(lt(lh(s,yt(0))),"float32");return et(lt(a),o)}}throw Error(`Unknown reduction: ${n}`)}var Ku=re({computeWeightedLoss_:Z4e});function X4e(e,t,n,r=pa.SUM_BY_NONZERO_WEIGHTS){let i=U(e,"labels","absoluteDifference"),a=U(t,"predictions","absoluteDifference"),s=null;n!=null&&(s=U(n,"weights","absoluteDifference")),_a(i.shape,a.shape,"Error in absoluteDifference: ");let o=Dr(Ve(i,a));return Ku(o,s,r)}var J4e=re({absoluteDifference_:X4e});function Y4e(e,t,n,r,i=pa.SUM_BY_NONZERO_WEIGHTS){let a=U(e,"labels","cosineDistance"),s=U(t,"predictions","cosineDistance"),o=null;r!=null&&(o=U(r,"weights","cosineDistance")),_a(a.shape,s.shape,"Error in cosineDistance: ");let l=yt(1),u=Ve(l,lt(ae(a,s),n,!0));return Ku(u,o,i)}var Q4e=re({cosineDistance_:Y4e});function e5e(e,t,n,r=pa.SUM_BY_NONZERO_WEIGHTS){let i=U(e,"labels","hingeLoss"),a=U(t,"predictions","hingeLoss"),s=null;n!=null&&(s=U(n,"weights","hingeLoss")),_a(i.shape,a.shape,"Error in hingeLoss: ");let o=yt(1);i=Ve(ae(yt(2),i),o);let l=On(Ve(o,ae(i,a)));return Ku(l,s,r)}var t5e=re({hingeLoss_:e5e});function n5e(e,t,n,r=1,i=pa.SUM_BY_NONZERO_WEIGHTS){let a=U(e,"labels","huberLoss"),s=U(t,"predictions","huberLoss"),o=null;n!=null&&(o=U(n,"weights","huberLoss")),_a(a.shape,s.shape,"Error in huberLoss: ");let l=yt(r),u=Dr(Ve(s,a)),c=cd(u,l),d=Ve(u,c),p=we(ae(yt(.5),zn(c)),ae(l,d));return Ku(p,o,i)}var r5e=re({huberLoss_:n5e});function i5e(e,t,n,r=1e-7,i=pa.SUM_BY_NONZERO_WEIGHTS){let a=U(e,"labels","logLoss"),s=U(t,"predictions","logLoss"),o=null;n!=null&&(o=U(n,"weights","logLoss")),_a(a.shape,s.shape,"Error in logLoss: ");let l=yt(1),u=yt(r),c=Yn(ae(a,gs(we(s,u)))),d=ae(Ve(l,a),gs(we(Ve(l,s),u))),p=Ve(c,d);return Ku(p,o,i)}var a5e=re({logLoss_:i5e});function s5e(e,t,n,r=pa.SUM_BY_NONZERO_WEIGHTS){let i=U(e,"labels","meanSquaredError"),a=U(t,"predictions","meanSquaredError"),s=null;n!=null&&(s=U(n,"weights","meanSquaredError")),_a(i.shape,a.shape,"Error in meanSquaredError: ");let o=T$(i,a);return Ku(o,s,r)}var o5e=re({meanSquaredError_:s5e});function l5e(e,t){let n=U(e,"labels","sigmoidCrossEntropyWithLogits"),r=U(t,"logits","sigmoidCrossEntropyWithLogits");_a(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");let i=On(r),a=ae(r,n),s=Sw(Qi(Yn(Dr(r))));return we(Ve(i,a),s)}function u5e(e,t,n,r=0,i=pa.SUM_BY_NONZERO_WEIGHTS){let a=U(e,"multiClassLabels","sigmoidCrossEntropy"),s=U(t,"logits","sigmoidCrossEntropy"),o=null;if(n!=null&&(o=U(n,"weights","sigmoidCrossEntropy")),_a(a.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){let u=yt(r),c=yt(1),d=yt(.5);a=we(ae(a,Ve(c,u)),ae(d,u))}let l=l5e(a,s);return Ku(l,o,i)}var c5e=re({sigmoidCrossEntropy_:u5e});function d5e(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return jl((r,i,a)=>{let s=Cw(i,[n],!0),o=Ve(Me(i,"float32"),s);a([r,o]);let l=Yn(ae(o,r));return{value:lt(l,[n]),gradFunc:(u,c)=>{let[d,p]=c,h=oh(u.shape,[n]);return[ae(oe(u,h),Ve(Me(d,"float32"),Qi(p))),ae(oe(u,h),Ve(Qi(p),Me(d,"float32")))]}}})(e,t)}function p5e(e,t,n,r=0,i=pa.SUM_BY_NONZERO_WEIGHTS){let a=U(e,"onehotLabels","softmaxCrossEntropy"),s=U(t,"logits","softmaxCrossEntropy"),o=null;if(n!=null&&(o=U(n,"weights","softmaxCrossEntropy")),_a(a.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){let u=yt(r),c=yt(1),d=yt(a.shape[1]);a=we(ae(a,Ve(c,u)),et(u,d))}let l=d5e(a,s);return Ku(l,o,i)}var h5e=re({softmaxCrossEntropy_:p5e});function f5e(e,t,n,r){let i=U(e,"indices","sparseFillEmptyRows","int32"),a=U(t,"values","sparseFillEmptyRows"),s=U(n,"denseShape","sparseFillEmptyRows","int32"),o=U(r,"defaultValue","sparseFillEmptyRows",a.dtype);if(i.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(a.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(s.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${s.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);let l={indices:i,values:a,denseShape:s,defaultValue:o},u=ne.runKernel(iw,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}var m5e=re({sparseFillEmptyRows_:f5e});function g5e(e,t,n){let r=U(e,"inputIndices","sparseReshape","int32"),i=U(t,"inputShape","sparseReshape","int32"),a=U(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);let s={inputIndices:r,inputShape:i,newShape:a},o=ne.runKernel($v,s);return{outputIndices:o[0],outputShape:o[1]}}var y5e=re({sparseReshape_:g5e});function v5e(e,t,n){let r=U(e,"data","sparseSegmentMean"),i=U(t,"indices","sparseSegmentMean","int32"),a=U(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);let s={data:r,indices:i,segmentIds:a};return ne.runKernel(aw,s)}var b5e=re({sparseSegmentMean_:v5e});function w5e(e,t,n){let r=U(e,"data","sparseSegmentSum"),i=U(t,"indices","sparseSegmentSum","int32"),a=U(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);let s={data:r,indices:i,segmentIds:a};return ne.runKernel(sw,s)}var x5e=re({sparseSegmentSum_:w5e});function _5e(e,t,n,r,i,a,s,o){let l=U(e,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);let u=U(t,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");let c={separator:n,nGramWidths:r,leftPad:i,rightPad:a,padWidth:s,preserveShortSequences:o},d={data:l,dataSplits:u},p=ne.runKernel(uw,d,c);return{nGrams:p[0],nGramsSplits:p[1]}}var k5e=re({stringNGrams_:_5e});function S5e(e,t,n=!0){let r=U(e,"input","stringSplit","string"),i=U(t,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(i.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);let a={skipEmpty:n},s={input:r,delimiter:i},o=ne.runKernel(cw,s,a);return{indices:o[0],values:o[1],shape:o[2]}}var C5e=re({stringSplit_:S5e});function I5e(e,t){let n=U(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");let i={input:n};return ne.runKernel(dw,i,r)}var $5e=re({stringToHashBucketFast_:I5e});function T5e(e,t,n,r=!0){let i=U(e,"input","staticRegexReplace","string"),a={pattern:t,rewrite:n,replaceGlobal:r};return ne.runKernel(lw,{x:i},a)}var N5e=re({staticRegexReplace_:T5e}),mte={fft:Ow,ifft:iy,rfft:Pw,irfft:$$},gte={hammingWindow:r4e,hannWindow:lte,frame:ute,stft:o4e},$s={flipLeftRight:d4e,grayscaleToRGB:h4e,resizeNearestNeighbor:fte,resizeBilinear:hte,rgbToGrayscale:m4e,rotateWithOffset:y4e,cropAndResize:u4e,nonMaxSuppression:b4e,nonMaxSuppressionAsync:$4e,nonMaxSuppressionWithScore:N4e,nonMaxSuppressionWithScoreAsync:O4e,nonMaxSuppressionPadded:A4e,nonMaxSuppressionPaddedAsync:R4e,threshold:B4e,transform:V4e},uL={bandPart:U4e,gramSchmidt:G4e,qr:K4e},yte={absoluteDifference:J4e,computeWeightedLoss:Ku,cosineDistance:Q4e,hingeLoss:t5e,huberLoss:r5e,logLoss:a5e,meanSquaredError:o5e,sigmoidCrossEntropy:c5e,softmaxCrossEntropy:h5e},vte={sparseFillEmptyRows:m5e,sparseReshape:y5e,sparseSegmentMean:b5e,sparseSegmentSum:x5e},bte={stringNGrams:k5e,stringSplit:C5e,stringToHashBucketFast:$5e,staticRegexReplace:N5e},$e={};Dt($e,{Serializable:()=>wte,SerializationMap:()=>xte,getRegisteredName:()=>O5e,registerClass:()=>_te});var E5e=new Map,kP=new Map,wte=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},xte=class Hm{constructor(){this.classNameMap={}}static getMap(){return Hm.instance==null&&(Hm.instance=new Hm),Hm.instance}static register(t){Hm.getMap().classNameMap[t.className]=[t,t.fromConfig]}};function _te(e,t,n){Z(e.className!=null,()=>"Class being registered does not have the static className property defined."),Z(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),Z(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);let r=n,i=t+">"+r;return xte.register(e),E5e.set(i,e),kP.set(e,i),e}function O5e(e){return kP.has(e)?kP.get(e):e.className}var Zu=class extends wte{minimize(e,t=!1,n){let{value:r,grads:i}=this.computeGradients(e,n);if(n!=null){let a=n.map(s=>({name:s.name,tensor:i[s.name]}));this.applyGradients(a)}else this.applyGradients(i);return Rt(i),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return _ee(e,t)}dispose(){this.iterations_!=null&&Rt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:yt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty(Zu,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});var cL=class extends Zu{static get className(){return"Adadelta"}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],n==null&&(this.epsilon=ne.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=ne.registeredVariables[t],i=!1;this.accumulatedGrads[n]==null&&(this.accumulatedGrads[n]={originalName:`${t}/accum_grad`,variable:le(()=>sn(r).variable(i))}),this.accumulatedUpdates[n]==null&&(this.accumulatedUpdates[n]={originalName:`${t}/accum_var`,variable:le(()=>sn(r).variable(i))});let a=Array.isArray(e)?e[n].tensor:e[t];if(a==null)return;let s=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;le(()=>{let l=we(ae(s,this.rho),ae(zn(a),1-this.rho)),u=ae(et(Ai(we(o,this.epsilon)),Ai(we(s,this.epsilon))),a),c=we(ae(o,this.rho),ae(zn(u),1-this.rho));s.assign(l),o.assign(c);let d=we(ae(u,-this.learningRate),r);r.assign(d)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Rt(this.accumulatedGrads.map(e=>e.variable)),Rt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=e.length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}},dL=class extends Zu{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=ne.registeredVariables[t];this.accumulatedGrads[n]==null&&(this.accumulatedGrads[n]={originalName:`${t}/accumulator`,variable:le(()=>ds(r.shape,this.initialAccumulatorValue).variable(!1))});let i=Array.isArray(e)?e[n].tensor:e[t];if(i==null)return;let a=this.accumulatedGrads[n].variable;le(()=>{let s=we(a,zn(i));a.assign(s);let o=we(ae(et(i,Ai(we(s,ne.backend.epsilon()))),-this.learningRate),r);r.assign(o)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Rt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=!1;this.accumulatedGrads=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}},pL=class extends Zu{static get className(){return"Adam"}constructor(e,t,n,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],le(()=>{this.accBeta1=yt(t).variable(),this.accBeta2=yt(n).variable()}),r==null&&(this.epsilon=ne.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);le(()=>{let n=Ve(1,this.accBeta1),r=Ve(1,this.accBeta2);t.forEach((i,a)=>{let s=ne.registeredVariables[i],o=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:le(()=>sn(s).variable(o))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${i}/v`,variable:le(()=>sn(s).variable(o))});let l=Array.isArray(e)?e[a].tensor:e[i];if(l==null)return;let u=this.accumulatedFirstMoment[a].variable,c=this.accumulatedSecondMoment[a].variable,d=we(ae(u,this.beta1),ae(l,1-this.beta1)),p=we(ae(c,this.beta2),ae(zn(l),1-this.beta2)),h=et(d,n),m=et(p,r);u.assign(d),c.assign(p);let g=we(ae(et(h,we(Ai(m),this.epsilon)),-this.learningRate),s);s.assign(g)}),this.accBeta1.assign(ae(this.accBeta1,this.beta1)),this.accBeta2.assign(ae(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Rt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Rt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),le(()=>{this.accBeta1.assign(Du(this.beta1,this.iterations_+1)),this.accBeta2.assign(Du(this.beta2,this.iterations_+1))});let t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}},hL=class extends Zu{static get className(){return"Adamax"}constructor(e,t,n,r=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],le(()=>{this.iteration=yt(0).variable(),this.accBeta1=yt(t).variable()}),r==null&&(this.epsilon=ne.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);le(()=>{let n=Ve(1,this.accBeta1),r=et(-this.learningRate,we(ae(this.iteration,this.decay),1));t.forEach((i,a)=>{let s=ne.registeredVariables[i],o=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:sn(s).variable(o)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${i}/v`,variable:sn(s).variable(o)});let l=Array.isArray(e)?e[a].tensor:e[i];if(l==null)return;let u=this.accumulatedFirstMoment[a].variable,c=this.accumulatedWeightedInfNorm[a].variable,d=we(ae(u,this.beta1),ae(l,1-this.beta1)),p=ae(c,this.beta2),h=Dr(l),m=Xl(p,h);u.assign(d),c.assign(m);let g=we(ae(et(r,n),et(d,we(m,this.epsilon))),s);s.assign(g)}),this.iteration.assign(we(this.iteration,1)),this.accBeta1.assign(ae(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Rt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Rt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}},z$=class extends Zu{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=Array.isArray(e)?e[n].tensor:e[t];if(r==null)return;let i=ne.registeredVariables[t];le(()=>{let a=we(ae(this.c,r),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Jr(yt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}},fL=class extends z${static get className(){return"Momentum"}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=yt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=ne.registeredVariables[t];this.accumulations[n]==null&&(this.accumulations[n]={originalName:`${t}/momentum`,variable:le(()=>sn(r).variable(!1))});let i=this.accumulations[n].variable,a=Array.isArray(e)?e[n].tensor:e[t];a!=null&&le(()=>{let s,o=we(ae(this.m,i),a);this.useNesterov?s=we(ae(this.c,we(a,ae(o,this.m))),r):s=we(ae(this.c,o),r),i.assign(o),r.assign(s)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Rt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=!1;this.accumulations=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}},mL=class extends Zu{static get className(){return"RMSProp"}constructor(e,t=.9,n=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=ne.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=ne.registeredVariables[t],i=!1;this.accumulatedMeanSquares[n]==null&&(this.accumulatedMeanSquares[n]={originalName:`${t}/rms`,variable:le(()=>sn(r).variable(i))}),this.accumulatedMoments[n]==null&&(this.accumulatedMoments[n]={originalName:`${t}/momentum`,variable:le(()=>sn(r).variable(i))}),this.accumulatedMeanGrads[n]==null&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${t}/mg`,variable:le(()=>sn(r).variable(i))});let a=Array.isArray(e)?e[n].tensor:e[t];if(a==null)return;let s=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;le(()=>{let l=we(ae(s,this.decay),ae(zn(a),1-this.decay));if(this.centered){let u=this.accumulatedMeanGrads[n].variable,c=we(ae(u,this.decay),ae(a,1-this.decay)),d=et(ae(a,this.learningRate),Ai(Ve(l,we(zn(c),this.epsilon)))),p=we(ae(o,this.momentum),d);s.assign(l),u.assign(c),o.assign(p);let h=Ve(r,p);r.assign(h)}else{let u=we(ae(s,this.decay),ae(zn(a),1-this.decay)),c=we(ae(o,this.momentum),et(ae(a,this.learningRate),Ai(we(u,this.epsilon))));s.assign(u),o.assign(c);let d=Ve(r,c);r.assign(d)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Rt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Rt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Rt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}},P5e=[cL,dL,pL,hL,fL,mL,z$];function A5e(){for(let e of P5e)_te(e)}var Ti={};Dt(Ti,{CompositeArrayBuffer:()=>Hu,browserFiles:()=>B5e,browserHTTPRequest:()=>G5e,concatenateArrayBuffers:()=>wLe,copyModel:()=>VLe,decodeWeights:()=>KQ,decodeWeightsStream:()=>XQ,encodeWeights:()=>fLe,fromMemory:()=>K5e,fromMemorySync:()=>$te,getLoadHandlers:()=>TLe,getModelArtifactsForJSON:()=>nD,getModelArtifactsForJSONSync:()=>YQ,getModelArtifactsInfoForJSON:()=>vw,getSaveHandlers:()=>$Le,getWeightSpecs:()=>yP,http:()=>yL,isHTTPScheme:()=>CP,listModels:()=>BLe,loadWeights:()=>V5e,moveModel:()=>jLe,registerLoadRouter:()=>ILe,registerSaveRouter:()=>CLe,removeModel:()=>WLe,weightsLoaderFactory:()=>Ste,withSaveHandler:()=>Z5e,withSaveHandlerSync:()=>X5e});var M5e="model",R5e=".json",D5e=".weights.bin";function rU(e){return new Promise(t=>setTimeout(t)).then(e)}var ZC=class SP{constructor(t){if(!he().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(SP.URL_SCHEME)&&(t=t.slice(SP.URL_SCHEME.length)),(t==null||t.length===0)&&(t=M5e),this.modelJsonFileName=t+R5e,this.weightDataFileName=t+D5e}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let n=Hu.join(t.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let i=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a=JQ(t,i),s=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=s,await rU(()=>o.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){let l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await rU(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:vw(t)}}}};ZC.URL_SCHEME="downloads://";var L5e=class{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{let n=new FileReader;n.onload=r=>{let i=JSON.parse(r.target.result),a=i.modelTopology;if(a==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:a});return}let s=nD(i,o=>this.loadWeights(o));e(s)},n.onerror=r=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)})}loadWeights(e){let t=[],n=[];for(let a of e)t.push(...a.weights),n.push(...a.paths);let r=this.checkManifestAndWeightFiles(e),i=n.map(a=>this.loadWeightsFile(a,r[a]));return Promise.all(i).then(a=>[t,a])}loadWeightsFile(e,t){return new Promise((n,r)=>{let i=new FileReader;i.onload=a=>{let s=a.target.result;n(s)},i.onerror=a=>r(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){let t=[],n=this.weightsFiles.map(i=>eU(i.name)),r={};for(let i of e)i.paths.forEach(a=>{let s=eU(a);if(t.indexOf(s)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${s}'`);if(t.push(s),n.indexOf(s)===-1)throw new Error(`Weight file with basename '${s}' is not provided.`);r[a]=this.weightsFiles[n.indexOf(s)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}},F5e=e=>he().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ZC.URL_SCHEME)?z5e(e.slice(ZC.URL_SCHEME.length)):null;Fs.registerSaveRouter(F5e);function z5e(e="model"){return new ZC(e)}function B5e(e){return new L5e(e)}function iU(e,t,n,r){s(e),n=n==null?0:n,r=r==null?1:r,o(n,r);let i=0,a=l=>(l.then(u=>{let c=n+ ++i/e.length*(r-n);return t(c),u}),l);function s(l){Z(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,u){Z(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),Z(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),Z(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(e.map(a))}async function kte(e,t){t==null&&(t={});let n=t.fetchFunc==null?he().platform.fetch:t.fetchFunc,r=e.map(a=>n(a,t.requestInit,{isBinary:!0})),i=(t.onProgress==null?await Promise.all(r):await iU(r,t.onProgress,0,.5)).map(a=>a.arrayBuffer());return t.onProgress==null?await Promise.all(i):await iU(i,t.onProgress,.5,1)}function W5e(e,t){var n;let r=t.fetchFunc==null?he().platform.fetch:t.fetchFunc,i=0,a;return(n=t.onProgress)===null||n===void 0||n.call(t,0),new ReadableStream({pull:async s=>{for(var o;i<e.length;){a||(a=(await r(e[i],t.requestInit,{isBinary:!0})).body.getReader());let{done:l,value:u}=await a.read();if(l){i++,a=void 0,(o=t.onProgress)===null||o===void 0||o.call(t,i/e.length);continue}s.enqueue(u);return}s.close()}})}async function V5e(e,t="",n,r){return Ste(i=>kte(i,{requestInit:r}))(e,t,n)}function Ste(e){return async(t,n="",r)=>{let i=t.map(()=>!1),a={},s=r!=null?r.map(()=>!1):[],o=[];if(t.forEach((h,m)=>{let g=0;h.weights.forEach(v=>{let y="quantization"in v?v.quantization.dtype:v.dtype,b=th[y]*Pn(v.shape),_=()=>{i[m]=!0,a[m]==null&&(a[m]=[]),a[m].push({manifestEntry:v,groupOffset:g,sizeBytes:b})};r!=null?r.forEach((k,C)=>{k===v.name&&(_(),s[C]=!0)}):_(),o.push(v.name),g+=b})}),!s.every(h=>h)){let h=r.filter((m,g)=>!s[g]);throw new Error(`Could not find weights in manifest with names: ${h.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}let l=i.reduce((h,m,g)=>(m&&h.push(g),h),[]),u=[];l.forEach(h=>{t[h].paths.forEach(m=>{let g=n+(n.endsWith("/")?"":"/")+m;u.push(g)})});let c=await e(u),d={},p=0;return l.forEach(h=>{let m=t[h].paths.length,g=new Hu(c.slice(p,p+m));a[h].forEach(v=>{let y=g.slice(v.groupOffset,v.groupOffset+v.sizeBytes),b=KQ(y,[v.manifestEntry]);for(let _ in b)d[_]=b[_]}),p+=m}),d}}var j5e="application/octet-stream",U5e="application/json",gL=class{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(Z(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=he().platform.fetch,Z(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&Z(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=JQ(e,n);if(t.body.append("model.json",new Blob([JSON.stringify(r)],{type:U5e}),"model.json"),e.weightData!=null){let a=Hu.join(e.weightData);t.body.append("model.weights.bin",new Blob([a],{type:j5e}),"model.weights.bin")}let i=await this.fetch(this.path,t);if(i.ok)return{modelArtifactsInfo:vw(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){let e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}let n=t.modelTopology,r=t.weightsManifest;if(n==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();let e=await this.loadModelJSON();return nD(e,t=>this.loadWeights(t))}async loadStream(){let e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=yP(e.weightsManifest),r=()=>W5e(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:r})}async getWeightUrls(e){let t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=H5e(t),i=this.weightPathPrefix||n,a=[],s=[];for(let o of e)for(let l of o.paths)this.weightUrlConverter!=null?s.push(this.weightUrlConverter(l)):a.push(i+l+r);return this.weightUrlConverter&&a.push(...await Promise.all(s)),a}async loadWeights(e){let t=await this.getWeightUrls(e),n=yP(e),r=await kte(t,this.loadOptions);return[n,r]}};gL.URL_SCHEME_REGEX=/^https?:\/\//;function H5e(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),i=n>t?e.substring(n):"";return[r+"/",i]}function CP(e){return e.match(gL.URL_SCHEME_REGEX)!=null}var Cte=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(r=>CP(r)):n=CP(e),n)return yL(e,t)}return null};Fs.registerSaveRouter(Cte);Fs.registerLoadRouter(Cte);function yL(e,t){return new gL(e,t)}function G5e(e,t){return yL(e,t)}var tE=class{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}},Ite=class{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}},q5e=class{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}};function K5e(e,t,n,r){let i=arguments;return new q5e($te(...i))}function $te(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new tE(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new tE({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new tE({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function Z5e(e){return new Ite(e)}function X5e(e){return new Ite(e)}var Tte={};Dt(Tte,{confusionMatrix:()=>Y5e});function J5e(e,t,n){let r=U(e,"labels","confusionMatrix"),i=U(t,"predictions","confusionMatrix");Z(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),Z(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),Z(i.rank===1,()=>`Expected the rank of predictions to be 1, but got ${i.rank}`),Z(r.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),Z(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);let a=ty(Me(r,"int32"),n),s=ty(Me(i,"int32"),n),o=Ut(a),l=jt(o,s);return Me(l,"int32")}var Y5e=re({confusionMatrix_:J5e}),Aw={};Dt(Aw,{draw:()=>sWe,fromPixels:()=>oWe,fromPixelsAsync:()=>rWe,toPixels:()=>aWe});var rp,aU=!1;function Nte(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,a=!1,s=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)a=!0;else if(e.getContext!=null)s=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(n1(UC,ne.backendName)!=null){let p={pixels:e},h={numChannels:t};return ne.runKernel(UC,p,h)}let[l,u]=i?[e.videoWidth,e.videoHeight]:[e.width,e.height],c;if(s)c=e.getContext("2d").getImageData(0,0,l,u).data;else if(r||n)c=e.data;else if(a||i||o){if(rp==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")rp=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else rp=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});rp.canvas.width=l,rp.canvas.height=u,rp.drawImage(e,0,0,l,u),c=rp.getImageData(0,0,l,u).data}let d;if(t===4)d=new Int32Array(c);else{let p=l*u;d=new Int32Array(p*t);for(let h=0;h<p;h++)for(let m=0;m<t;++m)d[h*t+m]=c[h*4+m]}return N$(d,[u,l,t],"int32")}function Q5e(e){return e!=null&&e.data instanceof Uint8Array}function eWe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function tWe(e){return e!=null&&e.width!==0&&e.height!==0}function nWe(e){return eWe()&&!(e instanceof ImageBitmap)&&tWe(e)&&!Q5e(e)}async function rWe(e,t=3){let n=null;if(he().getBool("WRAP_TO_IMAGEBITMAP")&&nWe(e)){let r;try{r=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===e.width&&r.height===e.height?n=r:n=e}else n=e;return Nte(n,t)}function Ete(e){if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);let t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}function iWe(e){let t=(e==null?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}async function aWe(e,t){let n=U(e,"img","toPixels");if(!(e instanceof zt)){let u=n;n=Me(u,"int32"),u.dispose()}Ete(n);let[r,i]=n.shape.slice(0,2),a=n.rank===2?1:n.shape[2],s=await n.data(),o=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(i*r*4);for(let u=0;u<r*i;++u){let c=[0,0,0,255];for(let p=0;p<a;p++){let h=s[u*a+p];if(n.dtype==="float32"){if(h<0||h>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${h}.`)}else if(n.dtype==="int32"&&(h<0||h>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${h}.`);a===1?(c[0]=h*o,c[1]=h*o,c[2]=h*o):c[p]=h*o}let d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(t!=null){aU||n1(X2,ne.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),aU=!0),t.width=i,t.height=r;let u=t.getContext("2d"),c=new ImageData(l,i,r);u.putImageData(c,0,0)}return n!==e&&n.dispose(),l}function sWe(e,t,n){let r=U(e,"img","draw");if(!(e instanceof zt)){let s=r;r=Me(s,"int32"),s.dispose()}Ete(r),iWe(n==null?void 0:n.imageOptions);let i={image:r},a={canvas:t,options:n};ne.runKernel(X2,i,a)}var oWe=re({fromPixels_:Nte}),vL={};Dt(vL,{prepareAndValidate:()=>Ote});function Ote(e,t){let n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(Pn(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);let i=t.shape,a=i[i.length-1],s=1;for(let d=0;d<i.length-1;++d)s*=i[d];let o=e.shape,l=i.slice();l.pop();let u=1;for(let d=a;d<n;++d)u*=o[d],l.push(o[d]);let c=[...Py(e.shape).map(d=>d/u),1].slice(0,a);return[l,s,u,c]}var ei={};Dt(ei,{assertParamsValid:()=>uWe,computeFlatOffset:()=>fWe,computeOutShape:()=>dWe,getNormalizedAxes:()=>pWe,isSliceContinous:()=>hWe,maskToAxes:()=>cWe,parseSliceParams:()=>Bte,sliceInfo:()=>mWe,startForAxis:()=>Fte,startIndicesWithElidedDims:()=>Rte,stopForAxis:()=>zte,stopIndicesWithElidedDims:()=>Dte,stridesForAxis:()=>Lte,stridesWithElidedDims:()=>Pte});var IP=-2,lWe=-1;function uWe(e,t,n){let r=e.shape.length;Z(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),Z(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)Z(t[i]+n[i]<=e.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`)}function cWe(e){let t=[],n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function dWe(e,t,n){let r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function Pte(e,t,n,r){let i=[...e];for(let a=i.length;a<r.length;a++)i.push(1);for(let a=0;a<n;a++)a===0?i[t]=1:(i.splice(t,0,1),i.pop());return i}function Ate(e,t,n){return n<=e?n:n-(t-1)}function Mte(e,t){let n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function pWe(e,t,n,r,i,a,s,o,l){let u=e.length,c=new Array(u),d=new Array(u),p=new Array(u);if(t.length&&n>0){let h=t[0],m=n+1;c=Rte(s,h,m,r,e),d=Dte(o,h,m,i,e),p=Pte(a,h,m,e)}else for(let h=0;h<u;h++)c[h]=Fte(s,r,a,e,h,l),d[h]=zte(o,i,a,e,h,l),p[h]=Lte(a,h,l);return{begin:c,end:d,strides:p}}function Rte(e,t,n,r,i){let a=[...i],s=Mte(n,t);for(let o=0;o<a.length;o++)if(s.indexOf(o)>-1)a[o]=0;else{let l=Ate(t,n,o),u=r[l];e&1<<l&&(u=0),a[o]=u}return a}function Dte(e,t,n,r,i){let a=[...i],s=Mte(n,t);for(let o=0;o<a.length;o++)if(s.indexOf(o)>-1)a[o]=Number.MAX_SAFE_INTEGER;else{let l=Ate(t,n,o),u=r[l];e&1<<l&&(u=Number.MAX_SAFE_INTEGER),a[o]=u}for(let o=0;o<a.length;o++){let l=i[o];a[o]<0&&(a[o]+=l),a[o]=e1(0,a[o],i[o])}return a}function Lte(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function Fte(e,t,n,r,i,a){let s=t[i],o=n[i]||1;(e&1<<i||a&1<<i||s==null)&&(o>0?s=Number.MIN_SAFE_INTEGER:s=Number.MAX_SAFE_INTEGER);let l=r[i];return s<0&&(s+=l),s=e1(0,s,l-1),s}function zte(e,t,n,r,i,a){let s=t[i],o=n[i]||1;(e&1<<i||a&1<<i||s==null)&&(o>0?s=Number.MAX_SAFE_INTEGER:s=Number.MIN_SAFE_INTEGER);let l=r[i];return s<0&&(s+=l),o>0?s=e1(0,s,l):s=e1(-1,s,l-1),s}function hWe(e,t,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function fWe(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function Bte(e,t,n){let r,i=e.shape.length;typeof t=="number"?r=[t,...new Array(i-1).fill(0)]:t.length<i?r=t.concat(new Array(i-t.length).fill(0)):r=t.slice(),r.forEach(s=>{Z(s!==-1,()=>"slice() does not support negative begin indexing.")});let a;return n==null?a=new Array(i).fill(-1):typeof n=="number"?a=[n,...new Array(i-1).fill(-1)]:n.length<i?a=n.concat(new Array(i-n.length).fill(-1)):a=n,a=a.map((s,o)=>s>=0?s:(Z(s===-1,()=>`Negative size values should be exactly -1 but got ${s} for the slice() size at index ${o}.`),e.shape[o]-r[o])),[r,a]}function mWe(e,t,n,r,i,a,s,o,l){let u;if(r==null?(u=new Array(t.length),u.fill(1)):u=r,s!=null&&s&s-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1,d={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:u.slice(),beginMask:i,endMask:a,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)c&&1<<b&o&&d.numAddAxisAfterEllipsis++,1<<b&s&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);let p={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};gWe(d,p);let h=!0,m=!0,g=!0,v=[],y=[];for(let b=0;b<e.length;++b){if(p.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);let _=!!(p.shrinkAxisMask&1<<b),k=e[b];if(k===-1){v.push(_?1:-1);continue}let C=[p.beginMask&1<<b,p.endMask&1<<b],$=[p.strides[b]>0?0:-1,p.strides[b]>0?k:k-1];if(_&&p.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&p.strides[b]===1;let N=!!(p.beginMask&1<<b&&p.endMask&1<<b);if(p.beginValid&&p.endValid){if(_){let F=p.begin[b]<0?k+p.begin[b]:p.begin[b];if(p.begin[b]=F,p.end[b]=p.begin[b]+1,F<0||F>=k)throw Error(`slice index ${p.begin[b]} of dimension ${b} out of bounds.`)}else p.begin[b]=sU(p.begin[b],0,p.strides[b],k,C,$),p.end[b]=sU(p.end[b],1,p.strides[b],k,C,$);let O=p.strides[b]===1&&p.begin[b]===0&&p.end[b]===k;h=h&&O,m=m&&(b===0&&p.strides[b]===1||O)}else h=h&&p.strides[b]===1&&N,m=m&&(b===0&&p.strides[b]===1||N);let A,D=!1;if(p.beginValid&&p.endValid?(A=p.end[b]-p.begin[b],D=!0):_?(A=1,D=!0):N&&k>=0&&(p.strides[b]<0?A=-k:A=k,D=!0),D){let O;A===0||A<0!=p.strides[b]<0?O=0:O=Math.trunc(A/p.strides[b])+(A%p.strides[b]!==0?1:0),v.push(O)}else v.push(-1)}for(let b=0;b<p.finalShapeGatherIndices.length;++b){let _=p.finalShapeGatherIndices[b];_>=0?y.push(v[_]):_===IP&&y.push(1)}return{finalShapeSparse:y.filter((b,_)=>p.finalShapeGatherIndices[_]!==IP),finalShape:y,isIdentity:h,sliceDim0:m,isSimpleSlice:g,begin:p.begin,end:p.end,strides:p.strides}}function gWe(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){let i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(IP),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(lWe),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function sU(e,t,n,r,i,a){if(i[t])return n>0?a[t]:a[t+1&1];{let s=e<0?r+e:e;return s<a[0]?a[0]:s>a[1]?a[1]:s}}var yWe="4.16.0",Wte=class{static sgd(e){return new z$(e)}static momentum(e,t,n=!1){return new fL(e,t,n)}static rmsprop(e,t=.9,n=0,r=null,i=!1){return new mL(e,t,n,r,i)}static adam(e=.001,t=.9,n=.999,r=null){return new pL(e,t,n,r)}static adadelta(e=.001,t=.95,n=null){return new cL(e,t,n)}static adamax(e=.002,t=.9,n=.999,r=null,i=0){return new hL(e,t,n,r,i)}static adagrad(e,t=.1){return new dL(e,t)}},up=Wte,vWe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e();function bL(){return new Promise(e=>vWe(()=>e()))}var W={};Dt(W,{ERF_A1:()=>AWe,ERF_A2:()=>MWe,ERF_A3:()=>RWe,ERF_A4:()=>DWe,ERF_A5:()=>LWe,ERF_P:()=>PWe,PARALLELIZE_THRESHOLD:()=>wL,RowPartitionType:()=>_l,SELU_SCALE:()=>jte,SELU_SCALEALPHA:()=>Vte,applyActivation:()=>L$,assertAndGetBroadcastShape:()=>Vn,assertAxesAreInnerMostDims:()=>mze,assertParamsConsistent:()=>bWe,assignToTypedArray:()=>jWe,axesAreInnerMostDims:()=>OD,calculateShapes:()=>Xee,checkEinsumDimSizes:()=>ZWe,checkPadOnDimRoundingMode:()=>ka,combineLocations:()=>yee,combineRaggedTensorToTensorShapes:()=>xWe,complexWithEvenIndex:()=>BWe,complexWithOddIndex:()=>WWe,computeConv2DInfo:()=>bw,computeConv3DInfo:()=>lee,computeDefaultPad:()=>pD,computeDilation2DInfo:()=>hFe,computeOptimalWindowSize:()=>CWe,computeOutAndReduceShapes:()=>vee,computeOutShape:()=>wWe,computePool2DInfo:()=>oee,computePool3DInfo:()=>fFe,convertConv2DDataFormat:()=>uee,decodeEinsumEquation:()=>qWe,eitherStridesOrDilationsAreOne:()=>Zl,expandShapeToKeepDim:()=>oh,exponent:()=>HWe,exponents:()=>UWe,fromStringArrayToUint8:()=>gVe,fromUint8ToStringArray:()=>mVe,getAxesPermutation:()=>bee,getBroadcastDims:()=>mee,getComplexWithIndex:()=>VWe,getEinsumComputePath:()=>XWe,getEinsumPermutation:()=>KWe,getFusedBiasGradient:()=>D$,getFusedDyActivation:()=>R$,getImageCenter:()=>IWe,getInnerMostAxes:()=>gze,getPermuted:()=>TWe,getRaggedRank:()=>kWe,getReductionAxes:()=>Vr,getReshaped:()=>$We,getReshapedPermuted:()=>NWe,getRowPartitionTypesHelper:()=>_We,getSliceBeginCoords:()=>EWe,getSliceSize:()=>OWe,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>eVe,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>tVe,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>nVe,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>aVe,getSparseReshapeInputOutputMismatchErrorMessage:()=>oVe,getSparseReshapeInputOutputMultipleErrorMessage:()=>sVe,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>rVe,getSparseReshapeNegativeOutputDimErrorMessage:()=>iVe,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>dVe,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>lVe,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>uVe,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>cVe,getUndoAxesPermutation:()=>PD,isIdentityPermutation:()=>JWe,log:()=>CDe,mergeRealAndImagArrays:()=>FWe,prepareAndValidate:()=>Ote,prepareSplitSize:()=>QWe,segment_util:()=>Ute,shouldFuse:()=>F$,slice_util:()=>ei,splitRealAndImagArrays:()=>zWe,stridesOrDilationsArePositive:()=>ah,tupleValuesAreOne:()=>ud,upcastType:()=>Ls,validateDefaultValueShape:()=>SWe,validateInput:()=>O$,validateUpdateShape:()=>eL,warn:()=>Ic});function bWe(e,t){let n=e[0].length;e.forEach((i,a)=>{Z(i.length===n,()=>`Error in concat${n}D: rank of tensors[${a}] must be the same as the rank of the rest (${n})`)}),Z(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);let r=e[0];e.forEach((i,a)=>{for(let s=0;s<n;s++)Z(s===t||i[s]===r[s],()=>`Error in concat${n}D: Shape of tensors[${a}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${a}.`)})}function wWe(e,t){let n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var _l;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(_l||(_l={}));function xWe(e,t,n){let r=new Array;if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){let a=n[i],s=r[r.length-n.length+i],o=r[s];if(a>=0)if(o>=0){if(o!==a)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${a} but shape[${i+e}] = ${o}`)}else r[s]=a}return r}function _We(e){let t={FIRST_DIM_SIZE:_l.FIRST_DIM_SIZE,VALUE_ROWIDS:_l.VALUE_ROWIDS,ROW_LENGTHS:_l.ROW_LENGTHS,ROW_SPLITS:_l.ROW_SPLITS,ROW_LIMITS:_l.ROW_LIMITS,ROW_STARTS:_l.ROW_STARTS},n=[];for(let r of e)if(r in t)n.push(t[r]);else break;return n}function kWe(e){return e.length===0?0:e[0]===_l.FIRST_DIM_SIZE?e.length-1:e.length}function SWe(e,t){if(e==null||t==null)return;let n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){let a=e[i],s=t[i+1];if(a>=0&&s>=0&&a!==1&&a!==s)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${a} but ragged tensor input.flatValues.shape[${i-e.length}] = ${s}`)}}var wL=30;function CWe(e){return e<=wL?e:jC(e,Math.floor(Math.sqrt(e)))}function IWe(e,t,n){let r=n*(typeof e=="number"?e:e[0]),i=t*(typeof e=="number"?e:e[1]);return[r,i]}function $We(e,t,n,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);let a=t.length;for(let s=0;s<a;++s)i=i.concat([e[s+1]/t[s],t[s]]);i=i.concat(e.slice(a+1))}return i}function TWe(e,t,n=!0){let r=[];if(n){r.push(t);for(let i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{let i=[],a=[];for(let s=1;s<e;++s)s>=t*2+1||s%2===1?a.push(s):i.push(s);r.push(...i),r.push(0),r.push(...a)}return r}function NWe(e,t,n,r=!0){let i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let a=1;a<e.length;++a)a<=t.length?r?i.push(t[a-1]*e[a]):i.push(e[a]/t[a-1]):i.push(e[a]);return i}function EWe(e,t){let n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function OWe(e,t,n){let r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}var Vte=1.7580993408473768,jte=1.0507009873554805,PWe=.3275911,AWe=.254829592,MWe=-.284496736,RWe=1.421413741,DWe=-1.453152027,LWe=1.061405429;function FWe(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);let n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function zWe(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function BWe(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=0;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function WWe(e){let t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=2;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function VWe(e,t){let n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function jWe(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function UWe(e,t){let n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){let a=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}function HWe(e,t,n){let r=(n?2:-2)*Math.PI*(e/t),i=Math.cos(r),a=Math.sin(r);return{real:i,imag:a}}var nE="->",GWe=/->/g,oU=",",lU="...";function qWe(e,t){e=e.replace(/\s/g,"");let n=(e.length-e.replace(GWe,"").length)/nE.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${nE}").`);let[r,i]=e.split(nE);Z(r.indexOf(lU)===-1,()=>`The ellipsis notation ("${lU}") is not supported yet.`);let a=r.split(oU),s=a.length;if(t!==s)throw new Error(`Expected ${s} input tensors, received ${t}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let o=[];for(let p=0;p<i.length;++p){let h=i[p];if(!a.some(m=>m.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);o.indexOf(h)===-1&&o.push(h)}for(let p=0;p<r.length;++p){let h=r[p];o.indexOf(h)===-1&&h!==oU&&o.push(h)}let l=new Array(a.length);for(let p=0;p<s;++p){if(new Set(a[p].split("")).size!==a[p].length)throw new Error(`Found duplicate axes in input component ${a[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let h=0;h<a[p].length;++h)l[p].push(o.indexOf(a[p][h]))}let u=o.length,c=i.length,d=[];for(let p=c;p<u;++p)d.push(p);return{allDims:o,summedDims:d,idDims:l}}function KWe(e,t){let n=new Array(e);n.fill(-1);for(let i=0;i<t.length;++i)n[t[i]]=i;let r=[];for(let i=0;i<e;++i)n[i]===-1&&r.push(i);return n=n.filter(i=>i!==-1),{permutationIndices:n,expandDims:r}}function ZWe(e,t,n){let r=new Array(e);for(let i=0;i<n.length;++i){let a=n[i].shape;for(let s=0;s<t[i].length;++s)r[t[i][s]]===void 0?r[t[i][s]]=a[s]:Z(r[t[i][s]]===a[s],()=>`Expected dimension ${r[t[i][s]]} at axis ${s} of input shaped ${JSON.stringify(a)}, but got dimension ${a[s]}`)}}function XWe(e,t){let n=e,r=[],i=0;e.length===0&&n.push(-1),i=e.length+1;for(let s=0;s<i;++s)r.push([]);let a=[];for(let s=0;s<n.length;++s){let o=n[s],l=YWe(t,o);for(let u of l)a.indexOf(u)===-1&&(r[s].push(u),a.push(u))}return{path:n,steps:r}}function JWe(e){return e.every((t,n)=>t===n)}function YWe(e,t){let n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}function QWe(e,t,n=0){let r=[];if(typeof t=="number")Z(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{let i=t.reduce((s,o)=>(o===-1&&(s+=1),s),0);Z(i<=1,()=>"There should be only one negative value in split array.");let a=t.indexOf(-1);if(a!==-1){let s=t.reduce((o,l)=>l>0?o+l:o);t[a]=e.shape[n]-s}Z(e.shape[n]===t.reduce((s,o)=>s+o),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}function eVe(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function tVe(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function nVe(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}function rVe(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function iVe(e,t){return`size ${e} must be non-negative, not ${t}`}function aVe(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function sVe(e,t){let n=Pn(e),r=Pn(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function oVe(e,t){let n=Pn(e),r=Pn(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}function lVe(){return"segment ids must be >= 0"}function uVe(){return"segment ids are not increasing"}function cVe(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function dVe(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}var Ute={};Dt(Ute,{collectGatherOpShapeInfo:()=>fVe,computeOutShape:()=>hVe,segOpComputeOptimalWindowSize:()=>pVe});function pVe(e,t){let n=!1,r;for(e<=wL?(r=e,n=!0):r=jC(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=jC(e,r+1);return r}function hVe(e,t,n){let r=[],i=e.length;for(let a=0;a<i;a++)a!==t?r.push(e[a]):r.push(n);return r}function fVe(e,t,n,r){let i=t.shape.length,a=e.shape.length;if(r!==0&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>a)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${a}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(e.shape[d]!==t.shape[d])throw new Error(`x.shape[${d}]: ${e.shape[d]} should be equal to indices.shape[${d}]: ${t.shape[d]}.`);let s=e.shape[n],o=[],l=1,u=1,c=1;for(let d=0;d<r;++d)o.push(e.shape[d]),l*=e.shape[d];for(let d=r;d<n;d++)o.push(e.shape[d]),u*=e.shape[d];for(let d=r;d<i;d++)o.push(t.shape[d]);for(let d=n+1;d<a;d++)o.push(e.shape[d]),c*=e.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:s,outputShape:o}}function mVe(e){try{return e.map(t=>GC(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function gVe(e){return e.map(t=>gw(t))}var Jl={};Dt(Jl,{nonMaxSuppressionV3Impl:()=>cte,nonMaxSuppressionV4Impl:()=>dte,nonMaxSuppressionV5Impl:()=>pte,whereImpl:()=>Qee});A5e();var Hte={kernelName:Ay,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(e,Yf(Me(n,"float32"),-1))}}},yVe={kernelName:Eh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=zn(Me(n,"float32")),i=Ai(Ve(yt(1),r));return Yn(et(e,i))}}}},vVe={kernelName:Oh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Ai(Ve(zn(Me(n,"float32")),1));return et(e,r)}}}},bVe={kernelName:Nd,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Vn(n.shape,r.shape);return{a:()=>{let a=e,s=Vr(n.shape,i);return s.length>0&&(a=lt(a,s)),oe(a,n.shape)},b:()=>{let a=e,s=Vr(r.shape,i);return s.length>0&&(a=lt(a,s)),oe(a,r.shape)}}}},wVe={kernelName:Ph,saveAllInputs:!0,gradFunc:(e,t)=>{let n={};return t.forEach((r,i)=>{n[i]=()=>e.clone()}),n}},xVe={kernelName:Dy,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>sn(n)}}},_Ve={kernelName:Ly,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>sn(n)}}},kVe={kernelName:Ah,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>et(e,Ai(Ve(yt(1),zn(Me(n,"float32")))))}}},SVe={kernelName:Mh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Ai(we(yt(1),zn(Me(n,"float32"))));return et(e,r)}}}},CVe={kernelName:Lh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Vn(n.shape,r.shape);return{a:()=>{let a=we(zn(n),zn(r)),s=ae(e,et(r,a)),o=Vr(n.shape,i);return o.length>0&&(s=lt(s,o)),oe(s,n.shape)},b:()=>{let a=we(zn(n),zn(r)),s=Yn(ae(e,et(n,a))),o=Vr(r.shape,i);return o.length>0&&(s=lt(s,o)),oe(s,r.shape)}}}},IVe={kernelName:Rh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>et(e,we(zn(Me(n,"float32")),1))}}},$Ve={kernelName:Dh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>et(e,Ve(yt(1),zn(Me(n,"float32"))))}}};function TVe(e,t,n,r,i,a){let s=U(e,"dy","avgPool3dGrad"),o=U(t,"input","avgPool3dGrad"),l=s,u=o,c=!1;o.rank===4&&(c=!0,l=oe(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),u=oe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Z(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),Z(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),ka("avgPool3dGrad",i,a);let d={dy:l,input:u},p={filterSize:n,strides:r,pad:i,dimRoundingMode:a},h=ne.runKernel(K1,d,p);return c?oe(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}var NVe=re({avgPool3dGrad_:TVe}),EVe={kernelName:Fy,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:i,strides:a,pad:s,dimRoundingMode:o}=n;return{x:()=>NVe(e,r,i,a,s,o)}}};function OVe(e,t,n,r,i){let a=U(e,"dy","avgPoolGrad"),s=U(t,"input","avgPoolGrad");Z(s.rank===a.rank,()=>`Rank of input (${s.rank}) does not match rank of dy (${a.rank})`);let o=s,l=a,u=!1;s.rank===3&&(u=!0,o=oe(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=oe(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Z(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),Z(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);let c={dy:l,input:o},d={filterSize:n,strides:r,pad:i},p=ne.runKernel(q1,c,d);return u?oe(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var PVe=re({avgPoolGrad_:OVe}),AVe={kernelName:Fh,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:i,strides:a,pad:s}=n;return{x:()=>PVe(e,r,i,a,s)}}},MVe={kernelName:zh,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{let[r,i]=t,{transposeA:a,transposeB:s}=n;return!a&&!s?{a:()=>jt(e,i,!1,!0),b:()=>jt(r,e,!0,!1)}:!a&&s?{a:()=>jt(e,i,!1,!1),b:()=>jt(e,r,!0,!1)}:a&&!s?{a:()=>jt(i,e,!1,!0),b:()=>jt(r,e,!1,!1)}:{a:()=>jt(i,e,!0,!0),b:()=>jt(e,r,!0,!0)}}},RVe={kernelName:zy,gradFunc:(e,t,n)=>{let{blockShape:r,crops:i}=n;return{x:()=>Tw(e,r,i)}}},DVe={kernelName:EQ,gradFunc:(e,t,n)=>{let r=n,i=r.inputShape,a=r.shape,s=Array.from(a);for(let l=i.length-1;l>=0;l--)if(i[l]===a[l])s[l]=1;else if(i[l]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${a}].`);let o=[];for(let l=0;l<s.length;l++)s[l]>1&&o.push(l);return{x:()=>lt(e,o,!0)}}},LVe={kernelName:Bh,gradFunc:e=>({x:()=>e.clone()})},FVe={kernelName:Wh,gradFunc:e=>({x:()=>sn(e)})},zVe={kernelName:Ed,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{clipValueMin:i,clipValueMax:a}=n;return{x:()=>yi(ho(qu(r,i),Md(r,a)),e,sn(e))}}},BVe={kernelName:X1,inputsToSave:["x"],gradFunc:Hte.gradFunc},WVe={kernelName:Vy,saveAllInputs:!0,gradFunc:(e,t,n)=>{let r=t.map(o=>o.shape),{axis:i}=n,a=yo(i,t[0].shape)[0],s=r.map(o=>o[a]);return La(e,s,a).map(o=>()=>o)}},VVe={kernelName:Vh,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,i]=t,{dilations:a,strides:s,pad:o,dataFormat:l}=n;return Z(ud(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>kD(r.shape,e,i,s,o,l),filter:()=>oL(r,e,i.shape,s,o,l)}}},jVe={kernelName:jh,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{let[r,i]=t,{strides:a,pad:s,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>ga(e,i,a,s,o,1,l),filter:()=>oL(e,r,i.shape,a,s,o,l)}}};function UVe(e,t,n,r,i){let a=e;e.rank===4&&(a=oe(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let s=t;s.rank===4&&(s=oe(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),Z(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),Z(s.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${s.shape}.`),Z(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),Z(a.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`),Z(s.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${s.shape[4]}) must match output depth for filter (${n[4]}).`);let o={x:a,dy:s},l={strides:r,pad:i,filterShape:n};return ne.runKernel(jy,o,l)}var HVe=re({conv3DBackpropFilter_:UVe}),GVe={kernelName:Uh,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:i,pad:a}=n;Z(ud(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);let[s,o]=t;return{x:()=>hee(s.shape,e,o,i,a),filter:()=>HVe(s,e,o.shape,i,a)}}},qVe={kernelName:Hh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(Yn(S$(Me(n,"float32"))),e)}}},KVe={kernelName:Gh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(C$(Me(n,"float32")),e)}}},ZVe={kernelName:qh,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:i,exclusive:a,reverse:s}=n;return{x:()=>{let o=bee([i],r.rank),l=h$(e,i,a,!s);return o!=null&&(l=Ut(l,o)),l}}}},XVe={kernelName:Kh,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:i,pad:a,dimRoundingMode:s}=n,o=r==null?[1,1]:r;Z(ud(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);let[l,u]=t;return Z(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),Z(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),Z(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),Z(Zl(i,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${o}'.`),ka("depthwiseConv2d",a,s),{x:()=>ote(l.shape,e,u,i,a,o,s),filter:()=>ste(l,e,u.shape,i,a,o,s)}}},JVe={kernelName:Zh,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,i]=t,a={x:r,filter:i,dy:e},s={x:r,filter:i,dy:e};return{x:()=>ne.runKernel(Xg,a,n),filter:()=>ne.runKernel(Jg,s,n)}}},YVe={kernelName:Jh,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t,r={dy:e,y:n};return{x:()=>ne.runKernel(Ky,r)}}},QVe={kernelName:Yh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=ae(Qi(Yn(zn(n))),2/Math.sqrt(Math.PI));return{x:()=>ae(e,r)}}},e6e={kernelName:Qh,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(e,n)}}},t6e={kernelName:Xy,inputsToSave:["input"],gradFunc:(e,t)=>{let[n]=t;return{input:()=>oe(e,n.shape)}}},n6e={kernelName:ef,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(e,Qi(n))}}},r6e={kernelName:tf,gradFunc:e=>({x:()=>sn(e)})},i6e={kernelName:nf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Vn(n.shape,r.shape);return{a:()=>{let a=et(e,Me(r,"float32")),s=Vr(n.shape,i);return s.length>0?oe(lt(a,s),n.shape):a},b:()=>{let a=ae(e,Me(n,"float32")),s=Vr(r.shape,i);s.length>0&&(a=oe(lt(a,s),r.shape));let o=zn(r);return Yn(et(a,Me(o,"float32")))}}}},a6e={kernelName:rf,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{let{varianceEpsilon:r}=n,[i,a,s,o]=t,l=o==null?yt(1):o,u=Vr(a.shape,i.shape),c=[];if(a.rank===1){for(let g=0;g<i.shape.length-1;++g)c.push(i.shape[g]);c.push(1)}let d=Ve(i,a),p=ae(e,l),h=_$(we(s,yt(r))),m=ae(ae(ae(h,h),h),yt(-.5));return{x:()=>a.rank===1?oe(ae(ae(e,ss(oe(h,[1,1,1,a.shape[0]]),c)),l),i.shape):oe(ae(ae(e,h),l),i.shape),mean:()=>{let g=ae(ae(h,yt(-1)),p);return a.rank===1&&(g=lt(g,u)),oe(g,a.shape)},variance:()=>{let g=ae(ae(m,d),p);return a.rank===1&&(g=lt(g,u)),oe(g,a.shape)},scale:()=>{let g=ae(d,h),v=ae(e,g);return a.rank===1&&(v=lt(v,u)),oe(v,a.shape)},offset:()=>{let g=e;return a.rank===1&&(g=lt(g,u)),oe(g,a.shape)}}}},s6e={kernelName:Yy,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{let[r,i]=t,{axis:a,batchDims:s}=n,o=yo(a,r.shape)[0],l=(u,c,d)=>()=>{let p=u.shape,h=c.size,m=p.slice(0,o),g=m.length,v=p.slice(a,p.length).slice(1),y=v.length,b=uU(0,g),_=uU(g+1,g+1+y),k=cU([m,[h],v]),C=oe(d,k),$=oe(c,[h]),N=cU([[g],b,_]),A=Ut(C,N),D=A$(A,$,u.shape[o]),O=PD(N);return D=Ut(D,O),D};if(s===1){let u=r.shape[0],c=r.split(u,0);return{x:()=>Wr(c.map((d,p)=>l(d,i.slice(p,1),e.slice(p,1))())).reshape(r.shape),indices:()=>i}}else return{x:l(r,i,e),indices:()=>i}}};function uU(e,t){let n=[];for(let r=e;r<t;++r)n.push(r);return n}function cU(e){let t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var o6e={kernelName:af,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>sn(n),b:()=>sn(r)}}},l6e={kernelName:sf,gradFunc:e=>({x:()=>Me(e,"float32")})},u6e={kernelName:of,gradFunc:e=>({x:()=>sn(e)})},c6e={kernelName:lf,gradFunc:e=>({x:()=>sn(e)})},d6e={kernelName:uf,gradFunc:e=>({x:()=>sn(e)})},p6e={kernelName:cf,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{alpha:i}=n,a=Sa(r,0);return{x:()=>yi(a,e,ae(e,i))}}},h6e={kernelName:pf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>et(e,we(n,1))}}},f6e={kernelName:df,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>et(e,Me(n,"float32"))}}},m6e={kernelName:PQ,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{axis:i}=n;return{logits:()=>{let a=Qi(r);return Ve(e,ae(lt(e,i,!0),a))}}}};function g6e(e,t,n,r=5,i=1,a=1,s=.5){let o={x:e,y:t,dy:n},l={depthRadius:r,bias:i,alpha:a,beta:s};return ne.runKernel(ov,o,l)}var y6e=re({localResponseNormalizationBackprop_:g6e}),v6e={kernelName:hf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,i]=t,{depthRadius:a,bias:s,alpha:o,beta:l}=n;return{x:()=>y6e(r,i,e,a,s,o,l)}}};function Gte(e,t,n,r){return t.rank<n.rank&&(t=oe(t,oh(t.shape,r))),e.rank<n.rank&&(e=oe(e,oh(e.shape,r))),{x:()=>ae(e,Me(ms(n,t),e.dtype))}}var dU={kernelName:ff,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{reductionIndices:i}=r,a=t[0],s=t[1],o=yo(i,a.shape),l=Gte(e,s,a,o);return{x:()=>l.x()}}},b6e={kernelName:mf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>ae(e,Me(qu(n,r),"float32")),b:()=>ae(e,Me(ey(n,r),"float32"))}}};function w6e(e,t,n,r,i,a,s){let o=U(e,"dy","maxPool3dGrad"),l=U(t,"input","maxPool3dGrad"),u=U(n,"output","maxPool3dGrad"),c=o,d=l,p=u,h=!1;l.rank===4&&(h=!0,c=oe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=oe(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=oe(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),Z(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),Z(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),Z(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),ka("maxPool3dGrad",a,s);let m={dy:c,input:d,output:p},g={filterSize:r,strides:i,pad:a,dimRoundingMode:s},v=ne.runKernel(tw,m,g);return h?oe(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}var x6e=re({maxPool3dGrad_:w6e}),_6e={kernelName:lv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,i]=t,{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=n;return{x:()=>x6e(e,r,i,a,s,o,l)}}};function k6e(e,t,n,r,i,a,s){let o=U(e,"dy","maxPoolGrad"),l=U(t,"input","maxPoolGrad"),u=U(n,"output","maxPoolGrad");Z(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),Z(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),Z(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),ka("maxPoolGrad",a,s);let c={dy:o,input:l,output:u},d={filterSize:r,strides:i,pad:a,dimRoundingMode:s};return ne.runKernel(ew,c,d)}var S6e=re({maxPoolGrad_:k6e}),C6e={kernelName:gf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,i]=t,{filterSize:a,strides:s,pad:o}=n;return{x:()=>S6e(e,r,i,a,s,o)}}},I6e={kernelName:yf,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:i}=n,a=yo(i,r.shape),s=vee(r.shape,a)[1],o=Pn(s);return{x:()=>{let l=r.shape.slice();a.forEach(c=>{l[c]=1});let u=oe(e,l);return et(ae(u,Aa(r.shape,"float32")),o)}}}},$6e={kernelName:vf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{axis:i}=r,[a,s]=t,o=yo(i,a.shape),l=Gte(e,s,a,o);return{x:()=>l.x()}}},T6e={kernelName:bf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>ae(e,Me(Md(n,r),"float32")),b:()=>ae(e,Me(Sa(n,r),"float32"))}}},N6e={kernelName:wf,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:i}=n,a=i.map(s=>s[0]);return{x:()=>nn(e,a,r.shape)}}},E6e={kernelName:xf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Vn(n.shape,r.shape);return{a:()=>{let a=Vr(n.shape,i);return a.length>0?oe(lt(e,a),n.shape):e},b:()=>{let a=ae(e,Yn(Fv(et(n,r)))),s=Vr(r.shape,i);return s.length>0?oe(lt(a,s),r.shape):a}}}},O6e={kernelName:_f,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Vn(n.shape,r.shape);return{a:()=>{let a=ae(e,Me(r,"float32")),s=Vr(n.shape,i);return s.length>0?oe(lt(a,s),n.shape):a},b:()=>{let a=ae(e,Me(n,"float32")),s=Vr(r.shape,i);return s.length>0?oe(lt(a,s),r.shape):a}}}},P6e={kernelName:cv,gradFunc:e=>({x:()=>Yn(e)})},A6e={kernelName:kf,inputsToSave:["indices"],gradFunc:(e,t)=>{let n=t[0];return{indices:()=>br(n.shape,"float32")}}},M6e={kernelName:mv,gradFunc:e=>({x:()=>sn(e)})},R6e={kernelName:gv,saveAllInputs:!0,gradFunc:(e,t,n)=>{let{axis:r}=n;return Ir(e,r).map(i=>()=>i)}},pU={kernelName:Sf,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:i}=n,a=i.map(s=>s[0]);return{x:()=>nn(e,a,r.shape)}}},D6e={kernelName:Cf,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{let[n,r,i]=t,a=n,s=r,o=Vn(a.shape,s.shape);return{a:()=>{let l=Me(s,"float32"),u=ae(e,ae(l,Du(a,Ve(l,yt(1))))),c=Vr(a.shape,o);return c.length>0&&(u=lt(u,c)),oe(u,a.shape)},b:()=>{let l=Sa(a,0),u=yi(l,gs(a),sn(a)),c=ae(e,ae(i,u)),d=Vr(s.shape,o);return d.length>0&&(c=lt(c,d)),oe(c,s.shape)}}}},L6e={kernelName:If,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{let[n,r]=t,i=Sa(n,0);return{x:()=>yi(i,e,ae(e,r)),alpha:()=>{let a=yi(i,sn(e),ae(e,n)),s=Vr(r.shape,e.shape);return s.length>0&&(a=lt(a,s)),oe(a,r.shape)}}}};function F6e(e,t,n){let r=e.shape.slice();r[n]=1;let i=oe(t,r),a=l1(e,n,!0,!1),s=l1(e,n,!0,!0),o=ae(a,s);return ae(i,o)}function z6e(e,t,n){let r=e.shape.length,i=r-n.length,a=W.getAxesPermutation(n,r),s=e;a!=null&&(s=Ut(e,a));let o=s.shape.slice(),l=o.splice(r-n.length,n.length).reduce((d,p)=>d*p,1);o.push(l);let u=s.reshape(o),c=F6e(u,t,i);if(c=c.reshape(s.shape),a!=null){let d=W.getUndoAxesPermutation(a);c=Ut(c,d)}return c}var B6e={kernelName:$f,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:i}=n,a=[];return i==null?a=r.shape.map((s,o)=>o):typeof i=="number"?a=[i]:a=i,{x:()=>z6e(r,e,a)}}},W6e={kernelName:Xh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Vn(n.shape,r.shape);return{a:()=>{let a=et(e,Me(r,"float32")),s=Vr(n.shape,i);return s.length>0?oe(lt(a,s),n.shape):a},b:()=>{let a=ae(e,Me(n,"float32")),s=Vr(r.shape,i);s.length>0&&(a=oe(lt(a,s),r.shape));let o=zn(r);return Yn(et(a,Me(o,"float32")))}}}},V6e={kernelName:Tf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>et(e,Yn(zn(n)))}}},j6e={kernelName:Pf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=ae(Md(n,6),Yf(n));return{x:()=>ae(e,Me(r,"float32"))}}},U6e={kernelName:Nf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(e,Me(Yf(n),"float32"))}}},H6e={kernelName:yv,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>oe(e,n.shape)}}},G6e={kernelName:Of,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,i={dy:e,images:r};return{images:()=>ne.runKernel(bv,i,n)}}},q6e={kernelName:Ef,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,i={dy:e,images:r};return{images:()=>ne.runKernel(vv,i,n)}}},K6e={kernelName:Af,gradFunc:(e,t,n)=>{let{dims:r}=n,i=yo(r,e.shape);return{x:()=>zs(e,i)}}},Z6e={kernelName:Mf,gradFunc:e=>({x:()=>sn(e)})},X6e={kernelName:Rf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Yn(et(e,ae(Du(n,1.5),2)))}}},J6e={kernelName:kv,inputsToSave:["condition"],gradFunc:(e,t)=>{let[n]=t;return{condition:()=>Me(sn(n),"float32"),t:()=>ae(e,Me(n,e.dtype)),e:()=>ae(e,Me(Iw(n),e.dtype))}}},Y6e={kernelName:Df,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Sa(n,yt(0)),i=yt(Vte),a=yt(jte),s=ae(e,a),o=ae(ae(e,i),Qi(Me(n,"float32")));return yi(r,s,o)}}}},Q6e={kernelName:Bf,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(e,ae(n,Ve(yt(1),n)))}}},eje={kernelName:zf,gradFunc:e=>({x:()=>sn(e)})},tje={kernelName:Lf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(xw(Me(n,"float32")),e)}}},nje={kernelName:Ff,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(p$(Me(n,"float32")),e)}}},rje={kernelName:Sv,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{begin:i,size:a}=n,s=r.shape,[o,l]=Bte(r,i,a),u=[];for(let c=0;c<e.rank;c++)u.push([o[c],s[c]-o[c]-l[c]]);return{x:()=>al(e,u)}}},ije={kernelName:Uf,outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{dim:i}=n,a=!0,s=ae(e,r);return{logits:()=>Ve(s,ae(lt(s,[i],a),r))}}},aje={kernelName:Wf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(e,lo(n))}}},hU={kernelName:Cv,gradFunc:(e,t,n)=>{let{blockShape:r,paddings:i}=n;return{x:()=>ww(e,r,i)}}},fU={kernelName:Iv,gradFunc:(e,t,n)=>{let{axis:r}=n;return{x:()=>Wn(e,r)}}},sje={kernelName:Vf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>et(e,ae(Ai(Me(n,"float32")),2))}}},oje={kernelName:ow,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(e,ae(Me(n,"float32"),2))}}},lje={kernelName:Hf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=yt(2);return{a:()=>ae(e,ae(i,Ve(n,r))),b:()=>ae(e,ae(i,Ve(r,n)))}}},uje={kernelName:Pd,gradFunc:e=>({x:()=>sn(e)})},cje={kernelName:Gf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Vn(n.shape,r.shape);return{a:()=>{let a=e,s=Vr(n.shape,i);return s.length>0&&(a=lt(a,s)),oe(a,n.shape)},b:()=>{let a=e,s=Vr(r.shape,i);return s.length>0&&(a=lt(a,s)),oe(Yn(a),r.shape)}}}},dje={kernelName:jf,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,i=r.shape.slice(),{axis:a}=n;yo(a,r.shape).forEach(l=>{i[l]=1});let s=oe(e,i),o=ae(s,Aa(r.shape,"float32"));return{x:()=>o}}},pje={kernelName:qf,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>et(e,zn(xw(n)))}}},hje={kernelName:Kf,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ae(Ve(yt(1),zn(n)),e)}}},fje={kernelName:Od,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{reps:i}=n;return{x:()=>{let a=sn(r);if(r.rank===1)for(let s=0;s<i[0];++s)a=we(a,nn(e,[s*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let s=0;s<i[0];++s)for(let o=0;o<i[1];++o)a=we(a,nn(e,[s*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let s=0;s<i[0];++s)for(let o=0;o<i[1];++o)for(let l=0;l<i[2];++l)a=we(a,nn(e,[s*r.shape[0],o*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let s=0;s<i[0];++s)for(let o=0;o<i[1];++o)for(let l=0;l<i[2];++l)for(let u=0;u<i[3];++u)a=we(a,nn(e,[s*r.shape[0],o*r.shape[1],l*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return a}}}},mje={kernelName:ku,gradFunc:(e,t,n)=>{let r=n,{perm:i}=r,a=PD(i);return{x:()=>Ut(e,a)}}},gje={kernelName:Pv,gradFunc:(e,t,n)=>{let r=n,{axis:i}=r;return{value:()=>Wr(e,i)}}},yje={kernelName:hw,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>vje(e,n)}}};function vje(e,t){let n=Xl(t,sn(t)),r=zv(e,n),i=qu(t,yt(0,"int32")),a=r.rank-i.rank;for(let o=0;o<a;++o)i=hi(i,o+1);i=ho(i,Aa(r.shape,"bool"));let s=sn(r);return yi(i,r,s)}var bje={kernelName:Av,gradFunc:e=>({x:()=>sn(e)})},wje=[Hte,yVe,vVe,bVe,wVe,xVe,_Ve,kVe,SVe,CVe,IVe,$Ve,EVe,AVe,MVe,RVe,DVe,LVe,FVe,zVe,BVe,WVe,jVe,VVe,GVe,qVe,KVe,ZVe,XVe,JVe,W6e,YVe,QVe,e6e,t6e,n6e,i6e,r6e,a6e,s6e,o6e,l6e,u6e,c6e,d6e,p6e,h6e,f6e,m6e,v6e,dU,dU,b6e,_6e,C6e,I6e,$6e,T6e,N6e,E6e,O6e,P6e,A6e,M6e,R6e,pU,pU,D6e,L6e,B6e,V6e,j6e,U6e,H6e,G6e,q6e,K6e,Z6e,X6e,J6e,Y6e,Q6e,eje,tje,nje,rje,ije,aje,hU,hU,fU,fU,sje,lje,oje,uje,cje,dje,pje,hje,fje,mje,gje,yje,bje];for(let e of wje)AQ(e);xe().prototype.abs=function(){return this.throwIfDisposed(),Dr(this)};xe().prototype.acos=function(){return this.throwIfDisposed(),iD(this)};xe().prototype.acosh=function(){return this.throwIfDisposed(),aD(this)};xe().prototype.add=function(e){return this.throwIfDisposed(),we(this,e)};xe().prototype.all=function(e,t){return this.throwIfDisposed(),u$(this,e,t)};xe().prototype.any=function(e,t){return this.throwIfDisposed(),a1(this,e,t)};xe().prototype.argMax=function(e){return this.throwIfDisposed(),ih(this,e)};xe().prototype.argMin=function(e){return this.throwIfDisposed(),sD(this,e)};xe().prototype.asScalar=function(){return this.throwIfDisposed(),Z(this.size===1,()=>"The array must have only 1 element."),oe(this,[])};xe().prototype.asType=function(e){return this.throwIfDisposed(),Me(this,e)};xe().prototype.as1D=function(){return this.throwIfDisposed(),oe(this,[this.size])};xe().prototype.as2D=function(e,t){return this.throwIfDisposed(),oe(this,[e,t])};xe().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),oe(this,[e,t,n])};xe().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),oe(this,[e,t,n,r])};xe().prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),oe(this,[e,t,n,r,i])};xe().prototype.asin=function(){return this.throwIfDisposed(),oD(this)};xe().prototype.asinh=function(){return this.throwIfDisposed(),lD(this)};xe().prototype.atan=function(){return this.throwIfDisposed(),uD(this)};xe().prototype.atan2=function(e){return this.throwIfDisposed(),cD(this,e)};xe().prototype.atanh=function(){return this.throwIfDisposed(),dD(this)};xe().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Gu(this,e,t,n,r)};xe().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),ww(this,e,t)};xe().prototype.batchNorm=function(e,t,n,r,i){return this.throwIfDisposed(),Zf(this,e,t,n,r,i)};xe().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Pp(this,e)};xe().prototype.cast=function(e){return this.throwIfDisposed(),Me(this,e)};xe().prototype.ceil=function(){return this.throwIfDisposed(),vD(this)};xe().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),Yi(this,e,t)};xe().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof zt&&(e=[e]),Wn([this,...e],t)};xe().prototype.conv1d=function(e,t,n,r,i,a){return this.throwIfDisposed(),c$(this,e,t,n,r,i,a)};xe().prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),d$(this,e,t,n,r,i)};xe().prototype.conv2d=function(e,t,n,r,i,a){return this.throwIfDisposed(),ga(this,e,t,n,r,i,a)};xe().prototype.cos=function(){return this.throwIfDisposed(),xw(this)};xe().prototype.cosh=function(){return this.throwIfDisposed(),p$(this)};xe().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),l1(this,e,t,n)};xe().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),h$(this,e,t,n)};xe().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),ID(this,e,t)};xe().prototype.depthwiseConv2d=function(e,t,n,r,i,a){return this.throwIfDisposed(),Xf(this,e,t,n,r,i,a)};xe().prototype.dilation2d=function(e,t,n,r,i){return this.throwIfDisposed(),$D(this,e,t,n,r,i)};xe().prototype.divNoNan=function(e){return this.throwIfDisposed(),TD(this,e)};xe().prototype.div=function(e){return this.throwIfDisposed(),et(this,e)};xe().prototype.dot=function(e){return this.throwIfDisposed(),ND(this,e)};xe().prototype.elu=function(){return this.throwIfDisposed(),Dv(this)};xe().prototype.equal=function(e){return this.throwIfDisposed(),ms(this,e)};xe().prototype.erf=function(){return this.throwIfDisposed(),ED(this)};xe().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),AD(this,e,t)};xe().prototype.exp=function(){return this.throwIfDisposed(),Qi(this)};xe().prototype.expandDims=function(e){return this.throwIfDisposed(),hi(this,e)};xe().prototype.expm1=function(){return this.throwIfDisposed(),MD(this)};xe().prototype.fft=function(){return this.throwIfDisposed(),Ow(this)};xe().prototype.flatten=function(){return this.throwIfDisposed(),oe(this,[this.size])};xe().prototype.floor=function(){return this.throwIfDisposed(),Fv(this)};xe().prototype.floorDiv=function(e){return this.throwIfDisposed(),l$(this,e)};xe().prototype.gather=function(e,t,n){return this.throwIfDisposed(),zv(this,e,t,n)};xe().prototype.greaterEqual=function(e){return this.throwIfDisposed(),qu(this,e)};xe().prototype.greater=function(e){return this.throwIfDisposed(),Sa(this,e)};xe().prototype.ifft=function(){return this.throwIfDisposed(),iy(this)};xe().prototype.irfft=function(){return this.throwIfDisposed(),$$(this)};xe().prototype.isFinite=function(){return this.throwIfDisposed(),RD(this)};xe().prototype.isInf=function(){return this.throwIfDisposed(),DD(this)};xe().prototype.isNaN=function(){return this.throwIfDisposed(),LD(this)};xe().prototype.leakyRelu=function(e){return this.throwIfDisposed(),kw(this,e)};xe().prototype.lessEqual=function(e){return this.throwIfDisposed(),Md(this,e)};xe().prototype.less=function(e){return this.throwIfDisposed(),ey(this,e)};xe().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),FD(this,e,t,n,r)};xe().prototype.logSigmoid=function(){return this.throwIfDisposed(),zD(this)};xe().prototype.logSoftmax=function(e){return this.throwIfDisposed(),g$(this,e)};xe().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),Cw(this,e,t)};xe().prototype.log=function(){return this.throwIfDisposed(),gs(this)};xe().prototype.log1p=function(){return this.throwIfDisposed(),Sw(this)};xe().prototype.logicalAnd=function(e){return this.throwIfDisposed(),ho(this,e)};xe().prototype.logicalNot=function(){return this.throwIfDisposed(),Iw(this)};xe().prototype.logicalOr=function(e){return this.throwIfDisposed(),y$(this,e)};xe().prototype.logicalXor=function(e){return this.throwIfDisposed(),BD(this,e)};xe().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),jt(this,e,t,n)};xe().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),oi(this,e,t,n,r)};xe().prototype.max=function(e,t){return this.throwIfDisposed(),Ms(this,e,t)};xe().prototype.maximum=function(e){return this.throwIfDisposed(),Xl(this,e)};xe().prototype.mean=function(e,t){return this.throwIfDisposed(),vr(this,e,t)};xe().prototype.min=function(e,t){return this.throwIfDisposed(),Qg(this,e,t)};xe().prototype.minimum=function(e){return this.throwIfDisposed(),cd(this,e)};xe().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),VD(this,e,t)};xe().prototype.mod=function(e){return this.throwIfDisposed(),jD(this,e)};xe().prototype.mul=function(e){return this.throwIfDisposed(),ae(this,e)};xe().prototype.neg=function(){return this.throwIfDisposed(),Yn(this)};xe().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Lv(this,e,t,n)};xe().prototype.notEqual=function(e){return this.throwIfDisposed(),lh(this,e)};xe().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),ty(this,e,t,n)};xe().prototype.onesLike=function(){return this.throwIfDisposed(),ys(this)};xe().prototype.pad=function(e,t){return this.throwIfDisposed(),al(this,e,t)};xe().prototype.pool=function(e,t,n,r,i,a){return this.throwIfDisposed(),UD(this,e,t,n,r,i,a)};xe().prototype.pow=function(e){return this.throwIfDisposed(),Du(this,e)};xe().prototype.prelu=function(e){return this.throwIfDisposed(),Nw(this,e)};xe().prototype.prod=function(e,t){return this.throwIfDisposed(),HD(this,e,t)};xe().prototype.reciprocal=function(){return this.throwIfDisposed(),XD(this)};xe().prototype.relu=function(){return this.throwIfDisposed(),On(this)};xe().prototype.relu6=function(){return this.throwIfDisposed(),w$(this)};xe().prototype.reshapeAs=function(e){return this.throwIfDisposed(),oe(this,e.shape)};xe().prototype.reshape=function(e){return this.throwIfDisposed(),oe(this,e)};xe().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),hte(this,e,t,n)};xe().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),fte(this,e,t,n)};xe().prototype.reverse=function(e){return this.throwIfDisposed(),zs(this,e)};xe().prototype.rfft=function(){return this.throwIfDisposed(),Pw(this)};xe().prototype.round=function(){return this.throwIfDisposed(),x$(this)};xe().prototype.rsqrt=function(){return this.throwIfDisposed(),_$(this)};xe().prototype.selu=function(){return this.throwIfDisposed(),k$(this)};xe().prototype.separableConv2d=function(e,t,n,r,i,a){return this.throwIfDisposed(),Bv(this,e,t,n,r,i,a)};xe().prototype.sigmoid=function(){return this.throwIfDisposed(),lo(this)};xe().prototype.sign=function(){return this.throwIfDisposed(),JD(this)};xe().prototype.sin=function(){return this.throwIfDisposed(),S$(this)};xe().prototype.sinh=function(){return this.throwIfDisposed(),C$(this)};xe().prototype.slice=function(e,t){return this.throwIfDisposed(),nn(this,e,t)};xe().prototype.softmax=function(e){return this.throwIfDisposed(),Dd(this,e)};xe().prototype.softplus=function(){return this.throwIfDisposed(),Jf(this)};xe().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Tw(this,e,t)};xe().prototype.split=function(e,t){return this.throwIfDisposed(),La(this,e,t)};xe().prototype.sqrt=function(){return this.throwIfDisposed(),Ai(this)};xe().prototype.square=function(){return this.throwIfDisposed(),zn(this)};xe().prototype.squaredDifference=function(e){return this.throwIfDisposed(),T$(this,e)};xe().prototype.squeeze=function(e){return this.throwIfDisposed(),Ld(this,e)};xe().prototype.stack=function(e,t){this.throwIfDisposed();let n=e instanceof zt?[this,e]:[this,...e];return Wr(n,t)};xe().prototype.step=function(e){return this.throwIfDisposed(),Yf(this,e)};xe().prototype.stridedSlice=function(e,t,n,r,i,a,s,o){return this.throwIfDisposed(),YD(this,e,t,n,r,i,a,s,o)};xe().prototype.sub=function(e){return this.throwIfDisposed(),Ve(this,e)};xe().prototype.sum=function(e,t){return this.throwIfDisposed(),lt(this,e,t)};xe().prototype.tan=function(){return this.throwIfDisposed(),QD(this)};xe().prototype.tanh=function(){return this.throwIfDisposed(),sh(this)};xe().prototype.tile=function(e){return this.throwIfDisposed(),ss(this,e)};xe().prototype.toBool=function(){return this.throwIfDisposed(),Me(this,"bool")};xe().prototype.toFloat=function(){return this.throwIfDisposed(),Me(this,"float32")};xe().prototype.toInt=function(){return this.throwIfDisposed(),Me(this,"int32")};xe().prototype.topk=function(e,t){return this.throwIfDisposed(),tL(this,e,t)};xe().prototype.transpose=function(e){return this.throwIfDisposed(),Ut(this,e)};xe().prototype.unique=function(e){return this.throwIfDisposed(),nL(this,e)};xe().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),A$(this,e,t)};xe().prototype.unstack=function(e){return this.throwIfDisposed(),Ir(this,e)};xe().prototype.where=function(e,t){return this.throwIfDisposed(),yi(e,this,t)};xe().prototype.zerosLike=function(){return this.throwIfDisposed(),sn(this)};var wc=class qte extends Error{constructor(t){super(t),Object.setPrototypeOf(this,qte.prototype)}},El=class Kte extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Kte.prototype)}},de=class Zte extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Zte.prototype)}},qt=class Xte extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Xte.prototype)}},xje=class Jte extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Jte.prototype)}},Yte=class{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}};function ch(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{let n=new Array(t);return n.fill(e),n}}function kl(e,t){if(!e)throw new xje(t)}function mU(e,t){let n=0;for(let r of e)r===t&&n++;return n}function Pa(e){return e.length===1?e[0]:e}function En(e){return Array.isArray(e)?e:[e]}function mu(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function fp(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}var Xs={};function xL(e){if(e==null)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function $P(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>$P(t));else{let t=Object.keys(e);for(let n of t){let r=e[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?e[n]=r.value:$P(r))}}}function Mw(e,t={},n={},r="object",i=!1){if(typeof e=="string"){let a=e,s;if(a in n)s=n[a];else if(a in Xs)s=Xs[a];else if(s=t[a],s==null)throw new de(`Unknown ${r}: ${e}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return s}else{let a=e;if(a.className==null||a.config==null)throw new de(`${r}: Improper config format: ${JSON.stringify(a)}.
'className' and 'config' must set.`);let s=a.className,o,l;if(s in n?[o,l]=n[s]:s in Xs?[o,l]=Xs.className:s in t&&([o,l]=t[s]),o==null)throw new de(`Unknown ${r}: ${s}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){let u={};for(let h of Object.keys(Xs))u[h]=Xs[h];for(let h of Object.keys(n))u[h]=n[h];let c=a.config;c.customObjects=u;let d=Object.assign({},Xs);for(let h of Object.keys(n))Xs[h]=n[h];$P(a.config);let p=l(o,a.config,n,i);return Xs=Object.assign({},d),p}else{let u=Object.assign({},Xs);for(let d of Object.keys(n))Xs[d]=n[d];let c=new o(a.config);return Xs=Object.assign({},u),c}}}function _je(e,t){return e<t?-1:e>t?1:0}function l_(e,t){return-1*_je(e,t)}function Xc(e){if(e==null)return e;let t=[];for(let n of e)t.indexOf(n)===-1&&t.push(n);return t}function kje(e){if(e==null)throw new de(`Invalid value in obj: ${JSON.stringify(e)}`);for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function Qf(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new de(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function _L(e,t,n=0,r=1/0){return kl(n>=0),kl(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(i=>typeof i===t)}function mi(e,t){Array.isArray(e)?(P.assert(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,r)=>mi(n,`element ${r+1} of ${t}`))):P.assert(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${Qte(e)}.`)}function Qte(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>Qte(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function Sje(e,t,n){let r=n!=null?n():P.now(),i;return(...a)=>{let s=n!=null?n():P.now();return s-r<t||(r=s,i=e(...a)),i}}function ene(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}var Cje=0;function tne(){return Cje++}var u_={};function B$(e=""){return e in u_||(u_[e]=0),u_[e]+=1,e+u_[e].toString()}var Ije=["channelsFirst","channelsLast"],$je=["nearest","bilinear"],Tje=["valid","same","causal"],Nje=["max","avg"],Eje=["sum","mul","concat","ave"],Dm=new Map;function Ar(e){Qf(Ije,"DataFormat",e)}function Oje(e){Qf($je,"InterpolationFormat",e)}function Hs(e){Qf(Tje,"PaddingMode",e)}function nne(e){Qf(Nje,"PoolMode",e)}var _b=[],gU="/";function Ap(e,t){_b.push(e);try{let n=t();return _b.pop(),n}catch(n){throw _b.pop(),n}}function Pje(){return _b.length===0?"":_b.join(gU)+gU}function rne(e){if(!ane(e))throw new Error("Not a valid tensor name: '"+e+"'");return Pje()+e}function ine(e){if(!ane(e))throw new Error("Not a valid tensor name: '"+e+"'");Dm.has(e)||Dm.set(e,0);let t=Dm.get(e);if(Dm.set(e,Dm.get(e)+1),t>0){let n=`${e}_${t}`;return Dm.set(n,1),n}else return e}var Aje=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function ane(e){return!!e.match(Aje)}function Mje(e){return e===parseInt(e.toString(),10)}function Jc(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let r=1;for(let i=t;i<n;++i)r*=e[i];return r}function sy(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r<t&&(t=r)}return t}function pd(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r>t&&(t=r)}return t}function Yo(e,t){if(t<e)throw new de(`end (${t}) < begin (${e}) is forbidden.`);let n=[];for(let r=e;r<t;++r)n.push(r);return n}var rE;function Yr(){return rE==null&&(rE=eD().epsilon()),rE}function Qo(){return"channelsLast"}function Lu(e,t){return Me(e,t)}function Rw(e,t=-1){let n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),oe(e,n)}function Rje(e,t){return le(()=>{if(e.shape.length!==2)throw new de(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);let n=Rw(e,1);return TP(n,[1,t,1])})}function Dje(e){let t=[Jc(e.shape)];return oe(e,t)}function Lje(e){if(e.rank<=1)throw new de(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);let t=[e.shape[0],Jc(e.shape,1)];return oe(e,t)}function Mp(e,t,n){return le(()=>{switch(e.rank){case 1:return Ew(e,t,n);case 2:return I$(e,[t,0],[n,e.shape[1]]);case 3:return Wv(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return ry(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return nn(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return nn(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new de(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function iE(e,t,n){return le(()=>{switch(e.rank){case 1:return Ew(e,t,n);case 2:return I$(e,[0,t],[e.shape[0],n]);case 3:return Wv(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return ry(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new de(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function c_(e,t,n,r){return le(()=>{switch(e.rank){case 1:return Ew(e,t,n);case 2:switch(r){case 1:return Mp(e,t,n);case 2:return iE(e,t,n);default:throw new de(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Mp(e,t,n);case 2:return Wv(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return iE(e,t,n);default:throw new de(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Mp(e,t,n);case 2:return ry(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return ry(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return iE(e,t,n);default:throw new de(`The axis is not within the rank of the tensor ${r}`)}default:throw new de(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function kL(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),Wn(e,t)}function yU(e,t){switch(e.rank){case 1:return bD([e,t]);case 2:return wD([e,t],0);case 3:return xD([e,t],0);case 4:return _D([e,t],0);default:throw new de(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function TP(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new de(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return ss(e,t)}function W$(e,t=0,n=1,r,i){return b$(e,t,n,r,i)}function Bl(e,t,n,r){if(e.rank<2||t.rank<2)throw new qt(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){let i=e.shape.slice(-1)[0],a=t.shape.slice(-2)[0];if(i!==a)throw new qt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return ay.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?NP(e.rank,r,Qo()):null,activation:n});{let i=e.shape.slice(),a=i.pop();e=oe(e,[-1,a]);let s=t.shape.slice(),o=s.pop(),l=s.pop(),u=[...s,o],c=Array.from({length:t.rank},(p,h)=>h===0?t.rank-2:h<=t.rank-2?h-1:h);t=oe(Ut(t,c),[l,-1]);let d=[...i,...u];return oe(ay.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?NP(e.rank,r,Qo()):null,activation:n}),d)}}function sne(e,t,n){return le(()=>(Array.isArray(t)?t=Cn(t,"int32"):t=Me(t,"int32"),zv(e,t,n)))}function Dw(e){return ae(e,e)}function NP(e,t,n){let r=t.shape;if(t.rank!==1&&t.rank!==e)throw new de(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return r.length===1?oe(t,[1,r[0],1,1,1]):oe(t,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?oe(t,[1,1,1,1,r[0]]):oe(t,[1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?oe(t,[1,r[0],1,1]):oe(t,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?oe(t,[1,1,1,r[0]]):oe(t,[1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?oe(t,[1,r[0],1]):oe(t,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?oe(t,[1,1,r[0]]):oe(t,[1].concat(r))}else if(e<3)return t;throw new de(`Unsupported input rank by biasAdd: ${t.rank}`)}function sl(e,t,n){return le(()=>(n==null&&(n=Qo()),Ar(n),we(e,NP(e.rank,t,n))))}function Fje(e,t=1){if(t!==1)throw new qt(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return Dv(e)}function zje(e){return le(()=>et(e,we(Dr(e),1)))}function one(e,t,n,r){return le(()=>aL(e,t,n,r))}function Bje(e){return le(()=>{let t=we(.5,ae(.2,e));return Yi(t,0,1)})}function Lw(e,t,n=!1){return n?e():t()}var Wje=["fanIn","fanOut","fanAvg"],Vje=["normal","uniform","truncatedNormal"];function jje(e){Qf(Wje,"FanMode",e)}function Uje(e){Qf(Vje,"Distribution",e)}var vo=class extends $e.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},SL=class extends vo{apply(e,t){return br(e,t)}};SL.className="Zeros";$e.registerClass(SL);var V$=class extends vo{apply(e,t){return Aa(e,t)}};V$.className="Ones";$e.registerClass(V$);var CL=class extends vo{constructor(e){if(super(),typeof e!="object")throw new de(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new de(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return le(()=>ae(yt(this.value),Aa(e,t)))}getConfig(){return{value:this.value}}};CL.className="Constant";$e.registerClass(CL);var IL=class extends vo{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Rd(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}};IL.className="RandomUniform";$e.registerClass(IL);var $L=class extends vo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new qt(`randomNormal does not support dType ${t}.`);return W$(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};$L.className="RandomNormal";$e.registerClass($L);var TL=class extends vo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new qt(`truncatedNormal does not support dType ${t}.`);return P$(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};TL.className="TruncatedNormal";$e.registerClass(TL);var NL=class extends vo{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return le(()=>{if(e.length!==2||e[0]!==e[1])throw new de("Identity matrix initializer can only be used for 2D square matrices.");return ae(this.gain,f$(e[0]))})}getConfig(){return{gain:this.gain}}};NL.className="Identity";$e.registerClass(NL);function Hje(e,t="channelsLast"){let n,r;if(Ar(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){let i=Jc(e,2);n=e[1]*i,r=e[0]*i}else if(t==="channelsLast"){let i=Jc(e,0,e.length-2);n=e[e.length-2]*i,r=e[e.length-1]*i}}else{let i=Jc(e);n=Math.sqrt(i),r=Math.sqrt(i)}return[n,r]}var Ba=class extends vo{constructor(e){if(super(),e.scale<0)throw new de(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,jje(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Uje(this.distribution),this.seed=e.seed}apply(e,t){let n=Hje(e),r=n[0],i=n[1],a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,r):this.mode==="fanOut"?a/=Math.max(1,i):a/=Math.max(1,(r+i)/2),this.distribution==="normal"){let s=Math.sqrt(a);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new qt(`${this.getClassName()} does not support dType ${t}.`);return P$(e,0,s,t,this.seed)}else{let s=Math.sqrt(3*a);return Rd(e,-s,s,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}};Ba.className="VarianceScaling";$e.registerClass(Ba);var j$=class extends Ba{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Ba.className}};j$.className="GlorotUniform";$e.registerClass(j$);var U$=class extends Ba{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Ba.className}};U$.className="GlorotNormal";$e.registerClass(U$);var H$=class extends Ba{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Ba.className}};H$.className="HeNormal";$e.registerClass(H$);var G$=class extends Ba{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Ba.className}};G$.className="HeUniform";$e.registerClass(G$);var q$=class extends Ba{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Ba.className}};q$.className="LeCunNormal";$e.registerClass(q$);var K$=class extends Ba{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Ba.className}};K$.className="LeCunUniform";$e.registerClass(K$);var EL=class extends vo{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return le(()=>{if(e.length<2)throw new qt("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;let n=P.sizeFromShape(e.slice(0,-1)),r=e[e.length-1],i=n*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);let a=[Math.max(r,n),Math.min(r,n)],s=W$(a,0,1,t,this.seed),o=uL.qr(s,!1),l=o[0],u=o[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return l=ae(l,u.sign()),n<r&&(l=l.transpose()),ae(yt(this.gain),l.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}};EL.className="Orthogonal";$e.registerClass(EL);var vU={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function bU(e,t={}){return Mw(e,$e.SerializationMap.getMap().classNameMap,t,"initializer")}function wr(e){return xL(e)}function hr(e){if(typeof e=="string"){let t=e in vU?vU[e]:e;if(t==="GlorotNormal")return new U$;if(t==="GlorotUniform")return new j$;if(t==="HeNormal")return new H$;if(t==="HeUniform")return new G$;if(t==="LeCunNormal")return new q$;if(t==="LeCunUniform")return new K$;{let n={};return n.className=t,n.config={},bU(n)}}else return e instanceof vo?e:bU(e)}function EP(e){return Array.isArray(e)&&Array.isArray(e[0])}function XC(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function Tt(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new de(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function pn(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new de(`Expected exactly 1 Shape; got ${e.length}`)}else return e}function JC(e){let t=0;for(let n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((r,i)=>r*i);return t}var wU="Variable",lne=class{constructor(e,t="float32",n=wU,r=!0,i=null){this.dtype=t==null?"float32":t,this.shape=e.shape,this.id=tne(),n=n==null?wU:n,this.originalName=rne(n),this.name=ine(this.originalName),this.trainable_=r,this.constraint=i,this.val=rL(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),Gje(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}};function Gje(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function OP(e){return e.map(t=>t.read())}function OL(e){e.forEach(t=>{t[0].write(t[1])})}var zr=class{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}},el=class{constructor(e,t,n,r,i,a,s){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=s,this.id=tne(),a!=null&&(this.originalName=rne(a),this.name=ine(this.originalName)),this.rank=t.length}},qje=0,Z$=class{constructor(e,t){this.callArgs=t,this.id=qje++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(let n of e.inboundLayers)n!=null&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){let e=[];for(let t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},Kje=0,Xt=class extends $e.Serializable{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Kje++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let n=this.getClassName();t=mu(n)+"_"+B$(n)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let n;if(e.batchInputShape!=null)n=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),n=[i].concat(e.inputShape)}this.batchInputShape=n;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new El(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new de(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Pa(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Pa(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new wc(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new wc(`Layer ${this.name} is not connected, no input to return.`);return Pa(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new wc(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new wc(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Pa(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){let t=En(e);if(this.inputSpec==null||this.inputSpec.length===0)return;let n=En(this.inputSpec);if(t.length!==n.length)throw new de(`Layer ${this.name} expects ${n.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let r=0;r<t.length;r++){let i=t[r],a=n[r];if(a==null)continue;let s=i.rank;if(a.ndim!=null&&s!==a.ndim)throw new de(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${a.ndim}, found ndim=${s}`);if(a.maxNDim!=null&&s>a.maxNDim)throw new de(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${a.maxNDim}, found ndim=${s}`);if(a.minNDim!=null&&s<a.minNDim)throw new de(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${a.minNDim}, found ndim=${s}.`);if(a.dtype!=null&&i.dtype!==a.dtype)throw new de(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${a.dtype}, found dtype=${i.dtype}.`);if(a.axes){let o=i.shape;for(let l in a.axes){let u=Number(l),c=a.axes[l],d=u>=0?o[u]:o[o.length+u];if(c!=null&&[c,null].indexOf(d)===-1)throw new de(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${c} but got shape ${o}.`)}}if(a.shape!=null)for(let o=0;o<a.shape.length;++o){let l=a.shape[o],u=i.shape[o];if(l!=null&&u!=null&&l!==u)throw new de(`Input ${r} is incompatible with layer ${this.name}: expected shape=${a.shape}, found shape=${i.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();let n=En(e),r=Jje(e),i=Yje(e);if(r===i)throw new de("Arguments to apply() must be all SymbolicTensors or all Tensors");return Ap(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);let a=[];for(let s of En(e))a.push(s.shape);this.build(Pa(a)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let a=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,a);let s=En(a),o=[];for(let l of s)n.indexOf(l)!==-1&&(l=l.clone()),o.push(l);if(a=Pa(o),this.activityRegularizer!=null)throw new qt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}else{let a=Zje(e),s=this.computeOutputShape(a),o,l=Xje(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?a[0]:a),s!=null&&s.length>0&&Array.isArray(s[0])?o=s.map((u,c)=>new el(l,u,this,En(e),t,this.name,c)):o=new el(l,s,this,En(e),t,this.name),this.addInboundNode(e,o,null,null,a,s,t),this._refCount++,this.activityRegularizer!=null)throw new qt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((n,r)=>{n!=null&&e[r]!=null&&e[r]!==n&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new wc(`The layer ${this.name} has never been called and thus has no defined output shape.`);let e=[];for(let t of this.inboundNodes){let n=JSON.stringify(t.outputShapes);e.indexOf(n)===-1&&e.push(n)}if(e.length===1){let t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new wc(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new El(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return JC(this.weights)}build(e){this.built=!0}getWeights(e=!1){return OP(e?this.trainableWeights:this.weights)}setWeights(e){le(()=>{let t=this.weights;if(t.length!==e.length)throw new de(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;let n=[],r=OP(t);for(let i=0;i<r.length;++i){let a=r[i],s=t[i],o=e[i];if(!P.arraysEqual(a.shape,o.shape))throw new de(`Layer weight shape ${a.shape} not compatible with provided weight shape ${o.shape}`);n.push([s,o])}OL(n)})}addWeight(e,t,n,r,i,a,s,o){if(this._addedWeightNames.indexOf(e)!==-1)throw new de(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),n==null&&(n="float32"),this.fastWeightInitDuringBuild&&(r=o!=null?o():hr("zeros"));let l=r.apply(t,n),u=new lne(l,n,e,a,s);return l.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),a==null&&(a=!0),a?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=En(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(n=>{if(n!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;let r=this.computeMask(e,n),i=En(t),a=En(r);if(i.length!==a.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let s=0;s<i.length;s++)i[s].kerasMask=a[s]}addInboundNode(e,t,n,r,i,a,s=null){let o=En(e);t=En(t),n=En(n),r=En(r),i=XC(i),a=XC(a);let l=[],u=[],c=[];for(let d of o)l.push(d.sourceLayer),u.push(d.nodeIndex),c.push(d.tensorIndex);new Z$({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:c,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:a},s);for(let d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}getConfig(){let e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function Zje(e){e=En(e);let t=[];for(let n of e)t.push(n.shape);return Pa(t)}function Xje(e){return"float32"}function une(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{let r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{let i=[];for(let a=0;a<r.inboundLayers.length;a++){let s=r.inputTensors[a],o=r.inboundLayers[a],l=r.nodeIndices[a],u=une(s,o,l);for(let c of u)i.indexOf(c)===-1&&i.push(c)}return i}}}function Jje(e){let t=!0;for(let n of En(e))if(!(n instanceof el)){t=!1;break}return t}function Yje(e){let t=!0;for(let n of En(e))if(n instanceof el){t=!1;break}return t}var jv=class extends Xt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:B$("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new de("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new de("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new de("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];let r=new el(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Z$({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new de(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}};jv.className="InputLayer";$e.registerClass(jv);function cne(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new de("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new jv({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function Qje(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return Me(t,e.dtype)}catch{throw new de(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}var og=class dne{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof dne)for(let n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(let n of t)this.add(n.key,n.value)}}add(t,n,r){if(this.id2Value[t.id]==null)this.id2Value[t.id]=Qje(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r);else throw new de(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof el){if(this.id2Value[t.id]==null)throw new de(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{let n=this.name2Id[t];if(n==null)throw new de(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof el){if(this.id2Value[t.id]==null)throw new de(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{let n=this.name2Id[t];if(n==null)throw new de(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Rt(this.id2Mask)}},YC=new Yte,QC=new Yte;function eUe(e){YC!=null&&YC.setMaxEntries(e),QC!=null&&QC.setMaxEntries(e)}function Q0(e,t,n,r){let i=n==null?!1:n.training,a=Array.isArray(e),s=a?e:[e],o=s.map(m=>m.name),l=[],u=t.names();for(let m of o)u.indexOf(m)!==-1?l.push(t.getValue(m)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);let c=o.join(",")+"|"+t.names().sort().join(","),d=YC.get(c),p;if(d==null){let m=tUe(s,t);d=m.sorted,p=m.recipientCounts,YC.put(c,d),QC.put(c,p)}p={},i||Object.assign(p,QC.get(c));let h=new og(t);for(let m=0;m<d.length;++m){if(r!=null){let D=qC().numTensors;D>r.maxNumTensors&&(r.maxNumTensors=D),D<r.minNumTensors&&(r.minNumTensors=D)}let g=d[m],v=g.sourceLayer;if(v instanceof jv)continue;let y=[],b=[],_=[],k=!1;for(let D of g.inputs){let O=h.getValue(D),F=h.getMask(D);y.push(O),b.push(F),F!=null&&(k=!0),i||(p[D.name]--,p[D.name]===0&&!t.hasKey(D)&&o.indexOf(D.name)===-1&&!O.isDisposed&&D.sourceLayer.stateful!==!0&&_.push(O))}k&&(n=n||{},n.mask=b[0]);let C=En(v.apply(y,n)),$=null;v.supportsMasking&&($=v.computeMask(y,b));let N=rUe(g),A=Array.isArray(N)?N:[N];for(let D=0;D<A.length;++D){h.hasKey(A[D])||h.add(A[D],C[D],Array.isArray($)?$[0]:$);let O=o.indexOf(A[D].name);O!==-1&&(l[O]=C[D])}i||Rt(_)}return h.disposeMasks(),a?l:l[0]}function tUe(e,t){P.assert(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(e.length===1){let i=xU(e[0],t);n=i.sorted,r=i.recipientMap}else{let i=new Set;for(let a of e){let{sorted:s,recipientMap:o}=xU(a,t);for(let l of s)i.has(l.name)||(n.push(l),i.add(l.name));for(let l in o)r[l]==null&&(r[l]=new Set),o[l].forEach(u=>r[l].add(u))}}return{sorted:n,recipientCounts:nUe(r)}}function nUe(e){let t={};for(let n in e)t[n]=e[n].size;return t}function xU(e,t){let n=new Set,r=[],i={};for(let o of t.names())n.add(o);let a=[],s=[];for(a.push(e);a.length>0;){let o=a[a.length-1];if(n.has(o.name)){a.pop();continue}let l=s[s.length-1]===a.length-1;if(o.inputs.length===0||l)a.pop(),r.push(o),n.add(o.name),l&&s.pop();else{s.push(a.length-1);for(let u of o.inputs)i[u.name]==null&&(i[u.name]=new Set),i[u.name].add(o.name),!n.has(u.name)&&a.push(u)}}return{sorted:r,recipientMap:i}}function rUe(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(let i of e.sourceLayer.inboundNodes[r].outputTensors)if(i.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var iUe=he();iUe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,eUe);var pne={};Dt(pne,{maxNorm:()=>aUe,minMaxNorm:()=>lUe,nonNeg:()=>oUe,unitNorm:()=>sUe});function PL(e,t){return le(()=>Ai(lt(ae(e,e),t,!0)))}var Fw=class extends $e.Serializable{getConfig(){return{}}},AL=class extends Fw{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return le(()=>{let t=PL(e,this.axis),n=Yi(t,0,this.maxValue);return ae(e,et(n,we(Yr(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}};AL.className="MaxNorm";$e.registerClass(AL);var ML=class extends Fw{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return le(()=>et(e,we(Yr(),PL(e,this.axis))))}getConfig(){return{axis:this.axis}}};ML.className="UnitNorm";$e.registerClass(ML);var RL=class extends Fw{apply(e){return On(e)}};RL.className="NonNeg";$e.registerClass(RL);var DL=class extends Fw{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return le(()=>{let t=PL(e,this.axis),n=we(ae(this.rate,Yi(t,this.minValue,this.maxValue)),ae(1-this.rate,t));return ae(e,et(n,we(Yr(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}};DL.className="MinMaxNorm";$e.registerClass(DL);var _U={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function ti(e){return xL(e)}function kU(e,t={}){return Mw(e,$e.SerializationMap.getMap().classNameMap,t,"constraint")}function ni(e){if(e==null)return null;if(typeof e=="string"){let t={className:e in _U?_U[e]:e,config:{}};return kU(t)}else return e instanceof Fw?e:kU(e)}function aUe(e){return new AL(e)}function sUe(e){return new ML(e)}function oUe(){return new RL}function lUe(e){return new DL(e)}var hne={};Dt(hne,{constant:()=>dUe,glorotNormal:()=>vUe,glorotUniform:()=>yUe,heNormal:()=>bUe,heUniform:()=>wUe,identity:()=>mUe,leCunNormal:()=>xUe,leCunUniform:()=>_Ue,ones:()=>cUe,orthogonal:()=>kUe,randomNormal:()=>hUe,randomUniform:()=>pUe,truncatedNormal:()=>fUe,varianceScaling:()=>gUe,zeros:()=>uUe});function uUe(){return new SL}function cUe(){return new V$}function dUe(e){return new CL(e)}function pUe(e){return new IL(e)}function hUe(e){return new $L(e)}function fUe(e){return new TL(e)}function mUe(e){return new NL(e)}function gUe(e){return new Ba(e)}function yUe(e){return new j$(e)}function vUe(e){return new U$(e)}function bUe(e){return new H$(e)}function wUe(e){return new G$(e)}function xUe(e){return new q$(e)}function _Ue(e){return new K$(e)}function kUe(e){return new EL(e)}var fne={};Dt(fne,{Layer:()=>Xt,RNN:()=>Xu,RNNCell:()=>Bw,activation:()=>QHe,add:()=>l8e,alphaDropout:()=>H8e,average:()=>u8e,averagePooling1d:()=>KF,averagePooling2d:()=>ZF,averagePooling3d:()=>XF,avgPool1d:()=>v8e,avgPool2d:()=>w8e,avgPool3d:()=>_8e,avgPooling1d:()=>b8e,avgPooling2d:()=>x8e,avgPooling3d:()=>k8e,batchNormalization:()=>m8e,bidirectional:()=>L8e,categoryEncoding:()=>X8e,centerCrop:()=>K8e,concatenate:()=>c8e,conv1d:()=>UHe,conv2d:()=>HHe,conv2dTranspose:()=>GHe,conv3d:()=>qHe,conv3dTranspose:()=>KHe,convLstm2d:()=>A8e,convLstm2dCell:()=>M8e,cropping2D:()=>XHe,dense:()=>e8e,depthwiseConv2d:()=>YHe,dot:()=>f8e,dropout:()=>t8e,elu:()=>FHe,embedding:()=>o8e,flatten:()=>r8e,gaussianDropout:()=>U8e,gaussianNoise:()=>j8e,globalAveragePooling1d:()=>S8e,globalAveragePooling2d:()=>C8e,globalMaxPool1d:()=>z8e,globalMaxPool2d:()=>B8e,globalMaxPooling1d:()=>fre,globalMaxPooling2d:()=>mre,gru:()=>$8e,gruCell:()=>T8e,input:()=>Pne,inputLayer:()=>LHe,layerNormalization:()=>g8e,leakyReLU:()=>BHe,lstm:()=>N8e,lstmCell:()=>E8e,masking:()=>G8e,maxPool1d:()=>W8e,maxPool2d:()=>V8e,maxPooling1d:()=>gre,maxPooling2d:()=>yre,maxPooling3d:()=>I8e,maximum:()=>d8e,minimum:()=>p8e,multiply:()=>h8e,permute:()=>s8e,prelu:()=>WHe,randomWidth:()=>J8e,reLU:()=>zHe,repeatVector:()=>i8e,rescaling:()=>q8e,reshape:()=>a8e,resizing:()=>Z8e,rnn:()=>R8e,separableConv2d:()=>ZHe,simpleRNN:()=>O8e,simpleRNNCell:()=>P8e,softmax:()=>VHe,spatialDropout1d:()=>n8e,stackedRNNCells:()=>D8e,thresholdedReLU:()=>jHe,timeDistributed:()=>F8e,upSampling2d:()=>JHe,zeroPadding2d:()=>y8e});async function fc(e){if(e==null)return;let t=[],n=[],r=[];for(let i in e){let a=e[i];if(typeof a!="number"){let s=a;t.push(s.data()),n.push(i),r.push(s)}}if(t.length>0){let i=await Promise.all(t);for(let a=0;a<i.length;++a)e[n[a]]=i[a][0];Rt(r)}}function mne(e){if(e!=null)for(let t in e){let n=e[t];typeof n!="number"&&n.dispose()}}var SU;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(SU||(SU={}));var SUe=125,oy=class{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}},gne=class{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(let t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(let t of this.callbacks)await t.onTrainEnd(e)}},CUe=class extends oy{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});let n=t.size==null?0:t.size;this.seen+=n;for(let r in t){let i=t[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*n;else{let a;r in this.totals?a=this.totals[r]:this.totals[r]=0;let s=le(()=>we(this.totals[r],ae(i,n)));this.totals[r]=s,a!=null&&a.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(let n of this.params.metrics)this.totals[n]!=null&&(typeof this.totals[n]=="number"?t[n]=this.totals[n]/this.seen:le(()=>{let r=ae(et(1,this.seen),this.totals[n]);t[n]=r,this.totals[n].dispose(),Jr(t[n])}))}},yne=class extends oy{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(let n in t)this.history[n]==null&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){let e=[],t=[],n=[];for(let i in this.history){let a=this.history[i];for(let s=0;s<a.length;++s)if(typeof a[s]!="number"){let o=a[s];e.push(o.data()),t.push(i),n.push(s)}}let r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[t[i]][n[i]].dispose(),this.history[t[i]][n[i]]=r[i][0]}},vne=class extends oy{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||bL,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=SUe),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");P.isNumber(this.yieldEvery)&&(this.maybeWait=Sje(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){let r=[];this.yield!=null&&(await fc(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await fc(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let n=[];this.epochEnd!=null&&(await fc(t),n.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){this.batchBegin!=null&&(await fc(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let n=[];this.batchEnd!=null&&(await fc(t),n.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?n.push(this.nextFrameFunc()):P.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){this.trainBegin!=null&&(await fc(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await fc(e),await this.trainEnd(e))}};function bne(e,t){return e==null&&(e={}),e instanceof oy?[e]:Array.isArray(e)&&e[0]instanceof oy?e:En(e).map(n=>new vne(n,t))}var LL=class fl{constructor(){}static registerCallbackConstructor(t,n){P.assert(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),fl.checkForDuplicate(n),fl.constructors[t]==null&&(fl.constructors[t]=[]),fl.constructors[t].push(n)}static checkForDuplicate(t){for(let n in fl.constructors)fl.constructors[+n].forEach(r=>{if(r===t)throw new de("Duplicate callback constructor.")})}static clear(){fl.constructors={}}static createCallbacks(t){let n=[];for(let r in fl.constructors){let i=+r;t>=i&&n.push(...fl.constructors[i])}return n.map(r=>new r)}};LL.constructors={};function wne(e,t,n,r,i,a,s,o,l){let u=new yne,c=[new CUe,...LL.createCallbacks(t)];e!=null&&c.push(...e),c.push(u);let d=new gne(c);return d.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:s,verbose:t,doValidation:o,metrics:l}),{callbackList:d,history:u}}function Wo(e,t={},n=!1){return Mw(e,$e.SerializationMap.getMap().classNameMap,t,"layer",n)}function eI(e,t){return le(()=>{e.dtype!=="float32"&&(e=Me(e,"float32"));let n=lt(Dw(e),t,!0),r=ds(n.shape,Yr()),i=Ai(Xl(n,r));return et(e,i)})}function em(e,t){return le(()=>vr(Dw(Ve(t,e)),-1))}function X$(e,t){return le(()=>vr(Dr(Ve(t,e)),-1))}function Uv(e,t){return le(()=>{let n=Ve(e,t),r=Yi(Dr(e),Yr(),Number.MAX_VALUE),i=Dr(et(n,r));return ae(100,vr(i,-1))})}function IUe(e,t){return le(()=>{let n=Yi(t,Yr(),Number.MAX_VALUE),r=gs(we(1,n)),i=Yi(e,Yr(),Number.MAX_VALUE),a=gs(we(1,i));return vr(Dw(Ve(r,a)),-1)})}function $Ue(e,t){return le(()=>{let n=Xl(0,Ve(1,ae(e,t)));return vr(Dw(n),-1)})}function TUe(e,t){return le(()=>{let n=Xl(0,Ve(1,ae(e,t)));return vr(n,-1)})}function NUe(e,t){return le(()=>{let n=lt(ae(e,t),-1),r=Ms(ae(Ve(1,e),t),-1);return Xl(0,we(1,Ve(r,n)))})}function EUe(e,t){return le(()=>{let n=Math.log(2),r=Ve(t,e),i=Ve(we(r,Jf(ae(-2,r))),n);return vr(i,-1)})}function u1(e,t,n=!1){return le(()=>{if(n)t=Dd(t);else{let r=lt(t,t.shape.length-1,!0);t=et(t,r)}return t=Yi(t,Yr(),1-Yr()),Yn(lt(ae(Me(e,"float32"),gs(t)),t.shape.length-1))})}function tI(e,t,n=!1){return le(()=>{let r=Me(Fv(Dje(e)),"int32");t=Yi(t,Yr(),1-Yr());let i=t.shape,a=oe(ty(r,i[i.length-1]),i);return u1(a,t,n)})}function OUe(e,t){if(!P.arraysEqual(e.shape,t.shape))throw new de(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return le(()=>{let n=On(t),r=Yn(Dr(t));return we(Ve(n,ae(t,e)),Sw(Qi(r)))})}function J$(e,t){return le(()=>{let n;return n=Yi(t,Yr(),1-Yr()),n=gs(et(n,Ve(1,n))),vr(OUe(e,n),-1)})}function PUe(e,t){return le(()=>{let n=Yi(e,Yr(),1),r=Yi(t,Yr(),1);return lt(ae(e,gs(et(n,r))),-1)})}function AUe(e,t){return le(()=>{let n=gs(we(Yr(),t));return vr(Ve(t,ae(e,n)),-1)})}function FL(e,t){return le(()=>{let n=eI(e,-1),r=eI(t,-1),i=ae(n,r);return Yn(lt(i,-1))})}var nI={meanSquaredError:em,meanAbsoluteError:X$,meanAbsolutePercentageError:Uv,meanSquaredLogarithmicError:IUe,squaredHinge:$Ue,hinge:TUe,categoricalHinge:NUe,logcosh:EUe,categoricalCrossentropy:u1,sparseCategoricalCrossentropy:tI,binaryCrossentropy:J$,kullbackLeiblerDivergence:PUe,poisson:AUe,cosineProximity:FL};function aE(e){if(typeof e=="string"){if(e in nI)return nI[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new de(t)}else return e}function zL(e,t){return le(()=>{let n=ae(.5,ys(t)),r=Lu(Sa(t,n),e.dtype);return vr(ms(e,r),-1)})}function BL(e,t){return le(()=>Lu(ms(ih(e,-1),ih(t,-1)),"float32"))}function xne(e,t){return le(()=>Me(lt(ho(ms(e,1),ms(t,1))),"float32"))}function MUe(e,t){return le(()=>Me(lt(ho(ms(e,1),ms(t,0))),"float32"))}function RUe(e,t){return le(()=>Me(lt(ho(ms(e,0),ms(t,1))),"float32"))}function _ne(e,t){return le(()=>{let n=xne(e,t),r=RUe(e,t),i=we(n,r);return Me(yi(Sa(i,0),et(n,i),0),"float32")})}function DUe(e,t){return le(()=>{let n=xne(e,t),r=MUe(e,t),i=we(n,r);return Me(yi(Sa(i,0),et(n,i),0),"float32")})}function kne(e,t){return J$(e,t)}function Sne(e,t){return e.rank===t.rank&&(e=Ld(e,[e.rank-1])),t=ih(t,-1),t.dtype!==e.dtype&&(t=Me(t,e.dtype)),Me(ms(e,t),"float32")}var LUe=em,FUe=em,zUe=X$,BUe=X$,WUe=Uv,VUe=Uv,WL=u1,jUe=FL,Cne=tI,rI={binaryAccuracy:zL,categoricalAccuracy:BL,precision:_ne,categoricalCrossentropy:WL,sparseCategoricalCrossentropy:Cne,mse:LUe,MSE:FUe,mae:zUe,MAE:BUe,mape:WUe,MAPE:VUe,cosine:jUe};function UUe(e){if(typeof e=="string"&&e in rI)return rI[e];if(typeof e!="string"&&e!=null)return e;throw new de(`Unknown metric ${e}`)}function d_(e){if(kl(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(let n of Object.keys(nI))if(nI[n]===e){t=n;break}if(t!==void 0)return t;for(let n of Object.keys(rI))if(rI[n]===e){t=n;break}return t!==void 0?t:e.name}}function HUe(e){let t={Adagrad:()=>up.adagrad(.01),Adadelta:()=>up.adadelta(1,.95,Yr()),Adam:()=>up.adam(.001,.9,.999,Yr()),Adamax:()=>up.adamax(.002,.9,.999,Yr(),0),RMSProp:()=>up.rmsprop(.001,.9,0,Yr()),SGD:()=>up.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new de(`Unknown Optimizer ${e}`)}function CU(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!PP(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){let r=JSON.stringify(e);r.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function PP(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e);for(let n of t)if(typeof n!="string"||!PP(e[n]))return!1;return!0}else if(Array.isArray(e)){for(let t of e)if(!PP(t))return!1;return!0}else return!1;else{let t=typeof e;return t==="string"||t==="number"||t==="boolean"}}function GUe(e,t,n,r=console.log){let i=KUe(e),a=["Layer (type)","Input Shape","Output shape","Param #"];i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(t*c)));let s;if(!i){a.push("Receives inputs"),s=[];for(let c in e.nodesByDepth)s.push(...e.nodesByDepth[c])}r("_".repeat(t)),iI(a,n,r),r("=".repeat(t));let o=e.layers;for(let c=0;c<o.length;++c)i?ZUe(o[c],n,r):XUe(o[c],n,s,r),r((c===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let l=qUe(e),u=JC(e.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(t))}function qUe(e){let t;return e.collectedTrainableWeights!=null?t=JC(e.collectedTrainableWeights):t=JC(e.trainableWeights),t}function KUe(e){let t=!0,n=[],r=[];for(let i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(let i of n){if(i.length>1||i.length===1&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(let i of e.layers){let a=!1;for(let s of i.inboundNodes)if(r.indexOf(s)!==-1)if(a){t=!1;break}else a=!0;if(!t)break}return t}function iI(e,t,n=console.log){let r="";for(let i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=e[i],r=r.slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function ZUe(e,t,n){let r,i;try{i=e.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}let a=e.name,s=e.getClassName(),o=[`${a} (${s})`,i,r,e.countParams().toString()];iI(o,t,n)}function XUe(e,t,n,r){let i,a;try{a=e.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{a="multiple"}try{i=JSON.stringify(e.outputShape)}catch{i="multiple"}let s=[];for(let d of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let p=0;p<d.inboundLayers.length;++p){let h=d.inboundLayers[p].name,m=d.nodeIndices[p],g=d.tensorIndices[p];s.push(`${h}[${m}][${g}]`)}let o=e.name,l=e.getClassName(),u=s.length===0?"":s[0],c=[`${o} (${l})`,a,i,e.countParams().toString(),u];iI(c,t,r);for(let d=1;d<s.length;++d)iI(["","","","",s[d]],t,r)}function Ine(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function c1(e,t){if(e===null)return null;if(typeof e=="string")return fp(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let n=[],r=e.length;for(let i=0;i<r;++i){let a=e[i];Ine(t,i,a)?n.push(a):n.push(c1(a,t))}return n}else{let n={};for(let r of Object.keys(e)){let i=e[r];if(r==="name"&&typeof i=="string")n[r]=i;else{let a=fp(r);n[a]=c1(i,a)}}return n}}function AP(e,t){if(e==null)return null;if(typeof e=="string")return mu(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let n=[],r=e.length;for(let i=0;i<r;++i){let a=e[i];Ine(t,i,a)?n.push(a):n.push(AP(a,t))}return n}else{let n={};for(let r of Object.keys(e)){let i=e[r],a=mu(r);(r==="name"||r==="className")&&typeof i=="string"?n[a]=i:n[a]=AP(i,r)}return n}}var VL="4.16.0",JUe=e=>{let t=Object.keys(e);if(t.length===0)return!1;let n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))},YUe=class ml extends Xt{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){let b=this.getClassName().toLowerCase();this.name=B$(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],Xc(this.inputs).length!==this.inputs.length)throw new de(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);Xc(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let b of this.outputs){let _=b.sourceLayer,k=b.nodeIndex,C=b.tensorIndex;this.outputLayers.push(_),this.outputLayersNodeIndices.push(k),this.outputLayersTensorIndices.push(C)}for(let b of this.inputs){let _=b.sourceLayer,k=b.nodeIndex,C=b.tensorIndex;kl(k===0,"input layer has >1 nodes"),kl(C===0,"input layer has >1 tensors"),this.inputLayers.push(_),this.inputLayersNodeIndices.push(k),this.inputLayersTensorIndices.push(C)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){let _=this.inputLayers[b];if(!(_ instanceof jv))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${b} (0-based) originates from layer type ${_.getClassName()}.`);this.inputNames.push(_.name),this.feedInputShapes.push(_.batchInputShape),this.feedInputNames.push(_.name)}for(let b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);let n={},r={},i={},a={},s={},o=[],l=(b,_,k,C,$,N)=>{(C==null||$==null||N==null)&&(C=b.sourceLayer,$=b.nodeIndex,N=b.tensorIndex);let A=C.inboundNodes[$];if(k.indexOf(A)!==-1)throw new El(`The tensor ${b.name} at layer "${C.name}" is part of a cycle.`);if(_.indexOf(A)!==-1)return;this.containerNodes.add(ml.nodeKey(C,$)),C.id in s||(s[C.id]=Object.keys(s).length),k.indexOf(A)===-1&&k.push(A);let D=A.inboundLayers.length;for(let O=0;O<D;O++){let F=A.inputTensors[O],E=A.inboundLayers[O],z=A.nodeIndices[O],q=A.tensorIndices[O];l(F,_,k,E,z,q)}for(_.push(A);k.indexOf(A)>=0;)k.splice(k.indexOf(A),1);o.push(A)},u=[],c=[];for(let b of this.outputs)l(b,u,c);let d=o.slice().reverse();for(let b of d){r[b.id]=b,b.id in n||(n[b.id]=0);let _=n[b.id],k=i[b.outboundLayer.id]==null?0:i[b.outboundLayer.id];_=Math.max(_,k),i[b.outboundLayer.id]=_,a[b.outboundLayer.id]=b.outboundLayer,n[b.id]=_;for(let C=0;C<b.inboundLayers.length;C++){let $=b.inboundLayers[C],N=b.nodeIndices[C],A=$.inboundNodes[N],D=n[A.id]==null?0:n[A.id];n[A.id]=Math.max(_+1,D),r[A.id]=A}}let p={};for(let b in n){let _=n[b];_ in p||(p[_]=[]),p[_].push(r[b])}let h={};for(let b in i){let _=i[b];_ in h||(h[_]=[]),h[_].push(a[b])}let m=Object.keys(h).map(b=>parseInt(b,10)).sort(l_);this.layers=[];for(let b of m){let _=h[b];_.sort((k,C)=>{let $=s[k.id],N=s[C.id];return $<N?-1:$>N?1:0});for(let k of _)k instanceof ml&&this.internalContainerRefs.push(k),this.layers.push(k)}this.layersByDepth=h,m=Object.keys(p).map(b=>parseInt(b,10)).sort(l_);let g=this.inputs.slice(),v=[];for(let b of m)for(let _ of p[b]){let k=_.outboundLayer;if(k!=null){for(let C of _.inputTensors)if(g.indexOf(C)===-1)throw new El(`Graph disconnected: cannot obtain value for tensor ${C} at layer "${k.name}". The following previous layers were accessed without issue: ${v}`);for(let C of _.outputTensors)g.push(C);v.push(k.name)}}this.nodesByDepth=p;let y=this.layers.map(b=>b.name);for(let b of y){let _=y.filter(k=>k===b).length;if(_!==1)throw new El(`The name "${b}" is used ${_} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new Z$({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(let n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(let n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new de("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(let n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){let t=[];for(let n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){let n=[];for(let r of this.layers)n.push(...r.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){let r={},i=0,a=JUe(t);a&&this.parseWeights(t);for(let o of this.layers)for(let[l,u]of o.weights.entries()){let c=a?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(r[c]!=null)throw new de(`Duplicate weight name: ${c}`);r[c]=u,i++}let s=[];for(let o in t){let l=o;if(r[o]==null){let u=o.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(r[l]!=null)s.push([r[l],t[o]]);else if(n)throw new de(`Provided weight data has no target variable: ${o}`);delete r[l]}if(n){let o=[];for(let l in r)o.push(l);if(o.length>0)throw new de(`${o.length} of ${i} weights are not set: ${o}`)}OL(s)}parseWeights(t){for(let n in Object.keys(t)){let r=n.split("/"),i=["vars","layer_checkpoint_dependencies"],a=r.map(s=>s.startsWith("_")?s.slice(1):s).filter(s=>!i.includes(s)).join("/");a!==n&&(t[a]=t[n],delete t[n])}}updatedConfig(){let t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${VL}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){let r=AP(this.updatedConfig());return n?JSON.stringify(r):r}call(t,n){return le(()=>{t=En(t);let r=new og;for(let i=0;i<this.inputs.length;++i)r.add(this.inputs[i],t[i]);return Q0(this.outputs,r,n)})}computeMask(t,n){return le(()=>{t=En(t);let r;return n==null?r=ch(null,t.length):r=En(n),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){let n=XC(t);if(n.length!==this.inputLayers.length)throw new de(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);let r={};for(let o=0;o<n.length;o++){let l=this.inputLayers[o],u=n[o],c=l.name+"_0_0";r[c]=u}let i=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(l_);if(i.length>1)for(let o of i){let l=this.nodesByDepth[o];for(let u of l){let c=u.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(c.id)!==-1)continue;let d=[];for(let g=0;g<u.inboundLayers.length;g++){let v=u.inboundLayers[g],y=u.nodeIndices[g],b=u.tensorIndices[g],_=`${v.name}_${y}_${b}`,k=r[_];d.push(k)}let p=c.computeOutputShape(Pa(d)),h=XC(p),m=c.inboundNodes.indexOf(u);for(let g=0;g<h.length;g++){let v=`${c.name}_${m}_${g}`;r[v]=h[g]}}}let a=[],s=[];for(let o=0;o<this.outputLayers.length;o++){let l=this.outputLayers[o],u=this.outputLayersNodeIndices[o],c=this.outputLayersTensorIndices[o],d=`${l.name}_${u}_${c}`;s.push(d)}for(let o=0;o<s.length;o++){let l=s[o];kl(l in r),a.push(r[l])}return Pa(a)}runInternalGraph(t,n){n==null&&(n=ch(null,t.length));let r={};for(let l=0;l<this.inputs.length;++l){let u=this.inputs[l],c=t[l],d=n[l];r[u.id]=[c,d]}let i=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(l_);for(let l of i){let u=this.nodesByDepth[l];for(let c of u){let d=c.outboundLayer,p=c.inputTensors,h=c.outputTensors,m=new Array;for(let g of p)g.id in r&&m.push(r[g.id]);if(m.length===p.length){let g={},v,y,b,_;if(c.callArgs!=null&&(g=c.callArgs),m.length===1){let[k,C]=m[0];g.mask==null&&(g.mask=C),b=En(d.call(k,g)),_=En(d.computeMask(k,C)),v=[k],y=[C]}else v=m.map(k=>k[0]),y=m.map(k=>k[1]),g.mask==null&&(g.mask=y),b=En(d.call(v,g)),_=En(d.computeMask(v,y));if(d.activityRegularizer)throw new qt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let k=0;k<h.length;++k){let C=h[k],$=b[k],N=_[k];r[C.id]=[$,N]}}}}let a=[],s=[],o=[];for(let l of this.outputs){kl(l.id in r,`Could not compute output ${l.name} : ${l.id}`);let[u,c]=r[l.id];o.push(u.shape),a.push(u),s.push(c)}return[a,s,o]}buildNodeConversionMap(t){let n={},r;for(let i of this.layers){r=i instanceof ml?1:0;for(let a=0;a<i.inboundNodes.length;a++){let s=ml.nodeKey(i,a);this.containerNodes.has(s)&&(n[s]=r,r+=1)}}return n}getLayer(t,n){if(n!=null)return this.findLayer(n);if(t==null)throw new de("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(let r of this.layers)if(r.name===t)return r;throw new de(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new de(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return le(()=>{let t=[];for(let n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){let i=ml.nodeKey(n,r);this.containerNodes.has(i)&&t.push(...n.calculateLosses())}return t})}getConfig(){let t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(let s of this.layers){let o=s.getClassName(),l=s.getConfig(),u=[];for(let d=0;d<s.inboundNodes.length;d++){let p=s.inboundNodes[d],h=ml.nodeKey(s,d),m={};if(this.containerNodes.has(h)){if(p.callArgs)try{JSON.stringify(p.callArgs),m=p.callArgs}catch{console.warn(`Layer ${s.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),m={}}if(p.inboundLayers.length>0){let g=[];for(let v=0;v<p.inboundLayers.length;v++){let y=p.inboundLayers[v],b=p.nodeIndices[v],_=p.tensorIndices[v],k=ml.nodeKey(y,b),C=n[k];C==null&&(C=0),g.push([y.name,C,_,m])}u.push(g)}}}let c={};c.name=s.name,c.className=o,c.config=l,c.inboundNodes=u,r.push(c)}t.layers=r;let i=[];for(let s=0;s<this.inputLayers.length;s++){let o=this.inputLayers[s],l=this.inputLayersNodeIndices[s],u=ml.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);let d=this.inputLayersTensorIndices[s];i.push([o.name,c,d])}t.inputLayers=i;let a=[];for(let s=0;s<this.outputLayers.length;s++){let o=this.outputLayers[s],l=this.outputLayersNodeIndices[s],u=ml.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);let d=this.outputLayersTensorIndices[s];a.push([o.name,c,d])}return t.outputLayers=a,t}static fromConfig(t,n,r={},i=!1){let a={},s={};function o(v,y){v.name in s?s[v.name].push(y):s[v.name]=[y]}function l(v,y){let b=[],_;for(let k of y){let C=k[0],$=k[1],N=k[2];if(_=k[3]==null?{}:k[3],!(C in a)){o(v,y);return}let A=a[C];if(A.inboundNodes.length<=$){o(v,y);return}let D=A.inboundNodes[$];b.push(D.outputTensors[N])}b.length>0&&v.apply(Pa(b),_)}function u(v){let y=v.name,b=Wo(v,n.customObjects!=null?n.customObjects:{});b.setFastWeightInitDuringBuild(i),a[y]=b,v.inboundNodes.forEach(_=>{if(!(_ instanceof Array))throw new de(`Corrupted configuration, expected array for nodeData: ${_}`);o(b,_)})}let c=n.name,d=n.layers;for(let v of d)u(v);for(;!kje(s);)for(let v of d){let y=a[v.name];if(y.name in s){let b=s[y.name];delete s[y.name];for(let _ of b)l(y,_)}}let p=[],h=[],m=n.inputLayers;for(let v of m){let y=v[0],b=v[1],_=v[2];kl(y in a);let k=a[y].inboundNodes[b].outputTensors;p.push(k[_])}let g=n.outputLayers;for(let v of g){let y=v[0],b=v[1],_=v[2];kl(y in a);let k=a[y].inboundNodes[b].outputTensors;h.push(k[_])}return new t({inputs:p,outputs:h,name:c})}get stateful(){if(this._stateful)throw new de("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let t of this.layers)if(t.stateful)return!0;return!1}resetStates(){le(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}};function QUe(e,t,n){let r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(i=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){let i=[];return t.forEach(a=>{a in e?i.push(e[a]):i.push(null)}),i}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function $ne(e,t){return QUe(e,t,"classWeight")}async function Tne(e,t,n,r){if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){let i=le(()=>{if(e.shape.length===1)return Fl(e);if(e.shape.length===2){if(e.shape[1]>1)return ih(e,1);if(e.shape[1]===1)return oe(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),a=Array.from(await i.data());Rt(i);let s=[];return a.forEach(o=>{if(n[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);s.push(n[o])}),Cn(s,"float32")}else return null}function eHe(e,t){return ae(e,t)}var tHe=32;function Nne(e,t){let n,r,i=t;n=i.xs,r=i.ys,P.assert(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);let a=IU("input",e.inputNames,n),s=IU("output",e.outputNames,r),o=a[0].shape[0];P.assert(a.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),P.assert(s.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${s.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let l=0;l<a.length;l++)P.assert(a[l].shape[0]===o,()=>`Batch size mismatch: input ${e.inputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);for(let l=0;l<s.length;l++)P.assert(s[l].shape[0]===o,()=>`Batch size mismatch: output ${e.outputNames[l]} has ${s[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);return{xs:a,ys:s}}function IU(e,t,n){if(n instanceof zt)return[n];if(Array.isArray(n))return P.assert(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{let r=[];for(let i of t){if(n[i]==null)throw new de(`The feature data generated by the dataset lacks the required ${e} key '${i}'.`);r.push(n[i])}return r}}function nHe(e){if(e.length===3)throw new qt("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function rHe(e,t,n){let r=n.batchesPerEpoch!=null;if(P.assert(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),P.assert(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),P.assert(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),P.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),P.assert(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let i=n.validationData!=null,a,s;if(i)if($U(n.validationData))P.assert(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{let v=nHe(n.validationData);a=v.xs,s=v.ys}let o=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),u;i?u=l.slice().concat(l.map(v=>"val_"+v)):u=l.slice();let c=bne(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:p,history:h}=wne(c,d,n.epochs,null,null,iHe(t,n),null,i,u);p.setModel(e),e.history=h,await p.onTrainBegin(),e.stopTraining_=!1;let m=n.initialEpoch==null?0:n.initialEpoch,g=await t.iterator();for(;m<n.epochs;){let v={};await p.onEpochBegin(m);let y=0,b=0;for(r||(g=await t.iterator());!r||y<n.batchesPerEpoch;){let _=await g.next();if(r&&_.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(_.value!=null){let{xs:k,ys:C}=Nne(e,_.value),$={};$.batch=b,$.size=k[0].shape[0],await p.onBatchBegin(b,$);let N=[];if(n.classWeight!=null){let O=$ne(n.classWeight,e.outputNames);for(let F=0;F<O.length;++F)N.push(await Tne(C[F],null,O[F]))}let A=k.concat(C).concat(N),D=o(A);Rt(A);for(let O=0;O<l.length;++O){let F=l[O],E=D[O];$[F]=E,Jr(E)}await p.onBatchEnd(b,$),mne($),b++,y++}if(r?y>=n.batchesPerEpoch:_.done){if(i){let k;$U(n.validationData)?k=En(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):k=En(e.evaluate(a,s,{batchSize:n.validationBatchSize==null?tHe:n.validationBatchSize,verbose:0}));for(let C=0;C<e.metricsNames.length;++C)v[`val_${e.metricsNames[C]}`]=k[C]}break}if(e.stopTraining_)break}if(await p.onEpochEnd(m,v),m++,e.stopTraining_)break}return await p.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function iHe(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function $U(e){return typeof e.iterator=="function"}function aHe(e){return typeof e.next=="function"}async function sHe(e,t,n){n=n||{};let r=n.batches!=null,i=e.testFunction,a=[];if(n.verbose>0)throw new qt("Verbose mode is not implemented yet.");P.assert(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);let s=aHe(t)?t:await t.iterator(),o=0,l=0;for(;!r||l<n.batches;){let u=await s.next();if(a=le(()=>{if(u.value){let{xs:c,ys:d}=Nne(e,u.value),p=c.concat(d),h=le(()=>i(p));if(Rt(p),l===0)for(let g=0;g<h.length;++g)a.push(yt(0));let m=p[0].shape[0];for(let g=0;g<h.length;++g){let v=h[g],y=a[g];a[g]=le(()=>we(a[g],ae(m,v))),l>0&&Rt(y)}Rt(h),o+=m,++l}return a}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<a.length;++u){let c=a[u];a[u]=et(a[u],o),Rt(c)}return Pa(a)}function sE(e){P.assert(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function B0(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(r=>Mp(r,t,n-t)):Mp(e,t,n-t)}function MP(e,t){return le(()=>e==null?null:Array.isArray(e)?e.map(n=>MP(n,t)):sne(e,t.dtype==="int32"?t:Me(t,"int32")))}function oE(e,t){let n=[],r=0,i=null;for(;r<e;)i=r+t,i>=e&&(i=e),n.push([r,i]),r=i;return n}function Ene(e){let t=[];e instanceof zt&&(e=[e]);for(let n=0;n<e.length;++n){let r=e[n];if(r.rank===1)t.push(Rw(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function To(e,t){if(e==null)return;let n=[];if(t instanceof zt)n.push(t.id);else if(Array.isArray(t))t.forEach(i=>n.push(i.id));else if(t!=null)for(let i in t){let a=t[i];n.push(a.id)}let r=[];if(e instanceof zt)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(i=>{n.indexOf(i.id)===-1&&r.push(i)});else if(e!=null)for(let i in e){let a=e[i];n.indexOf(a.id)===-1&&r.push(a)}r.forEach(i=>{i.isDisposed||i.dispose()})}function oHe(e){return e instanceof zt}function RP(e){return Array.isArray(e)}function TU(e){return!oHe(e)&&!RP(e)}function NU(e,t,n,r=!0,i=""){if(t==null||t.length===0){if(e!=null){let s=!1;if(RP(e)&&e.length>0)s=!0;else if(TU(e)){for(let o in e)if(e.hasOwnProperty(o)){s=!0;break}}else s=!0;if(s)throw new de(`Error when checking model ${i} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(s=>null);let a;if(TU(e)){e=e,a=[];for(let s of t){if(e[s]==null)throw new de(`No data provided for "${s}". Need data for each key in: ${t}`);a.push(e[s])}}else if(RP(e)){if(e=e,e.length!==t.length)throw new de(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);a=e}else{if(e=e,t.length>1)throw new de(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);a=[e]}if(a=Ene(a),n!=null)for(let s=0;s<t.length;++s){if(n[s]==null)continue;let o=a[s];if(o.shape.length!==n[s].length)throw new de(`Error when checking ${i}: expected ${t[s]} to have ${n[s].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;let u=o.shape[l],c=n[s][l];if(c!=null&&c>=0&&u!==c)throw new de(`${i} expected a batch of elements where each example has shape [${n[s].slice(1,n[s].length)}] (i.e.,tensor shape [*,${n[s].slice(1,n[s].length)}]) but the ${i} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return a}function lHe(e,t,n){let r=Xc(e.map(a=>a.shape[0]));r.sort();let i=Xc(t.map(a=>a.shape[0]));if(i.sort(),r.length>1)throw new de(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(a=>a.shape))}`);if(i.length>1)throw new de(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(a=>a.shape))}`);if(r.length>0&&i.length>0&&!P.arraysEqual(r,i))throw new de(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}function uHe(e,t,n){let r=[em,J$,u1];for(let i=0;i<e.length;++i){let a=e[i],s=t[i],o=n[i];if(s!=null){if(s===u1&&a.shape[a.shape.length-1]===1)throw new de(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(s)!==-1){let l=a.shape.slice(1),u=o.slice(1);for(let c=0;c<l.length;++c){let d=l[c],p=u[c];if(p!=null&&d!==p)throw new de(`A target Tensor with shape ${a.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function EU(e,t,n,r=!0,i=""){let a;if(Array.isArray(e)){if(e.length!==t.length)throw new de(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);a=e}else{if(t.length>1)throw new de(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);a=[e]}if(n!=null)for(let s=0;s<t.length;++s){if(n[s]==null)continue;let o=a[s];if(o.shape.length!==n[s].length)throw new de(`Error when checking ${i}: expected ${t[s]} to have ${n[s].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;let u=o.shape[l],c=n[s][l];if(c!=null&&c!==u)throw new de(`Error when checking ${i}: expected ${t[s]} to have shape ${JSON.stringify(n[s])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function cHe(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(r=>n);{let r=[];for(let i of t){let a=n.hasOwnProperty(i)?n[i]:[];Array.isArray(a)||(a=[a]),r.push(a)}return r}}var dHe="layers-model",Su=class extends YUe{constructor(e){super(e),this.isTraining=!1}summary(e,t,n=console.log){if(!this.built)throw new de("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");GUe(this,e,t,n)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=HUe(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Zu))throw new de("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(let a in e.loss)if(this.outputNames.indexOf(a)===-1)throw new de(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(let a of this.outputNames)e.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),t.push(aE(e.loss[a]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new de(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(a=>aE(a))}else{let a=aE(e.loss);this.outputs.forEach(s=>{t.push(a)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){let s=this.internalOutputShapes[a],o=this.outputNames[a];this.feedOutputNames.push(o),this.feedOutputShapes.push(s),this.feedLossFns.push(this.lossFunctions[a])}let n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Ap("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(n.indexOf(a)!==-1)continue;let s=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([s,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});let r=cHe(e.metrics,this.outputNames),i=(a,s,o)=>{this.outputNames.length>1&&(s=this.outputNames[a]+"_"+s),this.metricsNames.push(s),this.metricsTensors.push([o,a])};Ap("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(n.indexOf(a)!==-1)continue;let s=r[a];(o=>{let l="",u,c,d;for(let p of o){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){let m=this.internalOutputShapes[a];m[m.length-1]===1||this.lossFunctions[a]===J$?["accuracy","acc"].indexOf(p)!==-1?c=zL:["crossentropy","ce"].indexOf(p)!==-1&&(c=kne):this.lossFunctions[a]===tI?["accuracy","acc"].indexOf(p)!==-1?c=Sne:["crossentropy","ce"].indexOf(p)!==-1&&(c=Cne):["accuracy","acc"].indexOf(p)!==-1?c=BL:["crossentropy","ce"].indexOf(p)!==-1&&(c=WL);let g;["accuracy","acc"].indexOf(p)!==-1?g="acc":["crossentropy","ce"].indexOf(p)!==-1&&(g="ce"),d=c,u=l+g}else d=UUe(p),u=l+d_(p);let h;Ap(u,()=>{h=d}),i(a,u,h)}})(s)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,n={}){let r=n.batchSize==null?32:n.batchSize;sE(r);let i=this.standardizeUserDataXY(e,t,!0,r);try{let a=i[0].concat(i[1]);this.makeTestFunction();let s=this.testFunction,o=this.testLoop(s,a,r,n.verbose,n.steps);return Pa(o)}finally{To(i[0],e),To(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),sHe(this,e,t)}checkNumSamples(e,t,n,r="steps"){let i;if(n!=null){if(i=null,t!=null)throw new de(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new de(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new de("`outputs` is an empty Array, which is not allowed.");let n=Array.isArray(t),r=n?t:[t],i=this.retrieveSymbolicTensors(r),a=new og;if(e instanceof zt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new de(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let o=0;o<this.inputs.length;++o)a.add(this.inputs[o],e[o])}else for(let o of this.inputs){let l=e[o.name];if(l==null)throw new de(`No value is provided for the model's input ${o.name}`);a.add(o,l)}let s=Q0(i,a);return n?s:s[0]}retrieveSymbolicTensors(e){let t=ch(null,e.length),n=e.length;for(let r of this.layers){let i=Array.isArray(r.output)?r.output:[r.output],a=i.map(s=>s.name);for(let s=0;s<e.length;++s){let o=a.indexOf(e[s]);if(o!==-1&&(t[s]=i[o],n--),n===0)break}if(n===0)break}if(n>0){let r=[];throw t.forEach((i,a)=>{i==null&&r.push(e[a])}),new de(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return t}predictLoop(e,t=32,n=!1){return le(()=>{let r=this.checkNumSamples(e);if(n)throw new qt("Verbose predictLoop() is not implemented yet.");let i=oE(r,t),a=this.outputs.map(s=>[]);for(let s=0;s<i.length;++s)le(()=>{let o=i[s][0],l=i[s][1],u=B0(e,o,l),c=[];if(Array.isArray(u))for(let p=0;p<u.length;++p)c.push({key:this.inputs[p],value:u[p]});else c.push({key:this.inputs[0],value:u});let d=new og(c);return Q0(this.outputs,d)}).forEach((o,l)=>a[l].push(o));return Pa(a.map(s=>Wn(s,0)))})}predict(e,t={}){let n=Ene(e);EU(n,this.inputNames,this.feedInputShapes,!1);try{let r=t.batchSize==null?32:t.batchSize;return sE(r),this.predictLoop(n,r)}finally{To(n,e)}}predictOnBatch(e){EU(e,this.inputNames,this.feedInputShapes,!0);let t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,n=!0,r){if(this.optimizer_==null)throw new El("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let i=[];for(let a=0;a<this.feedOutputShapes.length;++a){let s=this.feedOutputShapes[a];this.feedLossFns[a]===tI?i.push(s.slice(0,s.length-1).concat([1])):i.push(s)}if(e=NU(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=NU(t,this.feedOutputNames,i,!1,"target"),lHe(e,t),uHe(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new de(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,n,r,i=!0,a){let[s,o]=this.standardizeUserDataXY(e,t,i,a);if(n!=null)throw new Error("sample weight is not supported yet.");let l=null;if(r!=null){let u=$ne(r,this.outputNames);l=[];for(let c=0;c<u.length;++c)l.push(await Tne(o[c],null,u[c]))}return[s,o,l]}testLoop(e,t,n,r=0,i){return le(()=>{let a=this.checkNumSamples(t,n,i,"steps"),s=[];if(r>0)throw new qt("Verbose mode is not implemented yet.");if(i!=null)throw new qt("steps mode in testLoop() is not implemented yet");{let o=oE(a,n),l=Cn(Yo(0,a));for(let u=0;u<o.length;++u){let c=o[u][0],d=o[u][1],p=Mp(l,c,d-c),h=MP(t,p),m=e(h);if(u===0)for(let g=0;g<m.length;++g)s.push(yt(0));for(let g=0;g<m.length;++g){let v=m[g];s[g]=we(s[g],ae(d-c,v))}}for(let u=0;u<s.length;++u)s[u]=et(s[u],a)}return s})}getDedupedMetricsNames(){let e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){let r=e[n],i=r;if(mU(e,r)>1){let a=mU(e.slice(0,n),r);i+=`_${a}`}t.push(i)}return t}makeTrainFunction(){return e=>{let t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],s=()=>{let l=[];for(let p=0;p<this.inputs.length;++p)l.push({key:this.inputs[p],value:n[p]});let u=new og(l),c=Q0(this.outputs,u,{training:!0}),d;for(let p=0;p<this.lossFunctions.length;++p){let h=this.lossFunctions[p],m=h(r[p],c[p]);i[p]!=null&&(m=eHe(m,i[p]));let g=vr(m);t.push(g),p===0?d=m:d=we(d,m)}for(let p=0;p<this.metricsTensors.length;++p){let h;if(this.outputs.length>1&&p<this.outputs.length)h=t[p];else{let m=this.metricsTensors[p][0],g=this.metricsTensors[p][1];h=vr(m(r[g],c[g]))}Jr(h),a.push(h)}return d=vr(d),this.calculateLosses().forEach(p=>{d=we(d,p)}),d},o=this.collectedTrainableWeights.map(l=>l.read());return[this.optimizer_.minimize(s,!0,o)].concat(a)}}makeTestFunction(){this.testFunction=e=>le(()=>{let t=[],n,r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let l=0;l<this.inputs.length;++l)a.push({key:this.inputs[l],value:r[l]});let s=new og(a),o=Q0(this.outputs,s);for(let l=0;l<this.lossFunctions.length;++l){let u=this.lossFunctions[l],c=vr(u(i[l],o[l]));l===0?n=c:n=we(n,c),t.push(n)}for(let l=0;l<this.metricsTensors.length;++l){let u=this.metricsTensors[l][0],c=this.metricsTensors[l][1],d=vr(u(i[c],o[c]));t.push(d)}return t})}async fit(e,t,n={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,a,s,o,l,u,c,d;try{let p=n.batchSize==null?32:n.batchSize;sE(p);let h=await this.standardizeUserData(e,t,n.sampleWeight,n.classWeight,!1,p);r=h[0],i=h[1],d=h[2];let m=!1,g;if(n.validationData!=null&&n.validationData.length>0){if(m=!0,n.validationData.length===2)o=n.validationData[0],l=n.validationData[1];else throw n.validationData.length===3?new qt("validationData including sample weights is not supported yet."):new de(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${n.validationData} is invalid.`);let $=await this.standardizeUserData(o,l,null,null,!0,p);u=$[0],c=$[1],g=u.concat(c)}else if(n.validationSplit!=null&&n.validationSplit>0&&n.validationSplit<1){m=!0;let $=Math.floor(r[0].shape[0]*(1-n.validationSplit)),N=r[0].shape[0];u=B0(r,$,N),a=r,r=B0(r,0,$),c=B0(i,$,N),s=i,i=B0(i,0,$),g=u.concat(c)}else n.validationSteps!=null&&(m=!0);let v=r.concat(i).concat(d);this.checkTrainableWeightsConsistency();let y=this.makeTrainFunction(),b=this.getDedupedMetricsNames(),_,k;m?(this.makeTestFunction(),_=this.testFunction,k=b.slice().concat(b.map($=>"val_"+$))):(_=null,g=[],k=b.slice());let C=bne(n.callbacks,n.yieldEvery);return await this.fitLoop(y,v,b,p,n.epochs,n.verbose,C,_,g,n.shuffle,k,n.initialEpoch,null,null)}finally{this.isTraining=!1,To(r,e),To(i,t),To(a,e),To(s,t),To(u,o),To(c,l),d!=null&&Rt(d)}}async fitLoop(e,t,n,r,i,a,s,o,l,u,c,d,p,h){r==null&&(r=32),i==null&&(i=1),u==null&&(u=!0),d==null&&(d=0);let m=!1;if(o!=null&&l!=null&&(m=!0),h!=null&&(m=!0,p==null))throw new de("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let g=this.checkNumSamples(t,r,p,"steps_per_epoch"),v;g!=null&&(v=Yo(0,g)),a==null&&(a=1);let{callbackList:y,history:b}=wne(s,a,i,d,g,p,r,m,c);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let _=d;_<i;++_){await y.onEpochBegin(_);let k={};if(p!=null)throw new qt("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new qt("batch shuffling is not implemneted yet");u&&P.shuffle(v);let C=Cn(v),$=oE(g,r);for(let N=0;N<$.length;++N){let A={};if(await y.onBatchBegin(N,A),le(()=>{let D=$[N][0],O=$[N][1],F=Mp(C,D,O-D);A.batch=N,A.size=O-D;let E=MP(t,F),z=e(E);for(let q=0;q<n.length;++q){let H=n[q],J=z[q];A[H]=J,Jr(J)}if(N===$.length-1&&m){let q=this.testLoop(o,l,r);for(let H=0;H<n.length;++H){let J=n[H],ee=q[H];Jr(ee),k["val_"+J]=ee}}}),await y.onBatchEnd(N,A),mne(A),this.stopTraining_)break}C.dispose()}if(await y.onEpochEnd(_,k),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return rHe(this,e,t)}async trainOnBatch(e,t){let n=await this.standardizeUserData(e,t),r=n[0],i=n[1],a=this.makeTrainFunction()(r.concat(i)),s=[];for(let o of a){let l=await o.data();s.push(l[0])}return Rt(a),To(n[0],e),To(n[1],t),Pa(s)}getNamedWeights(e){let t=[],n=e!=null&&e.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n);for(let a=0;a<r.length;++a)n&&!r[a].trainable||t.push({name:r[a].originalName,tensor:i[a]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let t=qC().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-qC().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=mu(this.loss);else if(Array.isArray(this.loss)){for(let t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>mu(t))}else{let t=Object.keys(this.loss);e={};let n=this.loss;for(let r of t)if(typeof n[r]=="string")e[r]=mu(n[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[mu(d_(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>mu(d_(e)));{let e={};for(let t in this.metrics)e[t]=mu(d_(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");let t=c1(e.optimizer_config),n=Wo(t),r;if(typeof e.loss=="string")r=fp(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(a=>fp(a));else if(e.loss!=null){r={};for(let a in e.loss)r[a]=fp(e.loss[a])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(a=>fp(a));else if(e.metrics!=null){i={};for(let a in e.metrics)i[a]=fp(e.metrics[a])}this.compile({loss:r,metrics:i,optimizer:n})}async save(e,t){if(typeof e=="string"){let i=Ti.getSaveHandlers(e);if(i.length===0)throw new de(`Cannot find any save handlers for URL '${e}'`);if(i.length>1)throw new de(`Found more than one (${i.length}) save handlers for URL '${e}'`);e=i[0]}if(e.save==null)throw new de("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let n=await Ti.encodeWeights(this.getNamedWeights(t)),r={modelTopology:this.toJSON(null,!1),format:dHe,generatedBy:`TensorFlow.js tfjs-layers v${VL}`,convertedBy:null};if(t!=null&&t.includeOptimizer&&this.optimizer!=null){r.trainingConfig=this.getTrainingConfig();let i="optimizer",{data:a,specs:s}=await Ti.encodeWeights(await this.optimizer.getWeights(),i);n.specs.push(...s),n.data=Ti.concatenateArrayBuffers([n.data,a])}return this.userDefinedMetadata!=null&&(CU(this.userDefinedMetadata,this.name,!0),r.userDefinedMetadata=this.userDefinedMetadata),r.weightData=n.data,r.weightSpecs=n.specs,e.save(r)}setUserDefinedMetadata(e){CU(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}};Su.className="Model";$e.registerClass(Su);var One=class extends Su{};One.className="Functional";$e.registerClass(One);async function pHe(e,t){"modelTopology"in e||(e={modelTopology:e}),e=e;let n=e.modelTopology;n.model_config!=null&&(n=n.model_config);let r=c1(n),i=Wo(r,t);if(e.weightsManifest!=null){let a=await Ti.loadWeights(e.weightsManifest,e.pathPrefix,i.weights.map(o=>o.originalName)),s={};for(let o of i.weights)s[o.originalName]=a[o.originalName];i.loadWeights(s),Rt(a)}return i}async function hHe(e,t){if(t==null&&(t={}),typeof e=="string"){let n=Ti.getLoadHandlers(e,t);if(n.length===0)n.push(Ti.browserHTTPRequest(e,t));else if(n.length>1)throw new de(`Found more than one (${n.length}) load handlers for URL '${e}'`);e=n[0]}return fHe(e,void 0,t)}async function fHe(e,t,n){if(n==null&&(n={}),e.load==null)throw new de("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let r=await e.load(),i=r.modelTopology;i.model_config!=null&&(i=i.model_config);let a=n.strict==null?!0:n.strict,s=r.weightData!=null&&r.weightSpecs!=null&&a,o=Wo(c1(i),t,s),l=r.trainingConfig;if(l!=null&&o.loadTrainingConfig(l),r.userDefinedMetadata!=null&&o.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new de("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:u,optimizerWeights:c}=mHe(r.weightData,r.weightSpecs);o.loadWeights(u,a),o.optimizer!=null&&c.length>0&&await o.optimizer.setWeights(c),Rt(u),Rt(c.map(d=>d.tensor))}return o}function mHe(e,t){let n=Ti.decodeWeights(e,t),r={},i=[];return t.forEach(a=>{a.group==="optimizer"?i.push({name:a.name,tensor:n[a.name]}):r[a.name]=n[a.name]}),{modelWeights:r,optimizerWeights:i}}var Y$=class DP extends Su{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:B$("sequential_"),t.layers!=null)for(let n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(n=>n<0))throw new de(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){let n=t instanceof DP||t instanceof Su,r;if(n){if(r=t,r.outputs.length!==1)throw new de("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new de("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new de("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let i=cne({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(t.inboundNodes.length!==1)throw new de(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new de("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=une(this.outputs[0])}this.inboundNodes=[],new Z$({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:ch(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(i=>i.shape),outputShapes:this.outputs[0].shape})}else{let i=t.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(pn(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Su({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,r=console.log){this.built||this.build(),super.summary(t,n,r)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,r={}){if(!this.built)throw new El("The model needs to be compiled before being used.");return this.model.evaluate(t,n,r)}async evaluateDataset(t,n){if(!this.built)throw new El("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,n,r={}){if(!this.built)throw new El("The model needs to be compiled before being used.");return this.model.fit(t,n,r)}async fitDataset(t,n){if(!this.built)throw new El("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)}async trainOnBatch(t,n){return this.model.trainOnBatch(t,n)}static fromConfig(t,n,r={},i=!1){let a,s={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new de("Legacy serialization format not supported yet.");a=n}else P.assert(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=n.layers,delete n.layers,s=n;let o=new t(s);if(!(o instanceof DP))throw new qt(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(let l of a){let u=Wo(l,void 0,i);i&&u.setFastWeightInitDuringBuild(!0),o.add(u)}return o}set stopTraining(t){if(this.model==null)throw new de("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new de("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let t=[];for(let n of this.layers){let r={};r.className=n.getClassName(),r.config=n.getConfig(),t.push(r)}return{name:this.name,layers:t}}};Y$.className="Sequential";$e.registerClass(Y$);function gHe(e){return new Su(e)}function yHe(e){return new Y$(e)}function Pne(e){return cne(e)}function vHe(e,t){LL.registerCallbackConstructor(e,t)}var Za=class extends $e.Serializable{getConfig(){return{}}},Ane=class extends Za{apply(e,t=1){return Fje(e,t)}};Ane.className="elu";$e.registerClass(Ane);var Mne=class extends Za{apply(e){return k$(e)}};Mne.className="selu";$e.registerClass(Mne);var Rne=class extends Za{apply(e){return On(e)}};Rne.className="relu";$e.registerClass(Rne);var Dne=class extends Za{apply(e){return le(()=>cd(6,On(e)))}};Dne.className="relu6";$e.registerClass(Dne);var Lne=class extends Za{apply(e){return e}};Lne.className="linear";$e.registerClass(Lne);var Fne=class extends Za{apply(e){return lo(e)}};Fne.className="sigmoid";$e.registerClass(Fne);var zne=class extends Za{apply(e){return Bje(e)}};zne.className="hardSigmoid";$e.registerClass(zne);var Bne=class extends Za{apply(e){return Jf(e)}};Bne.className="softplus";$e.registerClass(Bne);var Wne=class extends Za{apply(e){return zje(e)}};Wne.className="softsign";$e.registerClass(Wne);var Vne=class extends Za{apply(e){return sh(e)}};Vne.className="tanh";$e.registerClass(Vne);var jL=class extends Za{apply(e,t=-1){return Dd(e,t)}};jL.className="softmax";$e.registerClass(jL);var jne=class extends Za{apply(e,t=-1){return g$(e,t)}};jne.className="logSoftmax";$e.registerClass(jne);var Une=class extends Za{apply(e,t=1){return le(()=>ae(lo(ae(e,t)),e))}};Une.className="swish";$e.registerClass(Une);var Hne=class extends Za{apply(e){return le(()=>ae(e,sh(Jf(e))))}};Hne.className="mish";$e.registerClass(Hne);function hd(e){return e.getClassName()}function lE(e,t={}){return Mw(e,$e.SerializationMap.getMap().classNameMap,t,"activation")}function fd(e){if(e==null){let t={};return t.className="linear",t.config={},lE(t)}if(typeof e=="string"){let t={};return t.className=e,t.config={},lE(t)}else return e instanceof Za?e:lE(e)}function UL(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}var Gne=class extends $e.Serializable{},zw=class extends Gne{constructor(e){super(),UL(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return le(()=>{let t=br([1]);return this.hasL1&&(t=we(t,lt(ae(this.l1,Dr(e))))),this.hasL2&&(t=we(t,lt(ae(this.l2,Dw(e))))),oe(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}};zw.className="L1L2";$e.registerClass(zw);function bHe(e){return UL(e),new zw({l1:e!=null?e.l1:null,l2:0})}function wHe(e){return UL(e),new zw({l2:e!=null?e.l2:null,l1:0})}var OU={l1l2:"L1L2"};function Zn(e){return xL(e)}function PU(e,t={}){return Mw(e,$e.SerializationMap.getMap().classNameMap,t,"regularizer")}function fr(e){if(e==null)return null;if(typeof e=="string"){let t={className:e in OU?OU[e]:e,config:{}};return PU(t)}else return e instanceof Gne?e:PU(e)}var HL=class extends Xt{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=Tt(e);let n=On(e);return this.maxValue!=null&&(n=Yi(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}};HL.className="ReLU";$e.registerClass(HL);var GL=class extends Xt{constructor(e){super(e==null?{}:e),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=Tt(e);return kw(n,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};GL.className="LeakyReLU";$e.registerClass(GL);var qL=class extends Xt{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=hr(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=fr(e.alphaRegularizer),this.alphaConstraint=ni(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new de(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=pn(e);let t=e.slice(1);if(this.sharedAxes!=null)for(let r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let n={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)n[r]=e[r];this.inputSpec=[new zr({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=Tt(e),Nw(e,this.alpha.read())}getConfig(){let e={alphaInitializer:wr(this.alphaInitializer),alphaRegularizer:Zn(this.alphaRegularizer),alphaConstraint:ti(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}};qL.className="PReLU";$e.registerClass(qL);var KL=class extends Xt{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new qt(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=Tt(e);return Dv(n)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};KL.className="ELU";$e.registerClass(KL);var ZL=class extends Xt{constructor(e){super(e==null?{}:e),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){let n=Tt(e);return ae(n,Me(Sa(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}};ZL.className="ThresholdedReLU";$e.registerClass(ZL);var XL=class extends Xt{constructor(e){super(e==null?{}:e),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new jL().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return le(()=>{let n=Tt(e),r=t.mask;if(r!=null){let i=ae(Ve(Aa(n.shape),Me(r,n.dtype)),yt(-1e9));n=we(n,i)}return this.axis instanceof Array?this.axis.length>1?Qi(Ve(n,Cw(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)})}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};XL.className="Softmax";$e.registerClass(XL);function $g(e,t,n){if(typeof e=="number")return ch(e,t);if(e.length!==t)throw new de(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){let i=e[r];if(!Mje(i))throw new de(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${i}`)}return e}function Vo(e,t,n,r,i=1){if(e==null)return e;let a=t+(t-1)*(i-1),s;return n==="same"?s=e:s=e-a+1,Math.floor((s+r-1)/r)}function Sl(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+pd([n-t,0]);else if(r==="same")e=e*t;else throw new de(`Unsupport padding mode: ${r}.`);return e}function JL(e,t){return le(()=>(Ar(t),t==="channelsFirst"?Ut(e,[0,2,3,1]):e))}function qne(e,t){return le(()=>(Ar(t),t==="channelsFirst"?Ut(e,[0,2,3,4,1]):e))}function xHe(e,t,n,r=1,i="valid",a,s=1){return le(()=>{if(a==null&&(a=Qo()),Ar(a),e.shape.length!==3)throw new de(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new de(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new de(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(a==="channelsFirst"&&(e=Ut(e,[0,2,1])),i==="causal")throw new qt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=c$(e,t,r,i==="same"?"same":"valid","NWC",s);return n!=null&&(o=sl(o,n)),o})}function AU(e,t,n,r=[1,1],i="valid",a,s,o=null){return le(()=>{if(a==null&&(a=Qo()),Ar(a),e.rank!==3&&e.rank!==4)throw new de(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new de(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=JL(e,a);if(i==="causal")throw new qt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=ay.conv2d({x:l,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:o}),a==="channelsFirst"&&(l=Ut(l,[0,3,1,2])),l})}function _He(e,t,n,r=[1,1,1],i="valid",a,s){return le(()=>{if(a==null&&(a=Qo()),Ar(a),e.rank!==4&&e.rank!==5)throw new de(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new de(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let o=qne(e,a);if(i==="causal")throw new qt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=SD(o,t,r,i==="same"?"same":"valid","NDHWC",s),n!=null&&(o=sl(o,n)),a==="channelsFirst"&&(o=Ut(o,[0,4,1,2,3])),o})}var Kne=class Zne extends Xt{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Zne.verifyArgs(n),this.rank=t,mi(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new qt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=$g(n.kernelSize,t,"kernelSize"),this.strides=$g(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,Hs(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Ar(this.dataFormat),this.activation=fd(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=hr(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=ni(n.biasConstraint),this.biasRegularizer=fr(n.biasRegularizer),this.activityRegularizer=fr(n.activityRegularizer),this.dilationRate=$g(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new de(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new de(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new de(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(kl("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!_L(t.kernelSize,"number",1,3))throw new de(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){let t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:hd(this.activation),useBias:this.useBias,biasInitializer:wr(this.biasInitializer),biasRegularizer:Zn(this.biasRegularizer),activityRegularizer:Zn(this.activityRegularizer),biasConstraint:ti(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}},Q$=class Xne extends Kne{constructor(t,n){super(t,n),this.kernel=null,Xne.verifyArgs(n),this.filters=n.filters,mi(this.filters,"filters"),this.kernelInitializer=hr(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=ni(n.kernelConstraint),this.kernelRegularizer=fr(n.kernelRegularizer)}build(t){t=pn(t);let n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new de(`The channel dimension of the input should be defined. Found ${t[n]}`);let r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(t,n){return le(()=>{t=Tt(t);let r,i=this.bias==null?null:this.bias.read(),a=ene(this.activation.getClassName());if(a!=null&&this.rank===2)r=AU(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)r=xHe(t,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=AU(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=_He(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new qt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=pn(t);let n=[],r=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let a=0;a<r.length;++a){let s=Vo(r[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);n.push(s)}let i=[t[0]];return this.dataFormat==="channelsLast"?(i=i.concat(n),i.push(this.filters)):(i.push(this.filters),i=i.concat(n)),i}getConfig(){let t={filters:this.filters,kernelInitializer:wr(this.kernelInitializer),kernelRegularizer:Zn(this.kernelRegularizer),kernelConstraint:ti(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new de(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}},eT=class Jne extends Q${constructor(t){super(2,t),Jne.verifyArgs(t)}getConfig(){let t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!_L(t.kernelSize,"number",1,2))throw new de(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}};eT.className="Conv2D";$e.registerClass(eT);var tT=class Yne extends Q${constructor(t){super(3,t),Yne.verifyArgs(t)}getConfig(){let t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new de(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}};tT.className="Conv3D";$e.registerClass(tT);var YL=class extends eT{constructor(e){if(super(e),this.inputSpec=[new zr({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new de(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=pn(e),e.length!==4)throw new de("Input should have rank 4; Received input shape: "+JSON.stringify(e));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new de("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new zr({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return le(()=>{let n=Tt(e);if(n.shape.length!==4)throw new de(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${n.shape.length}`);let r=n.shape,i=r[0],a,s;this.dataFormat==="channelsFirst"?(a=2,s=3):(a=1,s=2);let o=r[a],l=r[s],u=this.kernelSize[0],c=this.kernelSize[1],d=this.strides[0],p=this.strides[1],h=Sl(o,d,u,this.padding),m=Sl(l,p,c,this.padding),g=[i,h,m,this.filters];this.dataFormat!=="channelsLast"&&(n=Ut(n,[0,2,3,1]));let v=d$(n,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(v=Ut(v,[0,3,1,2])),this.bias!=null&&(v=sl(v,this.bias.read(),this.dataFormat)),this.activation!=null&&(v=this.activation.apply(v)),v})}computeOutputShape(e){e=pn(e);let t=e.slice(),n,r,i;this.dataFormat==="channelsFirst"?(n=1,r=2,i=3):(n=3,r=1,i=2);let a=this.kernelSize[0],s=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return t[n]=this.filters,t[r]=Sl(t[r],o,a,this.padding),t[i]=Sl(t[i],l,s,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};YL.className="Conv2DTranspose";$e.registerClass(YL);var QL=class extends tT{constructor(e){if(super(e),this.inputSpec=[new zr({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new de(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=pn(e),e.length!==5)throw new de("Input should have rank 5; Received input shape: "+JSON.stringify(e));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new de("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new zr({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return le(()=>{let n=Tt(e);if(n.shape.length!==5)throw new de(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${n.shape.length}`);let r=n.shape,i=r[0],a,s,o;this.dataFormat==="channelsFirst"?(o=2,a=3,s=4):(o=1,a=2,s=3);let l=r[o],u=r[a],c=r[s],d=this.kernelSize[0],p=this.kernelSize[1],h=this.kernelSize[2],m=this.strides[0],g=this.strides[1],v=this.strides[2],y=Sl(l,m,d,this.padding),b=Sl(u,g,p,this.padding),_=Sl(c,v,h,this.padding),k=[i,y,b,_,this.filters];this.dataFormat!=="channelsLast"&&(n=Ut(n,[0,2,3,4,1]));let C=CD(n,this.kernel.read(),k,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=Ut(C,[0,4,1,2,3])),this.bias!==null&&(C=sl(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(e){e=pn(e);let t=e.slice(),n,r,i,a;this.dataFormat==="channelsFirst"?(n=1,r=2,i=3,a=4):(n=4,r=1,i=2,a=3);let s=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],u=this.strides[0],c=this.strides[1],d=this.strides[2];return t[n]=this.filters,t[r]=Sl(t[r],u,s,this.padding),t[i]=Sl(t[i],c,o,this.padding),t[a]=Sl(t[a],d,l,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};QL.className="Conv3DTranspose";$e.registerClass(QL);var Qne=class extends Q${constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new de("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new de("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new de(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=hr(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=fr(t.depthwiseRegularizer),this.depthwiseConstraint=ni(t.depthwiseConstraint),this.pointwiseInitializer=hr(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=fr(t.pointwiseRegularizer),this.pointwiseConstraint=ni(t.pointwiseConstraint)}build(e){if(e=pn(e),e.length<this.rank+2)throw new de(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new de(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);let n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[];for(let s=0;s<this.rank;++s)i.push(1);i.push(n*this.depthMultiplier,this.filters);let a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new zr({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return le(()=>{e=Tt(e);let n;if(this.rank===1)throw new qt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Ut(e,[0,2,3,1])),n=Bv(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(n=sl(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),this.dataFormat==="channelsFirst"&&(n=Ut(n,[0,3,1,2])),n})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=wr(this.depthwiseInitializer),e.pointwiseInitializer=wr(this.pointwiseInitializer),e.depthwiseRegularizer=Zn(this.depthwiseRegularizer),e.pointwiseRegularizer=Zn(this.pointwiseRegularizer),e.depthwiseConstraint=ti(this.depthwiseConstraint),e.pointwiseConstraint=ti(this.pointwiseConstraint),e}};Qne.className="SeparableConv";var eF=class extends Qne{constructor(e){super(2,e)}};eF.className="SeparableConv2D";$e.registerClass(eF);var tF=class ere extends Q${constructor(t){super(1,t),ere.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){let t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!_L(t.kernelSize,"number",1,1))throw new de(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}};tF.className="Conv1D";$e.registerClass(tF);var nF=class extends Xt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return le(()=>{if(e=Tt(e),this.dataFormat==="channelsLast"){let n=c_(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return c_(n,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{let n=c_(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return c_(n,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};nF.className="Cropping2D";$e.registerClass(nF);var rF=class extends Xt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ar(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Oje(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){let t=e[2]==null?null:this.size[0]*e[2],n=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,n]}else{let t=e[1]==null?null:this.size[0]*e[1],n=e[2]==null?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return le(()=>{let n=Tt(e),r=n.shape;if(this.dataFormat==="channelsFirst"){n=Ut(n,[0,2,3,1]);let i=this.size[0]*r[2],a=this.size[1]*r[3],s=this.interpolation==="nearest"?$s.resizeNearestNeighbor(n,[i,a]):$s.resizeBilinear(n,[i,a]);return Ut(s,[0,3,1,2])}else{let i=this.size[0]*r[1],a=this.size[1]*r[2];return this.interpolation==="nearest"?$s.resizeNearestNeighbor(n,[i,a]):$s.resizeBilinear(n,[i,a])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}};rF.className="UpSampling2D";$e.registerClass(rF);function kHe(e,t,n=[1,1],r="valid",i,a){return le(()=>{i==null&&(i=Qo()),Ar(i);let s=JL(e,i);if(e.rank!==4)throw new de(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new de(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return s=Xf(s,t,n,r==="same"?"same":"valid","NHWC",a),i==="channelsFirst"&&(s=Ut(s,[0,3,1,2])),s})}var iF=class extends Kne{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=hr(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=ni(e.depthwiseConstraint),this.depthwiseRegularizer=fr(e.depthwiseRegularizer)}build(e){if(e=pn(e),e.length<4)throw new de(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);let t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new de(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);let n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return le(()=>{e=Tt(e);let n=kHe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(n=sl(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),n})}computeOutputShape(e){e=pn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Vo(t,this.kernelSize[0],this.padding,this.strides[0]),a=Vo(n,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,a]:[e[0],i,a,r]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=wr(this.depthwiseInitializer),e.depthwiseRegularizer=Zn(this.depthwiseRegularizer),e.depthwiseConstraint=ti(this.depthwiseRegularizer),e}};iF.className="DepthwiseConv2D";$e.registerClass(iF);function tre(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new de("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(a){return a==null||Array.isArray(a)?a:[a]}return t=i(t),n=i(n),{inputs:e,initialState:t,constants:n}}function nre(e,t,n,r=!1,i,a,s=!1,o=!1){return le(()=>{let l=t.shape.length;if(l<3)throw new de(`Input should be at least 3D, but is ${l}D.`);let u=[1,0].concat(Yo(2,l));if(t=Ut(t,u),a!=null)throw new qt("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&(i=Me(Me(i,"bool"),"float32"),i.rank===l-1&&(i=hi(i,-1)),i=Ut(i,u)),r&&(t=zs(t,0),i!=null&&(i=zs(i,0)));let c=[],d,p=n,h=t.shape[0],m=Ir(t),g;i!=null&&(g=Ir(i));for(let y=0;y<h;++y){let b=m[y],_=le(()=>e(b,p));if(i==null)d=_[0],p=_[1];else{let k=le(()=>{let C=g[y],$=Ve(ys(C),C),N=we(ae(_[0],C),ae(p[0],$)),A=p.map((D,O)=>we(ae(_[1][O],C),ae(D,$)));return{output:N,newStates:A}});d=k.output,p=k.newStates}o&&c.push(d)}let v;return o&&(v=Wr(c,1)),[d,v,p]})}var Xu=class rre extends Xt{constructor(t){super(t);let n;if(t.cell==null)throw new de("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new iT({cells:t.cell}):n=t.cell,n.stateSize==null)throw new de("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new zr({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){let t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Yo(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){EP(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);let r=n[0],i;if(this.returnSequences?i=[t[0],t[1],r]:i=[t[0],r],this.returnState){let a=[];for(let s of n)a.push([t[0],s]);return[i].concat(a)}else return i}computeMask(t,n){return le(()=>{Array.isArray(n)&&(n=n[0]);let r=this.returnSequences?n:null;if(this.returnState){let i=this.states.map(a=>null);return[r].concat(i)}else return r})}get states(){if(this.states_==null){let t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<t;++r)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new qt("Constants support is not implemented in RNN yet.");EP(t)&&(t=t[0]),t=t;let n=this.stateful?t[0]:null,r=t.slice(2);this.inputSpec[0]=new zr({shape:[n,null,...r]});let i=[t[0]].concat(t.slice(2));this.cell.build(i);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!P.arraysEqual(this.stateSpec.map(s=>s.shape[s.shape.length-1]),a))throw new de(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(s=>new zr({shape:[null,s]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){le(()=>{if(!this.stateful)throw new wc("Cannot call resetStates() on an RNN Layer that is not stateful.");let r=this.inputSpec[0].shape[0];if(r==null)throw new de("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>br([r,i])):this.states_=[br([r,this.cell.stateSize])];else if(t==null)Rt(this.states_),this.keptStates!=null&&(Rt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>br([r,i])):this.states_[0]=br([r,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new de(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):Rt(this.states_);for(let i=0;i<this.states_.length;++i){let a=t[i],s=Array.isArray(this.cell.stateSize)?this.cell.stateSize[i]:this.cell.stateSize,o=[r,s];if(!P.arraysEqual(a.shape,o))throw new de(`State ${i} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${a.shape}`);this.states_[i]=a}}this.states_=this.states_.map(i=>Jr(i.clone()))})}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});let a=tre(t,r,i,this.numConstants);t=a.inputs,r=a.initialState,i=a.constants;let s=[],o=[];if(r!=null){n.initialState=r,s=s.concat(r),this.stateSpec=[];for(let l of r)this.stateSpec.push(new zr({shape:l.shape}));o=o.concat(this.stateSpec)}if(i!=null&&(n.constants=i,s=s.concat(i),this.numConstants=i.length),s[0]instanceof el){let l=[t].concat(s),u=this.inputSpec.concat(o),c=this.inputSpec;this.inputSpec=u;let d=super.apply(l,n);return this.inputSpec=c,d}else return super.apply(t,n)}call(t,n){return le(()=>{let r=n==null?null:n.mask,i=n==null?null:n.training,a=n==null?null:n.initialState;t=Tt(t),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(t));let s=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==s)throw new de(`RNN Layer has ${s} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let o={training:i},l=nre((h,m)=>{let g=this.cell.call([h].concat(m),o);return[g[0],g.slice(1)]},t,a,this.goBackwards,r,null,this.unroll,this.returnSequences),u=l[0],c=l[1],d=l[2];this.stateful&&this.resetStates(d,i);let p=this.returnSequences?c:u;return this.returnState?[p].concat(d):p})}getInitialState(t){return le(()=>{let n=br(t.shape);return n=lt(n,[1,2]),n=Rw(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?TP(n,[1,r]):n):this.cell.stateSize>1?[TP(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){let t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);let r=this.cell.getConfig();return this.getClassName()===rre.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),t),n)}static fromConfig(t,n,r={}){let i=n.cell,a=Wo(i,r);return new t(Object.assign(n,{cell:a}))}};Xu.className="RNN";$e.registerClass(Xu);var Bw=class extends Xt{},nT=class extends Bw{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,mi(this.units,"units"),this.activation=fd(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=hr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=hr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=hr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=fr(e.kernelRegularizer),this.recurrentRegularizer=fr(e.recurrentRegularizer),this.biasRegularizer=fr(e.biasRegularizer),this.kernelConstraint=ni(e.kernelConstraint),this.recurrentConstraint=ni(e.recurrentConstraint),this.biasConstraint=ni(e.biasConstraint),this.dropout=sy([1,pd([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=sy([1,pd([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=pn(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return le(()=>{if(e=e,e.length!==2)throw new de(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let n=e[1];e=e[0];let r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=md({ones:()=>ys(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=md({ones:()=>ys(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i,a=this.dropoutMask,s=this.recurrentDropoutMask;a!=null?i=Bl(ae(e,a),this.kernel.read()):i=Bl(e,this.kernel.read()),this.bias!=null&&(i=sl(i,this.bias.read())),s!=null&&(n=ae(n,s));let o=we(i,Bl(n,this.recurrentKernel.read()));return this.activation!=null&&(o=this.activation.apply(o)),[o,o]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:hd(this.activation),useBias:this.useBias,kernelInitializer:wr(this.kernelInitializer),recurrentInitializer:wr(this.recurrentInitializer),biasInitializer:wr(this.biasInitializer),kernelRegularizer:Zn(this.kernelRegularizer),recurrentRegularizer:Zn(this.recurrentRegularizer),biasRegularizer:Zn(this.biasRegularizer),activityRegularizer:Zn(this.activityRegularizer),kernelConstraint:ti(this.kernelConstraint),recurrentConstraint:ti(this.recurrentConstraint),biasConstraint:ti(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}};nT.className="SimpleRNNCell";$e.registerClass(nT);var aF=class extends Xu{constructor(e){e.cell=new nT(e),super(e)}call(e,t){return le(()=>{this.cell.dropoutMask!=null&&(Rt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Rt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})})}static fromConfig(e,t){return new e(t)}};aF.className="SimpleRNN";$e.registerClass(aF);var rT=class extends Bw{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new de("GRUCell does not support reset_after parameter set to true.");this.units=e.units,mi(this.units,"units"),this.activation=fd(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=fd(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=hr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=hr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=hr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=fr(e.kernelRegularizer),this.recurrentRegularizer=fr(e.recurrentRegularizer),this.biasRegularizer=fr(e.biasRegularizer),this.kernelConstraint=ni(e.kernelConstraint),this.recurrentConstraint=ni(e.recurrentConstraint),this.biasConstraint=ni(e.biasConstraint),this.dropout=sy([1,pd([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=sy([1,pd([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=pn(e);let t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return le(()=>{if(e=e,e.length!==2)throw new de(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);let n=t.training==null?!1:t.training,r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=md({ones:()=>ys(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=md({ones:()=>ys(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));let i=this.dropoutMask,a=this.recurrentDropoutMask,s,o,l;0<this.dropout&&this.dropout<1&&(e=ae(e,i[0]));let u=Bl(e,this.kernel.read());this.useBias&&(u=sl(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=ae(r,a[0]));let c=this.recurrentKernel.read(),[d,p]=La(c,[2*this.units,this.units],c.rank-1),h=Bl(r,d),[m,g,v]=La(u,3,u.rank-1),[y,b]=La(h,2,h.rank-1);s=this.recurrentActivation.apply(we(m,y)),o=this.recurrentActivation.apply(we(g,b));let _=Bl(ae(o,r),p);l=this.activation.apply(we(v,_));let k=we(ae(s,r),ae(we(1,Yn(s)),l));return[k,k]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:hd(this.activation),recurrentActivation:hd(this.recurrentActivation),useBias:this.useBias,kernelInitializer:wr(this.kernelInitializer),recurrentInitializer:wr(this.recurrentInitializer),biasInitializer:wr(this.biasInitializer),kernelRegularizer:Zn(this.kernelRegularizer),recurrentRegularizer:Zn(this.recurrentRegularizer),biasRegularizer:Zn(this.biasRegularizer),activityRegularizer:Zn(this.activityRegularizer),kernelConstraint:ti(this.kernelConstraint),recurrentConstraint:ti(this.recurrentConstraint),biasConstraint:ti(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}};rT.className="GRUCell";$e.registerClass(rT);var sF=class extends Xu{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new rT(e),super(e)}call(e,t){return le(()=>{this.cell.dropoutMask!=null&&(Rt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Rt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};sF.className="GRU";$e.registerClass(sF);var Ww=class extends Bw{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,mi(this.units,"units"),this.activation=fd(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=fd(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=hr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=hr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=hr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=fr(e.kernelRegularizer),this.recurrentRegularizer=fr(e.recurrentRegularizer),this.biasRegularizer=fr(e.biasRegularizer),this.kernelConstraint=ni(e.kernelConstraint),this.recurrentConstraint=ni(e.recurrentConstraint),this.biasConstraint=ni(e.biasConstraint),this.dropout=sy([1,pd([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=sy([1,pd([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=pn(e);let n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){let i=this.biasInitializer,a=this.units;r=new(t=class extends vo{apply(s,o){let l=i.apply([a]),u=new V$().apply([a]),c=i.apply([a*2]);return yU(yU(l,u),c)}},t.className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return le(()=>{let n=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new de(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1],i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=md({ones:()=>ys(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=md({ones:()=>ys(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let a=this.dropoutMask,s=this.recurrentDropoutMask,o,l,u,c;0<this.dropout&&this.dropout<1&&(e=ae(e,a[0]));let d=Bl(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=ae(r,s[0])),d=we(d,Bl(r,this.recurrentKernel.read())),this.useBias&&(d=sl(d,this.bias.read()));let[p,h,m,g]=La(d,4,d.rank-1);o=this.recurrentActivation.apply(p),l=this.recurrentActivation.apply(h),u=we(ae(l,i),ae(o,this.activation.apply(m))),c=this.recurrentActivation.apply(g);let v=ae(c,this.activation.apply(u));return[v,v,u]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:hd(this.activation),recurrentActivation:hd(this.recurrentActivation),useBias:this.useBias,kernelInitializer:wr(this.kernelInitializer),recurrentInitializer:wr(this.recurrentInitializer),biasInitializer:wr(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Zn(this.kernelRegularizer),recurrentRegularizer:Zn(this.recurrentRegularizer),biasRegularizer:Zn(this.biasRegularizer),activityRegularizer:Zn(this.activityRegularizer),kernelConstraint:ti(this.kernelConstraint),recurrentConstraint:ti(this.recurrentConstraint),biasConstraint:ti(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}};Ww.className="LSTMCell";$e.registerClass(Ww);var oF=class extends Xu{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Ww(e),super(e)}call(e,t){return le(()=>{this.cell.dropoutMask!=null&&(Rt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Rt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};oF.className="LSTM";$e.registerClass(oF);var iT=class extends Bw{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return le(()=>{e=e;let n=e.slice(1),r=[];for(let s of this.cells.slice().reverse())Array.isArray(s.stateSize)?r.push(n.splice(0,s.stateSize.length)):r.push(n.splice(0,1));r.reverse();let i=[],a;for(let s=0;s<this.cells.length;++s){let o=this.cells[s];n=r[s],s===0?a=[e[0]].concat(n):a=[a[0]].concat(n),a=o.call(a,t),i.push(a.slice(1))}n=[];for(let s of i.slice().reverse())n.push(...s);return[a[0]].concat(n)})}build(e){EP(e)&&(e=e[0]),e=e;let t;this.cells.forEach((n,r)=>{Ap(`RNNCell_${r}`,()=>{n.build(e),Array.isArray(n.stateSize)?t=n.stateSize[0]:t=n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){let e=super.getConfig(),t=r=>({className:r.getClassName(),config:r.getConfig()}),n={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),n)}static fromConfig(e,t,n={}){let r=[];for(let i of t.cells)r.push(Wo(i,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let n of this.cells)t.push(...n.trainableWeights);return t.concat(e)}return e}getWeights(){let e=[];for(let t of this.cells)e.push(...t.weights);return OP(e)}setWeights(e){let t=[];for(let n of this.cells){let r=n.weights.length,i=e.splice(r);for(let a=0;a<n.weights.length;++a)t.push([n.weights[a],i[a]])}OL(t)}};iT.className="StackedRNNCells";$e.registerClass(iT);function md(e){let{ones:t,rate:n,training:r=!1,count:i=1,dropoutFunc:a}=e,s=()=>a!=null?a(t(),n):one(t(),n),o=()=>Lw(s,t,r);return!i||i<=1?Jr(o().clone()):Array(i).fill(void 0).map(o).map(l=>Jr(l.clone()))}var SHe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},ire=class extends Xu{constructor(e){if(e.unroll)throw new qt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new qt("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new zr({ndim:5})]}call(e,t){return le(()=>{if(this.cell.dropoutMask!=null&&(Rt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Rt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new de("ConvRNN2D cell does not support constants");let n=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return le(()=>{let{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)],a=br(i);return Array.isArray(t)?Array(t.length).fill(a):[a]})}resetStates(e,t=!1){le(()=>{if(!this.stateful)throw new wc("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)];if(n[0]==null)throw new de("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>br(i)):this.states_=[br(i)];else if(e==null)Rt(this.states_),this.keptStates!=null&&(Rt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>br(i)):this.states_[0]=br(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new de(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):Rt(this.states_);for(let a=0;a<this.states_.length;++a){let s=e[a],o=i;if(!P.arraysEqual(s.shape,o))throw new de(`State ${a} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${s.shape}`);this.states_[a]=s}}this.states_=this.states_.map(a=>Jr(a.clone()))})}computeSingleOutputShape(e){let{dataFormat:t,filters:n,kernelSize:r,padding:i,strides:a,dilationRate:s}=this.cell,o=t==="channelsFirst",l=e[o?3:2],u=e[o?4:3],c=Vo(l,r[0],i,a[0],s[0]),d=Vo(u,r[1],i,a[1],s[1]);return[...e.slice(0,2),...o?[n,c,d]:[c,d,n]]}};ire.className="ConvRNN2D";var aT=class extends Ww{constructor(e){let{filters:t,kernelSize:n,strides:r,padding:i,dataFormat:a,dilationRate:s}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,mi(this.filters,"filters"),this.kernelSize=$g(n,2,"kernelSize"),this.kernelSize.forEach(o=>mi(o,"kernelSize")),this.strides=$g(r||1,2,"strides"),this.strides.forEach(o=>mi(o,"strides")),this.padding=i||"valid",Hs(this.padding),this.dataFormat=a||"channelsLast",Ar(this.dataFormat),this.dilationRate=$g(s||1,2,"dilationRate"),this.dilationRate.forEach(o=>mi(o,"dilationRate"))}build(e){var t;e=pn(e);let n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new de(`The channel dimension of the input should be defined. Found ${e[n]}`);let r=e[n],i=4,a=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let s=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",s,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let o;if(this.unitForgetBias){let l=this.biasInitializer,u=this.filters;o=new(t=class extends vo{apply(c,d){let p=l.apply([u]),h=Aa([u]),m=l.apply([u*2]);return kL([p,h,m])}},t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return le(()=>{if(e.length!==3)throw new de(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let n=t.training||!1,r=e[0],i=e[1],a=e[2],s=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=md({ones:()=>ys(r),rate:this.dropout,training:n,count:s,dropoutFunc:this.dropoutFunc}));let o=this.dropoutMask,l=(Q,X,Y)=>!X||!X[Y]?Q:ae(X[Y],Q),u=l(r,o,0),c=l(r,o,1),d=l(r,o,2),p=l(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=md({ones:()=>ys(i),rate:this.recurrentDropout,training:n,count:s,dropoutFunc:this.dropoutFunc}));let h=this.recurrentDropoutMask,m=l(i,h,0),g=l(i,h,1),v=l(i,h,2),y=l(i,h,3),b=3,[_,k,C,$]=La(this.kernel.read(),s,b),[N,A,D,O]=this.useBias?La(this.bias.read(),s):[null,null,null,null];u=this.inputConv(u,_,N,this.padding),c=this.inputConv(c,k,A,this.padding),d=this.inputConv(d,C,D,this.padding),p=this.inputConv(p,$,O,this.padding);let[F,E,z,q]=La(this.recurrentKernel.read(),s,b);m=this.recurrentConv(m,F),g=this.recurrentConv(g,E),v=this.recurrentConv(v,z),y=this.recurrentConv(y,q);let H=this.recurrentActivation.apply(we(u,m)),J=this.recurrentActivation.apply(we(c,g)),ee=we(ae(J,a),ae(H,this.activation.apply(we(d,v)))),V=ae(this.recurrentActivation.apply(we(p,y)),this.activation.apply(ee));return[V,V,ee]})}getConfig(){let e=super.getConfig(),t=SHe(e,["units"]),n={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),n)}inputConv(e,t,n,r){let i=ga(e,t,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return n?sl(i,n,this.dataFormat):i}recurrentConv(e,t){return ga(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}};aT.className="ConvLSTM2DCell";$e.registerClass(aT);var lF=class extends ire{constructor(e){let t=new aT(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}};lF.className="ConvLSTM2D";$e.registerClass(lF);var sT=class extends Xt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;let t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(this.noiseShape[r]==null?t[r]:this.noiseShape[r]);return n}call(e,t){return le(()=>{this.invokeCallHook(e,t);let n=Tt(e);if(0<this.rate&&this.rate<1){let r=t.training==null?!1:t.training,i=this.getNoiseShape(n);return Lw(()=>one(n,this.rate,i,this.seed),()=>n,r)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}};sT.className="Dropout";$e.registerClass(sT);var uF=class extends sT{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}};uF.className="SpatialDropout1D";$e.registerClass(uF);var cF=class extends Xt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,mi(this.units,"units"),this.activation=fd(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=hr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=hr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=ni(e.kernelConstraint),this.biasConstraint=ni(e.biasConstraint),this.kernelRegularizer=fr(e.kernelRegularizer),this.biasRegularizer=fr(e.biasRegularizer),this.activityRegularizer=fr(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=pn(e);let t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=pn(e);let t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return le(()=>{this.invokeCallHook(e,t);let n=Tt(e),r=ene(this.activation.getClassName()),i;return r!=null?i=Bl(n,this.kernel.read(),r,this.bias?this.bias.read():null):(i=Bl(n,this.kernel.read()),this.bias!=null&&(i=sl(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){let e={units:this.units,activation:hd(this.activation),useBias:this.useBias,kernelInitializer:wr(this.kernelInitializer),biasInitializer:wr(this.biasInitializer),kernelRegularizer:Zn(this.kernelRegularizer),biasRegularizer:Zn(this.biasRegularizer),activityRegularizer:Zn(this.activityRegularizer),kernelConstraint:ti(this.kernelConstraint),biasConstraint:ti(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}};cF.className="Dense";$e.registerClass(cF);var dF=class extends Xt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=pn(e);for(let t of e.slice(1))if(t==null)throw new de(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Jc(e,1)]}call(e,t){return le(()=>{this.invokeCallHook(e,t);let n=Tt(e);if(this.dataFormat==="channelsFirst"&&n.rank>1){let r=[0];for(let i=2;i<n.rank;++i)r.push(i);r.push(1),n=Ut(n,r)}return Lje(n)})}getConfig(){let e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);let t=super.getConfig();return Object.assign(e,t),e}};dF.className="Flatten";$e.registerClass(dF);var pF=class extends Xt{constructor(e){super(e),this.supportsMasking=!0,this.activation=fd(e.activation)}call(e,t){return le(()=>{this.invokeCallHook(e,t);let n=Tt(e);return this.activation.apply(n)})}getConfig(){let e={activation:hd(this.activation)},t=super.getConfig();return Object.assign(e,t),e}};pF.className="Activation";$e.registerClass(pF);var hF=class extends Xt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return le(()=>(e=Tt(e),Rje(e,this.n)))}getConfig(){let e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}};hF.className="RepeatVector";$e.registerClass(hF);var fF=class extends Xt{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){let n="Total size of new array must be unchanged.",r=t.slice(),i=1,a=null;for(let o=0;o<r.length;++o){let l=r[o];if(this.isUnknown(l))if(a===null)a=o;else throw new de("Can only specifiy one unknown dimension.");else i*=l}let s=Jc(e);if(a!==null){if(i===0||s%i!==0)throw new de(n);r[a]=s/i}else if(s!==i)throw new de(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return le(()=>{this.invokeCallHook(e,t);let n=Tt(e),r=n.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return oe(n,i)})}getConfig(){let e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}};fF.className="Reshape";$e.registerClass(fF);var mF=class extends Xt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);let t=Yo(1,e.dims.length+1);if(!P.arraysEqual(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new zr({ndim:this.dims.length+1})]}computeOutputShape(e){e=pn(e);let t=e.slice();return this.dims.forEach((n,r)=>{t[r+1]=e[n]}),t}call(e,t){return Ut(Tt(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}};mF.className="Permute";$e.registerClass(mF);var gF=class extends Xt{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){let n=Tt(e);return a1(lh(n,this.maskValue),-1)}call(e,t){return le(()=>{this.invokeCallHook(e,t);let n=Tt(e),r=a1(lh(n,this.maskValue),-1,!0);return ae(n,Me(r,n.dtype))})}};gF.className="Masking";$e.registerClass(gF);var yF=class extends Xt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(En(e.inputLength))}this.inputDim=e.inputDim,mi(this.inputDim,"inputDim"),this.outputDim=e.outputDim,mi(this.outputDim,"outputDim"),this.embeddingsInitializer=hr(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=fr(e.embeddingsRegularizer),this.activityRegularizer=fr(e.activityRegularizer),this.embeddingsConstraint=ni(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return le(()=>this.maskZero?(e=Tt(e),lh(e,sn(e))):null)}computeOutputShape(e){if(e=pn(e),this.inputLength==null)return[...e,this.outputDim];let t=En(this.inputLength);if(t.length!==e.length-1)throw new de(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let n=0;for(let r=0;r<t.length;++r){let i=t[r],a=e[r+1];if(i!=null&&a!=null&&i!==a)throw new de(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(t[n]=a),n++}}return[e[0],...t,this.outputDim]}call(e,t){return le(()=>{this.invokeCallHook(e,t);let n=Tt(e);n.dtype!=="int32"&&(n=Lu(n,"int32"));let r=sne(this.embeddings.read(),oe(n,[n.size]));return oe(r,pn(this.computeOutputShape(n.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:wr(this.embeddingsInitializer),embeddingsRegularizer:Zn(this.embeddingsRegularizer),activityRegularizer:Zn(this.activityRegularizer),embeddingsConstraint:ti(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}};yF.className="Embedding";$e.registerClass(yF);var tm=class extends Xt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new qt}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;let n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){let i=e[e.length-t.length+r],a=t[r];if(i==null||a==null||i<0||a<0)n.push(null);else if(i===1)n.push(a);else if(a===1)n.push(i);else{if(i!==a)throw new de("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(i)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[pn(e)]),e=e,e.length<2)throw new de(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(let i of e)i!=null&&i[0]!==null&&t.push(i[0]);if(t=Xc(t),t.length>1)throw new de(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let n=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){let a=e[i]==null?null:e[i].slice(1);n=this.computeElementwiseOpOutputShape(n,a)}let r=e.map(i=>i.length);e.indexOf(null)===-1&&Xc(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return le(()=>{if(e=e,this.reshapeRequired){let n=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){let i=pd(r);for(let a of e){let s=a.rank;for(let o=0;o<i-s;++o)a=Rw(a,1);n.push(a)}return this.mergeFunction(n)}else{let i=!1;for(let o of e){let l=o.rank;if(l==null){let u=o.shape,c=u[0],d=u.slice(1).concat([c]),p=oe(o,[c].concat(Jc(u.slice(1))));p=Ut(p,[1,0]),p=oe(p,d),n.push(p),i=!0}else if(l>1){let u=Yo(1,l).concat([0]);n.push(Ut(o,u)),i=!0}else n.push(o)}let a=this.mergeFunction(n),s=a.rank;if(i){if(s==null){let o=a.shape,l=o.length,u=o[l-1],c=[u].concat(o.slice(0,o.length-1));a=oe(Ut(oe(a,[-1,u]),[1,0]),c)}else if(s>1){let o=[s-1].concat(Yo(0,s-1));a=Ut(a,o)}}return a}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let r=1;r<e.length;++r){let i=e[r]==null?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,i)}let n=[];for(let r of e)r!=null&&r[0]!==null&&n.push(r[0]);return n=Xc(n),n.length===1?t=n.concat(t):t=[null].concat(t),t}computeMask(e,t){return le(()=>{if(t==null)return null;if(!Array.isArray(t))throw new de("`mask` should be an Array");if(!Array.isArray(e))throw new de("`inputs` should be an Array");if(t.length!==e.length)throw new de(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(r=>r==null))return null;t=t.map(r=>r==null?r:hi(r,0));let n=t[0];for(let r=1;r<t.length-1;++r)n=ho(n,t[r]);return n})}},vF=class extends tm{constructor(e){super(e)}mergeFunction(e){return le(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=we(t,e[n]);return t})}};vF.className="Add";$e.registerClass(vF);var bF=class extends tm{constructor(e){super(e)}mergeFunction(e){return le(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=ae(t,e[n]);return t})}};bF.className="Multiply";$e.registerClass(bF);var wF=class extends tm{constructor(e){super(e)}mergeFunction(e){return le(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=we(t,e[n]);return ae(1/e.length,t)})}};wF.className="Average";$e.registerClass(wF);var xF=class extends tm{constructor(e){super(e)}mergeFunction(e){return le(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Xl(t,e[n]);return t})}};xF.className="Maximum";$e.registerClass(xF);var _F=class extends tm{constructor(e){super(e)}mergeFunction(e){return le(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=cd(t,e[n]);return t})}};_F.className="Minimum";$e.registerClass(_F);var kF=class extends tm{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new de("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(let r of e)if(r!=null){t=!1;break}if(t)return;let n=[];for(let r=0;r<e.length;++r){let i=e[r].slice();i.splice(this.axis,1);let a=!1;for(let s of n)if(P.arraysEqual(s,i)){a=!0;break}a||n.push(i)}if(n.length>1)throw new de("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return le(()=>kL(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new de("A `Concatenate` layer should be called on a list of inputs.");let t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(let i of t.slice(1)){if(n[r]==null||i[r]==null){n[r]=null;break}n[r]+=i[r]}return n}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new de("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new de("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new de(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return le(()=>{let n=!0;if(t.forEach(a=>{if(a!=null){n=!1;return}}),n)return null;let r=[];for(let a=0;a<e.length;++a)t[a]==null?r.push(Me(ys(e[a]),"bool")):t[a].rank<e[a].rank?r.push(hi(t[a],-1)):r.push(t[a]);let i=Wn(r,this.axis);return u$(i,-1,!1)})}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};kF.className="Concatenate";$e.registerClass(kF);function W0(e,t){for(;e<0;)e+=t;return e}function CHe(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new qt("batchDot is not implemented for tensors of 4D or higher rank yet");if(P.assert(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),P.assert(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new qt("batchDot is not implemented for complex64-type Tensors yet.");let r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);let a=n;return le(()=>{let s;if(r>i){s=r-i;let l=[];for(let u=0;u<s;++u)l.push(1);t=oe(t,t.shape.concat(l))}else if(i>r){s=i-r;let l=[];for(let u=0;u<s;++u)l.push(1);e=oe(e,e.shape.concat(l))}else s=0;let o;if(e.shape.length===2&&t.shape.length===2)a[0]===a[1]?o=lt(ae(e,t),a[0]):o=lt(ae(Ut(e,[1,0]),t),a[1]);else{let l=a[0]!==e.shape.length-1,u=a[1]===t.shape.length-1;o=jt(e,t,l,u)}if(s>0){let l;r>i?l=r+i-3:l=r-1;let u=[];for(let c=l;c<l+s;++c)u.push(c);o=Ld(o,u)}return o.shape.length===1&&(o=hi(o,1)),o})}var SF=class extends tm{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){P.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0],n=e[1];if(t.length>3||n.length>3)throw new qt("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new de(`Dimension incompatibility: ${t[r[0]]} !== ${n[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new de(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],n=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,a)=>W0(i,e[a].shape.length)):r=[W0(this.axes,t.shape.length),W0(this.axes,n.shape.length)],this.normalize&&(t=eI(t,r[0]),n=eI(n,r[1])),CHe(t,n,r)}interpretAxes(e,t){let n;return Array.isArray(this.axes)?n=this.axes:n=[W0(this.axes,e.length),W0(this.axes,t.length)],n}computeOutputShape(e){P.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new qt("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);let i=t.concat(n);return i.length===1&&i.push(1),i}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}};SF.className="Dot";$e.registerClass(SF);var CF=class extends Xt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return le(()=>{this.invokeCallHook(e,t);let n=Tt(e);return Lw(()=>we(W$(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}};CF.className="GaussianNoise";$e.registerClass(CF);var IF=class extends Xt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return le(()=>{this.invokeCallHook(e,t);let n=Tt(e);return this.rate>0&&this.rate<1?Lw(()=>{let r=Math.sqrt(this.rate/(1-this.rate));return ae(n,W$(n.shape,1,r))},()=>n,t.training||!1):n})}};IF.className="GaussianDropout";$e.registerClass(IF);var $F=class extends Xt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Tt(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return le(()=>{if(this.rate<1&&this.rate>0){let n=this._getNoiseShape(e);return Lw(()=>{let r=Tt(e),i=-1.6732632423543772*1.0507009873554805,a=qu(Rd(n),this.rate);a=Lu(a,"float32");let s=((1-this.rate)*(1+this.rate*i**2))**-.5,o=-s*i*this.rate,l=we(ae(r,a),ae(we(a,-1),i));return we(ae(l,s),o)},()=>Tt(e),t.training||!1)}return e})}};$F.className="AlphaDropout";$e.registerClass($F);function d1(e,t,n,r,i,a=.001){let s;if(e.rank===2)s=fD(e,t,n,r,i,a);else if(e.rank===3)s=mD(e,t,n,r,i,a);else if(e.rank===4)s=gD(e,t,n,r,i,a);else throw new qt(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return s}function IHe(e,t,n,r,i=.001){return le(()=>{let a=$w(e,r),s=a.mean,o=a.variance;return[d1(e,s,o,n,t,i),s,o]})}function $He(e,t,n,r,i=.001){return le(()=>{let a=$w(e,r),s=a.mean,o=a.variance,l=[];for(let h of Yo(0,e.rank))r.indexOf(h)!==-1?l.push(1):l.push(e.shape[h]);let u=oe(s,l),c=oe(o,l),d=t==null?null:oe(t,l),p=n==null?null:oe(n,l);return[d1(e,u,c,p,d,i),s,o]})}function THe(e,t,n,r,i=.001){return P.arraysEqual(r.slice().sort(),Yo(0,e.rank-1))?IHe(e,t,n,r,i):$He(e,t,n,r,i)}var TF=class extends Xt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=hr(e.betaInitializer||"zeros"),this.gammaInitializer=hr(e.gammaInitializer||"ones"),this.movingMeanInitializer=hr(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=hr(e.movingVarianceInitializer||"ones"),this.betaConstraint=ni(e.betaConstraint),this.gammaConstraint=ni(e.gammaConstraint),this.betaRegularizer=fr(e.betaRegularizer),this.gammaRegularizer=fr(e.gammaRegularizer)}build(e){e=pn(e);let t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(n==null)throw new de(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new zr({ndim:e.length,axes:{[t]:n}})];let r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return le(()=>{let n=t.training==null?!1:t.training,r=Tt(e),i=r.shape,a=i.length,s=Yo(0,a),o=this.axis>=0?this.axis:this.axis+a;s.splice(o,1);let l=ch(1,a);l[o]=i[o];let u=s.slice();u.sort();let c=!P.arraysEqual(u,Yo(0,a).slice(0,a-1)),d=()=>{if(c){let v=oe(this.movingMean.read(),l),y=oe(this.movingVariance.read(),l),b=this.center?oe(this.beta.read(),l):null,_=this.scale?oe(this.gamma.read(),l):null;return d1(r,v,y,b,_,this.epsilon)}else return d1(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!n)return d();let[p,h,m]=THe(r,this.gamma.read(),this.beta.read(),s,this.epsilon),g=(v,y,b)=>{le(()=>{let _=1-b,k=v.read(),C=ae(Ve(k,y),_);v.write(Ve(k,C))})};return g(this.movingMean,h,this.momentum),g(this.movingVariance,m,this.momentum),p})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:wr(this.betaInitializer),gammaInitializer:wr(this.gammaInitializer),movingMeanInitializer:wr(this.movingMeanInitializer),movingVarianceInitializer:wr(this.movingVarianceInitializer),betaRegularizer:Zn(this.betaRegularizer),gammaRegularizer:Zn(this.gammaRegularizer),betaConstraint:ti(this.betaConstraint),gammaConstraint:ti(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}};TF.className="BatchNormalization";$e.registerClass(TF);var NF=class extends Xt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(let t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=hr(e.betaInitializer||"zeros"),this.gammaInitializer=hr(e.gammaInitializer||"ones"),this.betaRegularizer=fr(e.betaRegularizer),this.gammaRegularizer=fr(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=pn(e);let t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=t);for(let i of this.axis)if(i<0||i>=t)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Xc(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);let n=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){let n=Tt(e),r=n.shape,i=r.length;return le(()=>{let{mean:a,variance:s}=$w(n,this.axis,!0),o=ch(1,i);for(let h of this.axis)o[h]=r[h];let l=h=>h!=null&&h.shape.length!==i?oe(h,o):h,u=this.scale?l(this.gamma.read()):null,c=this.center?l(this.beta.read()):null,d=[],p=[];for(let h=0;h<i;++h)this.axis.indexOf(h)!==-1?(d.push(r[h]),p.push(1)):(d.push(1),p.push(r[h]));return a=ss(a,d),s=ss(s,d),u!=null&&(u=ss(u,p)),c!=null&&(c=ss(c,p)),d1(n,a,s,c,u,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:wr(this.betaInitializer),gammaInitializer:wr(this.gammaInitializer),betaRegularizer:Zn(this.betaRegularizer),gammaRegularizer:Zn(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}};NF.className="LayerNormalization";$e.registerClass(NF);function NHe(e,t,n){return le(()=>{if(e.rank!==4)throw new de(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new de("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Qo()),n!=="channelsLast"&&n!=="channelsFirst")throw new de(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],al(e,r)})}var EF=class extends Xt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Qo():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new de(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,n;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new de(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new de(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new zr({ndim:4})]}computeOutputShape(e){e=pn(e);let t,n;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?n=e[3]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],e[1],t,n]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?n=e[2]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],t,n,e[3]])}call(e,t){return le(()=>NHe(Tt(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};EF.className="ZeroPadding2D";$e.registerClass(EF);function oT(e,t,n,r,i,a){return le(()=>{Ar(i),nne(a),Hs(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=Qo()),a==null&&(a="max"),e=JL(e,i);let s,o=r==="same"?"same":"valid";return a==="max"?s=oi(e,t,n,o):s=Gu(e,t,n,o),i==="channelsFirst"&&(s=Ut(s,[0,3,1,2])),s})}function are(e,t,n,r,i,a){return le(()=>{Ar(i),nne(a),Hs(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Qo()),a==null&&(a="max"),e=qne(e,i);let s,o=r==="same"?"same":"valid";return a==="max"?s=WD(e,t,n,o):s=hD(e,t,n,o),i==="channelsFirst"&&(s=Ut(s,[0,4,1,2,3])),s})}var sre=class extends Xt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new de(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(mi(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new de(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);mi(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Hs(this.padding),this.inputSpec=[new zr({ndim:3})]}computeOutputShape(e){e=pn(e);let t=Vo(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return le(()=>{this.invokeCallHook(e,t),e=Rw(Tt(e),2);let n=this.poolingFunction(Tt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Ld(n,[2])})}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}},OF=class extends sre{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Ar(i),Hs(r),oT(e,t,n,r,i,"max")}};OF.className="MaxPooling1D";$e.registerClass(OF);var PF=class extends sre{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Ar(i),Hs(r),oT(e,t,n,r,i,"avg")}};PF.className="AveragePooling1D";$e.registerClass(PF);var ore=class extends Xt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new de(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];mi(this.poolSize,"poolSize"),mi(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ar(this.dataFormat),Hs(this.padding),this.inputSpec=[new zr({ndim:4})]}computeOutputShape(e){e=pn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=Vo(t,this.poolSize[0],this.padding,this.strides[0]),n=Vo(n,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return le(()=>(this.invokeCallHook(e,t),this.poolingFunction(Tt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},AF=class extends ore{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Ar(i),Hs(r),oT(e,t,n,r,i,"max")}};AF.className="MaxPooling2D";$e.registerClass(AF);var MF=class extends ore{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Ar(i),Hs(r),oT(e,t,n,r,i,"avg")}};MF.className="AveragePooling2D";$e.registerClass(MF);var lre=class extends Xt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new de(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];mi(this.poolSize,"poolSize"),mi(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ar(this.dataFormat),Hs(this.padding),this.inputSpec=[new zr({ndim:5})]}computeOutputShape(e){e=pn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=Vo(t,this.poolSize[0],this.padding,this.strides[0]),n=Vo(n,this.poolSize[1],this.padding,this.strides[1]),r=Vo(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return le(()=>(this.invokeCallHook(e,t),this.poolingFunction(Tt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},RF=class extends lre{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Ar(i),Hs(r),are(e,t,n,r,i,"max")}};RF.className="MaxPooling3D";$e.registerClass(RF);var DF=class extends lre{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Ar(i),Hs(r),are(e,t,n,r,i,"avg")}};DF.className="AveragePooling3D";$e.registerClass(DF);var ure=class extends Xt{constructor(e){super(e),this.inputSpec=[new zr({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new qt}},LF=class extends ure{constructor(e){super(e||{})}call(e,t){return le(()=>{let n=Tt(e);return vr(n,1)})}};LF.className="GlobalAveragePooling1D";$e.registerClass(LF);var FF=class extends ure{constructor(e){super(e||{})}call(e,t){return le(()=>{let n=Tt(e);return Ms(n,1)})}};FF.className="GlobalMaxPooling1D";$e.registerClass(FF);var cre=class extends Xt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ar(this.dataFormat),this.inputSpec=[new zr({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new qt}getConfig(){let e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},zF=class extends cre{call(e,t){return le(()=>{let n=Tt(e);return this.dataFormat==="channelsLast"?vr(n,[1,2]):vr(n,[2,3])})}};zF.className="GlobalAveragePooling2D";$e.registerClass(zF);var BF=class extends cre{call(e,t){return le(()=>{let n=Tt(e);return this.dataFormat==="channelsLast"?Ms(n,[1,2]):Ms(n,[2,3])})}};BF.className="GlobalMaxPooling2D";$e.registerClass(BF);var dre=class extends Xt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){let r=t.layer,i=Wo(r,n);delete t.layer;let a={layer:i};return Object.assign(a,t),new e(a)}},WF=class extends dre{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=pn(e),e.length<3)throw new de(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=pn(e);let t=[e[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return le(()=>(e=Tt(e),nre((n,r)=>[Tt(this.layer.call(n,t)),[]],e,[],!1,null,null,!1,!0)[1]))}};WF.className="TimeDistributed";$e.registerClass(WF);function EHe(e){Qf(Eje,"BidirectionalMergeMode",e)}var OHe="concat",VF=class extends dre{constructor(e){super(e);let t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=Wo(n),t.goBackwards=t.goBackwards!==!0;let r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=Wo(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?OHe:e.mergeMode,EHe(this.mergeMode),e.weights)throw new qt("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let n,r,i;return this.returnState&&(i=t.slice(1)),n=t[0],n=n,this.mergeMode==="concat"?(n[n.length-1]*=2,r=[n]):this.mergeMode==null?r=[n,n.slice()]:r=[n],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[n].concat(i).concat(i.slice()):Pa(r)}apply(e,t){let n=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});let i=tre(e,n,r,this.numConstants);if(e=i.inputs,n=i.initialState,r=i.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(n==null||n.length===0)&&r==null)return super.apply(e,t);let a=[],s=[];if(n!=null){let l=n.length;if(l%2>0)throw new de("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,a.push(...n);let u=n.map(c=>new zr({shape:c.shape}));this.forwardLayer.stateSpec=u.slice(0,l/2),this.backwardLayer.stateSpec=u.slice(l/2),s.push(...u)}if(r!=null)throw new qt("Support for constants in Bidirectional layers is not implemented yet.");let o=a[0]instanceof el;for(let l of a)if(l instanceof el!==o)throw new de("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){let l=[e].concat(a),u=this.inputSpec.concat(s),c=this.inputSpec;this.inputSpec=u;let d=super.apply(l,t);return this.inputSpec=c,d}else return super.apply(e,t)}call(e,t){return le(()=>{let n=t.initialState,r,i;if(n==null)r=this.forwardLayer.call(e,t),i=this.backwardLayer.call(e,t);else{let o=n.slice(0,n.length/2),l=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:o})),i=this.backwardLayer.call(e,Object.assign(t,{initialState:l}))}let a;this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=zs(i,1));let s;return this.mergeMode==="concat"?s=kL([r,i]):this.mergeMode==="sum"?s=we(r,i):this.mergeMode==="ave"?s=ae(.5,we(r,i)):this.mergeMode==="mul"?s=ae(r,i):this.mergeMode==null&&(s=[r,i]),this.returnState?this.mergeMode==null?s.concat(a):[s].concat(a):s})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Ap(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Ap(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let n;if(this.returnSequences?this.mergeMode==null?n=[t,t]:n=t:this.mergeMode==null?n=[null,null]:n=null,this.returnState){let r=this.forwardLayer.states.map(i=>null);return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}else return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){let n=Wo(t.layer);if(delete t.layer,t.numConstants!=null)throw new qt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let r=t;return r.layer=n,new e(r)}};VF.className="Bidirectional";$e.registerClass(VF);var jF=class extends Xt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return le(()=>(e=Tt(e),e.dtype!=="float32"&&(e=Lu(e,"float32")),we(ae(e,this.scale),this.offset)))}};jF.className="Rescaling";$e.registerClass(jF);var{resizeBilinear:PHe,cropAndResize:AHe}=$s,UF=class extends Xt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,i,a,s,o){return le(()=>{let l,u=!1,c=t/a,d=n/s,p=(r+t)/a,h=(i+n)/s,m=[c,d,p,h],g=[];e.rank===3?(u=!0,l=Wr([e])):l=e;for(let _=0;_<l.shape[0];_++)g.push(m);let v=fa(g,[g.length,4]),y=uh(0,g.length,1,"int32"),b=AHe(l,v,y,[r,i],"nearest");return Lu(u?Tt(Ir(b)):b,o)})}upsize(e,t,n,r){return le(()=>{let i=PHe(e,[t,n]);return Lu(i,r)})}call(e,t){return le(()=>{let n=Tt(e),r=n.dtype,i=n.shape,a=i[i.length-3],s=i[i.length-2],o=0;a!==this.height&&(o=Math.floor((a-this.height)/2));let l=0;return s!==this.width&&(l=Math.floor((s-this.width)/2),l===0&&(l=1)),o>=0&&l>=0?this.centerCrop(n,o,l,this.height,this.width,a,s,r):this.upsize(e,this.height,this.width,r)})}getConfig(){let e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=pn(e);let t=e.length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}};UF.className="CenterCrop";$e.registerClass(UF);function MHe(e,t,n,r){let i=Tt(e);if(i.dtype!=="int32"&&(i=Lu(i,"int32")),t==="int")return i;let a=i.shape;if(i.rank===0&&(i=hi(i,-1)),t==="oneHot"&&i.shape[i.shape.length-1]!==1&&(i=hi(i,-1)),i.rank>2)throw new de(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${a} which would result in output rank ${i.rank}.`);let s=["multiHot","oneHot"].includes(t),o=i,l;if(typeof r<"u"&&t==="count"?l=KC(o,r,n,s):l=KC(o,[],n,s),t!=="tfIdf")return l;if(r)return ae(l,r);throw new de("When outputMode is 'tfIdf', weights must be provided.")}var HF=class extends Xt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=pn(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return le(()=>{e=Tt(e),e.dtype!=="int32"&&(e=Lu(e,"int32"));let n;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new de(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);n=Tt(t.countWeights)}let r=Ms(e),i=Qg(e),a=Sa(this.numTokens,r).bufferSync().get(0),s=qu(i,0).bufferSync().get(0);if(!(a&&s))throw new de(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return MHe(e,this.outputMode,this.numTokens,n)})}};HF.className="CategoryEncoding";$e.registerClass(HF);var RHe=["bilinear","nearest"],MU=new Set(RHe),GF=class extends Xt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(MU.has(e.interpolation))this.interpolation=e.interpolation;else throw new de(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=pn(e);let t=e[2];return[this.height,this.width,t]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return le(()=>{let n=[this.height,this.width];if(this.interpolation==="bilinear")return $s.resizeBilinear(e,n,!this.cropToAspectRatio);if(this.interpolation==="nearest")return $s.resizeNearestNeighbor(e,n,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...MU]} are supported`)})}};GF.className="Resizing";$e.registerClass(GF);var pre=class{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}};pre.className="RandomSeed";var hre=class extends Xt{constructor(e){super(e),this.randomGenerator=new pre(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}};hre.className="BaseRandomLayer";var DHe=["bilinear","nearest"],RU=new Set(DHe),qF=class extends hre{constructor(e){super(e);let{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new de(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new de(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new de(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(n)if(RU.has(n))this.interpolation=n;else throw new de(`Invalid interpolation parameter: ${n} is not implemented`)}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=pn(e);let t=e[2];return[this.imgHeight,-1,t]}call(e,t){return le(()=>{let n=Tt(e);this.imgHeight=n.shape[n.shape.length-3];let r=n.shape[n.shape.length-2];this.widthFactor=Rd([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);let a=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return $s.resizeBilinear(e,a);case"nearest":return $s.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...RU]} are supported`)}})}};qF.className="RandomWidth";$e.registerClass(qF);function LHe(e){return new jv(e)}function FHe(e){return new KL(e)}function zHe(e){return new HL(e)}function BHe(e){return new GL(e)}function WHe(e){return new qL(e)}function VHe(e){return new XL(e)}function jHe(e){return new ZL(e)}function UHe(e){return new tF(e)}function HHe(e){return new eT(e)}function GHe(e){return new YL(e)}function qHe(e){return new tT(e)}function KHe(e){return new QL(e)}function ZHe(e){return new eF(e)}function XHe(e){return new nF(e)}function JHe(e){return new rF(e)}function YHe(e){return new iF(e)}function QHe(e){return new pF(e)}function e8e(e){return new cF(e)}function t8e(e){return new sT(e)}function n8e(e){return new uF(e)}function r8e(e){return new dF(e)}function i8e(e){return new hF(e)}function a8e(e){return new fF(e)}function s8e(e){return new mF(e)}function o8e(e){return new yF(e)}function l8e(e){return new vF(e)}function u8e(e){return new wF(e)}function c8e(e){return new kF(e)}function d8e(e){return new xF(e)}function p8e(e){return new _F(e)}function h8e(e){return new bF(e)}function f8e(e){return new SF(e)}function m8e(e){return new TF(e)}function g8e(e){return new NF(e)}function y8e(e){return new EF(e)}function KF(e){return new PF(e)}function v8e(e){return KF(e)}function b8e(e){return KF(e)}function ZF(e){return new MF(e)}function w8e(e){return ZF(e)}function x8e(e){return ZF(e)}function XF(e){return new DF(e)}function _8e(e){return XF(e)}function k8e(e){return XF(e)}function S8e(e){return new LF(e)}function C8e(e){return new zF(e)}function fre(e){return new FF(e)}function mre(e){return new BF(e)}function gre(e){return new OF(e)}function yre(e){return new AF(e)}function I8e(e){return new RF(e)}function $8e(e){return new sF(e)}function T8e(e){return new rT(e)}function N8e(e){return new oF(e)}function E8e(e){return new Ww(e)}function O8e(e){return new aF(e)}function P8e(e){return new nT(e)}function A8e(e){return new lF(e)}function M8e(e){return new aT(e)}function R8e(e){return new Xu(e)}function D8e(e){return new iT(e)}function L8e(e){return new VF(e)}function F8e(e){return new WF(e)}var z8e=fre,B8e=mre,W8e=gre,V8e=yre;function j8e(e){return new CF(e)}function U8e(e){return new IF(e)}function H8e(e){return new $F(e)}function G8e(e){return new gF(e)}function q8e(e){return new jF(e)}function K8e(e){return new UF(e)}function Z8e(e){return new GF(e)}function X8e(e){return new HF(e)}function J8e(e){return new qF(e)}var vre={};Dt(vre,{MAPE:()=>lGe,MSE:()=>dGe,binaryAccuracy:()=>Y8e,binaryCrossentropy:()=>Q8e,categoricalAccuracy:()=>tGe,categoricalCrossentropy:()=>nGe,cosineProximity:()=>aGe,mape:()=>uGe,meanAbsoluteError:()=>sGe,meanAbsolutePercentageError:()=>oGe,meanSquaredError:()=>cGe,mse:()=>pGe,precision:()=>rGe,recall:()=>iGe,sparseCategoricalAccuracy:()=>eGe});function Y8e(e,t){return zL(e,t)}function Q8e(e,t){return kne(e,t)}function eGe(e,t){return Sne(e,t)}function tGe(e,t){return BL(e,t)}function nGe(e,t){return WL(e,t)}function rGe(e,t){return _ne(e,t)}function iGe(e,t){return DUe(e,t)}function aGe(e,t){return FL(e,t)}function sGe(e,t){return X$(e,t)}function oGe(e,t){return Uv(e,t)}function lGe(e,t){return Uv(e,t)}function uGe(e,t){return Uv(e,t)}function cGe(e,t){return em(e,t)}function dGe(e,t){return em(e,t)}function pGe(e,t){return em(e,t)}var bre={};Dt(bre,{modelFromJSON:()=>pHe});var wre={};Dt(wre,{l1:()=>fGe,l1l2:()=>hGe,l2:()=>mGe});function hGe(e){return new zw(e)}function fGe(e){return bHe(e)}function mGe(e){return wHe(e)}var xre=class extends oy{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof Su))throw new Error("model must be a LayersModel, not some other Container");this.model=e}};function p_(e,t){return e<t}function DU(e,t){return e>t}var _re=class extends xre{constructor(e){if(super(),e==null&&(e={}),e.restoreBestWeights)throw new qt("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=p_:this.mode==="max"?this.monitorFunc=DU:this.monitor.indexOf("acc")!==-1?this.monitorFunc=DU:this.monitorFunc=p_,this.monitorFunc===p_&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===p_?1/0:-1/0}async onEpochEnd(e,t){await fc(t);let n=this.getMonitorValue(t);n!=null&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){e==null&&(e={});let t=e[this.monitor];return t==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),t}};function gGe(e){return new _re(e)}var yGe={earlyStopping:gGe},vGe=he();vGe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var Qa;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(Qa||(Qa={}));var LU;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(LU||(LU={}));var JF={};function bGe(e,t){let n={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};JF[e]=n}function kre(e){return JF[e]}function wGe(e){delete JF[e]}function M(e,t,n,r,i){let a=t.inputParams[e];if(a&&a.inputIndexStart!==void 0){let o=a.inputIndexStart,l=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?o+1:a.inputIndexEnd,u=o<0?t.inputNames.length+o:o;if(a.type==="tensor")return Ii(t.inputNames[u],n,r,i);if(a.type==="tensors"){let p=t.inputs.slice(o,l);return t.inputNames.slice(o,l).filter((h,m)=>{var g;return((g=p[m])===null||g===void 0?void 0:g.op)!=="NoOp"}).map(h=>Ii(h,n,r,i))}let c=Ii(t.inputNames[u],n,r,i),d=c.dataSync();return a.type==="number"?d[0]:P.toNestedArray(c.shape,d)}let s=t.attrParams[e];return s&&s.value}function Ii(e,t,n,r){let[i,a]=ts(e,n);if(r!=null){let o=r.getHashTableHandleByName(i);if(o!=null)return o}let s=n.currentContextIds.find(o=>!!t[aI(i,o)]);return s!==void 0?t[aI(i,s)][a]:void 0}function FU(e,t,n){return t[aI(e,n.currentContextId)]}function gu(e,t){let[n,r,i]=ts(e,t);return[aI(n,t&&t.currentContextId),r,i]}function aI(e,t){return t?`${e}-${t}`:e}function ts(e,t){if(e==="")return["",0,void 0];let n=t!=null&&t.parseNodeNameCache!=null;if(n){let a=t.parseNodeNameCache.get(e);if(a!=null)return a}let r=e.split(":"),i;if(r.length===1)i=[e,0,void 0];else{let a=r[0],s=r.length===3?r[1]:void 0,o=Number(r[r.length-1]);i=[a,o,s]}return n&&t.parseNodeNameCache.set(e,i),i}function ok(e,t,n){let r=M("pad",e,t,n);if(r==="explicit"){r=M("explicitPaddings",e,t,n);let i=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)i[a][0]=r[a*2],i[a][1]=r[a*2+1];return i}return r}function yu(e){return e.kept?e:Fl(e)}var Sre={};Dt(Sre,{json:()=>xGe});var xGe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Cre={};Dt(Cre,{json:()=>_Ge});var _Ge=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Ire={};Dt(Ire,{json:()=>kGe});var kGe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],$re={};Dt($re,{json:()=>SGe});var SGe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Tre={};Dt(Tre,{json:()=>CGe});var CGe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Nre={};Dt(Nre,{json:()=>IGe});var IGe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Ere={};Dt(Ere,{json:()=>$Ge});var $Ge=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Ore={};Dt(Ore,{json:()=>TGe});var TGe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Pre={};Dt(Pre,{json:()=>NGe});var NGe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Are={};Dt(Are,{json:()=>EGe});var EGe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Mre={};Dt(Mre,{json:()=>OGe});var OGe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Rre={};Dt(Rre,{json:()=>PGe});var PGe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Dre={};Dt(Dre,{json:()=>AGe});var AGe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Lre={};Dt(Lre,{json:()=>MGe});var MGe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Fre={};Dt(Fre,{json:()=>RGe});var RGe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],zre={};Dt(zre,{json:()=>DGe});var DGe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Bre={};Dt(Bre,{json:()=>LGe});var LGe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Wre={};Dt(Wre,{json:()=>FGe});var FGe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Vre={};Dt(Vre,{json:()=>zGe});var zGe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],zU=class{static get Instance(){return this._instance||(this._instance=new this)}constructor(){let e=[Sre,Cre,Ire,$re,Tre,Nre,Ere,Ore,Pre,Are,Mre,Rre,Dre,Lre,Fre,zre,Bre,Wre,Vre],t=[].concat(...e.map(n=>n.json));this.opMappers=t.reduce((n,r)=>(n[r.tfOpName]=r,n),{})}transformGraph(e,t={}){let n=e.node,r=[],i=[],a=[],s=n.reduce((m,g)=>(m[g.name]=this.mapNode(g),g.op.startsWith("Placeholder")?r.push(m[g.name]):g.op==="Const"?i.push(m[g.name]):(g.input==null||g.input.length===0)&&a.push(m[g.name]),m),{}),o=[],l=[],u={},c={};t!=null&&(u=this.mapSignatureEntries(t.inputs),c=this.mapSignatureEntries(t.outputs));let d=Object.keys(s);d.forEach(m=>{let g=s[m];g.inputNames.forEach((v,y)=>{let[b,,_]=gu(v),k=s[b];if(k.outputs!=null){let C=k.outputs.indexOf(_);if(C!==-1){let $=`${b}:${C}`;g.inputNames[y]=$}}g.inputs.push(k),k.children.push(g)})}),Object.keys(c).length===0?d.forEach(m=>{let g=s[m];g.children.length===0&&l.push(g)}):Object.keys(c).forEach(m=>{let[g]=gu(m),v=s[g];v!=null&&(v.signatureKey=c[m],l.push(v))}),Object.keys(u).length>0?Object.keys(u).forEach(m=>{let[g]=gu(m),v=s[g];v&&(v.signatureKey=u[m],o.push(v))}):o=r;let p={};e.library!=null&&e.library.function!=null&&(p=e.library.function.reduce((m,g)=>(m[g.signature.name]=this.mapFunction(g),m),{}));let h={nodes:s,inputs:o,outputs:l,weights:i,placeholders:r,signature:t,functions:p};return a.length>0&&(h.initNodes=a),h}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){let t=kre(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});let n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(n.inputParams=t.inputs.reduce((r,i)=>(r[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},r),{})),t.attrs!=null&&(n.attrParams=t.attrs.reduce((r,i)=>{let a=i.type,s;switch(i.type){case"string":s=LP(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=LP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":s=UP(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=UP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":s=zP(e.attr,i.tfName,i.defaultValue||0),s===void 0&&i.tfDeprecatedName&&(s=zP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":s=jP(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=jP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":s=FP(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=FP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":s=GP(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=GP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":s=VP(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=VP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":s=HP(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=HP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":s=BP(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=BP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":s=WP(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=WP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":s=BU(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=BU(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return r[i.name]={value:s,type:a},r},{})),n}mapFunction(e){let t=e.nodeDef,n=[],r=[],i={};t!=null&&(i=t.reduce((u,c)=>(u[c.name]=this.mapNode(c),c.op==="Const"&&r.push(u[c.name]),u),{}));let a=[],s=[];e.signature.inputArg.forEach(u=>{let[c]=gu(u.name),d={name:c,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:YF(u.type),type:"dtype"}},children:[]};d.signatureKey=u.name,a.push(d),i[c]=d}),Object.keys(i).forEach(u=>{let c=i[u];c.inputNames.forEach((d,p)=>{let[h,,m]=gu(d),g=i[h];if(g.outputs!=null){let v=g.outputs.indexOf(m);if(v!==-1){let y=`${h}:${v}`;c.inputNames[p]=y}}c.inputs.push(g),g.children.push(c)})});let o=e.ret;e.signature.outputArg.forEach(u=>{let[c,d]=gu(o[u.name]),p=i[c];p!=null&&(p.defaultOutput=d,s.push(p))});let l=this.mapArgsToSignature(e);return{nodes:i,inputs:a,outputs:s,weights:r,placeholders:n,signature:l}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n),t),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return t!=null&&(n=t[n]),{name:n,dtype:e.type}}};function BGe(e){let t=he().global;if(typeof t.atob<"u")return t.atob(e);if(typeof Buffer<"u")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function jre(e,t){let n=Array.isArray(e)?String.fromCharCode.apply(null,e):BGe(e);return t?n:n.toLowerCase()}function LP(e,t,n,r=!1){let i=e[t];return i!=null?jre(i.s,r):n}function FP(e,t,n){let r=e[t];return r?r.b:n}function zP(e,t,n){let r=e[t]||{},i=r.i!=null?r.i:r.f!=null?r.f:n;return typeof i=="number"?i:parseInt(i,10)}function YF(e){switch(typeof e=="string"&&(e=Qa[e]),e){case Qa.DT_FLOAT:case Qa.DT_HALF:return"float32";case Qa.DT_INT32:case Qa.DT_INT64:case Qa.DT_INT8:case Qa.DT_UINT8:return"int32";case Qa.DT_BOOL:return"bool";case Qa.DT_DOUBLE:return"float32";case Qa.DT_STRING:return"string";case Qa.DT_COMPLEX64:case Qa.DT_COMPLEX128:return"complex64";default:return null}}function BU(e,t,n){let r=e[t];return r&&r.func?r.func.name:n}function BP(e,t,n){let r=e[t];return r&&r.type?YF(r.type):n}function WP(e,t,n){let r=e[t];return r&&r.list&&r.list.type?r.list.type.map(i=>YF(i)):n}function Ure(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function VP(e,t,n){let r=e[t];return r&&r.shape?Ure(r.shape):n}function jP(e,t,n){let r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(i=>typeof i=="number"?i:parseInt(i,10)):n}function UP(e,t,n,r=!1){let i=e[t];return i&&i.list&&i.list.s?i.list.s.map(a=>jre(a,r)):n}function HP(e,t,n){let r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(i=>Ure(i)):n}function GP(e,t,n){let r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var WGe=class{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,i)=>(r[i]=this.getAttr(i),r),{}))}getInput(e){return Ii(e,this.tensorMap,this.context)}getAttr(e,t){let n=this.node.rawAttrs[e];if(n.tensor!=null)return Ii(e,this.tensorMap,this.context);if(n.i!=null||n.f!=null)return zP(this.node.rawAttrs,e,t);if(n.s!=null)return LP(this.node.rawAttrs,e,t);if(n.b!=null)return FP(this.node.rawAttrs,e,t);if(n.shape!=null)return VP(this.node.rawAttrs,e,t);if(n.type!=null)return BP(this.node.rawAttrs,e,t);if(n.list!=null){if(n.list.i!=null||n.list.f!=null)return jP(this.node.rawAttrs,e,t);if(n.list.s!=null)return UP(this.node.rawAttrs,e,t);if(n.list.shape!=null)return HP(this.node.rawAttrs,e,t);if(n.list.b!=null)return GP(this.node.rawAttrs,e,t);if(n.list.type!=null)return WP(this.node.rawAttrs,e,t)}return t}},bi={};Dt(bi,{OP_SCOPE_SUFFIX:()=>QR,abs:()=>Dr,acos:()=>iD,acosh:()=>aD,add:()=>we,addN:()=>see,all:()=>u$,any:()=>a1,argMax:()=>ih,argMin:()=>sD,asin:()=>oD,asinh:()=>lD,atan:()=>uD,atan2:()=>cD,atanh:()=>dD,avgPool:()=>Gu,avgPool3d:()=>hD,basicLSTMCell:()=>cee,batchNorm:()=>Zf,batchNorm2d:()=>fD,batchNorm3d:()=>mD,batchNorm4d:()=>gD,batchToSpaceND:()=>ww,bincount:()=>yD,bitwiseAnd:()=>dee,booleanMaskAsync:()=>ete,broadcastArgs:()=>pee,broadcastTo:()=>Pp,buffer:()=>Gt,cast:()=>Me,ceil:()=>vD,clipByValue:()=>Yi,clone:()=>Fl,complex:()=>Ru,concat:()=>Wn,concat1d:()=>bD,concat2d:()=>wD,concat3d:()=>xD,concat4d:()=>_D,conv1d:()=>c$,conv2d:()=>ga,conv2dTranspose:()=>d$,conv3d:()=>SD,conv3dTranspose:()=>CD,cos:()=>xw,cosh:()=>p$,cosineWindow:()=>M$,cumprod:()=>l1,cumsum:()=>h$,denseBincount:()=>KC,depthToSpace:()=>ID,depthwiseConv2d:()=>Xf,diag:()=>fee,dilation2d:()=>$D,div:()=>et,divNoNan:()=>TD,dot:()=>ND,dropout:()=>aL,einsum:()=>hp,elu:()=>Dv,enclosingPowerOfTwo:()=>sL,ensureShape:()=>gee,equal:()=>ms,erf:()=>ED,euclideanNorm:()=>AD,exp:()=>Qi,expandDims:()=>hi,expm1:()=>MD,eye:()=>f$,fft:()=>Ow,fill:()=>ds,floor:()=>Fv,floorDiv:()=>l$,fused:()=>ay,gather:()=>zv,gatherND:()=>ite,greater:()=>Sa,greaterEqual:()=>qu,ifft:()=>iy,imag:()=>_w,image:()=>$s,inTopKAsync:()=>ate,irfft:()=>$$,isFinite:()=>RD,isInf:()=>DD,isNaN:()=>LD,leakyRelu:()=>kw,less:()=>ey,lessEqual:()=>Md,linalg:()=>uL,linspace:()=>xee,localResponseNormalization:()=>FD,log:()=>gs,log1p:()=>Sw,logSigmoid:()=>zD,logSoftmax:()=>g$,logSumExp:()=>Cw,logicalAnd:()=>ho,logicalNot:()=>Iw,logicalOr:()=>y$,logicalXor:()=>BD,losses:()=>yte,lowerBound:()=>kee,matMul:()=>jt,max:()=>Ms,maxPool:()=>oi,maxPool3d:()=>WD,maxPoolWithArgmax:()=>See,maximum:()=>Xl,mean:()=>vr,meshgrid:()=>Cee,min:()=>Qg,minimum:()=>cd,mirrorPad:()=>VD,mod:()=>jD,moments:()=>$w,movingAverage:()=>tte,mul:()=>ae,multiRNNCell:()=>Iee,multinomial:()=>$ee,neg:()=>Yn,norm:()=>Lv,notEqual:()=>lh,oneHot:()=>ty,ones:()=>Aa,onesLike:()=>ys,op:()=>re,outerProduct:()=>Tee,pad:()=>al,pad1d:()=>Nee,pad2d:()=>Eee,pad3d:()=>Oee,pad4d:()=>Pee,pool:()=>UD,pow:()=>Du,prelu:()=>Nw,print:()=>rD,prod:()=>HD,raggedGather:()=>Aee,raggedRange:()=>Mee,raggedTensorToTensor:()=>Ree,rand:()=>Dee,randomGamma:()=>Bee,randomNormal:()=>b$,randomStandardNormal:()=>Wee,randomUniform:()=>Rd,randomUniformInt:()=>Vee,range:()=>uh,real:()=>ny,reciprocal:()=>XD,relu:()=>On,relu6:()=>w$,reshape:()=>oe,reverse:()=>zs,reverse1d:()=>jee,reverse2d:()=>Uee,reverse3d:()=>Hee,reverse4d:()=>Gee,rfft:()=>Pw,round:()=>x$,rsqrt:()=>_$,scalar:()=>yt,scatterND:()=>nte,searchSorted:()=>v$,selu:()=>k$,separableConv2d:()=>Bv,setdiff1dAsync:()=>qee,sigmoid:()=>lo,sign:()=>JD,signal:()=>gte,sin:()=>S$,sinh:()=>C$,slice:()=>nn,slice1d:()=>Ew,slice2d:()=>I$,slice3d:()=>Wv,slice4d:()=>ry,softmax:()=>Dd,softplus:()=>Jf,spaceToBatchND:()=>Tw,sparse:()=>vte,sparseToDense:()=>rte,spectral:()=>mte,split:()=>La,sqrt:()=>Ai,square:()=>zn,squaredDifference:()=>T$,squeeze:()=>Ld,stack:()=>Wr,step:()=>Yf,stridedSlice:()=>YD,string:()=>bte,sub:()=>Ve,sum:()=>lt,tan:()=>QD,tanh:()=>sh,tensor:()=>fa,tensor1d:()=>Cn,tensor2d:()=>zl,tensor3d:()=>N$,tensor4d:()=>dd,tensor5d:()=>Kee,tensor6d:()=>Zee,tensorScatterUpdate:()=>Jee,tile:()=>ss,topk:()=>tL,transpose:()=>Ut,truncatedNormal:()=>P$,unique:()=>nL,unsortedSegmentSum:()=>A$,unstack:()=>Ir,upperBound:()=>Yee,variable:()=>rL,where:()=>yi,whereAsync:()=>iL,zeros:()=>br,zerosLike:()=>sn});var VGe=(e,t,n,r=bi)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(M("a",e,t,n),M("b",e,t,n))];case"AddN":return[r.addN(M("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(M("a",e,t,n),M("b",e,t,n))];case"Mul":return[r.mul(M("a",e,t,n),M("b",e,t,n))];case"RealDiv":case"Div":return[r.div(M("a",e,t,n),M("b",e,t,n))];case"DivNoNan":return[r.divNoNan(M("a",e,t,n),M("b",e,t,n))];case"FloorDiv":return[r.floorDiv(M("a",e,t,n),M("b",e,t,n))];case"Sub":return[r.sub(M("a",e,t,n),M("b",e,t,n))];case"Minimum":return[r.minimum(M("a",e,t,n),M("b",e,t,n))];case"Maximum":return[r.maximum(M("a",e,t,n),M("b",e,t,n))];case"Pow":return[r.pow(M("a",e,t,n),M("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(M("a",e,t,n),M("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},jGe=(e,t,n,r=bi)=>{switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(M("x",e,t,n))];case"Acos":return[r.acos(M("x",e,t,n))];case"Acosh":return[r.acosh(M("x",e,t,n))];case"Asin":return[r.asin(M("x",e,t,n))];case"Asinh":return[r.asinh(M("x",e,t,n))];case"Atan":return[r.atan(M("x",e,t,n))];case"Atan2":return[r.atan2(M("x",e,t,n),M("y",e,t,n))];case"Atanh":return[r.atanh(M("x",e,t,n))];case"Ceil":return[r.ceil(M("x",e,t,n))];case"Complex":return[r.complex(M("real",e,t,n),M("imag",e,t,n))];case"Cos":return[r.cos(M("x",e,t,n))];case"Cosh":return[r.cosh(M("x",e,t,n))];case"Elu":return[r.elu(M("x",e,t,n))];case"Erf":return[r.erf(M("x",e,t,n))];case"Exp":return[r.exp(M("x",e,t,n))];case"Expm1":return[r.expm1(M("x",e,t,n))];case"Floor":return[r.floor(M("x",e,t,n))];case"Log":return[r.log(M("x",e,t,n))];case"Log1p":return[r.log1p(M("x",e,t,n))];case"Imag":return[r.imag(M("x",e,t,n))];case"Neg":return[r.neg(M("x",e,t,n))];case"Reciprocal":return[r.reciprocal(M("x",e,t,n))];case"Real":return[r.real(M("x",e,t,n))];case"Relu":return[r.relu(M("x",e,t,n))];case"Round":return[r.round(M("x",e,t,n))];case"Selu":return[r.selu(M("x",e,t,n))];case"Sigmoid":return[r.sigmoid(M("x",e,t,n))];case"Sin":return[r.sin(M("x",e,t,n))];case"Sign":return[r.sign(M("x",e,t,n))];case"Sinh":return[r.sinh(M("x",e,t,n))];case"Softplus":return[r.softplus(M("x",e,t,n))];case"Sqrt":return[r.sqrt(M("x",e,t,n))];case"Square":return[r.square(M("x",e,t,n))];case"Tanh":return[r.tanh(M("x",e,t,n))];case"Tan":return[r.tan(M("x",e,t,n))];case"ClipByValue":return[r.clipByValue(M("x",e,t,n),M("clipValueMin",e,t,n),M("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(M("x",e,t,n))];case"Rsqrt":return[r.rsqrt(Ii(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(M("x",e,t,n),M("alpha",e,t,n))];case"Prelu":return[r.prelu(M("x",e,t,n),M("alpha",e,t,n))];case"IsNan":return[r.isNaN(Ii(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(Ii(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(Ii(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function Qs(e,t,n=""){if(!(typeof e=="number"||typeof t=="number")){P.assert(e.length===t.length,()=>n+` Shapes ${e} and ${t} must match`);for(let r=0;r<e.length;r++){let i=e[r],a=t[r];P.assert(i<0||a<0||i===a,()=>n+` Shapes ${e} and ${t} must match`)}}}function WU(e){return!(typeof e=="number"||e.some(t=>t<0))}function V0(e,t,n){let r=qP(e,n),i=!WU(r);if(i&&t.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(i&&t.forEach(a=>{r=qP(a.shape,r)}),!WU(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function qP(e,t){if(typeof e=="number")return t;if(typeof t=="number")return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);let n=[];for(let r=0;r<e.length;++r){let i=e[r],a=t[r];if(i>=0&&a>=0&&i!==a)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[r]=i>=0?i:a}return n}var UGe=class{constructor(e,t,n,r,i,a,s){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=a,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=yt(0),Jr(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);let t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);let n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),Qs(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);n.tensor=t,Jr(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((n,r)=>this.write(n,t[r]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return fa([],[0].concat(this.elementShape));let n=this.readMany(e);return Qs(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Wr(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return fa([],[0].concat(this.elementShape));let t=[];for(let r=0;r<this.size();r++)t.push(r);let n=this.readMany(t);return Qs(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),Wn(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);let n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(e,Ir(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let n=0,r=e.map(o=>(n+=o,n));if(n!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${n}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);let i=n===0?0:t.size/n,a=[];le(()=>{t=oe(t,[1,n,i]);for(let o=0;o<e.length;++o){let l=[0,o===0?0:r[o-1],0],u=[1,e[o],i];a[o]=oe(nn(t,l,u),this.elementShape)}return a});let s=[];for(let o=0;o<e.length;o++)s[o]=o;this.writeMany(s,a)}},lT=class KP{get id(){return this.idTensor.id}constructor(t,n,r,i=-1){this.tensors=t,this.elementShape=n,this.elementDtype=r,t!=null&&t.forEach(a=>{if(r!==a.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${a.dtype}`);Qs(n,a.shape,"TensorList shape mismatch: "),Jr(a)}),this.idTensor=yt(0),this.maxNumElements=i,Jr(this.idTensor)}copy(){return new KP([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);Qs(t,this.elementShape,"TensorList shape mismatch: ");let i=V0(this.elementShape,this.tensors,t);return le(()=>{let a=this.tensors.map(s=>oe(s,i));return Wr(a,0)})}popBack(t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");let r=V0(this.elementShape,this.tensors,t),i=this.tensors.pop();return i.kept=!1,Qs(i.shape,t,"TensorList shape mismatch: "),oe(i,r)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(Qs(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Jr(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);let n=new KP([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(let r=0;r<Math.min(this.tensors.length,t);++r)n.tensors[r]=this.tensors[r];return n}getItem(t,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);Qs(this.tensors[t].shape,n,"TensorList shape mismatch: ");let i=V0(this.elementShape,this.tensors,n);return oe(this.tensors[t],i)}setItem(t,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);Qs(this.elementShape,n.shape,"TensorList shape mismatch: "),Jr(n),this.tensors[t]!=null&&(this.tensors[t].kept=!1),this.tensors[t]=n}gather(t,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Qs(this.elementShape,r,"TensorList shape mismatch: "),t=t.slice(0,this.size());let i=V0(this.elementShape,this.tensors,r);return t.length===0?fa([],[0].concat(i)):le(()=>{let a=t.map(s=>oe(this.tensors[s],i));return Wr(a,0)})}concat(t,n){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);Qs(this.elementShape,n,"TensorList shape mismatch: ");let r=V0(this.elementShape,this.tensors,n);return this.size()===0?fa([],[0].concat(r)):le(()=>{let i=this.tensors.map(a=>oe(a,r));return Wn(i,0)})}};function HGe(e,t,n){let r=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);let i=e.shape.slice(1);Qs(i,t,"TensorList shape mismatch: ");let a=Ir(e);return new lT(a,t,r)}function GGe(e,t,n,r){return new lT([],e,t,r)}function qGe(e,t,n,r){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);let i=Math.max(...t);if(r!=null&&r!==-1&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);let a=new lT([],n,e.dtype,r),s=Ir(e,0);return t.forEach((o,l)=>{a.setItem(o,s[l])}),a}function KGe(e,t,n){let r=0,i=t.map(c=>(r+=c,r));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${e.shape}`);let a=e.shape.slice(1),s=qP(a,n),o=r===0?0:e.size/r,l=le(()=>{let c=[];e=oe(e,[1,r,o]);for(let d=0;d<t.length;++d){let p=[0,d===0?0:i[d-1],0],h=[1,t[d],o];c[d]=oe(nn(e,p,h),s)}return e.dispose(),c}),u=new lT([],n,e.dtype,t.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}var ZGe=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{let r=M("thenBranch",e,t,n),i=M("elseBranch",e,t,n),a=M("cond",e,t,n),s=M("args",e,t,n);return(await a.data())[0]?n.functionMap[r].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap):n.functionMap[i].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{let r=M("body",e,t,n),i=M("cond",e,t,n),a=M("args",e,t,n),s=await n.functionMap[i].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap),o=a.map(c=>c.id),l=await s[0].data();s.forEach(c=>{!c.kept&&o.indexOf(c.id)===-1&&c.dispose()});let u=a;for(;l[0];){let c=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);let d=u.map(h=>h.id);c.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()});let p=await n.functionMap[i].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()})}return u}case"LoopCond":{let r=M("pred",e,t,n);return[yu(r)]}case"Switch":{let r=M("pred",e,t,n),i=M("data",e,t,n);return i.kept||(i=yu(i)),(await r.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{let r=e.inputNames.find(i=>Ii(i,t,n)!==void 0);if(r){let i=Ii(r,t,n);return[yu(i)]}return}case"Enter":{let r=M("frameName",e,t,n),i=M("tensor",e,t,n);return n.enterFrame(r),[yu(i)]}case"Exit":{let r=M("tensor",e,t,n);return n.exitFrame(),[yu(r)]}case"NextIteration":{let r=M("tensor",e,t,n);return n.nextIteration(),[yu(r)]}case"TensorArrayV3":{let r=M("size",e,t,n),i=M("dtype",e,t,n),a=M("elementShape",e,t,n),s=M("dynamicSize",e,t,n),o=M("clearAfterRead",e,t,n),l=M("identicalElementShapes",e,t,n),u=M("name",e,t,n),c=new UGe(u,i,r,a,l,s,o);return n.addTensorArray(c),[c.idTensor,yt(1)]}case"TensorArrayWriteV3":{let r=M("tensorArrayId",e,t,n),i=M("index",e,t,n),a=M("tensor",e,t,n),s=n.getTensorArray(r.id);return s.write(i,a),[s.idTensor]}case"TensorArrayReadV3":{let r=M("tensorArrayId",e,t,n),i=M("index",e,t,n);return[n.getTensorArray(r.id).read(i)]}case"TensorArrayGatherV3":{let r=M("tensorArrayId",e,t,n),i=M("indices",e,t,n),a=M("dtype",e,t,n);return[n.getTensorArray(r.id).gather(i,a)]}case"TensorArrayScatterV3":{let r=M("tensorArrayId",e,t,n),i=M("indices",e,t,n),a=M("tensor",e,t,n),s=n.getTensorArray(r.id);return s.scatter(i,a),[s.idTensor]}case"TensorArrayConcatV3":{let r=M("tensorArrayId",e,t,n),i=n.getTensorArray(r.id),a=M("dtype",e,t,n);return[i.concat(a)]}case"TensorArraySplitV3":{let r=M("tensorArrayId",e,t,n),i=M("tensor",e,t,n),a=M("lengths",e,t,n),s=n.getTensorArray(r.id);return s.split(a,i),[s.idTensor]}case"TensorArraySizeV3":{let r=M("tensorArrayId",e,t,n),i=n.getTensorArray(r.id);return[yt(i.size(),"int32")]}case"TensorArrayCloseV3":{let r=M("tensorArrayId",e,t,n),i=n.getTensorArray(r.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{let r=M("tensorListId",e,t,n),i=M("index",e,t,n),a=M("tensor",e,t,n),s=n.getTensorList(r.id);return s.setItem(i,a),[s.idTensor]}case"TensorListGetItem":{let r=M("tensorListId",e,t,n),i=M("index",e,t,n),a=M("elementShape",e,t,n),s=M("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(i,a,s)]}case"TensorListScatterV2":case"TensorListScatter":{let r=M("indices",e,t,n),i=M("tensor",e,t,n),a=M("elementShape",e,t,n),s=M("numElements",e,t,n),o=qGe(i,r,a,s);return n.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{let r=M("elementShape",e,t,n),i=M("elementDType",e,t,n),a;e.op==="TensorListReserve"?a="numElements":a="maxNumElements";let s=M(a,e,t,n),o=e.op==="TensorListReserve"?-1:s,l=GGe(r,i,s,o);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{let r=M("tensorListId",e,t,n),i=M("indices",e,t,n),a=M("elementShape",e,t,n),s=M("elementDType",e,t,n);return[n.getTensorList(r.id).gather(i,s,a)]}case"TensorListStack":{let r=M("tensorListId",e,t,n),i=M("elementShape",e,t,n),a=M("elementDType",e,t,n),s=M("numElements",e,t,n);return[n.getTensorList(r.id).stack(i,a,s)]}case"TensorListFromTensor":{let r=M("tensor",e,t,n),i=M("elementShape",e,t,n),a=M("elementDType",e,t,n),s=HGe(r,i,a);return n.addTensorList(s),[s.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{let r=M("tensorListId",e,t,n),i=n.getTensorList(r.id),a=M("dtype",e,t,n),s=M("elementShape",e,t,n);return[i.concat(a,s)]}case"TensorListPushBack":{let r=M("tensorListId",e,t,n),i=M("tensor",e,t,n),a=n.getTensorList(r.id);return a.pushBack(i),[a.idTensor]}case"TensorListPopBack":{let r=M("tensorListId",e,t,n),i=M("elementShape",e,t,n),a=M("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(i,a)]}case"TensorListSplit":{let r=M("tensor",e,t,n),i=M("elementShape",e,t,n),a=M("lengths",e,t,n),s=KGe(r,a,i);return n.addTensorList(s),[s.idTensor]}case"TensorListLength":{let r=M("tensorListId",e,t,n),i=n.getTensorList(r.id);return[yt(i.size(),"int32")]}case"TensorListResize":{let r=M("tensorListId",e,t,n),i=M("size",e,t,n),a=n.getTensorList(r.id).resize(i);return n.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};function VU(e,t,n){let[r,i]=M("fusedOps",e,t,n),a=r==="biasadd",s=!a,o=i==="prelu",l=r==="fusedbatchnorm",u=M("numArgs",e,t,n);if(a){if(o&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&a&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");let c=M("strides",e,t,n),d=ok(e,t,n),p=M("dataFormat",e,t,n).toUpperCase(),h=M("dilations",e,t,n),[m,g]=M("args",e,t,n);s&&(g=m,m=void 0);let v=M("leakyreluAlpha",e,t,n);return{stride:c,pad:d,dataFormat:p,dilations:h,biasArg:m,preluArg:g,activationFunc:i,leakyreluAlpha:v}}var XGe=(e,t,n,r=bi)=>{switch(e.op){case"Conv1D":{let i=M("stride",e,t,n),a=M("pad",e,t,n),s=M("dataFormat",e,t,n).toUpperCase(),o=M("dilation",e,t,n);return[r.conv1d(M("x",e,t,n),M("filter",e,t,n),i,a,s,o)]}case"Conv2D":{let i=M("strides",e,t,n),a=ok(e,t,n),s=M("dataFormat",e,t,n).toUpperCase(),o=M("dilations",e,t,n);return[r.conv2d(M("x",e,t,n),M("filter",e,t,n),[i[1],i[2]],a,s,[o[1],o[2]])]}case"_FusedConv2D":{let{stride:i,pad:a,dataFormat:s,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=VU(e,t,n);return[r.fused.conv2d({x:M("x",e,t,n),filter:M("filter",e,t,n),strides:[i[1],i[2]],pad:a,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{let{stride:i,pad:a,dataFormat:s,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=VU(e,t,n);return[r.fused.depthwiseConv2d({x:M("x",e,t,n),filter:M("filter",e,t,n),strides:[i[1],i[2]],pad:a,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{let i=M("outputShape",e,t,n),a=M("strides",e,t,n),s=ok(e,t,n);return[r.conv2dTranspose(M("x",e,t,n),M("filter",e,t,n),i,[a[1],a[2]],s)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{let i=M("strides",e,t,n),a=ok(e,t,n),s=M("dilations",e,t,n),o=M("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(M("input",e,t,n),M("filter",e,t,n),[i[1],i[2]],a,o,[s[1],s[2]])]}case"Conv3D":{let i=M("strides",e,t,n),a=M("pad",e,t,n),s=M("dataFormat",e,t,n).toUpperCase(),o=M("dilations",e,t,n);return[r.conv3d(M("x",e,t,n),M("filter",e,t,n),[i[1],i[2],i[3]],a,s,[o[1],o[2],o[3]])]}case"AvgPool":{let i=M("strides",e,t,n),a=M("pad",e,t,n),s=M("kernelSize",e,t,n);return[r.avgPool(M("x",e,t,n),[s[1],s[2]],[i[1],i[2]],a)]}case"MaxPool":{let i=M("strides",e,t,n),a=M("pad",e,t,n),s=M("kernelSize",e,t,n);return[r.maxPool(M("x",e,t,n),[s[1],s[2]],[i[1],i[2]],a)]}case"MaxPoolWithArgmax":{let i=M("strides",e,t,n),a=M("pad",e,t,n),s=M("kernelSize",e,t,n),o=M("includeBatchInIndex",e,t,n),{result:l,indexes:u}=r.maxPoolWithArgmax(M("x",e,t,n),[s[1],s[2]],[i[1],i[2]],a,o);return[l,u]}case"AvgPool3D":{let i=M("strides",e,t,n),a=M("pad",e,t,n),s=M("kernelSize",e,t,n);return[r.avgPool3d(M("x",e,t,n),[s[1],s[2],s[3]],[i[1],i[2],i[3]],a)]}case"MaxPool3D":{let i=M("strides",e,t,n),a=M("pad",e,t,n),s=M("kernelSize",e,t,n);return[r.maxPool3d(M("x",e,t,n),[s[1],s[2],s[3]],[i[1],i[2],i[3]],a)]}case"Dilation2D":{let i=M("strides",e,t,n),a=M("pad",e,t,n),s=M("dilations",e,t,n),o=i[1],l=i[2],u=s[1],c=s[2];return[r.dilation2d(M("x",e,t,n),M("filter",e,t,n),[o,l],a,[u,c],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},JGe=(e,t,n,r=bi)=>{switch(e.op){case"Fill":{let i=M("shape",e,t,n),a=M("dtype",e,t,n),s=M("value",e,t,n);return[r.fill(i,s,a)]}case"LinSpace":{let i=M("start",e,t,n),a=M("stop",e,t,n),s=M("num",e,t,n);return[r.linspace(i,a,s)]}case"Multinomial":{let i=M("logits",e,t,n),a=M("numSamples",e,t,n),s=M("seed",e,t,n);return[r.multinomial(i,a,s)]}case"OneHot":{let i=M("indices",e,t,n),a=M("depth",e,t,n),s=M("onValue",e,t,n),o=M("offValue",e,t,n),l=M("dtype",e,t,n);return[r.oneHot(i,a,s,o,l)]}case"Ones":return[r.ones(M("shape",e,t,n),M("dtype",e,t,n))];case"OnesLike":return[r.onesLike(M("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(M("shape",e,t,n),M("dtype",e,t,n),M("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(M("shape",e,t,n),M("minval",e,t,n),M("maxval",e,t,n),M("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(M("shape",e,t,n),M("minval",e,t,n),M("maxval",e,t,n),M("seed",e,t,n))];case"Range":{let i=M("start",e,t,n),a=M("stop",e,t,n),s=M("step",e,t,n);return[r.range(i,a,s,M("dtype",e,t,n))]}case"TruncatedNormal":{let i=M("shape",e,t,n),a=M("mean",e,t,n),s=M("stdDev",e,t,n),o=M("seed",e,t,n);return[r.truncatedNormal(i,a,s,M("dtype",e,t,n),o)]}case"Zeros":return[r.zeros(M("shape",e,t,n),M("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(M("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function uE(e,t,n){let r=M("boxes",e,t,n),i=M("scores",e,t,n),a=M("maxOutputSize",e,t,n),s=M("iouThreshold",e,t,n),o=M("scoreThreshold",e,t,n),l=M("softNmsSigma",e,t,n);return{boxes:r,scores:i,maxOutputSize:a,iouThreshold:s,scoreThreshold:o,softNmsSigma:l}}var YGe=async(e,t,n,r,i=bi)=>{switch(e.op){case"NonMaxSuppressionV5":{let{boxes:a,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=uE(e,t,n),d=await i.image.nonMaxSuppressionWithScoreAsync(a,s,o,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{let{boxes:a,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=uE(e,t,n),c=M("padToMaxOutputSize",e,t,n),d=await i.image.nonMaxSuppressionPaddedAsync(a,s,o,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{let{boxes:a,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=uE(e,t,n);return[await i.image.nonMaxSuppressionAsync(a,s,o,l,u)]}case"Where":{let a=i.cast(M("condition",e,t,n),"bool"),s=[await i.whereAsync(a)];return a.dispose(),s}case"ListDiff":return i.setdiff1dAsync(M("x",e,t,n),M("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}},QGe=(e,t,n,r=bi)=>{switch(e.op){case"LowerBound":{let i=M("sortedSequence",e,t,n),a=M("values",e,t,n);return[r.lowerBound(i,a)]}case"TopKV2":{let i=M("x",e,t,n),a=M("k",e,t,n),s=M("sorted",e,t,n),o=r.topk(i,a,s);return[o.values,o.indices]}case"UpperBound":{let i=M("sortedSequence",e,t,n),a=M("values",e,t,n);return[r.upperBound(i,a)]}case"Unique":{let i=M("x",e,t,n),a=r.unique(i);return[a.values,a.indices]}case"UniqueV2":{let i=M("x",e,t,n),a=M("axis",e,t,n),s=r.unique(i,a);return[s.values,s.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},e7e=(e,t,n,r=bi)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":let i=M("default",e,t,n);return[Ii(e.name,t,n)||i];case"Placeholder":return[Ii(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{let c=M("x",e,t,n);return[yu(c)]}case"IdentityN":return M("x",e,t,n).map(c=>yu(c));case"Snapshot":let a=M("x",e,t,n);return[yu(a)];case"Shape":return[r.tensor1d(M("x",e,t,n).shape,"int32")];case"ShapeN":return M("x",e,t,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar(M("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(M("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":let s=M("x",e,t,n),o=M("data",e,t,n),l=M("message",e,t,n),u=M("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<o.length;c++)console.log(Array.prototype.slice.call(o[c].dataSync()).slice(0,u));return[s];default:throw TypeError(`Node type ${e.op} is not implemented`)}},t7e=class{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=yt(0),this.tensorMap=new Map,Jr(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return yt(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),le(()=>{let r=Ir(t),i=n.length,a=r.length;P.assert(i===a,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${a} elements.`);for(let s=0;s<i;s++){let o=n[s],l=r[s];Jr(l),this.tensorMap.set(o,l)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return le(()=>{let r=[];for(let i=0;i<n.length;i++){let a=n[i],s=this.findWithDefault(a,t);r.push(s)}return Wr(r)})}findWithDefault(e,t){let n=this.tensorMap.get(e);return n!=null?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}},n7e=async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{let i=r.getHashTableHandleByName(e.name);if(i!=null)return[i];{let a=M("keyDType",e,t,n),s=M("valueDType",e,t,n),o=new t7e(a,s);return r.addHashTable(e.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{let i=M("tableHandle",e,t,n,r),a=M("keys",e,t,n),s=M("values",e,t,n);return[await r.getHashTableById(i.id).import(a,s)]}case"LookupTableFind":case"LookupTableFindV2":{let i=M("tableHandle",e,t,n,r),a=M("keys",e,t,n),s=M("defaultValue",e,t,n);return[await r.getHashTableById(i.id).find(a,s)]}case"LookupTableSize":case"LookupTableSizeV2":{let i=M("tableHandle",e,t,n,r);return[r.getHashTableById(i.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},r7e=(e,t,n,r=bi)=>{switch(e.op){case"ResizeBilinear":{let i=M("images",e,t,n),a=M("size",e,t,n),s=M("alignCorners",e,t,n),o=M("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(i,[a[0],a[1]],s,o)]}case"ResizeNearestNeighbor":{let i=M("images",e,t,n),a=M("size",e,t,n),s=M("alignCorners",e,t,n),o=M("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(i,[a[0],a[1]],s,o)]}case"CropAndResize":{let i=M("image",e,t,n),a=M("boxes",e,t,n),s=M("boxInd",e,t,n),o=M("cropSize",e,t,n),l=M("method",e,t,n),u=M("extrapolationValue",e,t,n);return[r.image.cropAndResize(i,a,s,o,l,u)]}case"ImageProjectiveTransformV3":{let i=M("images",e,t,n),a=M("transforms",e,t,n),s=M("outputShape",e,t,n),o=M("fillValue",e,t,n),l=M("interpolation",e,t,n),u=M("fillMode",e,t,n);return[r.image.transform(i,a,l.toLowerCase(),u.toLowerCase(),o,s)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},i7e=(e,t,n,r=bi)=>{switch(e.op){case"Equal":return[r.equal(M("a",e,t,n),M("b",e,t,n))];case"NotEqual":return[r.notEqual(M("a",e,t,n),M("b",e,t,n))];case"Greater":return[r.greater(M("a",e,t,n),M("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(M("a",e,t,n),M("b",e,t,n))];case"Less":return[r.less(M("a",e,t,n),M("b",e,t,n))];case"LessEqual":return[r.lessEqual(M("a",e,t,n),M("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(M("a",e,t,n),M("b",e,t,n))];case"LogicalNot":return[r.logicalNot(M("a",e,t,n))];case"LogicalOr":return[r.logicalOr(M("a",e,t,n),M("b",e,t,n))];case"Select":case"SelectV2":return[r.where(M("condition",e,t,n),M("a",e,t,n),M("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(M("a",e,t,n),M("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},a7e=(e,t,n,r=bi)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(M("a",e,t,n),M("b",e,t,n),M("transposeA",e,t,n),M("transposeB",e,t,n))];case"Einsum":return[r.einsum(M("equation",e,t,n),...M("tensors",e,t,n))];case"Transpose":return[r.transpose(M("x",e,t,n),M("perm",e,t,n))];case"_FusedMatMul":let[i,a]=M("fusedOps",e,t,n),s=i==="biasadd",o=a==="prelu",l=M("numArgs",e,t,n),u=M("leakyreluAlpha",e,t,n);if(s){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}let[c,d]=M("args",e,t,n);return[r.fused.matMul({a:M("a",e,t,n),b:M("b",e,t,n),transposeA:M("transposeA",e,t,n),transposeB:M("transposeB",e,t,n),bias:c,activation:a,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[r.linalg.bandPart(M("a",e,t,n),M("numLower",e,t,n),M("numUpper",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},s7e=(e,t,n,r=bi)=>{switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(M("x",e,t,n),M("axis",e,t,n),M("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(M("x",e,t,n),M("mean",e,t,n),M("variance",e,t,n),M("offset",e,t,n),M("scale",e,t,n),M("epsilon",e,t,n))];case"FusedBatchNormV3":return[r.batchNorm(M("x",e,t,n),M("mean",e,t,n),M("variance",e,t,n),M("offset",e,t,n),M("scale",e,t,n),M("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(M("x",e,t,n),M("radius",e,t,n),M("bias",e,t,n),M("alpha",e,t,n),M("beta",e,t,n))];case"Softmax":return[r.softmax(M("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(M("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},o7e=(e,t,n,r=bi)=>{switch(e.op){case"RaggedGather":{let{outputNestedSplits:i,outputDenseValues:a}=r.raggedGather(M("paramsNestedSplits",e,t,n),M("paramsDenseValues",e,t,n),M("indices",e,t,n),M("outputRaggedRank",e,t,n));return i.concat(a)}case"RaggedRange":{let{rtNestedSplits:i,rtDenseValues:a}=r.raggedRange(M("starts",e,t,n),M("limits",e,t,n),M("splits",e,t,n));return[i,a]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(M("shape",e,t,n),M("values",e,t,n),M("defaultValue",e,t,n),M("rowPartitionTensors",e,t,n),M("rowPartitionTypes",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},l7e=(e,t,n,r=bi)=>{switch(e.op){case"Max":{let o=M("axis",e,t,n),l=M("keepDims",e,t,n);return[r.max(M("x",e,t,n),o,l)]}case"Mean":{let o=M("axis",e,t,n),l=M("keepDims",e,t,n);return[r.mean(M("x",e,t,n),o,l)]}case"Min":{let o=M("axis",e,t,n),l=M("keepDims",e,t,n);return[r.min(M("x",e,t,n),o,l)]}case"Sum":{let o=M("axis",e,t,n),l=M("keepDims",e,t,n);return[r.sum(M("x",e,t,n),o,l)]}case"All":{let o=M("axis",e,t,n),l=M("keepDims",e,t,n);return[r.all(M("x",e,t,n),o,l)]}case"Any":{let o=M("axis",e,t,n),l=M("keepDims",e,t,n);return[r.any(M("x",e,t,n),o,l)]}case"ArgMax":{let o=M("axis",e,t,n);return[r.argMax(M("x",e,t,n),o)]}case"ArgMin":{let o=M("axis",e,t,n);return[r.argMin(M("x",e,t,n),o)]}case"Prod":{let o=M("axis",e,t,n),l=M("keepDims",e,t,n);return[r.prod(M("x",e,t,n),o,l)]}case"Cumprod":{let o=M("axis",e,t,n),l=M("exclusive",e,t,n),u=M("reverse",e,t,n);return[r.cumprod(M("x",e,t,n),o,l,u)]}case"Cumsum":{let o=M("axis",e,t,n),l=M("exclusive",e,t,n),u=M("reverse",e,t,n);return[r.cumsum(M("x",e,t,n),o,l,u)]}case"Bincount":let i=M("x",e,t,n),a=M("weights",e,t,n),s=M("size",e,t,n);return[r.bincount(i,a,s)];case"DenseBincount":{let o=M("x",e,t,n),l=M("weights",e,t,n),u=M("size",e,t,n),c=M("binaryOutput",e,t,n);return[r.denseBincount(o,l,u,c)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},u7e=(e,t,n,r=bi)=>{switch(e.op){case"ConcatV2":case"Concat":{let i=M("n",e,t,n),a=M("axis",e,t,n),s=M("tensors",e,t,n);return s=s.slice(0,i),[r.concat(s,a)]}case"Gather":{let i=M("x",e,t,n),a=M("indices",e,t,n);return[r.gather(i,r.cast(a,"int32"),0)]}case"GatherV2":{let i=M("axis",e,t,n),a=M("batchDims",e,t,n),s=M("x",e,t,n),o=M("indices",e,t,n);return[r.gather(s,r.cast(o,"int32"),i,a)]}case"Reverse":{let i=M("dims",e,t,n),a=[];for(let o=0;o<i.length;o++)i[o]&&a.push(o);let s=M("x",e,t,n);return[r.reverse(s,a)]}case"ReverseV2":{let i=M("axis",e,t,n),a=M("x",e,t,n);return[r.reverse(a,i)]}case"Slice":{let i=M("begin",e,t,n),a=M("size",e,t,n);return[r.slice(M("x",e,t,n),i,a)]}case"StridedSlice":{let i=M("begin",e,t,n),a=M("end",e,t,n),s=M("strides",e,t,n),o=M("beginMask",e,t,n),l=M("endMask",e,t,n),u=M("ellipsisMask",e,t,n),c=M("newAxisMask",e,t,n),d=M("shrinkAxisMask",e,t,n),p=M("x",e,t,n);return[r.stridedSlice(p,i,a,s,o,l,u,c,d)]}case"Pack":return le(()=>{let i=M("axis",e,t,n),a=M("tensors",e,t,n),s=a[0].shape,o=r.squeeze(a[0]).shape,l=a.map(u=>{let c=P.arraysEqual(u.shape,s);if(!c&&!P.arraysEqual(r.squeeze(u).shape,o))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,s)});return[r.stack(l,i)]});case"Unpack":{let i=M("axis",e,t,n),a=M("tensor",e,t,n);return r.unstack(a,i)}case"Tile":{let i=M("reps",e,t,n);return[r.tile(M("x",e,t,n),i)]}case"Split":case"SplitV":{let i=M("axis",e,t,n),a=M("numOrSizeSplits",e,t,n),s=M("x",e,t,n);return r.split(s,a,i)}case"ScatterNd":{let i=M("indices",e,t,n),a=M("values",e,t,n),s=M("shape",e,t,n);return[r.scatterND(i,a,s)]}case"GatherNd":{let i=M("x",e,t,n),a=M("indices",e,t,n);return[r.gatherND(i,a)]}case"SparseToDense":{let i=M("sparseIndices",e,t,n),a=M("outputShape",e,t,n),s=M("sparseValues",e,t,n),o=M("defaultValue",e,t,n);return[r.sparseToDense(i,s,a,s.dtype===o.dtype?o:r.cast(o,s.dtype))]}case"TensorScatterUpdate":{let i=M("indices",e,t,n),a=M("values",e,t,n),s=M("tensor",e,t,n);return[r.tensorScatterUpdate(s,i,a)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},c7e=(e,t,n,r=bi)=>{switch(e.op){case"SparseFillEmptyRows":{let{outputIndices:i,outputValues:a,emptyRowIndicator:s,reverseIndexMap:o}=r.sparse.sparseFillEmptyRows(M("indices",e,t,n),M("values",e,t,n),M("denseShape",e,t,n),M("defaultValue",e,t,n));return[i,a,s,o]}case"SparseReshape":{let{outputIndices:i,outputShape:a}=r.sparse.sparseReshape(M("inputIndices",e,t,n),M("inputShape",e,t,n),M("newShape",e,t,n));return[i,a]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(M("data",e,t,n),M("indices",e,t,n),M("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(M("data",e,t,n),M("indices",e,t,n),M("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},d7e=(e,t,n,r=bi)=>{switch(e.op){case"FFT":return[r.fft(M("x",e,t,n))];case"IFFT":return[r.ifft(M("x",e,t,n))];case"RFFT":return[r.rfft(M("x",e,t,n))];case"IRFFT":return[r.irfft(M("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},p7e=(e,t,n,r=bi)=>{switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(M("input",e,t,n),M("pattern",e,t,n),M("rewrite",e,t,n),M("replaceGlobal",e,t,n))];case"StringNGrams":{let{nGrams:i,nGramsSplits:a}=r.string.stringNGrams(M("data",e,t,n),M("dataSplits",e,t,n),M("separator",e,t,n),M("nGramWidths",e,t,n),M("leftPad",e,t,n),M("rightPad",e,t,n),M("padWidth",e,t,n),M("preserveShortSequences",e,t,n));return[i,a]}case"StringSplit":{let{indices:i,values:a,shape:s}=r.string.stringSplit(M("input",e,t,n),M("delimiter",e,t,n),M("skipEmpty",e,t,n));return[i,a,s]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(M("input",e,t,n),M("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},h7e=(e,t,n,r=bi)=>{switch(e.op){case"Cast":return[r.cast(M("x",e,t,n),M("dtype",e,t,n))];case"ExpandDims":{let i=M("axis",e,t,n);return[r.expandDims(M("x",e,t,n),i)]}case"Squeeze":{let i=M("axis",e,t,n);return[r.squeeze(M("x",e,t,n),i)]}case"Reshape":return[r.reshape(M("x",e,t,n),M("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(M("x",e,t,n),M("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(M("x",e,t,n),M("padding",e,t,n),M("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(M("x",e,t,n),M("padding",e,t,n),M("constantValue",e,t,n))];case"SpaceToBatchND":{let i=M("blockShape",e,t,n),a=M("paddings",e,t,n);return[r.spaceToBatchND(M("x",e,t,n),i,a)]}case"BatchToSpaceND":{let i=M("blockShape",e,t,n),a=M("crops",e,t,n);return[r.batchToSpaceND(M("x",e,t,n),i,a)]}case"DepthToSpace":{let i=M("blockSize",e,t,n),a=M("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(M("x",e,t,n),i,a)]}case"BroadcastTo":return[r.broadcastTo(M("x",e,t,n),M("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(M("s0",e,t,n),M("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function jU(e,t,n,r,i=le){let a=((s,o,l)=>{switch(s.category){case"arithmetic":return i(()=>VGe(s,o,l));case"basic_math":return i(()=>jGe(s,o,l));case"control":return ZGe(s,o,l);case"convolution":return i(()=>XGe(s,o,l));case"creation":return i(()=>JGe(s,o,l));case"dynamic":return YGe(s,o,l);case"evaluation":return i(()=>QGe(s,o,l));case"image":return i(()=>r7e(s,o,l));case"graph":return i(()=>e7e(s,o,l));case"logical":return i(()=>i7e(s,o,l));case"matrices":return i(()=>a7e(s,o,l));case"normalization":return i(()=>s7e(s,o,l));case"ragged":return i(()=>o7e(s,o,l));case"reduction":return i(()=>l7e(s,o,l));case"slice_join":return i(()=>u7e(s,o,l));case"sparse":return i(()=>c7e(s,o,l));case"spectral":return i(()=>d7e(s,o,l));case"string":return i(()=>p7e(s,o,l));case"transformation":return i(()=>h7e(s,o,l));case"hash_table":return n7e(s,o,l,r);case"custom":let u=kre(s.op);if(u&&u.customExecutor)return u.customExecutor(new WGe(s,o,l));throw TypeError(`Custom op ${s.op} is not registered.`);default:throw TypeError(`Unknown op '${s.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return P.isPromise(a)?a.then(s=>[].concat(s)):[].concat(a)}var UU=class{constructor(e={},t={},n={},r={},i){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){let e=[];for(let t=0;t<this.contexts.length-1;t++){let n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;let e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(let t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(let t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}};function HU(e,t,n,r){let i=new Set,a=[],s=null,o=null,l=new Set,u=new Set(Object.keys(e).map(p=>ts(p)[0]));r=r||[];let c=new Set(r.map(p=>ts(p.name)[0])),d=[...t];for(;d.length>0;){let p=d.pop();if((mp(p)||x7e(p)||_7e(p))&&s==null&&(s=p,o=s.children.map(h=>h.name).filter(h=>i.has(h))),i.add(p.name),n[p.name]==null&&!u.has(p.name)&&!c.has(p.name)){if(p.inputs.length===0){a.push(p.name);continue}p.inputs.forEach(h=>{l.has(h.name)||(l.add(h.name),d.push(h))})}}return{inputs:e,outputs:t,usedNodes:i,missingInputs:a,dynamicNode:s,syncInputs:o}}function f7e(e,t){let{usedNodes:n,inputs:r}=t,i=Object.keys(r).map(v=>ts(v)[0]).map(v=>e.nodes[v]),a=e.initNodes||[],s=v=>n.has(typeof v=="string"?v:v.name);function o(v){return[...new Map(v.map(y=>[y.name,y])).values()]}let l=o([...i,...e.weights,...a]).filter(s),u=o([...l,...Object.values(e.nodes)]).filter(s),c=new Map(u.map(v=>[v.name,v])),d={};for(let v of u){d[v.name]=d[v.name]||0;for(let y of v.children)s(y)||(d[y.name]=Number.POSITIVE_INFINITY),d[y.name]=(d[y.name]||0)+1}let p=Object.entries(d).filter(([,v])=>v===0).map(([v])=>v),h=[...p];for(;p.length>0;){let v=p.pop(),y=c.get(v);for(let b of y.children.filter(s))--d[b.name]===0&&(h.push(b.name),p.push(b.name))}let m=h.map(v=>c.get(v)),g=m7e(m,l);return g7e(g,l),g}function m7e(e,t){let n=new Map(e.map(a=>[a.name,a])),r=t.map(a=>a.name),i=new Set(r);for(;r.length>0;){let a=r.pop(),s=n.get(a);for(let o of s.children)!n.has(o.name)||i.has(o.name)||(i.add(o.name),r.push(o.name))}return e.filter(a=>i.has(a.name))}var h_=class extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}};function g7e(e,t){let n=new Map(e.map((o,l)=>[o.name,l])),r=new Set(t.map(o=>o.name)),i=o=>r.has(typeof o=="string"?o:o.name),a=new Set(e.map(o=>o.name)),s=o=>a.has(typeof o=="string"?o:o.name);for(let o of e){for(let l of o.children.filter(s)){if(!n.has(l.name))throw new h_(`Child ${l.name} of node ${o.name} is unreachable.`);if(n.get(o.name)>n.get(l.name))throw new h_(`Node ${o.name} is scheduled to run after its child ${l.name}.`)}if(!i(o))for(let l of o.inputs){if(!n.has(l.name))throw new h_(`Input ${l.name} of node ${o.name} is unreachable.`);if(n.get(l.name)>n.get(o.name))throw new h_(`Node ${o.name} is scheduled to run before its input ${l.name}.`)}}}function y7e(e){let t=new Map(e.map((o,l)=>[o.name,l])),n=Number.MAX_SAFE_INTEGER,r=e.map((o,l)=>mp(o)?n:l),i=o=>{let l=r[t.get(o.name)];return l==null?-1:l},a=e.map((o,l)=>o.children.map(i).reduce((u,c)=>Math.max(u,c),r[l])),s=new Map;for(let o=0;o<e.length;++o){let l=a[o];if(l===n)continue;let u=e[o],c=e[l];s.has(c.name)||s.set(c.name,[]),s.get(c.name).push(u)}return s}var v7e=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),b7e=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),w7e=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function mp(e){return v7e.has(e.op)}function x7e(e){return b7e.has(e.op)}function _7e(e){return w7e.has(e.op)}var GU=class Hre{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){let n=Object.keys(t).map(r=>t[r].map(i=>i.id));this._weightIds=[].concat(...n),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{let n=t.signatureKey||t.name;return t.defaultOutput?`${n}:${t.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((t,n)=>(t[n]=this._functions[n].signature,t),{})}constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(r=>{this._functionExecutorMap[r]=new Hre(t.functions[r],this)})}getCompilationKey(t,n){let r=t.map(a=>a.name).sort(),i=n.map(a=>a.name).sort();return r.join(this.SEPARATOR)+"--"+i.join(this.SEPARATOR)}compile(t,n){let r=HU(t,n,this.weightMap,this._initNodes),{missingInputs:i,dynamicNode:a,syncInputs:s}=r;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${s}]`);if(i.length>0){let u=n.map(d=>d.name),c=Object.keys(t);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${c}]. Missing the following inputs: [${i}]`)}let o=f7e(this.graph,r),l=y7e(o);return{orderedNodes:o,nodeLiveUntilMap:l}}cloneAndKeepTensor(t){if(t==null)return null;let n=t.clone();return Jr(n),n}cloneTensorList(t){return t?t.map(n=>this.cloneAndKeepTensor(n)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(t,n){this.disposeIntermediateTensors(),t=this.mapInputs(t);let r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);let i=r.map(p=>this.graph.nodes[ts(p)[0]]),a=n.map(p=>ts(p)[0]),s=new Set(a),o=a.map(p=>this.graph.nodes[p]);o.length===0&&(o=this._outputs);let l=this.getCompilationKey(i,o),u=this.compiledMap.get(l);u==null&&(u=this.compile(t,o),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=he().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}let c={},d={};return le(()=>{let p=new UU(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),h=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach(y=>{let[b,_]=ts(y,p),k=[];k[_]=t[y],h[b]=k,this.keepIntermediateTensors&&(this.clonedTensorsMap[b]=this.cloneTensorList(k))});let m=this.getFrozenTensorIds(h),{orderedNodes:g,nodeLiveUntilMap:v}=u;for(let y of g){if(h[y.name])continue;let b=jU(y,h,p,this._resourceManager);if(P.isPromise(b))throw new Error(`The execution of the op '${y.op}' returned a promise. Please use model.executeAsync() instead.`);h[y.name]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[y.name]=this.cloneTensorList(b)),this.checkTensorForDisposalWithNodeLiveUntilInfo(y,h,p,m,s,v.get(y.name))}return this.parent==null&&p.dispose(m),n.map(y=>Ii(y,h,p))})}getFrozenTensorIds(t){let n=[].concat.apply([],Object.keys(t).map(r=>t[r]).map(r=>r.map(i=>i.id)));return new Set(n)}checkTensorForDisposal(t,n,r,i,a,s,o){if(!(mp(n)||s.has(t))){for(let l of r[t])l!=null&&(o[l.id]=(o[l.id]||0)+n.children.length);for(let l of n.inputs){if(mp(l))continue;let u=FU(l.name,r,i);if(u!=null)for(let c of u){if(!c||c.kept||a.has(c.id))continue;let d=o[c.id];d===1?(c.dispose(),delete o[c.id]):d!=null&&o[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,n,r,i,a,s){function o(l){return mp(l)||a.has(l.name)}if(!(mp(t)||s==null))for(let l of s){if(o(l))continue;let u=FU(l.name,n,r);for(let c of u)!c||c.kept||i.has(c.id)||c.dispose()}}async executeAsync(t,n){return this._executeAsync(t,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(t=>{for(let n of t)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(t,n,r=!1,i={},a={}){this.disposeIntermediateTensors(),r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=he().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}let s=new UU(this.weightMap,i,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));let o=await this.executeWithControlFlow(t,s,n,r),l=n.map(p=>Ii(p,o,s)),u=l.map(p=>p.id),c=Object.keys(t).map(p=>t[p].id),d=new Set([...u,...c,...this.weightIds]);return Object.values(o).forEach(p=>{p.forEach(h=>{h&&!h.isDisposed&&!d.has(h.id)&&h.dispose()})}),this.parent==null&&s.dispose(d),l}async executeFunctionAsync(t,n,r){let i=t.reduce((a,s,o)=>(a[this.inputs[o].name]=s,a),{});return this._executeAsync(i,this.outputNodes,!0,n,r)}async executeWithControlFlow(t,n,r,i){let a=Object.keys(t),s=a.map(k=>this.graph.nodes[ts(k)[0]]),o=r.map(k=>ts(k)[0]),l=new Set(o),u=o.map(k=>this.graph.nodes[k]);u.length===0&&(u=this._outputs);let{usedNodes:c,missingInputs:d,dynamicNode:p,syncInputs:h}=HU(t,u,this.weightMap,this._initNodes),m=[...s,...this.graph.weights,...this._initNodes||[]].map(k=>({node:k,contexts:n.currentContext})),g=Object.assign({},this.weightMap);Object.keys(t).forEach(k=>{let[C,$]=ts(k),N=[];N[$]=t[k],g[C]=N});let v={},y=this.getFrozenTensorIds(g),b={};for(;m.length>0;){let k=this.processStack(s,m,n,g,b,y,l,v,c);await Promise.all(k)}p==null&&!i&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");let _=u.filter(k=>!mp(k)&&!Ii(k.name,g,n)).map(k=>k.name);if(_.length>0){let k="";throw p!=null&&(k=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${_}] from the provided inputs [${a}]. Consider providing the following inputs: [${d}]. ${k}`)}return g}processStack(t,n,r,i,a,s,o,l,u){let c=[];for(;n.length>0;){let d=n.pop();r.currentContext=d.contexts;let p="";if(d.node.op==="Enter"&&M("isConstant",d.node,i,r)&&([p]=gu(d.node.name,r)),i[d.node.name]==null){let h=jU(d.node,i,r,this._resourceManager);p||([p]=gu(d.node.name,r));let m=r.currentContext;P.isPromise(h)?c.push(h.then(g=>(i[p]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(g)),r.currentContext=m,this.checkTensorForDisposal(p,d.node,i,r,s,o,l),this.processChildNodes(d.node,n,r,i,a,u),g))):(i[p]=h,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(h)),this.checkTensorForDisposal(p,d.node,i,r,s,o,l),this.processChildNodes(d.node,n,r,i,a,u))}else this.processChildNodes(d.node,n,r,i,a,u)}return c}processChildNodes(t,n,r,i,a,s){t.children.forEach(o=>{let[l]=gu(o.name,r);a[l]||!s.has(o.name)||(o.op==="Merge"?o.inputNames.some(u=>!!Ii(u,i,r))&&(a[l]=!0,n.push({contexts:r.currentContext,node:o})):o.inputNames.every(u=>!!Ii(u,i,r))&&(a[l]=!0,n.push({contexts:r.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(n=>n.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(n=>{let r=t[n],[i]=ts(n),a=this.graph.nodes[i];if(a.attrParams.shape&&a.attrParams.shape.value){let s=a.attrParams.shape.value,o=s.length===r.shape.length&&r.shape.every((l,u)=>s[u]===-1||s[u]===l);P.assert(o,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${s}], but was [${r.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&P.assert(r.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(t){var n,r;let i={};for(let a in t){let s=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[a];s!=null?i[s.name]=t[a]:i[a]=t[a]}return i}checkInputs(t){let n=Object.keys(t).filter(r=>{let[i]=ts(r);return this.graph.nodes[i]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(t){return t.map(n=>{var r,i;let a=(i=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||i===void 0?void 0:i[n];return a!=null?a.name:n},{})}checkOutputs(t){t.forEach(n=>{let[r]=ts(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}},k7e=class{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(let e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(let e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}},S7e="?tfjs-format=file",C7e="model.json",QF=class{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},n=Ti){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,t==null&&(this.loadOptions={}),this.resourceManager=new k7e}findIOHandler(){let e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{let t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let e=this.handler.load();return P.isPromise(e)?e.then(t=>t.getWeightStream==null?this.loadSync(t):this.loadStreaming(t)):this.loadSync(e)}loadSync(e){let t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");let t=await XQ(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;let n=this.artifacts.modelTopology,r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){let i=this.artifacts.userDefinedMetadata;i.signature!=null&&(r=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=r,this.version=`${n.versions.producer}.${n.versions.minConsumer}`,this.executor=new GU(zU.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){let i=zU.Instance.transformGraph(e.modelInitializer);this.initializer=new GU(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){let n=this.io.getSaveHandlers(e);if(n.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(n.length>1)throw new Error(`Found more than one (${n.length}) save handlers for URL '${e}'`);e=n[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){let t=e instanceof zt?[e]:e,n={};return t.forEach((r,i)=>n[this.structuredOutputKeys[i]]=r),n}return e}predict(e,t){let n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){let n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof zt)&&!Array.isArray(e)){let i=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(i!=null)for(let a in i){let s=i[a];s.resourceId!=null&&(e[a]=this.resourceIdToCapturedInput[s.resourceId])}return e}e=Array.isArray(e)?e:[e];let n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-n} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((i,a)=>{var s,o,l;let u=(l=(o=(s=this.signature)===null||s===void 0?void 0:s.inputs)===null||o===void 0?void 0:o[a])===null||l===void 0?void 0:l.resourceId;return u!=null?i[a]=this.resourceIdToCapturedInput[u]:i[a]=e[r++],i},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){let t=this.initializerSignature.outputs,n=Object.keys(t);for(let r=0;r<n.length;r++){let i=n[r],a=t[i];this.resourceIdToCapturedInput[a.resourceId]=e[r]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Rt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}};async function I7e(e,t={},n=Ti){if(e==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof e=="string"&&(e=T7e(e));let r=new QF(e,t,n);return await r.load(),r}function $7e(e){if(e==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){let[r,i]=e;if(!r)throw new Error("modelJSON must be the first element of the array");if(!i||!(i instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in r))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in r))throw new Error("Model JSON is missing 'weightsManifest'");let a=Ti.getWeightSpecs(r.weightsManifest),s=Ti.getModelArtifactsForJSONSync(r,a,i);t=Ti.fromMemorySync(s)}else if("load"in e)t=e;else if("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e)t=Ti.fromMemorySync(e);else throw new Error("Unknown model format");let n=new QF(t);return n.load(),n}function T7e(e){return e.endsWith("/")||(e=e+"/"),`${e}${C7e}${S7e}`}var N7e="4.16.0",Gre={};Dt(Gre,{CSVDataset:()=>rie,Dataset:()=>Hv,FileDataSource:()=>cie,TextLineDataset:()=>nie,URLDataSource:()=>die,array:()=>Y7e,csv:()=>d9e,func:()=>p9e,generator:()=>h9e,microphone:()=>m9e,version_data:()=>g9e,webcam:()=>f9e,zip:()=>Q7e});var E7e=Td(V2()),O7e=Td(V2());function P7e(e,t){return sI(e,t)}function sI(e,t,n=new Map,r=new Set){if(e==null)return null;if(typeof Blob=="function"&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);let i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse)if(ly(e)){let a=Array.isArray(e)?[]:{};r.add(e);for(let s in e){let o=e[s],l=sI(o,t,n,r);a[s]=l}return r.delete(e),e.__proto__&&(a.__proto__=e.__proto__),a}else throw new Error(`Can't recurse into non-iterable type: ${e}`);else return n.set(e,i.value),i.value}function A7e(e,t=Kre){return qre(e,t)}function qre(e,t,n=new Set){let r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");let i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse)if(ly(r)){let a=Array.isArray(r)?[]:{};n.add(r);for(let s in r){let o=e.map(u=>u[s]),l=qre(o,t,n);a[s]=l}return n.delete(r),a}else throw new Error(`Can't recurse into non-iterable type: ${r}`);else return i.value}function Kre(e){return e===null?null:ly(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function Zre(e,t){let n=new Map;sI(e,t,n);for(let r of Array.from(n.keys())){let i=n.get(r);if(P.isPromise(i)){let a=await i;n.set(r,a)}}return sI(e,t,n)}function ly(e){let t=!1;if(he().get("IS_BROWSER"))t=e instanceof TextDecoder;else{let{StringDecoder:n}=gQ();t=e instanceof n}return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof zt)&&!(e instanceof Promise)&&!t)}function M7e(e){return e==null||R7e(e)||Array.isArray(e)||typeof e=="object"&&e instanceof zt||P.isTypedArray(e)}function R7e(e){return e===null||typeof e!="object"&&typeof e!="function"}function D7e(e){return P7e(e,L7e)}function L7e(e){return e instanceof zt?{value:e.clone(),recurse:!1}:ly(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var Xre=class{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}},Jre=class Yre extends Xre{constructor(){super(Yre.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){let t=this.capacity*2,n=new Array(t),r=this.length();for(let i=0;i<r;i++)n[i]=this.get(this.wrap(this.begin+i));this.data=n,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=r}};Jre.INITIAL_CAPACITY=32;function Qre(e){return new B7e(e)}function ez(e){return new W7e(e)}function F7e(e,t){return new eie(e,t)}function z7e(e,t=Ac.FAIL){return new X7e(e,t)}var vi=class{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new K7e(this,e)}filter(e){return new G7e(this,e)}map(e){return new q7e(this,e)}mapAsync(e){return new qU(this,e)}serialMapAsync(e){return new qU(this,e).serial()}flatmap(e){return new Z7e(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(t=>t===!0)}rowMajorBatch(e,t=!0){return new H7e(this,e,t)}columnMajorBatch(e,t=!0,n=Kre){return this.rowMajorBatch(e,t).map(r=>A7e(r,n))}concatenate(e,t){return new eie(Qre([this,e]),t)}take(e){return e<0||e==null?this:new U7e(this,e)}skip(e){return e<0||e==null?this:new j7e(this,e)}prefetch(e){return new tie(this,e)}shuffle(e,t){return new J7e(this,e,t)}serial(){return new V7e(this)}},B7e=class extends vi{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:D7e(e),done:!1}}},W7e=class extends vi{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}},V7e=class extends vi{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}},j7e=class extends vi{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;Rt(e.value)}return this.upstream.next()}},U7e=class extends vi{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}},H7e=class extends vi{constructor(e,t,n=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}},G7e=class extends vi{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;Rt(e.value)}}},q7e=class extends vi{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=Bo.getTensorsInContainer(e.value),n=this.transform(e.value),r=Bo.getTensorsInContainer(n);for(let i of t)Bo.isTensorInList(i,r)||i.dispose();return{value:n,done:!1}}},K7e=class extends vi{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}},qU=class extends vi{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=Bo.getTensorsInContainer(e.value),n=await this.transform(e.value),r=Bo.getTensorsInContainer(n);for(let i of t)Bo.isTensorInList(i,r)||i.dispose();return{value:n,done:!1}}},tz=class extends vi{constructor(){super(),this.outputQueue=new Jre,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}},Z7e=class extends tz{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=Bo.getTensorsInContainer(e.value),n=this.transform(e.value),r=Bo.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(let i of t)Bo.isTensorInList(i,r)||i.dispose();return!0}},eie=class extends vi{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){let n=await this.moreIterators.next();if(n.done)return{value:null,done:!0};this.iterator=n.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}},Ac;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(Ac||(Ac={}));var X7e=class extends vi{constructor(e,t=Ac.FAIL){super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,n=0;function r(a){return a instanceof vi?{value:a.next().then(s=>(t++,s.done&&n++,s.value)),recurse:!1}:{value:null,recurse:!0}}let i=await Zre(this.iterators,r);if(t===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case Ac.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case Ac.SHORTEST:return{value:null,done:!0};case Ac.LONGEST:}return this.count++,{value:i,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}},tie=class extends vi{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new Xre(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}},J7e=class extends tie{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=O7e.alea(n||P.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(t.done)this.upstreamExhausted=!0;else return this.refill(),t}return{value:null,done:!0}}},Hv=class{constructor(){this.size=null}batch(e,t=!0){let n=this;P.assert(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let r;return this.size===1/0||this.size==null?r=this.size:t?r=Math.ceil(this.size/e):r=Math.floor(this.size/e),es(async()=>(await n.iterator()).columnMajorBatch(e,t,e9e),r)}concatenate(e){let t=this,n;return this.size===1/0||e.size===1/0?n=1/0:this.size!=null&&e.size!=null?n=this.size+e.size:n=null,es(async()=>(await t.iterator()).concatenate(await e.iterator()),n)}filter(e){let t=this,n;return this.size===1/0?n=1/0:n=null,es(async()=>(await t.iterator()).filter(r=>le(()=>e(r))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return es(async()=>(await t.iterator()).map(n=>le(()=>e(n))),this.size)}mapAsync(e){let t=this;return es(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return es(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){let t=this,n;return this.size!=null&&e>0?n=this.size*e:e===0?n=0:this.size!=null&&(e===void 0||e<0)?n=1/0:n=null,es(async()=>{let r=ez(async()=>({value:await t.iterator(),done:!1}));return F7e(r.take(e))},n)}skip(e){let t=this,n;return this.size!=null&&e>=0&&this.size>=e?n=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?n=0:n=null,es(async()=>(await t.iterator()).skip(e),n)}shuffle(e,t,n=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);let r=this,i=E7e.alea(t||P.now().toString());return es(async()=>{let a=i.int32();return n&&(a+=i.int32()),(await r.iterator()).shuffle(e,a.toString())},this.size)}take(e){let t=this,n;return this.size!=null&&this.size>e?n=e:this.size!=null&&this.size<=e?n=this.size:n=null,es(async()=>(await t.iterator()).take(e),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}};Hv.MAX_BUFFER_SIZE=1e4;function es(e,t=null){return new class extends Hv{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function Y7e(e){return es(async()=>Qre(e),e.length)}function Q7e(e){if(!ly(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let n=0;n<e.length;n++)t=t==null?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(let n in e)t=t==null?e[n].size:Math.min(t,e[n].size);return es(async()=>{let n=await Zre(e,r=>{if(r instanceof Hv)return{value:r.iterator(),recurse:!1};if(ly(r))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return z7e(n,Ac.SHORTEST)},t)}function e9e(e){if(e===null)return null;let t=e[0];return M7e(t)?{value:t9e(e),recurse:!1}:{value:null,recurse:!0}}function t9e(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof zt?Wr(e):fa(e)}var nie=class extends Hv{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(e=>(e.endsWith("\r")&&(e=e.slice(0,-1)),e))}},f_='"',j0=Symbol("out"),KU=Symbol("field"),m_=Symbol("quote"),cE=Symbol("quoteafterquote"),ZU=Symbol("quoteinquote"),rie=class extends Hv{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){let e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&P.assert(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);let t=this.fullColumnNames.reduce((r,i)=>(r[i]=r[i]+1||1,r),{}),n=Object.keys(t).filter(r=>t[r]>1);if(P.assert(n.length===0,()=>"Duplicate column names found: "+n.toString()),this.columnConfigs){for(let r of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(r)===-1)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){let e=await(await this.base.iterator()).next();if(e.done)throw new Error("No data was found for CSV parsing.");let t=e.value;return this.parseRow(t,!1)}else return null}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new nie(e),t||(t={}),this.hasHeader=t.hasHeader!==!1,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(P.assert(t.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(t=>this.makeDataElement(t))}makeDataElement(e){let t=this.parseRow(e),n={},r={};for(let i=0;i<this.fullColumnNames.length;i++){let a=this.fullColumnNames[i],s=this.columnConfigs?this.columnConfigs[a]:null;if(!(this.configuredColumnsOnly&&!s)){let o=t[i],l=null;if(o==="")if(s&&s.default!==void 0)l=s.default;else{if(s&&(s.required||s.isLabel))throw new Error(`Required column ${a} is empty in this line: ${e}`);l=void 0}else{let u=Number(o);if(isNaN(u))s&&s.dtype==="bool"?l=this.getBoolean(o):l=o;else if(!s||!s.dtype)l=u;else switch(s.dtype){case"float32":l=u;break;case"int32":l=Math.floor(u);break;case"bool":l=this.getBoolean(o);break;default:l=u}}s&&s.isLabel?r[a]=l:n[a]=l}}return Object.keys(r).length===0?n:{xs:n,ys:r}}getBoolean(e){return e==="1"||e.toLowerCase()==="true"?1:0}parseRow(e,t=!0){let n=[],r=0,i=e.length,a=j0;for(let s=0;s<i;s++)switch(a){case j0:switch(e.charAt(s)){case f_:r=s+1,a=m_;break;case this.delimiter:if(r=s+1,this.delimiter===" "&&this.delimWhitespace)break;n.push(""),a=j0;break;default:a=KU,r=s;break}break;case KU:switch(e.charAt(s)){case this.delimiter:n.push(e.substring(r,s)),a=j0,r=s+1;break}break;case m_:switch(e.charAt(s)){case f_:a=cE;break}break;case cE:switch(e.charAt(s)){case this.delimiter:n.push(e.substring(r,s-1)),a=j0,r=s+1;break;case f_:a=m_;break;default:a=ZU;break}break;case ZU:switch(e.charAt(s)){case f_:a=m_;break}break}if(a===cE?n.push(e.substring(r,i-1)):n.push(e.substring(r)),t&&n.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${n}`);return n}},n9e=class iie extends vi{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;let n=Math.log2(this.fftSize);if(this.fftSize<0||n<4||n>14||!Number.isInteger(n))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=t.includeSpectrogram!==!1,this.includeWaveform=t.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(t={}){if(!he().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");let n=new iie(t);return await n.start(),n}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(r){throw new Error(`Error thrown while initializing video stream: ${r.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");let t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);let n=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,n.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let t,n,r=await this.getAudioData();if(this.includeSpectrogram){let i=this.flattenQueue(r.freqDataQueue);t=this.getTensorFromAudioDataArray(i,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let i=this.flattenQueue(r.timeDataQueue);n=this.getTensorFromAudioDataArray(i,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:n},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){let t=[],n=[],r=0;return new Promise(i=>{let a=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&i({freqDataQueue:t,timeDataQueue:n}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),n.push(this.timeData.slice())),++r===this.numFrames&&(clearInterval(a),i({freqDataQueue:t,timeDataQueue:n}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){let n=t[0].length,r=new Float32Array(t.length*n);return t.forEach((i,a)=>r.set(i,a*n)),r}getTensorFromAudioDataArray(t,n){let r=new Float32Array(P.sizeFromShape(n));return r.set(t,r.length-t.length),fa(r,n)}},r9e=class aie extends vi{constructor(t,n){if(super(),this.webcamVideoElement=t,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=Cn([0],"int32"),this.webcamConfig.centerCrop){let r=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,i=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,a=(1-r)/2,s=(1-i)/2,o=a+r,l=i+s;this.cropBox=zl([s,a,l,o],[1,4])}else this.cropBox=zl([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t,n={}){if(!he().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}let r=new aie(t,n);return await r.start(),r}async start(){this.webcamConfig.facingMode&&P.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message=`Error thrown while initializing video stream: ${t.message}`,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})}async next(){if(this.isClosed)return{value:null,done:!0};let t;try{t=Aw.fromPixels(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{t.dispose()}else return{value:t,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(t){return le(()=>{let n=hi(Me(t,"float32"),0),r;r=$s.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");let i=r.shape;return oe(r,i.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(t=>t.stop());try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}},sie=class{},oie=class extends vi{split(e){return new i9e(this,e)}},i9e=class extends oie{constructor(e,t){super(),this.upstream=e,this.impl=new a9e(e,t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},a9e=class extends tz{constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){let e=await this.upstream.next();if(e.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);let t=e.value.split(this.separator);t[0]=this.carryover+t[0];for(let n of t.slice(0,-1))this.outputQueue.push(n);return this.carryover=t[t.length-1],!0}},s9e=class extends vi{decodeUTF8(){return new o9e(this)}},o9e=class extends oie{constructor(e){super(),this.upstream=e,this.impl=new l9e(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},l9e=class extends tz{constructor(e){if(super(),this.upstream=e,he().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:t}=gQ();this.decoder=new t("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){let e=await this.upstream.next(),t;if(e.done)return!1;t=e.value;let n;return he().get("IS_BROWSER")?n=this.decoder.decode(t,{stream:!0}):n=this.decoder.write(Buffer.from(t.buffer)),this.outputQueue.push(n),!0}},lie=class extends s9e{constructor(e,t={}){super(),this.file=e,this.options=t,P.assert(e instanceof Uint8Array||(he().get("IS_BROWSER")?e instanceof File||e instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((e,t)=>{let n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,n)));else{let r=new FileReader;r.onload=a=>{let s=r.result;if(s instanceof ArrayBuffer&&(s=new Uint8Array(s)),!(s instanceof Uint8Array))return t(new TypeError("FileReader returned unknown type."));e(s)},r.onabort=a=>t(new Error("Aborted")),r.onerror=a=>t(new Error(a.type));let i=this.file.slice(this.offset,n);r.readAsArrayBuffer(i)}this.offset=n}),done:!1}}};async function u9e(e,t={},n){let r,i;typeof e=="string"?r=e:(r=e.url,i=c9e(e));let a=await(n||P.fetch)(r,i);if(a.ok){let s=new Uint8Array(await a.arrayBuffer());return new lie(s,t)}else throw new Error(a.statusText)}var c9e=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});function uie(e){return typeof e=="string"&&e.slice(0,7)==="file://"}var cie=class extends sie{constructor(e,t={}){super(),this.input=e,this.options=t}async iterator(){if(uie(this.input)&&he().get("IS_NODE")){let e=HR();this.input=e.readFileSync(this.input.slice(7))}return new lie(this.input,this.options)}},die=class extends sie{constructor(e,t={}){super(),this.url=e,this.fileOptions=t}async iterator(){return uie(this.url)?new cie(this.url,this.fileOptions).iterator():u9e(this.url,this.fileOptions)}};function d9e(e,t={}){return new rie(new die(e),t)}function p9e(e){let t=ez(e);return es(async()=>t)}function h9e(e){return es(async()=>{let t=await e();return ez(()=>t.next())})}async function f9e(e,t){return r9e.create(e,t)}async function m9e(e){return n9e.create(e)}var g9e="4.16.0";function dt(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&P.assert(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}var y9e=Jl.whereImpl,nz=class pie extends H1{nextDataId(){return pie.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new j2(this,Ys())}write(t,n,r){this.firstUse&&(this.firstUse=!1,he().get("IS_NODE")&&W.warn(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));let i={id:this.nextDataId()};return this.data.set(i,{values:t,dtype:r,refCount:1}),i}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&P.isString(r[0])){let a=r.map(s=>P.encodeString(s));i=this.write(a,t,n)}else i=this.write(r,t,n);return{dataId:i,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){let n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){let n=this.data.get(t);n.refCount--}}move(t,n,r,i,a){this.data.set(t,{values:n,dtype:i,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){let{dtype:n,complexTensorInfos:r}=this.data.get(t);if(n==="complex64"){let i=this.readSync(r.real.dataId),a=this.readSync(r.imag.dataId);return W.mergeRealAndImagArrays(i,a)}return P.convertBackendValuesAndArrayBuffer(this.data.get(t).values,n)}bufferSync(t){let n=this.readSync(t.dataId);if(t.dtype==="string")try{let r=n.map(i=>P.decodeString(i));return Gt(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Gt(t.shape,t.dtype,n)}makeOutput(t,n,r){return Ys().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;let{complexTensorInfos:r}=this.data.get(t);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){let n=P.now();return t(),{kernelMs:P.now()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){dt([t],"where");let n=this.readSync(t.dataId);return y9e(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};nz.nextDataId=0;var rz={};Dt(rz,{addImpl:()=>mie,bincountImpl:()=>az,bincountReduceImpl:()=>gie,bitwiseAndImpl:()=>yie,castImpl:()=>fie,ceilImpl:()=>vie,concatImpl:()=>sz,equalImpl:()=>bie,expImpl:()=>xie,expm1Impl:()=>kie,floorDivImpl:()=>Cie,floorImpl:()=>Sie,gatherNdImpl:()=>Iie,gatherV2Impl:()=>$ie,greaterEqualImpl:()=>Nie,greaterImpl:()=>Tie,lessEqualImpl:()=>Oie,lessImpl:()=>Eie,linSpaceImpl:()=>Pie,logImpl:()=>Aie,maxImpl:()=>Mie,maximumImpl:()=>Rie,minimumImpl:()=>Die,multiplyImpl:()=>oz,negImpl:()=>Lie,notEqualImpl:()=>Fie,prodImpl:()=>zie,raggedGatherImpl:()=>Bie,raggedRangeImpl:()=>Wie,raggedTensorToTensorImpl:()=>Vie,rangeImpl:()=>uz,rsqrtImpl:()=>jie,scatterImpl:()=>kp,sigmoidImpl:()=>gqe,simpleAbsImpl:()=>hie,sliceImpl:()=>lI,sparseFillEmptyRowsImpl:()=>Hie,sparseReshapeImpl:()=>Gie,sparseSegmentReductionImpl:()=>cz,sqrtImpl:()=>bqe,squaredDifferenceImpl:()=>qie,staticRegexReplaceImpl:()=>Kie,stridedSliceImpl:()=>Zie,stringNGramsImpl:()=>dz,stringSplitImpl:()=>pz,stringToHashBucketFastImpl:()=>hz,subImpl:()=>Xie,tileImpl:()=>Jie,topKImpl:()=>Qie,transposeImpl:()=>lz,uniqueImpl:()=>mz});function hie(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var v9e=e=>{let{x:t}=e.inputs,n=e.backend;dt(t,"abs");let r=new Float32Array(P.sizeFromShape(t.shape)),i=n.data.get(t.dataId).values;return r=hie(i),n.makeOutput(r,t.shape,t.dtype)},b9e={kernelName:Ay,backendName:"cpu",kernelFunc:v9e};function Mr(e){return(t,n,r,i,a)=>{let s=W.assertAndGetBroadcastShape(t,n),o=s.length,l=P.computeStrides(s),u=P.sizeFromShape(s),c=P.getTypedArrayFromDType(a,u),d=t.length,p=n.length,h=P.computeStrides(t),m=P.computeStrides(n),g=W.getBroadcastDims(t,s),v=W.getBroadcastDims(n,s);if(g.length+v.length===0)for(let y=0;y<c.length;++y)c[y]=e(r[y%r.length],i[y%i.length]);else for(let y=0;y<c.length;++y){let b=P.indexToLoc(y,o,l),_=b.slice(-d);g.forEach(N=>_[N]=0);let k=P.locToIndex(_,d,h),C=b.slice(-p);v.forEach(N=>C[N]=0);let $=P.locToIndex(C,p,m);c[y]=e(r[k],i[$])}return[c,s]}}function is(e){let{inputs:t,backend:n}=e,{real:r,imag:i}=t,a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,o=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",a),imag:n.makeTensorInfo(i.shape,"float32",s)},o}var w9e={kernelName:G2,backendName:"cpu",kernelFunc:is};function oI(e,t,n="float32"){if(n==="complex64"){let i=oI(e,t,"float32"),a=oI(e,t,"float32");return is({inputs:{real:i,imag:a},backend:e})}let r=P.makeZerosTypedArray(P.sizeFromShape(t),n);return e.makeTensorInfo(t,n,r)}function Ul(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var x9e={kernelName:sf,backendName:"cpu",kernelFunc:Ul};function dh(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}var _9e={kernelName:i$,backendName:"cpu",kernelFunc:dh};function fie(e,t,n,r){if(r==="int32"){let i=Int32Array.from(e);return[t,"int32",i]}if(r==="bool"){let i=P.toTypedArray([0],n),[a,s]=Mr((o,l)=>o!==l?1:0)(t,[],e,i,"bool");return[s,"bool",a]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function gd(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:a}=r;if(a==="complex64"){if(i.dtype==="complex64")return Ul({inputs:{x:i},backend:n});let c=oI(n,i.shape,i.dtype),d=gd({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),p=is({inputs:{real:d,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),p}if(i.dtype==="complex64"){let c=dh({inputs:{input:i},backend:n}),d=gd({inputs:{x:c},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(c),d}if(!P.hasEncodingLoss(i.dtype,a)){let c=Ul({inputs:{x:i},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:a}}let s=n.data.get(i.dataId).values,[o,l,u]=fie(s,i.shape,i.dtype,a);return n.makeTensorInfo(o,l,u)}var k9e={kernelName:Bh,backendName:"cpu",kernelFunc:gd};function ri(e,t,n,r){return n==null?({inputs:i,backend:a})=>{let{a:s,b:o}=i,l=a;dt([s,o],e);let u=l.data.get(s.dataId).values,c=l.data.get(o.dataId).values,d=s.dtype==="string"?W.fromUint8ToStringArray(u):u,p=s.dtype==="string"?W.fromUint8ToStringArray(c):c,h=r||s.dtype,[m,g]=t(s.shape,o.shape,d,p,h);return l.makeTensorInfo(g,h,m)}:({inputs:i,backend:a})=>{let{a:s,b:o}=i,l=a;if(s.dtype==="complex64"||o.dtype==="complex64"){let u=gd({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),d=c.complexTensorInfos.real,p=c.complexTensorInfos.imag,h=l.data.get(d.dataId).values,m=l.data.get(p.dataId).values,g=gd({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),v=l.data.get(g.dataId),y=v.complexTensorInfos.real,b=v.complexTensorInfos.imag,_=l.data.get(y.dataId).values,k=l.data.get(b.dataId).values,[C,$,N]=n(s.shape,o.shape,h,m,_,k),A=l.makeTensorInfo(N,"float32",C),D=l.makeTensorInfo(N,"float32",$),O=is({inputs:{real:A,imag:D},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(A),l.disposeIntermediateTensorInfo(D),O}else{let u=l.data.get(s.dataId).values,c=l.data.get(o.dataId).values,d=r||s.dtype,[p,h]=t(s.shape,o.shape,u,c,d);return l.makeTensorInfo(h,d,p)}}}function iz(e){return(t,n,r,i,a,s)=>{let o=W.assertAndGetBroadcastShape(t,n),l=P.sizeFromShape(o),u=o.length,c=P.computeStrides(o),d=P.getTypedArrayFromDType("float32",l),p=P.getTypedArrayFromDType("float32",l),h=W.getBroadcastDims(t,o),m=W.getBroadcastDims(n,o),g=W.mergeRealAndImagArrays(r,i),v=W.mergeRealAndImagArrays(a,s),y=t.length,b=P.computeStrides(t),_=n.length,k=P.computeStrides(n);if(h.length+m.length===0)for(let C=0;C<d.length;C++){let $=C%g.length,N=C%v.length,A=e(g[$*2],g[$*2+1],v[N*2],v[N*2+1]);d[C]=A.real,p[C]=A.imag}else for(let C=0;C<d.length;C++){let $=P.indexToLoc(C,u,c),N=$.slice(-y);h.forEach(E=>N[E]=0);let A=P.locToIndex(N,y,b),D=$.slice(-_);m.forEach(E=>D[E]=0);let O=P.locToIndex(D,_,k),F=e(g[A*2],g[A*2+1],v[O*2],v[O*2+1]);d[C]=F.real,p[C]=F.imag}return[d,p,o]}}var mie=Mr((e,t)=>e+t),S9e=iz((e,t,n,r)=>({real:e+n,imag:t+r})),uy=ri(Nd,mie,S9e),C9e={kernelName:Nd,backendName:"cpu",kernelFunc:uy};function az(e,t,n,r,i){let a=P.sizeFromShape(r),s=P.makeZerosTypedArray(i,n);for(let o=0;o<e.length;o++){let l=e[o];if(l<0)throw new Error("Input x must be non-negative!");l>=i||(a>0?s[l]+=t[o]:s[l]+=1)}return s}function gie(e,t,n,r=!1){let i=e.shape[0],a=e.shape[1],s=Gt([i,n],t.dtype);for(let o=0;o<i;o++)for(let l=0;l<a;l++){let u=e.get(o,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?s.set(1,o,u):t.size>0?s.set(s.get(o,u)+t.get(o,l),o,u):s.set(s.get(o,u)+1,o,u))}return s}var yie=Mr((e,t)=>e&t),I9e=ri(Wy,yie),$9e={kernelName:Wy,backendName:"cpu",kernelFunc:I9e};function Yl(e){return(t,n,r)=>{let i=P.getArrayFromDType(n,t.length);for(let a=0;a<t.length;++a)i[a]=e(t[a],r);return i}}function Mn(e,t,n){let r=Yl(t);return Fd(e,r,n)}function Fd(e,t,n){return({inputs:r,attrs:i,backend:a})=>{let{x:s}=r;dt(s,e);let o=a,l=o.data.get(s.dataId).values,u;if(s.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=W.fromUint8ToStringArray(l)}else u=l;let c=n||s.dtype,d=t(u,c,i);return o.makeTensorInfo(s.shape,c,d)}}var vie=Yl(e=>Math.ceil(e)),T9e=Fd(Wh,vie),N9e={kernelName:Wh,backendName:"cpu",kernelFunc:T9e};function sz(e,t,n,r){let i=P.getArrayFromDType(n,P.sizeFromShape(t));if(r&&n!=="string"){let a=0;e.forEach(s=>{let o=P.sizeFromShape(s.shape);i.set(s.vals,a),a+=o})}else{let a=0;e.forEach(s=>{let o=n==="string"?W.fromUint8ToStringArray(s.vals):s.vals,l=0;for(let u=0;u<s.shape[0];++u){let c=u*t[1]+a;for(let d=0;d<s.shape[1];++d)i[c+d]=o[l++]}a+=s.shape[1]})}return i}var bie=Mr((e,t)=>e===t?1:0),wie=ri(Zy,bie,null,"bool"),E9e={kernelName:Zy,backendName:"cpu",kernelFunc:wie},xie=Yl(e=>Math.exp(e)),_ie=Fd(Qh,xie,"float32"),O9e={kernelName:Qh,backendName:"cpu",kernelFunc:_ie},kie=Yl(e=>Math.expm1(e)),P9e=Fd(ef,kie),A9e={kernelName:ef,backendName:"cpu",kernelFunc:P9e},Sie=Yl(e=>Math.floor(e)),M9e=Fd(tf,Sie),R9e={kernelName:tf,backendName:"cpu",kernelFunc:M9e},Cie=Mr((e,t)=>Math.floor(e/t)),D9e=ri(nf,Cie,null,"int32"),L9e={kernelName:nf,backendName:"cpu",kernelFunc:D9e};function Iie(e,t,n,r,i,a,s,o,l){let u=Gt([r,a],n);for(let c=0;c<r;c++){let d=[],p=0;for(let h=0;h<i;h++){let m=e[c*i+h];p+=m*s[h],d.push(m)}if(p<0||p>=l/a)throw new Error(`Invalid indices: ${d} does not index into ${o}`);for(let h=0;h<a;h++)u.values[c*a+h]=t.get(...t.indexToLoc(p*a+h))}return u}function $ie(e,t,n){let r=Gt(n,e.dtype);for(let i=0;i<r.size;++i){let a=r.indexToLoc(i).slice(),s=a[0],o=a[2],l=t.locToIndex([s,o]);a[2]=t.values[l];let u=e.locToIndex(a);0<=u&&u<e.values.length&&(r.values[i]=e.values[u])}return r}var Tie=Mr((e,t)=>e>t?1:0),F9e=ri(ev,Tie,null,"bool"),z9e={kernelName:ev,backendName:"cpu",kernelFunc:F9e},Nie=Mr((e,t)=>e>=t?1:0),B9e=ri(af,Nie,null,"bool"),W9e={kernelName:af,backendName:"cpu",kernelFunc:B9e},Eie=Mr((e,t)=>e<t?1:0),V9e=ri(tv,Eie,null,"bool"),j9e={kernelName:tv,backendName:"cpu",kernelFunc:V9e},Oie=Mr((e,t)=>e<=t?1:0),U9e=ri(nv,Oie,null,"bool"),H9e={kernelName:nv,backendName:"cpu",kernelFunc:U9e};function Pie(e,t,n){let r=(t-e)/(n-1),i=P.makeZerosTypedArray(n,"float32");i[0]=e;for(let a=1;a<i.length;a++)i[a]=i[a-1]+r;return i}var Aie=Yl(e=>Math.log(e)),G9e=Fd(df,Aie),q9e={kernelName:df,backendName:"cpu",kernelFunc:G9e};function Mie(e,t,n,r){let i=P.getTypedArrayFromDType(r,P.sizeFromShape(n));for(let a=0;a<i.length;++a){let s=a*t,o=e[s];for(let l=0;l<t;++l){let u=e[s+l];(Number.isNaN(u)||u>o)&&(o=u)}i[a]=o}return i}var Rie=Mr((e,t)=>Math.max(e,t)),K9e=ri(mf,Rie),Z9e={kernelName:mf,backendName:"cpu",kernelFunc:K9e},Die=Mr((e,t)=>Math.min(e,t)),X9e=ri(bf,Die),J9e={kernelName:bf,backendName:"cpu",kernelFunc:X9e},oz=Mr((e,t)=>e*t),Y9e=iz((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),uT=ri(_f,oz,Y9e),Q9e={kernelName:_f,backendName:"cpu",kernelFunc:uT};function Lie(e,t,n){let r=P.createScalarValue(-1,n);return oz([],t,r,e,n)}function eqe(e){let{inputs:t,backend:n}=e,{x:r}=t;dt(r,"neg");let i=n.data.get(r.dataId).values,[a,s]=Lie(i,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,a)}var tqe={kernelName:cv,backendName:"cpu",kernelFunc:eqe},Fie=Mr((e,t)=>e!==t?1:0),nqe=ri(dv,Fie,null,"bool"),rqe={kernelName:dv,backendName:"cpu",kernelFunc:nqe};function lz(e,t,n,r,i){let a=t.length,s=P.sizeFromShape(t),o=P.computeStrides(t),l=P.computeStrides(i),u=P.getTypedArrayFromDType(n,P.sizeFromShape(i));for(let c=0;c<s;++c){let d=P.indexToLoc(c,a,o),p=new Array(d.length);for(let m=0;m<p.length;m++)p[m]=d[r[m]];let h=P.locToIndex(p,a,l);u[h]=e[c]}return u}function Wa(e){let{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:a}=n;dt(i,"transpose");let s=i.shape.length,o=new Array(s);for(let c=0;c<o.length;c++)o[c]=i.shape[a[c]];let l=r.data.get(i.dataId).values,u=lz(l,i.shape,i.dtype,a,o);return{dataId:r.write(u,o,i.dtype),shape:o,dtype:i.dtype}}var iqe={kernelName:ku,backendName:"cpu",kernelFunc:Wa};function zie(e,t,n,r){let[i,a]=W.computeOutAndReduceShapes(e,r),s=Ls(t,"int32"),o=P.makeZerosTypedArray(P.sizeFromShape(i),s),l=P.sizeFromShape(a);for(let u=0;u<o.length;++u){let c=u*l,d=1;for(let p=0;p<l;++p)d*=n[c+p];o[u]=d}return{outVals:o,outShape:i,outDtype:s}}function aqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;dt(i,"prod");let o=i.shape.length,l=P.parseAxisParam(a,i.shape),u=W.getAxesPermutation(l,o),c=l,d=i,p=[];u!=null&&(d=Wa({inputs:{x:i},backend:n,attrs:{perm:u}}),p.push(d),c=W.getInnerMostAxes(c.length,o));let h=n.data.get(d.dataId).values,{outVals:m,outShape:g,outDtype:v}=zie(d.shape,d.dtype,h,c),y=g;return s&&(y=W.expandShapeToKeepDim(g,l)),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(y,v,m)}var sqe={kernelName:$f,backendName:"cpu",kernelFunc:aqe};function oqe(e,t,n){e.forEach((r,i)=>{if(r<0||r>=n){let a=P.indexToLoc(i,t.length,P.computeStrides(t)).join(",");throw new Error(`indices[${a}] = ${r} is not in [0, ${n})`)}})}function lqe(e,t){for(let n=0;n<e.length;++n){let r=e[n],i=n===e.length-1?t:e[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let a=1;a<r.length;++a)if(r[a-1]>r[a])throw new Error("Ragged splits must be sorted in ascending order")}}function uqe(e,t,n,r){let i=[],a=0,s=t.length-1+n.length,o=new Array(s).fill(null).map(()=>[0]);lqe(n,r);let l=1;for(let u=0;u<t.length-1;++u){l*=t[u];let c=t[u+1];for(let d=1;d<l+1;++d)o[u].push(d*c)}for(let u=0;u<e.length;++u){let c=e[u],d=e[u]+1;for(let p=0;p<n.length;++p){let h=n[p],m=p+t.length-1;if(m>=0){let g=o[m],v=g[g.length-1]-h[c];for(let y=c;y<d;++y)o[m].push(h[y+1]+v)}c=h[c],d=h[d]}d!==c&&(i.push([c,d]),a+=d-c)}return{outSplits:o,valueSlices:i,numValues:a}}function cqe(e){let t=[];for(let n=0;n<e.length;++n){let r=e[n].length,i=P.getArrayFromDType("int32",r);t.push(i),e[n].forEach((a,s)=>i[s]=a)}return t}function XU(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function dqe(e,t,n,r,i,a){let s=XU(t,2)[1],o=XU(a,2)[1],l=0;for(let u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)i[l*o+d]=e[c*s+d];++l}}function pqe(e,t,n,r,i){let a=t.slice();a[0]=i;let s=P.getArrayFromDType(n,P.sizeFromShape(a)),o=e.length,l=o===0?0:o/t[0];return dqe(e,t,r,l,s,a),[s,a]}function Bie(e,t,n,r,i,a,s,o){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");let l=t[0][0]-1;if(oqe(a,s,l),r.length===0)throw new Error("params.rank must be nonzero");let u=r[0],{outSplits:c,valueSlices:d,numValues:p}=uqe(a,s,e,u),h=cqe(c),m=pqe(n,r,i,d,p);return[h,m[0],m[1]]}var JU=2147483647;function Wie(e,t,n,r,i,a,s){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");let o=t.length===0,l=i.length===0,u=s.length===0,c=[];o||c.push(t[0]),l||c.push(i[0]),u||c.push(s[0]);for(let v=1;v<c.length;++v)if(c[v]!==c[v-1])throw new Error("starts, limits, and deltas must have the same shape");let d=c.length===0?1:c[0],p=P.getArrayFromDType("int32",d+1);p[0]=0;for(let v=0;v<d;++v){let y=o?e[0]:e[v],b=l?r[0]:r[v],_=u?a[0]:a[v];if(_===0)throw new Error("Requires delta != 0");let k;if(_>0&&b<y||_<0&&b>y)k=0;else if(k=Math.ceil(Math.abs((b-y)/_)),k>JU)throw new Error(`Requires ((limit - start) / delta) <= ${JU}`);p[v+1]=p[v]+k}let h=p[d],m=P.getArrayFromDType(n,h),g=0;for(let v=0;v<d;++v){let y=p[v+1]-p[v],b=o?e[0]:e[v],_=u?a[0]:a[v];for(let k=0;k<y;++k)m[g++]=b,b+=_}return[p,m]}var Js=W.RowPartitionType,hqe=class ZP{constructor(t,n,r,i,a,s,o,l,u,c){this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=i,this.valuesDType=a,this.defaultValue=s,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=W.getRowPartitionTypesHelper(c),this.raggedRank=W.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===Js.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===Js.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){let n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case Js.VALUE_ROWIDS:return ZP.getMaxWidthValueRowID(n);case Js.ROW_SPLITS:return ZP.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Js[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){let n=t.length;if(n===0||n===1)return 0;let r=0;for(let i=0;i<n-1;++i){let a=t[i+1]-t[i];a>r&&(r=a)}return r}static getMaxWidthValueRowID(t){let n=t.length;if(n===0)return 0;let r=0,i=t[0],a=0;for(let s=1;s<n;++s){let o=t[s];o!==i&&(i=o,a=Math.max(s-r,a),r=s)}return Math.max(n-r,a)}tensorShapeFromTensor(t,n,r=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return QU(t,r)}calculateOutputSize(t){let n=this.valuesShape,r=this.defaultValueShape;W.validateDefaultValueShape(r,n);let i=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=W.combineRaggedTensorToTensorShapes(this.raggedRank,i,n);a[0]<0&&(a[0]=t);for(let s=1;s<=this.raggedRank;++s)a[s]<0&&(a[s]=this.getMaxWidth(s));return a}calculateFirstParentOutputIndex(t,n,r){let i=Math.min(t,r),a=[],s=0;for(let o=0;o<i;++o,s+=n)a.push(s);for(let o=i;o<t;++o)a.push(-1);return P.assert(a.length===t,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(t,n,r,i){let a=t.length,s=[];for(let o=0;o<a-1;++o){let l=t[o+1]-t[o],u=Math.min(i,l),c=n[o];c===-1&&(u=0);for(let d=0;d<u;++d)s.push(c),c+=r;for(let d=0;d<l-u;++d)s.push(-1)}if(a>0&&s.length!==t[a-1])throw new Error("Invalid row split size.");return s}calculateOutputIndexValueRowID(t,n,r,i){let a=t.length,s=[];if(a===0)return[];let o=0,l=t[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];s.push(u);for(let c=1;c<a;++c){let d=t[c];if(d===l)u>=0&&(++o,o<i?u+=r:u=-1);else{if(o=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}s.push(u)}if(s.length!==t.length)throw new Error("Invalid row ids.");return s}calculateOutputIndex(t,n,r,i){let a=this.getRowPartitionTensor(t),s=this.getRowPartitionTypeByDimension(t);switch(s){case Js.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,n,r,i);case Js.ROW_SPLITS:if(a.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(a,n,r,i);default:throw new Error(`Unsupported partition type: ${Js[s]}`)}}getFirstDimensionSize(){let t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");let n=this.rowPartitionTypes[0];switch(n){case Js.FIRST_DIM_SIZE:return t[0];case Js.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Js.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Js[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let t=this.getFirstDimensionSize(),n=this.calculateOutputSize(t),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let s=r.length-2;s>=0;--s)r[s]=r[s+1]*n[s+1];let i=QU(n,!1),a=P.getArrayFromDType(this.valuesDType,P.sizeFromShape(i));if(r[0]*n[0]>0){let s=this.calculateFirstParentOutputIndex(t,r[0],n[0]);for(let o=1;o<=this.raggedRank;++o)s=this.calculateOutputIndex(o-1,s,r[o],n[o]);this.setOutput(this.raggedRank,s,a,i)}return[i,a]}setOutput(t,n,r,i){if(r.length===0)return;let a=this.values,s=r,o=i.slice();o=o.slice(t+1);let l=P.sizeFromShape(o),u=n.length,c=this.defaultValue;if(c.length!==l&&c.length!==1){let m=this.defaultValueShape;le(()=>{let g=oe(c,m);c=Pp(g,o).dataSync()})}let d=0,p=0,h=0;for(let m=0;m<=u;++m){let g=m<u?n[m]:-1;if(g===h){++h;continue}if(p<h){let v=a.subarray(d*l),y=s.subarray(p*l),b=(h-p)*l;YU(y,v,b)}if(m>=u){let v=r.length;g=Math.floor(v/l)}if(g>h)if(this.defaultValue.length===1)s.subarray(h*l,g*l).fill(this.defaultValue[0]),h=g;else for(;g>h;){let v=s.slice(h*l);YU(v,c,l),++h}g<0?(d=m+1,p=h):(d=m,p=h,h=p+1)}}};function YU(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function QU(e,t){let n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function Vie(e,t,n,r,i,a,s,o,l,u){return new hqe(e,t,n,r,i,a,s,o,l,u).compute()}function uz(e,t,n,r){let i=e===t,a=e<t&&n<0,s=t<e&&n>1;if(i||a||s)return P.makeZerosTypedArray(0,r);let o=Math.abs(Math.ceil((t-e)/n)),l=P.makeZerosTypedArray(o,r);t<e&&n===1&&(n=-1),l[0]=e;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}var jie=Yl(e=>1/Math.sqrt(e)),fqe=Fd(Rf,jie),mqe={kernelName:Rf,backendName:"cpu",kernelFunc:fqe};function kp(e,t,n,r,i,a,s,o,l,u){let c=[r/i,i],d=e.values,p=t.values;if(r===0)return Gt(n,t.dtype);let h=l instanceof Br?l:Gt(c,t.dtype);typeof l=="string"||typeof l=="number"?h.values.fill(l):typeof l=="boolean"&&h.values.fill(+l);for(let m=0;m<a;m++){let g=[],v=0;for(let y=0;y<s;y++){let b=d[m*s+y];g.push(b),v+=b*o[y]}if(v<0||v>=r/i)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let y=0;y<i;y++)u?h.values[v*i+y]+=p[m*i+y]:h.values[v*i+y]=t.rank===0?p[0]:p[m*i+y]}return h}var gqe=Yl(e=>1/(1+Math.exp(-e))),Uie=Mn(Bf,e=>1/(1+Math.exp(-e))),yqe={kernelName:Bf,backendName:"cpu",kernelFunc:Uie};function lI(e,t,n,r,i){let a=ei.isSliceContinous(r,t,n),s=P.sizeFromShape(n),o=P.computeStrides(r);if(a){let d=ei.computeFlatOffset(t,o);return i==="string"?e.slice(d,d+s):e.subarray(d,d+s)}let l=i==="string"?W.fromUint8ToStringArray(e):e,u=Gt(r,i,l),c=Gt(n,i);for(let d=0;d<c.size;++d){let p=c.indexToLoc(d),h=p.map((m,g)=>m+t[g]);c.set(u.get(...h),...p)}return i==="string"?W.fromStringArrayToUint8(c.values):c.values}function ph(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,size:s}=r;dt(i,"slice");let[o,l]=ei.parseSliceParams(i,a,s);ei.assertParamsValid(i,o,l);let u=n.data.get(i.dataId).values,c=lI(u,o,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,c)}var vqe={kernelName:Sv,backendName:"cpu",kernelFunc:ph};function Hie(e,t,n,r,i,a,s){let o=t[0],l=a[0],u=new Array(l),c=new Array(o),d=t[1];if(l===0){if(o!==0)throw new Error(W.getSparseFillEmptyRowsIndicesDenseShapeMismatch(o));let v=P.getArrayFromDType(n,0),y=P.getArrayFromDType(i,0);return[v,[0,d],y,u,c]}let p=!0,h=0,m=new Array(l).fill(0);for(let v=0;v<o;++v){let y=e[v*d];if(y<0)throw new Error(W.getSparseFillEmptyRowsNegativeIndexErrorMessage(v,y));if(y>=l)throw new Error(W.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(v,y,l));++m[y],p=p&&y>=h,h=y}let g=!0;for(let v=0;v<l;++v){let y=m[v]===0;u[v]=y,g=g&&!y,m[v]=Math.max(m[v],1),v>0&&(m[v]+=m[v-1])}if(g&&p){let v=e,y=r;for(let b=0;b<o;++b)c[b]=b;return[v,[o,d],y,u,c]}else{let v=m[l-1],y=P.getArrayFromDType(n,v*d),b=P.getArrayFromDType(i,v),_=new Array(l).fill(0);for(let k=0;k<o;++k){let C=e[k*d],$=_[C],N=(C===0?0:m[C-1])+$;_[C]++;for(let A=0;A<d;++A)y[N*d+A]=e[k*d+A];b[N]=r[k],c[k]=N}for(let k=0;k<l;++k)if(_[k]===0){let C=k===0?0:m[k-1];y[C*d+0]=k;for(let $=1;$<d;++$)y[C*d+$]=0;b[C]=s}return[y,[v,d],b,u,c]}}function Gie(e,t,n,r,i){let a=P.sizeFromShape(r),s=t[0],o=i.length,l=[],u=1,c=-1;for(let g=0;g<o;++g){let v=i[g];if(v===-1){if(c!==-1)throw new Error(W.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(c,g));c=g,l.push(1)}else{if(v<0)throw new Error(W.getSparseReshapeNegativeOutputDimErrorMessage(g,v));u*=v,l.push(v)}}if(c!==-1){if(u<=0)throw new Error(W.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let g=Math.trunc(a/u);if(u*g!==a)throw new Error(W.getSparseReshapeInputOutputMultipleErrorMessage(r,l));l[c]=g}if(P.sizeFromShape(l)!==a)throw new Error(W.getSparseReshapeInputOutputMismatchErrorMessage(r,l));let d=r.length,p=[];if(d>0){p[d-1]=1;for(let g=d-2;g>=0;--g)p[g]=p[g+1]*r[g+1]}let h=[];if(o>0){h[o-1]=1;for(let g=o-2;g>=0;--g)h[g]=h[g+1]*l[g+1]}let m=P.getArrayFromDType(n,s*o);for(let g=0;g<s;++g){let v=0;for(let y=0;y<d;++y)v+=e[g*d+y]*p[y];for(let y=0;y<o;++y)m[g*o+y]=Math.trunc(v/h[y]),v%=h[y]}return[m,[s,o],l]}function cz(e,t,n,r,i,a=!1,s=0){let o=r.length,l=[t[0],e.length/t[0]],u=l[1],c=o>0?i[o-1]+1:0;if(c<0)throw new Error(W.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let d=t.slice();d[0]=c;let p=d.reduce((b,_)=>b*_,1),h=P.getArrayFromDType(n,p);if(o===0)return c>0&&h.fill(s),[h,d];if(c<=0)throw new Error(W.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let m=0,g=1,v=0,y=i[m];for(;;){let b=0;if(g<o){if(b=i[g],y===b){++g;continue}if(y>=b)throw new Error(W.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=c)throw new Error(W.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,c));y>v&&h.fill(s,v*u,y*u);for(let _=m;_<g;++_){let k=r[_];if(k<0||k>=l[0])throw new Error(W.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(_,r[_],l[0]));for(let C=0;C<u;C++)h[y*u+C]+=e[k*u+C]}if(a)for(let _=0;_<u;_++)h[y*u+_]/=g-m;if(m=g,++g,v=y+1,y=b,g>o)break}return v<c&&h.fill(s,v*u,c*u),[h,d]}var bqe=Yl(e=>Math.sqrt(e)),wqe=Mn(Vf,e=>Math.sqrt(e)),xqe={kernelName:Vf,backendName:"cpu",kernelFunc:wqe},qie=Mr((e,t)=>{let n=e-t;return n*n}),_qe=ri(Hf,qie),kqe={kernelName:Hf,backendName:"cpu",kernelFunc:_qe},Kie=Yl((e,t)=>{let{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?"g":""),i)}),Sqe=Fd(lw,Kie),Cqe={kernelName:lw,backendName:"cpu",kernelFunc:Sqe};function Zie(e,t,n,r){let i=Gt(e,t.dtype);for(let a=0;a<i.size;a++){let s=i.indexToLoc(a),o=new Array(s.length);for(let l=0;l<o.length;l++)o[l]=s[l]*n[l]+r[l];i.set(t.get(...o),...s)}return i}var Iqe=class{constructor(e,t,n,r,i,a){this.separator=P.encodeString(e),this.nGramWidths=t,this.leftPad=P.encodeString(n),this.rightPad=P.encodeString(r),this.padWidth=i,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,i,a){for(let s=0;s<i;++s){let o=this.getPadWidth(a),l=Math.max(0,o-s),u=Math.max(0,o-(i-(s+1))),c=a-(l+u),d=t+(l>0?0:s-o),p=0;p+=l*this.leftPad.length;for(let y=0;y<c;++y)p+=e[d+y].length;p+=u*this.rightPad.length;let h=l+u+c-1;p+=h*this.separator.length,n[r+s]=new Uint8Array(p);let m=n[r+s],g=0,v=y=>y.forEach(b=>m[g++]=b);for(let y=0;y<l;++y)v(this.leftPad),v(this.separator);for(let y=0;y<c-1;++y)v(e[d+y]),v(this.separator);if(c>0){v(e[d+c-1]);for(let y=0;y<u;++y)v(this.separator),v(this.rightPad)}else{for(let y=0;y<u-1;++y)v(this.rightPad),v(this.separator);v(this.rightPad)}}}compute(e,t){let n=e.length,r=t.length;if(r>0){let o=t[0];if(o!==0)throw new Error(`First split value must be 0, got ${o}`);for(let l=1;l<r;++l){let u=t[l]>=o;if(u=u&&t[l]<=n,!u)throw new Error(`Invalid split value ${t[l]}, must be in [${o}, ${n}]`);o=t[l]}if(o!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${o}`)}let i=r-1,a=P.getArrayFromDType("int32",r);if(n===0||r===0){let o=new Array(n);for(let l=0;l<=i;++l)a[l]=0;return[o,a]}a[0]=0;for(let o=1;o<=i;++o){let l=t[o]-t[o-1],u=0;this.nGramWidths.forEach(c=>{u+=this.getNumNGrams(l,c)}),this.preserveShort&&l>0&&u===0&&(u=1),a[o]=a[o-1]+u}let s=new Array(a[i]);for(let o=0;o<i;++o){let l=t[o],u=a[o];if(this.nGramWidths.forEach(c=>{let d=t[o+1]-t[o],p=this.getNumNGrams(d,c);this.createNGrams(e,l,s,u,p,c),u+=p}),this.preserveShort&&u===a[o]){let c=t[o+1]-t[o];if(c===0)continue;let d=c+2*this.padWidth;this.createNGrams(e,l,s,u,1,d)}}return[s,a]}};function dz(e,t,n,r,i,a,s,o){return new Iqe(n,r,i,a,s,o).compute(e,t)}function $qe(e,t,n,r){if(!e.length)return;if(t.length===0){for(let a=0;a<e.length;++a)r.push(e.subarray(a,a+1));return}if(t.length===1){let a=t[0],s=e.indexOf(a);for(;s!==-1;){let o=e.subarray(0,s);(!n||o.length!==0)&&r.push(o),e=e.subarray(s+1),s=e.indexOf(a)}(!n||e.length!==0)&&r.push(e);return}let i=0;for(let a=0;a<e.length+1;a++)if(a===e.length||t.indexOf(e[a])!==-1){let s=e.subarray(i,a);(!n||s.length!==0)&&r.push(s),i=a+1}}function pz(e,t,n){let r=e.length,i=[],a=0,s=0,o=new Array(r);for(let p=0;p<r;++p){let h=i.length;$qe(e[p],t,n,i);let m=i.length-h;o[p]=m,a+=m,s=Math.max(s,m)}let l=P.getArrayFromDType("int32",a*2),u=new Array(a),c=[r,s],d=0;for(let p=0;p<r;++p)for(let h=0;h<o[p];++h)l[d*2]=p,l[d*2+1]=h,u[d]=i[d],++d;return[l,u,c]}function hz(e,t){let n=P.getArrayFromDType("int32",e.length);for(let r=0;r<e.length;++r)n[r]=P.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}var Xie=Mr((e,t)=>e-t),Tqe=iz((e,t,n,r)=>({real:e-n,imag:t-r})),fz=ri(Gf,Xie,Tqe),Nqe={kernelName:Gf,backendName:"cpu",kernelFunc:fz};function Jie(e,t){let n=new Array(e.rank);for(let i=0;i<n.length;i++)n[i]=e.shape[i]*t[i];let r=Gt(n,e.dtype);for(let i=0;i<r.values.length;++i){let a=r.indexToLoc(i),s=new Array(e.rank);for(let l=0;l<s.length;l++)s[l]=a[l]%e.shape[l];let o=e.locToIndex(s);r.values[i]=e.values[o]}return r}var eb=(e,t)=>{let n=t.value-e.value;return n===0?e.index-t.index:n};function Yie(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){let o=r-n+1,l=t-n+1,u=Math.log(o),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(o-c)/o)*Math.sign(l-o/2),p=Math.max(n,Math.floor(t-l*c/o+d)),h=Math.min(r,Math.floor(t+(o-l)*c/o+d));Yie(e,t,p,h)}let i=e[t],a=n,s=r;for(P.swap(e,n,t),eb(e[r],i)>0&&P.swap(e,n,r);a<s;){for(P.swap(e,a,s),a++,s--;eb(e[a],i)<0;)a=a+1;for(;eb(e[s],i)>0;)s=s-1}eb(e[n],i)===0?P.swap(e,n,s):(s=s+1,P.swap(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}}function Qie(e,t,n,r,i){let a=t[t.length-1],[s,o]=[e.length/a,a],l=P.getTypedArrayFromDType(n,s*r),u=P.getTypedArrayFromDType("int32",s*r);for(let d=0;d<s;d++){let p=d*o,h=e.subarray(p,p+o),m=new Array(h.length);h.forEach((b,_)=>m[_]={value:b,index:_}),r<m.length&&(Yie(m,r),m=m.slice(0,r)),i&&m.sort(eb);let g=d*r,v=l.subarray(g,g+r),y=u.subarray(g,g+r);for(let b=0;b<r;b++)v[b]=m[b].value,y[b]=m[b].index}let c=t.slice();return c[c.length-1]=r,[Gt(c,n,l),Gt(c,"int32",u)]}function mz(e,t,n,r){let i=P.parseAxisParam(t,n)[0],a=[1,n[0],1];for(let m=0;m<i;m++)a[0]*=n[m];a[1]=n[i];for(let m=i+1;m<n.length;m++)a[2]*=n[m];let s=new Map,o=new Int32Array(n[i]),l=new Br(a,r,e),u=[],c=a[0]===1&&a[2]===1;for(let m=0;m<n[i];m++){let g;if(c)g=e[m].toString();else{let y=[];for(let b=0;b<a[0];b++)for(let _=0;_<a[2];_++)y.push(l.get(b,m,_));g=y.join(",")}let v=s.get(g);if(v!=null)o[m]=v;else{let y=s.size;s.set(g,y),o[m]=y,u.push(m)}}let d=a.slice();d[1]=s.size;let p=new Br(d,r);u.forEach((m,g)=>{for(let v=0;v<a[0];v++)for(let y=0;y<a[2];y++)p.set(l.get(v,m,y),v,g,y)});let h=n.slice();return h[i]=d[1],{outputValues:p.values,outputShape:h,indices:o}}var Eqe="4.16.0";o$("cpu",()=>new nz,1);var eae=Mn(Jh,e=>e>=0?e:Math.exp(e)-1),Oqe={kernelName:Jh,backendName:"cpu",kernelFunc:eae};function tae(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:a}=r;dt([i],"leakyRelu");let s=P.sizeFromShape(i.shape),o=n.data.get(i.dataId).values,l=P.getTypedArrayFromDType("float32",s);for(let u=0;u<o.length;u++)l[u]=o[u]<0?a*o[u]:o[u];return n.makeTensorInfo(i.shape,"float32",l)}var Pqe={kernelName:cf,backendName:"cpu",kernelFunc:tae},Aqe=Mr((e,t)=>e<0?t*e:e);function nae(e){let{inputs:t,backend:n}=e,{x:r,alpha:i}=t;dt([r,i],"prelu");let a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,[o,l]=Aqe(r.shape,i.shape,a,s,"float32");return n.makeTensorInfo(l,"float32",o)}var Mqe={kernelName:If,backendName:"cpu",kernelFunc:nae},rae=Mn(Nf,e=>Math.max(0,e)),Rqe={kernelName:Nf,backendName:"cpu",kernelFunc:rae},iae=Mn(Pf,e=>Math.min(Math.max(0,e),6)),Dqe={kernelName:Pf,backendName:"cpu",kernelFunc:iae};function uI(e,t,n,r,i){if(n==="linear")return Ul({inputs:{x:t},backend:e});if(n==="relu")return rae({inputs:{x:t},backend:e});if(n==="elu")return eae({inputs:{x:t},backend:e});if(n==="relu6")return iae({inputs:{x:t},backend:e});if(n==="prelu")return nae({inputs:{x:t,alpha:r},backend:e});if(n==="leakyrelu")return tae({inputs:{x:t},backend:e,attrs:{alpha:i}});if(n==="sigmoid")return Uie({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}function Qn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:a}=r,s=P.sizeFromShape(i.shape),o=P.inferFromImplicitShape(a,s),l=P.sizeFromShape(o);P.assert(s===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${i.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);let u=n.data.get(i.dataId);if(u.complexTensorInfos!=null){let c=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;c.shape=o,d.shape=o}return{dataId:i.dataId,shape:o,dtype:i.dtype}}var Lqe={kernelName:yv,backendName:"cpu",kernelFunc:Qn};function aae(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a}=t,{transposeA:s,transposeB:o}=r;dt([i,a],"matMul");let l=i.shape.length,u=a.shape.length,c=s?i.shape[l-2]:i.shape[l-1],d=o?a.shape[u-1]:a.shape[u-2],p=s?i.shape[l-1]:i.shape[l-2],h=o?a.shape[u-2]:a.shape[u-1],m=i.shape.slice(0,-2),g=a.shape.slice(0,-2),v=P.sizeFromShape(m),y=P.sizeFromShape(g),b=Rv.assertAndGetBroadcastShape(i.shape.slice(0,-2),a.shape.slice(0,-2)).concat([p,h]);P.assert(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${i.shape} and ${a.shape} and transposeA=${s} and transposeB=${o} must match.`);let _=s?[v,c,p]:[v,p,c],k=o?[y,h,d]:[y,d,h],C=Qn({inputs:{x:i},backend:n,attrs:{shape:_}}),$=Qn({inputs:{x:a},backend:n,attrs:{shape:k}}),N=s?C.shape[1]:C.shape[2],A=s?C.shape[2]:C.shape[1],D=o?$.shape[1]:$.shape[2],O=Math.max(v,y),F=n.data.get(C.dataId).values,E=n.data.get($.dataId).values,z=P.computeStrides(C.shape),q=P.computeStrides($.shape),[H,J,ee]=s?[z[0],1,z[1]]:[z[0],z[1],1],[V,Q,X]=o?[1,q[1],q[0]]:[q[1],1,q[0]],Y=A*D,ce=Gt([O,A,D],C.dtype),pe=ce.values,fe=n.blockSize;for(let ye=0;ye<O;ye++){let _e=ye%v,Ee=ye%y;for(let Se=0;Se<A;Se+=fe){let Re=Math.min(Se+fe,A);for(let Ze=0;Ze<D;Ze+=fe){let at=Math.min(Ze+fe,D);for(let Je=0;Je<N;Je+=fe){let st=Math.min(Je+fe,N);for(let He=Se;He<Re;He++)for(let xt=Ze;xt<at;xt++){let gt=0;for(let ft=Je;ft<st;ft++){let Ft=F[_e*H+He*J+ft*ee],Hn=E[ft*V+xt*Q+Ee*X];gt+=Ft*Hn}pe[ye*Y+(He*D+xt)]+=gt}}}}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo($),n.makeTensorInfo(b,ce.dtype,ce.values)}var Fqe={kernelName:zh,backendName:"cpu",kernelFunc:aae};function zqe(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r,p,h,m,g=[];p=aae({inputs:{a:i,b:a},attrs:{transposeA:l,transposeB:u},backend:n}),s&&(h=uy({inputs:{a:p,b:s},backend:n}),g.push(p),p=h),c&&(m=uI(n,p,c,o,d),g.push(p),p=m);for(let v of g)n.disposeIntermediateTensorInfo(v);return p}var Bqe={kernelName:Jp,backendName:"cpu",kernelFunc:zqe},Wqe=Mn(Eh,e=>Math.acos(e)),Vqe={kernelName:Eh,backendName:"cpu",kernelFunc:Wqe},jqe=Mn(Oh,e=>Math.acosh(e)),Uqe={kernelName:Oh,backendName:"cpu",kernelFunc:jqe};function Hqe(e){let{inputs:t,backend:n}=e,r=t;dt(t,"addN");let i=r.map(o=>n.data.get(o.dataId).values),a=Gt(r[0].shape,r[0].dtype),s=a.values;for(let o=0;o<r.length;o++){let l=i[o];for(let u=0;u<s.length;u++)s[u]+=l[u]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}var Gqe={kernelName:Ph,backendName:"cpu",kernelFunc:Hqe};function qqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;dt(i,"all");let o=P.parseAxisParam(a,i.shape),l=o,u=W.getAxesPermutation(l,i.shape.length),c=i;u!=null&&(c=Wa({inputs:{x:i},backend:n,attrs:{perm:u}}),l=W.getInnerMostAxes(l.length,i.shape.length)),W.assertAxesAreInnerMostDims("all",l,c.shape.length);let[d,p]=W.computeOutAndReduceShapes(c.shape,l),h=P.sizeFromShape(p),m=P.makeZerosTypedArray(P.sizeFromShape(d),c.dtype),g=n.data.get(c.dataId).values;for(let y=0;y<m.length;++y){let b=y*h,_=g[b];for(let k=0;k<h;++k){let C=g[b+k];_=_&&C}m[y]=_}u!=null&&n.disposeIntermediateTensorInfo(c);let v=n.makeTensorInfo(d,c.dtype,m);if(s){let y=W.expandShapeToKeepDim(d,o),b=Qn({inputs:{x:v},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(v),b}return v}var Kqe={kernelName:My,backendName:"cpu",kernelFunc:qqe};function Zqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;dt(i,"any");let o=P.parseAxisParam(a,i.shape),l=o,u=W.getAxesPermutation(l,i.shape.length),c=i;u!=null&&(c=Wa({inputs:{x:i},backend:n,attrs:{perm:u}}),l=W.getInnerMostAxes(l.length,i.shape.length)),W.assertAxesAreInnerMostDims("any",l,c.shape.length);let[d,p]=W.computeOutAndReduceShapes(c.shape,l),h=P.sizeFromShape(p),m=P.makeZerosTypedArray(P.sizeFromShape(d),c.dtype),g=n.data.get(c.dataId).values;for(let y=0;y<m.length;++y){let b=y*h,_=g[b];for(let k=0;k<h;++k){let C=g[b+k];_=_||C}m[y]=_}u!=null&&n.disposeIntermediateTensorInfo(c);let v=n.makeTensorInfo(d,c.dtype,m);if(s){let y=W.expandShapeToKeepDim(d,o),b=Qn({inputs:{x:v},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(v),b}return v}var Xqe={kernelName:Ry,backendName:"cpu",kernelFunc:Zqe};function Jqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r;dt(i,"argMax");let s=P.parseAxisParam(a,i.shape),o=W.getAxesPermutation(s,i.shape.length),l=i,u=[];o!=null&&(l=Wa({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),s=W.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],W.assertAxesAreInnerMostDims("argMax",s,l.shape.length);let[c,d]=W.computeOutAndReduceShapes(l.shape,s),p=P.sizeFromShape(c),h=P.makeZerosTypedArray(p,"int32"),m=P.sizeFromShape(d),g=n.data.get(l.dataId).values;for(let v=0;v<h.length;++v){let y=v*m,b=g[y],_=0;for(let k=0;k<m;++k){let C=g[y+k];C>b&&(b=C,_=k)}h[v]=_}return u.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(c,"int32",h)}var Yqe={kernelName:Dy,backendName:"cpu",kernelFunc:Jqe};function Qqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r;dt(i,"argMin");let s=P.parseAxisParam(a,i.shape),o=W.getAxesPermutation(s,i.shape.length),l=i,u=[];o!=null&&(l=Wa({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),s=W.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],W.assertAxesAreInnerMostDims("argMin",s,l.shape.length);let[c,d]=W.computeOutAndReduceShapes(l.shape,s),p=P.sizeFromShape(c),h=P.makeZerosTypedArray(p,"int32"),m=P.sizeFromShape(d),g=n.data.get(l.dataId).values;for(let v=0;v<h.length;++v){let y=v*m,b=g[y],_=0;for(let k=0;k<m;++k){let C=g[y+k];C<b&&(b=C,_=k)}h[v]=_}return u.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(c,"int32",h)}var eKe={kernelName:Ly,backendName:"cpu",kernelFunc:Qqe},tKe=Mn(Ah,e=>Math.asin(e)),nKe={kernelName:Ah,backendName:"cpu",kernelFunc:tKe},rKe=Mn(Mh,e=>Math.asinh(e)),iKe={kernelName:Mh,backendName:"cpu",kernelFunc:rKe},aKe=Mn(Rh,e=>Math.atan(e)),sKe={kernelName:Rh,backendName:"cpu",kernelFunc:aKe},oKe=Mr((e,t)=>Math.atan2(e,t)),lKe=ri(Lh,oKe),uKe={kernelName:Lh,backendName:"cpu",kernelFunc:lKe},cKe=Mn(Dh,e=>Math.atanh(e)),dKe={kernelName:Dh,backendName:"cpu",kernelFunc:cKe};function gz(e,t,n,r,i,a){let s=i.strideHeight,o=i.strideWidth,l=i.dilationHeight,u=i.dilationWidth,c=i.effectiveFilterHeight,d=i.effectiveFilterWidth,p=i.padInfo.top,h=i.padInfo.left,m=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Gt(i.outShape,n),v=g.values,y=i.outShape[1]*i.outShape[2]*i.outShape[3],b=i.outShape[2]*i.outShape[3],_=i.outShape[3];for(let k=0;k<i.batchSize;++k){let C=k*y,$=k*r[0];for(let N=0;N<i.inChannels;++N)for(let A=0;A<i.outHeight;++A){let D=A*s-p,O=Math.max(0,D),F=Math.min(i.inHeight,c+D),E=C+A*b;for(let z=0;z<i.outWidth;++z){let q=z*o-h,H=Math.max(0,q),J=Math.min(i.inWidth,d+q),ee=m,V=0,Q=0;for(let Y=O;Y<F;Y+=l){let ce=$+Y*r[1];for(let pe=H;pe<J;pe+=u){let fe=ce+pe*r[2],ye=e[fe+N];a==="max"&&ye>ee?ee=ye:a==="avg"&&(V+=ye,Q++)}if(isNaN(ee))break}let X=E+z*_+N;v[X]=a==="avg"?V/Q:ee}}}return g}function sae(e,t,n,r,i=!1,a=!1){let s=Gt(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=r.padInfo.top,m=r.padInfo.left,g=Gt(t,n,e);for(let v=0;v<r.batchSize;++v)for(let y=0;y<r.inChannels;++y)for(let b=0;b<r.outHeight;++b){let _=b*o-h,k=_;for(;k<0;)k+=u;let C=Math.min(r.inHeight,d+_);for(let $=0;$<r.outWidth;++$){let N=$*l-m,A=N;for(;A<0;)A+=c;let D=Math.min(r.inWidth,p+N),O=Number.NEGATIVE_INFINITY,F=-1;for(let E=k;E<C;E+=u){let z=E-_;for(let q=A;q<D;q+=c){let H=q-N,J=g.get(v,E,q,y);J>O&&(O=J,i?F=a?((v*r.inHeight+E)*r.inWidth+q)*r.inChannels+y:(E*r.inWidth+q)*r.inChannels+y:F=z*p+H)}}s.set(F,v,b,$,y)}}return s}function oae(e,t,n,r,i,a){let s=i.strideDepth,o=i.strideHeight,l=i.strideWidth,u=i.dilationDepth,c=i.dilationHeight,d=i.dilationWidth,p=i.effectiveFilterDepth,h=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=i.padInfo.front,v=i.padInfo.top,y=i.padInfo.left,b=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,_=Gt(i.outShape,n),k=_.values,C=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],$=i.outShape[2]*i.outShape[3]*i.outShape[4],N=i.outShape[3]*i.outShape[4],A=i.outShape[4];for(let D=0;D<i.batchSize;++D){let O=D*C,F=D*r[0];for(let E=0;E<i.inChannels;++E)for(let z=0;z<i.outDepth;++z){let q=z*s-g,H=q;for(;H<0;)H+=u;let J=Math.min(i.inDepth,p+q),ee=O+z*$;for(let V=0;V<i.outHeight;++V){let Q=V*o-v,X=Q;for(;X<0;)X+=c;let Y=Math.min(i.inHeight,h+Q),ce=ee+V*N;for(let pe=0;pe<i.outWidth;++pe){let fe=pe*l-y,ye=fe;for(;ye<0;)ye+=d;let _e=Math.min(i.inWidth,m+fe),Ee=ce+pe*A,Se=b,Re=0,Ze=0;for(let Je=H;Je<J;Je+=u){let st=F+Je*r[1];for(let He=X;He<Y;He+=c){let xt=st+He*r[2];for(let gt=ye;gt<_e;gt+=d){let ft=xt+gt*r[3],Ft=e[ft+E];if(a==="max"&&Ft>Se?Se=Ft:a==="avg"&&(Re+=Ft,Ze++),isNaN(Se))break}if(isNaN(Se))break}if(isNaN(Se))break}let at=Ee+E;k[at]=a==="avg"?Re/Math.max(Ze,1):Se}}}}return _}function pKe(e,t){let n=Gt(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=t.padInfo.front,h=t.padInfo.top,m=t.padInfo.left;for(let g=0;g<t.batchSize;++g)for(let v=0;v<t.inChannels;++v)for(let y=0;y<t.outDepth;++y){let b=y*r-p,_=b;for(;_<0;)_+=s;let k=Math.min(t.inDepth,u+b);for(let C=0;C<t.outHeight;++C){let $=C*i-h,N=$;for(;N<0;)N+=o;let A=Math.min(t.inHeight,c+$);for(let D=0;D<t.outWidth;++D){let O=D*a-m,F=O;for(;F<0;)F+=l;let E=Math.min(t.inWidth,d+O),z=Number.NEGATIVE_INFINITY,q=-1;for(let H=_;H<k;H+=s){let J=H-b;for(let ee=N;ee<A;ee+=o){let V=ee-$;for(let Q=F;Q<E;Q+=l){let X=Q-O,Y=e.get(g,H,ee,Q,v);Y>=z&&(z=Y,q=J*c*d+V*c+X)}}}n.set(q,g,y,C,D,v)}}}return n}function hKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;dt(i,"avgPool");let{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=r,u=1;P.assert(W.eitherStridesOrDilationsAreOne(s,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let c=W.computePool2DInfo(i.shape,a,s,u,o,l),d;if(c.filterWidth===1&&c.filterHeight===1&&P.arraysEqual(c.inShape,c.outShape))d=Ul({inputs:{x:i},backend:n});else{let p=n.data.get(i.dataId).values,h=P.computeStrides(i.shape),m=gz(p,i.shape,i.dtype,h,c,"avg");d=n.makeTensorInfo(c.outShape,i.dtype,m.values)}return d}var fKe={kernelName:Fh,backendName:"cpu",kernelFunc:hKe};function mKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r;dt(i,"avgPool3d");let c=W.computePool3DInfo(i.shape,a,s,1,o,l,u),d=n.data.get(i.dataId).values,p=oae(d,i.shape,i.dtype,P.computeStrides(i.shape),c,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}var gKe={kernelName:Fy,backendName:"cpu",kernelFunc:mKe};function yKe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r;dt([i,a],"avgPool3DGrad");let c=W.computePool3DInfo(a.shape,s,o,1,l,u),d=c.strideDepth,p=c.strideHeight,h=c.strideWidth,m=c.filterDepth,g=c.filterHeight,v=c.filterWidth,y=c.dilationDepth,b=c.dilationHeight,_=c.dilationWidth,k=c.effectiveFilterDepth,C=c.effectiveFilterHeight,$=c.effectiveFilterWidth,N=k-1-c.padInfo.front,A=$-1-c.padInfo.left,D=C-1-c.padInfo.top,O=Gt(a.shape,"float32"),F=1/(m*g*v),E=n.bufferSync(i);for(let z=0;z<c.batchSize;++z)for(let q=0;q<c.inChannels;++q)for(let H=0;H<c.inDepth;++H)for(let J=0;J<c.inHeight;++J)for(let ee=0;ee<c.inWidth;++ee){let V=H-N,Q=J-D,X=ee-A,Y=0;for(let ce=0;ce<k;ce+=y){let pe=(V+ce)/d;if(!(pe<0||pe>=c.outDepth||Math.floor(pe)!==pe))for(let fe=0;fe<C;fe+=b){let ye=(Q+fe)/p;if(!(ye<0||ye>=c.outHeight||Math.floor(ye)!==ye))for(let _e=0;_e<$;_e+=_){let Ee=(X+_e)/h;if(Ee<0||Ee>=c.outWidth||Math.floor(Ee)!==Ee)continue;let Se=E.get(z,pe,ye,Ee,q);Y+=Se}}}O.set(Y*F,z,H,J,ee,q)}return n.makeTensorInfo(O.shape,O.dtype,O.values)}var vKe={kernelName:K1,backendName:"cpu",kernelFunc:yKe};function bKe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,s=a;dt([i,a],"avgPoolGrad");let{filterSize:o,strides:l,pad:u}=r,c=W.computePool2DInfo(s.shape,o,l,1,u),d=c.strideHeight,p=c.strideWidth,h=c.filterHeight,m=c.filterWidth,g=c.dilationHeight,v=c.dilationWidth,y=c.effectiveFilterHeight,b=c.effectiveFilterWidth,_=b-1-c.padInfo.left,k=y-1-c.padInfo.top,C=Gt(s.shape,"float32"),$=1/(h*m),N=n.data.get(i.dataId).values,A=Gt(i.shape,"float32",N);for(let D=0;D<c.batchSize;++D)for(let O=0;O<c.inChannels;++O)for(let F=0;F<c.inHeight;++F)for(let E=0;E<c.inWidth;++E){let z=F-k,q=E-_,H=0;for(let J=0;J<y;J+=g){let ee=(z+J)/d;if(!(ee<0||ee>=c.outHeight||Math.floor(ee)!==ee))for(let V=0;V<b;V+=v){let Q=(q+V)/p;if(Q<0||Q>=c.outWidth||Math.floor(Q)!==Q)continue;let X=A.get(D,ee,Q,O);H+=X}}C.set(H*$,D,F,E,O)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}var wKe={kernelName:q1,backendName:"cpu",kernelFunc:bKe};function xKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,scale:a,offset:s,mean:o,variance:l}=t;P.assert(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),P.assert(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),P.assert(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),dt([i,o,l,a,s],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);let c=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,p=n.data.get(l.dataId).values,h=a?n.data.get(a.dataId).values:new Float32Array([1]),m=s?n.data.get(s.dataId).values:new Float32Array([0]),g=new Float32Array(c.length),v=m.length,y=h.length,b=p.length,_=d.length,k=0,C=0,$=0,N=0;for(let A=0;A<c.length;++A)g[A]=m[k++]+(c[A]-d[C++])*h[$++]/Math.sqrt(p[N++]+u),k>=v&&(k=0),C>=_&&(C=0),$>=y&&($=0),N>=b&&(N=0);return n.makeTensorInfo(i.shape,i.dtype,g)}var _Ke={kernelName:rf,backendName:"cpu",kernelFunc:xKe};function kKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,crops:s}=r;dt([i],"batchToSpaceND");let o=a.reduce((y,b)=>y*b),l=W.getReshaped(i.shape,a,o),u=W.getPermuted(l.length,a.length),c=W.getReshapedPermuted(i.shape,a,o),d=W.getSliceBeginCoords(s,a.length),p=W.getSliceSize(c,s,a.length),h=Qn({inputs:{x:i},backend:n,attrs:{shape:l}}),m=Wa({inputs:{x:h},backend:n,attrs:{perm:u}}),g=Qn({inputs:{x:m},backend:n,attrs:{shape:c}}),v=ph({inputs:{x:g},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),v}var SKe={kernelName:zy,backendName:"cpu",kernelFunc:kKe};function CKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:s}=r,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,u=az(o,l,a.dtype,a.shape,s);return n.makeTensorInfo([s],a.dtype,u)}var IKe={kernelName:By,backendName:"cpu",kernelFunc:CKe};function $Ke(e){let{inputs:t,backend:n}=e,{s0:r,s1:i}=t,a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,o=W.assertAndGetBroadcastShape(Array.from(a),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}var TKe={kernelName:Z1,backendName:"cpu",kernelFunc:$Ke},NKe=Mn(Ed,(e,t)=>{let n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),EKe={kernelName:Ed,backendName:"cpu",kernelFunc:NKe},OKe=e=>{let{x:t}=e.inputs,n=e.backend,r=new Float32Array(P.sizeFromShape(t.shape)),i=n.data.get(t.dataId),a=i.complexTensorInfos.real,s=i.complexTensorInfos.imag,o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values;for(let u=0;u<o.length;u++){let c=o[u],d=l[u];r[u]=Math.hypot(c,d)}return n.makeOutput(r,t.shape,"float32")},PKe={kernelName:X1,backendName:"cpu",kernelFunc:OKe};function cy(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}var AKe={kernelName:e$,backendName:"cpu",kernelFunc:cy};function dy(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,a=P.parseAxisParam(i,t[0].shape)[0],s=t.map(g=>g.shape);W.assertParamsConsistent(s,a);let o=W.computeOutShape(t.map(g=>g.shape),a);if(P.sizeFromShape(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(g=>P.sizeFromShape(g.shape)>0);if(l.length===1)return Ul({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){let g=l.map(k=>dh({inputs:{input:k},backend:n})),v=l.map(k=>cy({inputs:{input:k},backend:n})),y=dy({inputs:g,backend:n,attrs:{axis:a}}),b=dy({inputs:v,backend:n,attrs:{axis:a}}),_=is({inputs:{real:y,imag:b},backend:n});return g.forEach(k=>n.disposeIntermediateTensorInfo(k)),v.forEach(k=>n.disposeIntermediateTensorInfo(k)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),_}let u=l.map(g=>{let v=[-1,P.sizeFromShape(g.shape.slice(a))];return Qn({inputs:{x:g},backend:n,attrs:{shape:v}})}),c=u.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));o=W.computeOutShape(u.map(g=>g.shape),1);let d=u[0].shape[0]===1,p=sz(c,o,t[0].dtype,d),h=W.computeOutShape(l.map(g=>g.shape),a),m=n.makeTensorInfo(h,t[0].dtype,p);return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}var MKe={kernelName:Vy,backendName:"cpu",kernelFunc:dy};function lae(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=r;dt([i,a],"conv2d");let d=W.convertConv2DDataFormat(l),p=W.computeConv2DInfo(i.shape,a.shape,s,u,o,c,!1,d),h=p.filterHeight,m=p.filterWidth,g=p.dilationHeight,v=p.dilationWidth,y=p.padInfo.left,b=p.padInfo.top,_=p.dataFormat==="channelsLast",k=new Br(p.outShape,i.dtype),C=P.computeStrides(i.shape),$=P.computeStrides(a.shape),N=C[0],A=_?C[1]:C[2],D=_?C[2]:1,O=_?1:C[1],F=k.strides[0],E=_?k.strides[1]:k.strides[2],z=_?k.strides[2]:1,q=_?1:k.strides[1],H=n.data.get(i.dataId).values,J=n.data.get(a.dataId).values,ee=k.values;for(let V=0;V<p.batchSize;++V){let Q=V*N,X=V*F;for(let Y=0;Y<p.outHeight;++Y){let ce=X+Y*E,pe=Y*p.strideHeight-b;for(let fe=0;fe<h;++fe){let ye=pe+fe*g;if(ye<0||ye>=p.inHeight)continue;let _e=fe*$[0],Ee=Q+ye*A;for(let Se=0;Se<p.outWidth;++Se){let Re=ce+Se*z,Ze=Se*p.strideWidth-y;for(let at=0;at<m;++at){let Je=Ze+at*v;if(Je<0||Je>=p.inWidth)continue;let st=_e+at*$[1],He=Ee+Je*D,xt=st;for(let gt=0;gt<p.inChannels;++gt){let ft=H[He+gt*O];for(let Ft=0;Ft<p.outChannels;++Ft)ee[Re+Ft*q]+=ft*J[xt+Ft];xt+=p.outChannels}}}}}}return n.makeTensorInfo(k.shape,k.dtype,ee)}var RKe={kernelName:Vh,backendName:"cpu",kernelFunc:lae};function DKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;dt([i,a],"conv2dBackpropFilter");let d=W.convertConv2DDataFormat(l),p=W.computeConv2DInfo(i.shape,c,s,1,o,u,!1,d),{strideHeight:h,strideWidth:m,filterHeight:g,filterWidth:v}=p,y=p.dataFormat==="channelsLast",b=new Br(p.filterShape,"float32"),_=p.padInfo.left,k=p.padInfo.top,C=n.data.get(i.dataId).values,$=n.data.get(a.dataId).values,N=new Br(i.shape,i.dtype,C),A=new Br(a.shape,a.dtype,$);for(let D=0;D<g;++D){let O=Math.max(0,Math.ceil((k-D)/h)),F=Math.min(p.outHeight,(p.inHeight+k-D)/h);for(let E=0;E<v;++E){let z=Math.max(0,Math.ceil((_-E)/m)),q=Math.min(p.outWidth,(p.inWidth+_-E)/m);for(let H=0;H<p.inChannels;++H)for(let J=0;J<p.outChannels;++J){let ee=0;for(let V=0;V<p.batchSize;++V)for(let Q=O;Q<F;++Q){let X=D+Q*h-k;for(let Y=z;Y<q;++Y){let ce=E+Y*m-_;y?ee+=N.get(V,X,ce,H)*A.get(V,Q,Y,J):ee+=N.get(V,H,X,ce)*A.get(V,J,Q,Y)}}b.set(ee,D,E,H,J)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}var LKe={kernelName:q2,backendName:"cpu",kernelFunc:DKe};function FKe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{inputShape:s,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=r;dt([i,a],"conv2dBackpropInput");let d=P.computeStrides(a.shape),p=P.computeStrides(i.shape),h=W.convertConv2DDataFormat(u),m=W.computeConv2DInfo(s,a.shape,o,1,l,c,!1,h),g=new Br(m.inShape,"float32"),v=g.values,y=n.data.get(i.dataId).values,b=n.data.get(a.dataId).values,[_,k,C]=d,{batchSize:$,filterHeight:N,filterWidth:A,inChannels:D,inHeight:O,inWidth:F,outChannels:E,outHeight:z,outWidth:q,strideHeight:H,strideWidth:J}=m;h=m.dataFormat;let ee=N-1-m.padInfo.top,V=A-1-m.padInfo.left,Q=h==="channelsLast",X=g.strides[0],Y=Q?g.strides[1]:g.strides[2],ce=Q?g.strides[2]:1,pe=Q?1:g.strides[1],fe=p[0],ye=Q?p[1]:p[2],_e=Q?p[2]:1,Ee=Q?1:p[1];for(let Se=0;Se<$;++Se)for(let Re=0;Re<D;++Re)for(let Ze=0;Ze<O;++Ze){let at=Ze-ee,Je=Math.max(0,Math.ceil(at/H)),st=Math.min(z,(N+at)/H);for(let He=0;He<F;++He){let xt=He-V,gt=Math.max(0,Math.ceil(xt/J)),ft=Math.min(q,(A+xt)/J),Ft=0;for(let _t=Je;_t<st;++_t){let bn=_t*H-at;for(let Jt=gt;Jt<ft;++Jt){let Mt=Jt*J-xt,Rn=fe*Se+ye*_t+_e*Jt,Gn=_*(N-1-bn)+k*(A-1-Mt)+C*Re;for(let wn=0;wn<E;++wn){let $n=y[Rn+Ee*wn],cn=b[Gn+wn];Ft+=$n*cn}}}let Hn=X*Se+Y*Ze+ce*He+pe*Re;v[Hn]=Ft}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}var zKe={kernelName:jh,backendName:"cpu",kernelFunc:FKe};function BKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l}=r;dt([i,a],"conv3d");let u=W.computeConv3DInfo(i.shape,a.shape,s,l,o),{filterDepth:c,filterHeight:d,filterWidth:p,dilationDepth:h,dilationHeight:m,dilationWidth:g,padInfo:v}=u,y=v.front,b=v.left,_=v.top,k=new Br(u.outShape,i.dtype),C=n.data.get(i.dataId).values,$=n.data.get(a.dataId).values,N=k.values,A=P.computeStrides(i.shape),D=P.computeStrides(a.shape);for(let O=0;O<u.batchSize;++O){let F=O*A[0],E=O*k.strides[0];for(let z=0;z<u.outDepth;++z){let q=E+z*k.strides[1],H=z*u.strideDepth-y;for(let J=0;J<c;++J){let ee=H+J*h;if(ee<0||ee>=u.inDepth)continue;let V=J*D[0],Q=F+ee*A[1];for(let X=0;X<u.outHeight;++X){let Y=q+X*k.strides[2],ce=X*u.strideHeight-_;for(let pe=0;pe<d;++pe){let fe=ce+pe*m;if(fe<0||fe>=u.inHeight)continue;let ye=V+pe*D[1],_e=Q+fe*A[2];for(let Ee=0;Ee<u.outWidth;++Ee){let Se=Y+Ee*u.outChannels,Re=Ee*u.strideWidth-b;for(let Ze=0;Ze<p;++Ze){let at=Re+Ze*g;if(at<0||at>=u.inWidth)continue;let Je=ye+Ze*D[2],st=_e+at*u.inChannels,He=Je;for(let xt=0;xt<u.inChannels;++xt){let gt=C[st+xt];for(let ft=0;ft<u.outChannels;++ft)N[Se+ft]+=gt*$[He+ft];He+=u.outChannels}}}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}var WKe={kernelName:Uh,backendName:"cpu",kernelFunc:BKe};function VKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:o,filterShape:l}=r;dt([i,a],"conv3dBackpropFilterV2");let u=P.computeStrides(i.shape),c=P.computeStrides(a.shape),d=W.computeConv3DInfo(i.shape,l,s,1,o),p=d.strideDepth,h=d.strideHeight,m=d.strideWidth,g=d.filterDepth,v=d.filterHeight,y=d.filterWidth,b=new Br(d.filterShape,"float32"),_=b.values,[k,C,$,N]=b.strides,A=n.data.get(a.dataId).values,[D,O,F,E]=c,z=n.data.get(i.dataId).values,[q,H,J,ee]=u,V=d.padInfo.front,Q=d.padInfo.left,X=d.padInfo.top;for(let Y=0;Y<g;++Y){let ce=Math.max(0,Math.ceil((V-Y)/p)),pe=Math.min(d.outDepth,(d.inDepth+V-Y)/p),fe=Y*k;for(let ye=0;ye<v;++ye){let _e=Math.max(0,Math.ceil((X-ye)/h)),Ee=Math.min(d.outHeight,(d.inHeight+X-ye)/h),Se=ye*C+fe;for(let Re=0;Re<y;++Re){let Ze=Math.max(0,Math.ceil((Q-Re)/m)),at=Math.min(d.outWidth,(d.inWidth+Q-Re)/m),Je=Re*$+Se;for(let st=0;st<d.inChannels;++st){let He=st*N+Je;for(let xt=0;xt<d.outChannels;++xt){let gt=0;for(let ft=0;ft<d.batchSize;++ft){let Ft=ft*q,Hn=ft*D;for(let _t=ce;_t<pe;++_t){let bn=(Y+_t*p-V)*H+Ft,Jt=_t*O+Hn;for(let Mt=_e;Mt<Ee;++Mt){let Rn=(ye+Mt*h-X)*J+bn,Gn=Mt*F+Jt;for(let wn=Ze;wn<at;++wn){let $n=(Re+wn*m-Q)*ee+Rn,cn=wn*E+Gn;gt+=z[$n+st]*A[cn+xt]}}}}_[He+xt]=gt}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}var jKe={kernelName:jy,backendName:"cpu",kernelFunc:VKe};function UKe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{pad:s,strides:o,inputShape:l}=r;dt([i],"conv3dBackpropInputV2");let u=P.computeStrides(i.shape),c=P.computeStrides(a.shape),d=W.computeConv3DInfo(l,a.shape,o,1,s),p=new Br(d.inShape,"float32"),h=p.values,[m,g,v,y]=p.strides,b=n.data.get(i.dataId).values,[_,k,C,$]=u,N=n.data.get(a.dataId).values,[A,D,O,F]=c,{batchSize:E,filterDepth:z,filterHeight:q,filterWidth:H,inChannels:J,inDepth:ee,inHeight:V,inWidth:Q,outChannels:X,outDepth:Y,outHeight:ce,outWidth:pe,strideDepth:fe,strideHeight:ye,strideWidth:_e}=d,Ee=z-1-d.padInfo.front,Se=q-1-d.padInfo.top,Re=H-1-d.padInfo.left;for(let Ze=0;Ze<E;++Ze)for(let at=0;at<J;++at)for(let Je=0;Je<ee;++Je){let st=Je-Ee,He=Math.max(0,Math.ceil(st/fe)),xt=Math.min(Y,(z+st)/fe);for(let gt=0;gt<V;++gt){let ft=gt-Se,Ft=Math.max(0,Math.ceil(ft/ye)),Hn=Math.min(ce,(q+ft)/ye);for(let _t=0;_t<Q;++_t){let bn=_t-Re,Jt=Math.max(0,Math.ceil(bn/_e)),Mt=Math.min(pe,(H+bn)/_e),Rn=0;for(let Gn=He;Gn<xt;++Gn){let wn=Gn*fe-st;for(let $n=Ft;$n<Hn;++$n){let cn=$n*ye-ft;for(let Nr=Jt;Nr<Mt;++Nr){let wi=Nr*_e-bn,tr=_*Ze+k*Gn+C*$n+$*Nr,$a=A*(z-1-wn)+D*(q-1-cn)+O*(H-1-wi)+F*at;for(let yn=0;yn<X;++yn){let Ge=b[tr+yn],rt=N[$a+yn];Rn+=Ge*rt}}}}h[m*Ze+g*Je+v*gt+y*_t+at]=Rn}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}var HKe={kernelName:Uy,backendName:"cpu",kernelFunc:UKe},GKe=Mn(Hh,e=>Math.cos(e)),qKe={kernelName:Hh,backendName:"cpu",kernelFunc:GKe},KKe=Mn(Gh,e=>Math.cosh(e)),ZKe={kernelName:Gh,backendName:"cpu",kernelFunc:KKe};function XKe(e){let{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:a,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:u}=r,[c,d,p,h]=i.shape,m=a.shape[0],[g,v]=o,y=Gt([m,g,v,h],"float32"),b=n.data.get(a.dataId).values,_=n.data.get(s.dataId).values,k=n.data.get(i.dataId).values,C=P.computeStrides(i.shape),$=P.computeStrides(y.shape);for(let N=0;N<m;N++){let A=N*4,D=b[A],O=b[A+1],F=b[A+2],E=b[A+3],z=_[N];if(z>=c)continue;let q=g>1?(F-D)*(d-1)/(g-1):0,H=v>1?(E-O)*(p-1)/(v-1):0;for(let J=0;J<g;J++){let ee=g>1?D*(d-1)+J*q:.5*(D+F)*(d-1);if(ee<0||ee>d-1){for(let V=0;V<v;V++)for(let Q=0;Q<h;Q++){let X=Q+V*$[2]+J*$[1]+N*$[0];y.values[X]=u}continue}if(l==="bilinear"){let V=Math.floor(ee),Q=Math.ceil(ee),X=ee-V;for(let Y=0;Y<v;Y++){let ce=v>1?O*(p-1)+Y*H:.5*(O+E)*(p-1);if(ce<0||ce>p-1){for(let _e=0;_e<h;_e++){let Ee=_e+Y*$[2]+J*$[1]+N*$[0];y.values[Ee]=u}continue}let pe=Math.floor(ce),fe=Math.ceil(ce),ye=ce-pe;for(let _e=0;_e<h;_e++){let Ee=_e+pe*C[2]+V*C[1]+z*C[0],Se=k[Ee];Ee=_e+fe*C[2]+V*C[1]+z*C[0];let Re=k[Ee];Ee=_e+pe*C[2]+Q*C[1]+z*C[0];let Ze=k[Ee];Ee=_e+fe*C[2]+Q*C[1]+z*C[0];let at=k[Ee],Je=Se+(Re-Se)*ye,st=Ze+(at-Ze)*ye;Ee=_e+Y*$[2]+J*$[1]+N*$[0],y.values[Ee]=Je+(st-Je)*X}}}else for(let V=0;V<v;++V){let Q=v>1?O*(p-1)+V*H:.5*(O+E)*(p-1);if(Q<0||Q>p-1){for(let ce=0;ce<h;ce++){let pe=ce+V*$[2]+J*$[1]+N*$[0];y.values[pe]=u}continue}let X=Math.round(Q),Y=Math.round(ee);for(let ce=0;ce<h;ce++){let pe=ce+X*C[2]+Y*C[1]+z*C[0],fe=ce+V*$[2]+J*$[1]+N*$[0];y.values[fe]=k[pe]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}var JKe={kernelName:Gy,backendName:"cpu",kernelFunc:XKe};function YKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:s,reverse:o}=r;dt(i,"cumprod");let l=W.getAxesPermutation([a],i.shape.length),u=i;l!=null&&(u=Wa({inputs:{x:i},backend:n,attrs:{perm:l}}));let c=W.getInnerMostAxes(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);let d=Ls(u.dtype,"int32"),p=P.makeOnesTypedArray(P.sizeFromShape(u.shape),d),h=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],g=o?(y,b)=>y+m-b-1:(y,b)=>y+b;for(let y=0;y<h.length;y+=m)for(let b=0;b<m;b++){let _=g(y,b);if(b===0)p[_]=s?1:h[_];else{let k=g(y,b-1);p[_]=s?h[k]*p[k]:h[_]*p[k]}}let v=n.makeTensorInfo(u.shape,d,p);if(l!=null){let y=W.getUndoAxesPermutation(l),b=Wa({inputs:{x:v},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(u),b}return v}var QKe={kernelName:Hy,backendName:"cpu",kernelFunc:YKe};function eZe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:s,reverse:o}=r;dt(i,"cumsum");let l=W.getAxesPermutation([a],i.shape.length),u=i;l!=null&&(u=Wa({inputs:{x:i},backend:n,attrs:{perm:l}}));let c=W.getInnerMostAxes(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);let d=Ls(u.dtype,"int32"),p=P.makeZerosTypedArray(P.sizeFromShape(u.shape),d),h=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],g=o?(y,b)=>y+m-b-1:(y,b)=>y+b;for(let y=0;y<h.length;y+=m)for(let b=0;b<m;b++){let _=g(y,b);if(b===0)p[_]=s?0:h[_];else{let k=g(y,b-1);p[_]=s?h[k]+p[k]:h[_]+p[k]}}let v=n.makeTensorInfo(u.shape,d,p);if(l!=null){let y=W.getUndoAxesPermutation(l),b=Wa({inputs:{x:v},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(u),b}return v}var tZe={kernelName:qh,backendName:"cpu",kernelFunc:eZe};function nZe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:s,binaryOutput:o}=r;if(i.shape.length===1){let l=n.data.get(i.dataId).values,u=n.data.get(a.dataId).values,c=az(l,u,a.dtype,a.shape,s);return n.makeTensorInfo([s],a.dtype,c)}else if(i.shape.length===2){let l=n.bufferSync(i),u=n.bufferSync(a),c=gie(l,u,s,o);return n.makeTensorInfo(c.shape,a.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}var rZe={kernelName:J1,backendName:"cpu",kernelFunc:nZe};function iZe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:a,dataFormat:s}=r;P.assert(s==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${s}`);let o=i.shape[0],l=i.shape[1],u=i.shape[2],c=i.shape[3],d=l*a,p=u*a,h=c/(a*a),m=n.data.get(i.dataId).values,g=new Float32Array(o*d*p*h),v=0;for(let y=0;y<o;++y)for(let b=0;b<d;++b){let _=Math.floor(b/a),k=b%a;for(let C=0;C<p;++C){let $=Math.floor(C/a),N=C%a,A=(k*a+N)*h;for(let D=0;D<h;++D){let O=D+A+c*($+u*(_+l*y));g[v++]=m[O]}}}return n.makeTensorInfo([o,d,p,h],i.dtype,g)}var aZe={kernelName:qy,backendName:"cpu",kernelFunc:iZe};function uae(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:u}=r;dt([i,a],"depthwiseConv2DNative");let c=P.computeStrides(i.shape),d=P.computeStrides(a.shape),p=l;p==null&&(p=[1,1]),P.assert(W.eitherStridesOrDilationsAreOne(s,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${p}'`);let h=W.computeConv2DInfo(i.shape,a.shape,s,p,o,u,!0),{filterHeight:m,filterWidth:g,dilationHeight:v,dilationWidth:y,padInfo:b}=h,_=b.left,k=b.top,C=h.outChannels/h.inChannels,$=new Br(h.outShape,i.dtype),N=n.data.get(i.dataId).values,A=n.data.get(a.dataId).values,D=$.values;for(let O=0;O<h.batchSize;++O){let F=O*c[0],E=O*$.strides[0];for(let z=0;z<h.outHeight;++z){let q=E+z*$.strides[1],H=z*h.strideHeight-k;for(let J=0;J<m;++J){let ee=H+J*v;if(ee<0||ee>=h.inHeight)continue;let V=J*d[0],Q=F+ee*c[1];for(let X=0;X<h.outWidth;++X){let Y=q+X*$.strides[2],ce=X*h.strideWidth-_;for(let pe=0;pe<g;++pe){let fe=ce+pe*y;if(fe<0||fe>=h.inWidth)continue;let ye=V+pe*d[1],_e=Q+fe*h.inChannels,Ee=Y,Se=ye;for(let Re=0;Re<h.inChannels;++Re){let Ze=N[_e+Re];for(let at=0;at<C;++at)D[Ee+at]+=Ze*A[Se+at];Ee+=C,Se+=C}}}}}}return n.makeTensorInfo($.shape,$.dtype,$.values)}var sZe={kernelName:Kh,backendName:"cpu",kernelFunc:uae};function oZe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r;dt([i,a],"depthwiseConv2dNativeBackpropFilter");let d=W.computeConv2DInfo(i.shape,c,s,o,l,u,!0),{strideHeight:p,strideWidth:h,filterHeight:m,filterWidth:g}=d,v=new Br(d.filterShape,"float32"),y=d.padInfo.left,b=d.padInfo.top,_=d.outChannels/d.inChannels,k=n.data.get(i.dataId).values,C=new Br(i.shape,i.dtype,k),$=n.data.get(a.dataId).values,N=new Br(a.shape,a.dtype,$);for(let A=0;A<m;++A){let D=Math.max(0,Math.ceil((b-A)/p)),O=Math.min(d.outHeight,(d.inHeight+b-A)/p);for(let F=0;F<g;++F){let E=Math.max(0,Math.ceil((y-F)/h)),z=Math.min(d.outWidth,(d.inWidth+y-F)/h);for(let q=0;q<d.outChannels;++q){let H=Math.trunc(q/_),J=q%_,ee=0;for(let V=0;V<d.batchSize;++V)for(let Q=D;Q<O;++Q){let X=A+Q*p-b;for(let Y=E;Y<z;++Y){let ce=F+Y*h-y;ee+=C.get(V,X,ce,H)*N.get(V,Q,Y,q)}}v.set(ee,A,F,H,J)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}var lZe={kernelName:K2,backendName:"cpu",kernelFunc:oZe};function uZe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=r;dt([i,a],"depthwiseConv2DNativeBackpropInput");let d=P.computeStrides(i.shape),p=P.computeStrides(a.shape),h=W.computeConv2DInfo(c,a.shape,s,o,l,u,!0),m=new Br(h.inShape,"float32"),g=m.values,[v,y,b]=m.strides,_=n.data.get(i.dataId).values,[k,C,$]=d,N=n.data.get(a.dataId).values,[A,D,O]=p,{batchSize:F,filterHeight:E,filterWidth:z,inChannels:q,inHeight:H,inWidth:J,outChannels:ee,outHeight:V,outWidth:Q,strideHeight:X,strideWidth:Y}=h,ce=E-1-h.padInfo.top,pe=z-1-h.padInfo.left,fe=ee/q;for(let ye=0;ye<F;++ye)for(let _e=0;_e<q;++_e)for(let Ee=0;Ee<H;++Ee){let Se=Ee-ce,Re=Math.max(0,Math.ceil(Se/X)),Ze=Math.min(V,(E+Se)/X);for(let at=0;at<J;++at){let Je=at-pe,st=Math.max(0,Math.ceil(Je/Y)),He=Math.min(Q,(z+Je)/Y),xt=0;for(let gt=Re;gt<Ze;++gt){let ft=gt*X-Se;for(let Ft=st;Ft<He;++Ft){let Hn=Ft*Y-Je,_t=k*ye+C*gt+$*Ft,bn=A*(E-1-ft)+D*(z-1-Hn)+O*_e;for(let Jt=0;Jt<fe;++Jt){let Mt=_e*fe+Jt,Rn=_[_t+Mt],Gn=N[bn+Jt];xt+=Rn*Gn}}}g[v*ye+y*Ee+b*at+_e]=xt}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}var cZe={kernelName:Z2,backendName:"cpu",kernelFunc:uZe};function dZe(e){let{inputs:t,backend:n}=e,{x:r}=t,i=P.sizeFromShape(r.shape),a=n.data.get(r.dataId).values,s=Gt([i,i],r.dtype),o=s.values;for(let u=0;u<a.length;u++)o[u*i+u]=a[u];let l=[...r.shape,...r.shape];return n.makeTensorInfo(l,s.dtype,s.values)}var pZe={kernelName:Y1,backendName:"cpu",kernelFunc:dZe},hZe={kernelName:Zh,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:i}=e,{strides:a,pad:s,dilations:o}=n,l=t,u=l.data.get(r.dataId).values,c=r.shape.length,d=l.data.get(i.dataId).values,p=i.shape.length,{batchSize:h,inHeight:m,inWidth:g,inChannels:v,outHeight:y,outWidth:b,padInfo:_,strideHeight:k,strideWidth:C,filterHeight:$,filterWidth:N,dilationHeight:A,dilationWidth:D,outShape:O}=W.computeDilation2DInfo(r.shape,i.shape,a,s,"NHWC",o),F=P.sizeFromShape(O),E=O.length,z=P.getArrayFromDType(r.dtype,F);for(let q=0;q<h;++q)for(let H=0;H<y;++H){let J=H*k-_.top;for(let ee=0;ee<b;++ee){let V=ee*C-_.left;for(let Q=0;Q<v;++Q){let X=Number.MIN_SAFE_INTEGER;for(let ce=0;ce<$;++ce){let pe=J+ce*A;if(pe>=0&&pe<m)for(let fe=0;fe<N;++fe){let ye=V+fe*D;if(ye>=0&&ye<g){let _e=P.locToIndex([q,pe,ye,Q],c,P.computeStrides(r.shape)),Ee=P.locToIndex([ce,fe,Q],p,P.computeStrides(i.shape)),Se=u[_e]+d[Ee];Se>X&&(X=Se)}}}let Y=P.locToIndex([q,H,ee,Q],E,P.computeStrides(O));z[Y]=X}}}return{dataId:l.write(P.toTypedArray(z,r.dtype),O,r.dtype),shape:O,dtype:r.dtype}}},fZe={kernelName:Jg,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:i,dy:a}=e,{strides:s,pad:o,dilations:l}=n,u=t,c=P.toNestedArray(r.shape,u.data.get(r.dataId).values),d=P.toNestedArray(i.shape,u.data.get(i.dataId).values),{batchSize:p,inHeight:h,inWidth:m,inChannels:g,outHeight:v,outWidth:y,padInfo:b,strideHeight:_,strideWidth:k,filterHeight:C,filterWidth:$,dilationHeight:N,dilationWidth:A,outShape:D}=W.computeDilation2DInfo(r.shape,i.shape,s,o,"NHWC",l);P.assert(a.rank===D.length,()=>`Error in ${Jg}, dy must have the same rank as output ${D.length}, but got ${a.rank}`);let O=P.toNestedArray(D,u.data.get(a.dataId).values),F=P.makeZerosNestedTypedArray(i.shape,i.dtype);for(let E=0;E<p;++E)for(let z=0;z<v;++z){let q=z*_-b.top;for(let H=0;H<y;++H){let J=H*k-b.left;for(let ee=0;ee<g;++ee){let V=Number.MIN_SAFE_INTEGER,Q=0,X=0;for(let Y=0;Y<C;++Y){let ce=q+Y*N;if(ce>=0&&ce<h)for(let pe=0;pe<$;++pe){let fe=J+pe*A;if(fe>=0&&fe<m){let ye=c[E][ce][fe][ee]+d[Y][pe][ee];ye>V&&(V=ye,Q=Y,X=pe)}}}F[Q][X][ee]+=O[E][z][H][ee]}}}return{dataId:u.write(P.toTypedArray(F,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},mZe={kernelName:Xg,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:i,dy:a}=e,{strides:s,pad:o,dilations:l}=n,u=t,c=P.toNestedArray(r.shape,u.data.get(r.dataId).values),d=P.toNestedArray(i.shape,u.data.get(i.dataId).values),{batchSize:p,inHeight:h,inWidth:m,inChannels:g,outHeight:v,outWidth:y,padInfo:b,strideHeight:_,strideWidth:k,filterHeight:C,filterWidth:$,dilationHeight:N,dilationWidth:A,outShape:D}=W.computeDilation2DInfo(r.shape,i.shape,s,o,"NHWC",l);P.assert(a.rank===D.length,()=>`Error in ${Xg}, dy must have the same rank as output ${D.length}, but got ${a.rank}`);let O=P.toNestedArray(D,u.data.get(a.dataId).values),F=P.makeZerosNestedTypedArray(r.shape,r.dtype);for(let E=0;E<p;++E)for(let z=0;z<v;++z){let q=z*_-b.top;for(let H=0;H<y;++H){let J=H*k-b.left;for(let ee=0;ee<g;++ee){let V=Number.MIN_SAFE_INTEGER,Q=q<0?0:q,X=J<0?0:J;for(let Y=0;Y<C;++Y){let ce=q+Y*N;if(ce>=0&&ce<h)for(let pe=0;pe<$;++pe){let fe=J+pe*A;if(fe>=0&&fe<m){let ye=c[E][ce][fe][ee]+d[Y][pe][ee];ye>V&&(V=ye,Q=ce,X=fe)}}}F[E][Q][X][ee]+=O[E][z][H][ee]}}}return{dataId:u.write(P.toTypedArray(F,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function gZe(e){let{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{canvas:a,options:s}=r,{contextOptions:o,imageOptions:l}=s||{},u=(l==null?void 0:l.alpha)||1,c=(o==null?void 0:o.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);let d=a.getContext(c,(o==null?void 0:o.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${c} type.`);let[p,h]=i.shape.slice(0,2),m=i.shape.length===2?1:i.shape[2],g=n.data.get(i.dataId).values,v=i.dtype==="float32"?255:1,y=new Uint8ClampedArray(h*p*4);for(let _=0;_<p*h;++_){let k=[0,0,0,255*u];for(let $=0;$<m;$++){let N=g[_*m+$];if(i.dtype==="float32"){if(N<0||N>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${N}.`)}else if(i.dtype==="int32"&&(N<0||N>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${N}.`);m===1?(k[0]=N*v,k[1]=N*v,k[2]=N*v):k[$]=N*v}let C=_*4;y[C+0]=Math.round(k[0]),y[C+1]=Math.round(k[1]),y[C+2]=Math.round(k[2]),y[C+3]=Math.round(k[3])}a.width=h,a.height=p;let b=new ImageData(y,h,p);return d.putImageData(b,0,0),i}var yZe={kernelName:X2,backendName:"cpu",kernelFunc:gZe};function Vw(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;dt(i,"sum");let o;i.dtype==="bool"?o=gd({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):o=Ul({inputs:{x:i},backend:n});let l=o.shape.length,u=P.parseAxisParam(a,o.shape),c=W.getAxesPermutation(u,l),d=u,p=o;c!=null&&(p=Wa({inputs:{x:o},backend:n,attrs:{perm:c}}),d=W.getInnerMostAxes(d.length,l)),W.assertAxesAreInnerMostDims("sum",d,p.shape.length);let[h,m]=W.computeOutAndReduceShapes(p.shape,d),g=W.upcastType(p.dtype,"int32"),v=oI(n,h,g),y=P.sizeFromShape(m),b=n.data.get(v.dataId).values,_=n.data.get(p.dataId).values;for(let k=0;k<b.length;++k){let C=k*y,$=0;for(let N=0;N<y;++N)$+=_[C+N];b[k]=$}if(s){let k=W.expandShapeToKeepDim(v.shape,u),C=v;v=Qn({inputs:{x:v},backend:n,attrs:{shape:k}}),n.disposeIntermediateTensorInfo(C)}return n.disposeIntermediateTensorInfo(o),c!=null&&n.disposeIntermediateTensorInfo(p),v}var vZe={kernelName:jf,backendName:"cpu",kernelFunc:Vw};function bZe(e){let{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,a=t,{allDims:s,summedDims:o,idDims:l}=W.decodeEinsumEquation(i,a.length);W.checkEinsumDimSizes(s.length,l,a);let{path:u,steps:c}=W.getEinsumComputePath(o,l),d=c.length,p=null,h=s.length,m=[];for(let g=0;g<d;++g){for(let v of c[g]){let{permutationIndices:y,expandDims:b}=W.getEinsumPermutation(h,l[v]),_;W.isIdentityPermutation(y)?_=a[v]:(_=Wa({inputs:{x:a[v]},backend:n,attrs:{perm:y}}),m.push(_));let k=_.shape.slice();for(let C=0;C<b.length;++C)k.splice(b[C],0,1);P.arraysEqual(_.shape,k)||(_=Qn({inputs:{x:_},backend:n,attrs:{shape:k}}),m.push(_)),p===null?p=_:(p=uT({inputs:{a:_,b:p},backend:n}),m.push(p))}g<d-1&&(u[g]>=0&&(p=Vw({inputs:{x:p},backend:n,attrs:{axis:u[g]-(s.length-h),keepDims:!1}}),m.push(p)),h--)}for(let g of m)g!==p&&n.disposeIntermediateTensorInfo(g);return p}var wZe={kernelName:J2,backendName:"cpu",kernelFunc:bZe};function xZe(e){let{inputs:t,backend:n}=e,{dy:r,y:i}=t;dt([r,i],"eluGrad");let a=new Float32Array(P.sizeFromShape(i.shape)),s=n.data.get(i.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<s.length;++l){let u=s[l];u>=0?a[l]=o[l]:a[l]=o[l]*(u+1)}return n.makeTensorInfo(i.shape,"float32",a)}var _Ze={kernelName:Ky,backendName:"cpu",kernelFunc:xZe},kZe=W.ERF_P,SZe=W.ERF_A1,CZe=W.ERF_A2,IZe=W.ERF_A3,$Ze=W.ERF_A4,TZe=W.ERF_A5,NZe=Mn(Yh,e=>{let t=Math.sign(e),n=Math.abs(e),r=1/(1+kZe*n);return t*(1-((((TZe*r+$Ze)*r+IZe)*r+CZe)*r+SZe)*r*Math.exp(-n*n))}),EZe={kernelName:Yh,backendName:"cpu",kernelFunc:NZe};function cI(e){let{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:a}=r,s=i.shape.length,o=i.shape.slice(),l=a;return a<0&&(P.assert(-(s+1)<=a,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+a+1),o.splice(l,0,1),Qn({inputs:{x:i},backend:n,attrs:{shape:o}})}var OZe={kernelName:Xy,backendName:"cpu",kernelFunc:cI},PZe=Mr((e,t)=>e/t),yz=ri(Xh,PZe),XP={kernelName:Xh,backendName:"cpu",kernelFunc:yz};function cae(e,t,n){let r=e.shape,i=r[0],a=r[1],s=n.data.get(e.dataId),o=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,u=[i,a],c=P.sizeFromShape(u),d=P.getTypedArrayFromDType("float32",c),p=P.getTypedArrayFromDType("float32",c);for(let v=0;v<i;v++){let y=ph({inputs:{x:o},backend:n,attrs:{begin:[v,0],size:[1,a]}}),b=ph({inputs:{x:l},backend:n,attrs:{begin:[v,0],size:[1,a]}}),_=is({inputs:{real:y,imag:b},backend:n}),{real:k,imag:C}=AZe(_,t,n),$=W.mergeRealAndImagArrays(k,C);for(let N=0;N<a;N++){let A=W.getComplexWithIndex($,N);d[v*a+N]=A.real,p[v*a+N]=A.imag}n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(_)}let h=n.makeTensorInfo(u,"float32",d),m=n.makeTensorInfo(u,"float32",p),g=is({inputs:{real:h,imag:m},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),g}function AZe(e,t,n){let r=P.sizeFromShape(e.shape),i=n.data.get(e.dataId),a=n.data.get(i.complexTensorInfos.real.dataId).values,s=n.data.get(i.complexTensorInfos.imag.dataId).values;if(MZe(r)){let o=JP(a,s,r,t,n),l=[e.shape[0],e.shape[1]];if(t){let u=n.makeTensorInfo(l,"float32",o.real),c=n.makeTensorInfo(l,"float32",o.imag),d=n.makeTensorInfo([],"float32",P.createScalarValue(r,"float32")),p=Ul({inputs:{x:d},backend:n}),h=XP.kernelFunc({inputs:{a:u,b:d},backend:n}),m=XP.kernelFunc({inputs:{a:c,b:p},backend:n}),g=n.data.get(h.dataId).values,v=n.data.get(m.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),{real:g,imag:v}}return o}else{let o=W.mergeRealAndImagArrays(a,s),l=RZe(o,r,t);return W.splitRealAndImagArrays(l)}}function MZe(e){return(e&e-1)===0}function JP(e,t,n,r,i){if(n===1)return{real:e,imag:t};let a=W.mergeRealAndImagArrays(e,t),s=n/2,o=W.complexWithEvenIndex(a),l=o.real,u=o.imag,c=[l.length],d=i.makeTensorInfo(c,"float32",l),p=i.makeTensorInfo(c,"float32",u),h=is({inputs:{real:d,imag:p},backend:i}),m=W.complexWithOddIndex(a),g=m.real,v=m.imag,y=[g.length],b=i.makeTensorInfo(y,"float32",g),_=i.makeTensorInfo(y,"float32",v),k=is({inputs:{real:b,imag:_},backend:i}),C=JP(l,u,s,r,i),$=C.real,N=C.imag,A=[$.length],D=i.makeTensorInfo(A,"float32",$),O=i.makeTensorInfo(A,"float32",N),F=is({inputs:{real:D,imag:O},backend:i}),E=JP(g,v,s,r,i),z=E.real,q=E.imag,H=[z.length],J=i.makeTensorInfo(H,"float32",z),ee=i.makeTensorInfo(H,"float32",q),V=is({inputs:{real:J,imag:ee},backend:i}),Q=W.exponents(n,r),X=[Q.real.length],Y=i.makeTensorInfo(X,"float32",Q.real),ce=i.makeTensorInfo(X,"float32",Q.imag),pe=is({inputs:{real:Y,imag:ce},backend:i}),fe=uT({inputs:{a:pe,b:V},backend:i}),ye=uy({inputs:{a:F,b:fe},backend:i}),_e=fz({inputs:{a:F,b:fe},backend:i}),Ee=dh({inputs:{input:ye},backend:i}),Se=dh({inputs:{input:_e},backend:i}),Re=cy({inputs:{input:ye},backend:i}),Ze=cy({inputs:{input:_e},backend:i}),at=dy({inputs:[Ee,Se],backend:i,attrs:{axis:0}}),Je=dy({inputs:[Re,Ze],backend:i,attrs:{axis:0}}),st=i.data.get(at.dataId).values,He=i.data.get(Je.dataId).values;return i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(k),i.disposeIntermediateTensorInfo(D),i.disposeIntermediateTensorInfo(O),i.disposeIntermediateTensorInfo(F),i.disposeIntermediateTensorInfo(J),i.disposeIntermediateTensorInfo(ee),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(Y),i.disposeIntermediateTensorInfo(ce),i.disposeIntermediateTensorInfo(pe),i.disposeIntermediateTensorInfo(fe),i.disposeIntermediateTensorInfo(ye),i.disposeIntermediateTensorInfo(_e),i.disposeIntermediateTensorInfo(Ee),i.disposeIntermediateTensorInfo(Re),i.disposeIntermediateTensorInfo(Se),i.disposeIntermediateTensorInfo(Ze),i.disposeIntermediateTensorInfo(at),i.disposeIntermediateTensorInfo(Je),{real:st,imag:He}}function RZe(e,t,n){let r=new Float32Array(t*2);for(let i=0;i<t;i++){let a=0,s=0;for(let o=0;o<t;o++){let l=W.exponent(i*o,t,n),u=W.getComplexWithIndex(e,o);a+=u.real*l.real-u.imag*l.imag,s+=u.real*l.imag+u.imag*l.real}n&&(a/=t,s/=t),W.assignToTypedArray(r,a,s,i)}return r}function DZe(e){let{inputs:t,backend:n}=e,{input:r}=t,i=P.sizeFromShape(r.shape),a=r.shape[r.shape.length-1],s=i/a,o=Qn({inputs:{x:r},backend:n,attrs:{shape:[s,a]}}),l=cae(o,!1,n),u=Qn({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}var LZe={kernelName:Y2,backendName:"cpu",kernelFunc:DZe};function vz(e){let{backend:t,attrs:n}=e,{shape:r,value:i,dtype:a}=n,s=a||P.inferDtype(i),o=P.getArrayFromDType(s,P.sizeFromShape(r));return zZe(o,i),t.makeTensorInfo(r,s,o)}var FZe={kernelName:Q1,backendName:"cpu",kernelFunc:vz};function zZe(e,t,n){e.fill(t)}var BZe={kernelName:Jy,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,i=n,a=P.getTypedArrayFromDType(r.dtype,P.sizeFromShape(r.shape)),[s,o,l,u]=r.shape,c=i.data.get(r.dataId).values;for(let d=0;d<s;d++){let p=d*l*o*u;for(let h=0;h<o;h++){let m=h*(l*u);for(let g=0;g<l;g++){let v=g*u;for(let y=0;y<u;y++){let b=Math.round(l-g-1),_=p+m+v+y,k=c[_];if(b>=0&&b<l){let C=b*u,$=p+m+C+y;k=c[$]}a[_]=k}}}}return{dataId:i.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function WZe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:m}=r,g=lae({inputs:{x:i,filter:a},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p}});if(s){let v=g;if(c==="NCHW"&&s.shape.length===1&&s.shape[0]!==1){let y=Qn({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});g=uy({inputs:{a:g,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else g=uy({inputs:{a:g,b:s},backend:n});n.disposeIntermediateTensorInfo(v)}if(h){let v=g;if(c==="NCHW"&&h==="prelu"&&o.shape.length===1&&o.shape[0]!==1){let y=Qn({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=uI(n,g,h,y,m),n.disposeIntermediateTensorInfo(y)}else g=uI(n,g,h,o,m);n.disposeIntermediateTensorInfo(v)}return g}var VZe={kernelName:Yp,backendName:"cpu",kernelFunc:WZe};function jZe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:m}=r,g=uae({inputs:{x:i,filter:a},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p}});if(s){let v=g;g=uy({inputs:{a:g,b:s},backend:n}),n.disposeIntermediateTensorInfo(v)}if(h){let v=g;g=uI(n,g,h,o,m),n.disposeIntermediateTensorInfo(v)}return g}var UZe={kernelName:Qp,backendName:"cpu",kernelFunc:jZe};function HZe(e){let{inputs:t,backend:n}=e,{params:r,indices:i}=t,a=P.sizeFromShape(r.shape),s=i.shape,o=s[s.length-1],[l,u,c,d]=W.prepareAndValidate(r,i);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);let p=n.data.get(i.dataId).values,h=n.bufferSync(r),m=Iie(p,h,r.dtype,u,o,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,m.values)}var GZe={kernelName:Qy,backendName:"cpu",kernelFunc:HZe};function qZe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,indices:a}=t,{axis:s,batchDims:o}=r;dt([i,a],"gatherV2");let l=P.parseAxisParam(s,i.shape)[0],u=n.data.get(a.dataId).values,c=i.shape[l];for(let k=0;k<u.length;++k){let C=u[k];P.assert(C<=c-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${c-1}]`)}let d=o;o==null&&(d=0);let p=P.sizeFromShape(a.shape),h=W.segment_util.collectGatherOpShapeInfo(i,a,l,d),m=Qn({inputs:{x:i},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),g=Qn({inputs:{x:a},backend:n,attrs:{shape:[h.batchSize,p/h.batchSize]}}),v=[h.batchSize,h.outerSize,p/h.batchSize,h.sliceSize],y=n.bufferSync(g),b=n.bufferSync(m),_=$ie(b,y,v);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(h.outputShape,_.dtype,_.values)}var KZe={kernelName:Yy,backendName:"cpu",kernelFunc:qZe};function ZZe(e){let{inputs:t,backend:n}=e,{input:r}=t,i=P.sizeFromShape(r.shape),a=r.shape[r.shape.length-1],s=i/a,o=Qn({inputs:{x:r},backend:n,attrs:{shape:[s,a]}}),l=cae(o,!0,n),u=Qn({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}var XZe={kernelName:Q2,backendName:"cpu",kernelFunc:ZZe},JZe=Mn(of,e=>Number.isFinite(e)?1:0,"bool"),YZe={kernelName:of,backendName:"cpu",kernelFunc:JZe},QZe=Mn(lf,e=>Math.abs(e)===1/0?1:0,"bool"),eXe={kernelName:lf,backendName:"cpu",kernelFunc:QZe},tXe=Mn(uf,e=>Number.isNaN(e)?1:0,"bool"),nXe={kernelName:uf,backendName:"cpu",kernelFunc:tXe};function rXe(e){let{backend:t,attrs:n}=e,{start:r,stop:i,num:a}=n,s=Pie(r,i,a);return t.makeTensorInfo([s.length],"float32",s)}var iXe={kernelName:rv,backendName:"cpu",kernelFunc:rXe},aXe=Mn(pf,e=>Math.log1p(e)),sXe={kernelName:pf,backendName:"cpu",kernelFunc:aXe},oXe=Mr((e,t)=>e&&t),lXe=ri(iv,oXe,null,"bool"),uXe={kernelName:iv,backendName:"cpu",kernelFunc:lXe},cXe=Mn(av,e=>e?0:1,"bool"),dXe={kernelName:av,backendName:"cpu",kernelFunc:cXe},pXe=Mr((e,t)=>e||t),hXe=ri(sv,pXe,null,"bool"),fXe={kernelName:sv,backendName:"cpu",kernelFunc:hXe};function mXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:a,bias:s,alpha:o,beta:l}=r;dt(i,"LRN");let u=i.shape[3],c=u-1,d=n.data.get(i.dataId).values,p=P.sizeFromShape(i.shape),h=new Float32Array(p);function m(g){let v=g%u,y=g-v+Math.max(0,v-a),b=g-v+Math.min(v+a,c),_=0;for(;y<=b;y++){let k=d[y];_+=k*k}return _}for(let g=0;g<p;g++){let v=m(g),y=d[g]*Math.pow(s+o*v,-l);h[g]=y}return n.makeTensorInfo(i.shape,i.dtype,h)}var gXe={kernelName:hf,backendName:"cpu",kernelFunc:mXe};function yXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,y:a,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=r;dt(s,"LRNGrad");let d=P.sizeFromShape(s.shape),p=s.shape[3],h=n.data.get(s.dataId).values,m=n.data.get(i.dataId).values,g=n.data.get(a.dataId).values,v=new Float32Array(d),y=d;for(let b=0;b<y;b++){let _=b%p,k=b-_+Math.max(0,_-o),C=b-_+Math.min(p,_+o+1),$=0;for(let N=k;N<C;N++)$+=Math.pow(m[N],2);$=u*$+l;for(let N=k;N<C;N++){let A=-2*u*c*m[N]*g[b]/$;b===N&&(A+=Math.pow($,-c)),A*=h[b],v[N]+=A}}return n.makeTensorInfo(s.shape,i.dtype,v)}var vXe={kernelName:ov,backendName:"cpu",kernelFunc:yXe};function dae(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:a,keepDims:s}=r,o=n,l=i.shape,u=l.length,c=P.parseAxisParam(a,l),d=c,p=W.getAxesPermutation(d,u),h=o.data.get(i.dataId).values;if(p!=null){let k=new Array(u);for(let C=0;C<k.length;C++)k[C]=l[p[C]];h=lz(h,l,i.dtype,p,k),d=W.getInnerMostAxes(d.length,u),l=k}dt(i,"max"),W.assertAxesAreInnerMostDims("max",d,u);let[m,g]=W.computeOutAndReduceShapes(l,d),v=P.sizeFromShape(g),y=Mie(h,v,m,i.dtype),b=o.write(y,m,i.dtype),_=m;return s&&(_=W.expandShapeToKeepDim(m,c)),{dataId:b,shape:_,dtype:i.dtype}}var bXe={kernelName:ff,backendName:"cpu",kernelFunc:dae};function wXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;dt(i,"maxPool");let{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=r,u=1;P.assert(W.eitherStridesOrDilationsAreOne(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let c=W.computePool2DInfo(i.shape,a,s,u,o,l),d;if(c.filterWidth===1&&c.filterHeight===1&&P.arraysEqual(c.inShape,c.outShape))d=Ul({inputs:{x:i},backend:n});else{let p=n.data.get(i.dataId).values,h=P.computeStrides(i.shape),m=gz(p,i.shape,i.dtype,h,c,"max");d=n.makeTensorInfo(c.outShape,i.dtype,m.values)}return d}var xXe={kernelName:gf,backendName:"cpu",kernelFunc:wXe};function _Xe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r;dt(i,"maxPool3d");let c=W.computePool3DInfo(i.shape,a,s,1,o,l,u),d=n.data.get(i.dataId).values,p=oae(d,i.shape,i.dtype,P.computeStrides(i.shape),c,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}var kXe={kernelName:lv,backendName:"cpu",kernelFunc:_Xe};function SXe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r;dt([i,a],"maxPool3DGrad");let c=W.computePool3DInfo(a.shape,s,o,1,l,u),d=n.bufferSync(a),p=pKe(d,c),h=c.strideDepth,m=c.strideHeight,g=c.strideWidth,v=c.dilationDepth,y=c.dilationHeight,b=c.dilationWidth,_=c.effectiveFilterDepth,k=c.effectiveFilterHeight,C=c.effectiveFilterWidth,$=_-1-c.padInfo.front,N=C-1-c.padInfo.left,A=k-1-c.padInfo.top,D=Gt(a.shape,"float32"),O=n.bufferSync(i);for(let F=0;F<c.batchSize;++F)for(let E=0;E<c.inChannels;++E)for(let z=0;z<c.inDepth;++z)for(let q=0;q<c.inHeight;++q)for(let H=0;H<c.inWidth;++H){let J=z-$,ee=q-A,V=H-N,Q=0;for(let X=0;X<_;X+=v){let Y=(J+X)/h;if(!(Y<0||Y>=c.outDepth||Math.floor(Y)!==Y))for(let ce=0;ce<k;ce+=y){let pe=(ee+ce)/m;if(!(pe<0||pe>=c.outHeight||Math.floor(pe)!==pe))for(let fe=0;fe<C;fe+=b){let ye=(V+fe)/g;if(ye<0||ye>=c.outWidth||Math.floor(ye)!==ye)continue;let _e=_*k*C-1-p.get(F,Y,pe,ye,E),Ee=X*k*C+ce*C+fe,Se=_e===Ee?1:0;if(Se===0)continue;let Re=O.get(F,Y,pe,ye,E);Q+=Re*Se}}}D.set(Q,F,z,q,H,E)}return n.makeTensorInfo(D.shape,D.dtype,D.values)}var CXe={kernelName:tw,backendName:"cpu",kernelFunc:SXe};function IXe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a,output:s}=t,o=a;dt([a,s],"maxPoolGrad");let{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,p=W.computePool2DInfo(o.shape,l,u,1,c,d),h=n.data.get(o.dataId).values,m=Gt(p.outShape,o.dtype,sae(h,o.shape,o.dtype,p).values),g=p.strideHeight,v=p.strideWidth,y=p.dilationHeight,b=p.dilationWidth,_=p.effectiveFilterHeight,k=p.effectiveFilterWidth,C=k-1-p.padInfo.left,$=_-1-p.padInfo.top,N=Gt(o.shape,"float32"),A=n.data.get(i.dataId).values,D=Gt(i.shape,"float32",A);for(let O=0;O<p.batchSize;++O)for(let F=0;F<p.inChannels;++F)for(let E=0;E<p.inHeight;++E)for(let z=0;z<p.inWidth;++z){let q=E-$,H=z-C,J=0;for(let ee=0;ee<_;ee+=y){let V=(q+ee)/g;if(!(V<0||V>=p.outHeight||Math.floor(V)!==V))for(let Q=0;Q<k;Q+=b){let X=(H+Q)/v;if(X<0||X>=p.outWidth||Math.floor(X)!==X)continue;let Y=_*k-1-m.get(O,V,X,F),ce=ee*k+Q,pe=Y===ce?1:0;if(pe===0)continue;let fe=D.get(O,V,X,F);J+=fe*pe}}N.set(J,O,E,z,F)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}var $Xe={kernelName:ew,backendName:"cpu",kernelFunc:IXe};function TXe(e,t,n,r,i){let a=P.computeStrides(t),s=gz(e,t,n,a,i,"max"),o=sae(e,t,n,i,!0,r);return[s.values,o.values]}var NXe={kernelName:nw,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:i,strides:a,pad:s,includeBatchInIndex:o}=t,l=n;dt(r,"MaxPoolWithArgmax");let u=l.data.get(r.dataId).values,c=W.computePool2DInfo(r.shape,i,a,[1,1],s),[d,p]=TXe(u,r.shape,r.dtype,o,c),h=l.write(d,c.outShape,r.dtype),m=l.write(p,c.outShape,r.dtype);return[{dataId:h,shape:c.outShape,dtype:r.dtype},{dataId:m,shape:c.outShape,dtype:"int32"}]}};function EXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r,o=P.parseAxisParam(a,i.shape),l=W.computeOutAndReduceShapes(i.shape,o)[1],u=P.sizeFromShape(l),c=[],d=n.makeTensorInfo([],"float32",new Float32Array([u]));c.push(d);let p=gd({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});c.push(p);let h=yz({inputs:{a:p,b:d},backend:n});c.push(h);let m=Vw({inputs:{x:h},backend:n,attrs:{axis:a,keepDims:s}});return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}var OXe={kernelName:yf,backendName:"cpu",kernelFunc:EXe};function PXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;dt(i,"min");let o=P.parseAxisParam(a,i.shape),l=o,u=W.getAxesPermutation(l,i.shape.length),c=i;u!=null&&(c=Wa({inputs:{x:i},backend:n,attrs:{perm:u}}),l=W.getInnerMostAxes(l.length,i.shape.length)),W.assertAxesAreInnerMostDims("min",l,c.shape.length);let[d,p]=W.computeOutAndReduceShapes(c.shape,l),h=P.sizeFromShape(p),m=P.makeZerosTypedArray(P.sizeFromShape(d),c.dtype),g=n.data.get(c.dataId).values;for(let y=0;y<m.length;++y){let b=y*h,_=g[b];for(let k=0;k<h;++k){let C=g[b+k];(Number.isNaN(C)||C<_)&&(_=C)}m[y]=_}u!=null&&n.disposeIntermediateTensorInfo(c);let v=n.makeTensorInfo(d,c.dtype,m);if(s){let y=W.expandShapeToKeepDim(d,o),b=Qn({inputs:{x:v},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(v),b}return v}var AXe={kernelName:vf,backendName:"cpu",kernelFunc:PXe};function MXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:a,mode:s}=r;dt(i,"mirrorPad");let o=a.map((b,_)=>b[0]+i.shape[_]+b[1]),l=a.map(b=>b[0]),u=a.map((b,_)=>b[0]+i.shape[_]),c=s==="reflect"?0:1,d=n.data.get(i.dataId).values,p=i.shape.length,h=P.computeStrides(i.shape),m=P.sizeFromShape(o),g=o.length,v=P.computeStrides(o),y=P.getTypedArrayFromDType(i.dtype,m);for(let b=0;b<m;b++){let _=P.indexToLoc(b,g,v);for(let C=0;C<g;C++)_[C]<l[C]?_[C]=l[C]*2-_[C]-c:_[C]>=u[C]&&(_[C]=(u[C]-1)*2-_[C]+c);_=_.map((C,$)=>C-l[$]);let k=P.locToIndex(_,p,h);y[b]=d[k]}return{dataId:n.write(y,o,i.dtype),shape:o,dtype:i.dtype}}var RXe={kernelName:wf,backendName:"cpu",kernelFunc:MXe},DXe=Mr((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),LXe=ri(xf,DXe),FXe={kernelName:xf,backendName:"cpu",kernelFunc:LXe},zXe=Td(V2());function pae(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:a}=r,s=i.shape.length,o=a;if(o===-1&&(o=s-1),o!==s-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${s} and dim was ${o}`);let l=P.parseAxisParam([o],i.shape),u=dae({inputs:{x:i},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=W.expandShapeToKeepDim(u.shape,l),d=Qn({inputs:{x:u},backend:n,attrs:{shape:c}}),p=fz({inputs:{a:i,b:d},backend:n}),h=_ie({inputs:{x:p},backend:n}),m=Vw({inputs:{x:h},backend:n,attrs:{axis:l,keepDims:!1}}),g=Qn({inputs:{x:m},backend:n,attrs:{shape:c}}),v=yz({inputs:{a:h,b:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),v}var BXe={kernelName:Uf,backendName:"cpu",kernelFunc:pae};function WXe(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:a,seed:s,normalized:o}=r;dt(i,"multinomial");let l=o?i:pae({inputs:{logits:i},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,p=[u,a],h=P.makeZerosTypedArray(P.sizeFromShape(p),"int32");for(let m=0;m<u;++m){let g=m*c,v=new Float32Array(c-1);v[0]=d[g];for(let _=1;_<v.length;++_)v[_]=v[_-1]+d[g+_];let y=zXe.alea(s.toString()),b=m*a;for(let _=0;_<a;++_){let k=y();h[b+_]=v.length;for(let C=0;C<v.length;C++)if(k<v[C]){h[b+_]=C;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",h)}var VXe={kernelName:uv,backendName:"cpu",kernelFunc:WXe},jXe=Jl.nonMaxSuppressionV3Impl;function UXe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r;dt(i,"NonMaxSuppression");let u=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,{selectedIndices:d}=jXe(u,c,s,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}var HXe={kernelName:pv,backendName:"cpu",kernelFunc:UXe},GXe=Jl.nonMaxSuppressionV4Impl;function qXe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r;dt(i,"NonMaxSuppressionPadded");let c=n.data.get(i.dataId).values,d=n.data.get(a.dataId).values,{selectedIndices:p,validOutputs:h}=GXe(c,d,s,o,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}var KXe={kernelName:hv,backendName:"cpu",kernelFunc:qXe},ZXe=Jl.nonMaxSuppressionV5Impl;function XXe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r;dt(i,"NonMaxSuppressionWithScore");let c=n.data.get(i.dataId).values,d=n.data.get(a.dataId).values,p=s,h=o,m=l,g=u,{selectedIndices:v,selectedScores:y}=ZXe(c,d,p,h,m,g);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var JXe={kernelName:fv,backendName:"cpu",kernelFunc:XXe};function YXe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:a,depth:s,onValue:o,offValue:l}=r;dt(i,"oneHot");let u=P.sizeFromShape(i.shape),c=new Float32Array(u*s);c.fill(l);let d=n.data.get(i.dataId).values;for(let p=0;p<u;++p)d[p]>=0&&d[p]<s&&(c[p*s+d[p]]=o);return n.makeTensorInfo([...i.shape,s],a,c)}var QXe={kernelName:kf,backendName:"cpu",kernelFunc:YXe};function dI(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){let i=dh({inputs:{input:r},backend:n}),a=dI({inputs:{x:i},backend:n}),s=cy({inputs:{input:r},backend:n}),o=dI({inputs:{x:s},backend:n}),l=is({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return vz({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var eJe={kernelName:Av,backendName:"cpu",kernelFunc:dI};function hae(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){let i=dh({inputs:{input:r},backend:n}),a=hae({inputs:{x:i},backend:n}),s=cy({inputs:{input:r},backend:n}),o=dI({inputs:{x:s},backend:n}),l=is({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return vz({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}var tJe={kernelName:mv,backendName:"cpu",kernelFunc:hae};function fae(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return cI({inputs:{input:t[0]},backend:n,attrs:{dim:i}});let a=t[0].shape,s=t[0].dtype;t.forEach(c=>{P.assertShapesMatch(a,c.shape,"All tensors passed to stack must have matching shapes"),P.assert(s===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(c=>{let d=cI({inputs:{input:c},backend:n,attrs:{dim:i}});return o.push(d),d}),u=dy({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}var nJe={kernelName:gv,backendName:"cpu",kernelFunc:fae};function rJe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:a,constantValue:s}=r;dt(i,"pad");let o=a.map((y,b)=>y[0]+i.shape[b]+y[1]),l=a.map(y=>y[0]),u=n.data.get(i.dataId).values,c=P.sizeFromShape(i.shape),d=i.shape.length,p=P.computeStrides(i.shape),h=P.sizeFromShape(o),m=o.length,g=P.computeStrides(o),v=P.getTypedArrayFromDType(i.dtype,h);s!==0&&v.fill(s);for(let y=0;y<c;y++){let b=P.indexToLoc(y,d,p).map((k,C)=>k+l[C]),_=P.locToIndex(b,m,g);v[_]=u[y]}return{dataId:n.write(v,o,i.dtype),shape:o,dtype:i.dtype}}var mae={kernelName:Sf,backendName:"cpu",kernelFunc:rJe},iJe=Mr((e,t)=>Math.pow(e,t)),aJe=ri(Cf,iJe),sJe={kernelName:Cf,backendName:"cpu",kernelFunc:aJe};function oJe(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:a,indices:s}=t,o=i.map(v=>n.data.get(v.dataId).values),l=i.map(v=>v.shape),u=n.data.get(a.dataId).values,c=n.data.get(s.dataId).values,[d,p,h]=Bie(o,l,u,a.shape,a.dtype,c,s.shape),m=d.map(v=>n.makeTensorInfo([v.length],"int32",v)),g=n.makeTensorInfo(h,a.dtype,p);return m.concat([g])}var lJe={kernelName:t$,backendName:"cpu",kernelFunc:oJe};function uJe(e){let{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:a}=t,s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,[u,c]=Wie(s,r.shape,r.dtype,o,i.shape,l,a.shape),d=n.makeTensorInfo([u.length],"int32",u),p=n.makeTensorInfo([c.length],r.dtype,c);return[d,p]}var cJe={kernelName:n$,backendName:"cpu",kernelFunc:uJe};function dJe(e){let{inputs:t,backend:n,attrs:r}=e,{shape:i,values:a,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,d=n.data.get(s.dataId).values,p=o.map(v=>n.data.get(v.dataId).values),h=o.map(v=>v.shape),[m,g]=Vie(u,i.shape,c,a.shape,a.dtype,d,s.shape,p,h,l);return n.makeTensorInfo(m,a.dtype,g)}var pJe={kernelName:r$,backendName:"cpu",kernelFunc:dJe};function hJe(e){let{backend:t,attrs:n}=e,{start:r,stop:i,dtype:a,step:s}=n,o=uz(r,i,s,a);return t.makeTensorInfo([o.length],a,o)}var fJe={kernelName:rw,backendName:"cpu",kernelFunc:hJe},mJe=Mn(Tf,e=>1/e),gJe={kernelName:Tf,backendName:"cpu",kernelFunc:mJe};function yJe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:s,size:o}=r;dt(i,"resizeBilinear");let l=P.computeStrides(i.shape),[u,c]=o,[d,p,h,m]=i.shape,g=n.data.get(i.dataId).values,v=new Float32Array(P.sizeFromShape([d,u,c,m])),y=[a&&u>1?p-1:p,a&&c>1?h-1:h],b=[a&&u>1?u-1:u,a&&c>1?c-1:c],_=0,k=y[0]/b[0],C=y[1]/b[1];for(let $=0;$<d;$++)for(let N=0;N<u;N++){let A;s?A=k*(N+.5)-.5:A=k*N;let D=Math.max(0,Math.floor(A)),O=A-D,F=Math.min(p-1,Math.ceil(A)),E=$*l[0]+D*l[1],z=$*l[0]+F*l[1];for(let q=0;q<c;q++){let H;s?H=C*(q+.5)-.5:H=C*q;let J=Math.max(0,Math.floor(H)),ee=H-J,V=Math.min(h-1,Math.ceil(H)),Q=E+J*l[2],X=z+J*l[2],Y=E+V*l[2],ce=z+V*l[2];for(let pe=0;pe<m;pe++){let fe=g[Q+pe],ye=g[X+pe],_e=g[Y+pe],Ee=g[ce+pe],Se=fe+(_e-fe)*ee,Re=ye+(Ee-ye)*ee,Ze=Se+(Re-Se)*O;v[_++]=Ze}}}return n.makeTensorInfo([d,u,c,m],"float32",v)}var vJe={kernelName:Of,backendName:"cpu",kernelFunc:yJe};function bJe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:s}=r;dt([a,i],"resizeBilinearGrad");let o=P.computeStrides(i.shape),[l,u,c,d]=i.shape,[,p,h]=a.shape,m=new Float32Array(l*u*c*d),g=[s&&p>1?u-1:u,s&&h>1?c-1:c],v=[s&&p>1?p-1:p,s&&h>1?h-1:h],y=g[0]/v[0],b=g[1]/v[1],_=n.data.get(a.dataId).values,k=0;for(let C=0;C<l;C++){let $=C*o[0];for(let N=0;N<p;N++){let A=N*y,D=Math.floor(A),O=Math.min(Math.ceil(A),u-1),F=$+D*o[1],E=$+O*o[1],z=A-D,q=1-z;for(let H=0;H<h;H++){let J=H*b,ee=Math.floor(J),V=Math.min(Math.ceil(J),c-1),Q=J-ee,X=1-Q,Y=F+ee*o[2],ce=F+V*o[2],pe=E+ee*o[2],fe=E+V*o[2],ye=q*X,_e=q*Q,Ee=z*X,Se=z*Q;for(let Re=0;Re<d;Re++){let Ze=_[k++];m[Y+Re]+=Ze*ye,m[ce+Re]+=Ze*_e,m[pe+Re]+=Ze*Ee,m[fe+Re]+=Ze*Se}}}}return n.makeTensorInfo([l,c,u,d],"float32",m)}var wJe={kernelName:bv,backendName:"cpu",kernelFunc:bJe};function xJe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:s,size:o}=r;dt(i,"resizeNearestNeighbor");let l=P.computeStrides(i.shape),[u,c]=o,[d,p,h,m]=i.shape,g=n.data.get(i.dataId).values,v=new Float32Array(d*u*c*m),y=[a&&u>1?p-1:p,a&&c>1?h-1:h],b=[a&&u>1?u-1:u,a&&c>1?c-1:c],_=y[0]/b[0],k=y[1]/b[1],C=0;for(let $=0;$<d;$++){let N=$*l[0];for(let A=0;A<u;A++){let D=s?_*(A+.5):_*A,O=Math.min(p-1,a?Math.round(D):Math.floor(D));s&&(O=Math.max(0,O));let F=N+O*l[1];for(let E=0;E<c;E++){let z=s?k*(E+.5):k*E,q=Math.min(h-1,a?Math.round(z):Math.floor(z));s&&(q=Math.max(0,q));let H=F+q*l[2];for(let J=0;J<m;J++){let ee=g[H+J];v[C++]=ee}}}}return n.makeTensorInfo([d,u,c,m],i.dtype,v)}var _Je={kernelName:Ef,backendName:"cpu",kernelFunc:xJe};function kJe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:s}=r;dt([a,i],"resizeNearestNeighborGrad");let o=P.computeStrides(i.shape),l=P.computeStrides(a.shape),[u,c,d,p]=i.shape,[,h,m]=a.shape,g=new Float32Array(u*c*d*p),v=n.data.get(a.dataId).values,y=[s&&h>1?c-1:c,s&&m>1?d-1:d],b=[s&&h>1?h-1:h,s&&m>1?m-1:m],_=y[0]/b[0],k=y[1]/b[1],C=1/_,$=1/k,N=Math.ceil(C)*2+2,A=Math.ceil($)*2+2;for(let D=0;D<u;D++){let O=D*o[0];for(let F=0;F<c;F++){let E=O+F*o[1],z=Math.floor(F*C),q=Math.floor(z-N/2);for(let H=0;H<d;H++){let J=E+H*o[2],ee=Math.floor(H*$),V=Math.floor(ee-A/2);for(let Q=0;Q<p;Q++){let X=0;for(let Y=0;Y<N;Y++){let ce=Y+q;if(ce<0||ce>=h)continue;let pe=O+ce*l[1],fe=ce*_,ye=Math.min(c-1,s?Math.round(fe):Math.floor(fe));if(F===ye)for(let _e=0;_e<A;_e++){let Ee=_e+V;if(Ee<0||Ee>=m)continue;let Se=pe+Ee*l[2],Re=Ee*k,Ze=Math.min(d-1,s?Math.round(Re):Math.floor(Re));H===Ze&&(X+=v[Se+Q])}}g[J+Q]=X}}}}return n.makeTensorInfo(i.shape,i.dtype,g)}var SJe={kernelName:vv,backendName:"cpu",kernelFunc:kJe};function CJe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:a}=r;dt(i,"reverse");let s=i.shape.length,o=P.parseAxisParam(a,i.shape);if(s===0)return Ul({inputs:{x:i},backend:n});let l=new Br(i.shape,i.dtype),u=n.bufferSync(i);for(let c=0;c<l.size;c++){let d=l.indexToLoc(c),p=d.slice();o.forEach(h=>p[h]=i.shape[h]-1-p[h]),l.set(u.get(...p),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}var IJe={kernelName:Af,backendName:"cpu",kernelFunc:CJe},$Je={kernelName:Mv,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:i,fillValue:a,center:s}=t,o=n,l=P.getTypedArrayFromDType(r.dtype,P.sizeFromShape(r.shape)),[u,c,d,p]=r.shape,[h,m]=W.getImageCenter(s,c,d),g=255,v=Math.sin(i),y=Math.cos(i),b=o.data.get(r.dataId).values;for(let _=0;_<u;_++){let k=_*d*c*p;for(let C=0;C<c;C++){let $=C*(d*p);for(let N=0;N<d;N++){let A=N*p;for(let D=0;D<p;D++){let O=[u,C,N,D],F=O[2],E=O[1],z=(F-h)*y-(E-m)*v,q=(F-h)*v+(E-m)*y;z=Math.round(z+h),q=Math.round(q+m);let H=a;if(typeof a!="number"&&(D===3?H=g:H=a[D]),z>=0&&z<d&&q>=0&&q<c){let ee=q*(d*p),V=z*p,Q=k+ee+V+D;H=b[Q]}let J=k+$+A+D;l[J]=H}}}}return{dataId:o.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},TJe=Mn(Mf,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),NJe={kernelName:Mf,backendName:"cpu",kernelFunc:TJe};function EJe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:a}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=W.calculateShapes(a,i,s),p=!0,h=n.bufferSync(i),m=n.bufferSync(a),g=kp(h,m,s,d,u,l,o,c,0,p);return n.makeTensorInfo(s,g.dtype,g.values)}var OJe={kernelName:wv,backendName:"cpu",kernelFunc:EJe};function PJe(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<t?n=i+1:r=i;return r}function AJe(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<=t?n=i+1:r=i;return r}function MJe(e,t,n,r,i,a){let s=P.getArrayFromDType("int32",n*i);for(let o=0;o<n;++o){let l=e.slice(o*r,(o+1)*r),u=o*i;for(let c=0;c<i;++c)s[u+c]=a==="left"?PJe(l,t[c+u]):AJe(l,t[c+u])}return s}function RJe(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:a}=t,{side:s}=r,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,u=MJe(o,l,i.shape[0],i.shape[1],a.shape[1],s);return n.makeTensorInfo(a.shape,"int32",u)}var DJe={kernelName:_v,backendName:"cpu",kernelFunc:RJe};function LJe(e){let{inputs:t,backend:n}=e,{condition:r,t:i,e:a}=t;dt([r,i,a],"select");let s=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(a.dataId).values,c=Ls(i.dtype,a.dtype),d=P.makeZerosTypedArray(P.sizeFromShape(i.shape),c),p=0,h=s===0||s>1||i.shape.length===1?1:P.sizeFromShape(i.shape.slice(1));for(let m=0;m<o.length;m++)for(let g=0;g<h;g++)o[m]===1?d[p++]=l[m]:d[p++]=u[m];return n.makeTensorInfo(i.shape,c,d)}var FJe={kernelName:kv,backendName:"cpu",kernelFunc:LJe},zJe=W.SELU_SCALEALPHA,BJe=W.SELU_SCALE,WJe=Mn(Df,e=>e>=0?BJe*e:zJe*(Math.exp(e)-1)),VJe={kernelName:Df,backendName:"cpu",kernelFunc:WJe},jJe=Mn(zf,e=>e<0?-1:e>0?1:0),UJe={kernelName:zf,backendName:"cpu",kernelFunc:jJe},HJe=Mn(Lf,e=>Math.sin(e)),GJe={kernelName:Lf,backendName:"cpu",kernelFunc:HJe},qJe=Mn(Ff,e=>Math.sinh(e)),KJe={kernelName:Ff,backendName:"cpu",kernelFunc:qJe},ZJe=11920928955078125e-23,eH=Math.log(ZJe)+2,XJe=Mn(Wf,e=>{let t=e>-eH,n=e<eH,r=Math.exp(e),i;return n?i=r:t?i=e:i=Math.log(1+r),i}),JJe={kernelName:Wf,backendName:"cpu",kernelFunc:XJe};function YJe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,paddings:s}=r;dt([i],"spaceToBatchND");let o=P.sizeFromShape(a),l=[[0,0]];l.push(...s);for(let v=1+a.length;v<i.shape.length;++v)l.push([0,0]);let u=mae.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),c=W.getReshaped(u.shape,a,o,!1),d=W.getPermuted(c.length,a.length,!1),p=W.getReshapedPermuted(u.shape,a,o,!1),h=Qn({inputs:{x:u},backend:n,attrs:{shape:c}}),m=Wa({inputs:{x:h},backend:n,attrs:{perm:d}}),g=Qn({inputs:{x:m},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),g}var QJe={kernelName:Cv,backendName:"cpu",kernelFunc:YJe};function eYe(e){let{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:a,defaultValue:s}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);let o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(s.dataId).values[0],[d,p,h,m,g]=Hie(o,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],i.dtype,h),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(v=>Number(v)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}var tYe={kernelName:iw,backendName:"cpu",kernelFunc:eYe};function nYe(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:a}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);let s=Array.from(n.data.get(i.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(a.dataId).values),[u,c,d]=Gie(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}var rYe={kernelName:$v,backendName:"cpu",kernelFunc:nYe};function iYe(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,[u,c]=cz(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(c,r.dtype,u)}var aYe={kernelName:aw,backendName:"cpu",kernelFunc:iYe};function sYe(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,[u,c]=cz(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(c,r.dtype,u)}var oYe={kernelName:sw,backendName:"cpu",kernelFunc:sYe};function lYe(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:a,defaultValue:s}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=W.calculateShapes(a,i,o),h=!1,m=n.bufferSync(i),g;switch(a.dtype){case"bool":{let v=n.bufferSync(a),y=!!n.data.get(s.dataId).values[0];g=kp(m,v,o,p,c,u,l,d,y,h);break}case"float32":{let v=n.bufferSync(a),y=n.data.get(s.dataId).values[0];g=kp(m,v,o,p,c,u,l,d,y,h);break}case"int32":{let v=n.bufferSync(a),y=n.data.get(s.dataId).values[0];g=kp(m,v,o,p,c,u,l,d,y,h);break}case"string":{let v=n.bufferSync(a),y=P.decodeString(n.data.get(s.dataId).values[0]);g=kp(m,v,o,p,c,u,l,d,y,h);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return n.makeTensorInfo(o,g.dtype,g.values)}var uYe={kernelName:Tv,backendName:"cpu",kernelFunc:lYe};function cYe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:a,axis:s}=r,o=P.parseAxisParam(s,i.shape)[0],l=W.prepareSplitSize(i,a,o),u=new Array(i.shape.length).fill(0),c=i.shape.slice();return l.map(d=>{let p=[...c];p[o]=d;let h=ph({inputs:{x:i},backend:n,attrs:{begin:u,size:p}});return u[o]+=d,h})}var dYe={kernelName:Iv,backendName:"cpu",kernelFunc:cYe},pYe={kernelName:ow,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{let{x:n}=e,r=t;dt(n,"square");let i=r.data.get(n.dataId).values,a=new Float32Array(i.length);for(let s=0;s<i.length;++s){let o=i[s];a[s]=o*o}return{dataId:r.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},hYe=Mn(Pd,(e,t)=>{let n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),fYe={kernelName:Pd,backendName:"cpu",kernelFunc:hYe};function mYe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,end:s,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=r;dt(i,"stridedSlice");let{finalShapeSparse:h,finalShape:m,isIdentity:g,sliceDim0:v,isSimpleSlice:y,begin:b,end:_,strides:k}=ei.sliceInfo(i.shape,a,s,o,l,u,c,d,p),C;if(g)C=Qn({inputs:{x:i},backend:n,attrs:{shape:m}});else if(v||y){P.assert(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);let $=ei.computeOutShape(b,_,k),N=ph({inputs:{x:i},backend:n,attrs:{begin:b,size:$}});C=Qn({inputs:{x:N},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(N)}else{let $=n.bufferSync(i),N=Zie(h,$,k,b);C=n.makeTensorInfo(m,N.dtype,N.values)}return C}var gYe={kernelName:Nv,backendName:"cpu",kernelFunc:mYe};function yYe(e){let{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:a,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=t,p=n.data.get(c.dataId).values,h=n.data.get(d.dataId).values,[m,g]=dz(p,h,i,a,s,o,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",g)]}var vYe={kernelName:uw,backendName:"cpu",kernelFunc:yYe};function bYe(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:a,delimiter:s}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);let o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values[0],[u,c,d]=pz(o,l,i),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}var wYe={kernelName:cw,backendName:"cpu",kernelFunc:bYe};function xYe(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");let s=n.data.get(a.dataId).values,o=hz(s,i);return n.makeTensorInfo(a.shape,"int32",o)}var _Ye={kernelName:dw,backendName:"cpu",kernelFunc:xYe},kYe=Mn(qf,e=>Math.tan(e)),SYe={kernelName:qf,backendName:"cpu",kernelFunc:kYe},CYe=Mn(Kf,e=>Math.tanh(e)),IYe={kernelName:Kf,backendName:"cpu",kernelFunc:CYe};function $Ye(e){let{inputs:t,backend:n}=e,{tensor:r,indices:i,updates:a}=t,{sliceRank:s,numUpdates:o,sliceSize:l,strides:u,outputSize:c}=W.calculateShapes(a,i,r.shape),d=!1,p=n.bufferSync(i),h=n.bufferSync(a),m=n.bufferSync(r),g=kp(p,h,r.shape,c,l,o,s,u,m,d);return n.makeTensorInfo(r.shape,g.dtype,g.values)}var TYe={kernelName:xv,backendName:"cpu",kernelFunc:$Ye};function NYe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:a}=r;dt(i,"tile");let s=Jie(n.bufferSync(i),a);return n.makeTensorInfo(s.shape,s.dtype,s.values)}var EYe={kernelName:Od,backendName:"cpu",kernelFunc:NYe};function OYe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:a,sorted:s}=r;dt(i,"topk");let o=n.data.get(i.dataId).values,[l,u]=Qie(o,i.shape,i.dtype,a,s);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}var PYe={kernelName:Ev,backendName:"cpu",kernelFunc:OYe};function AYe(e){let{inputs:t,attrs:n,backend:r}=e,{image:i,transforms:a}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:u}=n,[c,d,p,h]=i.shape,[m,g]=u!=null?u:[d,p],v=[c,m,g,h],y=P.computeStrides(i.shape),b=y[0],_=y[1],k=y[2],C=P.computeStrides(v),$=C[0],N=C[1],A=C[2],D=P.getTypedArrayFromDType(i.dtype,P.sizeFromShape(v));D.fill(l);let O=r.data.get(i.dataId).values,F=r.data.get(a.dataId).values;for(let E=0;E<c;++E){let z=a.shape[0]===1?F:F.subarray(E*8,E*8+8);for(let q=0;q<m;++q)for(let H=0;H<g;++H)for(let J=0;J<h;++J){let ee,V=z[6]*H+z[7]*q+1;if(V===0)continue;let Q=(z[0]*H+z[1]*q+z[2])/V,X=(z[3]*H+z[4]*q+z[5])/V,Y=tH(Q,p,o),ce=tH(X,d,o);switch(s){case"nearest":ee=zYe(O,d,p,b,_,k,E,ce,Y,J,l);break;case"bilinear":ee=BYe(O,d,p,b,_,k,E,ce,Y,J,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${s}`)}let pe=E*$+q*N+H*A+J;D[pe]=ee}return r.makeTensorInfo(v,i.dtype,D)}return{dataId:r.write(D,v,i.dtype),shape:i.shape,dtype:i.dtype}}var MYe={kernelName:Ov,backendName:"cpu",kernelFunc:AYe};function tH(e,t,n){switch(n){case"reflect":return RYe(e,t);case"wrap":return DYe(e,t);case"nearest":return FYe(e,t);case"constant":default:return LYe(e)}}function RYe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{let r=2*t;n-=r*Math.trunc(n/r),n>=t&&(n=r-n-1)}return P.clamp(0,n,t-1)}function DYe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{let r=t-1;n-=t*Math.trunc(n/r)}return P.clamp(0,n,t-1)}function LYe(e,t){return e}function FYe(e,t){return P.clamp(0,e,t-1)}function tb(e,t,n,r,i,a,s,o,l,u,c){let d=s*r+o*i+l*a+u;return 0<=o&&o<t&&0<=l&&l<n?e[d]:c}function zYe(e,t,n,r,i,a,s,o,l,u,c){let d=Math.round(o),p=Math.round(l);return tb(e,t,n,r,i,a,s,d,p,u,c)}function BYe(e,t,n,r,i,a,s,o,l,u,c){let d=Math.floor(o),p=Math.floor(l),h=d+1,m=p+1,g=(m-l)*tb(e,t,n,r,i,a,s,d,p,u,c)+(l-p)*tb(e,t,n,r,i,a,s,d,m,u,c),v=(m-l)*tb(e,t,n,r,i,a,s,h,p,u,c)+(l-p)*tb(e,t,n,r,i,a,s,h,m,u,c);return(h-o)*g+(o-d)*v}function WYe(e){let{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:a}=t;dt(a,"unique");let s=r.data.get(a.dataId).values,{outputValues:o,outputShape:l,indices:u}=mz(s,i,a.shape,a.dtype);return[r.makeTensorInfo(l,a.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}var VYe={kernelName:pw,backendName:"cpu",kernelFunc:WYe};function jYe(e){let{inputs:t,backend:n,attrs:r}=e,{value:i}=t,{axis:a}=r;a<0&&(a+=i.shape.length);let s=i.shape.length,o=i.shape[a],l=new Array(s-1),u=0;for(let h=0;h<s;h++)h!==a&&(l[u++]=i.shape[h]);let c=new Array(s).fill(0),d=i.shape.slice();d[a]=1;let p=new Array(o);for(let h=0;h<p.length;h++){c[a]=h;let m=ph({inputs:{x:i},backend:n,attrs:{begin:c,size:d}});p[h]=Qn({inputs:{x:m},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(m)}return p}var UYe={kernelName:Pv,backendName:"cpu",kernelFunc:jYe};function HYe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:a}=t,{numSegments:s}=r;dt(i,"unsortedSegmentSum");let o=i.shape.length,l=a.shape.length,u=[],c=[],d=o-l,p=a;for(let m=0;m<d;++m){let g=cI({inputs:{input:p},backend:n,attrs:{dim:m+1}});p=g,c.push(g)}for(let m=0;m<s;++m){let g=P.createScalarValue(m,"int32"),v=n.makeTensorInfo([],"int32",g),y=wie({inputs:{a:v,b:p},backend:n}),b=gd({inputs:{x:y},backend:n,attrs:{dtype:"float32"}}),_=uT({inputs:{a:b,b:i},backend:n}),k=Vw({inputs:{x:_},backend:n,attrs:{axis:0,keepDims:!1}});u.push(k),c.push(v),c.push(y),c.push(b),c.push(_),c.push(k)}let h=fae({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),h}var GYe={kernelName:hw,backendName:"cpu",kernelFunc:HYe},qYe=[Bqe,b9e,Vqe,Uqe,C9e,Gqe,Kqe,Xqe,Yqe,eKe,nKe,iKe,sKe,uKe,dKe,fKe,gKe,vKe,wKe,Fqe,_Ke,SKe,IKe,$9e,TKe,k9e,N9e,EKe,w9e,PKe,MKe,RKe,LKe,zKe,WKe,jKe,HKe,qKe,ZKe,JKe,QKe,tZe,rZe,aZe,sZe,lZe,cZe,pZe,hZe,fZe,mZe,yZe,wZe,Oqe,_Ze,E9e,EZe,O9e,OZe,A9e,LZe,FZe,BZe,R9e,L9e,VZe,UZe,GZe,KZe,z9e,W9e,x9e,XZe,AKe,YZe,eXe,nXe,Pqe,j9e,H9e,iXe,q9e,sXe,uXe,dXe,fXe,gXe,vXe,bXe,Z9e,xXe,kXe,CXe,$Xe,NXe,OXe,AXe,J9e,RXe,FXe,VXe,Q9e,tqe,HXe,KXe,JXe,rqe,QXe,tJe,nJe,mae,sJe,Mqe,sqe,lJe,cJe,pJe,fJe,_9e,XP,gJe,Rqe,Dqe,Lqe,vJe,wJe,_Je,SJe,IJe,$Je,NJe,mqe,OJe,DJe,FJe,VJe,yqe,UJe,GJe,KJe,vqe,BXe,JJe,QJe,tYe,rYe,aYe,oYe,uYe,dYe,xqe,pYe,kqe,Cqe,fYe,gYe,vYe,wYe,_Ye,Nqe,vZe,SYe,IYe,TYe,EYe,PYe,MYe,iqe,VYe,UYe,GYe,eJe];for(let e of qYe)fw(e);var gae={};Dt(gae,{assertNotComplex:()=>qv,bindCanvasToFramebuffer:()=>iQe,bindColorTextureToFramebuffer:()=>uk,bindTextureToProgramUniformSampler:()=>Pae,bindTextureUnit:()=>Nae,bindVertexBufferToProgramAttribute:()=>YP,callAndCheck:()=>We,canBeRepresented:()=>vae,createFragmentShader:()=>xae,createFramebuffer:()=>Tae,createProgram:()=>_ae,createStaticIndexBuffer:()=>Cae,createStaticVertexBuffer:()=>Sae,createTexture:()=>Iae,createVertexShader:()=>wae,getBatchDim:()=>hh,getExtensionOrThrow:()=>nb,getFramebufferErrorMessage:()=>Aae,getMaxTexturesInShader:()=>Lae,getNumChannels:()=>nQe,getProgramUniformLocation:()=>Oae,getProgramUniformLocationOrThrow:()=>Eae,getRowsCols:()=>fh,getShapeAs3D:()=>ib,getTextureShapeFromLogicalShape:()=>Rae,getWebGLDisjointQueryTimerVersion:()=>Fae,getWebGLErrorMessage:()=>bae,getWebGLMaxTextureSize:()=>Dae,hasExtension:()=>Ns,isCapableOfRenderingToFloatTexture:()=>zae,isDownloadFloatTextureEnabled:()=>Bae,isReshapeFree:()=>h1,isWebGLFenceEnabled:()=>Wae,isWebGLVersionEnabled:()=>eA,linkProgram:()=>kae,logShaderSourceAndInfoLog:()=>wz,resetMaxTextureSize:()=>aQe,resetMaxTexturesInShader:()=>sQe,unbindColorTextureFromFramebuffer:()=>QP,unbindTextureUnit:()=>rQe,validateFramebuffer:()=>rb,validateProgram:()=>lk,validateTextureSize:()=>$ae});var gp={},g_={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function yae(e,t){gp[e]=t}function tl(e,t){if(!(e in gp)||t!=null){let r=ZYe(e,t);if(r!==null)gp[e]=r;else return console.log("Could not get context for WebGL version",e),null}let n=gp[e];return n==null||n.isContextLost()?(delete gp[e],tl(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),gp[e])}function KYe(e){if(!he().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function ZYe(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=t==null?KYe(e):t;return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete gp[e]},!1),he().getBool("SOFTWARE_WEBGL_ENABLED")&&(g_.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",g_)||n.getContext("experimental-webgl",g_):n.getContext("webgl2",g_)}var p1;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(p1||(p1={}));var Ts;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(Ts||(Ts={}));var $i;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})($i||($i={}));function jw(e,t){return[t,e]}function XYe(e,t){return e*t}function y_(e){let t=P.sizeFromShape(e),n=Math.ceil(t/4);return P.sizeToSquarishShape(n)}function Gv(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function JYe(e,t){let[n,r]=Gv(e,t);return n*r*4}function bz(e,t){let n=e,r,i,a,s,o,l,u,c,d,p;return he().getNumber("WEBGL_VERSION")===2?(r=n.R32F,i=n.R16F,a=n.RGBA16F,s=n.RGBA32F,o=n.RED,u=4,c=1,d=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(r=e.RGBA,i=e.RGBA,a=e.RGBA,s=n.RGBA,o=e.RGBA,u=4,c=4,d=t!=null?t.HALF_FLOAT_OES:null,p=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:s,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:p}}function We(e,t){let n=t();return he().getBool("DEBUG")&&YYe(e),n}function YYe(e){let t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+bae(e,t))}var QYe=596e-10,eQe=65504;function vae(e){return!!(he().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||QYe<Math.abs(e)&&Math.abs(e)<eQe)}function bae(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function nb(e,t){return Ju(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function wae(e,t){let n=Ju(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(We(e,()=>e.shaderSource(n,t)),We(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function xae(e,t){let n=Ju(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(We(e,()=>e.shaderSource(n,t)),We(e,()=>e.compileShader(n)),he().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw wz(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var tQe=/ERROR: [0-9]+:([0-9]+):/g;function wz(e,t){let n=tQe.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}let r=+n[1],i=e.split(`
`),a=i.length.toString().length+2,s=i.map((d,p)=>P.rightPad((p+1).toString(),a)+d),o=0;for(let d=0;d<s.length;d++)o=Math.max(s[d].length,o);let l=s.slice(0,r-1),u=s.slice(r-1,r),c=s.slice(r);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${P.rightPad(u[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function _ae(e){return Ju(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function kae(e,t){if(We(e,()=>e.linkProgram(t)),!he().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function lk(e,t){if(We(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function Sae(e,t){let n=Ju(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return We(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),We(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function Cae(e,t){let n=Ju(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return We(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),We(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function nQe(){return he().getNumber("WEBGL_VERSION")===2?1:4}function Iae(e){return Ju(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function $ae(e,t){let n=he().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){let r=`[${e}x${t}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){let r=`[${e}x${t}]`,i=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function Tae(e){return Ju(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function YP(e,t,n,r,i,a,s){let o=e.getAttribLocation(t,n);return o===-1?!1:(We(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),We(e,()=>e.vertexAttribPointer(o,i,e.FLOAT,!1,a,s)),We(e,()=>e.enableVertexAttribArray(o)),!0)}function Nae(e,t,n){Mae(e,n),We(e,()=>e.activeTexture(e.TEXTURE0+n)),We(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function rQe(e,t){Mae(e,t),We(e,()=>e.activeTexture(e.TEXTURE0+t)),We(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function Eae(e,t,n){return Ju(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function Oae(e,t,n){return e.getUniformLocation(t,n)}function Pae(e,t,n,r){We(e,()=>Nae(e,t,r)),We(e,()=>e.uniform1i(n,r))}function iQe(e){We(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),We(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),We(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function uk(e,t,n){We(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),We(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function QP(e,t){We(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),We(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function rb(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Aae(e,t))}function Aae(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function Ju(e,t,n){let r=We(e,()=>t());if(r==null)throw new Error(n);return r}function Mae(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){let i=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${i}.`)}}function hh(e,t=2){return P.sizeFromShape(e.slice(0,e.length-t))}function fh(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function ib(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[hh(e),...fh(e)]),t}function Rae(e,t=!1){let n=he().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=he().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&he().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n=n*2,r=r*2,e=e.map((o,l)=>l>=e.length-2?P.nearestLargerEven(e[l]):e[l]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=P.squeezeShape(e).newShape);let i=P.sizeFromShape(e),a=null;e.length<=1&&i<=n?a=[1,i]:e.length===2&&e[0]<=n&&e[1]<=n?a=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?a=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?a=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?a=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(a=[e[0],e[1]*e[2]*e[3]]);let s=a!=null&&Math.max(...a)>r&&Math.min(...a)<=(t?2:1)&&Math.min(...a)>0;if(a==null||s)if(t){let o=hh(e),l=2,u=2;e.length&&([l,u]=fh(e)),i=o*(l/2)*(u/2),a=P.sizeToSquarishShape(i).map(c=>c*2)}else a=P.sizeToSquarishShape(i);return a}function v_(e){return e%2===0}function h1(e,t){if(e=e.slice(-2),t=t.slice(-2),P.arraysEqual(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){let n=e[e.length-1],r=t[t.length-1];if(n===r||v_(n)&&v_(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&v_(e[0])&&v_(t[0])}var ck,dk;function Dae(e){if(ck==null){let t=tl(e);ck=t.getParameter(t.MAX_TEXTURE_SIZE)}return ck}function aQe(){ck=null}function sQe(){dk=null}function Lae(e){if(dk==null){let t=tl(e);dk=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,dk)}function Fae(e){if(e===0)return 0;let t,n=tl(e);return Ns(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:Ns(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function Ns(e,t){return e.getExtension(t)!=null}function eA(e){try{if(tl(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function zae(e){if(e===0)return!1;let t=tl(e);if(e===1){if(!Ns(t,"OES_texture_float"))return!1}else if(!Ns(t,"EXT_color_buffer_float"))return!1;return tA(t)}function Bae(e){if(e===0)return!1;let t=tl(e);if(e===1){if(!Ns(t,"OES_texture_float")||!Ns(t,"WEBGL_color_buffer_float"))return!1}else{if(Ns(t,"EXT_color_buffer_float"))return tA(t);let n="EXT_color_buffer_half_float";if(Ns(t,n)){let r=t.getExtension(n);return oQe(t,r)}return!1}return tA(t)}function tA(e){let t=bz(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function oQe(e,t){let n=bz(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);let a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),a}function Wae(e){return e!==2?!1:tl(e).fenceSync!=null}function qv(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&P.assert(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}var pt=he();pt.registerFlag("HAS_WEBGL",()=>pt.getNumber("WEBGL_VERSION")>0);pt.registerFlag("WEBGL_VERSION",()=>eA(2)?2:eA(1)?1:0);pt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);pt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>pt.get("WEBGL_VERSION")===2);pt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);pt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);pt.registerFlag("WEBGL_PACK",()=>pt.getBool("HAS_WEBGL"));pt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_CLIP",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_REDUCE",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_LAZILY_UNPACK",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_CONV_IM2COL",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Dae(pt.getNumber("WEBGL_VERSION")));pt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Lae(pt.getNumber("WEBGL_VERSION")));pt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=pt.getNumber("WEBGL_VERSION");return e===0?0:Fae(e)});pt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>pt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!yw.isMobile());pt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>zae(pt.getNumber("WEBGL_VERSION")));pt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>pt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:pt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));pt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Bae(pt.getNumber("WEBGL_VERSION")));pt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Wae(pt.getNumber("WEBGL_VERSION")));pt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>pt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);pt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});pt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>yw.isMobile()?1:-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});pt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);pt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);pt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);pt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);pt.registerFlag("WEBGL_EXP_CONV",()=>!1);pt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>pt.getBool("IS_TEST"));pt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);pt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);pt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);pt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);function Ca(){let e,t,n,r,i,a,s,o,l,u;return he().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",a="outputColor",s="out vec4 outputColor;",o=he().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",s="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}function nm(e,t,n="index"){let r=P.computeStrides(t);return r.map((i,a)=>{let s=`int ${e[a]} = ${n} / ${i}`,o=a===r.length-1?`int ${e[a+1]} = ${n} - ${e[a]} * ${i}`:`index -= ${e[a]} * ${i}`;return`${s}; ${o};`}).join("")}function cT(e,t,n="index"){let r=P.computeStrides(t);return r.map((i,a)=>{let s=`int ${e[a]} = ${n} / outShapeStrides[${a}]`,o=a===r.length-1?`int ${e[a+1]} = ${n} - ${e[a]} * outShapeStrides[${a}]`:`index -= ${e[a]} * outShapeStrides[${a}]`;return`${s}; ${o};`}).join("")}function lQe(e,t){let n=e.length,r=e.map(a=>`${t}[${a}]`),i=new Array(n-1);i[n-2]=r[n-1];for(let a=n-3;a>=0;--a)i[a]=`(${i[a+1]} * ${r[a+1]})`;return i}function uQe(e,t,n="index"){let r=e.map((a,s)=>s),i=lQe(r,t);return i.map((a,s)=>{let o=`int ${e[s]} = ${n} / ${i[s]}`,l=s===i.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${i[s]}`:`index -= ${e[s]} * ${i[s]}`;return`${o}; ${l};`}).join("")}function xz(e){let t=P.computeStrides(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function _z(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}var Vae=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`,{getBroadcastDims:jae}=W;function cQe(e,t,n){let r=[];if(e.forEach(p=>{let h=P.sizeFromShape(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push(`uniform float ${p.name}${h>1?`[${h}]`:""};`):(r.push(`uniform sampler2D ${p.name};`),r.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){let{uniformShape:m}=kz(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${p.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${p.name}Shape;`);break}r.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{r.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});let i=r.join(`
`),a=e.map(p=>dQe(p,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),s=t.texShape,o=Ca(),l=fQe(o),u,c,d=yQe(o);return t.isPacked?(u=pQe(t.logicalShape,s,n.enableShapeUniforms),c=gQe(o)):(u=hQe(t.logicalShape,s,n.enableShapeUniforms),c=mQe(o)),n.packedInputs&&(d+=xQe),[d,l,c,i,u,a,n.userCode].join(`
`)}function Kv(e,t=!1){let n=e.shapeInfo.logicalShape;switch(n.length){case 0:return AQe(e,t);case 1:return RQe(e,t);case 2:return LQe(e,t);case 3:return zQe(e,t);case 4:return WQe(e,t);case 5:return VQe(e);case 6:return jQe(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function Uae(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return PQe(e);case 1:return MQe(e,t);case 2:return DQe(e,t);case 3:return FQe(e,t);default:return BQe(e,t)}}function dQe(e,t,n=!1,r){let i="";n?i+=Uae(e,r):i+=Kv(e,r);let a=e.shapeInfo.logicalShape,s=t.logicalShape;return a.length<=s.length&&(n?i+=UQe(e,t):i+=HQe(e,t)),i}function pQe(e,t,n){switch(e.length){case 0:return Hae();case 1:return _Qe(e,t,n);case 2:return EQe(e,t,n);case 3:return SQe(e,t,n);default:return IQe(e,t,n)}}function hQe(e,t,n){switch(e.length){case 0:return Hae();case 1:return kQe(e,t,n);case 2:return OQe(e,t,n);case 3:return CQe(e,t,n);case 4:return $Qe(e,t,n);case 5:return TQe(e,t);case 6:return NQe(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function fQe(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function mQe(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function gQe(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function yQe(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${vQe}
    ${bQe}
    ${wQe}
  `}var vQe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,bQe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,wQe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,xQe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Hae(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function _Qe(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function kQe(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function SQe(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),a=i*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function CQe(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${cT(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;let r=nm(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function IQe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),a=i*Math.ceil(e[e.length-2]/2),s=a,o="",l="b, r, c";for(let u=2;u<e.length-1;u++)s*=e[e.length-u-1],o=`
      int b${u} = index / ${s};
      index -= b${u} * ${s};
    `+o,l=`b${u}, `+l;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${o}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${e.length}(${l});
    }
  `}function $Qe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${cT(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;let r=nm(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function TQe(e,t){let n=nm(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function NQe(e,t){let n=nm(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function EQe(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(P.arraysEqual(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;let i=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function OQe(e,t,n){return P.arraysEqual(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function rm(e){return`offset${e}`}function PQe(e){let t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Ca();return`
    vec4 ${n}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function AQe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;let[i,a]=e.shapeInfo.texShape;if(i===1&&a===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;let s=rm(n);if(t)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${s});
      return sampleTexture(${n}, uv);
    }
  `;let[o,l]=e.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${s});
      return sampleTexture(${n}, uv);
    }
  `}function MQe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,a=Ca();if(t)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${n}, uv);
    }
  `;let s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${s[0]}, ${s[1]}, index);
      return ${a.texture2D}(${n}, uv);
    }
  `}function RQe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Zv(e)}
      }
    `;let i=e.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;let o=rm(n);return s===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${a}.0);
        return sampleTexture(${n}, uv);
      }
    `:a===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${s}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${a}, ${s}, index + ${o});
      return sampleTexture(${n}, uv);
    }
  `}function DQe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,s=a[0],o=a[1],l=Ca();if(a!=null&&P.arraysEqual(n,a))return t?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${s}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(t)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;let u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function LQe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape;if(a!=null&&P.arraysEqual(n,a)){if(t)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;let p=a[0],h=a[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `}let{newShape:s,keptDims:o}=P.squeezeShape(n),l=s;if(l.length<n.length){let p=Xv(e,l),h=["row","col"];return`
      ${Kv(p,t)}
      float ${i}(int row, int col) {
        return ${i}(${Jv(h,o)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Zv(e)}
      }
    `;let u=a[0],c=a[1],d=rm(r);return c===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:t?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function FQe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(n[0]===1){let p=n.slice(1),h=[1,2],m=Xv(e,p),g=["b","row","col"];return`
        ${Uae(m,t)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${Jv(g,h)});
        }
      `}let o=Ca();if(t)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `;let l=s[0],u=s[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `}function zQe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[1]*n[2],s=n[2],{newShape:o,keptDims:l}=P.squeezeShape(n),u=o;if(u.length<n.length){let g=Xv(e,u),v=["row","col","depth"];return`
        ${Kv(g,t)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${Jv(v,l)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${s}, 1)));
        ${Zv(e)}
      }
    `;let c=e.shapeInfo.texShape,d=c[0],p=c[1],h=e.shapeInfo.flatOffset;if(p===a&&h==null)return t?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${s}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(p===s&&h==null)return t?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;let m=rm(r);return t?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${m};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${s} + depth + ${m};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${r}, uv);
      }
  `}function BQe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=Ca();if(t)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);
    }
  `;let a=e.shapeInfo.logicalShape,s=a.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=l[0],c=l[1],d=Math.ceil(a[s-1]/2),p=d*Math.ceil(a[s-2]/2),h="int b, int row, int col",m=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<s-1;g++)h=`int b${g}, `+h,p*=a[s-g-1],m=`b${g} * ${p} + `+m;return`
    vec4 ${r}(${h}) {
      int index = ${m};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${i.texture2D}(${n}, uv);
    }
  `}function WQe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[3],s=n[2]*a,o=n[1]*s,{newShape:l,keptDims:u}=P.squeezeShape(n);if(l.length<n.length){let b=Xv(e,l),_=["row","col","depth","depth2"];return`
      ${Kv(b,t)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${Jv(_,u)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${s}, ${a}, 1)));
        ${Zv(e)}
      }
    `;let c=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],h=d[1],m=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,v=`int stride0 = ${r}Shape[1] * stride1;`;if(h===o&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${m}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${s}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(h===a&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;let y=rm(r);return t?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${g}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${s} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${p}, ${h}, index + ${y});
      return sampleTexture(${r}, uv);
    }
  `}function VQe(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],a=t[3]*i,s=t[2]*a,o=t[1]*s,{newShape:l,keptDims:u}=P.squeezeShape(t);if(l.length<t.length){let g=Xv(e,l),v=["row","col","depth","depth2","depth3"];return`
      ${Kv(g)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Jv(v,u)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${s}, ${a}, ${i})) +
          depth3;
        ${Zv(e)}
      }
    `;let c=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],h=d[1];if(h===o&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${s}, ${a}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===i&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;let m=rm(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${s} + depth * ${a} +
          depth2 * ${i} + depth3 + ${m};
      vec2 uv = uvFromFlat(${p}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function jQe(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:a}=P.squeezeShape(t);if(i.length<t.length){let v=Xv(e,i),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${Kv(v)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Jv(y,a)});
      }
    `}let s=t[5],o=t[4]*s,l=t[3]*o,u=t[2]*l,c=t[1]*u;if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${s}, 1)));
        ${Zv(e)}
      }
    `;let d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],m=p[1];if(m===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${o}, ${s})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(m===s&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;let g=rm(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${o} + depth3 * ${s} + depth4 + ${g};
      vec2 uv = uvFromFlat(${h}, ${m}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Zv(e){let t=e.name,n=P.sizeFromShape(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function UQe(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,o=jae(e.shapeInfo.logicalShape,t.logicalShape),l=jn(s),u=s-a,c,d=["x","y","z","w","u","v"];a===0?c="":s<2&&o.length>=1?c="coords = 0;":c=o.map(v=>`coords.${d[v+u]} = 0;`).join(`
`);let p="";s<2&&a>0?p="coords":p=e.shapeInfo.logicalShape.map((v,y)=>`coords.${d[y+u]}`).join(", ");let h="return outputValue;",m=P.sizeFromShape(e.shapeInfo.logicalShape)===1,g=P.sizeFromShape(t.logicalShape)===1;if(a===1&&!m&&!g)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!g)s===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(o.length){let v=a-2,y=a-1;o.indexOf(v)>-1&&o.indexOf(y)>-1?h="return vec4(outputValue.x);":o.indexOf(v)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(y)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${p});
      ${h}
    }
  `}function HQe(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=t.texShape,s=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&e.shapeInfo.flatOffset==null&&P.arraysEqual(s,a))return`
      float ${i}() {
        return sampleTexture(${n}, resultUV);
      }
    `;let u=jn(l),c=jae(e.shapeInfo.logicalShape,t.logicalShape),d=l-o,p,h=["x","y","z","w","u","v"];o===0?p="":l<2&&c.length>=1?p="coords = 0;":p=c.map(g=>`coords.${h[g+d]} = 0;`).join(`
`);let m="";return l<2&&o>0?m="coords":m=e.shapeInfo.logicalShape.map((g,v)=>`coords.${h[v+d]}`).join(", "),`
    float ${i}() {
      ${u} coords = getOutputCoords();
      ${p}
      return get${r}(${m});
    }
  `}function jn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function kz(e,t,n){let{newShape:r,keptDims:i}=P.squeezeShape(t),a=t.length,s=e&&a===3&&t[0]===1,o=s?t.slice(1):r,l=!e&&a>1&&!P.arraysEqual(t,n)&&r.length<a||s;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:i}}function Xv(e,t){let n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Jv(e,t){return t.map(n=>e[n]).join(", ")}function GQe(e,t,n,r){let i=n.map((c,d)=>{let p={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(p.flatOffset=c.texData.slice.flatOffset),{name:t.variableNames[d],shapeInfo:p}}),a=i.map(c=>c.shapeInfo),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=cQe(i,s,t),l=xae(e.gl,o),u=e.createProgram(l);return he().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:a,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(u),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:a,outShapeInfo:s},Gae(e,t,u)))}function Gae(e,t,n){let r=[],i=[],a,s,o,l=null,u=null;u=e.getUniformLocation(n,"NAN",!1),he().getNumber("WEBGL_VERSION")===1&&(l=e.getUniformLocation(n,"INFINITY",!1));let c=!1;for(let d of t.variableNames){let p={name:d,uniform:e.getUniformLocation(n,d,c),offset:e.getUniformLocation(n,`offset${d}`,c)};t.enableShapeUniforms&&(p.shape=e.getUniformLocation(n,`${d}Shape`,c),p.texShape=e.getUniformLocation(n,`${d}TexShape`,c)),r.push(p)}if(t.enableShapeUniforms&&(a=e.getUniformLocation(n,"outShape",c),o=e.getUniformLocation(n,"outShapeStrides",c),s=e.getUniformLocation(n,"outTexShape",c)),t.customUniforms)for(let d of t.customUniforms)i.push(e.getUniformLocation(n,d.name,c));return{variablesLocations:r,customUniformLocations:i,infLoc:l,nanLoc:u,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:s}}function nH(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,r)=>{let i=n.logicalShape,a=t[r],s=a.shape;if(!P.arraysEqual(i,s))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${s} must match`);if(n.isUniform&&a.isUniform)return;let o=n.texShape,l=a.isUniform?null:a.texData.texShape;if(!P.arraysEqual(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function qQe(e,t,n,r,i){t.program.enableShapeUniforms||(nH(t.inShapeInfos,n),nH([t.outShapeInfo],[r]));let a=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(a.texture,s[0],s[1]):e.setOutputMatrixTexture(a.texture,s[0],s[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),he().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){let u=n[l],{uniform:c,offset:d,shape:p,texShape:h}=t.variablesLocations[l];if(p){let{uniformShape:m}=kz(t.program.packedInputs,u.shape,u.texData.texShape);switch(m.length){case 1:e.gl.uniform1iv(p,new Int32Array(m));break;case 2:e.gl.uniform2iv(p,new Int32Array(m));break;case 3:e.gl.uniform3iv(p,new Int32Array(m));break;case 4:e.gl.uniform4iv(p,new Int32Array(m));break}}if(h&&e.gl.uniform2i(h,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(P.sizeFromShape(u.shape)<2)e.gl.uniform1f(c,u.uniformValues[0]);else{let m=u.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),e.gl.uniform1fv(c,m)}continue}u.texData.slice!=null&&d!=null&&e.gl.uniform1i(d,u.texData.slice.flatOffset),e.setInputMatrixTexture(u.texData.texture.texture,c,l)}}let o=t.outShapeLocation;if(o)switch(r.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(r.shape));break}if(t.outShapeStridesLocation){let l=P.computeStrides(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let l=0;l<t.program.customUniforms.length;++l){let u=t.program.customUniforms[l],c=t.customUniformLocations[l],d=i[l];if(u.type==="float")e.gl.uniform1fv(c,d);else if(u.type==="vec2")e.gl.uniform2fv(c,d);else if(u.type==="vec3")e.gl.uniform3fv(c,d);else if(u.type==="vec4")e.gl.uniform4fv(c,d);else if(u.type==="int")e.gl.uniform1iv(c,d);else if(u.type==="ivec2")e.gl.uniform2iv(c,d);else if(u.type==="ivec3")e.gl.uniform3iv(c,d);else if(u.type==="ivec4")e.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}e.executeProgram()}function KQe(e,t,n){let r="";t.concat(n).forEach(s=>{let o=s.texData!=null&&s.texData.slice!=null&&s.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!s.isUniform){let l=s.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=kz(e.packedInputs,s.shape,l),p="",h="",m="";if(c.length===1&&e.packedInputs){let C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${C[0]>1}_${C[1]>1}`}else if(c.length===2&&!e.packedInputs)h=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!e.packedInputs){let C=P.computeStrides(c);m=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}let g=s.shape.length,v=c.length===2&&P.arraysEqual(s.shape,l),y=P.sizeFromShape(s.shape)===1,b=W.getBroadcastDims(s.shape,n.shape),_=!e.packedInputs&&g===n.shape.length&&P.arraysEqual(l,n.texData.texShape),k=e.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${g}_${_}_${u?d:""}_${c.length}_${y}_${b}_${v}_${p}_${h}_${m}_${k}_${o}`}else{let l=s.isUniform?"uniform":s.texData.texShape;r+=`${s.shape}_${l}_${o}`}});let i=e.userCode,a=e.constructor.name;return a+="_"+r+"_"+i+`${he().getNumber("WEBGL_VERSION")}`,a}function na(e){return he().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var ZQe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=p1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=Ca();this.outputShape=e,this.enableShapeUniforms=na(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?cT(["r","c","d"],e):nm(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}},XQe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=p1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=Ca();this.outputShape=e,this.enableShapeUniforms=na(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?cT(["r","c","d"],e):nm(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}},JQe=class{constructor(e){this.variableNames=["A"],this.outTexUsage=Ts.DOWNLOAD;let t=Ca();this.outputShape=e,this.userCode=`
      ${Vae}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}},YQe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ts.DOWNLOAD;let t=Ca();this.outputShape=e,this.userCode=`
      ${Vae}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}},QQe={R:0,G:1,B:2,A:3},rH=class{constructor(e,t=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let r=Ca();this.outputShape=e,this.enableShapeUniforms=na(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)");let a="";for(let s=0;s<n.length;s++){let o=n[s];a+=`
          if(offset == ${s}) {
            result = values[${QQe[o]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?_z():xz(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${n.length});

        flatIndex = idiv(flatIndex, ${n.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${a}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}},eet=class{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=Ca();this.outputShape=e,this.enableShapeUniforms=na(this.outputShape.length);let r="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let s=0;s<=1;s++){let o=a*2+s;r+=`
          localCoords = coords;
          if(localCoords[2] + ${s} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${s};
          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${a};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${n.texture2D}(A, uv);

            if (offset == 0) {
              result[${o}] = values[0];
            } else if (offset == 1) {
              result[${o}] = values[1];
            } else if (offset == 2) {
              result[${o}] = values[2];
            } else {
              result[${o}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?_z():xz(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${n.output} = ${i};
        }
    `}},qae={};Dt(qae,{bindVertexProgramAttributeStreams:()=>nse,createBufferFromOutputTexture:()=>ase,createFloat16MatrixTexture:()=>Yae,createFloat16PackedMatrixTexture:()=>tse,createFloat32MatrixTexture:()=>Jae,createIndexBuffer:()=>Xae,createPackedMatrixTexture:()=>ese,createUnsignedBytesMatrixTexture:()=>Qae,createVertexBuffer:()=>Zae,createVertexShader:()=>Kae,downloadByteEncodedFloatMatrixFromOutputTexture:()=>ose,downloadFloat32MatrixFromBuffer:()=>sse,downloadMatrixFromPackedOutputTexture:()=>use,downloadPackedMatrixFromBuffer:()=>lse,getInternalFormatForFloat16MatrixTexture:()=>Cz,getInternalFormatForFloat16PackedMatrixTexture:()=>Tz,getInternalFormatForFloat32MatrixTexture:()=>Sz,getInternalFormatForPackedMatrixTexture:()=>$z,getInternalFormatForUnsignedBytesMatrixTexture:()=>Iz,uploadDenseMatrixToTexture:()=>rse,uploadPixelDataToTexture:()=>ise});function Kae(e){let t=Ca(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return wae(e,n)}function Zae(e){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Sae(e,t)}function Xae(e){let t=new Uint16Array([0,1,2,2,1,3]);return Cae(e,t)}function Uw(e,t,n,r,i,a){$ae(t,n);let s=Iae(e),o=e.TEXTURE_2D;return We(e,()=>e.bindTexture(o,s)),We(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),We(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),We(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),We(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),he().getNumber("WEBGL_VERSION")===1?We(e,()=>e.texImage2D(o,0,r,t,n,0,i,a,null)):We(e,()=>e.texStorage2D(o,1,r,t,n)),We(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:s,texShape:[n,t]}}function Sz(e){return e.internalFormatFloat}function Jae(e,t,n,r){let[i,a]=jw(t,n);return Uw(e,i,a,Sz(r),r.textureFormatFloat,e.FLOAT)}function Cz(e){return e.internalFormatHalfFloat}function Yae(e,t,n,r){let[i,a]=jw(t,n);return Uw(e,i,a,Cz(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function Iz(e){return e.downloadTextureFormat}function Qae(e,t,n,r){let[i,a]=jw(t,n);return Uw(e,i,a,Iz(r),e.RGBA,e.UNSIGNED_BYTE)}function $z(e){return e.internalFormatPackedFloat}function ese(e,t,n,r){let[i,a]=Gv(t,n);return Uw(e,i,a,$z(r),e.RGBA,e.FLOAT)}function Tz(e){return e.internalFormatPackedHalfFloat}function tse(e,t,n,r){let[i,a]=Gv(t,n);return Uw(e,i,a,Tz(r),e.RGBA,r.textureTypeHalfFloat)}function nse(e,t,n){return We(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),YP(e,t,"clipSpacePos",n,3,20,0)&&YP(e,t,"uv",n,2,20,12)}function rse(e,t,n,r,i,a){We(e,()=>e.bindTexture(e.TEXTURE_2D,t));let s,o,l;i instanceof Uint8Array?(s=new Uint8Array(n*r*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(n*r*4),o=e.FLOAT,l=a.internalFormatPackedFloat),s.set(i),he().getNumber("WEBGL_VERSION")===2?We(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,o,s)):We(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,o,s)),We(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function ise(e,t,n){We(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?he().getNumber("WEBGL_VERSION")===2?We(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):We(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):he().getNumber("WEBGL_VERSION")===2?We(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):We(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),We(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function ase(e,t,n,r){let i=e.createBuffer();We(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i));let a=4*4*t*n;return We(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)),We(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),We(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),i}function sse(e,t,n){let r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function ose(e,t,n,r){let[i,a]=jw(t,n),s=4,o=new Uint8Array(XYe(t*n,s));return We(e,()=>e.readPixels(0,0,i,a,r.downloadTextureFormat,e.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function lse(e,t,n,r,i,a,s,o){let l=e,u=new Float32Array(JYe(a,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function use(e,t,n){let r=new Float32Array(t*n*4);return We(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}var pk=class{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=he().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,yae(t,e)):this.gl=tl(t),e=this.gl,he().getNumber("WEBGL_VERSION")===2){let i=e;this.createVertexArray=()=>We(i,()=>i.createVertexArray()),this.bindVertexArray=a=>We(i,()=>i.bindVertexArray(a)),this.deleteVertexArray=a=>We(i,()=>i.deleteVertexArray(a)),this.getVertexArray=()=>We(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){let i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>We(e,()=>i.createVertexArrayOES()),this.bindVertexArray=a=>We(e,()=>i.bindVertexArrayOES(a)),this.deleteVertexArray=a=>We(e,()=>i.deleteVertexArrayOES(a)),this.getVertexArray=()=>We(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float",r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),he().getNumber("WEBGL_VERSION")===1){let i="OES_texture_float",a="OES_texture_half_float";if(this.textureFloatExtension=nb(this.gl,i),Ns(this.gl,a))this.textureHalfFloatExtension=nb(this.gl,a);else if(he().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Ns(this.gl,r))this.colorBufferHalfFloatExtension=nb(this.gl,r);else if(he().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Ns(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(Ns(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Zae(this.gl),this.indexBuffer=Xae(this.gl),this.framebuffer=Tae(this.gl),this.textureConfig=bz(this.gl,this.textureHalfFloatExtension)}get debug(){return he().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;We(e,()=>e.finish()),We(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),We(e,()=>e.deleteFramebuffer(this.framebuffer)),We(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),We(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),We(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),Jae(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),Yae(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),Qae(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),ise(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),rse(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),tse(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),ese(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(QP(this.gl,this.framebuffer),this.outputTexture=null),We(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>ose(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,r,i,a){return lse(this.gl,e,t,n,r,i,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return sse(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let r=ase(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(he().getBool("WEBGL_FENCE_API_ENABLED")){let r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let a=r.clientWaitSync(i,0,0);return a===r.ALREADY_SIGNALED||a===r.CONDITION_SATISFIED},t=i}else he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>use(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl;this.vertexShader==null&&(this.vertexShader=Kae(t));let n=_ae(t);We(t,()=>t.attachShader(n,this.vertexShader)),We(t,()=>t.attachShader(n,e)),kae(t,n);let r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&lk(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;We(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),nse(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(We(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&lk(this.gl,this.program),We(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?Eae(this.gl,e,t):Oae(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),We(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Pae(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[r,i]=Gv(t,n);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&lk(this.gl,this.program),rb(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;if(this.debug){let t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}We(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),We(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=nb(this.gl,he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.createQuery();return n.beginQuery(r.TIME_ELAPSED_EXT,i),i}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT);return}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await P.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){let n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}else{let n=this.getQueryTimerExtensionWebGL1();return n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{let n=this.getQueryTimerExtensionWebGL1(),r=n.getQueryObjectEXT(e,n.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=tet(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:n}=this.itemsToPoll[t];n()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in he().platform&&(n=he().platform.setTimeoutCustom.bind(he().platform)),P.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),uk(this.gl,e,this.framebuffer),this.debug&&rb(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(uk(this.gl,this.outputTexture,this.framebuffer),this.debug&&rb(this.gl)):QP(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let r=this.gl;uk(r,e,this.framebuffer),this.debug&&rb(r),this.outputTexture=e,We(r,()=>r.viewport(0,0,t,n)),We(r,()=>r.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),We(this.gl,()=>this.gl.scissor(e,t,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}};function tet(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var{addImpl:net,bincountImpl:cse,bincountReduceImpl:ret,bitwiseAndImpl:iet,castImpl:aet,ceilImpl:set,concatImpl:oet,equalImpl:uet,expImpl:cet,expm1Impl:det,floorImpl:pet,gatherNdImpl:het,gatherV2Impl:fet,greaterImpl:met,greaterEqualImpl:get,lessImpl:yet,lessEqualImpl:vet,linSpaceImpl:bet,logImpl:wet,maxImpl:xet,maximumImpl:_et,minimumImpl:ket,multiplyImpl:Cet,negImpl:Iet,notEqualImpl:$et,prodImpl:Tet,raggedGatherImpl:Net,raggedRangeImpl:Eet,raggedTensorToTensorImpl:Oet,rangeImpl:Pet,rsqrtImpl:Aet,scatterImpl:Met,sigmoidImpl:Ret,simpleAbsImpl:dse,sliceImpl:Det,sparseFillEmptyRowsImpl:Let,sparseReshapeImpl:Fet,sparseSegmentReductionImpl:pse,sqrtImpl:zet,staticRegexReplaceImpl:Bet,stridedSliceImpl:Wet,stringNGramsImpl:Vet,stringSplitImpl:jet,stringToHashBucketFastImpl:Uet,subImpl:Het,tileImpl:Get,topKImpl:qet,transposeImpl:Nz,uniqueImpl:Ket}=rz;function hse(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function ha(e,t){return t===1?[e]:hse(e,t)}function Zet(e,t){if(e===1)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}var Xet=class{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=na(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let t=ha("rc",this.rank),n=jn(this.rank),r=this.getOutOfBoundsCondition(t),i=this.getSetup(t),a=this.getOutput(t);this.userCode=`
        void main() {
          ${n} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${a}));
          }
        }
      `}}getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let i=`${n===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let a=2;a<this.rank;a++)i=`${e[e.length-1-a]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";let t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${n};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){let t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}},fse=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=na(this.outputShape.length);let n="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Jet(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?_z():xz(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${n}

        setOutput(result);
      }
    `}};function Jet(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?uQe(["r","c","d"],"inputShape"):nm(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}var Yet=class{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){let r=aH(t,n),i=sH(e,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);let a=iH(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();let o=this.freeTextures[i].pop();return this.usedTextures[i].push(o),o}let s;return r===$i.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===$i.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===$i.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===$i.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===$i.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(s),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),s}releaseTexture(e,t,n,r){if(this.freeTextures==null)return;let i=aH(n,r),a=sH(t,i,r);a in this.freeTextures||(this.freeTextures[a]=[]);let s=iH(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),o=he().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");o!==-1&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=s):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;let l=this.usedTextures[a],u=l&&l.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[u]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);let t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(let e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function Qet(e,t){let n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F||t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function iH(e,t,n,r,i){let a=ett(t,r),s;if(i){let[l,u]=Gv(e[0],e[1]);s=l*u}else{let[l,u]=jw(e[0],e[1]);s=l*u}let o=Qet(n,a);return s*o}function ett(e,t){switch(e){case $i.PACKED_2X2_FLOAT32:return $z(t);case $i.PACKED_2X2_FLOAT16:return Tz(t);case $i.UNPACKED_FLOAT32:return Sz(t);case $i.UNPACKED_FLOAT16:return Cz(t);case $i.PACKED_4X1_UNSIGNED_BYTE:return Iz(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function ttt(e){return he().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?$i.PACKED_2X2_FLOAT32:$i.UNPACKED_FLOAT32:e?$i.PACKED_2X2_FLOAT16:$i.UNPACKED_FLOAT16}function aH(e,t){if(e===Ts.UPLOAD)return $i.PACKED_2X2_FLOAT32;if(e===Ts.RENDER||e==null)return ttt(t);if(e===Ts.DOWNLOAD||e===Ts.PIXELS)return $i.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function sH(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}var Ol=class{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=na(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}},bo="if (isnan(x)) return x;",ntt="return x;",oH="return abs(x);",rtt="return (x >= 0.0) ? x : (exp(x) - 1.0);",itt=bo+`
  return (x < 0.0) ? 0.0 : x;
`,att=bo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,xc="return x;",stt="return 1.0 / (1.0 + exp(-1.0 * x));",ott="return x;",ltt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,utt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ctt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dtt="return 1.0 / (1.0 + exp(-1.0 * x));",Mc=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=na(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}},ptt=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=na(this.outputShape.length);let t=e.length,n=ha("rc",t),r=jn(t),i=Zet(t,n),a=n.slice(-2),s=t<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${s}));
      }
    `}},htt=Jl.whereImpl,ftt=1e-7,mtt=1e-4,dE={};function gtt(e){return e in dE||(dE[e]={}),dE[e]}var ytt=he().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),vtt=600;function btt(){return he().global.screen==null?1024:he().global.screen.height*he().global.screen.width*window.devicePixelRatio*vtt/1024/1024}var Ez=class mse extends H1{nextDataId(){return mse.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!he().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(t!=null){if(t instanceof pk)n=t;else{let r=tl(he().getNumber("WEBGL_VERSION"),t);n=new pk(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let r=tl(he().getNumber("WEBGL_VERSION"));n=new pk(r),this.binaryCache=gtt(he().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Yet(this.gpgpu),this.numMBBeforeWarning=btt(),this.texData=new j2(this,Ys())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,n,r,i,a,s){let o=this.makeTensorInfo(n,r),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:t,texShape:[i,a]},l.texShape=[i,a];let u=ib(n),c=new rH(u,!1,s),d=this.runWebGLProgram(c,[o],r,[[i,a]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(o),d.dataId}write(t,n,r){if((he().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||he().getBool("DEBUG"))&&this.checkNumericalProblems(t),r==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let i={id:this.nextDataId()};return this.texData.set(i,{shape:n,dtype:r,values:t,usage:Ts.UPLOAD,refCount:1}),i}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){let n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){let n=this.texData.get(t);n.refCount--}}move(t,n,r,i,a){if(he().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:r,dtype:i,values:n,usage:Ts.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){let n=this.texData.get(t),{values:r,dtype:i,complexTensorInfos:a,slice:s,shape:o,isPacked:l}=n;if(s!=null){let p;l?p=new Mc(o,xc):p=new Ol(o,xc);let h=this.runWebGLProgram(p,[{dataId:t,shape:o,dtype:i}],i),m=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),m}if(r!=null)return this.convertAndCacheOnCPU(t);if(i==="string")return r;let u=this.activeTimers!=null,c;u&&(c=P.now());let d;if(i==="complex64"){let p=this.readSync(a.real.dataId),h=this.readSync(a.imag.dataId);d=W.mergeRealAndImagArrays(p,h)}else d=this.getValuesFromTexture(t);return u&&(this.downloadWaitMs+=P.now()-c),this.convertAndCacheOnCPU(t,d)}async read(t){if(this.pendingRead.has(t)){let m=this.pendingRead.get(t);return new Promise(g=>m.push(g))}let n=this.texData.get(t),{values:r,shape:i,slice:a,dtype:s,complexTensorInfos:o,isPacked:l}=n;if(a!=null){let m;l?m=new Mc(i,xc):m=new Ol(i,xc);let g=this.runWebGLProgram(m,[{dataId:t,shape:i,dtype:s}],s),v=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),v}if(r!=null)return this.convertAndCacheOnCPU(t);if(he().getBool("DEBUG")&&!he().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&he().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(s!=="complex64"&&he().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(t);let m=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(m.texture.texture,...y_(i))}this.pendingRead.set(t,[]),s!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(s==="complex64"){let m=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),g=m[0],v=m[1];d=W.mergeRealAndImagArrays(g,v)}else if(u==null)d=this.getValuesFromTexture(t);else{let m=P.sizeFromShape(i);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,m)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){let m=this.gpgpu.gl;We(m,()=>m.deleteBuffer(u))}let p=this.convertAndCacheOnCPU(t,d),h=this.pendingRead.get(t);return this.pendingRead.delete(t),h.forEach(m=>m(p)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Ys().removeDataId(t,this),this.pendingDeletes--),p}readToGPU(t,n={}){let r=this.texData.get(t),{values:i,shape:a,slice:s,dtype:o,isPacked:l,texture:u}=r;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(s!=null){let h;l?h=new Mc(a,xc):h=new Ol(a,xc);let m=this.runWebGLProgram(h,[{dataId:t,shape:a,dtype:o}],o),g=this.readToGPU(m,n);return this.disposeIntermediateTensorInfo(m),g}if(u==null)throw i!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let c=this.decode(t,n.customTexShape),d=Ys().makeTensorFromTensorInfo(c),p=this.texData.get(c.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(t){let n=this.readSync(t.dataId);if(t.dtype==="string")try{let r=n.map(i=>P.decodeString(i));return Gt(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Gt(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){let r=t[n];if(!vae(r))throw he().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(t){let{shape:n,dtype:r,isPacked:i}=this.texData.get(t),a=P.sizeFromShape(n);if(he().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let p=this.decode(t),h=this.texData.get(p.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...y_(n)).subarray(0,a);return this.disposeIntermediateTensorInfo(p),m}let s=he().getBool("WEBGL_PACK")&&i===!0,o=s?ib(n):n,l=s?new YQe(o):new JQe(o),u=this.runWebGLProgram(l,[{shape:o,dtype:r,dataId:t}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){let n=this.activeTimers,r=[],i=!1;this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,t();let a=P.flatten(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),s=P.flatten(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,i&&(this.programTimersStack=null);let o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let l=await Promise.all(a);o.kernelMs=P.sum(l),o.getExtraProfileInfo=()=>l.map((u,c)=>({name:s[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:P.now(),endMs:null}}endTimer(t){return he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=P.now(),t)}async getQueryTime(t){if(he().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);let n=t;return n.endMs-n.startMs}disposeData(t,n=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(n?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!n&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);let{complexTensorInfos:r}=this.texData.get(t);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(t),!0}releaseGPUData(t){let{texture:n,dtype:r,texShape:i,usage:a,isPacked:s,slice:o}=this.texData.get(t),l=o&&o.origDataId||t,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,a,s)));let c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,n=ytt){return he().getBool("WEBGL_CPU_FORWARD")&&t.every(r=>this.texData.get(r.dataId).texture==null&&P.sizeFromShape(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){W.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let n=t.dataSync();return htt(t.shape,n)}packedUnaryOp(t,n,r){let i=new Mc(t.shape,n),a=this.compileAndRun(i,[t],r);return Ys().makeTensorFromTensorInfo(a)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){let i=dse(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,i)}if(he().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,oH,t.dtype);let n=new Ol(t.shape,oH),r=this.compileAndRun(n,[t]);return Ys().makeTensorFromTensorInfo(r)}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&P.isString(r[0])){let a=r.map(s=>P.encodeString(s));i=this.write(a,t,n)}else i=this.write(r,t,n);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:n}}makeOutput(t,n,r){return Ys().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,r),this)}unpackTensor(t){let n=new ptt(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){let n=new Xet(t.shape);return this.runWebGLProgram(n,[t],t.dtype,null,!0)}packedReshape(t,n){let r=[hh(t.shape),...fh(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},a=[hh(n),...fh(n)],s=new fse(a,r),o=!0,l=[r],u=this.runWebGLProgram(s,[i],t.dtype,l,o);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(t,n){let r=this.texData.get(t),{isPacked:i,shape:a,dtype:s}=r;if(n!=null){let p=P.sizeFromShape(a),h=n[0]*n[1]*4;P.assert(p<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let o=ib(a),l;i?l=new XQe(o):l=new ZQe(o);let u=!0,c=[n!=null?n:y_(o)],d=this.runWebGLProgram(l,[{shape:o,dtype:s,dataId:t}],s,c,u,n);return{dtype:s,shape:a,dataId:d.dataId}}runWebGLProgram(t,n,r,i,a=!1,s){let o=this.makeTensorInfo(t.outputShape,r),l=this.texData.get(o.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===p1.DENSE){let y=s!=null?s:y_(t.outputShape);l.texShape=y.map(b=>b*2)}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),P.sizeFromShape(o.shape)===0)return l.values=P.getTypedArrayFromDType(o.dtype,0),o;let u=[],c=n.map(y=>{if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let b=this.texData.get(y.dataId);if(b.texture==null){if(!t.packedInputs&&P.sizeFromShape(y.shape)<=he().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:b.values};t.packedInputs&&(b.isPacked=!0,b.shape=y.shape)}if(this.uploadToGPU(y.dataId),!!b.isPacked!=!!t.packedInputs)y=b.isPacked?this.unpackTensor(y):this.packTensor(y),u.push(y),b=this.texData.get(y.dataId);else if(b.isPacked&&!h1(b.shape,y.shape)){let _=y,k=y.shape;y.shape=b.shape,y=this.packedReshape(y,k),u.push(y),b=this.texData.get(y.dataId),_.shape=k}return{shape:y.shape,texData:b,isUniform:!1}});this.uploadToGPU(o.dataId);let d={shape:o.shape,texData:l,isUniform:!1},p=KQe(t,c,d),h=this.getAndSaveBinary(p,()=>GQe(this.gpgpu,t,c,d)),m=this.activeTimers!=null,g;m&&(g=this.startTimer()),he().get("ENGINE_COMPILE_ONLY")||qQe(this.gpgpu,h,c,d,i),u.forEach(y=>this.disposeIntermediateTensorInfo(y)),m&&(g=this.endTimer(g),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(g)}));let v=he().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){let y=P.now();y-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!he().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){let y=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),y}return o}compileAndRun(t,n,r,i,a=!1){return r=r||n[0].dtype,this.runWebGLProgram(t,n,r,i,a)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(he().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=le(()=>{if(!he().get("WEBGL_RENDER_FLOAT32_ENABLED")){let t=he().getBool("DEBUG");he().set("DEBUG",!1);let n=this.abs(yt(1e-8)).dataSync()[0];if(he().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?ftt:mtt}uploadToGPU(t){let n=this.texData.get(t),{shape:r,dtype:i,values:a,texture:s,usage:o,isPacked:l}=n;if(s!=null)return;let u=this.activeTimers!=null,c;u&&(c=P.now());let d=n.texShape;if(d==null&&(d=Rae(r,l),n.texShape=d),a!=null){let p=ib(r),h,m=d[1],g=d[0],v=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(l||!v)&&([m,g]=Gv(d[0],d[1])),l?h=new eet(p,v):h=new rH(p,v);let y=v?[g,m]:d,b=this.makeTensorInfo(y,i),_=this.texData.get(b.dataId);v?_.usage=Ts.PIXELS:_.usage=Ts.UPLOAD,_.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),m,g,a);let k=[[g,m]],C=this.runWebGLProgram(h,[b],i,k,!0),$=this.texData.get(C.dataId);n.texShape=$.texShape,n.isPacked=$.isPacked,n.usage=$.usage,he().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(n.texture=$.texture,n.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(b),u&&(this.uploadWaitMs+=P.now()-c)}else{let p=this.acquireTexture(d,o,i,l);n.texture=p}}convertAndCacheOnCPU(t,n){let r=this.texData.get(t),{dtype:i}=r;return n!=null&&(r.values=wtt(n,i)),r.values}acquireTexture(t,n,r,i){if(this.numBytesInGPU+=this.computeBytes(t,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,i)}computeBytes(t,n){return t[0]*t[1]*P.bytesPerElement(n)}checkCompileCompletion(){for(let[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){let t=[];if(this.gpgpu.parallelCompilationExtension){for(let[,n]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(n));return Promise.all(t)}else{for(let[,n]of Object.entries(this.binaryCache)){let r=new Promise(i=>{try{this.checkCompletion_(n),i(!0)}catch(a){throw a}});t.push(r)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await bL(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(wz(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);let{variablesLocations:n,customUniformLocations:r,infLoc:i,nanLoc:a,outShapeLocation:s,outShapeStridesLocation:o,outTexShapeLocation:l}=Gae(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=n,t.customUniformLocations=r,t.infLoc=i,t.nanLoc=a,t.outShapeLocation=s,t.outShapeStridesLocation=o,t.outTexShapeLocation=l}}createTensorFromGPUData(t,n,r){t.channels=t.channels||"RGBA";let{texture:i,height:a,width:s,channels:o}=t,l=Ys().backend;if(!l.gpgpu.gl.isTexture(i))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let u=l.writeTexture(i,n,r,a,s,o);return Ys().makeTensorFromDataId(u,n,r,l)}};Ez.nextDataId=0;function wtt(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){let n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}else throw new Error(`Unknown dtype ${t}`)}var xtt="4.16.0";function gse(){he().set("WEBGL_FORCE_F16_TEXTURES",!0)}yw.isBrowser()&&o$("webgl",()=>new Ez,2);var _tt={forceHalfFloat:gse},Oz=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,mh=class{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=W.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=na(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}},im=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`,Yv=class{constructor(e,t,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=W.assertAndGetBroadcastShape(t,n);let i=this.outputShape.length;this.enableShapeUniforms=na(i);let a="";if(r)if(i===0||P.sizeFromShape(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${jn(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let s=ha("coords",i);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${s[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${s[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${s[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${s[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}};function vs(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var ktt={kernelName:sf,backendName:"webgl",kernelFunc:vs};function zd(e){let{inputs:t,backend:n}=e,{real:r,imag:i}=t,a=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(a.dataId),o=vs({inputs:{x:r},backend:n}),l=vs({inputs:{x:i},backend:n});return s.complexTensorInfos={real:o,imag:l},a}var Stt={kernelName:G2,backendName:"webgl",kernelFunc:zd},yse="return (a < 0.) ? b * a : a;",vse=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Ctt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:a}=r,s=n.makeTensorInfo([],"float32",P.createScalarValue(a,"float32")),o=he().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yv(vse,i.shape,s.shape):new mh(yse,i.shape,s.shape),l=n.runWebGLProgram(o,[i,s],"float32");return n.disposeIntermediateTensorInfo(s),l}var Itt={kernelName:cf,backendName:"webgl",kernelFunc:Ctt},bse="return (a < 0.) ? b * a : a;",wse=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function $tt(e){let{inputs:t,backend:n}=e,{x:r,alpha:i}=t,a=he().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yv(wse,r.shape,i.shape):new mh(bse,r.shape,i.shape);return n.runWebGLProgram(a,[r,i],"float32")}var Ttt={kernelName:If,backendName:"webgl",kernelFunc:$tt},Qv="if (isnan(x)) return x;";function un({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:a})=>{let{x:s}=i,o=a,l=r||s.dtype;if(o.shouldExecuteOnCPU([s])&&n!=null){let d=o.texData.get(s.dataId),p=n(d.values,l);return o.makeTensorInfo(s.shape,l,p)}let u=he().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null,c;return u?c=new Mc(s.shape,t):c=new Ol(s.shape,e),o.runWebGLProgram(c,[s],l)}}function Di({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:a}){return({inputs:s,backend:o})=>{let{a:l,b:u}=s,c=o;if(r&&l.dtype==="complex64"){let m=c.texData.get(l.dataId),g=c.texData.get(u.dataId),[v,y]=[[m.complexTensorInfos.real,g.complexTensorInfos.real],[m.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(_=>{let[k,C]=_,$={dataId:k.dataId,dtype:k.dtype,shape:l.shape},N={dataId:C.dataId,dtype:C.dtype,shape:u.shape},A=new mh(e,l.shape,u.shape);return c.runWebGLProgram(A,[$,N],Ls(k.dtype,C.dtype))}),b=zd({inputs:{real:v,imag:y},backend:c});return c.disposeIntermediateTensorInfo(v),c.disposeIntermediateTensorInfo(y),b}let d=a||Ls(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&i!=null){let m=c.texData.get(l.dataId).values,g=c.texData.get(u.dataId).values,v=l.dtype==="string"?W.fromUint8ToStringArray(m):m,y=l.dtype==="string"?W.fromUint8ToStringArray(g):g,[b,_]=i(l.shape,u.shape,v,y,d),k=c.makeTensorInfo(_,d),C=c.texData.get(k.dataId);return C.values=b,k}let p=he().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null,h;return p?h=new Yv(t,l.shape,u.shape,n):h=new mh(e,l.shape,u.shape),c.runWebGLProgram(h,[l,u],d)}}function f1(e,t=!1){if(e==="linear")return t?ott:ntt;if(e==="relu")return t?utt:itt;if(e==="elu")return t?ltt:rtt;if(e==="relu6")return t?ctt:att;if(e==="prelu")return t?wse:bse;if(e==="leakyrelu")return t?vse:yse;if(e==="sigmoid")return t?dtt:stt;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}var xse=class{constructor(e,t,n,r=!1,i=!1,a=!1,s=null,o=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=na(this.outputShape.length);let u=r?e[1]:e[2],c=Math.ceil(u/2),d=r?"i * 2, rc.y":"rc.y, i * 2",p=i?"rc.z, i * 2":"i * 2, rc.z",h=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",v="";s&&(o?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:l?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:g=`vec4 activation(vec4 x) {
          ${s}
        }`,v="result = activation(result);");let y=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let b="rc.x",_="rc.x";e[0]<t[0]?b=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(_=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${c}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${_};
        for (int i = 0; i < ${c}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${h[0]} * ${m[0]});
          result += (${h[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${v}

        setOutput(result);
      }
    `}},lH={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},uH=class{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=W.assertAndGetBroadcastShape(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}},cH="return a * b;";function Pz(e){let{inputs:t,backend:n}=e,{a:r,b:i}=t,a=W.upcastType(r.dtype,i.dtype);if(r.dtype==="complex64"){let o=n.texData.get(r.dataId),l=n.texData.get(i.dataId),u=new uH(lH.REAL,r.shape,i.shape),c=new uH(lH.IMAG,r.shape,i.shape),d=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],p=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),m=zd({inputs:{real:p,imag:h},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),m}if(n.shouldExecuteOnCPU([r,i])){let o=n.texData.get(r.dataId),l=n.texData.get(i.dataId),[u,c]=Cet(r.shape,i.shape,o.values,l.values,a),d=n.makeTensorInfo(c,a),p=n.texData.get(d.dataId);return p.values=u,d}let s;return he().getBool("WEBGL_PACK_BINARY_OPERATIONS")?s=new Yv(cH,r.shape,i.shape):s=new mh(cH,r.shape,i.shape),n.runWebGLProgram(s,[r,i],a)}var Ntt={kernelName:_f,backendName:"webgl",kernelFunc:Pz};function Ett(e,t,n){let r=[hh(e.shape),...fh(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},a=[hh(t),...fh(t)],s=new fse(a,r),o=!0,l=[r],u=n.runWebGLProgram(s,[i],e.dtype,l,o);return{dataId:u.dataId,shape:t,dtype:u.dtype}}function Be(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:a}=r,s=n,o=P.sizeFromShape(i.shape),l=P.inferFromImplicitShape(a,o),u=P.sizeFromShape(l);P.assert(o===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);let c=s.texData.get(i.dataId);return c.isPacked&&!h1(i.shape,l)&&!(c.texture!==null&&h1(c.shape,l))?Ett(i,l,s):(s.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype})}var Ott={kernelName:yv,backendName:"webgl",kernelFunc:Be},dH=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:i,outSize:a}=e;this.outputShape=[r,a];let s=Math.floor(n/4)*4,o=n%4,l="sumValue += dot(values, ones);";if(t!=null){let c=1/t;l=`sumValue += dot(values * ${P.isInt(c)?c.toPrecision(2):c}, ones);`}let u="";i%n>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        float sumValue = 0.0;

        for (int i = 0; i < ${s}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${s};
        if (${o===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${o===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${o===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}},Ptt=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:i,outSize:a}=e;this.outputShape=[r,a];let s="0.0",o="";t==="prod"?s="1.0":t==="min"?(s="1.0 / 1e-20",o="min"):t==="max"&&(s="-1.0 / 1e-20",o="max");let l=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?l="sumValue":t==="prod"?l="prodValue":t==="all"?l="allValue":t==="any"&&(l="anyValue");let u=Math.floor(n/4)*4,c=n%4,d=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${o}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${o}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";t==="all"?(s="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):t==="any"&&(s="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let h="";i%n>0&&(h=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${s};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        vec4 minMaxValue = vec4(${s});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${c===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${c===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${c===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${l});
      }
    `}};function Att(e){let t=[];for(;t.length===0||t[t.length-1].outSize!==1;){let n=t.length?t[t.length-1].outSize:e[1],r=W.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function am(e,t,n,r){let i=Att(e.shape),a=e;for(let s=0;s<i.length;s++){let{inSize:o,windowSize:l,outSize:u}=i[s],c,d;n==="mean"?c=s===0?new dH({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u},o):new dH({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u}):c=new Ptt({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u},n),d=a,a=r.runWebGLProgram(c,[a],t),d.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(d)}return a}var Mtt=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];this.outputShape=n,this.rank=n.length;let r=jn(this.rank),i=Rtt(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}};function Rtt(e){let t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}var Dtt=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=new Array(e.length);for(let u=0;u<n.length;u++)n[u]=e[t[u]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let r=jn(this.rank),i=hse("rc",this.rank),a=new Array(this.rank);for(let u=0;u<t.length;u++)a[t[u]]=i[u];let s=`vec2(${a.slice(-2).join()})`,o=`++${i[this.rank-1]} < ${n[this.rank-1]}`,l=`getChannel(getA(${a.join()}), ${s})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${l};
      if(${o}) {
        result[1] = ${l};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${n[this.rank-2]}) {
        result[2] = ${l};
        if(${o}) {
          result[3] = ${l};
        }
      }
      setOutput(result);
    }
    `}};function dT(e,t,n){let r=he().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Dtt(e.shape,t):new Mtt(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function Ltt(e,t,n,r){let i=t,a=e.shape.length,s=P.parseAxisParam(i,e.shape),o=s,l=W.getAxesPermutation(o,a),u=l!=null,c=e;u&&(c=dT(e,l,r),o=W.getInnerMostAxes(o.length,a)),W.assertAxesAreInnerMostDims("sum",o,a);let[d,p]=W.computeOutAndReduceShapes(c.shape,o),h=d;n&&(h=W.expandShapeToKeepDim(d,s));let m=P.sizeFromShape(p),g=P.sizeFromShape(e.shape)/m,v=Be({inputs:{x:c},attrs:{shape:[g,m]},backend:r}),y=s$(e.dtype),b=am(v,y,"sum",r),_=Be({inputs:{x:b},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(b),u&&r.disposeIntermediateTensorInfo(c),_}function pT(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;return Ltt(i,a,s,n)}var Ftt={kernelName:jf,backendName:"webgl",kernelFunc:pT};function ya(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:a}=r,s=n,o=i.shape.length,l=new Array(o);for(let c=0;c<l.length;c++)l[c]=i.shape[a[c]];let u;if(s.shouldExecuteOnCPU([i])){let c=s.texData.get(i.dataId).values,d=Nz(c,i.shape,i.dtype,a,l);u=s.makeTensorInfo(l,i.dtype);let p=s.texData.get(u.dataId);p.values=d}else u=dT(i,a,s);return u}var ztt={kernelName:ku,backendName:"webgl",kernelFunc:ya},_se=1e3;function pI({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}){let u=e.shape.length,c=t.shape.length,d=n?e.shape[u-2]:e.shape[u-1],p=r?t.shape[c-1]:t.shape[c-2],h=n?e.shape[u-1]:e.shape[u-2],m=r?t.shape[c-2]:t.shape[c-1],g=e.shape.slice(0,-2),v=t.shape.slice(0,-2),y=P.sizeFromShape(g),b=P.sizeFromShape(v),_=Rv.assertAndGetBroadcastShape(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([h,m]);P.assert(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);let k=n?[y,d,h]:[y,h,d],C=r?[b,m,p]:[b,p,m],$=Be({inputs:{x:e},backend:i,attrs:{shape:k}}),N=Be({inputs:{x:t},backend:i,attrs:{shape:C}}),A=[$,N],D=Math.max(y,b),O=n?$.shape[1]:$.shape[2],F=a!=null,E=s!=null,z=l==="leakyrelu",q=l!=null?f1(l,!0):null,H=F||E||z||q!=null,J;if((h===1||m===1)&&O>_se&&H===!1){let V=$,Q=N;n&&(V=ya({inputs:{x:$},backend:i,attrs:{perm:[0,2,1]}}),A.push(V)),r&&(Q=ya({inputs:{x:N},backend:i,attrs:{perm:[0,2,1]}}),A.push(Q));let X=m!==1,Y=m===1,ce=V;X&&(ce=Be({inputs:{x:V},backend:i,attrs:{shape:[D,O,1]}}),A.push(ce));let pe=m===1?2:1,fe=Q;Y&&(fe=Be({inputs:{x:Q},backend:i,attrs:{shape:[D,1,O]}}),A.push(fe));let ye=Pz({inputs:{a:ce,b:fe},backend:i});J=pT({inputs:{x:ye},backend:i,attrs:{axis:pe,keepDims:!0}}),A.push(ye)}else{let V=Ls(e.dtype,t.dtype),Q=new xse(k,C,[D,h,m],n,r,F,q,E,z),X=[$,N];if(a!=null&&X.push(a),E&&X.push(s),z){let Y=i.makeTensorInfo([],"float32",P.createScalarValue(o,"float32"));X.push(Y),A.push(Y)}J=i.runWebGLProgram(Q,X,V)}let ee=Be({inputs:{x:J},backend:i,attrs:{shape:_}});A.push(J);for(let V of A)i.disposeIntermediateTensorInfo(V);return ee}function Btt(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return pI({a:i,b:a,transposeA:l,transposeB:u,backend:n,bias:s,preluActivationWeights:o,leakyreluAlpha:d,activation:c})}var Wtt={kernelName:Jp,backendName:"webgl",kernelFunc:Btt},pH="return abs(x);";function Vtt(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){let a=n.texData.get(r.dataId),s=dse(a.values);return n.makeTensorInfo(r.shape,r.dtype,s)}let i;return he().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Mc(r.shape,pH):i=new Ol(r.shape,pH),n.runWebGLProgram(i,[r],r.dtype)}var jtt={kernelName:Ay,backendName:"webgl",kernelFunc:Vtt},Utt=bo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Htt=un({opSnippet:Utt}),Gtt={kernelName:Eh,backendName:"webgl",kernelFunc:Htt},qtt=bo+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Ktt=un({opSnippet:qtt}),Ztt={kernelName:Oh,backendName:"webgl",kernelFunc:Ktt},hH="return a + b;",Xtt=Di({opSnippet:hH,packedOpSnippet:hH,supportsComplex:!0,cpuKernelImpl:net}),Jtt={kernelName:Nd,backendName:"webgl",kernelFunc:Xtt},Ytt=class{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((i,a)=>`T${a}`);let n=[];this.variableNames.forEach(i=>{n.push(`float v${i} = get${i}AtOutCoords();`)});let r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}},Qtt=class{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((i,a)=>`T${a}`);let n=[];this.variableNames.forEach(i=>{n.push(`vec4 v${i} = get${i}AtOutCoords();`)});let r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}};function hk(e){let{inputs:t,backend:n}=e,r=t;if(r.length===1)return vs({inputs:{x:r[0]},backend:n});if(r.length>he().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let o=Math.floor(r.length/2),l=hk({inputs:r.slice(0,o),backend:n}),u=hk({inputs:r.slice(o),backend:n});return hk({inputs:[l,u],backend:n})}let i=r.map(o=>o.dtype).reduce((o,l)=>Ls(o,l)),a=r.map(o=>o.shape),s=he().getBool("WEBGL_PACK")?new Qtt(r[0].shape,a):new Ytt(r[0].shape,a);return n.runWebGLProgram(s,r,i)}var ent={kernelName:Ph,backendName:"webgl",kernelFunc:hk};function tnt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r,o=i.shape.length,l=P.parseAxisParam(a,i.shape),u=l,c=W.getAxesPermutation(u,o),d=i;c!=null&&(d=ya({inputs:{x:i},backend:n,attrs:{perm:c}}),u=W.getInnerMostAxes(u.length,o)),W.assertAxesAreInnerMostDims("all",u,o);let[p,h]=W.computeOutAndReduceShapes(d.shape,u),m=P.sizeFromShape(h),g=Be({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),v=am(g,g.dtype,"all",n),y;if(s){let b=W.expandShapeToKeepDim(p,l);y=Be({inputs:{x:v},backend:n,attrs:{shape:b}})}else y=Be({inputs:{x:v},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),y}var nnt={kernelName:My,backendName:"webgl",kernelFunc:tnt};function rnt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r,o=i.shape.length,l=P.parseAxisParam(a,i.shape),u=l,c=W.getAxesPermutation(u,o),d=i;c!=null&&(d=ya({inputs:{x:i},backend:n,attrs:{perm:c}}),u=W.getInnerMostAxes(u.length,o)),W.assertAxesAreInnerMostDims("any",u,o);let[p,h]=W.computeOutAndReduceShapes(d.shape,u),m=P.sizeFromShape(h),g=Be({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),v=am(g,g.dtype,"any",n),y;if(s){let b=W.expandShapeToKeepDim(p,l);y=Be({inputs:{x:v},backend:n,attrs:{shape:b}})}else y=Be({inputs:{x:v},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),y}var int={kernelName:Ry,backendName:"webgl",kernelFunc:rnt},ant=class{constructor(e,t,n){this.variableNames=["A"];let{windowSize:r,batchSize:i,outSize:a}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];let s=t==="max"?">":"<",o=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${o};
          float candidate = getA(batch, inIdx);
          if (candidate ${s} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}},snt=class{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,P.assert(e.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);let i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");let s=this.outputShape,o=s.length,l=jn(o),u=ha("coords",o),c,d;if(a===1){d=o+1;let N=jn(d);c=`
        ${N} sourceLocR = ${N}(${u.join()}, 0);
        ++${u[o-1]};
        ${N} sourceLocG = ${N}(${u.join()}, 0);
        ++${u[o-2]};
        ${N} sourceLocA = ${N}(${u.join()}, 0);
        --${u[o-1]};
        ${N} sourceLocB = ${N}(${u.join()}, 0);
        --${u[o-2]};`}else d=o,c=`
        ${l} sourceLocR = coords;
        ++${u[o-1]};
        ${l} sourceLocG = coords;
        ++${u[o-2]};
        ${l} sourceLocA = coords;
        --${u[o-1]};
        ${l} sourceLocB = coords;
        --${u[o-2]};`;let p=["x","y","z","w","u","v"].slice(0,d),h="."+p[d-1],m=p.map(N=>"int "+N),g=ha("sourceLocR",d-1).concat("inIdx.r"),v=ha("sourceLocG",d-1).concat("inIdx.g"),y=ha("sourceLocB",d-1).concat("inIdx.b"),b=ha("sourceLocA",d-1).concat("inIdx.a"),_=n==="max"?"greaterThan":"lessThan",k=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,C=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${v.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,$=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${$}
      void main() {
        ${l} coords = getOutputCoords();
        bool hasNextCol = ${u[o-1]} < ${s[o-1]-1};
        bool hasNextRow = ${u[o-2]} < ${s[o-2]-1};
        ${c}
        ivec4 srcIdx = ivec4(sourceLocR${h}, sourceLocG${h},
          sourceLocB${h}, sourceLocA${h}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${k}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${_}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}};function kse(e,t,n,r=null){let i=t.shape[0],a=t.shape[1];r!=null&&(i=r.shape[0],a=r.shape[1]);let s=W.computeOptimalWindowSize(a),o={windowSize:s,inSize:a,batchSize:i,outSize:Math.ceil(a/s)},l=new ant(o,n,r==null),u=[t];r!=null&&u.push(r);let c=e.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;let d=kse(e,t,n,c);return e.disposeIntermediateTensorInfo(c),d}function Sse(e,t,n,r=null){let i=r!=null?r.shape:t.shape,a=i[i.length-1],s=W.computeOptimalWindowSize(a),o=new snt(i,s,n,r==null),l=r==null?[t]:[t,r],u=e.runWebGLProgram(o,l,"int32");if(u.shape.length===t.shape.length){let c=Sse(e,t,n,u);return e.disposeIntermediateTensorInfo(u),c}return u}function Cse(e,t,n,r){let i=[n];if(W.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!he().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let a=[],s=e.texData.get(t.dataId),o=s!==null&&s.isPacked,l=t;o&&(l=e.unpackTensor(t),a.push(l));let[u,c]=W.computeOutAndReduceShapes(l.shape,i),d=P.sizeFromShape(c),p=Be({inputs:{x:l},backend:e,attrs:{shape:[-1,d]}});a.push(p);let h=kse(e,p,r);a.push(h);let m=Be({inputs:{x:h},backend:e,attrs:{shape:u}});return a.forEach(g=>e.disposeIntermediateTensorInfo(g)),m}return Sse(e,t,r)}function ont(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r,s=P.parseAxisParam(a,i.shape),o=W.getAxesPermutation(s,i.shape.length),l=i,u=[];o!=null&&(l=ya({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),s=W.getInnerMostAxes(s.length,l.shape.length)),W.assertAxesAreInnerMostDims("argMax",[s[0]],l.shape.length);let c=Cse(n,l,s[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}var lnt={kernelName:Dy,backendName:"webgl",kernelFunc:ont};function unt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r,s=P.parseAxisParam(a,i.shape),o=W.getAxesPermutation(s,i.shape.length),l=i,u=[];o!=null&&(l=ya({inputs:{x:i},backend:n,attrs:{perm:o}}),u.push(l),s=W.getInnerMostAxes(s.length,l.shape.length)),W.assertAxesAreInnerMostDims("argMin",[s[0]],l.shape.length);let c=Cse(n,l,s[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}var cnt={kernelName:Ly,backendName:"webgl",kernelFunc:unt},dnt=bo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,pnt=un({opSnippet:dnt}),hnt={kernelName:Ah,backendName:"webgl",kernelFunc:pnt},fnt=bo+"return log(x + sqrt(x * x + 1.0));",mnt=un({opSnippet:fnt}),gnt={kernelName:Mh,backendName:"webgl",kernelFunc:mnt},ynt=bo+`
  return atan(x);
`,vnt=un({opSnippet:ynt}),bnt={kernelName:Rh,backendName:"webgl",kernelFunc:vnt},wnt=Oz+`
  return atan(a, b);
`,xnt=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+im+`
  return result;
`,_nt=Di({opSnippet:wnt,packedOpSnippet:xnt}),knt={kernelName:Lh,backendName:"webgl",kernelFunc:_nt},Snt=bo+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Cnt=un({opSnippet:Snt}),Int={kernelName:Dh,backendName:"webgl",kernelFunc:Cnt},m1=class{constructor(e,t,n,r=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let a=e.filterWidth,s=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;let m=t==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,v=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`,y="0.0";if(m||(y="-1.0 / 1e-20"),n){let N=">=";this.userCode=`
        const ivec2 strides = ivec2(${s}, ${o});
        const ivec2 pads = ivec2(${p}, ${h});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${c};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${N} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?g:v:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let b="max",_=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(_="avgValue / max(count, 1.0)");let k=Math.floor(a/4)*4,C=a%4,$=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${o});
      const ivec2 pads = ivec2(${p}, ${h});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${c};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${k}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${$}
          }

          int xC = xCCorner + ${k};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${$}
          }
        }
        setOutput(${_});
      }
    `}},Az=class{constructor(e,t,n,r=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let a=e.filterWidth,s=e.strideDepth,o=e.strideHeight,l=e.strideWidth,u=e.dilationDepth,c=e.dilationHeight,d=e.dilationWidth,p=e.effectiveFilterDepth,h=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.front,v=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;let b=t==="avg",_="0.0";if(b||(_="-1.0 / 1e-20"),n){let D=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${s}, ${o}, ${l});
        const ivec3 pads = ivec3(${g}, ${v}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${h};
                wR += ${c}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${D} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${h} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let k="max",C=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(C="avgValue / max(count, 1.0)");let $=Math.floor(a/4)*4,N=a%4,A=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${k}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${s}, ${o}, ${l});
      const ivec3 pads = ivec3(${g}, ${v}, ${y});
      const float initializationValue = ${_};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${_});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h};
            wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${$}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${A}
            }

            int xC = xCCorner + ${$};
            if (${N===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${N===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${N===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${A}
            }
          }
        }
        setOutput(${C});
      }
    `}};function $nt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;qv(i,"avgPool");let{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=r,u=1;P.assert(W.eitherStridesOrDilationsAreOne(s,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let c=W.computePool2DInfo(i.shape,a,s,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&P.arraysEqual(c.inShape,c.outShape))return vs({inputs:{x:i},backend:n});let d=new m1(c,"avg",!1);return n.runWebGLProgram(d,[i],"float32")}var Tnt={kernelName:Fh,backendName:"webgl",kernelFunc:$nt};function Nnt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=W.computePool3DInfo(i.shape,a,s,c,o,l,u),p=new Az(d,"avg",!1);return n.runWebGLProgram(p,[i],"float32")}var Ent={kernelName:Fy,backendName:"webgl",kernelFunc:Nnt},Ont=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=o-1-e.padInfo.top,c=l-1-e.padInfo.left,d=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${c});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${s}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},Pnt=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,h=c-1-e.padInfo.front,m=d-1-e.padInfo.top,g=p-1-e.padInfo.left,v=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(${h}, ${m}, ${g});
      const float avgMultiplier = float(${v});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${c};
            wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Ant(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,s=a,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],p=W.computePool3DInfo(s.shape,o,l,d,u,c),h=new Pnt(p);return n.runWebGLProgram(h,[i],s.dtype)}var Mnt={kernelName:K1,backendName:"webgl",kernelFunc:Ant};function Rnt(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,s=a;qv([i,a],"avgPoolGrad");let{filterSize:o,strides:l,pad:u}=r,c=W.computePool2DInfo(s.shape,o,l,1,u),d=new Ont(c);return n.runWebGLProgram(d,[i],s.dtype)}var Dnt={kernelName:q1,backendName:"webgl",kernelFunc:Rnt};function Lnt(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a}=t,{transposeA:s,transposeB:o}=r;return pI({a:i,b:a,transposeA:s,transposeB:o,backend:n})}var Fnt={kernelName:zh,backendName:"webgl",kernelFunc:Lnt},znt=class{constructor(e,t,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],W.assertAndGetBroadcastShape(e,t),W.assertAndGetBroadcastShape(e,n);let s="0.0";r!=null&&(W.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="1.0";i!=null&&(W.assertAndGetBroadcastShape(e,i),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${s};
        float scale = ${o};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}},Bnt=class{constructor(e,t,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],W.assertAndGetBroadcastShape(e,t),W.assertAndGetBroadcastShape(e,n);let s="vec4(0.0)";r!=null&&(W.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="vec4(1.0)";i!=null&&(W.assertAndGetBroadcastShape(e,i),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${s};
        vec4 scale = ${o};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}},Wnt=({inputs:e,backend:t,attrs:n})=>{let{x:r,mean:i,variance:a,offset:s,scale:o}=e;P.assert(i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),P.assert(s==null||i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),P.assert(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);let u=[r,i,a],c=null;s!=null&&(c=s.shape,u.push(s));let d=null;o!=null&&(d=o.shape,u.push(o));let p=he().getBool("WEBGL_PACK_NORMALIZATION")?new Bnt(r.shape,i.shape,a.shape,c,d,l):new znt(r.shape,i.shape,a.shape,c,d,l);return t.runWebGLProgram(p,u,u[0].dtype)},Vnt={kernelName:rf,backendName:"webgl",kernelFunc:Wnt},jnt=class{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let t=jn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let n=Unt(this.rank),r,i=e.map((a,s)=>`sourceLoc.${nA[s]} = start[${s}] + coords.${nA[s]};`);r=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${n}));
      }
    `}},nA=["x","y","z","w","u","v"];function Unt(e){if(e===1)return"sourceLoc";if(e<=6)return nA.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}var Hnt=class{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=jn(this.rank),n=ha("coords",this.rank),r=ha("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,a=`getChannel(getSource(${r.join()}), ${i})`,s=`
      result.x = ${a};
      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${a};
        --${r[this.rank-1]};
      }
    `,o=this.rank===1?"":`
      --${n[this.rank-1]};
      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${a};
        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${a};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((u,c)=>`start[${c}]`).join()});`:e.map((u,c)=>`${r[c]} = ${n[c]} + start[${c}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${s}
        ${o}
        setOutput(result);
      }
    `}};function Gnt(e,t,n,r){let i=r.texData.get(e.dataId),a=r.makeTensorInfo(n,e.dtype),s=r.texData.get(a.dataId);Object.assign(s,i),s.refCount=1,s.shape=n,s.dtype=e.dtype;let o=ei.computeFlatOffset(t,P.computeStrides(e.shape));i.slice&&(o+=i.slice.flatOffset),s.slice={flatOffset:o,origDataId:i.slice&&i.slice.origDataId||e.dataId};let l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),a}function e0(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,size:s}=r,[o,l]=ei.parseSliceParams(i,a,s);if(ei.assertParamsValid(i,o,l),P.sizeFromShape(l)===0)return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||i.dtype==="string"){let d=n.texData.get(i.dataId),p=Det(d.values,o,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,p)}let{isPacked:u}=n.texData.get(i.dataId),c=ei.isSliceContinous(i.shape,o,l);if(u||!c){let d=he().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hnt(l):new jnt(l),p=[o];return n.runWebGLProgram(d,[i],i.dtype,p)}return n.uploadToGPU(i.dataId),Gnt(i,o,l,n)}var qnt={kernelName:Sv,backendName:"webgl",kernelFunc:e0},Knt=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,crops:s}=r;P.assert(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let o=a.reduce((b,_)=>b*_),l=W.getReshaped(i.shape,a,o),u=W.getPermuted(l.length,a.length),c=W.getReshapedPermuted(i.shape,a,o),d=W.getSliceBeginCoords(s,a.length),p=W.getSliceSize(c,s,a.length),h=[],m=Be({inputs:{x:i},backend:n,attrs:{shape:l}}),g=ya({inputs:{x:m},backend:n,attrs:{perm:u}}),v=Be({inputs:{x:g},backend:n,attrs:{shape:c}}),y=e0({inputs:{x:v},backend:n,attrs:{begin:d,size:p}});return h.push(m),h.push(g),h.push(v),h.forEach(b=>n.disposeIntermediateTensorInfo(b)),y},Znt={kernelName:zy,backendName:"webgl",kernelFunc:Knt};function Xnt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:s}=r,o=n.readSync(i.dataId),l=n.readSync(a.dataId),u=cse(o,l,a.dtype,a.shape,s);return n.makeTensorInfo([s],a.dtype,u)}var Jnt={kernelName:By,backendName:"webgl",kernelFunc:Xnt},Ynt=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Qnt=`
  return float(int(a.r) & int(b.r));
`;function ert(e){let{inputs:t,backend:n}=e,{a:r,b:i}=t,a=he().getBool("WEBGL_PACK_BINARY_OPERATIONS"),s=he().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||s===1){let l=n.texData.get(r.dataId).values,u=n.texData.get(i.dataId).values,[c,d]=iet(r.shape,i.shape,l,u,r.dtype),p=n.makeTensorInfo(d,r.dtype),h=n.texData.get(p.dataId);return h.values=c,p}let o;return a?o=new Yv(Ynt,r.shape,i.shape,!1):o=new mh(Qnt,r.shape,i.shape),n.runWebGLProgram(o,[r,i],r.dtype)}var trt={kernelName:Wy,backendName:"webgl",kernelFunc:ert};function nrt(e){let{inputs:t,backend:n}=e,{s0:r,s1:i}=t,a=n.readSync(r.dataId),s=n.readSync(i.dataId),o=W.assertAndGetBroadcastShape(Array.from(a),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}var rrt={kernelName:Z1,backendName:"webgl",kernelFunc:nrt},irt="return float(a != b);",Ise=Di({opSnippet:irt,cpuKernelImpl:$et,dtype:"bool"}),art={kernelName:dv,backendName:"webgl",kernelFunc:Ise};function Hw(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return vs({inputs:{x:i.complexTensorInfos.real},backend:n})}var srt={kernelName:i$,backendName:"webgl",kernelFunc:Hw},ort="return float(int(x));";function lrt(e,t){let n=new Ol(e.shape,ort),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function rA(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:a}=r;if(a==="complex64"){if(i.dtype==="complex64")return vs({inputs:{x:i},backend:n});let s=br(i.shape),o=rA({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),l=zd({inputs:{real:o,imag:s},backend:n});return s.dispose(),n.disposeIntermediateTensorInfo(o),l}if(i.dtype==="complex64"){let s=Hw({inputs:{input:i},backend:n}),o=rA({inputs:{x:s},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(s),o}if(!P.hasEncodingLoss(i.dtype,a)){let s=vs({inputs:{x:i},backend:n});return{dataId:s.dataId,shape:s.shape,dtype:a}}if(n.shouldExecuteOnCPU([i])){let s=n.texData.get(i.dataId).values,[o,l,u]=aet(s,i.shape,i.dtype,a);return n.makeTensorInfo(o,l,u)}if(a==="int32")return lrt(i,n);if(a==="bool"){let s=n.makeTensorInfo([],"bool",P.getTypedArrayFromDType("bool",1)),o=Ise({inputs:{a:i,b:s},backend:n});return n.disposeIntermediateTensorInfo(s),o}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${a}`)}var urt={kernelName:Bh,backendName:"webgl",kernelFunc:rA},fH="return ceil(x);",crt=un({opSnippet:fH,packedOpSnippet:fH,cpuKernelImpl:set}),drt={kernelName:Wh,backendName:"webgl",kernelFunc:crt},prt=class{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}},hrt=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}};function frt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:a,clipValueMax:s}=r,o;he().getBool("WEBGL_PACK_CLIP")?o=new hrt(i.shape):o=new prt(i.shape);let l=[[a],[s]];return n.runWebGLProgram(o,[i],i.dtype,l)}var mrt={kernelName:Ed,backendName:"webgl",kernelFunc:frt},grt=class{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}};function mH(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function yrt(e){let{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),a=new grt(r.shape),s=[mH(r,i.complexTensorInfos.real),mH(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(a,s,s[0].dtype)}var vrt={kernelName:X1,backendName:"webgl",kernelFunc:yrt},brt=class{constructor(e){this.outputShape=[],this.outputShape=W.computeOutShape(e,1),this.variableNames=e.map((a,s)=>`T${s}`);let t=new Array(e.length-1);t[0]=e[0][1];for(let a=1;a<t.length;a++)t[a]=t[a-1]+e[a][1];let n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<t.length;a++){let s=t[a-1];n.push(`else if (yC < ${t[a]}) setOutput(getT${a}(yR, yC-${s}));`)}let r=t.length,i=t[t.length-1];n.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${n.join(`
        `)}
      }
    `}},wrt=class{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=W.computeOutShape(e,t);let n=this.outputShape,r=n.length,i=jn(r),a=ha("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((m,g)=>`T${g}`);let o=new Array(e.length-1);o[0]=e[0][t];for(let m=1;m<o.length;m++)o[m]=o[m-1]+e[m][t];let l=s[t],u=s.slice(-2),c=s.join(),d=`if (${l} < ${o[0]}) {
        return getChannel(
            getT0(${c}), vec2(${u.join()}));
        }`;for(let m=1;m<o.length;m++){let g=o[m-1];d+=`
        if (${l} < ${o[m]}  && ${l} >= ${o[m-1]}) {
          return getChannel(
            getT${m}(${b_(s,l,g)}),
            vec2(${b_(u,l,g)}));
        }`}let p=o.length,h=o[o.length-1];d+=`
        return getChannel(
          getT${p}(${b_(s,l,h)}),
          vec2(${b_(u,l,h)}));`,this.userCode=`
      float getValue(${s.map(m=>"int "+m)}) {
        ${d}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[r-1]} = ${a[r-1]} + 1;
        if (${a[r-1]} < ${n[r-1]}) {
          result.g = getValue(${a});
        }

        ${a[r-2]} = ${a[r-2]} + 1;
        if (${a[r-2]} < ${n[r-2]}) {
          result.a = getValue(${a});
        }

        ${a[r-1]} = ${a[r-1]} - 1;
        if (${a[r-2]} < ${n[r-2]} &&
            ${a[r-1]} < ${n[r-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}};function b_(e,t,n){let r=e.indexOf(t);return e.map((i,a)=>a===r?`${i} - ${n}`:i).join()}function hT(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return vs({inputs:{x:i.complexTensorInfos.imag},backend:n})}var xrt={kernelName:e$,backendName:"webgl",kernelFunc:hT};function ab(e,t,n){let r=e[0].dtype;if(r==="complex64"){let h=e.map(b=>Hw({inputs:{input:b},backend:n})),m=e.map(b=>hT({inputs:{input:b},backend:n})),g=ab(h,t,n),v=ab(m,t,n),y=zd({inputs:{real:g,imag:v},backend:n});return h.forEach(b=>n.disposeIntermediateTensorInfo(b)),m.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),y}let i=n.shouldExecuteOnCPU(e);if(r==="string"&&(i=!0),i){let h=e.map(k=>{let C=[-1,P.sizeFromShape(k.shape.slice(t))];return Be({inputs:{x:k},backend:n,attrs:{shape:C}})}),m=h.map(k=>({vals:n.readSync(k.dataId),shape:k.shape})),g=W.computeOutShape(h.map(k=>k.shape),1),v=h[0].shape[0]===1,y=oet(m,g,r,v),b=W.computeOutShape(e.map(k=>k.shape),t),_=n.makeTensorInfo(b,r,y);return h.forEach(k=>n.disposeIntermediateTensorInfo(k)),_}let a=e.filter(h=>P.sizeFromShape(h.shape)>0),s=he().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(a.length===1){let h=s?new Ol(e[0].shape,xc):new Mc(e[0].shape,xc);return n.runWebGLProgram(h,e,r)}let o=he().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>o){let h=[];for(let g=0;g<a.length;g+=o){let v=a.slice(g,g+o);h.push(ab(v,t,n))}let m=ab(h,t,n);for(let g of h)n.disposeIntermediateTensorInfo(g);return m}if(s){let h=new wrt(a.map(m=>m.shape),t);return n.runWebGLProgram(h,a,r)}let{tensors2D:l,outShape:u}=_rt(a,t,n),c=new brt(l.map(h=>h.shape)),d=n.runWebGLProgram(c,l,r);l.forEach(h=>n.disposeIntermediateTensorInfo(h));let p=Be({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),p}function _rt(e,t,n){let r=W.computeOutShape(e.map(i=>i.shape),t);return{tensors2D:e.map(i=>Be({inputs:{x:i},attrs:{shape:[-1,P.sizeFromShape(i.shape.slice(t))]},backend:n})),outShape:r}}function $se(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,a=P.parseAxisParam(i,t[0].shape)[0],s=t.map(u=>u.shape);W.assertParamsConsistent(s,a);let o=W.computeOutShape(t.map(u=>u.shape),a);if(P.sizeFromShape(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(u=>P.sizeFromShape(u.shape)>0);return l.length===1?vs({inputs:{x:l[0]},backend:n}):ab(l,a,n)}var krt={kernelName:Vy,backendName:"webgl",kernelFunc:$se},Tse=class{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;let a=e.padInfo.top,s=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,h=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,g=e.dataFormat==="channelsLast",v=g?1:2,y=g?2:3,b=g?3:1,_="",k="";n&&(r?_=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:i?_=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:_=`
          float activation(float x) {
            ${n}
          }
        `,k="result = activation(result);");let C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${_}

      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${a}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${v}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${c};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${h}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${h}) *
                    getW(wR, wC, ${h}, d2);
              } else {
                dotProd +=
                    getX(batch, ${h}, xR, xC) *
                    getW(wR, wC, ${h}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2),
                getW(wR, wC, ${h} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1),
                  getX(batch, xR, xC, ${h} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC),
                  getX(batch, ${h} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${k}
        setOutput(result);
      }
    `}},Srt=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.filterDepth,d=e.filterHeight,p=e.filterWidth,h=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${a}, ${s});
      const ivec3 pads = ivec3(${t}, ${n}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${c}; wF++) {
          int xF = xFCorner + wF * ${o};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${h}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${h}) *
                  getW(wF, wR, wC, ${h}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1),
                  getX(batch, xF, xR, xC, ${h} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2),
                  getW(wF, wR, wC, ${h} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},Nse=class{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=na(this.outputShape.length);let a=e.padInfo.left,s=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,c=u,d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<u;g++)d+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;d+=`
     for (int r = 0; r < ${l}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let g=0;g<u;g++)d+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(c+1)/2;g++){let v=g*2;if(d+=`
           xC = xCCorner + ${v*o};
           `,s===1){if(v<u&&(a%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }
               `,o===1&&v>0?d+=`
                 xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                   } else {
                     xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 xC${v} = xTexelC${v};
                 `,v+1<u)){let y=a%2===0?P.nearestLargerEven(o):o;o%2===0&&a%2===1||o%2!==0&&a%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                     xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${v+1}.zw = vec2(0.0);
                     }
                     xTexelC${v+1}Ready = 1;
                   }
                   `,o>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                     } else {
                      xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                     }
                     `:d+=`
                     xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                     `):y===1?d+=`
                     xC${v+1} = xTexelC${v};
                     `:d+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                       xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${v+1}.zw = vec2(0.0);
                       }
                       xTexelC${v+1}Ready = 1;
                     }

                     xC${v+1} = xTexelC${v+1};
                     `}}else v<u&&(a%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                   xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${v+1}.zw = vec2(0.0);
                   }
                   xTexelC${v+1}Ready = 1;
                 }

                 xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
               `,v+1<u&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                   xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v+1}.zw = vec2(0.);
                   }
                   xTexelC${v+1}Ready = 1;
                 }

                 xC${v} = vec4(
                   xTexelC${v}.xy, xTexelC${v+1}.xy);
               `,v+1<u&&(d+=`
                   xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                 `)));v<u&&(d+=`
             wTexel = getW(r, ${v}, d1, d2);
             dotProd += xC${v}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${v}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,v+1<u&&(d+=`
               wTexel = getW(r, ${v+1}, d1, d2);
               dotProd += xC${v+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${v+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let p="",h="";n&&(r?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${n}
         }`:i?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${n}
         }`:p=`vec4 activation(vec4 x) {
           ${n}
         }`,h="result = activation(result);");let m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${h}
         setOutput(result);
       }
     `}},Crt=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=na(this.outputShape.length);let{dataFormat:n}=t,r=Ca(),i=n==="channelsLast",a=i?1:2,s=i?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`,l="";for(let u=0;u<=1;u++)for(let c=0;c<=1;c++)l+=`
          blockIndex = rc.z + ${c};
          pos = rc.y + ${u};

          ${o}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${s}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+c}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+c}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${l}

        ${r.output} = result;
      }
    `}};function hI(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function Ese({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:o=null}){let l=e.shape,u=r.texData.get(e.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],p=n.outChannels,h=n.dataFormat==="channelsLast",m=!1,g=!1,v,y=[];if(a!=null){let b=hI(a.shape,h);b!=null&&(a=Be({inputs:{x:a},backend:r,attrs:{shape:b}}),y.push(a))}if(i!=null){let b=hI(i.shape,h);b!=null&&(i=Be({inputs:{x:i},backend:r,attrs:{shape:b}}),y.push(i))}if(!((d===1||p===1)&&c>_se)&&u.isPacked&&h&&u.texture!=null&&l[2]%2!==0&&P.arraysEqual(u.shape.slice(-3),l.slice(-3))){let b=l[0]*l[1]*(l[2]+1),_={dataId:e.dataId,shape:[1,b,n.inChannels],dtype:e.dtype},k=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,P.assert(h1(u.shape,_.shape),()=>`packed reshape ${u.shape} to ${_.shape} isn't free`);let C=Be({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push(C);let $=pI({a:_,b:C,backend:r,transposeA:m,transposeB:g,bias:i,activation:o,preluActivationWeights:a,leakyreluAlpha:s}),N=r.texData.get($.dataId);P.assert(N.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=k,N.shape=n.outShape,v=vs({inputs:{x:$},backend:r}),v.shape=n.outShape,y.push($)}else{let b=n.outHeight*n.outWidth,_=Be({inputs:{x:e},backend:r,attrs:{shape:h?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),k=Be({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),C=pI({a:h?_:k,b:h?k:_,transposeA:!h,transposeB:g,backend:r,bias:i,activation:o,preluActivationWeights:a,leakyreluAlpha:s});v=Be({inputs:{x:C},backend:r,attrs:{shape:n.outShape}}),y.push(_),y.push(k),y.push(C)}for(let b of y)r.disposeIntermediateTensorInfo(b);return v}function Ose({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:o=null}){let{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:p,dataFormat:h}=n,m=h==="channelsLast",g=l*u*c,v=p*d,y=[n.batchSize,g,v],b=!0,_=!1,k=[];if(a!=null){let V=hI(a.shape,m);V!=null&&(a=Be({inputs:{x:a},backend:r,attrs:{shape:V}}),k.push(a))}if(i!=null){let V=hI(i.shape,m);V!=null&&(i=Be({inputs:{x:i},backend:r,attrs:{shape:V}}),k.push(i))}let C=Be({inputs:{x:t},backend:r,attrs:{shape:[1,g,P.sizeFromShape(t.shape)/g]}});k.push(C);let $=new Crt(y,n),N=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],A=r.runWebGLProgram($,[e],"float32",N),D=Be({inputs:{x:A},backend:r,attrs:{shape:y}});k.push(A),k.push(D);let O=i!=null,F=a!=null,E=o==="leakyrelu",z=o?f1(o,!0):null,q=new xse(m?D.shape:C.shape,m?C.shape:D.shape,m?[n.batchSize,v,n.outChannels]:[n.batchSize,n.outChannels,v],b,_,O,z,F,E),H=m?[D,C]:[C,D];if(i&&H.push(i),F&&H.push(a),E){let V=r.makeTensorInfo([],"float32",P.createScalarValue(s,"float32"));H.push(V),k.push(V)}let J=r.runWebGLProgram(q,H,"float32"),ee=Be({inputs:{x:J},backend:r,attrs:{shape:n.outShape}});k.push(J);for(let V of k)r.disposeIntermediateTensorInfo(V);return ee}function Irt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=W.convertConv2DDataFormat(l),p=W.computeConv2DInfo(i.shape,a.shape,s,u,o,c,!1,d),h;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))h=Ese({x:i,filter:a,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&he().getBool("WEBGL_EXP_CONV")){let g=new Nse(p),v=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];h=n.runWebGLProgram(g,[i,a],"float32",v)}else if(he().getBool("WEBGL_CONV_IM2COL"))h=Ose({x:i,filter:a,convInfo:p,backend:n});else{let g=new Tse(p);h=n.runWebGLProgram(g,[i,a],"float32")}let m=Be({inputs:{x:h},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(h),m}var $rt={kernelName:Vh,backendName:"webgl",kernelFunc:Irt},Trt=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${a?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}},Nrt=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dataFormat==="channelsLast",s=t-1-e.padInfo.top,o=n-1-e.padInfo.left,l=a?1:2,u=a?2:3,c=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${c}];

        ivec2 dyCorner = ivec2(coords[${l}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},Ert=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,s=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${n} - ${a};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${s};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},Ort=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,s=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${o}, ${l}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${n}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${n} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Prt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=W.convertConv2DDataFormat(l),p=W.computeConv2DInfo(i.shape,c,s,1,o,u,!1,d),h=new Trt(p);return n.runWebGLProgram(h,[i,a],"float32")}var Art={kernelName:q2,backendName:"webgl",kernelFunc:Prt},Mrt=class{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=na(this.outputShape.length);let t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,i=n-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            int wCPerm = ${n} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}};function Rrt(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{inputShape:s,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=W.convertConv2DDataFormat(u),p=W.computeConv2DInfo(s,a.shape,o,1,l,c,!1,d);if(he().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){let h=[[p.strideHeight,p.strideWidth]],m=new Mrt(p);return n.runWebGLProgram(m,[i,a],"float32",h)}else{let h=new Nrt(p);return n.runWebGLProgram(h,[i,a],"float32")}}var Drt={kernelName:jh,backendName:"webgl",kernelFunc:Rrt};function Lrt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l}=r,u=W.computeConv3DInfo(i.shape,a.shape,s,l,o),c=new Srt(u);return n.runWebGLProgram(c,[i,a],"float32")}var Frt={kernelName:Uh,backendName:"webgl",kernelFunc:Lrt};function zrt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:o,filterShape:l}=r,u=W.computeConv3DInfo(i.shape,l,s,1,o),c=new Ert(u);return n.runWebGLProgram(c,[i,a],"float32")}var Brt={kernelName:jy,backendName:"webgl",kernelFunc:zrt};function Wrt(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{pad:s,strides:o,inputShape:l}=r,u=W.computeConv3DInfo(l,a.shape,o,1,s),c=new Ort(u);return n.runWebGLProgram(c,[i,a],"float32")}var Vrt={kernelName:Uy,backendName:"webgl",kernelFunc:Wrt},jrt=Qv+`
  return cos(x);
`,Urt=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${im}
  return result;
`,Hrt=un({opSnippet:jrt,packedOpSnippet:Urt}),Grt={kernelName:Hh,backendName:"webgl",kernelFunc:Hrt},qrt=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Krt=un({opSnippet:qrt}),Zrt={kernelName:Gh,backendName:"webgl",kernelFunc:Krt},Xrt=class{constructor(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[a,s,o,l]=e,[u]=t,[c,d]=n;this.outputShape=[u,c,d,l];let p=r==="bilinear"?1:0,[h,m]=[`${s-1}.0`,`${o-1}.0`],[g,v,y]=c>1?[`${(s-1)/(c-1)}`,"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${h}`],[b,_,k]=d>1?[`${(o-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${v};
        float width_scale = ${_};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${h} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${k};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}},Jrt=e=>{let{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:a,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:u}=r,c=new Xrt(i.shape,a.shape,o,l,u);return n.runWebGLProgram(c,[i,a,s],"float32")},Yrt={kernelName:Gy,backendName:"webgl",kernelFunc:Jrt},g1;(function(e){e.Prod="*",e.Sum="+"})(g1||(g1={}));var gH=class{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let i=this.outputShape.length,a=this.op===g1.Prod?"1.0":"0.0",s=n?a:`getX(${yH(i,"coords",this.op)})`,o=this.outputShape[this.outputShape.length-1],l="",u="";n?(l=r?`end != ${o-1}`:"end != 0",u=r?"end + 1":"end - 1"):(l=r?`end + pow2 < ${o}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${jn(i)} coords = getOutputCoords();
        int end = ${vH(i,"coords",this.op)};
        float val = ${s};
        int pow2 = int(pow(2.0, index));
        if (${l}) {
          int idx = ${u};
          ${vH(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${yH(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}};function yH(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function vH(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function Pse(e,t,n,r,i,a){let s=t.shape.length,o=W.getAxesPermutation([r],s),l=t;o!=null&&(l=ya({inputs:{x:t},backend:n,attrs:{perm:o}}));let u=W.getInnerMostAxes(1,s)[0];if(u!==s-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);let c=l.shape[u],d=vs({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(c))-1;p++){let h=new gH(e,l.shape,!1,a),m=[[p]],g=d;d=n.runWebGLProgram(h,[d],d.dtype,m),n.disposeIntermediateTensorInfo(g)}if(i){let p=new gH(e,l.shape,i,a),h=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(h)}if(o!=null){let p=W.getUndoAxesPermutation(o),h=ya({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),h}return d}function Qrt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:s,reverse:o}=r;return Pse(g1.Prod,i,n,a,s,o)}var eit={kernelName:Hy,backendName:"webgl",kernelFunc:Qrt};function tit(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:s,reverse:o}=r;return Pse(g1.Sum,i,n,a,s,o)}var nit={kernelName:qh,backendName:"webgl",kernelFunc:tit};function rit(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:s,binaryOutput:o}=r;if(i.shape.length===1){let l=n.readSync(i.dataId),u=n.readSync(a.dataId),c=cse(l,u,a.dtype,a.shape,s);return n.makeTensorInfo([s],a.dtype,c)}else if(i.shape.length===2){let l=n.bufferSync(i),u=n.bufferSync(a),c=ret(l,u,s,o);return n.makeTensorInfo(c.shape,a.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}var iit={kernelName:J1,backendName:"webgl",kernelFunc:rit},ait=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};function sit(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:a,dataFormat:s}=r,o=i.shape[0],l=s==="NHWC"?i.shape[1]:i.shape[2],u=s==="NHWC"?i.shape[2]:i.shape[3],c=s==="NHWC"?i.shape[3]:i.shape[1],d=l*a,p=u*a,h=c/(a*a),m=s==="NHWC"?[o,d,p,h]:[o,h,d,p],g=new ait(m,a,s);return n.runWebGLProgram(g,[i],i.dtype)}var oit={kernelName:qy,backendName:"webgl",kernelFunc:sit},Ase=class{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=na(this.outputShape.length);let a=e.filterHeight,s=e.filterWidth,o=e.outChannels/e.inChannels,l="",u="";n&&(r?l=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:i?l=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:l=`
          float activation(float x) {
            ${n}
          }
        `,u="result = activation(result);");let c=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${l}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${s}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${c}
        ${u}
        setOutput(result);
      }
    `}},Mse=class{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=na(this.outputShape.length);let a=e.outChannels/e.inChannels,s=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c,p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<c;v++)p+=`
          vec4 xTexelC${v*2};
          int xTexelC${v*2}Ready;
          vec4 xTexelC${v*2+1};
          int xTexelC${v*2+1}Ready;
          vec4 xC${v};`;p+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let v=0;v<c;v++)p+=`
          xTexelC${v*2} = vec4(0.0);
          xTexelC${v*2}Ready = 0;
          xTexelC${v*2+1} = vec4(0.0);
          xTexelC${v*2+1}Ready = 0;
          xC${v} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let v=0;v<(d+1)/2;v++){let y=v*2;if(p+=`
          xC = xCCorner + ${y*l};
          `,o===1){if(y<c&&(s%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,l===1&&y>0?p+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<c)){let b=s%2===0?P.nearestLargerEven(l):l;l%2===0&&s%2===1||l%2!==0&&s%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,l>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:p+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):b===1?p+=`
                    xC${y+1} = xTexelC${y};
                    `:p+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<c&&(s%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<c&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<c&&(p+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<c&&(p+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<c&&(p+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let h="",m="";n&&(r?h=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:i?h=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:h=`vec4 activation(vec4 x) {
          ${n}
        }`,m="result = activation(result);");let g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${h}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}};function lit(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:u}=r,c=l;c==null&&(c=[1,1]),P.assert(W.eitherStridesOrDilationsAreOne(s,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let d=W.computeConv2DInfo(i.shape,a.shape,s,c,o,u,!0),p;he().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new Mse(d):p=new Ase(d);let h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[i,a],"float32",h)}var uit={kernelName:Kh,backendName:"webgl",kernelFunc:lit},cit=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},dit=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${o}; dm++) {
              int d2 = d1 * ${o} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function pit(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r,d=W.computeConv2DInfo(i.shape,c,s,o,l,u,!0),p=new cit(d);return n.runWebGLProgram(p,[i,a],"float32")}var hit={kernelName:K2,backendName:"webgl",kernelFunc:pit};function fit(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=r,d=W.computeConv2DInfo(c,a.shape,s,o,l,u,!0),p=new dit(d);return n.runWebGLProgram(p,[i,a],"float32")}var mit={kernelName:Z2,backendName:"webgl",kernelFunc:fit},git=class{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}};function yit(e){let{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],a=P.sizeFromShape(r.shape),s=Be({inputs:{x:r},backend:n,attrs:{shape:[a]}}),o=new git(a),l=n.runWebGLProgram(o,[s],s.dtype),u=Be({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}var vit={kernelName:Y1,backendName:"webgl",kernelFunc:yit},bit=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:r,strideHeight:i,strideWidth:a,filterHeight:s,filterWidth:o,dilationHeight:l,dilationWidth:u}=e,{top:c,left:d}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${a});
      const ivec2 pads = ivec2(${c}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${s}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${o}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${n}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}};function wit(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l}=r,u=W.computeDilation2DInfo(i.shape,a.shape,s,o,"NHWC",l),c,d=new bit(u);c=n.runWebGLProgram(d,[i,a],"float32");let p=Be({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),p}var xit={kernelName:Zh,backendName:"webgl",kernelFunc:wit};function _it(e){let{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,a=t,{allDims:s,summedDims:o,idDims:l}=W.decodeEinsumEquation(i,a.length);W.checkEinsumDimSizes(s.length,l,a);let{path:u,steps:c}=W.getEinsumComputePath(o,l),d=c.length,p=null,h=s.length,m=[];for(let g=0;g<d;++g){for(let v of c[g]){let{permutationIndices:y,expandDims:b}=W.getEinsumPermutation(h,l[v]),_;W.isIdentityPermutation(y)?_=a[v]:(_=ya({inputs:{x:a[v]},backend:n,attrs:{perm:y}}),m.push(_));let k=_.shape.slice();for(let C=0;C<b.length;++C)k.splice(b[C],0,1);P.arraysEqual(_.shape,k)||(_=Be({inputs:{x:_},backend:n,attrs:{shape:k}}),m.push(_)),p===null?p=_:(p=Pz({inputs:{a:_,b:p},backend:n}),m.push(p))}g<d-1&&(u[g]>=0&&(p=pT({inputs:{x:p},backend:n,attrs:{axis:u[g]-(s.length-h),keepDims:!1}}),m.push(p)),h--)}for(let g of m)g!==p&&n.disposeIntermediateTensorInfo(g);return p}var kit={kernelName:J2,backendName:"webgl",kernelFunc:_it},Sit="return (x >= 0.0) ? x : (exp(x) - 1.0);",Cit=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Iit=un({opSnippet:Sit,packedOpSnippet:Cit}),$it={kernelName:Jh,backendName:"webgl",kernelFunc:Iit},Tit="return (b >= 0.0) ? a : a * (b + 1.0);",Nit=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Eit=e=>{let{inputs:t,backend:n}=e,{dy:r,y:i}=t,a=he().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yv(Nit,r.shape,i.shape):new mh(Tit,r.shape,i.shape);return n.runWebGLProgram(a,[r,i],r.dtype)},Oit={kernelName:Ky,backendName:"webgl",kernelFunc:Eit},Pit=`
  return vec4(equal(a, b));
`,Ait="return float(a == b);",Mit=Di({opSnippet:Ait,packedOpSnippet:Pit,dtype:"bool",cpuKernelImpl:uet}),Rit={kernelName:Zy,backendName:"webgl",kernelFunc:Mit},Dit=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${W.ERF_P};
  float a1 = ${W.ERF_A1};
  float a2 = ${W.ERF_A2};
  float a3 = ${W.ERF_A3};
  float a4 = ${W.ERF_A4};
  float a5 = ${W.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Lit=un({opSnippet:Dit}),Fit={kernelName:Yh,backendName:"webgl",kernelFunc:Lit},zit=Qv+`
  return exp(x);
`,Bit=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Rse=un({opSnippet:zit,packedOpSnippet:Bit,cpuKernelImpl:cet,dtype:"float32"}),Wit={kernelName:Qh,backendName:"webgl",kernelFunc:Rse};function iA(e){let{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:a}=t,s=a.shape.length,o=a.shape.slice(),l=i;return i<0&&(P.assert(-(s+1)<=i,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+i+1),o.splice(l,0,1),Be({inputs:{x:a},backend:r,attrs:{shape:o}})}var Vit={kernelName:Xy,backendName:"webgl",kernelFunc:iA},bH="return exp(x) - 1.0;",jit=un({opSnippet:bH,packedOpSnippet:bH,cpuKernelImpl:det}),Uit={kernelName:ef,backendName:"webgl",kernelFunc:jit},wH=class{constructor(e,t,n){this.variableNames=["real","imag"];let r=t[1];this.outputShape=t;let i=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=n?`${r}.0`:"1.0",s;if(e==="real")s="return real * expR - imag * expI;";else if(e==="imag")s="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${s}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}};function Dse(e,t,n){let r=n.texData.get(e.dataId),i=P.sizeFromShape(e.shape),a=e.shape[e.shape.length-1],s=i/a,o=Be({inputs:{x:e},backend:n,attrs:{shape:[s,a]}}),l=o.shape,u=new wH("real",l,t),c=new wH("imag",l,t),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),m=zd({inputs:{real:p,imag:h},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h);let g=Be({inputs:{x:m},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(m),g}function Hit(e){let{inputs:t,backend:n}=e,{input:r}=t;return Dse(r,!1,n)}var Git={kernelName:Y2,backendName:"webgl",kernelFunc:Hit},qit=class{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}};function Gw(e){let{backend:t,attrs:n}=e,{shape:r,value:i}=n,{dtype:a}=n;if(a=a||P.inferDtype(i),a==="string"){let s=P.getArrayFromDType(a,P.sizeFromShape(r));return s.fill(i),t.makeTensorInfo(r,a,s)}else{let s=new qit(r,i),o=[[i]];return t.runWebGLProgram(s,[],a,o)}}var Kit={kernelName:Q1,backendName:"webgl",kernelFunc:Gw},Zit=class{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}},Xit={kernelName:Jy,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{let{image:n}=e,r=t,i=new Zit(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}},xH="return floor(x);",Jit=un({opSnippet:xH,packedOpSnippet:xH,cpuKernelImpl:pet}),Yit={kernelName:tf,backendName:"webgl",kernelFunc:Jit},Qit=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,eat=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,tat=Di({opSnippet:Qit,packedOpSnippet:eat,dtype:"int32"}),nat={kernelName:nf,backendName:"webgl",kernelFunc:tat},rat=class{constructor(e){this.variableNames=["A"];let t=Ca(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}},iat=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=Ca(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${n}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}},aat={kernelName:UC,backendName:"webgl",kernelFunc:sat},Lm,pE=he().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function sat(e){let{inputs:t,backend:n,attrs:r}=e,{pixels:i}=t,{numChannels:a}=r,s=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[l,u]=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[u,l],d=[u,l,a];if(o||s){let g=he().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Lm==null||g!==pE)&&(pE=g,Lm=document.createElement("canvas").getContext("2d",{willReadFrequently:pE})),Lm.canvas.width=l,Lm.canvas.height=u,Lm.drawImage(i,0,0,l,u),i=Lm.canvas}let p=n.makeTensorInfo(c,"int32");n.texData.get(p.dataId).usage=Ts.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),i);let h=he().getBool("WEBGL_PACK")?new iat(d):new rat(d),m=n.runWebGLProgram(h,[p],"int32");return n.disposeData(p.dataId),m}function oat(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:m}=r,g=W.convertConv2DDataFormat(c),v=W.computeConv2DInfo(i.shape,a.shape,l,d,u,p,!1,g),y,b=[],_=s!=null,k=o!=null,C=h==="leakyrelu",$=()=>{let A=[i,a],D=(O,F)=>{if(F==="NCHW"&&O.shape.length===1&&O.shape[0]!==1){let E=Be({inputs:{x:O},backend:n,attrs:{shape:[O.shape[0],1,1]}});return b.push(E),E}return O};if(_&&A.push(D(s,c)),k&&A.push(D(o,c)),C){let O=n.makeTensorInfo([],"float32",P.createScalarValue(m,"float32"));A.push(O),b.push(O)}return A};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))y=Ese({x:i,filter:a,convInfo:v,backend:n,bias:s,activation:h,preluActivationWeights:o,leakyreluAlpha:m});else if(v.strideWidth<=2&&g==="channelsLast"&&he().getBool("WEBGL_EXP_CONV")){let A=h?f1(h,!0):null,D=new Nse(v,_,A,k,C),O=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],F=$();y=n.runWebGLProgram(D,F,"float32",O)}else if(he().getBool("WEBGL_CONV_IM2COL"))y=Ose({x:i,filter:a,convInfo:v,backend:n,bias:s,activation:h,preluActivationWeights:o,leakyreluAlpha:m});else{let A=h?f1(h,!1):null,D=new Tse(v,_,A,k,C),O=$();y=n.runWebGLProgram(D,O,"float32")}let N=Be({inputs:{x:y},backend:n,attrs:{shape:v.outShape}});return b.push(y),b.forEach(A=>n.disposeIntermediateTensorInfo(A)),N}var lat={kernelName:Yp,backendName:"webgl",kernelFunc:oat};function uat(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:p,leakyreluAlpha:h}=r,m=[],g=c;g==null&&(g=[1,1]),P.assert(W.eitherStridesOrDilationsAreOne(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);let v=W.computeConv2DInfo(i.shape,a.shape,l,g,u,d,!0),y=he().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,b=p?f1(p,y):null,_=[i,a],k=s!=null,C=o!=null,$=p==="leakyrelu";if(k&&_.push(s),C&&_.push(o),$){let O=n.makeTensorInfo([],"float32",P.createScalarValue(h,"float32"));_.push(O),m.push(O)}let N;y?N=new Mse(v,k,b,C,$):N=new Ase(v,k,b,C,$);let A=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],D=n.runWebGLProgram(N,_,"float32",A);return m.forEach(O=>n.disposeIntermediateTensorInfo(O)),D}var cat={kernelName:Qp,backendName:"webgl",kernelFunc:uat},dat=class{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;let i=jn(n.length),a=`
    int index;`;for(let s=0;s<this.sliceDim;s++)a+=`
          index = round(getIndices(coords[0], ${s}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[s]};
          flattenIndex += index * ${this.strides[s]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}};function pat(e){let{inputs:t,backend:n}=e,{params:r,indices:i}=t,a=i.shape,s=a[a.length-1],o=P.sizeFromShape(r.shape),[l,u,c,d]=W.prepareAndValidate(r,i),p=Be({inputs:{x:i},backend:n,attrs:{shape:[u,s]}}),h=Be({inputs:{x:r},backend:n,attrs:{shape:[P.sizeFromShape(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){let y=n.readSync(i.dataId),b=n.bufferSync(r),_=het(y,b,r.dtype,u,s,c,d,r.shape,o);return n.makeTensorInfo(l,r.dtype,_.values)}let m=new dat(s,d,[u,c],r.shape),g=n.runWebGLProgram(m,[h,p],h.dtype),v=Be({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),v}var hat={kernelName:Qy,backendName:"webgl",kernelFunc:pat},fat=class{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=jn(this.rank),r=mat(e);this.userCode=`
      void main() {
        ${n} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}};function mat(e,t){let n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<e.length;i++)i===2?r.push("index"):r.push(`${n[i]}`);return r.join()}function Lse(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,indices:a}=t,{axis:s,batchDims:o}=r,l=P.parseAxisParam(s,i.shape)[0];if(he().get("DEBUG")){let b=n.readSync(a.dataId),_=i.shape[l];for(let k=0;k<b.length;++k){let C=b[k];P.assert(C<=_-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${_-1}]`)}}let u=W.segment_util.collectGatherOpShapeInfo(i,a,l,o),c=P.sizeFromShape(a.shape),d=[],p=Be({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),h=Be({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(p),d.push(h);let m=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([i,a])||i.dtype==="string"){let b=n.bufferSync(h),_=n.bufferSync(p),k=fet(_,b,m);return d.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(u.outputShape,k.dtype,k.values)}let g=new fat(p.shape,m),v=n.runWebGLProgram(g,[p,h],p.dtype);d.push(v);let y=Be({inputs:{x:v},backend:n,attrs:{shape:u.outputShape}});return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),y}var gat={kernelName:Yy,backendName:"webgl",kernelFunc:Lse},yat="return float(a > b);",vat=`
  return vec4(greaterThan(a, b));
`,bat=Di({opSnippet:yat,packedOpSnippet:vat,cpuKernelImpl:met,dtype:"bool"}),wat={kernelName:ev,backendName:"webgl",kernelFunc:bat},xat="return float(a >= b);",_at=`
  return vec4(greaterThanEqual(a, b));
`,kat=Di({opSnippet:xat,packedOpSnippet:_at,dtype:"bool",cpuKernelImpl:get}),Sat={kernelName:af,backendName:"webgl",kernelFunc:kat};function Cat(e){let{inputs:t,backend:n}=e,{input:r}=t;return Dse(r,!0,n)}var Iat={kernelName:Q2,backendName:"webgl",kernelFunc:Cat},$at="return float(!isnan(x) && !isinf(x));",Tat=un({opSnippet:$at,dtype:"bool"}),Nat={kernelName:of,backendName:"webgl",kernelFunc:Tat},Eat="return float(isinf(x));",Oat=un({opSnippet:Eat,dtype:"bool"}),Pat={kernelName:lf,backendName:"webgl",kernelFunc:Oat},Aat="return float(isnan(x));",Mat=un({opSnippet:Aat,dtype:"bool"}),Rat={kernelName:uf,backendName:"webgl",kernelFunc:Mat},Dat="return float(a < b);",Lat=`
  return vec4(lessThan(a, b));
`,Fat=Di({opSnippet:Dat,packedOpSnippet:Lat,cpuKernelImpl:yet,dtype:"bool"}),zat={kernelName:tv,backendName:"webgl",kernelFunc:Fat},Bat="return float(a <= b);",Wat=`
  return vec4(lessThanEqual(a, b));
`,Vat=Di({opSnippet:Bat,packedOpSnippet:Wat,cpuKernelImpl:vet,dtype:"bool"}),jat={kernelName:nv,backendName:"webgl",kernelFunc:Vat};function Uat(e){let{backend:t,attrs:n}=e,{start:r,stop:i,num:a}=n,s=bet(r,i,a);return t.makeTensorInfo([s.length],"float32",s)}var Hat={kernelName:rv,backendName:"webgl",kernelFunc:Uat},Gat=Qv+`
  return x < 0.0 ? 0./0. : log(x);
`,qat=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Kat=un({opSnippet:Gat,packedOpSnippet:qat,cpuKernelImpl:wet}),Zat={kernelName:df,backendName:"webgl",kernelFunc:Kat},Xat=Qv+`
  return log(1.0 + x);
`,Jat=un({opSnippet:Xat}),Yat={kernelName:pf,backendName:"webgl",kernelFunc:Jat},Qat="return float(a >= 1.0 && b >= 1.0);",est=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,tst=Di({opSnippet:Qat,packedOpSnippet:est,dtype:"bool"}),nst={kernelName:iv,backendName:"webgl",kernelFunc:tst},rst="return float(!(x >= 1.0));",ist=un({opSnippet:rst}),ast={kernelName:av,backendName:"webgl",kernelFunc:ist},sst="return float(a >= 1.0 || b >= 1.0);",ost=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,lst=Di({opSnippet:sst,packedOpSnippet:ost,dtype:"bool"}),ust={kernelName:sv,backendName:"webgl",kernelFunc:lst},cst=class{constructor(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];let a=t,s=e[3]-1;this.outputShape=e;let o,l=`float(${n}) + float(${r}) * sum`;i===.5?o=`inversesqrt(${l})`:i===1?o=`1.0/(${l})`:o=`exp(log(${l}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${s}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${o};
        setOutput(val);
      }
    `}},dst=class{constructor(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let a=t,s=e[3]-1;this.outputShape=e;let o,l=`float(${n}) + float(${r}) * sum`;i===.5?o=`inversesqrt(${l})`:i===1?o=`1.0/(${l})`:o=`exp(log(${l}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${s}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${o};
        setOutput(result);
      }
    `}},pst=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:a,bias:s,alpha:o,beta:l}=r,u=he().getBool("WEBGL_PACK_NORMALIZATION")?new dst(i.shape,a,s,o,l):new cst(i.shape,a,s,o,l);return n.runWebGLProgram(u,[i],i.dtype)},hst={kernelName:hf,backendName:"webgl",kernelFunc:pst},fst=class{constructor(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${n});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}},mst=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i,y:a,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=r,d=new fst(i.shape,o,l,u,c);return n.runWebGLProgram(d,[i,a,s],i.dtype)},gst={kernelName:ov,backendName:"webgl",kernelFunc:mst};function yst(e,t,n,r){let i=P.sizeFromShape(t),a=P.sizeFromShape(e.shape)/i,s=Be({inputs:{x:e},attrs:{shape:[a,i]},backend:r}),o=am(s,e.dtype,"max",r),l=Be({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),l}function Fse(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:a,keepDims:s}=r,o=i.shape.length,l=P.parseAxisParam(a,i.shape),u=l,c=W.getAxesPermutation(u,o),d=c!=null,p=n.shouldExecuteOnCPU([i]),h=i;if(d){if(p){let b=n.texData.get(h.dataId).values,_=new Array(o);for(let $=0;$<_.length;$++)_[$]=i.shape[c[$]];let k=Nz(b,i.shape,i.dtype,c,_);h=n.makeTensorInfo(_,i.dtype);let C=n.texData.get(h.dataId);C.values=k}else h=dT(i,c,n);u=W.getInnerMostAxes(u.length,o)}W.assertAxesAreInnerMostDims("max",u,o);let[m,g]=W.computeOutAndReduceShapes(h.shape,u),v=m;s&&(v=W.expandShapeToKeepDim(m,l));let y;if(p){let b=n.texData.get(h.dataId).values,_=xet(b,P.sizeFromShape(g),v,i.dtype);y=n.makeTensorInfo(v,i.dtype);let k=n.texData.get(y.dataId);k.values=_}else y=yst(h,g,v,n);return d&&n.disposeIntermediateTensorInfo(h),y}var vst={kernelName:ff,backendName:"webgl",kernelFunc:Fse},bst=Oz+`
  return max(a, b);
`,wst=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+im+`
  return result;
`,xst=Di({opSnippet:bst,packedOpSnippet:wst,cpuKernelImpl:_et}),_st={kernelName:mf,backendName:"webgl",kernelFunc:xst};function kst(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;qv(i,"maxPool");let{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=r,u=1;P.assert(W.eitherStridesOrDilationsAreOne(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let c=W.computePool2DInfo(i.shape,a,s,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&P.arraysEqual(c.inShape,c.outShape))return vs({inputs:{x:i},backend:n});let d=new m1(c,"max",!1);return n.runWebGLProgram(d,[i],i.dtype)}var Sst={kernelName:gf,backendName:"webgl",kernelFunc:kst};function Cst(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=W.computePool3DInfo(i.shape,a,s,c,o,u,l),p=new Az(d,"max",!1);return n.runWebGLProgram(p,[i],i.dtype)}var Ist={kernelName:lv,backendName:"webgl",kernelFunc:Cst},$st=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,s=i-1-e.padInfo.top,o=a-1-e.padInfo.left,l=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${n}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},Tst=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=o-1-e.padInfo.front,d=l-1-e.padInfo.top,p=u-1-e.padInfo.left,h=o*l*u-1;this.userCode=`
      const ivec3 pads = ivec3(${c}, ${d}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${o};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${n}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${s}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${h} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Nst(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,s=a,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],p=W.computePool3DInfo(s.shape,o,l,d,u,c),h=new Az(p,"max",!0),m=n.runWebGLProgram(h,[s],s.dtype),g=new Tst(p),v=n.runWebGLProgram(g,[i,m],s.dtype);return n.disposeIntermediateTensorInfo(m),v}var Est={kernelName:tw,backendName:"webgl",kernelFunc:Nst};function Ost(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a,output:s}=t,o=a;qv([a,s],"maxPoolGrad");let{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,p=W.computePool2DInfo(o.shape,l,u,1,c,d),h=!0,m=new m1(p,"max",h),g=n.runWebGLProgram(m,[o],o.dtype),v=new $st(p),y=n.runWebGLProgram(v,[i,g],o.dtype);return n.disposeIntermediateTensorInfo(g),y}var Pst={kernelName:ew,backendName:"webgl",kernelFunc:Ost};function Ast(e,t,n,r){let i=new m1(n,"max",!1),a=r.runWebGLProgram(i,[e],"float32");i=new m1(n,"max",!0,!0,t);let s=r.runWebGLProgram(i,[e],"float32");return[a,s]}var Mst={kernelName:nw,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:i,strides:a,pad:s,includeBatchInIndex:o}=t,l=n;P.assert(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);let u=[1,1];P.assert(W.eitherStridesOrDilationsAreOne(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);let c=W.computePool2DInfo(r.shape,i,a,u,s),[d,p]=Ast(r,o,c,l);return[d,p]}};function Rst(e,t,n,r){let i=P.sizeFromShape(t),a=P.sizeFromShape(e.shape)/i,s=Be({inputs:{x:e},attrs:{shape:[a,i]},backend:r}),o=am(s,"float32","mean",r),l=Be({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),l}var Dst={kernelName:yf,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{keepDims:i,axis:a}=t,s=n,o=r.shape.length,l=P.parseAxisParam(a,r.shape),u=l,c=W.getAxesPermutation(u,o),d=c!=null,p=s.shouldExecuteOnCPU([r]),h=[],m=r;if(d){if(p){let _=s.texData.get(m.dataId).values,k=new Array(o);for(let N=0;N<k.length;N++)k[N]=r.shape[c[N]];let C=Nz(_,r.shape,r.dtype,c,k);m=s.makeTensorInfo(k,r.dtype);let $=s.texData.get(m.dataId);$.values=C}else m=dT(r,c,s);h.push(m),u=W.getInnerMostAxes(u.length,o)}W.assertAxesAreInnerMostDims("sum",u,o);let[g,v]=W.computeOutAndReduceShapes(m.shape,u),y=g;i&&(y=W.expandShapeToKeepDim(g,l));let b=Rst(m,v,y,s);for(let _ of h)s.disposeIntermediateTensorInfo(_);return b}};function Lst(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r,o=i.shape.length,l=P.parseAxisParam(a,i.shape),u=l,c=W.getAxesPermutation(u,o),d=i;c!=null&&(d=ya({inputs:{x:i},backend:n,attrs:{perm:c}}),u=W.getInnerMostAxes(u.length,i.shape.length)),W.assertAxesAreInnerMostDims("min",u,o);let[p,h]=W.computeOutAndReduceShapes(d.shape,u),m=P.sizeFromShape(h),g=Be({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),v=am(g,g.dtype,"min",n),y;if(s){let b=W.expandShapeToKeepDim(p,l);y=Be({inputs:{x:v},backend:n,attrs:{shape:b}})}else y=Be({inputs:{x:v},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),y}var Fst={kernelName:vf,backendName:"webgl",kernelFunc:Lst},zst=Oz+`
  return min(a, b);
`,Bst=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+im+`
  return result;
`,Wst=Di({opSnippet:zst,packedOpSnippet:Bst,cpuKernelImpl:ket}),Vst={kernelName:bf,backendName:"webgl",kernelFunc:Wst},jst=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((u,c)=>u[0]+e[c]+u[1]);let r=e.length,i=jn(r),a=t.map(u=>u[0]).join(","),s=t.map((u,c)=>u[0]+e[c]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l=n==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${a};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${s});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${o}));
      }
    `}},Ust=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((h,m)=>h[0]+e[m]+h[1]);let r=e.length,i=jn(r),a=t.map(h=>h[0]).join(","),s=t.map((h,m)=>h[0]+e[m]).join(","),o=ha("rc",r),l=ha("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,c=r===1?"source":`vec2(${l.slice(-2).join()})`,d=n==="reflect"?0:1,p="";if(r===1){let h=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;p=`
        ${i} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${l.join()}), ${c});
        ${o[r-1]} += 1;
        if(${u}) {
          ${h}
          result[1] = getChannel(getX(${l.join()}), ${c});
        }
      `}else{let h=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;p=`
        ${i} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${l.join()}), ${c});
        ${o[r-1]} += 1;
        if(${u}) {
          ${h}
          result[1] = getChannel(getX(${l.join()}), ${c});
        }
        rc = outputLoc;
        ${o[r-2]} += 1;
        if(${o[r-2]} < ${this.outputShape[r-2]}) {
          ${h}
          result[2] = getChannel(getX(${l.join()}), ${c});
          ${o[r-1]} += 1;
          if(${u}) {
            ${h}
            result[3] = getChannel(getX(${l.join()}), ${c});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${s});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}},Hst=({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{paddings:i,mode:a}=n,s=he().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ust(r.shape,i,a):new jst(r.shape,i,a);return t.runWebGLProgram(s,[r],r.dtype)},Gst={kernelName:wf,backendName:"webgl",kernelFunc:Hst},qst=`if (b == 0.0) return NAN;
  return mod(a, b);`,Kst=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+im+`
  return result;
`,Zst=Di({opSnippet:qst,packedOpSnippet:Kst}),Xst={kernelName:xf,backendName:"webgl",kernelFunc:Zst},Jst=class{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}},Yst=`
if (a == b) {
  return 1.0;
};
return a / b;`,Qst=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,zse=Di({opSnippet:Yst,packedOpSnippet:Qst,checkOutOfBounds:!0}),eot={kernelName:Xh,backendName:"webgl",kernelFunc:zse},_H="return a - b;",Bse=Di({opSnippet:_H,packedOpSnippet:_H,supportsComplex:!0,cpuKernelImpl:Het}),tot={kernelName:Gf,backendName:"webgl",kernelFunc:Bse};function Wse(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:a}=r,s=P.parseAxisParam([a],i.shape),o=Fse({inputs:{x:i},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=W.expandShapeToKeepDim(o.shape,s),u=Be({inputs:{x:o},backend:n,attrs:{shape:l}}),c=Bse({inputs:{a:i,b:u},backend:n}),d=Rse({inputs:{x:c},backend:n}),p=pT({inputs:{x:d},backend:n,attrs:{axis:s,keepDims:!1}}),h=Be({inputs:{x:p},backend:n,attrs:{shape:l}}),m=zse({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),m}var not={kernelName:Uf,backendName:"webgl",kernelFunc:Wse};function rot(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:a,seed:s,normalized:o}=r,l=o?i:Wse({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new Jst(u,c,a),p=[[s]],h=n.runWebGLProgram(d,[l],"int32",p);return o||n.disposeIntermediateTensorInfo(l),h}var iot={kernelName:uv,backendName:"webgl",kernelFunc:rot},aot=bo+`
  return -x;
`,sot=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function oot(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){let a=n.texData.get(r.dataId),[s,o]=Iet(a.values,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,s)}let i;return he().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Mc(r.shape,sot):i=new Ol(r.shape,aot),n.runWebGLProgram(i,[r],r.dtype)}var lot={kernelName:cv,backendName:"webgl",kernelFunc:oot},uot=Jl.nonMaxSuppressionV3Impl;function cot(e){W.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r,u=n.readSync(i.dataId),c=n.readSync(a.dataId),{selectedIndices:d}=uot(u,c,s,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}var dot={kernelName:pv,backendName:"webgl",kernelFunc:cot},pot=Jl.nonMaxSuppressionV4Impl;function hot(e){W.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(i.dataId),d=n.readSync(a.dataId),{selectedIndices:p,validOutputs:h}=pot(c,d,s,o,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}var fot={kernelName:hv,backendName:"webgl",kernelFunc:hot},mot=Jl.nonMaxSuppressionV5Impl;function got(e){W.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(i.dataId),d=n.readSync(a.dataId),p=s,h=o,m=l,g=u,{selectedIndices:v,selectedScores:y}=mot(c,d,p,h,m,g);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var yot={kernelName:fv,backendName:"webgl",kernelFunc:got},vot=class{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${n}),
                      float(index == coords.y)));
      }
    `}},bot=e=>{let{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:a,depth:s,onValue:o,offValue:l}=r,u=P.sizeFromShape(i.shape),c=new vot(u,s,o,l),d=Be({inputs:{x:i},backend:n,attrs:{shape:[u]}}),p=n.runWebGLProgram(c,[d],a);n.disposeIntermediateTensorInfo(d);let h=[...i.shape,s],m=Be({inputs:{x:p},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(p),m},wot={kernelName:kf,backendName:"webgl",kernelFunc:bot};function fI(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="complex64"){let i=Hw({inputs:{input:r},backend:n}),a=fI({inputs:{x:i},backend:n}),s=hT({inputs:{input:r},backend:n}),o=fI({inputs:{x:s},backend:n}),l=zd({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return Gw({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}var xot={kernelName:Av,backendName:"webgl",kernelFunc:fI};function Vse(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){let i=Hw({inputs:{input:r},backend:n}),a=Vse({inputs:{x:i},backend:n}),s=hT({inputs:{input:r},backend:n}),o=fI({inputs:{x:s},backend:n}),l=zd({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return Gw({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}var _ot={kernelName:mv,backendName:"webgl",kernelFunc:Vse};function kot(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return iA({inputs:{input:t[0]},backend:n,attrs:{dim:i}});let a=t[0].shape,s=t[0].dtype;t.forEach(c=>{P.assertShapesMatch(a,c.shape,"All tensors passed to stack must have matching shapes"),P.assert(s===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(c=>{let d=iA({inputs:{input:c},backend:n,attrs:{dim:i}});return o.push(d),d}),u=$se({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}var Sot={kernelName:gv,backendName:"webgl",kernelFunc:kot},Cot=class{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((l,u)=>l[0]+e[u]+l[1]);let r=e.length,i=jn(r),a=t.map(l=>l[0]).join(","),s=t.map((l,u)=>l[0]+e[u]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${a};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${s});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${o}));
        }
      }
    `}},Iot=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((m,g)=>m[0]+e[g]+m[1]);let r=e.length,i=jn(r),a=t.map(m=>m[0]).join(","),s=t.map((m,g)=>m[0]+e[g]).join(","),o=ha("rc",r),l=ha("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,c=r===1?"source":`vec2(${l.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${o[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${o[r-2]} += 1;
       if(${o[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${o[r-1]} += 1;
         if(${u}) {`],p=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="";for(let m=0,g=r===1?2:4;m<g;m++)h+=`
        ${d[m]}
        if (${p}) {
          result[${m}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${m}] = getChannel(getX(${l.join()}), ${c});
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${s});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}},jse=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:a,constantValue:s}=r;if(P.sizeFromShape(i.shape)===0){let u=a.map((c,d)=>c[0]+i.shape[d]+c[1]);return Gw({backend:n,attrs:{shape:u,value:s,dtype:i.dtype}})}let o=he().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Iot(i.shape,a,s):new Cot(i.shape,a,s),l=[[s]];return n.runWebGLProgram(o,[i],i.dtype,l)},$ot={kernelName:Sf,backendName:"webgl",kernelFunc:jse},Tot=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Not=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+im+`
  return result;
`,Eot=Di({opSnippet:Tot,packedOpSnippet:Not}),Oot={kernelName:Cf,backendName:"webgl",kernelFunc:Eot};function Pot(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r,o=i.shape.length,l=[],u=P.parseAxisParam(a,i.shape),c=u,d=W.getAxesPermutation(c,o),p=i;d!=null&&(p=ya({inputs:{x:i},backend:n,attrs:{perm:d}}),c=W.getInnerMostAxes(c.length,o),l.push(p)),W.assertAxesAreInnerMostDims("prod",c,o);let h;if(n.shouldExecuteOnCPU([p])){let m=n.texData.get(p.dataId).values,{outVals:g,outShape:v,outDtype:y}=Tet(p.shape,p.dtype,m,c);h=n.makeTensorInfo(v,y,g)}else{let[m,g]=W.computeOutAndReduceShapes(p.shape,c),v=P.sizeFromShape(g),y=Be({inputs:{x:p},backend:n,attrs:{shape:[-1,v]}}),b=s$(i.dtype),_=am(y,b,"prod",n);h=Be({inputs:{x:_},backend:n,attrs:{shape:m}}),l.push(y),l.push(_)}if(s){l.push(h);let m=W.expandShapeToKeepDim(h.shape,u);h=Be({inputs:{x:h},backend:n,attrs:{shape:m}})}return l.forEach(m=>n.disposeIntermediateTensorInfo(m)),h}var Aot={kernelName:$f,backendName:"webgl",kernelFunc:Pot};function Mot(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:a,indices:s}=t,{outputRaggedRank:o}=r,l=i.map(y=>n.readSync(y.dataId)),u=i.map(y=>y.shape),c=n.readSync(a.dataId),d=n.readSync(s.dataId),[p,h,m]=Net(l,u,c,a.shape,a.dtype,d,s.shape,o),g=p.map(y=>n.makeTensorInfo([y.length],"int32",y)),v=n.makeTensorInfo(m,a.dtype,h);return g.concat([v])}var Rot={kernelName:t$,backendName:"webgl",kernelFunc:Mot};function Dot(e){let{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:a}=t,s=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(a.dataId),[u,c]=Eet(s,r.shape,r.dtype,o,i.shape,l,a.shape),d=n.makeTensorInfo([u.length],"int32",u),p=n.makeTensorInfo([c.length],r.dtype,c);return[d,p]}var Lot={kernelName:n$,backendName:"webgl",kernelFunc:Dot};function Fot(e){let{inputs:t,backend:n,attrs:r}=e,{shape:i,values:a,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.readSync(i.dataId),c=n.readSync(a.dataId),d=n.readSync(s.dataId),p=o.map(v=>n.readSync(v.dataId)),h=o.map(v=>v.shape),[m,g]=Oet(u,i.shape,c,a.shape,a.dtype,d,s.shape,p,h,l);return n.makeTensorInfo(m,a.dtype,g)}var zot={kernelName:r$,backendName:"webgl",kernelFunc:Fot},Use=e=>{let{backend:t,attrs:n}=e,{start:r,stop:i,step:a,dtype:s}=n,o=Pet(r,i,a,s);return t.makeTensorInfo([o.length],s,o)},Bot={kernelName:rw,backendName:"webgl",kernelFunc:Use},Wot="return 1.0 / x;",Vot=un({opSnippet:Wot}),jot={kernelName:Tf,backendName:"webgl",kernelFunc:Vot},Uot=bo+`
  return (x < 0.0) ? 0.0 : x;
`,Hot=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Got=un({opSnippet:Uot,packedOpSnippet:Hot}),qot={kernelName:Nf,backendName:"webgl",kernelFunc:Got},Kot=bo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Zot=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Xot=un({opSnippet:Kot,packedOpSnippet:Zot}),Jot={kernelName:Pf,backendName:"webgl",kernelFunc:Xot},Yot=class{constructor(e,t,n,r,i){this.variableNames=["A"],this.outputShape=[];let[a,s,o,l]=e;this.outputShape=[a,t,n,l];let u=[r&&t>1?s-1:s,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],d;i?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/c[0]},
          ${u[1]/c[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}},Qot=class{constructor(e,t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[a,s,o,l]=e;this.outputShape=[a,t,n,l];let u=[r&&t>1?s-1:s,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],d;i?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/c[0]},
          ${u[1]/c[1]},
          ${u[1]/c[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${o}.0,
                                     ${o}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}};function elt(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:s,size:o}=r,[l,u]=o,c=he().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Qot(i.shape,l,u,a,s):new Yot(i.shape,l,u,a,s);return n.runWebGLProgram(c,[i],"float32")}var tlt={kernelName:Of,backendName:"webgl",kernelFunc:elt},nlt=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,i]=t,[,a,s]=e,o=[n&&a>1?r-1:r,n&&s>1?i-1:i],l=[n&&a>1?a-1:a,n&&s>1?s-1:s],u=o[0]/l[0],c=o[1]/l[1],d=1/u,p=1/c,h=Math.ceil(d)*2+2,m=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${c});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${p});

        const int winHeight = int(${h});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function rlt(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:s}=r,o=new nlt(a.shape,i.shape,s);return n.runWebGLProgram(o,[a],a.dtype)}var ilt={kernelName:bv,backendName:"webgl",kernelFunc:rlt},alt=class{constructor(e,t,n,r,i){this.variableNames=["A"],this.outputShape=[];let[a,s,o,l]=e;this.outputShape=[a,t,n,l];let u=[r&&t>1?s-1:s,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0",p;i?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/c[0]},
          ${u[1]/c[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}},slt=class{constructor(e,t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[a,s,o,l]=e;this.outputShape=[a,t,n,l];let u=[r&&t>1?s-1:s,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0",p;i?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/c[0]},
          ${u[1]/c[1]},
          ${u[1]/c[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${o}.0,
                                     ${o}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}};function olt(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:s,size:o}=r,[l,u]=o,c=he().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new slt(i.shape,l,u,a,s):new alt(i.shape,l,u,a,s);return n.runWebGLProgram(c,[i],i.dtype)}var llt={kernelName:Ef,backendName:"webgl",kernelFunc:olt},ult=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,i]=t,[,a,s]=e,o=[n&&a>1?r-1:r,n&&s>1?i-1:i],l=[n&&a>1?a-1:a,n&&s>1?s-1:s],u=o[0]/l[0],c=o[1]/l[1],d=1/u,p=1/c,h=Math.ceil(d)*2+2,m=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${c});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${p});

        const int winHeight = int(${h});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float sourceFracRow =
              float(${o[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${o[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${n} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${n} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function clt(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:s}=r,o=new ult(a.shape,i.shape,s);return n.runWebGLProgram(o,[a],a.dtype)}var dlt={kernelName:vv,backendName:"webgl",kernelFunc:clt},plt=class{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,n===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}let r=s=>t.indexOf(s)!==-1&&e[s]!==1?`${e[s]} - coords[${s}] - 1`:`coords[${s}]`,i=e.map((s,o)=>r(o)).join(","),a=jn(n);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}},hlt=class{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;let r=ha("rc",n),i=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,a=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,s=jn(n);n===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${o(r.slice())};
          if(${i}){
            result.g = ${l(r.slice())};
          }
          if(${a}) {
            result.b = ${u(r.slice())};
            if(${i}) {
              result.a = ${c(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function o(h){return d(h)}function l(h){return h[n-1]="("+h[n-1]+" + 1)",d(h)}function u(h){return h[n-2]="("+h[n-2]+" + 1)",d(h)}function c(h){return h[n-1]="("+h[n-1]+" + 1)",h[n-2]="("+h[n-2]+" + 1)",d(h)}function d(h){let m=e.map((y,b)=>p(b,h)),g=m.join(","),v=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${v}))`}function p(h,m){return t.indexOf(h)!==-1&&e[h]!==1?`${e[h]} - ${m[h]} - 1`:`${m[h]}`}}};function flt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:a}=r,s=i.shape.length,o=P.parseAxisParam(a,i.shape);if(s===0)return vs({inputs:{x:i},backend:n});let l=he().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new hlt(i.shape,o):new plt(i.shape,o);return n.runWebGLProgram(l,[i],i.dtype)}var mlt={kernelName:Af,backendName:"webgl",kernelFunc:flt},glt=class{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],r=e[2];this.outputShape=e;let i="";typeof t=="number"?i=`float outputValue = ${t.toFixed(2)};`:i=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}},ylt={kernelName:Mv,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:i,fillValue:a,center:s}=t,o=n,l=new glt(r.shape,a),[u,c]=W.getImageCenter(s,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(i),Math.cos(i)]];return o.runWebGLProgram(l,[r],r.dtype,d)}},vlt=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,blt=un({opSnippet:vlt}),wlt={kernelName:Mf,backendName:"webgl",kernelFunc:blt},xlt="return inversesqrt(x);",_lt=un({opSnippet:xlt,cpuKernelImpl:Aet}),klt={kernelName:Rf,backendName:"webgl",kernelFunc:_lt},Mz=class{constructor(e,t,n,r,i,a,s=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;let l=jn(i.length),u=jn(a.length),c="";n===1?c="i":n===2&&(c="i, j");let d=`getIndices(${c})`,p="";r===1?p="i":r===2&&(p="i, coords[1]");let h=`getUpdates(${p})`,m="";o&&(m="coords[0], coords[1]");let g=`getDefaultValue(${m})`,v=t>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${v};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${h};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}},Slt=class{constructor(e,t,n,r,i,a,s=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;let l=jn(i.length),u=jn(a.length),c="";n===1?c="i":n===2&&(c="i, j");let d=`getIndices(${c})`,p="";r===1?p="i":r===2&&(p="i, coords[1]");let h=`getUpdates(${p})`,m="";o&&(m="coords[0], coords[1]");let g=`getDefaultValue(${m})`,v=t>1?"strides[j]":"strides",y=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${v};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${h};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}};function Clt(e){let{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:a}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=W.calculateShapes(a,i,s),p=[d/u,u];if(d===0)return n.makeTensorInfo(s,i.dtype);let h=Be({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),m=Be({inputs:{x:a},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0])),v;he().getBool("WEBGL_PACK")?v=new Slt(l,o,h.shape.length,m.shape.length,c,p):v=new Mz(l,o,h.shape.length,m.shape.length,c,p);let y=n.runWebGLProgram(v,[m,h,g],m.dtype),b=Be({inputs:{x:y},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),b}var Ilt={kernelName:wv,backendName:"webgl",kernelFunc:Clt},$lt=class{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];let i="while (left < right) {",a=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,s=he().getNumber("WEBGL_VERSION")===2?i:a,o=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${s}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${o} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}};function Tlt(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:a}=t,{side:s}=r,o=new $lt(i.shape[0],i.shape[1],a.shape[1],s),l=[[i.shape[1]]];return n.runWebGLProgram(o,[i,a],"int32",l)}var Nlt={kernelName:_v,backendName:"webgl",kernelFunc:Tlt},Elt=class{constructor(e,t,n){this.variableNames=["c","a","b"],this.outputShape=t;let r,i;if(n>4)throw Error(`Where for rank ${n} is not yet supported`);if(n===1)i="resRC",r="resRC";else{let s=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],l=[];for(let u=0;u<t.length;u++)l.push(`${s[u]}`),u<e&&o.push(`${s[u]}`);r=o.join(),i=l.join()}let a=jn(n);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}};function Olt(e){let{inputs:t,backend:n}=e,{condition:r,t:i,e:a}=t,s=new Elt(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(s,[r,i,a],Ls(i.dtype,a.dtype))}var Plt={kernelName:kv,backendName:"webgl",kernelFunc:Olt},Alt=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${W.SELU_SCALEALPHA};
  float scale = ${W.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Mlt=un({opSnippet:Alt}),Rlt={kernelName:Df,backendName:"webgl",kernelFunc:Mlt},Dlt=Qv+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Llt=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Flt=un({opSnippet:Dlt,packedOpSnippet:Llt,cpuKernelImpl:Ret}),zlt={kernelName:Bf,backendName:"webgl",kernelFunc:Flt},Blt=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Wlt=un({opSnippet:Blt}),Vlt={kernelName:zf,backendName:"webgl",kernelFunc:Wlt},jlt=Qv+`
  return sin(x);
`,Ult=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${im}
  return result;
`,Hlt=un({opSnippet:jlt,packedOpSnippet:Ult}),Glt={kernelName:Lf,backendName:"webgl",kernelFunc:Hlt},qlt=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Klt=un({opSnippet:qlt}),Zlt={kernelName:Ff,backendName:"webgl",kernelFunc:Klt},Xlt=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Jlt=un({opSnippet:Xlt}),Ylt={kernelName:Wf,backendName:"webgl",kernelFunc:Jlt},Qlt=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,paddings:s}=r;P.assert(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let o=a.reduce((y,b)=>y*b),l=[[0,0]];l.push(...s);for(let y=1+a.length;y<i.shape.length;++y)l.push([0,0]);let u=[],c=jse({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),d=W.getReshaped(c.shape,a,o,!1),p=W.getPermuted(d.length,a.length,!1),h=W.getReshapedPermuted(c.shape,a,o,!1),m=Be({inputs:{x:c},backend:n,attrs:{shape:d}}),g=ya({inputs:{x:m},backend:n,attrs:{perm:p}}),v=Be({inputs:{x:g},backend:n,attrs:{shape:h}});return u.push(c),u.push(m),u.push(g),u.forEach(y=>n.disposeIntermediateTensorInfo(y)),v},eut={kernelName:Cv,backendName:"webgl",kernelFunc:Qlt};function tut(e){let{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:a,defaultValue:s}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);let o=n.readSync(r.dataId),l=n.readSync(i.dataId),u=n.readSync(a.dataId),c=n.readSync(s.dataId)[0],[d,p,h,m,g]=Let(o,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],i.dtype,h),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(v=>Number(v)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}var nut={kernelName:iw,backendName:"webgl",kernelFunc:tut};function rut(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:a}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);let s=Array.from(n.readSync(i.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(a.dataId)),[u,c,d]=Fet(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}var iut={kernelName:$v,backendName:"webgl",kernelFunc:rut};function aut(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);let s=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(a.dataId),[u,c]=pse(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(c,r.dtype,u)}var sut={kernelName:aw,backendName:"webgl",kernelFunc:aut};function out(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);let s=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(a.dataId),[u,c]=pse(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(c,r.dtype,u)}var lut={kernelName:sw,backendName:"webgl",kernelFunc:out};function uut(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:a,defaultValue:s}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=W.calculateShapes(a,i,o),h=!1;if(a.dtype==="string"){let y=n.bufferSync(i),b=n.bufferSync(a),_=P.decodeString(n.readSync(s.dataId)[0]),k=Met(y,b,o,p,c,u,l,d,_,h);return n.makeTensorInfo(o,k.dtype,k.values)}let m=new Mz(u,l,i.shape.length,a.shape.length,d,[p,1],h),g=n.runWebGLProgram(m,[a,i,s],a.dtype),v=Be({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(g),v}var cut={kernelName:Tv,backendName:"webgl",kernelFunc:uut};function dut(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:a,axis:s}=r,o=P.parseAxisParam(s,i.shape)[0],l=W.prepareSplitSize(i,a,o),u=i.shape.length,c=new Array(u).fill(0),d=i.shape.slice();return l.map(p=>{let h=[...d];h[o]=p;let m=e0({inputs:{x:i},backend:n,attrs:{begin:c,size:h}});return c[o]+=p,m})}var put={kernelName:Iv,backendName:"webgl",kernelFunc:dut},kH="return sqrt(x);",hut=un({opSnippet:kH,packedOpSnippet:kH,cpuKernelImpl:zet}),fut={kernelName:Vf,backendName:"webgl",kernelFunc:hut},mut="return x * x;",gut=un({opSnippet:mut}),yut={kernelName:ow,backendName:"webgl",kernelFunc:gut},SH="return (a - b) * (a - b);",vut=Di({opSnippet:SH,packedOpSnippet:SH}),but={kernelName:Hf,backendName:"webgl",kernelFunc:vut};function wut(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");let a=n.readSync(i.dataId),s=W.fromUint8ToStringArray(a),o=Bet(s,"string",r);return n.makeTensorInfo(i.shape,"string",o)}var xut={kernelName:lw,backendName:"webgl",kernelFunc:wut};function _ut({inputs:e,attrs:t,backend:n}){let{x:r}=e,i=bo+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,a=new Ol(r.shape,i);return n.runWebGLProgram(a,[r],r.dtype)}var kut={kernelName:Pd,backendName:"webgl",kernelFunc:_ut},Sut=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let r=n.length,i=jn(n.length),a=jn(n.length),s="";if(r===1)s="coords * strides + begin";else{let o=0;s=n.map((l,u)=>(o++,n.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${o-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${t});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}};function Cut(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,end:s,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:h,finalShape:m,isIdentity:g,sliceDim0:v,isSimpleSlice:y,begin:b,end:_,strides:k}=ei.sliceInfo(i.shape,a,s,o,l,u,c,d,p),C;if(g)C=Be({inputs:{x:i},backend:n,attrs:{shape:m}});else if(v||y){P.assert(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);let N=ei.computeOutShape(b,_,k),A=e0({inputs:{x:i},backend:n,attrs:{begin:b,size:N}});C=Be({inputs:{x:A},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(A)}else if(n.shouldExecuteOnCPU([i])){let N=n.readSync(i.dataId),A=Gt(i.shape,i.dtype,N),D=Wet(h,A,k,b);C=n.makeTensorInfo(m,i.dtype,D.values)}else{let N=new Sut(b,k,h);C=n.runWebGLProgram(N,[i],i.dtype)}let $=Be({inputs:{x:C},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(C),$}var Iut={kernelName:Nv,backendName:"webgl",kernelFunc:Cut};function $ut(e){let{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:a,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=t,p=n.readSync(c.dataId),h=n.readSync(d.dataId),[m,g]=Vet(p,h,i,a,s,o,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",g)]}var Tut={kernelName:uw,backendName:"webgl",kernelFunc:$ut};function Nut(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:a,delimiter:s}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);let o=n.readSync(a.dataId),l=n.readSync(s.dataId)[0],[u,c,d]=jet(o,l,i),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}var Eut={kernelName:cw,backendName:"webgl",kernelFunc:Nut};function Out(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");let s=n.readSync(a.dataId),o=Uet(s,i);return n.makeTensorInfo(a.shape,"int32",o)}var Put={kernelName:dw,backendName:"webgl",kernelFunc:Out},Aut="return tan(x);",Mut=un({opSnippet:Aut}),Rut={kernelName:qf,backendName:"webgl",kernelFunc:Mut},Dut=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Lut=un({opSnippet:Dut}),Fut={kernelName:Kf,backendName:"webgl",kernelFunc:Lut};function zut(e){let{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:a,updates:s}=t,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=W.calculateShapes(s,a,i.shape),p=[d/u,u];if(d===0)return n.makeTensorInfo(i.shape,a.dtype);let h=Be({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),m=Be({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),g=Be({inputs:{x:i},backend:n,attrs:{shape:p}}),v=new Mz(l,o,h.shape.length,m.shape.length,c,p,!1,!0),y=n.runWebGLProgram(v,[m,h,g],g.dtype),b=Be({inputs:{x:y},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),b}var But={kernelName:xv,backendName:"webgl",kernelFunc:zut},Wut=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[a]*t[a];this.outputShape=n,this.rank=n.length;let r=jn(this.rank),i=Vut(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}};function Vut(e){let t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<e.length;i++)r.push(`imod(${n[i]}, ${e[i]})`);return r.join()}function Hse(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:a}=r;if(i.dtype==="string"||i.shape.length>5){let o=n.readSync(i.dataId),l=i.dtype==="string"?o.map(d=>P.decodeString(d)):o,u=Gt(i.shape,i.dtype,l),c=Get(u,a);return n.makeTensorInfo(c.shape,c.dtype,c.values)}let s=new Wut(i.shape,a);return n.runWebGLProgram(s,[i],i.dtype)}var jut={kernelName:Od,backendName:"webgl",kernelFunc:Hse},Uut=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}},Hut=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}};function ip(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function CH(e){let t=1;for(;t<e;)t*=2;return t}function Gut(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:a,sorted:s}=r,o=he().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=he().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=i.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([i])||c<o||a>l){let D=n.readSync(i.dataId),[O,F]=qet(D,u,i.dtype,a,s);return[n.makeTensorInfo(O.shape,O.dtype,O.values),n.makeTensorInfo(F.shape,F.dtype,F.values)]}if(a===0)return u[u.length-1]=0,[n.makeTensorInfo(u,i.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[i,Gw({attrs:{shape:u,dtype:"int32",value:0},backend:n})];let d=n.texData.get(i.dataId),p=d!==null&&d.isPacked,h=p?n.unpackTensor(i):i,m=P.sizeFromShape(u)/c,g=Be({inputs:{x:h},attrs:{shape:[m,c]},backend:n});p&&ip(n,h);let v=CH(a),y=CH(c),b=null,_=()=>b===null?[g,g]:[g,b],k=(D,O,F)=>{let E=_(),z=new Uut(F),q=[[c],[b===null?1:0],[Number.NEGATIVE_INFINITY],[D],[O]],H=b;b=n.runWebGLProgram(z,E,"int32",q),ip(n,H)};for(let D=1;D<v;D*=2){let O=D*2;for(let F=D;F>=1;F/=2)k(O,F,[m,y])}for(let D=y;D>v;D/=2){let O=_(),F=new Hut([m,D/2]),E=[[c],[b===null?1:0],[v]],z=b;b=n.runWebGLProgram(F,O,"int32",E),ip(n,z);let q=v/2,H=q*2;for(let J=q;J>=1;J/=2)k(H,J,b.shape)}let C=b;b=e0({inputs:{x:b},backend:n,attrs:{begin:0,size:[m,a]}}),ip(n,C);let $=Lse({inputs:{x:g,indices:b},backend:n,attrs:{axis:1,batchDims:1}});ip(n,g);let N=u.slice(0,-1);N.push(a),C=b,b=Be({inputs:{x:b},attrs:{shape:N},backend:n}),ip(n,C);let A=$;return $=Be({inputs:{x:$},attrs:{shape:N},backend:n}),ip(n,A),[$,b]}var qut={kernelName:Ev,backendName:"webgl",kernelFunc:Gut},Kut=class{constructor(e,t,n,r,i,a){this.variableNames=["Image","Transforms"],this.outputShape=a;let s=n==="nearest"?1:2,o;switch(r){case"constant":o=1;break;case"reflect":o=2;break;case"wrap":o=3;break;case"nearest":o=4;break;default:o=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${o} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${o} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${o} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${s} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}};function Zut(e){let{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:a}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:u}=r,[c,d,p,h]=i.shape,[m,g]=u!=null?u:[d,p],v=[c,m,g,h],y=new Kut(d,p,s,o,l,v);return n.runWebGLProgram(y,[i,a],"float32")}var Xut={kernelName:Ov,backendName:"webgl",kernelFunc:Zut};function Jut(e){let{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:a}=t;qv(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let s=r.readSync(a.dataId),{outputValues:o,outputShape:l,indices:u}=Ket(s,i,a.shape,a.dtype);return[r.makeTensorInfo(l,a.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}var Yut={kernelName:pw,backendName:"webgl",kernelFunc:Jut};function Qut(e){let{inputs:t,backend:n,attrs:r}=e,{value:i}=t,{axis:a}=r;a<0&&(a+=i.shape.length);let s=i,o=s.shape.length,l=i.shape[a],u=new Array(o-1),c=0;for(let g=0;g<o;g++)g!==a&&(u[c++]=s.shape[g]);let d=[],p=new Array(o).fill(0),h=s.shape.slice();h[a]=1;let m=new Array(l);for(let g=0;g<m.length;g++){p[a]=g;let v=e0({inputs:{x:s},backend:n,attrs:{begin:p,size:h}}),y=Be({inputs:{x:v},backend:n,attrs:{shape:u}});m[g]=y,d.push(v)}return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}var ect={kernelName:Pv,backendName:"webgl",kernelFunc:Qut},tct=class{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,s=a*Math.ceil(i/n);this.outputShape=[r,s];let o="0.0",l="sumValue",u=Math.floor(n/4)*4,c=n%4,d=`
        sumValue += dot(values, segFilter);
    `,p="";i%n>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let h="";i%n>0&&(h=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${o};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${h}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${n}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${c===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${c===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${c===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${l});
      }
    `}};function nct(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:a}=t,{numSegments:s}=r,o=i.shape.length,l=[],u=0,c=W.getAxesPermutation([u],o),d=i;c!=null&&(d=ya({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(d),u=W.getInnerMostAxes(1,o)[0]);let p=W.segment_util.computeOutShape(d.shape,u,s),h=P.sizeFromShape([d.shape[u]]),m=Be({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(m);let g=s$(i.dtype),v=(k,C,$,N,A)=>{let D=k.shape[0],O=k.shape[1],F=W.segment_util.segOpComputeOptimalWindowSize(O,A),E={windowSize:F,inSize:O,batchSize:D,numSegments:A},z=new tct(E,C),q=n.compileAndRun(z,[k,$],N);if(l.push(q),q.shape[1]===A)return q;let H=Use({backend:n,attrs:{start:0,stop:A,step:1,dtype:"float32"}}),J=Hse({inputs:{x:H},backend:n,attrs:{reps:[O/F]}});return l.push(H),l.push(J),v(q,C,J,N,A)},y=v(m,"unsortedSegmentSum",a,g,s),b=Be({inputs:{x:y},backend:n,attrs:{shape:p}}),_=b;if(c!=null){l.push(b);let k=W.getUndoAxesPermutation(c);_=ya({inputs:{x:_},backend:n,attrs:{perm:k}})}return l.forEach(k=>n.disposeIntermediateTensorInfo(k)),_}var rct={kernelName:hw,backendName:"webgl",kernelFunc:nct},ict=[Wtt,jtt,Gtt,Ztt,Jtt,ent,nnt,int,lnt,cnt,hnt,gnt,bnt,knt,Int,Tnt,Ent,Mnt,Dnt,Fnt,Vnt,Znt,Jnt,trt,rrt,urt,drt,mrt,Stt,vrt,krt,$rt,Art,Drt,Frt,Brt,Vrt,Grt,Zrt,Yrt,eit,nit,iit,oit,uit,hit,mit,vit,xit,kit,$it,Oit,Rit,Fit,Wit,Vit,Uit,Git,Kit,Xit,Yit,nat,aat,lat,cat,hat,gat,wat,Sat,ktt,Iat,xrt,Nat,Pat,Rat,Itt,zat,jat,Hat,Zat,Yat,nst,ast,ust,hst,gst,vst,_st,Sst,Ist,Est,Pst,Mst,Dst,Fst,Vst,Gst,Xst,iot,Ntt,lot,dot,fot,yot,art,wot,_ot,Sot,$ot,Oot,Ttt,Aot,Rot,Lot,zot,Bot,srt,eot,jot,qot,Jot,Ott,tlt,ilt,llt,dlt,mlt,ylt,wlt,klt,Ilt,Nlt,Plt,Rlt,zlt,Vlt,Glt,Zlt,qnt,not,Ylt,eut,nut,iut,sut,lut,cut,put,fut,yut,but,xut,kut,Iut,Tut,Eut,Put,tot,Ftt,Rut,Fut,But,jut,qut,Xut,ztt,Yut,ect,rct,xot];for(let e of ict)fw(e);var hn;(function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"})(hn||(hn={}));var y1;(function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"})(y1||(y1={}));var Gse;function act(e){Gse=e.wasm.cwrap(Jp,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])}function sct(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a,bias:s,preluActivationWeights:o}=t;if(i.dtype!=="float32"||a.dtype!=="float32")throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");let{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r,p=n.dataIdMap.get(i.dataId).id,h=n.dataIdMap.get(a.dataId).id,m=0;if(s!=null){let A=n.dataIdMap.get(s.dataId);if(A.shape.length!==1)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${A.shape.length}.`);m=A.id}let g=o==null?0:n.dataIdMap.get(o.dataId).id,v=y1[c];if(v==null)throw new Error(`${c} activation not yet supported for FusedConv2D in the wasm backend.`);let y=l?i.shape[2]:i.shape[1],b=u?a.shape[1]:a.shape[2],_=Rv.assertAndGetBroadcastShape(i.shape.slice(0,-2),a.shape.slice(0,-2)),k=n.makeOutput([..._,y,b],i.dtype),C=n.dataIdMap.get(k.dataId).id,$=new Uint8Array(new Int32Array(i.shape).buffer),N=new Uint8Array(new Int32Array(a.shape).buffer);return Gse(p,$,i.shape.length,h,N,a.shape.length,l,u,v,m,g,d||0,C),k}var oct={kernelName:Jp,backendName:"wasm",setupFunc:act,kernelFunc:sct};function ln(e,t){let n;function r(a){n=a.wasm.cwrap(e,null,["number","number","number"])}function i(a){let{backend:s,inputs:{x:o}}=a,l=s.dataIdMap.get(o.dataId).id,u=s.makeOutput(o.shape,t||o.dtype),c=s.dataIdMap.get(u.dataId).id;return P.sizeFromShape(u.shape)===0||n(l,hn[o.dtype],c),u}return{kernelName:e,backendName:"wasm",setupFunc:r,kernelFunc:i}}var lct=ln(Ay),uct=ln(Eh),cct=ln(Oh);function Ur(e,t,n){let r;function i(s){r=s.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])}function a(s){let{backend:o,inputs:l}=s,{a:u,b:c}=l,d=o.dataIdMap.get(u.dataId).id,p=o.dataIdMap.get(c.dataId).id,h=n!=null?n:u.dtype,m=W.assertAndGetBroadcastShape(u.shape,c.shape),g=o.makeOutput(m,h);if(P.sizeFromShape(m)===0)return g;let v=new Uint8Array(new Int32Array(u.shape).buffer),y=new Uint8Array(new Int32Array(c.shape).buffer),b=o.dataIdMap.get(g.dataId).id;return r(d,v,u.shape.length,p,y,c.shape.length,hn[u.dtype],b),g}return{kernelName:e,backendName:"wasm",setupFunc:i,kernelFunc:a}}var dct=Ur(Nd),qse;function pct(e){qse=e.wasm.cwrap(Ph,null,["array","number","number","number"])}function hct(e){let{inputs:t,backend:n}=e,r=n.makeOutput(t[0].shape,t[0].dtype);if(P.sizeFromShape(r.shape)===0)return r;let i=t.map(o=>n.dataIdMap.get(o.dataId).id),a=new Uint8Array(new Int32Array(i).buffer),s=n.dataIdMap.get(r.dataId).id;return qse(a,i.length,hn[r.dtype],s),r}var fct={kernelName:Ph,backendName:"wasm",setupFunc:pct,kernelFunc:hct};function fT(e){let{inputs:{x:t},backend:n}=e;if(t.dtype==="string")return fa(n.readSync(t.dataId),t.shape,t.dtype);let r=n.makeOutput(t.shape,t.dtype),i=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(r).set(i),r}var mct={kernelName:sf,backendName:"wasm",kernelFunc:fT},Kse;function gct(e){Kse=e.wasm.cwrap(ku,null,["number","array","number","number","number","array","number"])}function yd(e){let{inputs:t,backend:n,attrs:r}=e,[i,a]=vct(t.x.shape,r.perm),s=!0;for(let m=0;m<a.length;m++)a[m]!==m&&(s=!1);let o=yct(t.x.shape,r.perm),l={dataId:t.x.dataId,shape:i,dtype:t.x.dtype};if(s){let m=fT({inputs:t,backend:n});return m.shape=o,m}let u=n.makeOutput(o,l.dtype),c=n.dataIdMap.get(l.dataId).id,d=n.dataIdMap.get(u.dataId).id,p=new Uint8Array(new Int32Array(a).buffer),h=new Uint8Array(new Int32Array(l.shape).buffer);return Kse(c,h,l.shape.length,hn[l.dtype],d,p,a.length),u}function yct(e,t){let n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];return n}function vct(e,t){let n=[],r=[];for(let i=0;i<e.length;++i)e[i]!==1&&n.push(e[i]),e[t[i]]!==1&&r.push(t[i]);for(let i=0;i<r.length;++i){let a=-1;for(let s=0;s<r.length;++s)r[s]>=i&&(a===-1||r[a]>r[s])&&(a=s);r[a]=i}return[n,r]}var bct={kernelName:ku,backendName:"wasm",kernelFunc:yd,setupFunc:gct};function Bd(e,t,n){let r=e.shape,i=e.shape.length,a=P.parseAxisParam(t,r),s=a,o=W.getAxesPermutation(s,i),l=null,u=!1;if(o!=null){let c=new Array(i);for(let p=0;p<c.length;p++)c[p]=r[o[p]];s=W.getInnerMostAxes(s.length,i),l=yd({inputs:{x:e},attrs:{perm:o},backend:n});let d=n.dataIdMap.get(e.dataId).id;n.dataIdMap.get(l.dataId).id!==d&&(u=!0)}return{transposed:l,originalAxes:a,axes:s,inputWasTransposed:u}}var Zse;function wct(e){Zse=e.wasm.cwrap(My,null,["number, number, number"])}function xct(e){let{backend:t,inputs:n,attrs:r}=e,{axis:i,keepDims:a}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:u,axes:c,originalAxes:d,inputWasTransposed:p}=Bd(s,i,t);if(p){let b=t.dataIdMap.get(u.dataId).id;l=u,o=b}let h=l.shape.length;W.assertAxesAreInnerMostDims("all",c,h);let[m,g]=W.computeOutAndReduceShapes(l.shape,c),v=P.sizeFromShape(g),y=t.makeOutput(m,s.dtype);if(P.sizeFromShape(l.shape)!==0){let b=t.dataIdMap.get(y.dataId).id;Zse(o,v,b)}if(p&&t.disposeData(u.dataId),a){let b=W.expandShapeToKeepDim(y.shape,d);y.shape=b}return y}var _ct={kernelName:My,backendName:"wasm",setupFunc:wct,kernelFunc:xct},Xse;function kct(e){Xse=e.wasm.cwrap(Ry,null,["number, number, number"])}function Sct(e){let{backend:t,inputs:n,attrs:r}=e,{axis:i,keepDims:a}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:u,axes:c,originalAxes:d,inputWasTransposed:p}=Bd(s,i,t);if(p){let b=t.dataIdMap.get(u.dataId).id;l=u,o=b}let h=l.shape.length;W.assertAxesAreInnerMostDims("any",c,h);let[m,g]=W.computeOutAndReduceShapes(l.shape,c),v=P.sizeFromShape(g),y=t.makeOutput(m,s.dtype);if(P.sizeFromShape(l.shape)!==0){let b=t.dataIdMap.get(y.dataId).id;Xse(o,v,b)}if(p&&t.disposeData(u.dataId),a){let b=W.expandShapeToKeepDim(y.shape,d);y.shape=b}return y}var Cct={kernelName:Ry,backendName:"wasm",setupFunc:kct,kernelFunc:Sct};function Jse(e){let t;function n(i){t=i.wasm.cwrap(e,null,["number","number","number","number","number"])}function r(i){let{backend:a,inputs:s,attrs:o}=i,{axis:l}=o,{x:u}=s,c=a.dataIdMap.get(u.dataId).id,d=c,p=u,{transposed:h,axes:m,inputWasTransposed:g}=Bd(u,l,a);if(g){let C=a.dataIdMap.get(h.dataId).id;C!==c&&(p=h,d=C)}let v=p.shape.slice(0,-1),y=a.makeOutput(v,"int32"),b=a.dataIdMap.get(y.dataId).id,_=P.sizeFromShape(y.shape),k=p.shape[m[0]];return t(d,hn[p.dtype],_,k,b),g&&a.disposeData(h.dataId),y}return{kernelName:e,backendName:"wasm",setupFunc:n,kernelFunc:r}}var Ict=Jse(Dy),$ct=Jse(Ly),Tct=ln(Ah),Nct=ln(Mh),Ect=ln(Rh),Oct=Ur(Lh),Pct=ln(Dh),Yse;function Act(e){Yse=e.wasm.cwrap(Fh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Mct(e){let{inputs:t,attrs:n,backend:r}=e,i=t.x,a=r.dataIdMap.get(i.dataId).id,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=n,c=W.computePool2DInfo(i.shape,s,o,1,l,u),d=c.filterHeight,p=c.filterWidth,h=c.padInfo.top,m=c.padInfo.right,g=c.padInfo.bottom,v=c.padInfo.left,y=c.strideHeight,b=c.strideWidth,_=c.inChannels;if(c.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${c.dataFormat}'. Please use 'channelsLast'.`);if(c.dilationWidth!==1||c.dilationHeight!==1)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${c.dilationHeight}, ${c.dilationWidth}].`);let k=r.makeOutput(c.outShape,"float32"),C=r.dataIdMap.get(k.dataId).id;return Yse(a,i.shape[0],i.shape[1],i.shape[2],d,p,h,m,g,v,y,b,_,C),k}var Rct={kernelName:Fh,backendName:"wasm",setupFunc:Act,kernelFunc:Mct},Qse;function Dct(e){Qse=e.wasm.cwrap("AvgPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Lct(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r,c=W.computePool3DInfo(i.shape,a,s,1,o,l,u),d=n.makeOutput(c.outShape,i.dtype);return Qse(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),d}var Fct={kernelName:Fy,backendName:"wasm",setupFunc:Dct,kernelFunc:Lct},eoe;function zct(e){eoe=e.wasm.cwrap("AvgPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Bct(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r,c=W.computePool3DInfo(a.shape,s,o,1,l,u),d=n.makeOutput(a.shape,a.dtype);return eoe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left,c.filterDepth,c.filterHeight,c.filterWidth),d}var Wct={kernelName:K1,backendName:"wasm",setupFunc:zct,kernelFunc:Bct},toe;function Vct(e){toe=e.wasm.cwrap("AvgPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function jct(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:s,strides:o,pad:l}=r,u=W.computePool2DInfo(a.shape,s,o,1,l),c=n.makeOutput(a.shape,a.dtype);return toe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left,u.filterHeight,u.filterWidth),c}var Uct={kernelName:q1,backendName:"wasm",setupFunc:Vct,kernelFunc:jct};function Fa(e){let{inputs:t,attrs:n}=e,{x:r}=t,{shape:i}=n,a=P.sizeFromShape(r.shape),s=P.inferFromImplicitShape(i,a);return P.assert(a===P.sizeFromShape(s),()=>`new shape: ${s}, old shape: ${r.shape}. New shape and old shape must have the same number of elements.`),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:s,dtype:r.dtype}}var Hct={kernelName:yv,backendName:"wasm",kernelFunc:Fa},noe;function Gct(e){noe=e.wasm.cwrap(zh,null,["number","array","number","number","array","number","number","number","number"])}function qct(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a}=t,{transposeA:s,transposeB:o}=r;if(i.dtype!=="float32"||a.dtype!=="float32")throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");let l=i.shape.length,u=a.shape.length,c=s?i.shape[l-2]:i.shape[l-1],d=o?a.shape[u-1]:a.shape[u-2],p=s?i.shape[l-1]:i.shape[l-2],h=o?a.shape[u-2]:a.shape[u-1],m=i.shape.slice(0,-2),g=a.shape.slice(0,-2),v=P.sizeFromShape(m),y=P.sizeFromShape(g),b=Rv.assertAndGetBroadcastShape(i.shape.slice(0,-2),a.shape.slice(0,-2)).concat([p,h]);P.assert(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${i.shape} and ${a.shape} and transposeA=${s} and transposeB=${o} must match.`);let _=s?[v,c,p]:[v,p,c],k=o?[y,h,d]:[y,d,h],C=Fa({inputs:{x:i},backend:n,attrs:{shape:_}}),$=Fa({inputs:{x:a},backend:n,attrs:{shape:k}}),N=n.dataIdMap.get(C.dataId).id,A=n.dataIdMap.get($.dataId).id,D=s?C.shape[2]:C.shape[1],O=o?$.shape[1]:$.shape[2],F=Math.max(v,y),E=n.makeOutput([F,D,O],C.dtype),z=n.dataIdMap.get(E.dataId).id,q=new Uint8Array(new Int32Array(C.shape).buffer),H=new Uint8Array(new Int32Array($.shape).buffer);return noe(N,q,C.shape.length,A,H,$.shape.length,s,o,z),n.disposeData(C.dataId),n.disposeData($.dataId),E.shape=b,E}var Kct={kernelName:zh,backendName:"wasm",setupFunc:Gct,kernelFunc:qct};function gh(e){let{inputs:{x:t},attrs:{begin:n,size:r},backend:i}=e,[a,s]=ei.parseSliceParams(t,n,r),o=ei.isSliceContinous(t.shape,a,s),l=i.readSync(t.dataId),u=i.makeOutput(s,t.dtype),c=P.computeStrides(t.shape),d=i.dataIdMap.get(u.dataId);if(o){let m=ei.computeFlatOffset(a,c);return t.dtype==="string"?d.stringBytes=l.slice(m,m+P.sizeFromShape(s)):i.typedArrayFromHeap(u).set(l.subarray(m,m+P.sizeFromShape(s))),u}if(t.dtype==="string"){let m=lI(l,a,s,t.shape,t.dtype);return d.stringBytes=m,u}let p=i.typedArrayFromHeap(u),h=t.shape.length;if(h===2)Zct(l,c[0],p,a,s);else if(h===3)Xct(l,c[0],c[1],p,a,s);else if(h===4)Jct(l,c[0],c[1],c[2],p,a,s);else{let m=lI(l,a,s,t.shape,t.dtype);p.set(m)}return u}function Zct(e,t,n,r,i){let a=0,s=r[0],o=r[1],l=s+i[0];for(let u=s;u<l;u++){let c=u*t+o;n.set(e.subarray(c,c+i[1]),a),a+=i[1]}}function Xct(e,t,n,r,i,a){let s=0,o=i[0],l=i[1],u=i[2],c=o+a[0],d=l+a[1];for(let p=o;p<c;p++)for(let h=l;h<d;h++){let m=p*t+h*n+u;r.set(e.subarray(m,m+a[2]),s),s+=a[2]}}function Jct(e,t,n,r,i,a,s){let o=0,l=a[0],u=a[1],c=a[2],d=l+s[0],p=u+s[1],h=c+s[2],m=a[3];for(let g=l;g<d;g++)for(let v=u;v<p;v++)for(let y=c;y<h;y++){let b=g*t+v*n+y*r+m;i.set(e.subarray(b,b+s[3]),o),o+=s[3]}}var Yct={kernelName:Sv,backendName:"wasm",kernelFunc:gh};function Qct(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,crops:s}=r,o=a.reduce((y,b)=>y*b),l=W.getReshaped(i.shape,a,o),u=W.getPermuted(l.length,a.length),c=W.getReshapedPermuted(i.shape,a,o),d=W.getSliceBeginCoords(s,a.length),p=W.getSliceSize(c,s,a.length),h=Fa({inputs:{x:i},backend:n,attrs:{shape:l}}),m=yd({inputs:{x:h},backend:n,attrs:{perm:u}}),g=Fa({inputs:{x:m},backend:n,attrs:{shape:c}}),v=gh({inputs:{x:g},backend:n,attrs:{begin:d,size:p}});return n.disposeData(h.dataId),n.disposeData(m.dataId),n.disposeData(g.dataId),v}var edt={kernelName:zy,backendName:"wasm",kernelFunc:Qct},roe;function tdt(e){roe=e.wasm.cwrap(By,null,["number","number","boolean","number","number","number"])}function ndt(e){let{backend:t,inputs:n,attrs:r}=e,{x:i,weights:a}=n,{size:s}=r,o=a.shape.reduce((d,p)=>d*p,1)!==0,l=i.shape.length===1?[s]:[i.shape[0],s],u=t.makeOutput(l,a.dtype);function c(d){return t.dataIdMap.get(d.dataId).id}return roe(c(i),s,o,c(a),hn[a.dtype],c(u)),u}var rdt={kernelName:By,backendName:"wasm",setupFunc:tdt,kernelFunc:ndt},idt=Ur(Wy);function adt(e){let{inputs:t,backend:n}=e,{s0:r,s1:i}=t,a=n.typedArrayFromHeap(r),s=n.typedArrayFromHeap(i),o=W.assertAndGetBroadcastShape(Array.from(a),Array.from(s));return n.makeOutput([o.length],"int32",void 0,new Int32Array(o))}var sdt={kernelName:Z1,backendName:"wasm",kernelFunc:adt};function Wd(e){let{inputs:{x:t},attrs:{dtype:n},backend:r}=e,i=r.makeOutput(t.shape,n),a=r.typedArrayFromHeap(t);return r.typedArrayFromHeap(i).set(a),i}var odt={kernelName:Bh,backendName:"wasm",kernelFunc:Wd},ldt=ln(Wh),ioe;function udt(e){ioe=e.wasm.cwrap(Ed,null,["number","number","number","number"])}function cdt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:a,clipValueMax:s}=r,o=n.dataIdMap.get(i.dataId).id,l=n.makeOutput(i.shape,i.dtype),u=n.dataIdMap.get(l.dataId).id;return ioe(o,a,s,u),l}var ddt={kernelName:Ed,backendName:"wasm",setupFunc:udt,kernelFunc:cdt};function aoe(e){let{inputs:t,backend:n}=e,r=P.parseAxisParam(e.attrs.axis,t[0].shape)[0],i=t.map(h=>h.shape);W.assertParamsConsistent(i,r);let a=W.computeOutShape(t.map(h=>h.shape),r),s=t.filter(h=>P.sizeFromShape(h.shape)>0);if(s.length===1)return fT({inputs:{x:s[0]},backend:n});let o=n.makeOutput(a,t[0].dtype);if(P.sizeFromShape(a)===0)return o;if(s[0].dtype==="string"){let h=s.map(_=>{let k=[-1,P.sizeFromShape(_.shape.slice(r))];return Fa({inputs:{x:_},backend:n,attrs:{shape:k}})}),m=h.map(_=>({vals:n.readSync(_.dataId),shape:_.shape}));a=W.computeOutShape(h.map(_=>_.shape),1);let g=h[0].shape[0]===1,v=sz(m,a,t[0].dtype,g),y=W.computeOutShape(s.map(_=>_.shape),r);o.shape=y;let b=n.dataIdMap.get(o.dataId);return b.stringBytes=W.fromStringArrayToUint8(v),h.forEach(_=>n.disposeData(_.dataId)),o}let l=P.sizeFromShape(s[0].shape.slice(0,r)),u=0,c=s.map(h=>{let m=P.sizeFromShape(h.shape.slice(r));return u+=m,m}),d=s.map(h=>n.typedArrayFromHeap(h)),p=n.typedArrayFromHeap(o);for(let h=0;h<l;h++){let m=h*u;for(let g=0;g<d.length;g++){let v=c[g],y=h*v,b=d[g].subarray(y,y+v);p.set(b,m),m+=v}}return o}var pdt={kernelName:Vy,backendName:"wasm",kernelFunc:aoe},soe;function hdt(e){soe=e.wasm.cwrap(Vh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function fdt(e){let{inputs:t,attrs:n,backend:r}=e,{x:i,filter:a}=t,s=r.dataIdMap.get(i.dataId).id,o=r.dataIdMap.get(a.dataId).id,{strides:l,dilations:u,pad:c,dimRoundingMode:d,dataFormat:p}=n,h=W.convertConv2DDataFormat(p),m=W.computeConv2DInfo(i.shape,a.shape,l,u,c,d,!1,h),g=m.filterHeight,v=m.filterWidth,y=m.padInfo.top,b=m.padInfo.right,_=m.padInfo.bottom,k=m.padInfo.left,C=m.dilationHeight,$=m.dilationWidth,N=m.strideHeight,A=m.strideWidth,D=m.inChannels,O=m.outChannels,F=m.padInfo.type==="SAME"?1:0;if(m.dataFormat!=="channelsLast")throw new Error(`wasm backend Conv2D does not support dataFormat:'${m.dataFormat}'. Please use 'channelsLast'.`);let E=r.makeOutput(m.outShape,"float32"),z=r.dataIdMap.get(E.dataId).id;return soe(s,i.shape[0],i.shape[1],i.shape[2],o,g,v,y,b,_,k,F,C,$,N,A,D,O,z),E}var mdt={kernelName:Vh,backendName:"wasm",setupFunc:hdt,kernelFunc:fdt},ooe;function gdt(e){ooe=e.wasm.cwrap(jh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function ydt(e){let{backend:t,inputs:n,attrs:r}=e,{dy:i,filter:a}=n,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,inputShape:c}=r,d=1,p=W.convertConv2DDataFormat(l),h=W.computeConv2DInfo(c,a.shape,s,d,o,u,!1,p),{batchSize:m,filterHeight:g,filterWidth:v,inChannels:y,inHeight:b,inWidth:_,outChannels:k,outHeight:C,outWidth:$,strideHeight:N,strideWidth:A}=h,D=g-1-h.padInfo.top,O=v-1-h.padInfo.left,F=h.dataFormat==="channelsLast",E=P.computeStrides(h.inShape),z=P.computeStrides(i.shape),[q,H,J]=P.computeStrides(a.shape),ee=E[0],V=F?E[1]:E[2],Q=F?E[2]:1,X=F?1:E[1],Y=z[0],ce=F?z[1]:z[2],pe=F?z[2]:1,fe=F?1:z[1],ye=t.makeOutput(h.inShape,"float32"),_e=t.dataIdMap.get(ye.dataId).id,Ee=t.dataIdMap.get(i.dataId).id,Se=t.dataIdMap.get(a.dataId).id;return ooe(Ee,Se,m,g,v,b,_,y,C,$,k,N,A,D,O,q,H,J,ee,V,Q,X,Y,ce,pe,fe,_e),ye}var vdt={kernelName:jh,backendName:"wasm",setupFunc:gdt,kernelFunc:ydt},loe;function bdt(e){loe=e.wasm.cwrap(Uh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function wdt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l}=r;if(i.dtype!=="float32")throw new Error(`Tensor x must have dtype float32, got ${i.dtype}`);if(a.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${a.dtype}`);let u=W.computeConv3DInfo(i.shape,a.shape,s,l,o),c=n.makeOutput(u.outShape,i.dtype);return loe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),c}var xdt={kernelName:Uh,backendName:"wasm",setupFunc:bdt,kernelFunc:wdt},uoe;function _dt(e){uoe=e.wasm.cwrap(jy,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function kdt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:o,filterShape:l}=r;if(i.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${i.dtype}`);if(a.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${a.dtype}`);let u=W.computeConv3DInfo(i.shape,l,s,1,o),c=n.makeOutput(u.filterShape,a.dtype);return uoe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),c}var Sdt={kernelName:jy,backendName:"wasm",setupFunc:_dt,kernelFunc:kdt},coe;function Cdt(e){coe=e.wasm.cwrap(Uy,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Idt(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{pad:s,strides:o,inputShape:l}=r;if(i.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${i.dtype}`);if(a.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${a.dtype}`);let u=W.computeConv3DInfo(l,a.shape,o,1,s),c=n.makeOutput(u.inShape,i.dtype);return coe(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),c}var $dt={kernelName:Uy,backendName:"wasm",setupFunc:Cdt,kernelFunc:Idt},Tdt=ln(Hh),Ndt=ln(Gh),aA;(function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"})(aA||(aA={}));var doe;function Edt(e){doe=e.wasm.cwrap(Gy,null,["number","number","number","number","array","number","number","number","number","number"])}function Odt(e){let{backend:t,inputs:n,attrs:r}=e,{method:i,extrapolationValue:a,cropSize:s}=r,{image:o,boxes:l,boxInd:u}=n,c=l.shape[0],[d,p]=s,h=[c,d,p,o.shape[3]],m=t.dataIdMap.get(o.dataId),g;o.dtype!=="float32"&&(g=Wd({backend:t,inputs:{x:o},attrs:{dtype:"float32"}}),m=t.dataIdMap.get(g.dataId));let v=m.id,y=t.dataIdMap.get(l.dataId).id,b=t.dataIdMap.get(u.dataId).id,_=t.makeOutput(h,"float32"),k=t.dataIdMap.get(_.dataId).id,C=new Uint8Array(new Int32Array(o.shape).buffer);return doe(v,y,b,c,C,d,p,aA[i],a,k),g!=null&&t.disposeData(g.dataId),_}var Pdt={kernelName:Gy,backendName:"wasm",setupFunc:Edt,kernelFunc:Odt},poe;function Adt(e){poe=e.wasm.cwrap(Hy,null,["number","number","number","number","number","number"])}function Mdt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:s,reverse:o}=r,l=i.shape.length;P.assert(i.dtype==="float32"||i.dtype==="int32",()=>`cumprod does not support ${i.dtype} tensors in the WASM backend`);let u=W.getAxesPermutation([a],l),c=i;u!==null&&(c=yd({inputs:{x:i},attrs:{perm:u},backend:n}));let d=W.getInnerMostAxes(1,l)[0];W.assertAxesAreInnerMostDims("cumprod",[d],l);let p=n.makeOutput(c.shape,c.dtype),h=c.shape[d],m=n.dataIdMap.get(c.dataId).id,g=n.dataIdMap.get(p.dataId).id;poe(m,s?1:0,o?1:0,h,g,hn[i.dtype]);let v=p;if(u!==null){let y=W.getUndoAxesPermutation(u);v=yd({inputs:{x:p},attrs:{perm:y},backend:n}),n.disposeData(c.dataId),n.disposeData(p.dataId)}return v}var Rdt={kernelName:Hy,backendName:"wasm",setupFunc:Adt,kernelFunc:Mdt},hoe;function Ddt(e){hoe=e.wasm.cwrap(qh,null,["number","number","number","number","number","number"])}function Ldt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:s,reverse:o}=r,l=i.shape.length;P.assert(i.dtype==="float32"||i.dtype==="int32",()=>`cumsum does not support ${i.dtype} tensors in the WASM backend`);let u=W.getAxesPermutation([a],l),c=i;u!==null&&(c=yd({inputs:{x:i},attrs:{perm:u},backend:n}));let d=W.getInnerMostAxes(1,l)[0];W.assertAxesAreInnerMostDims("cumsum",[d],l);let p=n.makeOutput(c.shape,c.dtype),h=c.shape[d],m=n.dataIdMap.get(c.dataId).id,g=n.dataIdMap.get(p.dataId).id;hoe(m,s?1:0,o?1:0,h,g,hn[i.dtype]);let v=p;if(u!==null){let y=W.getUndoAxesPermutation(u);v=yd({inputs:{x:p},attrs:{perm:y},backend:n}),n.disposeData(c.dataId),n.disposeData(p.dataId)}return v}var Fdt={kernelName:qh,backendName:"wasm",setupFunc:Ddt,kernelFunc:Ldt},foe;function zdt(e){foe=e.wasm.cwrap("DenseBincount",null,["number","array","number","number","boolean","number","number","boolean","number"])}function Bdt(e){let{backend:t,inputs:n,attrs:r}=e,{x:i,weights:a}=n,{size:s,binaryOutput:o}=r,l=a.shape.reduce((p,h)=>p*h,1)!==0,u=i.shape.length===1?[s]:[i.shape[0],s],c=t.makeOutput(u,a.dtype);function d(p){return t.dataIdMap.get(p.dataId).id}return foe(d(i),new Uint8Array(new Int32Array(i.shape).buffer),i.shape.length,s,l,d(a),hn[a.dtype],o,d(c)),c}var Wdt={kernelName:J1,backendName:"wasm",setupFunc:zdt,kernelFunc:Bdt},moe;function Vdt(e){moe=e.wasm.cwrap(qy,null,["number","number","number","array","number","array","array","number","number"])}function jdt(e){let{backend:t,inputs:n,attrs:r}=e,{x:i}=n,{blockSize:a,dataFormat:s}=r,o=i.shape[0],l=s==="NHWC"?i.shape[1]:i.shape[2],u=s==="NHWC"?i.shape[2]:i.shape[3],c=s==="NHWC"?i.shape[3]:i.shape[1],d=l*a,p=u*a,h=c/(a*a),m=s==="NHWC"?[o,d,p,h]:[o,h,d,p],g=t.makeOutput(m,"float32"),v=t.dataIdMap.get(i.dataId).id,y=new Uint8Array(new Int32Array(P.computeStrides(i.shape)).buffer),b=new Uint8Array(new Int32Array(m).buffer),_=new Uint8Array(new Int32Array(P.computeStrides(m)).buffer),k=t.dataIdMap.get(g.dataId).id;return moe(v,a,s==="NHWC"?1:0,y,i.shape.length-1,b,_,m.length,k),g}var Udt={kernelName:qy,backendName:"wasm",setupFunc:Vdt,kernelFunc:jdt},goe;function Hdt(e){goe=e.wasm.cwrap(Kh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Gdt(e){let{inputs:t,attrs:n,backend:r}=e,{x:i,filter:a}=t,s=r.dataIdMap.get(i.dataId).id,o=r.dataIdMap.get(a.dataId).id,{strides:l,dilations:u,pad:c,dimRoundingMode:d}=n,p=u==null?[1,1]:u,h=W.computeConv2DInfo(i.shape,a.shape,l,p,c,d,!0),m=h.filterHeight,g=h.filterWidth,v=h.padInfo.top,y=h.padInfo.right,b=h.padInfo.bottom,_=h.padInfo.left,k=h.dilationHeight,C=h.dilationWidth,$=h.strideHeight,N=h.strideWidth,A=h.inChannels,D=h.outChannels,O=h.padInfo.type==="SAME"?1:0;if(h.dataFormat!=="channelsLast")throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${h.dataFormat}'. Please use 'channelsLast'.`);let F=r.makeOutput(h.outShape,"float32"),E=r.dataIdMap.get(F.dataId).id;return goe(s,i.shape[0],i.shape[1],i.shape[2],o,m,g,v,y,b,_,O,k,C,$,N,A,D,E),F}var qdt={kernelName:Kh,backendName:"wasm",setupFunc:Hdt,kernelFunc:Gdt},yoe;function Kdt(e){yoe=e.wasm.cwrap("Diag",null,["number","number","number","number"])}function Zdt(e){let{inputs:t,backend:n}=e,{x:r}=t,i=P.sizeFromShape(r.shape),a=n.makeOutput([...r.shape,...r.shape],r.dtype);return yoe(n.dataIdMap.get(r.dataId).id,hn[r.dtype],i,n.dataIdMap.get(a.dataId).id),a}var Xdt={kernelName:Y1,backendName:"wasm",setupFunc:Kdt,kernelFunc:Zdt},voe;function Jdt(e){voe=e.wasm.cwrap(Zh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Ydt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l}=r;if(i.dtype!==a.dtype)throw new Error(`Dilation2D error: x must have the same dtype as filter. Got ${i.dtype} and ${a.dtype}`);let u=W.computeDilation2DInfo(i.shape,a.shape,s,o,"NHWC",l),c=n.makeOutput(u.outShape,i.dtype);return voe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,hn[i.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),c}var Qdt={kernelName:Zh,backendName:"wasm",setupFunc:Jdt,kernelFunc:Ydt},boe;function ept(e){boe=e.wasm.cwrap(Jg,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function tpt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,dy:s}=t,{strides:o,pad:l,dilations:u}=r;if(i.dtype!==a.dtype||i.dtype!==s.dtype)throw new Error(`Dilation2DBackpropFilter error: x must have the same dtype as filter and dy. Got ${i.dtype}, ${a.dtype}, and ${s.dtype}`);let c=W.computeDilation2DInfo(i.shape,a.shape,o,l,"NHWC",u),d=n.makeOutput(a.shape,a.dtype);return boe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,hn[i.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),d}var npt={kernelName:Jg,backendName:"wasm",setupFunc:ept,kernelFunc:tpt},woe;function rpt(e){woe=e.wasm.cwrap(Xg,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function ipt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,dy:s}=t,{strides:o,pad:l,dilations:u}=r;if(i.dtype!==a.dtype||i.dtype!==s.dtype)throw new Error(`Dilation2DBackpropInput error: x must have the same dtype as filter and dy. Got ${i.dtype}, ${a.dtype}, and ${s.dtype}`);let c=W.computeDilation2DInfo(i.shape,a.shape,o,l,"NHWC",u),d=n.makeOutput(i.shape,i.dtype);return woe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,hn[i.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),d}var apt={kernelName:Xg,backendName:"wasm",setupFunc:rpt,kernelFunc:ipt},spt=ln(Jh),xoe;function opt(e){xoe=e.wasm.cwrap(Ky,null,["number","number","number"])}function lpt(e){let{inputs:t,backend:n}=e,{dy:r,y:i}=t,a=n.makeOutput(i.shape,"float32"),s=o=>n.dataIdMap.get(o.dataId).id;return xoe(s(i),s(r),s(a)),a}var upt={kernelName:Ky,backendName:"wasm",setupFunc:opt,kernelFunc:lpt},cpt=!1,dpt=Ur(Zy,cpt,"bool"),ppt=ln(Yh),hpt=ln(Qh,"float32");function sA(e){let{inputs:t,attrs:n,backend:r}=e,{input:i}=t,{dim:a}=n,s=i.shape.length,o=i.shape.slice(),l=a;return a<0&&(P.assert(-(s+1)<=a,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+a+1),o.splice(l,0,1),Fa({inputs:{x:i},backend:r,attrs:{shape:o}})}var fpt={kernelName:Xy,backendName:"wasm",kernelFunc:sA},mpt=ln(ef,"float32");function _oe(e){let{attrs:{shape:t,value:n},backend:r}=e,{attrs:{dtype:i}}=e;i=i||P.inferDtype(n);let a=r.makeOutput(t,i);return r.typedArrayFromHeap(a).fill(n),a}var gpt={kernelName:Q1,backendName:"wasm",kernelFunc:_oe},koe;function ypt(e){koe=e.wasm.cwrap(Jy,null,["number","number","number","number","number","number"])}function vpt(e){let{inputs:t,backend:n}=e,{image:r}=t,i=n.makeOutput(r.shape,r.dtype),a=n.dataIdMap.get(r.dataId).id,s=n.dataIdMap.get(i.dataId).id,[o,l,u,c]=r.shape;return koe(a,o,l,u,c,s),i}var bpt={kernelName:Jy,backendName:"wasm",kernelFunc:vpt,setupFunc:ypt},wpt=ln(tf),xpt=Ur(nf),Soe;function _pt(e){Soe=e.wasm.cwrap(rf,null,["number","number","number","number","number","number","number"])}function kpt(e){let{backend:t,inputs:n,attrs:r}=e,{varianceEpsilon:i}=r,{x:a,mean:s,variance:o,offset:l,scale:u}=n,c=t.dataIdMap.get(a.dataId).id,d=t.dataIdMap.get(s.dataId).id,p=t.dataIdMap.get(o.dataId).id,h=l!=null?t.dataIdMap.get(l.dataId).id:0,m=u!=null?t.dataIdMap.get(u.dataId).id:0,g=t.makeOutput(a.shape,a.dtype);if(P.sizeFromShape(a.shape)===0)return g;let v=t.dataIdMap.get(g.dataId).id;return Soe(c,d,p,h,m,i,v),g}var Spt={kernelName:rf,backendName:"wasm",setupFunc:_pt,kernelFunc:kpt},Coe;function Cpt(e){Coe=e.wasm.cwrap(Yp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Ipt(e){let{inputs:t,attrs:n,backend:r}=e,{x:i,filter:a,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:c,dataFormat:d,dimRoundingMode:p,activation:h,leakyreluAlpha:m}=n,g=W.computeConv2DInfo(i.shape,a.shape,l,c,u,p),v=y1[h];if(v==null)throw new Error(`${h} activation not yet supported for FusedConv2D in the wasm backend.`);let y=r.dataIdMap.get(i.dataId).id,b=r.dataIdMap.get(a.dataId).id,_=g.outChannels,k=0;if(s!=null){let pe=r.dataIdMap.get(s.dataId);if(pe.shape.length!==1)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${pe.shape.length}.`);if(pe.shape[0]!==_)throw new Error(`FusedConv2D bias shape (${pe.shape}) does not match the number of output channels (${_})`);k=pe.id}let C=g.filterHeight,$=g.filterWidth,N=g.padInfo.top,A=g.padInfo.right,D=g.padInfo.bottom,O=g.padInfo.left,F=g.dilationHeight,E=g.dilationWidth,z=g.strideHeight,q=g.strideWidth,H=g.inChannels,J=g.padInfo.type==="SAME"?1:0,ee=g.batchSize,V=g.inHeight,Q=g.inWidth;if(d!=="NHWC")throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${d}'. Please use 'NHWC'.`);let X=r.makeOutput(g.outShape,"float32"),Y=r.dataIdMap.get(X.dataId).id,ce=o==null?0:r.dataIdMap.get(o.dataId).id;return Coe(y,ee,V,Q,b,C,$,k,N,A,D,O,J,F,E,z,q,H,_,v,ce,m||0,Y),X}var $pt={kernelName:Yp,backendName:"wasm",setupFunc:Cpt,kernelFunc:Ipt},Ioe;function Tpt(e){Ioe=e.wasm.cwrap(Qp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Npt(e){let{inputs:t,attrs:n,backend:r}=e,{x:i,filter:a,bias:s,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:c,dataFormat:d,dimRoundingMode:p,activation:h,leakyreluAlpha:m}=n,g=W.computeConv2DInfo(i.shape,a.shape,l,c,u,p,!0),v=y1[h];if(v==null)throw new Error(`${h} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);let y=r.dataIdMap.get(i.dataId).id,b=r.dataIdMap.get(a.dataId).id,_=g.outChannels,k=0;if(s!=null){let pe=r.dataIdMap.get(s.dataId);if(pe.shape.length!==1)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${pe.shape.length}.`);if(pe.shape[0]!==_)throw new Error(`FusedDepthwiseConv2D bias shape (${pe.shape}) does not match the number of output channels (${_})`);k=pe.id}let C=g.filterHeight,$=g.filterWidth,N=g.padInfo.top,A=g.padInfo.right,D=g.padInfo.bottom,O=g.padInfo.left,F=g.dilationHeight,E=g.dilationWidth,z=g.strideHeight,q=g.strideWidth,H=g.inChannels,J=g.padInfo.type==="SAME"?1:0,ee=g.batchSize,V=g.inHeight,Q=g.inWidth;if(d!=="NHWC")throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${d}'. Please use 'NHWC'.`);let X=r.makeOutput(g.outShape,"float32"),Y=r.dataIdMap.get(X.dataId).id,ce=o==null?0:r.dataIdMap.get(o.dataId).id;return Ioe(y,ee,V,Q,b,C,$,k,N,A,D,O,J,F,E,z,q,H,_,v,ce,m||0,Y),X}var Ept={kernelName:Qp,backendName:"wasm",setupFunc:Tpt,kernelFunc:Npt},$oe;function Opt(e){$oe=e.wasm.cwrap(Qy,null,["number","number","number","number","number","number","array","number"])}function Ppt(e){let{backend:t,inputs:n}=e,{params:r,indices:i}=n,[a,s,o,l]=vL.prepareAndValidate(r,i),u=t.makeOutput(a,r.dtype);if(s===0)return u;let c=i.shape,d=c[c.length-1],p=t.dataIdMap.get(r.dataId).id,h=t.dataIdMap.get(i.dataId).id,m=new Uint8Array(new Int32Array(l).buffer),g=t.dataIdMap.get(u.dataId).id;return $oe(p,hn[r.dtype],h,s,d,o,m,g),u}var Apt={kernelName:Qy,backendName:"wasm",setupFunc:Opt,kernelFunc:Ppt},Toe;function Mpt(e){Toe=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])}function Rpt(e){let{backend:t,inputs:n,attrs:r}=e,{x:i,indices:a}=n,{axis:s,batchDims:o}=r,l=P.parseAxisParam(s,i.shape)[0],u=t.readSync(a.dataId),c=i.shape[l];for(let N=0;N<u.length;++N){let A=u[N];P.assert(A<=c-1&&A>=0,()=>`GatherV2: the index value ${A} is not in [0, ${c-1}]`)}let d=W.segment_util.collectGatherOpShapeInfo(i,a,l,o),p=Fa({inputs:{x:i},attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]},backend:t}),h=P.sizeFromShape(a.shape),m=Fa({inputs:{x:a},attrs:{shape:[d.batchSize,h/d.batchSize]},backend:t}),g=[d.batchSize,d.outerSize,h/d.batchSize,d.sliceSize],v=t.makeOutput(g,i.dtype);if(P.sizeFromShape(i.shape)===0)return v;let y=p.shape.length-1,b=t.dataIdMap.get(p.dataId).id,_=t.dataIdMap.get(m.dataId).id,k=t.dataIdMap.get(v.dataId).id,C=new Uint8Array(new Int32Array(P.computeStrides(p.shape)).buffer),$=new Uint8Array(new Int32Array(P.computeStrides(g)).buffer);return Toe(b,hn[i.dtype],C,y,_,d.batchSize,$,k),t.disposeData(p.dataId),t.disposeData(m.dataId),v.shape=d.outputShape,v}var Dpt={kernelName:Yy,backendName:"wasm",setupFunc:Mpt,kernelFunc:Rpt},Lpt=!1,Fpt=Ur(ev,Lpt,"bool"),zpt=!1,Bpt=Ur(af,zpt,"bool"),Wpt=ln(of,"bool"),Vpt=ln(lf,"bool"),jpt=ln(uf,"bool"),Noe;function Upt(e){Noe=e.wasm.cwrap(cf,null,["number","number","number","number"])}function Hpt(e){let{inputs:{x:t},attrs:{alpha:n},backend:r}=e,i=r.dataIdMap.get(t.dataId).id,a=r.makeOutput(t.shape,"float32");if(P.sizeFromShape(t.shape)!==0){let s=r.dataIdMap.get(a.dataId).id;Noe(i,hn[t.dtype],n,s)}return a}var Gpt={kernelName:cf,backendName:"wasm",setupFunc:Upt,kernelFunc:Hpt},qpt=!1,Kpt=Ur(tv,qpt,"bool"),Zpt=!1,Xpt=Ur(nv,Zpt,"bool"),Eoe;function Jpt(e){Eoe=e.wasm.cwrap(rv,null,["number","number","number","number"])}function Ypt(e){let{attrs:t,backend:n}=e,{start:r,stop:i,num:a}=t,s=Math.floor(a),o=n.makeOutput([s],"float32");return Eoe(n.dataIdMap.get(o.dataId).id,r,i,s),o}var Qpt={kernelName:rv,backendName:"wasm",setupFunc:Jpt,kernelFunc:Ypt},eht=ln(df),tht=ln(pf),nht=!1,rht=Ur(iv,nht,"bool"),iht=ln(av),aht=!1,sht=Ur(sv,aht,"bool"),oht=!1,lht=Ur(OQ,oht,"bool"),Ooe;function uht(e){Ooe=e.wasm.cwrap(hf,null,["number","number","number","number","number","number","number"])}function cht(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:a,bias:s,alpha:o,beta:l}=r;if(i.dtype!=="float32")throw new Error("LRN error: x must have dtype float32");let u=n.makeOutput(i.shape,i.dtype);return Ooe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(u.dataId).id,i.shape[3],a,s,o,l),u}var dht={kernelName:hf,backendName:"wasm",setupFunc:uht,kernelFunc:cht},Poe;function pht(e){Poe=e.wasm.cwrap(ov,null,["number","number","number","number","number","number","number","number","number"])}function hht(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,y:a,dy:s}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=r;if(i.dtype!=="float32"||a.dtype!=="float32"||s.dtype!=="float32")throw new Error("LRNGrad error: x, y, and dy must have dtype float32");let d=n.makeOutput(i.shape,i.dtype);return Poe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,s.shape[3],o,l,u,c),d}var fht={kernelName:ov,backendName:"wasm",setupFunc:pht,kernelFunc:hht},Aoe;function mht(e){Aoe=e.wasm.cwrap(ff,null,["number","number","number","number"])}function ght(e){let{backend:t,inputs:n,attrs:r}=e,{reductionIndices:i,keepDims:a}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:u,axes:c,originalAxes:d,inputWasTransposed:p}=Bd(s,i,t);if(p){let b=t.dataIdMap.get(u.dataId).id;l=u,o=b}let h=l.shape.length;W.assertAxesAreInnerMostDims("max",c,h);let[m,g]=W.computeOutAndReduceShapes(l.shape,c),v=P.sizeFromShape(g),y=t.makeOutput(m,s.dtype);if(P.sizeFromShape(l.shape)!==0){let b=t.dataIdMap.get(y.dataId).id;Aoe(o,hn[s.dtype],v,b)}if(p&&t.disposeData(u.dataId),a){let b=W.expandShapeToKeepDim(y.shape,d);y.shape=b}return y}var yht={kernelName:ff,backendName:"wasm",setupFunc:mht,kernelFunc:ght},vht=Ur(mf),Moe;function bht(e){Moe=e.wasm.cwrap(gf,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function wht(e){let{inputs:t,attrs:n,backend:r}=e,i=t.x,a=r.dataIdMap.get(i.dataId).id;P.assert(i.dtype==="float32",()=>`Error in MaxPool: only float32 input is supported. Got ${i.dtype}.`);let{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=n,c=W.computePool2DInfo(i.shape,s,o,1,l,u),d=c.filterHeight,p=c.filterWidth,h=c.padInfo.top,m=c.padInfo.right,g=c.padInfo.bottom,v=c.padInfo.left,y=c.dilationHeight,b=c.dilationWidth,_=c.strideHeight,k=c.strideWidth,C=c.inChannels,$=c.outChannels;if(c.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${c.dataFormat}'. Please use 'channelsLast'.`);let N=r.makeOutput(c.outShape,"float32"),A=r.dataIdMap.get(N.dataId).id;return Moe(a,i.shape[0],i.shape[1],i.shape[2],d,p,h,m,g,v,y,b,_,k,C,$,A),N}var xht={kernelName:gf,backendName:"wasm",setupFunc:bht,kernelFunc:wht},Roe;function _ht(e){Roe=e.wasm.cwrap("MaxPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function kht(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r,c=W.computePool3DInfo(i.shape,a,s,1,o,l,u),d=n.makeOutput(c.outShape,i.dtype);return Roe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),d}var Sht={kernelName:lv,backendName:"wasm",setupFunc:_ht,kernelFunc:kht},Doe;function Cht(e){Doe=e.wasm.cwrap("MaxPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Iht(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r,c=W.computePool3DInfo(a.shape,s,o,1,l,u),d=n.makeOutput(a.shape,a.dtype);return Doe(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),d}var $ht={kernelName:tw,backendName:"wasm",setupFunc:Cht,kernelFunc:Iht},Loe;function Tht(e){Loe=e.wasm.cwrap("MaxPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Nht(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:u}=r,c=W.computePool2DInfo(a.shape,s,o,1,l,u),d=n.makeOutput(a.shape,a.dtype);return Loe(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left),d}var Eht={kernelName:ew,backendName:"wasm",setupFunc:Tht,kernelFunc:Nht},Foe;function Oht(e){Foe=e.wasm.cwrap("MaxPoolWithArgmax",null,["number","number","number","number","boolean","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Pht(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,includeBatchInIndex:l}=r;P.assert(i.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${i.shape.length}.`);let u=[1,1];P.assert(W.eitherStridesOrDilationsAreOne(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let c=W.computePool2DInfo(i.shape,a,s,[1,1],o),d=n.makeOutput(c.outShape,i.dtype),p=n.makeOutput(c.outShape,"int32");return Foe(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(d.dataId).id,n.dataIdMap.get(p.dataId).id,hn[i.dtype],l,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left),[d,p]}var Aht={kernelName:nw,backendName:"wasm",setupFunc:Oht,kernelFunc:Pht},zoe;function Mht(e){zoe=e.wasm.cwrap(yf,null,["number, number, number"])}function Rht(e){let{backend:t,inputs:n,attrs:r}=e,{axis:i,keepDims:a}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:c,axes:d,originalAxes:p,inputWasTransposed:h}=Bd(s,i,t),m=d;if(h){let k=t.dataIdMap.get(c.dataId).id;k!==o&&(u=c,l=k,m=W.getInnerMostAxes(m.length,u.shape.length))}W.assertAxesAreInnerMostDims("mean",m,u.shape.length);let[g,v]=W.computeOutAndReduceShapes(u.shape,m),y=P.sizeFromShape(v),b=u;u.dtype!=="float32"&&(b=Wd({backend:t,inputs:{x:u},attrs:{dtype:"float32"}}),l=t.dataIdMap.get(b.dataId).id);let _=t.makeOutput(g,"float32");if(P.sizeFromShape(u.shape)!==0){let k=t.dataIdMap.get(_.dataId).id;zoe(l,y,k)}if(h&&t.disposeData(c.dataId),a){let k=W.expandShapeToKeepDim(_.shape,p);_.shape=k}return u.dtype!=="float32"&&t.disposeData(b.dataId),_}var Dht={kernelName:yf,backendName:"wasm",setupFunc:Mht,kernelFunc:Rht},Boe;function Lht(e){Boe=e.wasm.cwrap(vf,null,["number","number","number","number"])}function Fht(e){let{backend:t,inputs:n,attrs:r}=e,{axis:i,keepDims:a}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:c,axes:d,originalAxes:p,inputWasTransposed:h}=Bd(s,i,t);if(h){let _=t.dataIdMap.get(c.dataId).id;_!==o&&(u=c,l=_)}let m=u.shape.length;W.assertAxesAreInnerMostDims("min",d,m);let[g,v]=W.computeOutAndReduceShapes(u.shape,d),y=P.sizeFromShape(v),b=t.makeOutput(g,u.dtype);if(P.sizeFromShape(u.shape)!==0){let _=t.dataIdMap.get(b.dataId).id;Boe(l,hn[s.dtype],y,_)}if(h&&t.disposeData(c.dataId),a){let _=W.expandShapeToKeepDim(b.shape,p);b.shape=_}return b}var zht={kernelName:vf,backendName:"wasm",setupFunc:Lht,kernelFunc:Fht},Bht=Ur(bf),oA;(function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"})(oA||(oA={}));var Woe;function Wht(e){Woe=e.wasm.cwrap(wf,null,["number","array","number","number","array","array","number","number"])}function Vht(e){let{inputs:{x:t},backend:n,attrs:{paddings:r,mode:i}}=e,a=r.map((m,g)=>m[0]+t.shape[g]+m[1]),s=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(a,t.dtype),l=n.dataIdMap.get(o.dataId).id,u=new Uint8Array(new Int32Array(t.shape).buffer),c=r.map(m=>m[0]),d=r.map(m=>m[1]),p=new Uint8Array(new Int32Array(c).buffer),h=new Uint8Array(new Int32Array(d).buffer);return Woe(s,u,t.shape.length,hn[t.dtype],p,h,oA[i],l),o}var jht={kernelName:wf,backendName:"wasm",kernelFunc:Vht,setupFunc:Wht},Voe;function Uht(e){Voe=e.wasm.cwrap(Uf,null,["number","number","number","number"])}function joe(e){let{backend:t,inputs:{logits:n},attrs:{dim:r}}=e,i=t.dataIdMap.get(n.dataId).id,a=t.makeOutput(n.shape,n.dtype),s=t.dataIdMap.get(a.dataId).id,o=n.shape[r],l=P.sizeFromShape(n.shape)/o;return P.sizeFromShape(a.shape)===0||Voe(i,s,o,l),a}var Hht={kernelName:Uf,backendName:"wasm",setupFunc:Uht,kernelFunc:joe},Uoe;function Ght(e){Uoe=e.wasm.cwrap(uv,null,["number","number","number","number","number","number"])}function qht(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:a,seed:s,normalized:o}=r;if(i.dtype!=="float32")throw new Error(`Tensor logits must have dtype float32, got ${i.dtype}`);let l=o?i:joe({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),[u,c]=l.shape,d=n.makeOutput([u,a],"int32");return Uoe(n.dataIdMap.get(l.dataId).id,u,c,a,s,n.dataIdMap.get(d.dataId).id),o||n.disposeData(l.dataId),d}var Kht={kernelName:uv,backendName:"wasm",setupFunc:Ght,kernelFunc:qht},Zht=Ur(xf),Xht=Ur(_f),Jht=ln(cv);function Rz(e,t){let n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),r=n[0],i=n[1],a=n[2],s=n[3];return e.wasm._free(t),{pSelectedIndices:r,selectedSize:i,pSelectedScores:a,pValidOutputs:s}}var Hoe;function Yht(e){Hoe=e.wasm.cwrap(pv,"number",["number","number","number","number","number"])}function Qht(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:i,maxOutputSize:a,scoreThreshold:s}=r,{boxes:o,scores:l}=n,u=t.dataIdMap.get(o.dataId).id,c=t.dataIdMap.get(l.dataId).id,d=Hoe(u,c,a,i,s),{pSelectedIndices:p,selectedSize:h,pSelectedScores:m,pValidOutputs:g}=Rz(t,d);return t.wasm._free(m),t.wasm._free(g),t.makeOutput([h],"int32",p)}var eft={kernelName:pv,backendName:"wasm",setupFunc:Yht,kernelFunc:Qht},Goe;function tft(e){Goe=e.wasm.cwrap(hv,"number",["number","number","number","number","number","bool"])}function nft(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:i,maxOutputSize:a,scoreThreshold:s,padToMaxOutputSize:o}=r,{boxes:l,scores:u}=n,c=t.dataIdMap.get(l.dataId).id,d=t.dataIdMap.get(u.dataId).id,p=Goe(c,d,a,i,s,o),{pSelectedIndices:h,selectedSize:m,pSelectedScores:g,pValidOutputs:v}=Rz(t,p);t.wasm._free(g);let y=t.makeOutput([m],"int32",h),b=t.makeOutput([],"int32",v);return[y,b]}var rft={kernelName:hv,backendName:"wasm",setupFunc:tft,kernelFunc:nft},qoe;function ift(e){qoe=e.wasm.cwrap(fv,"number",["number","number","number","number","number","number"])}function aft(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:i,maxOutputSize:a,scoreThreshold:s,softNmsSigma:o}=r,{boxes:l,scores:u}=n,c=t.dataIdMap.get(l.dataId).id,d=t.dataIdMap.get(u.dataId).id,p=qoe(c,d,a,i,s,o),{pSelectedIndices:h,selectedSize:m,pSelectedScores:g,pValidOutputs:v}=Rz(t,p);t.wasm._free(v);let y=t.makeOutput([m],"int32",h),b=t.makeOutput([m],"float32",g);return[y,b]}var sft={kernelName:fv,backendName:"wasm",setupFunc:ift,kernelFunc:aft},oft=!1,lft=Ur(dv,oft,"bool"),Koe;function uft(e){Koe=e.wasm.cwrap(kf,null,["number","number","number","number","number"])}function cft(e){let{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:a,depth:s,onValue:o,offValue:l}=r,u=n.makeOutput([...i.shape,s],a),c=n.dataIdMap.get(u.dataId).id,d=n.dataIdMap.get(i.dataId).id;return Koe(d,s,o,l,c),u}var dft={kernelName:kf,backendName:"wasm",setupFunc:uft,kernelFunc:cft};function pft(e){let{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(1),r}var hft={kernelName:mv,backendName:"wasm",kernelFunc:pft};function fft(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return sA({inputs:{input:t[0]},backend:n,attrs:{dim:i}});let a=t[0].shape,s=t[0].dtype;t.forEach(c=>{P.assertShapesMatch(a,c.shape,"All tensors passed to stack must have matching shapes"),P.assert(s===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(c=>{let d=sA({inputs:{input:c},backend:n,attrs:{dim:i}});return o.push(d),d}),u=aoe({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(c=>n.disposeData(c.dataId)),u}var mft={kernelName:gv,backendName:"wasm",kernelFunc:fft},Zoe;function gft(e){Zoe=e.wasm.cwrap(Sf,null,["number","array","number","number","array","array","number","number"])}function yft(e){let{inputs:{x:t},backend:n,attrs:{paddings:r,constantValue:i}}=e,a=r.map((m,g)=>m[0]+t.shape[g]+m[1]);if(P.sizeFromShape(t.shape)===0)return _oe({backend:n,attrs:{shape:a,value:i,dtype:t.dtype}});let s=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(a,t.dtype),l=n.dataIdMap.get(o.dataId).id,u=new Uint8Array(new Int32Array(t.shape).buffer),c=r.map(m=>m[0]),d=r.map(m=>m[1]),p=new Uint8Array(new Int32Array(c).buffer),h=new Uint8Array(new Int32Array(d).buffer);return Zoe(s,u,t.shape.length,hn[t.dtype],p,h,i,l),o}var Xoe={kernelName:Sf,backendName:"wasm",kernelFunc:yft,setupFunc:gft},vft=Ur(Cf),Joe;function bft(e){Joe=e.wasm.cwrap(If,null,["number","number","number"])}function wft(e){let{inputs:t,backend:n}=e,{x:r,alpha:i}=t,a=n.dataIdMap.get(r.dataId).id,s=n.dataIdMap.get(i.dataId).id,o=a,l=r,u=l;l.dtype!=="float32"&&(u=Wd({backend:n,inputs:{x:r},attrs:{dtype:"float32"}}),o=n.dataIdMap.get(u.dataId).id);let c=n.makeOutput(r.shape,"float32"),d=n.dataIdMap.get(c.dataId).id;return Joe(o,s,d),l.dtype!=="float32"&&n.disposeData(u.dataId),c}var xft={kernelName:If,backendName:"wasm",setupFunc:bft,kernelFunc:wft},Yoe;function _ft(e){Yoe=e.wasm.cwrap($f,null,["number","number","number","number"])}function kft(e){let{backend:t,inputs:n,attrs:r}=e,{axis:i,keepDims:a}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:c,axes:d,originalAxes:p,inputWasTransposed:h}=Bd(s,i,t),m=d;if(h){let _=t.dataIdMap.get(c.dataId).id;_!==o&&(u=c,l=_,m=W.getInnerMostAxes(m.length,u.shape.length))}W.assertAxesAreInnerMostDims("prod",m,u.shape.length);let[g,v]=W.computeOutAndReduceShapes(u.shape,m),y=P.sizeFromShape(v),b=t.makeOutput(g,u.dtype);if(P.sizeFromShape(u.shape)!==0){let _=t.dataIdMap.get(b.dataId).id;Yoe(l,y,hn[b.dtype],_)}if(h&&t.disposeData(c.dataId),a){let _=W.expandShapeToKeepDim(b.shape,p);b.shape=_}return b}var Sft={kernelName:$f,backendName:"wasm",setupFunc:_ft,kernelFunc:kft},Cft=e=>{let{backend:t,attrs:n}=e,{start:r,stop:i,step:a,dtype:s}=n,o=uz(r,i,a,s),l=t.makeOutput([o.length],s);return t.typedArrayFromHeap(l).set(o),l},Ift={kernelName:rw,backendName:"wasm",kernelFunc:Cft},$ft=Ur(Xh),Tft=ln(Tf),Nft=ln(Nf),Eft=ln(Pf),Qoe;function Oft(e){Qoe=e.wasm.cwrap(Of,null,["number","number","number","number","number","number","number","number","number","number"])}function Pft(e){let{backend:t,inputs:n,attrs:r}=e,{images:i}=n,{alignCorners:a,halfPixelCenters:s,size:o}=r,[l,u]=o,[c,d,p,h]=i.shape,m=[c,l,u,h],g=t.dataIdMap.get(i.dataId),v;g.dtype!=="float32"&&(v=Wd({backend:t,inputs:{x:i},attrs:{dtype:"float32"}}),g=t.dataIdMap.get(v.dataId));let y=g.id,b=t.makeOutput(m,"float32");if(P.sizeFromShape(i.shape)===0)return b;let _=t.dataIdMap.get(b.dataId).id;return Qoe(y,c,d,p,h,l,u,a?1:0,s?1:0,_),v!=null&&t.disposeData(v.dataId),b}var Aft={kernelName:Of,backendName:"wasm",setupFunc:Oft,kernelFunc:Pft},ele;function Mft(e){ele=e.wasm.cwrap(bv,null,["number","number","number","array","array","boolean"])}function Rft(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:s}=r,o=n.makeOutput(i.shape,"float32"),l=n.dataIdMap.get(i.dataId),u;return l.dtype!=="float32"&&(u=Wd({backend:n,inputs:{x:i},attrs:{dtype:"float32"}}),l=n.dataIdMap.get(u.dataId)),ele(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(o.dataId).id,new Uint8Array(new Int32Array(i.shape).buffer),new Uint8Array(new Int32Array(a.shape).buffer),s),u!=null&&n.disposeData(u.dataId),o}var Dft={kernelName:bv,backendName:"wasm",setupFunc:Mft,kernelFunc:Rft},tle;function Lft(e){tle=e.wasm.cwrap(Ef,null,["number","number","number","number","number","number","number","number","number","number"])}function Fft(e){let{backend:t,inputs:n,attrs:r}=e,{images:i}=n,{alignCorners:a,halfPixelCenters:s,size:o}=r,[l,u]=o,[c,d,p,h]=i.shape,m=[c,l,u,h],g=t.makeOutput(m,"float32");if(P.sizeFromShape(i.shape)===0)return g;let v=t.dataIdMap.get(i.dataId),y;v.dtype!=="float32"&&(y=Wd({backend:t,inputs:{x:i},attrs:{dtype:"float32"}}),v=t.dataIdMap.get(y.dataId));let b=v.id,_=t.dataIdMap.get(g.dataId).id;return tle(b,c,d,p,h,l,u,a?1:0,s?1:0,_),y!=null&&t.disposeData(y.dataId),g}var zft={kernelName:Ef,backendName:"wasm",setupFunc:Lft,kernelFunc:Fft},nle;function Bft(e){nle=e.wasm.cwrap(vv,null,["number","number","number","array","array","boolean"])}function Wft(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:s}=r,o=n.makeOutput(i.shape,"float32"),l=n.dataIdMap.get(i.dataId),u;return l.dtype!=="float32"&&(u=Wd({backend:n,inputs:{x:i},attrs:{dtype:"float32"}}),l=n.dataIdMap.get(u.dataId)),nle(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(o.dataId).id,new Uint8Array(new Int32Array(i.shape).buffer),new Uint8Array(new Int32Array(a.shape).buffer),s),u!=null&&n.disposeData(u.dataId),o}var Vft={kernelName:vv,backendName:"wasm",setupFunc:Bft,kernelFunc:Wft},rle;function jft(e){rle=e.wasm.cwrap(Af,null,["number","array","number","array","number","number"])}function Uft(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:a}=r,s=P.parseAxisParam(a,i.shape);if(i.shape.length===0)return fT({inputs:{x:i},backend:n});let o=n.makeOutput(i.shape,i.dtype),l=n.dataIdMap.get(i.dataId).id,u=n.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(s).buffer),d=new Uint8Array(new Int32Array(i.shape).buffer);rle(l,c,s.length,d,i.shape.length,u);let p=Fa({inputs:{x:o},attrs:{shape:i.shape},backend:n});return n.disposeData(o.dataId),p}var Hft={kernelName:Af,backendName:"wasm",kernelFunc:Uft,setupFunc:jft},ile;function Gft(e){ile=e.wasm.cwrap(Mv,null,["number","number","number","number","number","number","number","number","array","number","number"])}function qft(e){let{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{radians:a,fillValue:s,center:o}=r,l=n.makeOutput(i.shape,i.dtype),u=n.dataIdMap.get(i.dataId).id,c=n.dataIdMap.get(l.dataId).id,[d,p,h,m]=i.shape,[g,v]=W.getImageCenter(o,p,h),y=s===0,b=255,_=typeof s=="number"?[s,s,s,y?0:b]:[...s,b],k=new Uint8Array(new Int32Array(_).buffer);return ile(u,d,p,h,m,a,g,v,k,_.length,c),l}var Kft={kernelName:Mv,backendName:"wasm",kernelFunc:qft,setupFunc:Gft},Zft=ln(Mf),Xft=ln(Rf),ale;function Jft(e){ale=e.wasm.cwrap(wv,null,["number","number","number","number","number","number","array","number","number"])}function Yft(e){let{backend:t,inputs:n,attrs:r}=e,{indices:i,updates:a}=n,{shape:s}=r,o=t.makeOutput(s,a.dtype);if(P.sizeFromShape(s)===0)return o;let{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=E$.calculateShapes(a,i,s),h=t.dataIdMap.get(i.dataId).id,m=t.dataIdMap.get(a.dataId).id,g=new Uint8Array(new Int32Array(d).buffer),v=t.dataIdMap.get(o.dataId).id;return ale(h,m,hn[a.dtype],l,u,c,g,p,v),o}var Qft={kernelName:wv,backendName:"wasm",setupFunc:Jft,kernelFunc:Yft},sle;function emt(e){sle=e.wasm.cwrap(_v,null,["number","number","number","number","number","number","bool","number"])}function tmt(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:a}=t,{side:s}=r;if(i.dtype!==a.dtype)throw new Error(`SearchSorted error: sorted_sequence must have the same dtype as values. Got ${i.dtype} and ${a.dtype}`);let o=n.makeOutput(a.shape,"int32");function l(u){return n.dataIdMap.get(u.dataId).id}return sle(l(i),l(a),i.shape[0],i.shape[1],a.shape[1],hn[i.dtype],s==="left",l(o)),o}var nmt={kernelName:_v,backendName:"wasm",setupFunc:emt,kernelFunc:tmt},ole;function rmt(e){ole=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}function imt(e){let{inputs:t,backend:n}=e,{condition:r,t:i,e:a}=t,s=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(i.dataId).id,l=n.dataIdMap.get(a.dataId).id,u=n.makeOutput(i.shape,i.dtype),c=n.dataIdMap.get(u.dataId).id,d=r.shape.length,p=i.shape.length,h=d===0||d>1||p===1?1:P.sizeFromShape(i.shape.slice(1));return ole(s,o,l,h,c),u}var amt={kernelName:kv,backendName:"wasm",kernelFunc:imt,setupFunc:rmt},smt=ln(Df),lle;function omt(e){lle=e.wasm.cwrap(Bf,null,["number","number"])}function lmt(e){let{backend:t,inputs:{x:n}}=e,r=t.dataIdMap.get(n.dataId).id,i=t.makeOutput(n.shape,n.dtype),a=t.dataIdMap.get(i.dataId).id;return P.sizeFromShape(i.shape)===0||lle(r,a),i}var umt={kernelName:"Sigmoid",backendName:"wasm",setupFunc:omt,kernelFunc:lmt},cmt=ln(zf),dmt=ln(Lf),pmt=ln(Ff),hmt=ln(Wf);function fmt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,paddings:s}=r,o=P.sizeFromShape(a),l=[[0,0]];l.push(...s);for(let v=1+a.length;v<i.shape.length;++v)l.push([0,0]);let u=Xoe.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),c=W.getReshaped(u.shape,a,o,!1),d=W.getPermuted(c.length,a.length,!1),p=W.getReshapedPermuted(u.shape,a,o,!1),h=Fa({inputs:{x:u},backend:n,attrs:{shape:c}}),m=yd({inputs:{x:h},backend:n,attrs:{perm:d}}),g=Fa({inputs:{x:m},backend:n,attrs:{shape:p}});return n.disposeData(u.dataId),n.disposeData(h.dataId),n.disposeData(m.dataId),g}var mmt={kernelName:Cv,backendName:"wasm",kernelFunc:fmt},ule;function gmt(e){ule=e.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])}function ymt(e){let{backend:t,inputs:n}=e,{indices:r,values:i,denseShape:a,defaultValue:s}=n,o=r.shape[0],l=r.shape[1],u=t.readSync(a.dataId)[0],c=[o+u,l],d=t.dataIdMap.get(r.dataId).id,p=t.dataIdMap.get(i.dataId).id,h=t.dataIdMap.get(s.dataId).id,m=t.makeOutput(c,r.dtype),g=t.dataIdMap.get(m.dataId).id,v=t.makeOutput(c.slice(0,1),i.dtype),y=t.dataIdMap.get(v.dataId).id,b=t.makeOutput([u],"bool"),_=t.dataIdMap.get(b.dataId).id,k=t.makeOutput([o],r.dtype),C=t.dataIdMap.get(k.dataId).id,$=t.makeOutput([4],"int32"),N=t.dataIdMap.get($.dataId).id,A=ule(d,p,hn[i.dtype],o,u,l,h,g,y,_,C,N),D=t.readSync($.dataId),O;switch(D[0]){case 1:{O=W.getSparseFillEmptyRowsIndicesDenseShapeMismatch(D[1]);break}case 2:{O=W.getSparseFillEmptyRowsNegativeIndexErrorMessage(D[1],D[2]);break}case 3:O=W.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(D[1],D[2],D[3]);break;default:O=""}if(t.disposeData($.dataId),O)throw t.disposeData(m.dataId),t.disposeData(v.dataId),t.disposeData(b.dataId),t.disposeData(k.dataId),new Error(O);let F=m,E=v;return A!==c[0]&&(F=gh({inputs:{x:m},attrs:{begin:0,size:[A,l]},backend:t}),E=gh({inputs:{x:v},attrs:{begin:0,size:A},backend:t}),t.disposeData(m.dataId),t.disposeData(v.dataId)),[F,E,b,k]}var vmt={kernelName:iw,backendName:"wasm",setupFunc:gmt,kernelFunc:ymt},cle;function bmt(e){cle=e.wasm.cwrap($v,null,["number","number","number","number","number","number","number"])}function wmt(e){let{backend:t,inputs:n}=e,{inputIndices:r,inputShape:i,newShape:a}=n;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);let s=t.dataIdMap.get(r.dataId).id,o=t.dataIdMap.get(i.dataId).id,l=t.dataIdMap.get(a.dataId).id,u=r.shape[0],c=P.sizeFromShape(a.shape),d=t.makeOutput([u,c],r.dtype),p=t.dataIdMap.get(d.dataId).id,h=t.makeOutput([c],a.dtype),m=t.dataIdMap.get(h.dataId).id,g=t.makeOutput([3],"int32"),v=t.dataIdMap.get(g.dataId).id;cle(s,o,l,u,p,m,v);let y=t.readSync(g.dataId),b;switch(y[0]){case 0:{b=W.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(y[1],y[2]);break}case 1:{b=W.getSparseReshapeNegativeOutputDimErrorMessage(y[1],y[2]);break}case 2:b=W.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage();break;case 3:{let _=Array.from(t.readSync(i.dataId)),k=Array.from(t.readSync(h.dataId));b=W.getSparseReshapeInputOutputMultipleErrorMessage(_,k);break}case 4:{let _=Array.from(t.readSync(i.dataId)),k=Array.from(t.readSync(h.dataId));b=W.getSparseReshapeInputOutputMismatchErrorMessage(_,k);break}default:b=""}if(t.disposeData(g.dataId),b)throw t.disposeData(d.dataId),t.disposeData(h.dataId),new Error(b);return[d,h]}var xmt={kernelName:$v,backendName:"wasm",setupFunc:bmt,kernelFunc:wmt},dle;function ple(e){dle=e.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function hle(e,t){let{backend:n,inputs:r}=e,{data:i,indices:a,segmentIds:s}=r,o=a.shape[0],l=n.readSync(s.dataId,o-1,o)[0],u=o>0?l+1:0;if(u<0)throw new Error(W.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let c=i.shape.slice();c[0]=u;let d=n.dataIdMap.get(i.dataId).id,p=n.dataIdMap.get(a.dataId).id,h=n.dataIdMap.get(s.dataId).id,m=n.makeOutput(c,i.dtype),g=n.dataIdMap.get(m.dataId).id,v=n.makeOutput([4],"int32"),y=n.dataIdMap.get(v.dataId).id;dle(d,hn[i.dtype],i.shape[0],p,h,g,y,t,0);let b=n.readSync(v.dataId),_;switch(b[0]){case 0:{_=W.getSparseSegmentReductionNegativeSegmentIdsErrorMessage();break}case 1:{_=W.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage();break}case 2:_=W.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(b[1],b[2]);break;case 3:_=W.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(b[1],b[2],b[3]);break;default:_=""}if(n.disposeData(v.dataId),_)throw n.disposeData(m.dataId),new Error(_);return m}function _mt(e){return hle(e,!0)}var kmt={kernelName:aw,backendName:"wasm",setupFunc:ple,kernelFunc:_mt};function Smt(e){return hle(e,!1)}var Cmt={kernelName:sw,backendName:"wasm",setupFunc:ple,kernelFunc:Smt},fle;function Imt(e){fle=e.wasm.cwrap(Tv,null,["number","number","number","number","number","number","number","number","array","number","number"])}function $mt(e){let{backend:t,inputs:n,attrs:r}=e,{sparseIndices:i,sparseValues:a,defaultValue:s}=n,{outputShape:o}=r,l=t.makeOutput(o,s.dtype);if(P.sizeFromShape(o)===0)return l;let{sliceRank:u,numUpdates:c,sliceSize:d,strides:p,outputSize:h}=W.calculateShapes(a,i,o),m=t.dataIdMap.get(i.dataId).id,g=t.dataIdMap.get(a.dataId).id,v=t.dataIdMap.get(s.dataId).id,y=new Uint8Array(new Int32Array(p).buffer),b=t.dataIdMap.get(l.dataId).id;return fle(m,g,a.shape.length,v,hn[s.dtype],u,c,d,y,h,b),l}var Tmt={kernelName:Tv,backendName:"wasm",setupFunc:Imt,kernelFunc:$mt};function Nmt(e){let{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{numOrSizeSplits:a,axis:s}=n,o=P.parseAxisParam(s,i.shape)[0],l=W.prepareSplitSize(i,a,o),u=new Array(i.shape.length).fill(0),c=i.shape.slice();return l.map(d=>{let p=[...c];p[o]=d;let h=gh({inputs:{x:i},attrs:{begin:u,size:p},backend:r});return u[o]+=d,h})}var Emt={kernelName:Iv,backendName:"wasm",kernelFunc:Nmt},Omt=ln(Vf),Pmt=ln(ow),Amt=Ur(Hf),mle;function Mmt(e){mle=e.wasm.cwrap(Pd,null,["number","number","number","number"])}function Rmt(e){let{backend:t,inputs:n,attrs:r}=e,{alpha:i}=r,{x:a}=n,s=t.dataIdMap.get(a.dataId).id,o=t.makeOutput(a.shape,a.dtype),l=t.dataIdMap.get(o.dataId).id;return mle(s,i,hn[a.dtype],l),o}var Dmt={kernelName:Pd,backendName:"wasm",setupFunc:Mmt,kernelFunc:Rmt},gle;function Lmt(e){gle=e.wasm.cwrap(Nv,null,["number","array","number","array","array","array","array","array","number","number"])}function Fmt(e){let{backend:t,inputs:n,attrs:r}=e,{x:i}=n,{begin:a,end:s,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:h,finalShape:m,isIdentity:g,sliceDim0:v,isSimpleSlice:y,begin:b,end:_,strides:k}=ei.sliceInfo(i.shape,a,s,o,l,u,c,d,p),C;if(g)C=Fa({inputs:{x:i},backend:t,attrs:{shape:m}});else if(v||y){P.assert(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);let $=ei.computeOutShape(b,_,k),N=gh({inputs:{x:i},backend:t,attrs:{begin:b,size:$}});C=Fa({inputs:{x:N},backend:t,attrs:{shape:m}}),t.disposeData(N.dataId)}else{let $=t.makeOutput(h,"float32"),N=t.dataIdMap.get(i.dataId).id,A=new Uint8Array(new Int32Array(P.computeStrides(i.shape)).buffer),D=new Uint8Array(new Int32Array(b).buffer),O=new Uint8Array(new Int32Array(_).buffer),F=new Uint8Array(new Int32Array(k).buffer),E=new Uint8Array(new Int32Array(h).buffer),z=new Uint8Array(new Int32Array(P.computeStrides(h)).buffer),q=t.dataIdMap.get($.dataId).id;gle(N,A,i.shape.length,D,O,F,E,z,h.length,q),C=Fa({inputs:{x:$},backend:t,attrs:{shape:m}}),t.disposeData($.dataId)}return C}var zmt={kernelName:Nv,backendName:"wasm",setupFunc:Lmt,kernelFunc:Fmt};function Bmt(e){let{backend:t,inputs:n,attrs:r}=e,{data:i,dataSplits:a}=n,{separator:s,nGramWidths:o,leftPad:l,rightPad:u,padWidth:c,preserveShortSequences:d}=r,p=t.readSync(i.dataId),h=t.readSync(a.dataId),[m,g]=dz(p,h,s,o,l,u,c,d),v=t.makeOutput([m.length],"string"),y=t.dataIdMap.get(v.dataId);y.stringBytes=m;let b=t.makeOutput(a.shape,"int32");return t.typedArrayFromHeap(b).set(g),[v,b]}var Wmt={kernelName:uw,backendName:"wasm",kernelFunc:Bmt};function Vmt(e){let{backend:t,inputs:n,attrs:r}=e,{input:i,delimiter:a}=n,{skipEmpty:s}=r,o=t.readSync(i.dataId),l=t.readSync(a.dataId),[u,c,d]=pz(o,l[0],s),p=c.length,h=t.makeOutput([p,2],"int32");t.typedArrayFromHeap(h).set(u);let m=t.makeOutput([p],"string"),g=t.dataIdMap.get(m.dataId);g.stringBytes=c;let v=t.makeOutput([2],"int32");return t.typedArrayFromHeap(v).set(d),[h,m,v]}var jmt={kernelName:cw,backendName:"wasm",kernelFunc:Vmt};function Umt(e){let{backend:t,inputs:n,attrs:r}=e,{input:i}=n,{numBuckets:a}=r,s=t.readSync(i.dataId),o=hz(s,a),l=t.makeOutput(i.shape,"int32");return t.typedArrayFromHeap(l).set(o),l}var Hmt={kernelName:dw,backendName:"wasm",kernelFunc:Umt},Gmt=Ur(Gf),yle;function qmt(e){yle=e.wasm.cwrap(jf,null,["number","number","number","number"])}function Kmt(e){let{backend:t,inputs:n,attrs:r}=e,{axis:i,keepDims:a}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,u=s,{transposed:c,axes:d,originalAxes:p,inputWasTransposed:h}=Bd(s,i,t),m=d;if(h){let _=t.dataIdMap.get(c.dataId).id;_!==o&&(u=c,l=_,m=W.getInnerMostAxes(m.length,u.shape.length))}W.assertAxesAreInnerMostDims("sum",m,u.shape.length);let[g,v]=W.computeOutAndReduceShapes(u.shape,m),y=P.sizeFromShape(v),b=t.makeOutput(g,u.dtype);if(P.sizeFromShape(u.shape)!==0){let _=t.dataIdMap.get(b.dataId).id;yle(l,y,hn[b.dtype],_)}if(h&&t.disposeData(c.dataId),a){let _=W.expandShapeToKeepDim(b.shape,p);b.shape=_}return b}var Zmt={kernelName:jf,backendName:"wasm",setupFunc:qmt,kernelFunc:Kmt},Xmt=ln(qf),Jmt=ln(Kf),vle;function Ymt(e){vle=e.wasm.cwrap(xv,null,["number","number","number","number","number","number","array","number","number","number"])}function Qmt(e){let{backend:t,inputs:n,attrs:r}=e,{tensor:i,indices:a,updates:s}=n,o=t.makeOutput(i.shape,i.dtype);if(P.sizeFromShape(i.shape)===0)return o;let{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=E$.calculateShapes(s,a,i.shape),h=t.dataIdMap.get(a.dataId).id,m=t.dataIdMap.get(s.dataId).id,g=t.dataIdMap.get(i.dataId).id,v=new Uint8Array(new Int32Array(d).buffer),y=t.dataIdMap.get(o.dataId).id;return vle(h,m,hn[s.dtype],l,u,c,v,p,y,g),o}var egt={kernelName:xv,backendName:"wasm",setupFunc:Ymt,kernelFunc:Qmt},ble;function tgt(e){ble=e.wasm.cwrap(Od,null,["number","array","number","array","number","number"])}function ngt(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,a=n.dataIdMap.get(i.dataId).id,{reps:s}=r,o=new Array(i.shape.length);for(let p=0;p<o.length;p++)o[p]=i.shape[p]*s[p];let l=new Uint8Array(new Int32Array(i.shape).buffer),u=new Uint8Array(new Int32Array(o).buffer),c=n.makeOutput(o,i.dtype),d=n.dataIdMap.get(c.dataId).id;return ble(a,l,i.shape.length,u,o.length,hn[c.dtype],d),c}var rgt={kernelName:Od,backendName:"wasm",setupFunc:tgt,kernelFunc:ngt},wle;function igt(e){wle=e.wasm.cwrap(Ev,null,["number","array","number","number","number","bool","number","number"])}var agt=({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{k:i,sorted:a}=n,s=t.dataIdMap.get(r.dataId).id,o=new Uint8Array(new Int32Array(r.shape).buffer),l=r.shape.slice();l[l.length-1]=i;let u=t.makeOutput(l,r.dtype),c=t.dataIdMap.get(u.dataId).id,d=t.makeOutput(l,"int32"),p=t.dataIdMap.get(d.dataId).id;return wle(s,o,r.shape.length,hn[r.dtype],i,a,c,p),[u,d]},sgt={kernelName:Ev,backendName:"wasm",setupFunc:igt,kernelFunc:agt},xle;function ogt(e){xle=e.wasm.cwrap(Ov,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])}function lgt(e){let{backend:t,inputs:n,attrs:r}=e,{image:i,transforms:a}=n,{interpolation:s,fillMode:o,fillValue:l,outputShape:u}=r,[c,d,p,h]=i.shape,[m,g]=u!=null?u:[d,p],v=[c,m,g,h],y=new Uint8Array(new Int32Array(P.computeStrides(i.shape)).buffer),b=new Uint8Array(new Int32Array(P.computeStrides(v)).buffer),_=t.makeOutput(v,i.dtype),k=t.dataIdMap.get(_.dataId).id,C=t.dataIdMap.get(i.dataId).id,$=t.dataIdMap.get(a.dataId).id,N=s==="nearest"?1:2,A;switch(o){case"constant":A=1;break;case"reflect":A=2;break;case"wrap":A=3;break;case"nearest":A=4;break;default:A=1;break}return xle(C,$,a.shape[0]>1,c,m,g,h,p,d,y,i.shape.length-1,b,v.length-1,N,A,l,k),_}var ugt={kernelName:Ov,backendName:"wasm",setupFunc:ogt,kernelFunc:lgt};function cgt(e){let{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:a}=t,{outputValues:s,outputShape:o,indices:l}=mz(r.readSync(a.dataId),i,a.shape,a.dtype);return[r.makeOutput(o,a.dtype,void 0,s),r.makeOutput([l.length],"int32",void 0,l)]}var dgt={kernelName:pw,backendName:"wasm",kernelFunc:cgt};function pgt(e){let{inputs:t,backend:n,attrs:r}=e,{value:i}=t,{axis:a}=r;a<0&&(a+=i.shape.length);let s=i.shape[a],o=i.shape.length,l=new Array(o-1),u=0;for(let h=0;h<o;h++)h!==a&&(l[u++]=i.shape[h]);let c=new Array(s),d=new Array(o).fill(0),p=i.shape.slice();p[a]=1;for(let h=0;h<c.length;h++)d[a]=h,c[h]=gh({inputs:{x:i},attrs:{begin:d,size:p},backend:n});return c.map(({dataId:h,dtype:m})=>({dataId:h,dtype:m,shape:l}))}var hgt={kernelName:Pv,backendName:"wasm",kernelFunc:pgt};function fgt(e){let{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(0),r}var mgt={kernelName:Av,backendName:"wasm",kernelFunc:fgt},ggt=[oct,lct,uct,cct,dct,fct,_ct,Cct,Ict,$ct,Tct,Nct,Ect,Oct,Pct,Rct,Uct,Fct,Wct,Kct,edt,rdt,idt,sdt,odt,ldt,ddt,pdt,mdt,vdt,xdt,Sdt,$dt,Tdt,Ndt,Pdt,Rdt,Fdt,Wdt,Udt,qdt,Xdt,Qdt,npt,apt,spt,upt,dpt,ppt,hpt,fpt,mpt,gpt,bpt,wpt,xpt,Spt,$pt,Ept,Apt,Dpt,Fpt,Bpt,mct,Wpt,Vpt,jpt,Gpt,Kpt,Xpt,Qpt,tht,eht,rht,iht,sht,lht,dht,fht,yht,vht,xht,Sht,$ht,Eht,Aht,Dht,zht,Bht,jht,Kht,Zht,Xht,Jht,eft,rft,sft,lft,dft,hft,mft,Xoe,vft,xft,Sft,Ift,$ft,Tft,Nft,Eft,Hct,Aft,Dft,zft,Vft,Hft,Kft,Zft,Xft,Qft,nmt,amt,smt,umt,cmt,dmt,pmt,Yct,Hht,hmt,mmt,vmt,xmt,kmt,Cmt,Tmt,Emt,Omt,Pmt,Amt,Dmt,zmt,Wmt,jmt,Hmt,Gmt,Zmt,Xmt,Jmt,egt,rgt,sgt,ugt,bct,dgt,hgt,mgt];for(let e of ggt)fw(e);var lA=he();lA.registerFlag("WASM_HAS_SIMD_SUPPORT",async()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}catch{return!1}});lA.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",async()=>{if(lA.get("IS_NODE"))return!1;try{return new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}});var IH=Td(JRe()),ygt=Td(YRe()),$H=Td(QRe()),TH=IH.default||IH,vgt=$H.default||$H,_le=class extends H1{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(kle),uA=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new j2(this,Ys())}write(e,t,n){let r={id:this.dataIdNextNumber++};return this.move(r,e,t,n,1),r}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){let t=P.now();return e(),{kernelMs:P.now()-t}}move(e,t,n,r,i){let a=this.dataIdNextNumber++;if(r==="string"){let u=t;this.dataIdMap.set(e,{id:a,stringBytes:u,shape:n,dtype:r,memoryOffset:null,refCount:i});return}let s=P.sizeFromShape(n),o=s*P.bytesPerElement(r),l=this.wasm._malloc(o)>>>0;this.dataIdMap.set(e,{id:a,memoryOffset:l,shape:n,dtype:r,refCount:i}),this.wasm.tfjs.registerTensor(a,s,l),t!=null&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,o),l)}async read(e){return this.readSync(e)}readSync(e,t,n){let{memoryOffset:r,dtype:i,shape:a,stringBytes:s}=this.dataIdMap.get(e);if(i==="string")return(t==null||t===0)&&(n==null||n>=s.length)?s:s.slice(t,n);t=t||0,n=n||P.sizeFromShape(a);let o=P.bytesPerElement(i),l=this.wasm.HEAPU8.slice(r+t*o,r+n*o);return xgt(l.buffer,i)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){let n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){let t=this.dataIdMap.get(e);t!=null&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,n,r){let i;if(n==null)i=this.write(r!=null?r:null,e,t);else{let a=this.dataIdNextNumber++;i={id:a},this.dataIdMap.set(i,{id:a,memoryOffset:n,shape:e,dtype:t,refCount:1});let s=P.sizeFromShape(e);this.wasm.tfjs.registerTensor(a,s,n)}return{dataId:i,shape:e,dtype:t}}typedArrayFromHeap({shape:e,dtype:t,dataId:n}){let r=this.wasm.HEAPU8.buffer,{memoryOffset:i}=this.dataIdMap.get(n),a=P.sizeFromShape(e);switch(t){case"float32":return new Float32Array(r,i,a);case"int32":return new Int32Array(r,i,a);case"bool":return new Uint8Array(r,i,a);default:throw new Error(`Unknown dtype ${t}`)}}};function bgt(e){return(t,n)=>(P.fetch(e,{credentials:"same-origin"}).then(r=>{r.ok||t.env.a(`failed to load wasm binary file at '${e}'`),r.arrayBuffer().then(i=>{WebAssembly.instantiate(i,t).then(a=>{n(a.instance,a.module)})})}),{})}function NH(e,t,n){if(mI!=null)return mI;let r="tfjs-backend-wasm.wasm";return e&&t?r="tfjs-backend-wasm-threaded-simd.wasm":e&&(r="tfjs-backend-wasm-simd.wasm"),kb!=null&&kb[r]!=null?kb[r]:n+r}async function wgt(){let[e,t]=await Promise.all([he().getAsync("WASM_HAS_SIMD_SUPPORT"),he().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise((n,r)=>{let i={};i.locateFile=(o,l)=>{if(o.endsWith(".worker.js")){let u=ygt.wasmWorkerContents.replace(/\n/g,"\\n"),c=new Blob([u],{type:"application/javascript"});return URL.createObjectURL(c)}return o.endsWith(".wasm")?NH(e,t,sb!=null?sb:l):l+o},Dz&&(i.instantiateWasm=bgt(NH(e,t,sb!=null?sb:"")));let a=!1;i.onAbort=()=>{a||Sb||(Sb=!0,r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"}))};let s;t&&e&&mI==null?(i.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+TH.toString()],{type:"text/javascript"}),s=TH(i)):s=vgt(i),s.then(o=>{a=!0,Sb=!1;let l=null;o.tfjs={init:o.cwrap("init",null,[]),initWithThreadsCount:o.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:o.cwrap("get_threads_count","number",[]),registerTensor:o.cwrap("register_tensor",null,["number","number","number"]),disposeData:o.cwrap("dispose_data",l,["number"]),dispose:o.cwrap("dispose",l,[])},n({wasm:o})}).catch(r)})}function xgt(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error(`Unknown dtype ${t}`)}}var _gt=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"],mI=null,sb=null,kb={},Sb=!1,Dz=!1;function kgt(e,t=!1){if(GQ("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),Sb)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");mI=e,Dz=t}function Sgt(e,t=!1){if(Sb)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if(typeof e=="string")sb=e;else{kb=e;let n=_gt.filter(r=>kb[r]==null);if(n.length>0)throw new Error(`There were no entries found for the following binaries: ${n.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}Dz=t}var kle=-1,uA=-1;function Cgt(e){kle=e}function Igt(){if(uA===-1)throw new Error("WASM backend not initialized.");return uA}var $gt="4.16.0",Tgt=2;o$("wasm",async()=>{let{wasm:e}=await wgt();return new _le(e)},Tgt);var EH="4.16.0",Ngt="4.16.0",Egt="4.16.0",Ogt="4.16.0",Pgt="4.16.0",Agt={tfjs:EH,"tfjs-core":EH,"tfjs-converter":Ngt,"tfjs-backend-cpu":Egt,"tfjs-backend-webgl":Ogt,"tfjs-backend-wasm":Pgt},Mgt={};jR(Mgt,{AnchorPosition:()=>Ble,DrawBox:()=>jle,DrawBoxOptions:()=>Vle,DrawFaceLandmarks:()=>oue,DrawFaceLandmarksOptions:()=>sue,DrawTextField:()=>Vz,DrawTextFieldOptions:()=>Wz,drawContour:()=>mc,drawDetections:()=>qgt,drawFaceExpressions:()=>syt,drawFaceLandmarks:()=>lyt});function mc(e,t,n=!1){if(e.beginPath(),t.slice(1).forEach(({x:r,y:i},a)=>{let s=t[a];e.moveTo(s.x,s.y),e.lineTo(r,i)}),n){let r=t[t.length-1],i=t[0];if(!r||!i)return;e.moveTo(r.x,r.y),e.lineTo(i.x,i.y)}e.stroke()}var Rgt={};jR(Rgt,{computeReshapedDimensions:()=>$le,getCenterPoint:()=>Lz,isDimensions:()=>dA,isEven:()=>cA,isFloat:()=>Ile,isTensor:()=>t0,isTensor1D:()=>Dgt,isTensor2D:()=>Cle,isTensor3D:()=>qw,isTensor4D:()=>Cu,isValidNumber:()=>Rp,isValidProbablitiy:()=>Lgt,range:()=>py,round:()=>mT});var Tg=class Sle{constructor(t,n){if(!Rp(t)||!Rp(n))throw new Error(`Dimensions.constructor - expected width and height to be valid numbers, instead have ${JSON.stringify({width:t,height:n})}`);this._width=t,this._height=n}get width(){return this._width}get height(){return this._height}reverse(){return new Sle(1/this.width,1/this.height)}};function t0(e,t){return e instanceof zt&&e.shape.length===t}function Dgt(e){return t0(e,1)}function Cle(e){return t0(e,2)}function qw(e){return t0(e,3)}function Cu(e){return t0(e,4)}function Ile(e){return e%1!==0}function cA(e){return e%2===0}function mT(e,t=2){let n=10**t;return Math.floor(e*n)/n}function dA(e){return e&&e.width&&e.height}function $le({width:e,height:t},n){let r=n/Math.max(t,e);return new Tg(Math.round(e*r),Math.round(t*r))}function Lz(e){return e.reduce((t,n)=>t.add(n),new Fn(0,0)).div(new Fn(e.length,e.length))}function py(e,t,n){return Array(e).fill(0).map((r,i)=>t+i*n)}function Rp(e){return!!e&&e!==1/0&&e!==-1/0&&!Number.isNaN(e)||e===0}function Lgt(e){return Rp(e)&&e>=0&&e<=1}var Fn=class cp{constructor(t,n){this._x=t,this._y=n}get x(){return this._x}get y(){return this._y}add(t){return new cp(this.x+t.x,this.y+t.y)}sub(t){return new cp(this.x-t.x,this.y-t.y)}mul(t){return new cp(this.x*t.x,this.y*t.y)}div(t){return new cp(this.x/t.x,this.y/t.y)}abs(){return new cp(Math.abs(this.x),Math.abs(this.y))}magnitude(){return Math.sqrt(this.x**2+this.y**2)}floor(){return new cp(Math.floor(this.x),Math.floor(this.y))}},yh=class Eo{static isRect(t){return!!t&&[t.x,t.y,t.width,t.height].every(Rp)}static assertIsValidBox(t,n,r=!1){if(!Eo.isRect(t))throw new Error(`${n} - invalid box: ${JSON.stringify(t)}, expected object with properties x, y, width, height`);if(!r&&(t.width<0||t.height<0))throw new Error(`${n} - width (${t.width}) and height (${t.height}) must be positive numbers`)}constructor(t,n=!0){let r=t||{},i=[r.left,r.top,r.right,r.bottom].every(Rp),a=[r.x,r.y,r.width,r.height].every(Rp);if(!a&&!i)throw new Error(`Box.constructor - expected box to be IBoundingBox | IRect, instead have ${JSON.stringify(r)}`);let[s,o,l,u]=a?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top];Eo.assertIsValidBox({x:s,y:o,width:l,height:u},"Box.constructor",n),this._x=s,this._y=o,this._width=l,this._height=u}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new Fn(this.left,this.top)}get topRight(){return new Fn(this.right,this.top)}get bottomLeft(){return new Fn(this.left,this.bottom)}get bottomRight(){return new Fn(this.right,this.bottom)}round(){let[t,n,r,i]=[this.x,this.y,this.width,this.height].map(a=>Math.round(a));return new Eo({x:t,y:n,width:r,height:i})}floor(){let[t,n,r,i]=[this.x,this.y,this.width,this.height].map(a=>Math.floor(a));return new Eo({x:t,y:n,width:r,height:i})}toSquare(){let{x:t,y:n,width:r,height:i}=this,a=Math.abs(r-i);return r<i&&(t-=a/2,r+=a),i<r&&(n-=a/2,i+=a),new Eo({x:t,y:n,width:r,height:i})}rescale(t){let n=dA(t)?t.width:t,r=dA(t)?t.height:t;return new Eo({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})}pad(t,n){let[r,i,a,s]=[this.x-t/2,this.y-n/2,this.width+t,this.height+n];return new Eo({x:r,y:i,width:a,height:s})}clipAtImageBorders(t,n){let{x:r,y:i,right:a,bottom:s}=this,o=Math.max(r,0),l=Math.max(i,0),u=a-o,c=s-l,d=Math.min(u,t-o),p=Math.min(c,n-l);return new Eo({x:o,y:l,width:d,height:p}).floor()}shift(t,n){let{width:r,height:i}=this,a=this.x+t,s=this.y+n;return new Eo({x:a,y:s,width:r,height:i})}padAtBorders(t,n){let r=this.width+1,i=this.height+1,a=1,s=1,o=r,l=i,u=this.left,c=this.top,d=this.right,p=this.bottom;return d>n&&(o=-d+n+r,d=n),p>t&&(l=-p+t+i,p=t),u<1&&(l=2-u,u=1),c<1&&(l=2-c,c=1),{dy:s,edy:l,dx:a,edx:o,y:c,ey:p,x:u,ex:d,w:r,h:i}}calibrate(t){return new Eo({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()}},Tle=class extends yh{constructor(e,t,n,r,i=!1){super({left:e,top:t,right:n,bottom:r},i)}},Nle=class Ele{constructor(t,n,r,i,a){this._imageDims=new Tg(a.width,a.height),this._score=t,this._classScore=n,this._className=r,this._box=new yh(i).rescale(this._imageDims)}get score(){return this._score}get classScore(){return this._classScore}get className(){return this._className}get box(){return this._box}get imageDims(){return this._imageDims}get imageWidth(){return this.imageDims.width}get imageHeight(){return this.imageDims.height}get relativeBox(){return new yh(this._box).rescale(this.imageDims.reverse())}forSize(t,n){return new Ele(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})}},nl=class Ole extends Nle{constructor(t,n,r){super(t,t,"",n,r)}forSize(t,n){let{score:r,relativeBox:i,imageDims:a}=super.forSize(t,n);return new Ole(r,i,a)}};function Fgt(e,t,n=!0){let r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),i=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),a=r*i;return n?a/(e.area+t.area-a):a/Math.min(e.area,t.area)}function zgt(e){let t=e.map(o=>o.x),n=e.map(o=>o.y),r=t.reduce((o,l)=>l<o?l:o,1/0),i=n.reduce((o,l)=>l<o?l:o,1/0),a=t.reduce((o,l)=>o<l?l:o,0),s=n.reduce((o,l)=>o<l?l:o,0);return new Tle(r,i,a,s)}function Bgt(e,t,n,r=!0){let i=t.map((s,o)=>({score:s,boxIndex:o})).sort((s,o)=>s.score-o.score).map(s=>s.boxIndex),a=[];for(;i.length>0;){let s=i.pop();a.push(s);let o=i,l=[];for(let u=0;u<o.length;u++){let c=o[u],d=e[s],p=e[c];l.push(Fgt(d,p,r))}i=i.filter((u,c)=>l[c]<=n)}return a}function Kw(e,t){return le(()=>{let[n,r,i]=t,a=ds([...e.shape.slice(0,3),1],n,"float32"),s=ds([...e.shape.slice(0,3),1],r,"float32"),o=ds([...e.shape.slice(0,3),1],i,"float32"),l=Wn([a,s,o],3);return Ve(e,l)})}function Wgt(e,t=!1){return le(()=>{let[n,r]=e.shape.slice(1);if(n===r)return e;let i=Math.abs(n-r),a=Math.round(i*(t?.5:1)),s=n>r?2:1,o=d=>{let p=e.shape.slice();return p[s]=d,ds(p,0,"float32")},l=o(a),u=i-l.shape[s],c=[t&&u?o(u):null,e,l].filter(d=>!!d).map(d=>Me(d,"float32"));return Wn(c,s)})}function hE(e){return 1/(1+Math.exp(-e))}var Ple=class extends yh{constructor(e,t,n,r,i=!1){super({x:e,y:t,width:n,height:r},i)}},Vgt=.5,jgt=.43,Ugt=.45,gI=class{constructor(e,t,n=new Fn(0,0)){let{width:r,height:i}=t;this._imgDims=new Tg(r,i),this._shift=n,this._positions=e.map(a=>a.mul(new Fn(r,i)).add(n))}get shift(){return new Fn(this._shift.x,this._shift.y)}get imageWidth(){return this._imgDims.width}get imageHeight(){return this._imgDims.height}get positions(){return this._positions}get relativePositions(){return this._positions.map(e=>e.sub(this._shift).div(new Fn(this.imageWidth,this.imageHeight)))}forSize(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})}shiftBy(e,t){return new this.constructor(this.relativePositions,this._imgDims,new Fn(e,t))}shiftByPoint(e){return this.shiftBy(e.x,e.y)}align(e,t={}){if(e){let i=e instanceof nl?e.box.floor():new yh(e);return this.shiftBy(i.x,i.y).align(null,t)}let{useDlibAlignment:n,minBoxPadding:r}={useDlibAlignment:!1,minBoxPadding:.2,...t};return n?this.alignDlib():this.alignMinBbox(r)}alignDlib(){let e=this.getRefPointsForAlignment(),[t,n,r]=e,i=c=>r.sub(c).magnitude(),a=(i(t)+i(n))/2,s=Math.floor(a/Ugt),o=Lz(e),l=Math.floor(Math.max(0,o.x-Vgt*s)),u=Math.floor(Math.max(0,o.y-jgt*s));return new Ple(l,u,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+u))}alignMinBbox(e){let t=zgt(this.positions);return t.pad(t.width*e,t.height*e)}getRefPointsForAlignment(){throw new Error("getRefPointsForAlignment not implemented by base class")}},Ale=class extends gI{getJawOutline(){return this.positions.slice(0,17)}getLeftEyeBrow(){return this.positions.slice(17,22)}getRightEyeBrow(){return this.positions.slice(22,27)}getNose(){return this.positions.slice(27,36)}getLeftEye(){return this.positions.slice(36,42)}getRightEye(){return this.positions.slice(42,48)}getMouth(){return this.positions.slice(48,68)}getRefPointsForAlignment(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Lz)}},OH=class{constructor(e,t){this._label=e,this._distance=t}get label(){return this._label}get distance(){return this._distance}toString(e=!0){return`${this.label}${e?` (${mT(this.distance)})`:""}`}},w_=class Mle{constructor(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(r=>!(r instanceof Float32Array)))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}get label(){return this._label}get descriptors(){return this._descriptors}toJSON(){return{label:this.label,descriptors:this.descriptors.map(t=>Array.from(t))}}static fromJSON(t){let n=t.descriptors.map(r=>new Float32Array(r));return new Mle(t.label,n)}};function yI(e){return e.detection instanceof nl}function Rle(e,t){return{...e,detection:t}}function Dle(){let e=window.fetch;if(!e)throw new Error("fetch - missing fetch implementation for browser environment");return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:()=>document.createElement("canvas"),createImageElement:()=>document.createElement("img"),createVideoElement:()=>document.createElement("video"),fetch:e,readFile:()=>{throw new Error("readFile - filesystem not available for browser environment")}}}function Fz(){return typeof global=="object"&&typeof process<"u"&&process.versions!=null&&process.versions.node!=null}function Lle(e){let t="";if(!e&&Fz())try{e=NRe("fs")}catch(n){t=n.toString()}return{readFile:e?n=>new Promise((r,i)=>{e.readFile(n,(a,s)=>a?i(a):r(s))}):()=>{throw new Error(`readFile - failed to require fs in nodejs environment with error: ${t}`)}}}function Fle(){let e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=global.Video||global.HTMLVideoElement,r=()=>{if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},i=()=>{if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=()=>{if(n)return new n;throw new Error("createVideoElement - missing Video implementation for nodejs environment")},s=global.fetch,o=Lle();return{Canvas:e||class{},CanvasRenderingContext2D:global.CanvasRenderingContext2D||class{},Image:t||class{},ImageData:global.ImageData||class{},Video:global.HTMLVideoElement||class{},createCanvasElement:r,createImageElement:i,createVideoElement:a,fetch:s,...o}}function zle(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}var si;function Hgt(){if(!si)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return si}function pA(e){si=e}function zz(){return zle()?pA(Dle()):Fz()?pA(Fle()):null}function Ggt(e){if(si||zz(),!si)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");let{Canvas:t=si.Canvas,Image:n=si.Image}=e;si.Canvas=t,si.Image=n,si.createCanvasElement=e.createCanvasElement||(()=>new t),si.createImageElement=e.createImageElement||(()=>new n),si.ImageData=e.ImageData||si.ImageData,si.Video=e.Video||si.Video,si.fetch=e.fetch||si.fetch,si.readFile=e.readFile||si.readFile}var va={getEnv:Hgt,setEnv:pA,initialize:zz,createBrowserEnv:Dle,createFileSystem:Lle,createNodejsEnv:Fle,monkeyPatch:Ggt,isBrowser:zle,isNodejs:Fz};zz();function Bz(e){return!va.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function vd(e){let{Canvas:t,CanvasRenderingContext2D:n}=va.getEnv();if(e instanceof n)return e;let r=Bz(e);if(!(r instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");let i=r.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var Ble=(e=>(e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e))(Ble||{}),Wz=class{constructor(e={}){let{anchorPosition:t,backgroundColor:n,fontColor:r,fontSize:i,fontStyle:a,padding:s}=e;this.anchorPosition=t||"TOP_LEFT",this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=a||"Georgia",this.padding=s||4}},Vz=class Wle{constructor(t,n,r={}){this.text=typeof t=="string"?[t]:t instanceof Wle?t.text:t,this.anchor=n,this.options=new Wz(r)}measureWidth(t){let{padding:n}=this.options;return this.text.map(r=>t.measureText(r).width).reduce((r,i)=>r<i?i:r,0)+2*n}measureHeight(){let{fontSize:t,padding:n}=this.options;return this.text.length*t+2*n}getUpperLeft(t,n){let{anchorPosition:r}=this.options,i=r==="BOTTOM_RIGHT"||r==="TOP_RIGHT",a=r==="BOTTOM_LEFT"||r==="BOTTOM_RIGHT",s=this.measureWidth(t),o=this.measureHeight(),l=i?this.anchor.x-s:this.anchor.x,u=a?this.anchor.y-o:this.anchor.y;if(n){let{width:c,height:d}=n,p=Math.max(Math.min(l,c-s),0),h=Math.max(Math.min(u,d-o),0);return{x:p,y:h}}return{x:l,y:u}}draw(t){let n=Bz(t),r=vd(n),{backgroundColor:i,fontColor:a,fontSize:s,fontStyle:o,padding:l}=this.options;r.font=`${s}px ${o}`;let u=this.measureWidth(r),c=this.measureHeight();r.fillStyle=i;let d=this.getUpperLeft(r,n);r.fillRect(d.x,d.y,u,c),r.fillStyle=a,this.text.forEach((p,h)=>{let m=l+d.x,g=l+d.y+(h+1)*s;r.fillText(p,m,g)})}},Vle=class{constructor(e={}){let{boxColor:t,lineWidth:n,label:r,drawLabelOptions:i}=e;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;let a={anchorPosition:"BOTTOM_LEFT",backgroundColor:this.boxColor};this.drawLabelOptions=new Wz({...a,...i})}},jle=class{constructor(e,t={}){this.box=new yh(e),this.options=new Vle(t)}draw(e){let t=vd(e),{boxColor:n,lineWidth:r}=this.options,{x:i,y:a,width:s,height:o}=this.box;t.strokeStyle=n,t.lineWidth=r,t.strokeRect(i,a,s,o);let{label:l}=this.options;l&&new Vz([l],{x:i-r/2,y:a},this.options.drawLabelOptions).draw(e)}};function qgt(e,t){(Array.isArray(t)?t:[t]).forEach(n=>{let r=n instanceof nl?n.score:yI(n)?n.detection.score:void 0,i=n instanceof nl?n.box:yI(n)?n.detection.box:new yh(n),a=r?`${mT(r)}`:void 0;new jle(i,{label:a}).draw(e)})}function Ule(e){let{Image:t,Video:n}=va.getEnv();return e instanceof t&&e.complete||e instanceof n&&e.readyState>=3}function Kgt(e){return new Promise((t,n)=>{(e instanceof va.getEnv().Canvas||Ule(e))&&t(null);function r(a){a.currentTarget&&(a.currentTarget.removeEventListener("load",i),a.currentTarget.removeEventListener("error",r),n(a))}function i(a){a.currentTarget&&(a.currentTarget.removeEventListener("load",i),a.currentTarget.removeEventListener("error",r),t(a))}e.addEventListener("load",i),e.addEventListener("error",r)})}function Zgt(e){return new Promise((t,n)=>{e instanceof Blob||n(new Error("bufferToImage - expected buf to be of type: Blob"));let r=new FileReader;r.onload=()=>{typeof r.result!="string"&&n(new Error("bufferToImage - expected reader.result to be a string, in onload"));let i=va.getEnv().createImageElement();i.onload=()=>t(i),i.onerror=n,i.src=r.result},r.onerror=n,r.readAsDataURL(e)})}function Hle(e){let{Image:t,Video:n}=va.getEnv();return e instanceof t?new Tg(e.naturalWidth,e.naturalHeight):e instanceof n?new Tg(e.videoWidth,e.videoHeight):new Tg(e.width,e.height)}function vI({width:e,height:t}){let{createCanvasElement:n}=va.getEnv(),r=n();return r.width=e,r.height=t,r}function Gle(e,t){let{ImageData:n}=va.getEnv();if(!(e instanceof n)&&!Ule(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");let{width:r,height:i}=t||Hle(e),a=vI({width:r,height:i});return e instanceof n?vd(a).putImageData(e,0,0):vd(a).drawImage(e,0,0,r,i),a}async function Xgt(e,t){let n=t||va.getEnv().createCanvasElement(),[r,i,a]=e.shape.slice(Cu(e)?1:0),s=le(()=>e.as3D(r,i,a).toInt());return await Aw.toPixels(s,n),s.dispose(),n}function PH(e){let{Image:t,Canvas:n,Video:r}=va.getEnv();return e instanceof t||e instanceof n||e instanceof r}function Jgt(e,t,n=!1){let{Image:r,Canvas:i}=va.getEnv();if(!(e instanceof r||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");if(t<=0)return vI({width:1,height:1});let a=Hle(e),s=t/Math.max(a.height,a.width),o=s*a.width,l=s*a.height,u=vI({width:t,height:t}),c=e instanceof i?e:Gle(e),d=Math.abs(o-l)/2,p=n&&o<l?d:0,h=n&&l<o?d:0;return c.width>0&&c.height>0&&vd(u).drawImage(c,p,h,o,l),u}var bI=class{constructor(e,t=!1){if(this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],this._inputSize=0,!Array.isArray(e))throw new Error(`NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have ${e}`);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach((n,r)=>{if(qw(n)){this._imageTensors[r]=n,this._inputDimensions[r]=n.shape;return}if(Cu(n)){let a=n.shape[0];if(a!==1)throw new Error(`NetInput - tf.Tensor4D with batchSize ${a} passed, but not supported in input array`);this._imageTensors[r]=n,this._inputDimensions[r]=n.shape.slice(1);return}let i=n instanceof va.getEnv().Canvas?n:Gle(n);this._canvases[r]=i,this._inputDimensions[r]=[i.height,i.width,3]})}get imageTensors(){return this._imageTensors}get canvases(){return this._canvases}get isBatchInput(){return this.batchSize>1||this._treatAsBatchInput}get batchSize(){return this._batchSize}get inputDimensions(){return this._inputDimensions}get inputSize(){return this._inputSize}get reshapedInputDimensions(){return py(this.batchSize,0,1).map((e,t)=>this.getReshapedInputDimensions(t))}getInput(e){return this.canvases[e]||this.imageTensors[e]}getInputDimensions(e){return this._inputDimensions[e]}getInputHeight(e){return this._inputDimensions[e][0]}getInputWidth(e){return this._inputDimensions[e][1]}getReshapedInputDimensions(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");let t=this.getInputWidth(e),n=this.getInputHeight(e);return $le({width:t,height:n},this.inputSize)}toBatchTensor(e,t=!0){return this._inputSize=e,le(()=>{let n=py(this.batchSize,0,1).map(r=>{let i=this.getInput(r);if(i instanceof zt){let a=Cu(i)?i:hi(i);return a=Wgt(a,t),(a.shape[1]!==e||a.shape[2]!==e)&&(a=$s.resizeBilinear(a,[e,e],!1,!1)),a.as3D(e,e,3)}if(i instanceof va.getEnv().Canvas)return Aw.fromPixels(Jgt(i,e,t));throw new Error(`toBatchTensor - at batchIdx ${r}, expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have ${i}`)});return Wr(n.map(r=>Me(r,"float32"))).as4D(this.batchSize,e,e,3)})}};async function ba(e){if(e instanceof bI)return e;let t=Array.isArray(e)?e:[e];if(!t.length)throw new Error("toNetInput - empty array passed as input");let n=i=>Array.isArray(e)?` at input index ${i}:`:"",r=t.map(Bz);return r.forEach((i,a)=>{if(!PH(i)&&!qw(i)&&!Cu(i))throw typeof t[a]=="string"?new Error(`toNetInput -${n(a)} string passed, but could not resolve HTMLElement for element id ${t[a]}`):new Error(`toNetInput -${n(a)} expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id`);if(Cu(i)){let s=i.shape[0];if(s!==1)throw new Error(`toNetInput -${n(a)} tf.Tensor4D with batchSize ${s} passed, but not supported in input array`)}}),await Promise.all(r.map(i=>PH(i)&&Kgt(i))),new bI(r,Array.isArray(e))}async function jz(e,t){let{Canvas:n}=va.getEnv(),r=e;if(!(e instanceof n)){let a=await ba(e);if(a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");let s=a.getInput(0);r=s instanceof n?s:await Xgt(s)}let i=vd(r);return t.map(a=>a instanceof nl?a.forSize(r.width,r.height).box.floor():a).map(a=>a.clipAtImageBorders(r.width,r.height)).map(({x:a,y:s,width:o,height:l})=>{let u=vI({width:o,height:l});return o>0&&l>0&&vd(u).putImageData(i.getImageData(a,s,o,l),0,0),u})}async function Uz(e,t){if(!qw(e)&&!Cu(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Cu(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return le(()=>{let[n,r,i]=e.shape.slice(Cu(e)?1:0);return t.map(a=>a instanceof nl?a.forSize(r,n).box:a).map(a=>a.clipAtImageBorders(r,n)).filter(a=>a.width>0&&a.height>0).map(({x:a,y:s,width:o,height:l})=>Wv(e.as3D(n,r,i),[s,a,0],[l,o,i]))})}async function qle(e,t){let{fetch:n}=va.getEnv(),r=await n(e,t);if(!(r.status<400))throw new Error(`failed to fetch: (${r.status}) ${r.statusText}, from url: ${r.url}`);return r}async function AH(e){let t=await qle(e),n=await t.blob();if(!n.type.startsWith("image/"))throw new Error(`fetchImage - expected blob type to be of type image/*, instead have: ${n.type}, for url: ${t.url}`);return Zgt(n)}async function Ygt(e){return(await qle(e)).json()}function Kle(e,t){let n=`${t}-weights_manifest.json`;if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:`/${n}`};let r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");let i=e.split("/").filter(o=>o),a=e.endsWith(".json")?i[i.length-1]:n,s=r+(e.endsWith(".json")?i.slice(0,i.length-1):i).join("/");return s=e.startsWith("/")?`/${s}`:s,{modelBaseUri:s,manifestUri:s==="/"?`/${a}`:`${s}/${a}`}}async function Qgt(e,t){let{manifestUri:n,modelBaseUri:r}=Kle(e,t),i=await Ygt(n);return Ti.loadWeights(i,r)}var Vd=class{constructor(e){this._params=void 0,this._paramMappings=[],this._name=e}get params(){return this._params}get paramMappings(){return this._paramMappings}get isLoaded(){return!!this.params}getParamFromPath(e){let{obj:t,objProp:n}=this.traversePropertyPath(e);return t[n]}reassignParamFromPath(e,t){let{obj:n,objProp:r}=this.traversePropertyPath(e);n[r].dispose(),n[r]=t}getParamList(){return this._paramMappings.map(({paramPath:e})=>({path:e,tensor:this.getParamFromPath(e)}))}getTrainableParams(){return this.getParamList().filter(e=>e.tensor instanceof eh)}getFrozenParams(){return this.getParamList().filter(e=>!(e.tensor instanceof eh))}variable(){this.getFrozenParams().forEach(({path:e,tensor:t})=>{this.reassignParamFromPath(e,t.variable())})}freeze(){this.getTrainableParams().forEach(({path:e,tensor:t})=>{let n=fa(t.dataSync());t.dispose(),this.reassignParamFromPath(e,n)})}dispose(e=!0){this.getParamList().forEach(t=>{if(e&&t.tensor.isDisposed)throw new Error(`param tensor has already been disposed for path ${t.path}`);t.tensor.dispose()}),this._params=void 0}serializeParams(){return new Float32Array(this.getParamList().map(({tensor:e})=>Array.from(e.dataSync())).reduce((e,t)=>e.concat(t)))}async load(e){if(e instanceof Float32Array){this.extractWeights(e);return}await this.loadFromUri(e)}async loadFromUri(e){if(e&&typeof e!="string")throw new Error(`${this._name}.loadFromUri - expected model uri`);let t=await Qgt(e,this.getDefaultModelName());this.loadFromWeightMap(t)}async loadFromDisk(e){if(e&&typeof e!="string")throw new Error(`${this._name}.loadFromDisk - expected model file path`);let{readFile:t}=va.getEnv(),{manifestUri:n,modelBaseUri:r}=Kle(e,this.getDefaultModelName()),i=l=>Promise.all(l.map(u=>t(u).then(c=>typeof c=="string"?Buffer.from(c):c.buffer))),a=Ti.weightsLoaderFactory(i),s=JSON.parse((await t(n)).toString()),o=await a(s,r);this.loadFromWeightMap(o)}loadFromWeightMap(e){let{paramMappings:t,params:n}=this.extractParamsFromWeightMap(e);this._paramMappings=t,this._params=n}extractWeights(e){let{paramMappings:t,params:n}=this.extractParams(e);this._paramMappings=t,this._params=n}traversePropertyPath(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");let t=e.split("/").reduce((i,a)=>{if(!i.nextObj.hasOwnProperty(a))throw new Error(`traversePropertyPath - object does not have property ${a}, for path ${e}`);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),{obj:n,objProp:r}=t;if(!n||!r||!(n[r]instanceof zt))throw new Error(`traversePropertyPath - parameter is not a tensor, for path ${e}`);return{obj:n,objProp:r}}};function Es(e,t,n){return le(()=>{let r=Bv(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=we(r,t.bias),r})}function fE(e,t,n=!1){return le(()=>{let r=On(n?we(ga(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Es(e,t.conv0,[2,2])),i=Es(r,t.conv1,[1,1]),a=On(we(r,i)),s=Es(a,t.conv2,[1,1]);return On(we(r,we(i,s)))})}function x_(e,t,n=!1,r=!0){return le(()=>{let i=On(n?we(ga(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Es(e,t.conv0,r?[2,2]:[1,1])),a=Es(i,t.conv1,[1,1]),s=On(we(i,a)),o=Es(s,t.conv2,[1,1]),l=On(we(i,we(a,o))),u=Es(l,t.conv3,[1,1]);return On(we(i,we(a,we(o,u))))})}function Cb(e,t,n="same",r=!1){return le(()=>{let i=we(ga(e,t.filters,[1,1],n),t.bias);return r?On(i):i})}function jd(e,t){Object.keys(e).forEach(n=>{t.some(r=>r.originalPath===n)||e[n].dispose()})}function Hz(e,t){return(n,r,i,a)=>{let s=dd(e(n*r*i*i),[i,i,n,r]),o=Cn(e(r));return t.push({paramPath:`${a}/filters`},{paramPath:`${a}/bias`}),{filters:s,bias:o}}}function Zle(e,t){return(n,r,i)=>{let a=zl(e(n*r),[n,r]),s=Cn(e(r));return t.push({paramPath:`${i}/weights`},{paramPath:`${i}/bias`}),{weights:a,bias:s}}}var Xle=class{constructor(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n}};function Gz(e,t){return(n,r,i)=>{let a=dd(e(9*n),[3,3,n,1]),s=dd(e(n*r),[1,1,n,r]),o=Cn(e(r));return t.push({paramPath:`${i}/depthwise_filter`},{paramPath:`${i}/pointwise_filter`},{paramPath:`${i}/bias`}),new Xle(a,s,o)}}function qz(e){return t=>{let n=e(`${t}/depthwise_filter`,4),r=e(`${t}/pointwise_filter`,4),i=e(`${t}/bias`,1);return new Xle(n,r,i)}}function sm(e,t){return(n,r,i)=>{let a=e[n];if(!t0(a,r))throw new Error(`expected weightMap[${n}] to be a Tensor${r}D, instead have ${a}`);return t.push({originalPath:n,paramPath:i||n}),a}}function Ud(e){let t=e;function n(i){let a=t.slice(0,i);return t=t.slice(i),a}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function Jle(e,t){let n=Hz(e,t),r=Gz(e,t);function i(s,o,l,u=!1){let c=u?n(s,o,3,`${l}/conv0`):r(s,o,`${l}/conv0`),d=r(o,o,`${l}/conv1`),p=r(o,o,`${l}/conv2`);return{conv0:c,conv1:d,conv2:p}}function a(s,o,l,u=!1){let{conv0:c,conv1:d,conv2:p}=i(s,o,l,u),h=r(o,o,`${l}/conv3`);return{conv0:c,conv1:d,conv2:p,conv3:h}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function eyt(e){let t=[],{extractWeights:n,getRemainingWeights:r}=Ud(e),{extractDenseBlock4Params:i}=Jle(n,t),a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),o=i(64,128,"dense2"),l=i(128,256,"dense3");if(r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:o,dense3:l}}}function Yle(e){return t=>{let n=e(`${t}/filters`,4),r=e(`${t}/bias`,1);return{filters:n,bias:r}}}function Qle(e,t){let n=sm(e,t),r=Yle(n),i=qz(n);function a(o,l=!1){let u=l?r(`${o}/conv0`):i(`${o}/conv0`),c=i(`${o}/conv1`),d=i(`${o}/conv2`);return{conv0:u,conv1:c,conv2:d}}function s(o,l=!1){let u=l?r(`${o}/conv0`):i(`${o}/conv0`),c=i(`${o}/conv1`),d=i(`${o}/conv2`),p=i(`${o}/conv3`);return{conv0:u,conv1:c,conv2:d,conv3:p}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:s}}function tyt(e){let t=[],{extractDenseBlock4Params:n}=Qle(e,t),r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return jd(e,t),{params:r,paramMappings:t}}var eue=class extends Vd{constructor(){super("FaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return le(()=>{let n=Me(e.toBatchTensor(112,!0),"float32"),r=Kw(n,[122.782,117.001,104.298]).div(255),i=x_(r,t.dense0,!0);return i=x_(i,t.dense1),i=x_(i,t.dense2),i=x_(i,t.dense3),i=Gu(i,[7,7],[2,2],"valid"),i})}async forward(e){return this.forwardInput(await ba(e))}getDefaultModelName(){return"face_feature_extractor_model"}extractParamsFromWeightMap(e){return tyt(e)}extractParams(e){return eyt(e)}};function hA(e,t){return le(()=>we(jt(e,t.weights),t.bias))}function nyt(e,t,n){let r=[],{extractWeights:i,getRemainingWeights:a}=Ud(e),s=Zle(i,r)(t,n,"fc");if(a().length!==0)throw new Error(`weights remaing after extract: ${a().length}`);return{paramMappings:r,params:{fc:s}}}function ryt(e){let t=[],n=sm(e,t);function r(a){let s=n(`${a}/weights`,2),o=n(`${a}/bias`,1);return{weights:s,bias:o}}let i={fc:r("fc")};return jd(e,t),{params:i,paramMappings:t}}function tue(e){let t={},n={};return Object.keys(e).forEach(r=>{let i=r.startsWith("fc")?n:t;i[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var nue=class extends Vd{constructor(e,t){super(e),this._faceFeatureExtractor=t}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error(`${this._name} - load model before inference`);return le(()=>{let n=e instanceof bI?this.faceFeatureExtractor.forwardInput(e):e;return hA(n.as2D(n.shape[0],-1),t.fc)})}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return nyt(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=tue(e);return this.faceFeatureExtractor.loadFromWeightMap(t),ryt(n)}extractParams(e){let t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,i=e.slice(0,e.length-r),a=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(a)}},MH=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Kz=class{constructor(e){if(this.neutral=0,this.happy=0,this.sad=0,this.angry=0,this.fearful=0,this.disgusted=0,this.surprised=0,e.length!==7)throw new Error(`FaceExpressions.constructor - expected probabilities.length to be 7, have: ${e.length}`);MH.forEach((t,n)=>{this[t]=e[n]})}asSortedArray(){return MH.map(e=>({expression:e,probability:this[e]})).sort((e,t)=>t.probability-e.probability)}},iyt=class extends nue{constructor(e=new eue){super("FaceExpressionNet",e)}forwardInput(e){return le(()=>Dd(this.runNet(e)))}async forward(e){return this.forwardInput(await ba(e))}async predictExpressions(e){let t=await ba(e),n=await this.forwardInput(t),r=await Promise.all(Ir(n).map(async a=>{let s=a.dataSync();return a.dispose(),s}));n.dispose();let i=r.map(a=>new Kz(a));return t.isBatchInput?i:i[0]}getDefaultModelName(){return"face_expression_model"}getClassifierChannelsIn(){return 256}getClassifierChannelsOut(){return 7}};function ayt(e){return e.expressions instanceof Kz}function rue(e,t){return{...e,expressions:t}}function syt(e,t,n=.1,r){(Array.isArray(t)?t:[t]).forEach(i=>{let a=i instanceof Kz?i:ayt(i)?i.expressions:void 0;if(!a)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");let s=a.asSortedArray().filter(l=>l.probability>n),o=yI(i)?i.detection.box.bottomLeft:r||new Fn(0,0);new Vz(s.map(l=>`${l.expression} (${mT(l.probability)})`),o).draw(e)})}function iue(e){return yI(e)&&e.landmarks instanceof gI&&e.unshiftedLandmarks instanceof gI&&e.alignedRect instanceof nl}function oyt(e){let t=l=>l*180/Math.PI,n=(l,u)=>Math.sqrt((l.x-u.x)**2+(l.y-u.y)**2),r={roll:void 0,pitch:void 0,yaw:void 0},i=(l,u,c)=>{let d=Math.floor(l.x-u.x),p=Math.floor(u.x-c.x);return d-p},a=(l,u)=>{let c=Math.hypot(u.x-l.x,u.y-l.y),d=u.y-l.y,p=Math.asin(d/c),h=t(p),m=Math.floor(90-h),g=u.x-l.x<0?-1:1;return m*g},s=(l,u,c)=>{let d=n(l,c),p=new Fn((l.x+c.x)/2,(l.y+c.y)/2),h=n(u,p),m=Math.atan(h/d),g=Math.floor(t(m)),v=p.y-u.y<0?-1:1;return g*v};if(!e||!e.positions||e.positions.length!==68)return r;let o=e.positions;return r.roll=a(o[27],o[66]),r.pitch=s(o[14],o[30],o[2]),r.yaw=i(o[14],o[33],o[2]),r}function aue(e,t){let{box:n}=e.detection,r=t.shiftBy(n.x,n.y),i=r.align(),{imageDims:a}=e.detection,s=new nl(e.detection.score,i.rescale(a.reverse()),a),o=oyt(t);return{...e,landmarks:r,unshiftedLandmarks:t,alignedRect:s,angle:o}}var sue=class{constructor(e={}){let{drawLines:t=!0,drawPoints:n=!0,lineWidth:r,lineColor:i,pointSize:a,pointColor:s}=e;this.drawLines=t,this.drawPoints=n,this.lineWidth=r||1,this.pointSize=a||2,this.lineColor=i||"rgba(0, 255, 255, 1)",this.pointColor=s||"rgba(255, 0, 255, 1)"}},oue=class{constructor(e,t={}){this.faceLandmarks=e,this.options=new sue(t)}draw(e){let t=vd(e),{drawLines:n,drawPoints:r,lineWidth:i,lineColor:a,pointSize:s,pointColor:o}=this.options;if(n&&this.faceLandmarks instanceof Ale&&(t.strokeStyle=a,t.lineWidth=i,mc(t,this.faceLandmarks.getJawOutline()),mc(t,this.faceLandmarks.getLeftEyeBrow()),mc(t,this.faceLandmarks.getRightEyeBrow()),mc(t,this.faceLandmarks.getNose()),mc(t,this.faceLandmarks.getLeftEye(),!0),mc(t,this.faceLandmarks.getRightEye(),!0),mc(t,this.faceLandmarks.getMouth(),!0)),r){t.strokeStyle=o,t.fillStyle=o;let l=u=>{t.beginPath(),t.arc(u.x,u.y,s,0,2*Math.PI),t.fill()};this.faceLandmarks.positions.forEach(l)}}};function lyt(e,t){(Array.isArray(t)?t:[t]).forEach(n=>{let r=n instanceof gI?n:iue(n)?n.landmarks:void 0;if(!r)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new oue(r).draw(e)})}function uyt(e,t){let n=Hz(e,t),r=Gz(e,t);function i(s,o,l){let u=r(s,o,`${l}/separable_conv0`),c=r(o,o,`${l}/separable_conv1`),d=n(s,o,1,`${l}/expansion_conv`);return{separable_conv0:u,separable_conv1:c,expansion_conv:d}}function a(s,o){let l=r(s,s,`${o}/separable_conv0`),u=r(s,s,`${o}/separable_conv1`),c=r(s,s,`${o}/separable_conv2`);return{separable_conv0:l,separable_conv1:u,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:i,extractMainBlockParams:a}}function cyt(e,t){let n=[],{extractWeights:r,getRemainingWeights:i}=Ud(e),{extractConvParams:a,extractSeparableConvParams:s,extractReductionBlockParams:o,extractMainBlockParams:l}=uyt(r,n),u=a(3,32,3,"entry_flow/conv_in"),c=o(32,64,"entry_flow/reduction_block_0"),d=o(64,128,"entry_flow/reduction_block_1"),p={conv_in:u,reduction_block_0:c,reduction_block_1:d},h={};py(t,0,1).forEach(y=>{h[`main_block_${y}`]=l(128,`middle_flow/main_block_${y}`)});let m=o(128,256,"exit_flow/reduction_block"),g=s(256,512,"exit_flow/separable_conv"),v={reduction_block:m,separable_conv:g};if(i().length!==0)throw new Error(`weights remaing after extract: ${i().length}`);return{paramMappings:n,params:{entry_flow:p,middle_flow:h,exit_flow:v}}}function dyt(e,t){let n=sm(e,t),r=Yle(n),i=qz(n);function a(o){let l=i(`${o}/separable_conv0`),u=i(`${o}/separable_conv1`),c=r(`${o}/expansion_conv`);return{separable_conv0:l,separable_conv1:u,expansion_conv:c}}function s(o){let l=i(`${o}/separable_conv0`),u=i(`${o}/separable_conv1`),c=i(`${o}/separable_conv2`);return{separable_conv0:l,separable_conv1:u,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:i,extractReductionBlockParams:a,extractMainBlockParams:s}}function pyt(e,t){let n=[],{extractConvParams:r,extractSeparableConvParams:i,extractReductionBlockParams:a,extractMainBlockParams:s}=dyt(e,n),o=r("entry_flow/conv_in"),l=a("entry_flow/reduction_block_0"),u=a("entry_flow/reduction_block_1"),c={conv_in:o,reduction_block_0:l,reduction_block_1:u},d={};py(t,0,1).forEach(g=>{d[`main_block_${g}`]=s(`middle_flow/main_block_${g}`)});let p=a("exit_flow/reduction_block"),h=i("exit_flow/separable_conv"),m={reduction_block:p,separable_conv:h};return jd(e,n),{params:{entry_flow:c,middle_flow:d,exit_flow:m},paramMappings:n}}function lue(e,t,n){return we(ga(e,t.filters,n,"same"),t.bias)}function mE(e,t,n=!0){let r=n?On(e):e;return r=Es(r,t.separable_conv0,[1,1]),r=Es(On(r),t.separable_conv1,[1,1]),r=oi(r,[3,3],[2,2],"same"),r=we(r,lue(e,t.expansion_conv,[2,2])),r}function hyt(e,t){let n=Es(On(e),t.separable_conv0,[1,1]);return n=Es(On(n),t.separable_conv1,[1,1]),n=Es(On(n),t.separable_conv2,[1,1]),n=we(n,e),n}var fyt=class extends Vd{constructor(e){super("TinyXception"),this._numMainBlocks=e}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyXception - load model before inference");return le(()=>{let n=Me(e.toBatchTensor(112,!0),"float32"),r=Kw(n,[122.782,117.001,104.298]).div(255),i=On(lue(r,t.entry_flow.conv_in,[2,2]));return i=mE(i,t.entry_flow.reduction_block_0,!1),i=mE(i,t.entry_flow.reduction_block_1),py(this._numMainBlocks,0,1).forEach(a=>{i=hyt(i,t.middle_flow[`main_block_${a}`])}),i=mE(i,t.exit_flow.reduction_block),i=On(Es(i,t.exit_flow.separable_conv,[1,1])),i})}async forward(e){return this.forwardInput(await ba(e))}getDefaultModelName(){return"tiny_xception_model"}extractParamsFromWeightMap(e){return pyt(e,this._numMainBlocks)}extractParams(e){return cyt(e,this._numMainBlocks)}};function myt(e){let t=[],{extractWeights:n,getRemainingWeights:r}=Ud(e),i=Zle(n,t),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}function gyt(e){let t=[],n=sm(e,t);function r(a){let s=n(`${a}/weights`,2),o=n(`${a}/bias`,1);return{weights:s,bias:o}}let i={fc:{age:r("fc/age"),gender:r("fc/gender")}};return jd(e,t),{params:i,paramMappings:t}}var yyt=(e=>(e.FEMALE="female",e.MALE="male",e))(yyt||{}),vyt=class extends Vd{constructor(e=new fyt(2)){super("AgeGenderNet"),this._faceFeatureExtractor=e}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error(`${this._name} - load model before inference`);return le(()=>{let n=e instanceof bI?this.faceFeatureExtractor.forwardInput(e):e,r=Gu(n,[7,7],[2,2],"valid").as2D(n.shape[0],-1),i=hA(r,t.fc.age).as1D(),a=hA(r,t.fc.gender);return{age:i,gender:a}})}forwardInput(e){return le(()=>{let{age:t,gender:n}=this.runNet(e);return{age:t,gender:Dd(n)}})}async forward(e){return this.forwardInput(await ba(e))}async predictAgeAndGender(e){let t=await ba(e),n=await this.forwardInput(t),r=Ir(n.age),i=Ir(n.gender),a=r.map((o,l)=>({ageTensor:o,genderTensor:i[l]})),s=await Promise.all(a.map(async({ageTensor:o,genderTensor:l})=>{let u=o.dataSync()[0],c=l.dataSync()[0],d=c>.5,p=d?"male":"female",h=d?c:1-c;return o.dispose(),l.dispose(),{age:u,gender:p,genderProbability:h}}));return n.age.dispose(),n.gender.dispose(),t.isBatchInput?s:s[0]}getDefaultModelName(){return"age_gender_model"}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return myt(e)}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=tue(e);return this.faceFeatureExtractor.loadFromWeightMap(t),gyt(n)}extractParams(e){let t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)}},uue=class extends nue{postProcess(e,t,n){let r=n.map(({width:a,height:s})=>{let o=t/Math.max(s,a);return{width:a*o,height:s*o}}),i=r.length;return le(()=>{let a=(u,c)=>Wr([ds([68],u,"float32"),ds([68],c,"float32")],1).as2D(1,136).as1D(),s=(u,c)=>{let{width:d,height:p}=r[u];return c(d,p)?Math.abs(d-p)/2:0},o=u=>s(u,(c,d)=>c<d),l=u=>s(u,(c,d)=>d<c);return e.mul(ds([i,136],t,"float32")).sub(Wr(Array.from(Array(i),(u,c)=>a(o(c),l(c))))).div(Wr(Array.from(Array(i),(u,c)=>a(r[c].width,r[c].height))))})}forwardInput(e){return le(()=>{let t=this.runNet(e);return this.postProcess(t,e.inputSize,e.inputDimensions.map(([n,r])=>({height:n,width:r})))})}async forward(e){return this.forwardInput(await ba(e))}async detectLandmarks(e){let t=await ba(e),n=le(()=>Ir(this.forwardInput(t))),r=await Promise.all(n.map(async(i,a)=>{let s=Array.from(i.dataSync()),o=s.filter((u,c)=>cA(c)),l=s.filter((u,c)=>!cA(c));return new Ale(Array(68).fill(0).map((u,c)=>new Fn(o[c],l[c])),{height:t.getInputHeight(a),width:t.getInputWidth(a)})}));return n.forEach(i=>i.dispose()),t.isBatchInput?r:r[0]}getClassifierChannelsOut(){return 136}},byt=class extends uue{constructor(e=new eue){super("FaceLandmark68Net",e)}getDefaultModelName(){return"face_landmark_68_model"}getClassifierChannelsIn(){return 256}};function wyt(e){let t=[],{extractDenseBlock3Params:n}=Qle(e,t),r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return jd(e,t),{params:r,paramMappings:t}}function xyt(e){let t=[],{extractWeights:n,getRemainingWeights:r}=Ud(e),{extractDenseBlock3Params:i}=Jle(n,t),a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),o=i(64,128,"dense2");if(r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:o}}}var _yt=class extends Vd{constructor(){super("TinyFaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return le(()=>{let n=Me(e.toBatchTensor(112,!0),"float32"),r=Kw(n,[122.782,117.001,104.298]).div(255),i=fE(r,t.dense0,!0);return i=fE(i,t.dense1),i=fE(i,t.dense2),i=Gu(i,[14,14],[2,2],"valid"),i})}async forward(e){return this.forwardInput(await ba(e))}getDefaultModelName(){return"face_feature_extractor_tiny_model"}extractParamsFromWeightMap(e){return wyt(e)}extractParams(e){return xyt(e)}},kyt=class extends uue{constructor(e=new _yt){super("FaceLandmark68TinyNet",e)}getDefaultModelName(){return"face_landmark_68_tiny_model"}getClassifierChannelsIn(){return 128}};function Syt(e,t){return we(ae(e,t.weights),t.biases)}function Zz(e,t,n,r,i="same"){let{filters:a,bias:s}=t.conv,o=ga(e,a,n,i);return o=we(o,s),o=Syt(o,t.scale),r?On(o):o}function Cyt(e,t){return Zz(e,t,[1,1],!0)}function cue(e,t){return Zz(e,t,[1,1],!1)}function due(e,t){return Zz(e,t,[2,2],!0,"valid")}function Iyt(e,t){function n(o,l,u){let c=e(o),d=c.length/(l*u*u);if(Ile(d))throw new Error(`depth has to be an integer: ${d}, weights.length: ${c.length}, numFilters: ${l}, filterSize: ${u}`);return le(()=>Ut(dd(c,[l,d,u,u]),[2,3,1,0]))}function r(o,l,u,c){let d=n(o,l,u),p=Cn(e(l));return t.push({paramPath:`${c}/filters`},{paramPath:`${c}/bias`}),{filters:d,bias:p}}function i(o,l){let u=Cn(e(o)),c=Cn(e(o));return t.push({paramPath:`${l}/weights`},{paramPath:`${l}/biases`}),{weights:u,biases:c}}function a(o,l,u,c){let d=r(o,l,u,`${c}/conv`),p=i(l,`${c}/scale`);return{conv:d,scale:p}}function s(o,l,u,c,d=!1){let p=a((d?.5:1)*o,l,u,`${c}/conv1`),h=a(o,l,u,`${c}/conv2`);return{conv1:p,conv2:h}}return{extractConvLayerParams:a,extractResidualLayerParams:s}}function $yt(e){let{extractWeights:t,getRemainingWeights:n}=Ud(e),r=[],{extractConvLayerParams:i,extractResidualLayerParams:a}=Iyt(t,r),s=i(4704,32,7,"conv32_down"),o=a(9216,32,3,"conv32_1"),l=a(9216,32,3,"conv32_2"),u=a(9216,32,3,"conv32_3"),c=a(36864,64,3,"conv64_down",!0),d=a(36864,64,3,"conv64_1"),p=a(36864,64,3,"conv64_2"),h=a(36864,64,3,"conv64_3"),m=a(147456,128,3,"conv128_down",!0),g=a(147456,128,3,"conv128_1"),v=a(147456,128,3,"conv128_2"),y=a(589824,256,3,"conv256_down",!0),b=a(589824,256,3,"conv256_1"),_=a(589824,256,3,"conv256_2"),k=a(589824,256,3,"conv256_down_out"),C=le(()=>Ut(zl(t(256*128),[128,256]),[1,0]));if(r.push({paramPath:"fc"}),n().length!==0)throw new Error(`weights remaing after extract: ${n().length}`);return{params:{conv32_down:s,conv32_1:o,conv32_2:l,conv32_3:u,conv64_down:c,conv64_1:d,conv64_2:p,conv64_3:h,conv128_down:m,conv128_1:g,conv128_2:v,conv256_down:y,conv256_1:b,conv256_2:_,conv256_down_out:k,fc:C},paramMappings:r}}function Tyt(e,t){let n=sm(e,t);function r(s){let o=n(`${s}/scale/weights`,1),l=n(`${s}/scale/biases`,1);return{weights:o,biases:l}}function i(s){let o=n(`${s}/conv/filters`,4),l=n(`${s}/conv/bias`,1),u=r(s);return{conv:{filters:o,bias:l},scale:u}}function a(s){return{conv1:i(`${s}/conv1`),conv2:i(`${s}/conv2`)}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function Nyt(e){let t=[],{extractConvLayerParams:n,extractResidualLayerParams:r}=Tyt(e,t),i=n("conv32_down"),a=r("conv32_1"),s=r("conv32_2"),o=r("conv32_3"),l=r("conv64_down"),u=r("conv64_1"),c=r("conv64_2"),d=r("conv64_3"),p=r("conv128_down"),h=r("conv128_1"),m=r("conv128_2"),g=r("conv256_down"),v=r("conv256_1"),y=r("conv256_2"),b=r("conv256_down_out"),{fc:_}=e;if(t.push({originalPath:"fc",paramPath:"fc"}),!Cle(_))throw new Error(`expected weightMap[fc] to be a Tensor2D, instead have ${_}`);let k={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:o,conv64_down:l,conv64_1:u,conv64_2:c,conv64_3:d,conv128_down:p,conv128_1:h,conv128_2:m,conv256_down:g,conv256_1:v,conv256_2:y,conv256_down_out:b,fc:_};return jd(e,t),{params:k,paramMappings:t}}function hl(e,t){let n=Cyt(e,t.conv1);return n=cue(n,t.conv2),n=we(n,e),n=On(n),n}function __(e,t){let n=due(e,t.conv1);n=cue(n,t.conv2);let r=Gu(e,2,2,"valid"),i=br(r.shape),a=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){let s=[...n.shape];s[1]=1;let o=br(s);n=Wn([n,o],1);let l=[...n.shape];l[2]=1;let u=br(l);n=Wn([n,u],2)}return r=a?Wn([r,i],3):r,n=we(r,n),n=On(n),n}var Eyt=class extends Vd{constructor(){super("FaceRecognitionNet")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return le(()=>{let n=Me(e.toBatchTensor(150,!0),"float32"),r=Kw(n,[122.782,117.001,104.298]).div(255),i=due(r,t.conv32_down);i=oi(i,3,2,"valid"),i=hl(i,t.conv32_1),i=hl(i,t.conv32_2),i=hl(i,t.conv32_3),i=__(i,t.conv64_down),i=hl(i,t.conv64_1),i=hl(i,t.conv64_2),i=hl(i,t.conv64_3),i=__(i,t.conv128_down),i=hl(i,t.conv128_1),i=hl(i,t.conv128_2),i=__(i,t.conv256_down),i=hl(i,t.conv256_1),i=hl(i,t.conv256_2),i=__(i,t.conv256_down_out);let a=i.mean([1,2]);return jt(a,t.fc)})}async forward(e){return this.forwardInput(await ba(e))}async computeFaceDescriptor(e){var t;if((t=e==null?void 0:e.shape)!=null&&t.some(a=>a<=0))return new Float32Array(128);let n=await ba(e),r=le(()=>Ir(this.forwardInput(n))),i=await Promise.all(r.map(a=>a.data()));return r.forEach(a=>a.dispose()),n.isBatchInput?i:i[0]}getDefaultModelName(){return"face_recognition_model"}extractParamsFromWeightMap(e){return Nyt(e)}extractParams(e){return $yt(e)}};function pue(e,t){return{...e,descriptor:t}}function hue(e,t){return{...e,age:t}}function fue(e,t,n){return{...e,gender:t,genderProbability:n}}function Oyt(e,t){function n(l,u){let c=dd(e(9*l),[3,3,l,1]),d=Cn(e(l)),p=Cn(e(l)),h=Cn(e(l)),m=Cn(e(l));return t.push({paramPath:`${u}/filters`},{paramPath:`${u}/batch_norm_scale`},{paramPath:`${u}/batch_norm_offset`},{paramPath:`${u}/batch_norm_mean`},{paramPath:`${u}/batch_norm_variance`}),{filters:c,batch_norm_scale:d,batch_norm_offset:p,batch_norm_mean:h,batch_norm_variance:m}}function r(l,u,c,d,p){let h=dd(e(l*u*c*c),[c,c,l,u]),m=Cn(e(u));return t.push({paramPath:`${d}/filters`},{paramPath:`${d}/${p?"batch_norm_offset":"bias"}`}),{filters:h,bias:m}}function i(l,u,c,d){let{filters:p,bias:h}=r(l,u,c,d,!0);return{filters:p,batch_norm_offset:h}}function a(l,u,c){let d=n(l,`${c}/depthwise_conv`),p=i(l,u,1,`${c}/pointwise_conv`);return{depthwise_conv:d,pointwise_conv:p}}function s(){let l=i(3,32,3,"mobilenetv1/conv_0"),u=a(32,64,"mobilenetv1/conv_1"),c=a(64,128,"mobilenetv1/conv_2"),d=a(128,128,"mobilenetv1/conv_3"),p=a(128,256,"mobilenetv1/conv_4"),h=a(256,256,"mobilenetv1/conv_5"),m=a(256,512,"mobilenetv1/conv_6"),g=a(512,512,"mobilenetv1/conv_7"),v=a(512,512,"mobilenetv1/conv_8"),y=a(512,512,"mobilenetv1/conv_9"),b=a(512,512,"mobilenetv1/conv_10"),_=a(512,512,"mobilenetv1/conv_11"),k=a(512,1024,"mobilenetv1/conv_12"),C=a(1024,1024,"mobilenetv1/conv_13");return{conv_0:l,conv_1:u,conv_2:c,conv_3:d,conv_4:p,conv_5:h,conv_6:m,conv_7:g,conv_8:v,conv_9:y,conv_10:b,conv_11:_,conv_12:k,conv_13:C}}function o(){let l=i(1024,256,1,"prediction_layer/conv_0"),u=i(256,512,3,"prediction_layer/conv_1"),c=i(512,128,1,"prediction_layer/conv_2"),d=i(128,256,3,"prediction_layer/conv_3"),p=i(256,128,1,"prediction_layer/conv_4"),h=i(128,256,3,"prediction_layer/conv_5"),m=i(256,64,1,"prediction_layer/conv_6"),g=i(64,128,3,"prediction_layer/conv_7"),v=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),y=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),b=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),_=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),k=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),C=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),$=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),N=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),A=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),D=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),O=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),F=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor");return{conv_0:l,conv_1:u,conv_2:c,conv_3:d,conv_4:p,conv_5:h,conv_6:m,conv_7:g,box_predictor_0:{box_encoding_predictor:v,class_predictor:y},box_predictor_1:{box_encoding_predictor:b,class_predictor:_},box_predictor_2:{box_encoding_predictor:k,class_predictor:C},box_predictor_3:{box_encoding_predictor:$,class_predictor:N},box_predictor_4:{box_encoding_predictor:A,class_predictor:D},box_predictor_5:{box_encoding_predictor:O,class_predictor:F}}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:o}}function Pyt(e){let t=[],{extractWeights:n,getRemainingWeights:r}=Ud(e),{extractMobilenetV1Params:i,extractPredictionLayerParams:a}=Oyt(n,t),s=i(),o=a(),l={extra_dim:N$(n(5118*4),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{params:{mobilenetv1:s,prediction_layer:o,output_layer:l},paramMappings:t}}function Ayt(e,t){let n=sm(e,t);function r(u,c,d){let p=n(`${u}/Conv2d_${c}_pointwise/weights`,4,`${d}/filters`),h=n(`${u}/Conv2d_${c}_pointwise/convolution_bn_offset`,1,`${d}/batch_norm_offset`);return{filters:p,batch_norm_offset:h}}function i(u){let c=`mobilenetv1/conv_${u}`,d=`MobilenetV1/Conv2d_${u}_depthwise`,p=`${c}/depthwise_conv`,h=`${c}/pointwise_conv`,m=n(`${d}/depthwise_weights`,4,`${p}/filters`),g=n(`${d}/BatchNorm/gamma`,1,`${p}/batch_norm_scale`),v=n(`${d}/BatchNorm/beta`,1,`${p}/batch_norm_offset`),y=n(`${d}/BatchNorm/moving_mean`,1,`${p}/batch_norm_mean`),b=n(`${d}/BatchNorm/moving_variance`,1,`${p}/batch_norm_variance`);return{depthwise_conv:{filters:m,batch_norm_scale:g,batch_norm_offset:v,batch_norm_mean:y,batch_norm_variance:b},pointwise_conv:r("MobilenetV1",u,h)}}function a(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:i(1),conv_2:i(2),conv_3:i(3),conv_4:i(4),conv_5:i(5),conv_6:i(6),conv_7:i(7),conv_8:i(8),conv_9:i(9),conv_10:i(10),conv_11:i(11),conv_12:i(12),conv_13:i(13)}}function s(u,c){let d=n(`${u}/weights`,4,`${c}/filters`),p=n(`${u}/biases`,1,`${c}/bias`);return{filters:d,bias:p}}function o(u){let c=s(`Prediction/BoxPredictor_${u}/BoxEncodingPredictor`,`prediction_layer/box_predictor_${u}/box_encoding_predictor`),d=s(`Prediction/BoxPredictor_${u}/ClassPredictor`,`prediction_layer/box_predictor_${u}/class_predictor`);return{box_encoding_predictor:c,class_predictor:d}}function l(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:o(0),box_predictor_1:o(1),box_predictor_2:o(2),box_predictor_3:o(3),box_predictor_4:o(4),box_predictor_5:o(5)}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:l}}function Myt(e){let t=[],{extractMobilenetV1Params:n,extractPredictionLayerParams:r}=Ayt(e,t),i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!qw(i))throw new Error(`expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have ${i}`);let a={mobilenetv1:n(),prediction_layer:r(),output_layer:{extra_dim:i}};return jd(e,t),{params:a,paramMappings:t}}function yl(e,t,n){return le(()=>{let r=ga(e,t.filters,n,"same");return r=we(r,t.batch_norm_offset),Yi(r,0,6)})}var Ryt=.0010000000474974513;function Dyt(e,t,n){return le(()=>{let r=Xf(e,t.filters,n,"same");return r=Zf(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,Ryt),Yi(r,0,6)})}function Lyt(e){return[2,4,6,12].some(t=>t===e)?[2,2]:[1,1]}function Fyt(e,t){return le(()=>{let n,r=yl(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach((i,a)=>{let s=a+1,o=Lyt(s);r=Dyt(r,i.depthwise_conv,o),r=yl(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function zyt(e,t,n){let r=e.arraySync(),i=Math.min(r[t][0],r[t][2]),a=Math.min(r[t][1],r[t][3]),s=Math.max(r[t][0],r[t][2]),o=Math.max(r[t][1],r[t][3]),l=Math.min(r[n][0],r[n][2]),u=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),p=(s-i)*(o-a),h=(c-l)*(d-u);if(p<=0||h<=0)return 0;let m=Math.max(i,l),g=Math.max(a,u),v=Math.min(s,c),y=Math.min(o,d),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(p+h-b)}function Byt(e,t,n,r,i){let a=e.shape[0],s=Math.min(n,a),o=t.map((c,d)=>({score:c,boxIndex:d})).filter(c=>c.score>i).sort((c,d)=>d.score-c.score),l=c=>c<=r?1:0,u=[];return o.forEach(c=>{if(u.length>=s)return;let d=c.score;for(let p=u.length-1;p>=0;--p){let h=zyt(e,c.boxIndex,u[p]);if(h!==0&&(c.score*=l(h),c.score<=i))break}d===c.score&&u.push(c.boxIndex)}),u}function Wyt(e){let t=Ir(Ut(e,[1,0])),n=[Ve(t[2],t[0]),Ve(t[3],t[1])],r=[we(t[0],et(n[0],2)),we(t[1],et(n[1],2))];return{sizes:n,centers:r}}function Vyt(e,t){let{sizes:n,centers:r}=Wyt(e),i=Ir(Ut(t,[1,0])),a=et(ae(Qi(et(i[2],5)),n[0]),2),s=we(ae(et(i[0],10),n[0]),r[0]),o=et(ae(Qi(et(i[3],5)),n[1]),2),l=we(ae(et(i[1],10),n[1]),r[1]);return Ut(Wr([Ve(s,a),Ve(l,o),we(s,a),we(l,o)]),[1,0])}function jyt(e,t,n){return le(()=>{let r=e.shape[0],i=Vyt(oe(ss(n.extra_dim,[r,1,1]),[-1,4]),oe(e,[-1,4]));i=oe(i,[r,i.shape[0]/r,4]);let a=lo(nn(t,[0,0,1],[-1,-1,-1])),s=nn(a,[0,0,0],[-1,-1,1]);s=oe(s,[r,s.shape[1]]);let o=Ir(i),l=Ir(s);return{boxes:o,scores:l}})}function Fm(e,t){return le(()=>{let n=e.shape[0],r=oe(Cb(e,t.box_encoding_predictor),[n,-1,1,4]),i=oe(Cb(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:i}})}function Uyt(e,t,n){return le(()=>{let r=yl(e,n.conv_0,[1,1]),i=yl(r,n.conv_1,[2,2]),a=yl(i,n.conv_2,[1,1]),s=yl(a,n.conv_3,[2,2]),o=yl(s,n.conv_4,[1,1]),l=yl(o,n.conv_5,[2,2]),u=yl(l,n.conv_6,[1,1]),c=yl(u,n.conv_7,[2,2]),d=Fm(t,n.box_predictor_0),p=Fm(e,n.box_predictor_1),h=Fm(i,n.box_predictor_2),m=Fm(s,n.box_predictor_3),g=Fm(l,n.box_predictor_4),v=Fm(c,n.box_predictor_5),y=Wn([d.boxPredictionEncoding,p.boxPredictionEncoding,h.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding,v.boxPredictionEncoding],1),b=Wn([d.classPrediction,p.classPrediction,h.classPrediction,m.classPrediction,g.classPrediction,v.classPrediction],1);return{boxPredictions:y,classPredictions:b}})}var vh=class{constructor({minConfidence:e,maxResults:t}={}){if(this._name="SsdMobilenetv1Options",this._minConfidence=e||.5,this._maxResults=t||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(`${this._name} - expected minConfidence to be a number between 0 and 1`);if(typeof this._maxResults!="number")throw new Error(`${this._name} - expected maxResults to be a number`)}get minConfidence(){return this._minConfidence}get maxResults(){return this._maxResults}},Hyt=class extends Vd{constructor(){super("SsdMobilenetv1")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return le(()=>{let n=Me(e.toBatchTensor(512,!1),"float32"),r=Ve(et(n,127.5),1),i=Fyt(r,t.mobilenetv1),{boxPredictions:a,classPredictions:s}=Uyt(i.out,i.conv11,t.prediction_layer);return jyt(a,s,t.output_layer)})}async forward(e){return this.forwardInput(await ba(e))}async locateFaces(e,t={}){let{maxResults:n,minConfidence:r}=new vh(t),i=await ba(e),{boxes:a,scores:s}=this.forwardInput(i),o=a[0],l=s[0];for(let y=1;y<a.length;y++)a[y].dispose(),s[y].dispose();let u=Array.from(l.dataSync()),c=Byt(o,u,n,.5,r),d=i.getReshapedInputDimensions(0),p=i.inputSize,h=p/d.width,m=p/d.height,g=o.arraySync(),v=c.map(y=>{let[b,_]=[Math.max(0,g[y][0]),Math.min(1,g[y][2])].map($=>$*m),[k,C]=[Math.max(0,g[y][1]),Math.min(1,g[y][3])].map($=>$*h);return new nl(u[y],new Ple(k,b,C-k,_-b),{height:i.getInputHeight(0),width:i.getInputWidth(0)})});return o.dispose(),l.dispose(),v}getDefaultModelName(){return"ssd_mobilenetv1_model"}extractParamsFromWeightMap(e){return Myt(e)}extractParams(e){return Pyt(e)}},Gyt=.4,qyt=[new Fn(.738768,.874946),new Fn(2.42204,2.65704),new Fn(4.30971,7.04493),new Fn(10.246,4.59428),new Fn(12.6868,11.8741)],Kyt=[new Fn(1.603231,2.094468),new Fn(6.041143,7.080126),new Fn(2.882459,3.518061),new Fn(4.266906,5.178857),new Fn(9.041765,10.66308)],Zyt=[117.001,114.697,97.404],Xyt="tiny_yolov2_model",Jyt="tiny_yolov2_separable_conv_model",k_=e=>typeof e=="number";function Yyt(e){if(!e)throw new Error(`invalid config: ${e}`);if(typeof e.withSeparableConvs!="boolean")throw new Error(`config.withSeparableConvs has to be a boolean, have: ${e.withSeparableConvs}`);if(!k_(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error(`config.iouThreshold has to be a number between [0, 1], have: ${e.iouThreshold}`);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(t=>typeof t=="string"))throw new Error(`config.classes has to be an array class names: string[], have: ${JSON.stringify(e.classes)}`);if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(t=>t||{}).every(t=>k_(t.x)&&k_(t.y)))throw new Error(`config.anchors has to be an array of { x: number, y: number }, have: ${JSON.stringify(e.anchors)}`);if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(k_)))throw new Error(`config.meanRgb has to be an array of shape [number, number, number], have: ${JSON.stringify(e.meanRgb)}`)}function Xz(e){return le(()=>{let t=ae(e,yt(.10000000149011612));return we(On(Ve(e,t)),t)})}function uc(e,t){return le(()=>{let n=al(e,[[0,0],[1,1],[1,1],[0,0]]);return n=ga(n,t.conv.filters,[1,1],"valid"),n=Ve(n,t.bn.sub),n=ae(n,t.bn.truediv),n=we(n,t.conv.bias),Xz(n)})}function cc(e,t){return le(()=>{let n=al(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Bv(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=we(n,t.bias),Xz(n)})}function Qyt(e,t){let n=Hz(e,t);function r(s,o){let l=Cn(e(s)),u=Cn(e(s));return t.push({paramPath:`${o}/sub`},{paramPath:`${o}/truediv`}),{sub:l,truediv:u}}function i(s,o,l){let u=n(s,o,3,`${l}/conv`),c=r(o,`${l}/bn`);return{conv:u,bn:c}}let a=Gz(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function evt(e,t,n,r){let{extractWeights:i,getRemainingWeights:a}=Ud(e),s=[],{extractConvParams:o,extractConvWithBatchNormParams:l,extractSeparableConvParams:u}=Qyt(i,s),c;if(t.withSeparableConvs){let[d,p,h,m,g,v,y,b,_]=r,k=t.isFirstLayerConv2d?o(d,p,3,"conv0"):u(d,p,"conv0"),C=u(p,h,"conv1"),$=u(h,m,"conv2"),N=u(m,g,"conv3"),A=u(g,v,"conv4"),D=u(v,y,"conv5"),O=b?u(y,b,"conv6"):void 0,F=_?u(b,_,"conv7"):void 0,E=o(_||b||y,5*n,1,"conv8");c={conv0:k,conv1:C,conv2:$,conv3:N,conv4:A,conv5:D,conv6:O,conv7:F,conv8:E}}else{let[d,p,h,m,g,v,y,b,_]=r,k=l(d,p,"conv0"),C=l(p,h,"conv1"),$=l(h,m,"conv2"),N=l(m,g,"conv3"),A=l(g,v,"conv4"),D=l(v,y,"conv5"),O=l(y,b,"conv6"),F=l(b,_,"conv7"),E=o(_,5*n,1,"conv8");c={conv0:k,conv1:C,conv2:$,conv3:N,conv4:A,conv5:D,conv6:O,conv7:F,conv8:E}}if(a().length!==0)throw new Error(`weights remaing after extract: ${a().length}`);return{params:c,paramMappings:s}}function tvt(e,t){let n=sm(e,t);function r(o){let l=n(`${o}/sub`,1),u=n(`${o}/truediv`,1);return{sub:l,truediv:u}}function i(o){let l=n(`${o}/filters`,4),u=n(`${o}/bias`,1);return{filters:l,bias:u}}function a(o){let l=i(`${o}/conv`),u=r(`${o}/bn`);return{conv:l,bn:u}}let s=qz(n);return{extractConvParams:i,extractConvWithBatchNormParams:a,extractSeparableConvParams:s}}function nvt(e,t){let n=[],{extractConvParams:r,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}=tvt(e,n),s;if(t.withSeparableConvs){let o=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?r("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:o>7?a("conv6"):void 0,conv7:o>8?a("conv7"):void 0,conv8:r("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:r("conv8")};return jd(e,n),{params:s,paramMappings:n}}var Jz=class{constructor({inputSize:e,scoreThreshold:t}={}){if(this._name="TinyYolov2Options",this._inputSize=e||416,this._scoreThreshold=t||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(`${this._name} - expected inputSize to be a number divisible by 32`);if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(`${this._name} - expected scoreThreshold to be a number between 0 and 1`)}get inputSize(){return this._inputSize}get scoreThreshold(){return this._scoreThreshold}},mue=class gue extends Vd{constructor(t){super("TinyYolov2"),Yyt(t),this._config=t}get config(){return this._config}get withClassScores(){return this.config.withClassScores||this.config.classes.length>1}get boxEncodingSize(){return 5+(this.withClassScores?this.config.classes.length:0)}runTinyYolov2(t,n){let r=uc(t,n.conv0);return r=oi(r,[2,2],[2,2],"same"),r=uc(r,n.conv1),r=oi(r,[2,2],[2,2],"same"),r=uc(r,n.conv2),r=oi(r,[2,2],[2,2],"same"),r=uc(r,n.conv3),r=oi(r,[2,2],[2,2],"same"),r=uc(r,n.conv4),r=oi(r,[2,2],[2,2],"same"),r=uc(r,n.conv5),r=oi(r,[2,2],[1,1],"same"),r=uc(r,n.conv6),r=uc(r,n.conv7),Cb(r,n.conv8,"valid",!1)}runMobilenet(t,n){let r=this.config.isFirstLayerConv2d?Xz(Cb(t,n.conv0,"valid",!1)):cc(t,n.conv0);return r=oi(r,[2,2],[2,2],"same"),r=cc(r,n.conv1),r=oi(r,[2,2],[2,2],"same"),r=cc(r,n.conv2),r=oi(r,[2,2],[2,2],"same"),r=cc(r,n.conv3),r=oi(r,[2,2],[2,2],"same"),r=cc(r,n.conv4),r=oi(r,[2,2],[2,2],"same"),r=cc(r,n.conv5),r=oi(r,[2,2],[1,1],"same"),r=n.conv6?cc(r,n.conv6):r,r=n.conv7?cc(r,n.conv7):r,Cb(r,n.conv8,"valid",!1)}forwardInput(t,n){let{params:r}=this;if(!r)throw new Error("TinyYolov2 - load model before inference");return le(()=>{let i=Me(t.toBatchTensor(n,!1),"float32");return i=this.config.meanRgb?Kw(i,this.config.meanRgb):i,i=i.div(255),this.config.withSeparableConvs?this.runMobilenet(i,r):this.runTinyYolov2(i,r)})}async forward(t,n){return this.forwardInput(await ba(t),n)}async detect(t,n={}){let{inputSize:r,scoreThreshold:i}=new Jz(n),a=await ba(t),s=await this.forwardInput(a,r),o=le(()=>Ir(s)[0].expandDims()),l={width:a.getInputWidth(0),height:a.getInputHeight(0)},u=await this.extractBoxes(o,a.getReshapedInputDimensions(0),i);s.dispose(),o.dispose();let c=u.map(m=>m.box),d=u.map(m=>m.score),p=u.map(m=>m.classScore),h=u.map(m=>this.config.classes[m.label]);return Bgt(c.map(m=>m.rescale(r)),d,this.config.iouThreshold,!0).map(m=>new Nle(d[m],p[m],h[m],c[m],l))}getDefaultModelName(){return""}extractParamsFromWeightMap(t){return nvt(t,this.config)}extractParams(t){let n=this.config.filterSizes||gue.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(r!==7&&r!==8&&r!==9)throw new Error(`TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found ${r} filterSizes in config`);return evt(t,this.config,this.boxEncodingSize,n)}async extractBoxes(t,n,r){let{width:i,height:a}=n,s=Math.max(i,a),o=s/i,l=s/a,u=t.shape[1],c=this.config.anchors.length,[d,p,h]=le(()=>{let y=t.reshape([u,u,c,this.boxEncodingSize]),b=y.slice([0,0,0,0],[u,u,c,4]),_=y.slice([0,0,0,4],[u,u,c,1]),k=this.withClassScores?Dd(y.slice([0,0,0,5],[u,u,c,this.config.classes.length]),3):yt(0);return[b,_,k]}),m=[],g=await p.array(),v=await d.array();for(let y=0;y<u;y++)for(let b=0;b<u;b++)for(let _=0;_<c;_++){let k=hE(g[y][b][_][0]);if(!r||k>r){let C=(b+hE(v[y][b][_][0]))/u*o,$=(y+hE(v[y][b][_][1]))/u*l,N=Math.exp(v[y][b][_][2])*this.config.anchors[_].x/u*o,A=Math.exp(v[y][b][_][3])*this.config.anchors[_].y/u*l,D=C-N/2,O=$-A/2,F={row:y,col:b,anchor:_},{classScore:E,label:z}=this.withClassScores?await this.extractPredictedClass(h,F):{classScore:1,label:0};m.push({box:new Tle(D,O,D+N,O+A),score:k,classScore:k*E,label:z,...F})}}return d.dispose(),p.dispose(),h.dispose(),m}async extractPredictedClass(t,n){let{row:r,col:i,anchor:a}=n,s=await t.array();return Array(this.config.classes.length).fill(0).map((o,l)=>s[r][i][a][l]).map((o,l)=>({classScore:o,label:l})).reduce((o,l)=>o.classScore>l.classScore?o:l)}};mue.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024];var yue=mue,rvt=class extends yue{constructor(e=!0){let t={withSeparableConvs:e,iouThreshold:Gyt,classes:["face"],...e?{anchors:Kyt,meanRgb:Zyt}:{anchors:qyt,withClassScores:!0}};super(t)}get withSeparableConvs(){return this.config.withSeparableConvs}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(n=>new nl(n.score,n.relativeBox,{width:n.imageWidth,height:n.imageHeight}))}getDefaultModelName(){return this.withSeparableConvs?Jyt:Xyt}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},ivt=class extends Jz{constructor(){super(...arguments),this._name="TinyFaceDetectorOptions"}},Zw=class{async then(e){return e(await this.run())}async run(){throw new Error("ComposableTask - run is not implemented")}};async function gT(e,t,n,r,i=({alignedRect:a})=>a){let a=e.map(l=>iue(l)?i(l):l.detection),s=r||(t instanceof zt?await Uz(t,a):await jz(t,a)),o=await n(s);return s.forEach(l=>l instanceof zt&&l.dispose()),o}async function Yz(e,t,n,r,i){return gT([e],t,async a=>n(a[0]),r,i)}var avt=.4,svt=[new Fn(1.603231,2.094468),new Fn(6.041143,7.080126),new Fn(2.882459,3.518061),new Fn(4.266906,5.178857),new Fn(9.041765,10.66308)],ovt=[117.001,114.697,97.404],lvt=class extends yue{constructor(){let e={withSeparableConvs:!0,iouThreshold:avt,classes:["face"],anchors:svt,meanRgb:ovt,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};super(e)}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(n=>new nl(n.score,n.relativeBox,{width:n.imageWidth,height:n.imageHeight}))}getDefaultModelName(){return"tiny_face_detector_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},ps={ssdMobilenetv1:new Hyt,tinyFaceDetector:new lvt,tinyYolov2:new rvt,faceLandmark68Net:new byt,faceLandmark68TinyNet:new kyt,faceRecognitionNet:new Eyt,faceExpressionNet:new iyt,ageGenderNet:new vyt},vue=class extends Zw{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},Qz=class extends vue{async run(){let e=await this.parentTask,t=await gT(e,this.input,async n=>Promise.all(n.map(r=>ps.faceExpressionNet.predictExpressions(r))),this.extractedFaces);return e.map((n,r)=>rue(n,t[r]))}withAgeAndGender(){return new r3(this,this.input)}},e3=class extends vue{async run(){let e=await this.parentTask;if(!e)return;let t=await Yz(e,this.input,n=>ps.faceExpressionNet.predictExpressions(n),this.extractedFaces);return rue(e,t)}withAgeAndGender(){return new i3(this,this.input)}},t3=class extends Qz{withAgeAndGender(){return new a3(this,this.input)}withFaceDescriptors(){return new o3(this,this.input)}},n3=class extends e3{withAgeAndGender(){return new s3(this,this.input)}withFaceDescriptor(){return new l3(this,this.input)}},bue=class extends Zw{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},r3=class extends bue{async run(){let e=await this.parentTask,t=await gT(e,this.input,async n=>Promise.all(n.map(r=>ps.ageGenderNet.predictAgeAndGender(r))),this.extractedFaces);return e.map((n,r)=>{let{age:i,gender:a,genderProbability:s}=t[r];return hue(fue(n,a,s),i)})}withFaceExpressions(){return new Qz(this,this.input)}},i3=class extends bue{async run(){let e=await this.parentTask;if(!e)return;let{age:t,gender:n,genderProbability:r}=await Yz(e,this.input,i=>ps.ageGenderNet.predictAgeAndGender(i),this.extractedFaces);return hue(fue(e,n,r),t)}withFaceExpressions(){return new e3(this,this.input)}},a3=class extends r3{withFaceExpressions(){return new t3(this,this.input)}withFaceDescriptors(){return new o3(this,this.input)}},s3=class extends i3{withFaceExpressions(){return new n3(this,this.input)}withFaceDescriptor(){return new l3(this,this.input)}},wue=class extends Zw{constructor(e,t){super(),this.parentTask=e,this.input=t}},o3=class extends wue{async run(){let e=await this.parentTask;return(await gT(e,this.input,t=>Promise.all(t.map(n=>ps.faceRecognitionNet.computeFaceDescriptor(n))),null,t=>t.landmarks.align(null,{useDlibAlignment:!0}))).map((t,n)=>pue(e[n],t))}withFaceExpressions(){return new t3(this,this.input)}withAgeAndGender(){return new a3(this,this.input)}},l3=class extends wue{async run(){let e=await this.parentTask;if(!e)return;let t=await Yz(e,this.input,n=>ps.faceRecognitionNet.computeFaceDescriptor(n),null,n=>n.landmarks.align(null,{useDlibAlignment:!0}));return pue(e,t)}withFaceExpressions(){return new n3(this,this.input)}withAgeAndGender(){return new s3(this,this.input)}},xue=class extends Zw{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.useTinyLandmarkNet=n}get landmarkNet(){return this.useTinyLandmarkNet?ps.faceLandmark68TinyNet:ps.faceLandmark68Net}},uvt=class extends xue{async run(){let e=await this.parentTask,t=e.map(i=>i.detection),n=this.input instanceof zt?await Uz(this.input,t):await jz(this.input,t),r=await Promise.all(n.map(i=>this.landmarkNet.detectLandmarks(i)));return n.forEach(i=>i instanceof zt&&i.dispose()),e.filter((i,a)=>r[a]).map((i,a)=>aue(i,r[a]))}withFaceExpressions(){return new t3(this,this.input)}withAgeAndGender(){return new a3(this,this.input)}withFaceDescriptors(){return new o3(this,this.input)}},cvt=class extends xue{async run(){let e=await this.parentTask;if(!e)return;let{detection:t}=e,n=this.input instanceof zt?await Uz(this.input,[t]):await jz(this.input,[t]),r=await this.landmarkNet.detectLandmarks(n[0]);return n.forEach(i=>i instanceof zt&&i.dispose()),aue(e,r)}withFaceExpressions(){return new n3(this,this.input)}withAgeAndGender(){return new s3(this,this.input)}withFaceDescriptor(){return new l3(this,this.input)}},_ue=class extends Zw{constructor(e,t=new vh){super(),this.input=e,this.options=t}},kue=class extends _ue{async run(){let{input:e,options:t}=this,n;if(t instanceof ivt)n=ps.tinyFaceDetector.locateFaces(e,t);else if(t instanceof vh)n=ps.ssdMobilenetv1.locateFaces(e,t);else if(t instanceof Jz)n=ps.tinyYolov2.locateFaces(e,t);else throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | TinyYolov2Options");return n}runAndExtendWithFaceDetections(){return new Promise((e,t)=>{this.run().then(n=>e(n.map(r=>Rle({},r)))).catch(n=>t(n))})}withFaceLandmarks(e=!1){return new uvt(this.runAndExtendWithFaceDetections(),this.input,e)}withFaceExpressions(){return new Qz(this.runAndExtendWithFaceDetections(),this.input)}withAgeAndGender(){return new r3(this.runAndExtendWithFaceDetections(),this.input)}},dvt=class extends _ue{async run(){let e=await new kue(this.input,this.options),t=e[0];return e.forEach(n=>{n.score>t.score&&(t=n)}),t}runAndExtendWithFaceDetection(){return new Promise(async e=>{let t=await this.run();e(t?Rle({},t):void 0)})}withFaceLandmarks(e=!1){return new cvt(this.runAndExtendWithFaceDetection(),this.input,e)}withFaceExpressions(){return new e3(this.runAndExtendWithFaceDetection(),this.input)}withAgeAndGender(){return new i3(this.runAndExtendWithFaceDetection(),this.input)}};function pvt(e,t=new vh){return new dvt(e,t)}function hvt(e,t=new vh){return new kue(e,t)}function fvt(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");let n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map((i,a)=>i-r[a]).reduce((i,a)=>i+a*a,0))}var mvt=class Sue{constructor(t,n=.6){this._distanceThreshold=n;let r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");let i=1,a=()=>`person ${i++}`;this._labeledDescriptors=r.map(s=>{if(s instanceof w_)return s;if(s instanceof Float32Array)return new w_(a(),[s]);if(s.descriptor&&s.descriptor instanceof Float32Array)return new w_(a(),[s.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}get labeledDescriptors(){return this._labeledDescriptors}get distanceThreshold(){return this._distanceThreshold}computeMeanDistance(t,n){return n.map(r=>fvt(r,t)).reduce((r,i)=>r+i,0)/(n.length||1)}matchDescriptor(t){return this.labeledDescriptors.map(({descriptors:n,label:r})=>new OH(r,this.computeMeanDistance(t,n))).reduce((n,r)=>n.distance<r.distance?n:r)}findBestMatch(t){let n=this.matchDescriptor(t);return n.distance<this._distanceThreshold?n:new OH("unknown",n.distance)}toJSON(){return{distanceThreshold:this._distanceThreshold,labeledDescriptors:this._labeledDescriptors.map(t=>t.toJSON())}}static fromJSON(t){let n=t.labeledDescriptors.map(r=>w_.fromJSON(r));return new Sue(n,t.distanceThreshold)}};function gvt({image:e,opened:t,close:n}){const{profiles:r,updateProfile:i}=js(),{updateTab:a}=gn(),[s,o]=I.exports.useState(),[l,u]=I.exports.useState(!1);I.exports.useEffect(()=>{e&&o(e)},[e]);const c=()=>{n(),Ne("hideUI"),Ne("takePhoto","facialRecognition")};I.exports.useEffect(()=>{(async()=>{try{await Promise.all([ps.ssdMobilenetv1.loadFromUri("models"),ps.faceLandmark68Net.loadFromUri("models"),ps.faceRecognitionNet.loadFromUri("models")])}catch(h){console.error("Failed to load models:",h)}})()},[]);const d=async()=>{if(!(!s||!Kg(s)||l)){u(!0);try{const p=await AH(s),h=await hvt(p,new vh).withFaceLandmarks().withFaceDescriptors();if(h.length===0){u(!1);return}let m=!1;for(const g of r)if(!!g.image)try{const v=await AH(g.image),y=await pvt(v,new vh).withFaceLandmarks().withFaceDescriptor();if(!y||!y.descriptor)continue;const _=new mvt([y]).findBestMatch(h[0].descriptor);if(_&&_.distance<.6){m=!0,n(),Ne("getProfile",g.identifier).then(k=>{!k||!g.identifier||i(g.identifier,k)}),a({title:"profiles",component:x(u3,{profileId:g.identifier})});break}}catch(v){console.error("Error processing reference image:",v)}u(!1)}catch(p){u(!1),console.error("Error processing image:",p)}}};return x(sr,{title:K.facial_recognition,opened:t,onClose:n,centered:!0,children:B(Ce,{spacing:20,w:"100%",children:[Kg(s)&&x(er,{src:s,size:"100%"}),x(Xe,{label:K.image_url,placeholder:K.url,value:s,onChange:p=>o(p.currentTarget.value),rightSection:x(Fe,{onClick:c,children:x(Kl,{})})}),x(me,{position:"right",children:x(Ct,{onClick:d,disabled:l,children:l?K.searching:K.search})})]})})}function Cue(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200),[r,{open:i,close:a}]=$r(!1),[s,o]=I.exports.useState(),[l,u]=I.exports.useState([{type:"tags",value:""}]),[c,d]=I.exports.useState();return kt("photoTaken",p=>{p.page==="facialRecognition"&&(d(p.url),i())}),B(ze,{children:[x(xa,{title:K.profiles,searchQuery:e,filterInputs:l,filters:s,setFilterInputs:u,setSearchQuery:t,setFilters:o,openFacialRecognition:i}),x($Re,{searchQuery:n,filters:s}),x(gvt,{image:c,opened:r,close:a})]})}function u3({profileId:e}){const{profiles:t,updateProfile:n}=js(),{updateTab:r}=gn(),[i,a]=I.exports.useState(t.find(y=>y.identifier===e)),[s,{open:o,close:l}]=$r(!1),[u,c]=I.exports.useState(i==null?void 0:i.image),[d,p]=I.exports.useState(i==null?void 0:i.notes),[h]=Kt(d,1e3);I.exports.useEffect(()=>{a(t.find(y=>y.identifier===e))},[t]),I.exports.useEffect(()=>{c(i==null?void 0:i.image)},[i]),I.exports.useEffect(()=>{i&&h&&n(i.identifier,{notes:h})},[h]);const m=I.exports.useCallback(()=>{r({title:"profiles",component:x(Cue,{})})},[i,r]),g=I.exports.useCallback(()=>{const y={...i,notes:d};Ne("saveProfile",y)},[i,d]),v=()=>{l(),Ne("hideUI"),Ne("takePhoto","profile")};return kt("photoTaken",y=>{y.page==="profile"&&(o(),c(y.url))}),B(ze,{children:[i&&B(me,{spacing:20,children:[x(Bt,{w:"60%",h:"81vh",color:"dark.6",radius:"xs",p:20,shadow:"xs",children:B(Ce,{w:"100%",spacing:25,align:"flex-start",children:[B(me,{w:"100%",position:"apart",children:[B(bt,{radius:"sm",children:["ID: ",i.identifier]}),B(me,{spacing:10,children:[x(Fe,{variant:"subtle",color:"blue",onClick:m,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:g,children:x(Us,{})})]})]}),x(me,{w:"100%",position:"apart",children:B(me,{w:"90%",children:[x(er,{size:160,src:i.image,onClick:o,sx:{cursor:"pointer"}}),x(An,{w:"75%",h:160,scrollHideDelay:0,scrollbarSize:5,children:B(me,{w:"100%",spacing:10,children:[x(Xe,{label:K.player_name,variant:"filled",readOnly:!0,value:i.name,size:"xs"}),x(Xe,{label:K.dob,variant:"filled",readOnly:!0,value:i.dob,size:"xs"}),x(Xe,{label:K.phone_number,variant:"filled",readOnly:!0,value:i.phoneNumber,size:"xs"}),x(Xe,{label:K.gender,variant:"filled",readOnly:!0,value:K[i.gender],size:"xs"}),i.fingerprint&&x(Xe,{label:K.fingerprint,variant:"filled",readOnly:!0,value:i.fingerprint,size:"xs"}),i.bloodType&&x(Xe,{label:K.bloodType,variant:"filled",readOnly:!0,value:i.bloodType,size:"xs"}),i.points&&x(Xe,{label:K.license_points,variant:"filled",readOnly:!0,value:i.points,size:"xs"})]})})]})}),x(bs,{w:"100%",label:K.notes,minRows:25,maxLength:5e4,value:d,onChange:y=>p(y.currentTarget.value)})]})}),x(ol,{page:"profile",sidebar:i.sideBarData,pageId:i.identifier,updateData:n})]}),x(sr,{size:"40%",centered:!0,title:i==null?void 0:i.name,opened:s,onClose:l,withinPortal:!0,children:B(Ce,{spacing:20,children:[x(il,{radius:"md",src:i==null?void 0:i.image}),x(Xe,{label:K.image_url,placeholder:K.url,variant:"filled",value:u,onChange:y=>c(y.currentTarget.value),rightSection:x(Fe,{onClick:v,children:x(Kl,{})})}),x(me,{position:"right",children:x(Ct,{onClick:()=>{!i||(l(),n(i.identifier,{image:u}))},children:K.confirm})})]})})]})}function yvt({searchQuery:e}){const{properties:t,updateProperty:n}=F2(),{updateTab:r}=gn(),i=I.exports.useMemo(()=>t.filter(s=>{var o,l;return((o=s.owner)==null?void 0:o.toLowerCase().includes(e.toLowerCase()))||((l=s.name)==null?void 0:l.toLowerCase().includes(e.toLowerCase()))}),[e,t]),a=({index:s,style:o})=>{const l=i[s];return x("div",{style:{...o},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getProperty",l.id).then(u=>{!u||!l.id||n(l.id,u)}),r({title:"properties",component:x($ue,{propertyId:l.id})})},p:10,children:B(me,{spacing:15,children:[x(er,{size:80,src:l.image}),B(Ce,{spacing:1,children:[x(Te,{fw:600,size:16,children:l.name}),x(Te,{fw:500,size:12,color:"gray.5",children:l.owner})]})]})})})};return x(ta,{height:window.innerHeight*.77,itemCount:i.length,itemSize:110,width:"100%",children:a})}function Iue(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200);return B(ze,{children:[x(xa,{title:K.properties,searchQuery:e,setSearchQuery:t}),x(yvt,{searchQuery:n})]})}function $ue({propertyId:e}){const{properties:t,updateProperty:n}=F2(),{updateTab:r}=gn(),[i,a]=I.exports.useState(t.find(y=>y.id===e)),[s,{open:o,close:l}]=$r(!1),[u,c]=I.exports.useState(i==null?void 0:i.image),[d,p]=I.exports.useState(i==null?void 0:i.notes),[h]=Kt(d,1e3);I.exports.useEffect(()=>{a(t.find(y=>y.id===e))},[t]),I.exports.useEffect(()=>{c(i==null?void 0:i.image)},[i]),I.exports.useEffect(()=>{i&&h&&n(i.id,{notes:h})},[h]);const m=I.exports.useCallback(()=>{r({title:"properties",component:x(Iue,{})})},[i,r]),g=I.exports.useCallback(()=>{const y={...i,notes:d};Ne("saveProperty",y)},[i,d]),v=()=>{l(),Ne("hideUI"),Ne("takePhoto","property")};return kt("photoTaken",y=>{y.page==="property"&&(o(),c(y.url))}),B(ze,{children:[i&&B(me,{spacing:20,children:[x(Bt,{w:"60%",h:"81vh",color:"dark.6",radius:"xs",p:20,shadow:"xs",children:B(Ce,{w:"100%",spacing:25,children:[B(me,{w:"100%",position:"apart",children:[B(me,{w:"90%",children:[x(er,{size:160,src:i.image,onClick:o,style:{cursor:"pointer"}}),x(An,{w:"75%",h:160,scrollHideDelay:0,scrollbarSize:5,children:B(me,{w:"100%",spacing:10,children:[x(Xe,{label:K.property_name,variant:"filled",value:i.name,size:"xs",rightSection:i.coords&&x(Fe,{size:20,color:"blue",variant:"subtle",onClick:()=>Ne("setMarker",i.coords),children:x(SMe,{})}),readOnly:!0,w:167}),x(Xe,{label:K.owner,variant:"filled",value:i.owner,readOnly:!0,size:"xs"})]})})]}),x(Ce,{h:160,justify:"flex-start",children:B(me,{spacing:10,children:[x(Fe,{variant:"subtle",color:"blue",onClick:m,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:g,children:x(Us,{})})]})})]}),x(bs,{w:"100%",label:K.notes,minRows:28,maxLength:5e4,value:d,onChange:y=>p(y.currentTarget.value)})]})}),x(ol,{page:"property",sidebar:i.sideBarData,pageId:i.id,updateData:n})]}),x(sr,{size:"40%",centered:!0,title:i==null?void 0:i.address,opened:s,onClose:l,withinPortal:!0,children:B(Ce,{spacing:20,children:[x(il,{radius:"md",src:i==null?void 0:i.image}),x(Xe,{label:K.image_url,placeholder:K.url,variant:"filled",value:u,onChange:y=>c(y.currentTarget.value),rightSection:x(Fe,{onClick:v,children:x(Kl,{})})}),x(me,{position:"right",children:x(Ct,{onClick:()=>{!i||(l(),n(i.id,{image:u}))},children:K.confirm})})]})})]})}function vvt({searchQuery:e,filters:t}){const{evidence:n,updateEvidence:r}=V1(),{updateTab:i}=gn(),{dateFormat:a}=tn(),s=I.exports.useMemo(()=>n.filter(l=>{const u=l.name.toLowerCase().includes(e.toLowerCase())||l.creator.toLowerCase().includes(e.toLowerCase())||l.id.toString()===e;if(!t)return u;const c=t.every(d=>{if(!l.sideBarData)return!1;let p;if(d.type in l.sideBarData?p=l.sideBarData[d.type]:p=l[d.type],Array.isArray(p)&&p.length>0){if(typeof p[0]=="object")return p.some(h=>Object.values(h).some(m=>typeof m=="string"?m.toLowerCase().includes(d.value.toLowerCase()):!1));if(typeof p[0]=="string")return p.some(h=>h.toLowerCase().includes(d.value.toLowerCase()))}return typeof p=="string"?p.toLowerCase().includes(d.value.toLowerCase()):!1});return u&&c}).sort((l,u)=>u.id-l.id),[e,t,n]),o=({index:l,style:u})=>{const c=s[l];return c.id<=-1?null:x("div",{style:{...u},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getEvidence",c.id).then(d=>{!d||!c.id||r(c.id,d)}),i({title:"evidence",component:x(c3,{evidenceId:c.id})})},p:10,children:B(me,{spacing:15,children:[x(er,{size:80,src:c.image}),B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:c.name}),B(bt,{radius:"sm",children:["ID: ",c.id]})]}),B(Te,{fw:500,size:12,color:"gray.5",children:[c.creator," - ",new Date(c.date*1e3).toLocaleString([],a||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]})]})]})})})};return x(ta,{height:window.innerHeight*.77,itemCount:s.length,itemSize:110,width:"100%",children:o})}function fA(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200),[r,i]=I.exports.useState(),[a,s]=I.exports.useState([{type:"creator",value:""},{type:"tags",value:""}]),{updateTab:o}=gn(),l=()=>{Ne("createEvidence").then(u=>{!u||o({title:"evidence",component:x(c3,{evidenceId:u.id})})})};return B(ze,{children:[x(xa,{title:K.evidence,searchQuery:e,filterInputs:a,filters:r,setFilterInputs:s,setFilters:i,setSearchQuery:t,createNew:l}),x(vvt,{searchQuery:n,filters:r})]})}function c3({evidenceId:e}){const{evidence:t,updateEvidence:n}=V1(),{updateTab:r}=gn(),[i,a]=I.exports.useState(t.find($=>$.id===e)),[s,{open:o,close:l}]=$r(!1),{dateFormat:u}=tn(),[c,d]=I.exports.useState(i==null?void 0:i.image),[p,h]=I.exports.useState(i==null?void 0:i.notes),[m,g]=I.exports.useState(i==null?void 0:i.name),[v]=Kt(m,500),[y]=Kt(p,1e3);I.exports.useEffect(()=>{a(t.find($=>$.id===e))},[t]),I.exports.useEffect(()=>{d(i==null?void 0:i.image)},[i]),I.exports.useEffect(()=>{i&&y&&n(i.id,{notes:y})},[y]),I.exports.useEffect(()=>{i&&v&&n(i.id,{name:v})},[v]);const b=I.exports.useCallback(()=>{r({title:"evidence",component:x(fA,{})})},[i,r]),_=I.exports.useCallback(()=>{const $={...i,notes:p};Ne("saveEvidence",$)},[i,p]),k=I.exports.useCallback(()=>{In.openConfirmModal({title:K.are_you_sure_remove,labels:{confirm:K.confirm,cancel:K.cancel},centered:!0,onConfirm:()=>{Ne("removeEvidence",i==null?void 0:i.id),r({title:"evidence",component:x(fA,{})})}})},[i,r]),C=()=>{l(),Ne("hideUI"),Ne("takePhoto","evidence")};return kt("photoTaken",$=>{$.page==="evidence"&&(o(),d($.url))}),B(ze,{children:[i&&x(ze,{children:B(me,{spacing:20,children:[x(Bt,{w:"60%",h:"81vh",color:"dark.6",radius:"xs",p:20,shadow:"xs",children:B(Ce,{w:"100%",spacing:25,children:[B(me,{w:"100%",position:"apart",children:[B(me,{w:"85%",children:[x(er,{size:160,src:i.image,onClick:o,sx:{cursor:"pointer"}}),x(An,{w:"75%",h:160,scrollHideDelay:0,scrollbarSize:5,children:B(me,{w:"100%",spacing:10,children:[x(Xe,{label:K.evidence_name,variant:"filled",value:m,onChange:$=>g($.currentTarget.value),size:"xs"}),x(Xe,{label:K.creator,variant:"filled",readOnly:!0,value:i.creator,size:"xs"}),x(Xe,{label:K.date,variant:"filled",readOnly:!0,value:new Date(i.date*1e3).toLocaleString([],u||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),size:"xs"})]})})]}),x(Ce,{h:160,justify:"flex-start",children:B(me,{spacing:10,children:[x(Fe,{variant:"subtle",color:"blue",onClick:b,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:_,children:x(Us,{})}),x(Fe,{variant:"subtle",color:"red",onClick:k,children:x(go,{})})]})})]}),x(bs,{w:"100%",label:K.notes,minRows:28,maxLength:5e4,value:p,onChange:$=>h($.currentTarget.value)})]})}),x(ol,{page:"evidence",sidebar:i.sideBarData,pageId:i.id,updateData:n})]})}),x(sr,{size:"40%",centered:!0,title:i==null?void 0:i.name,opened:s,onClose:l,withinPortal:!0,children:B(Ce,{spacing:20,children:[x(il,{radius:"md",src:i==null?void 0:i.image}),x(Xe,{label:K.image_url,placeholder:K.url,variant:"filled",value:c,onChange:$=>d($.currentTarget.value),rightSection:x(Fe,{onClick:C,children:x(Kl,{})})}),x(me,{position:"right",children:x(Ct,{onClick:()=>{!i||(l(),n(i.id,{image:c}))},children:K.confirm})})]})})]})}function bvt({searchQuery:e,filters:t}){const{reports:n,updateReport:r}=ju(),{updateTab:i}=gn(),{dateFormat:a}=tn(),s=I.exports.useMemo(()=>n.filter(l=>{var d,p,h,m,g;const u=((d=l.title)==null?void 0:d.toLowerCase().includes(e.toLowerCase()))||((p=l.id)==null?void 0:p.toString())===e||l.sideBarData&&(((h=l.sideBarData.officers)==null?void 0:h.some(v=>v.name.toLowerCase().includes(e.toLowerCase())))||((m=l.sideBarData.suspects)==null?void 0:m.some(v=>v.name.toLowerCase().includes(e.toLowerCase())))||((g=l.sideBarData.civilians)==null?void 0:g.some(v=>v.name.toLowerCase().includes(e.toLowerCase()))));if(!t)return u;const c=t.every(v=>{if(!l.sideBarData)return!1;let y;if(v.type in l.sideBarData?y=l.sideBarData[v.type]:y=l[v.type],Array.isArray(y)&&y.length>0){if(typeof y[0]=="object")return y.some(b=>Object.values(b).some(_=>typeof _=="string"?_.toLowerCase().includes(v.value.toLowerCase()):!1));if(typeof y[0]=="string")return y.some(b=>b.toLowerCase().includes(v.value.toLowerCase()))}return typeof y=="string"?y.toLowerCase().includes(v.value.toLowerCase()):!1});return u&&c}).sort((l,u)=>u.id-l.id),[e,t,n]),o=({index:l,style:u})=>{const c=s[l];return c.id<=-1?null:x("div",{style:{...u},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getReport",c.id).then(d=>{!d||!c.id||r(c.id,d)}),i({title:"reports",component:x(I1,{reportId:c.id})})},p:10,children:x(me,{spacing:15,children:B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:c.title}),B(bt,{radius:"sm",children:["ID: ",c.id]})]}),c.sideBarData.officers&&c.sideBarData.officers.length>0&&B(Te,{w:700,fw:500,size:13,color:"gray.4",style:{overflow:"hidden",wordBreak:"break-all",textOverflow:"ellipsis"},children:[K.officers_list," ",c.sideBarData.officers.map(d=>d.name).join(", ")]}),c.sideBarData.suspects&&c.sideBarData.suspects.length>0&&B(Te,{w:700,fw:500,size:13,color:"gray.4",style:{overflow:"hidden",wordBreak:"break-all",textOverflow:"ellipsis"},children:[K.suspects_list," ",c.sideBarData.suspects.map(d=>d.name).join(", ")]}),x(Te,{fw:500,size:12,color:"gray.5",children:new Date(c.date*1e3).toLocaleString([],a||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]})})})})};return x(ta,{height:window.innerHeight*.77,itemCount:s.length,itemSize:110,width:"100%",children:o})}function mA(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200),[r,i]=I.exports.useState(),[a,s]=I.exports.useState([{type:"creator",value:""},{type:"tags",value:""},{type:"officers",value:""},{type:"suspects",value:""},{type:"civilians",value:""}]),{updateTab:o}=gn(),l=()=>{Ne("createReport").then(u=>{!u||o({title:"reports",component:x(I1,{reportId:u.id})})})};return B(ze,{children:[x(xa,{title:K.reports,searchQuery:e,filterInputs:a,filters:r,setFilterInputs:s,setSearchQuery:t,setFilters:i,createNew:l}),x(bvt,{searchQuery:n,filters:r})]})}function ji(e){this.content=e}ji.prototype={constructor:ji,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,i=r.find(e),a=r.content.slice();return i==-1?a.push(n||e,t):(a[i+1]=t,n&&(a[i]=n)),new ji(a)},remove:function(e){var t=this.find(e);if(t==-1)return this;var n=this.content.slice();return n.splice(t,2),new ji(n)},addToStart:function(e,t){return new ji([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new ji(n)},addBefore:function(e,t,n){var r=this.remove(t),i=r.content.slice(),a=r.find(e);return i.splice(a==-1?i.length:a,0,t,n),new ji(i)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=ji.from(e),e.size?new ji(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=ji.from(e),e.size?new ji(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=ji.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}};ji.from=function(e){if(e instanceof ji)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new ji(t)};function Tue(e,t,n){for(let r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;let i=e.child(r),a=t.child(r);if(i==a){n+=i.nodeSize;continue}if(!i.sameMarkup(a))return n;if(i.isText&&i.text!=a.text){for(let s=0;i.text[s]==a.text[s];s++)n++;return n}if(i.content.size||a.content.size){let s=Tue(i.content,a.content,n+1);if(s!=null)return s}n+=i.nodeSize}}function Nue(e,t,n,r){for(let i=e.childCount,a=t.childCount;;){if(i==0||a==0)return i==a?null:{a:n,b:r};let s=e.child(--i),o=t.child(--a),l=s.nodeSize;if(s==o){n-=l,r-=l;continue}if(!s.sameMarkup(o))return{a:n,b:r};if(s.isText&&s.text!=o.text){let u=0,c=Math.min(s.text.length,o.text.length);for(;u<c&&s.text[s.text.length-u-1]==o.text[o.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||o.content.size){let u=Nue(s.content,o.content,n-1,r-1);if(u)return u}n-=l,r-=l}}class Ae{constructor(t,n){if(this.content=t,this.size=n||0,n==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,n,r,i=0,a){for(let s=0,o=0;o<n;s++){let l=this.content[s],u=o+l.nodeSize;if(u>t&&r(l,i+o,a||null,s)!==!1&&l.content.size){let c=o+1;l.nodesBetween(Math.max(0,t-c),Math.min(l.content.size,n-c),r,i+c)}o=u}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,n,r,i){let a="",s=!0;return this.nodesBetween(t,n,(o,l)=>{let u=o.isText?o.text.slice(Math.max(t,l)-l,n-l):o.isLeaf?i?typeof i=="function"?i(o):i:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&u||o.isTextblock)&&r&&(s?s=!1:a+=r),a+=u},0),a}append(t){if(!t.size)return this;if(!this.size)return t;let n=this.lastChild,r=t.firstChild,i=this.content.slice(),a=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),a=1);a<t.content.length;a++)i.push(t.content[a]);return new Ae(i,this.size+t.size)}cut(t,n=this.size){if(t==0&&n==this.size)return this;let r=[],i=0;if(n>t)for(let a=0,s=0;s<n;a++){let o=this.content[a],l=s+o.nodeSize;l>t&&((s<t||l>n)&&(o.isText?o=o.cut(Math.max(0,t-s),Math.min(o.text.length,n-s)):o=o.cut(Math.max(0,t-s-1),Math.min(o.content.size,n-s-1))),r.push(o),i+=o.nodeSize),s=l}return new Ae(r,i)}cutByIndex(t,n){return t==n?Ae.empty:t==0&&n==this.content.length?this:new Ae(this.content.slice(t,n))}replaceChild(t,n){let r=this.content[t];if(r==n)return this;let i=this.content.slice(),a=this.size+n.nodeSize-r.nodeSize;return i[t]=n,new Ae(i,a)}addToStart(t){return new Ae([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new Ae(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(t.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let n=this.content[t];if(!n)throw new RangeError("Index "+t+" out of range for "+this);return n}maybeChild(t){return this.content[t]||null}forEach(t){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];t(i,r,n),r+=i.nodeSize}}findDiffStart(t,n=0){return Tue(this,t,n)}findDiffEnd(t,n=this.size,r=t.size){return Nue(this,t,n,r)}findIndex(t,n=-1){if(t==0)return S_(0,t);if(t==this.size)return S_(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,i=0;;r++){let a=this.child(r),s=i+a.nodeSize;if(s>=t)return s==t||n>0?S_(r+1,s):S_(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,n){if(!n)return Ae.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ae(n.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return Ae.empty;let n,r=0;for(let i=0;i<t.length;i++){let a=t[i];r+=a.nodeSize,i&&a.isText&&t[i-1].sameMarkup(a)?(n||(n=t.slice(0,i)),n[n.length-1]=a.withText(n[n.length-1].text+a.text)):n&&n.push(a)}return new Ae(n||t,r)}static from(t){if(!t)return Ae.empty;if(t instanceof Ae)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Ae([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ae.empty=new Ae([],0);const gE={index:0,offset:0};function S_(e,t){return gE.index=e,gE.offset=t,gE}function wI(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!wI(e[r],t[r]))return!1}else{for(let r in e)if(!(r in t)||!wI(e[r],t[r]))return!1;for(let r in t)if(!(r in e))return!1}return!0}class Sn{constructor(t,n){this.type=t,this.attrs=n}addToSet(t){let n,r=!1;for(let i=0;i<t.length;i++){let a=t[i];if(this.eq(a))return t;if(this.type.excludes(a.type))n||(n=t.slice(0,i));else{if(a.type.excludes(this.type))return t;!r&&a.type.rank>this.type.rank&&(n||(n=t.slice(0,i)),n.push(this),r=!0),n&&n.push(a)}}return n||(n=t.slice()),r||n.push(this),n}removeFromSet(t){for(let n=0;n<t.length;n++)if(this.eq(t[n]))return t.slice(0,n).concat(t.slice(n+1));return t}isInSet(t){for(let n=0;n<t.length;n++)if(this.eq(t[n]))return!0;return!1}eq(t){return this==t||this.type==t.type&&wI(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let n in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=t.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);return r.create(n.attrs)}static sameSet(t,n){if(t==n)return!0;if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].eq(n[r]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return Sn.none;if(t instanceof Sn)return[t];let n=t.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}}Sn.none=[];class xI extends Error{}class Qe{constructor(t,n,r){this.content=t,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,n){let r=Oue(this.content,t+this.openStart,n);return r&&new Qe(r,this.openStart,this.openEnd)}removeBetween(t,n){return new Qe(Eue(this.content,t+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,n){if(!n)return Qe.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Qe(Ae.fromJSON(t,n.content),r,i)}static maxOpen(t,n=!0){let r=0,i=0;for(let a=t.firstChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.firstChild)r++;for(let a=t.lastChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.lastChild)i++;return new Qe(t,r,i)}}Qe.empty=new Qe(Ae.empty,0,0);function Eue(e,t,n){let{index:r,offset:i}=e.findIndex(t),a=e.maybeChild(r),{index:s,offset:o}=e.findIndex(n);if(i==t||a.isText){if(o!=n&&!e.child(s).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return e.replaceChild(r,a.copy(Eue(a.content,t-i-1,n-i-1)))}function Oue(e,t,n,r){let{index:i,offset:a}=e.findIndex(t),s=e.maybeChild(i);if(a==t||s.isText)return r&&!r.canReplace(i,i,n)?null:e.cut(0,t).append(n).append(e.cut(t));let o=Oue(s.content,t-a-1,n);return o&&e.replaceChild(i,s.copy(o))}function wvt(e,t,n){if(n.openStart>e.depth)throw new xI("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new xI("Inconsistent open depths");return Pue(e,t,n,0)}function Pue(e,t,n,r){let i=e.index(r),a=e.node(r);if(i==t.index(r)&&r<e.depth-n.openStart){let s=Pue(e,t,n,r+1);return a.copy(a.content.replaceChild(i,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&e.depth==r&&t.depth==r){let s=e.parent,o=s.content;return Lp(s,o.cut(0,e.parentOffset).append(n.content).append(o.cut(t.parentOffset)))}else{let{start:s,end:o}=xvt(n,e);return Lp(a,Mue(e,s,o,t,r))}else return Lp(a,_I(e,t,r))}function Aue(e,t){if(!t.type.compatibleContent(e.type))throw new xI("Cannot join "+t.type.name+" onto "+e.type.name)}function gA(e,t,n){let r=e.node(n);return Aue(r,t.node(n)),r}function Dp(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function Ib(e,t,n,r){let i=(t||e).node(n),a=0,s=t?t.index(n):i.childCount;e&&(a=e.index(n),e.depth>n?a++:e.textOffset&&(Dp(e.nodeAfter,r),a++));for(let o=a;o<s;o++)Dp(i.child(o),r);t&&t.depth==n&&t.textOffset&&Dp(t.nodeBefore,r)}function Lp(e,t){return e.type.checkContent(t),e.copy(t)}function Mue(e,t,n,r,i){let a=e.depth>i&&gA(e,t,i+1),s=r.depth>i&&gA(n,r,i+1),o=[];return Ib(null,e,i,o),a&&s&&t.index(i)==n.index(i)?(Aue(a,s),Dp(Lp(a,Mue(e,t,n,r,i+1)),o)):(a&&Dp(Lp(a,_I(e,t,i+1)),o),Ib(t,n,i,o),s&&Dp(Lp(s,_I(n,r,i+1)),o)),Ib(r,null,i,o),new Ae(o)}function _I(e,t,n){let r=[];if(Ib(null,e,n,r),e.depth>n){let i=gA(e,t,n+1);Dp(Lp(i,_I(e,t,n+1)),r)}return Ib(t,null,n,r),new Ae(r)}function xvt(e,t){let n=t.depth-e.openStart,i=t.node(n).copy(e.content);for(let a=n-1;a>=0;a--)i=t.node(a).copy(Ae.from(i));return{start:i.resolveNoCache(e.openStart+n),end:i.resolveNoCache(i.content.size-e.openEnd-n)}}class v1{constructor(t,n,r){this.pos=t,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,n=this.index(this.depth);if(n==t.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=t.child(n);return r?t.child(n).cut(r):i}get nodeBefore(){let t=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(t).cut(0,n):t==0?null:this.parent.child(t-1)}posAtIndex(t,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let a=0;a<t;a++)i+=r.child(a).nodeSize;return i}marks(){let t=this.parent,n=this.index();if(t.content.size==0)return Sn.none;if(this.textOffset)return t.child(n).marks;let r=t.maybeChild(n-1),i=t.maybeChild(n);if(!r){let o=r;r=i,i=o}let a=r.marks;for(var s=0;s<a.length;s++)a[s].type.spec.inclusive===!1&&(!i||!a[s].isInSet(i.marks))&&(a=a[s--].removeFromSet(a));return a}marksAcross(t){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=t.parent.maybeChild(t.index());for(var a=0;a<r.length;a++)r[a].type.spec.inclusive===!1&&(!i||!r[a].isInSet(i.marks))&&(r=r[a--].removeFromSet(r));return r}sharedDepth(t){for(let n=this.depth;n>0;n--)if(this.start(n)<=t&&this.end(n)>=t)return n;return 0}blockRange(t=this,n){if(t.pos<this.pos)return t.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!n||n(this.node(r))))return new kI(this,t,r);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let n=1;n<=this.depth;n++)t+=(t?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return t+":"+this.parentOffset}static resolve(t,n){if(!(n>=0&&n<=t.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,a=n;for(let s=t;;){let{index:o,offset:l}=s.content.findIndex(a),u=a-l;if(r.push(s,o,i+l),!u||(s=s.child(o),s.isText))break;a=u-1,i+=l+1}return new v1(n,r,a)}static resolveCached(t,n){for(let i=0;i<yE.length;i++){let a=yE[i];if(a.pos==n&&a.doc==t)return a}let r=yE[vE]=v1.resolve(t,n);return vE=(vE+1)%_vt,r}}let yE=[],vE=0,_vt=12;class kI{constructor(t,n,r){this.$from=t,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const kvt=Object.create(null);class Wl{constructor(t,n,r,i=Sn.none){this.type=t,this.attrs=n,this.marks=i,this.content=r||Ae.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,n,r,i=0){this.content.nodesBetween(t,n,r,i,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,n,r,i){return this.content.textBetween(t,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,n,r){return this.type==t&&wI(this.attrs,n||t.defaultAttrs||kvt)&&Sn.sameSet(this.marks,r||Sn.none)}copy(t=null){return t==this.content?this:new Wl(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new Wl(this.type,this.attrs,this.content,t)}cut(t,n=this.content.size){return t==0&&n==this.content.size?this:this.copy(this.content.cut(t,n))}slice(t,n=this.content.size,r=!1){if(t==n)return Qe.empty;let i=this.resolve(t),a=this.resolve(n),s=r?0:i.sharedDepth(n),o=i.start(s),u=i.node(s).content.cut(i.pos-o,a.pos-o);return new Qe(u,i.depth-s,a.depth-s)}replace(t,n,r){return wvt(this.resolve(t),this.resolve(n),r)}nodeAt(t){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(t);if(n=n.maybeChild(r),!n)return null;if(i==t||n.isText)return n;t-=i+1}}childAfter(t){let{index:n,offset:r}=this.content.findIndex(t);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(t);if(r<t)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(t){return v1.resolveCached(this,t)}resolveNoCache(t){return v1.resolve(this,t)}rangeHasMark(t,n,r){let i=!1;return n>t&&this.nodesBetween(t,n,a=>(r.isInSet(a.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Rue(this.marks,t)}contentMatchAt(t){let n=this.type.contentMatch.matchFragment(this.content,0,t);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(t,n,r=Ae.empty,i=0,a=r.childCount){let s=this.contentMatchAt(t).matchFragment(r,i,a),o=s&&s.matchFragment(this.content,n);if(!o||!o.validEnd)return!1;for(let l=i;l<a;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(t,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let a=this.contentMatchAt(t).matchType(r),s=a&&a.matchFragment(this.content,n);return s?s.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content);let t=Sn.none;for(let n=0;n<this.marks.length;n++)t=this.marks[n].addToSet(t);if(!Sn.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let t={type:this.type.name};for(let n in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(n=>n.toJSON())),t}static fromJSON(t,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(t.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(n.text,r)}let i=Ae.fromJSON(t,n.content);return t.nodeType(n.type).create(n.attrs,i,r)}}Wl.prototype.text=void 0;class SI extends Wl{constructor(t,n,r,i){if(super(t,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Rue(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,n){return this.text.slice(t,n)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new SI(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new SI(this.type,this.attrs,t,this.marks)}cut(t=0,n=this.text.length){return t==0&&n==this.text.length?this:this.withText(this.text.slice(t,n))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function Rue(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class bh{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,n){let r=new Svt(t,n);if(r.next==null)return bh.empty;let i=Due(r);r.next&&r.err("Unexpected trailing text");let a=Ovt(Evt(i));return Pvt(a,r),a}matchType(t){for(let n=0;n<this.next.length;n++)if(this.next[n].type==t)return this.next[n].next;return null}matchFragment(t,n=0,r=t.childCount){let i=this;for(let a=n;i&&a<r;a++)i=i.matchType(t.child(a).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:n}=this.next[t];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(t){for(let n=0;n<this.next.length;n++)for(let r=0;r<t.next.length;r++)if(this.next[n].type==t.next[r].type)return!0;return!1}fillBefore(t,n=!1,r=0){let i=[this];function a(s,o){let l=s.matchFragment(t,r);if(l&&(!n||l.validEnd))return Ae.from(o.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:c,next:d}=s.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let p=a(d,o.concat(c));if(p)return p}}return null}return a(this,[])}findWrapping(t){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==t)return this.wrapCache[r+1];let n=this.computeWrapping(t);return this.wrapCache.push(t,n),n}computeWrapping(t){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),a=i.match;if(a.matchType(t)){let s=[];for(let o=i;o.type;o=o.via)s.push(o.type);return s.reverse()}for(let s=0;s<a.next.length;s++){let{type:o,next:l}=a.next[s];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in n)&&(!i.type||l.validEnd)&&(r.push({match:o.contentMatch,type:o,via:i}),n[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function n(r){t.push(r);for(let i=0;i<r.next.length;i++)t.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),t.map((r,i)=>{let a=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)a+=(s?", ":"")+r.next[s].type.name+"->"+t.indexOf(r.next[s].next);return a}).join(`
`)}}bh.empty=new bh(!0);class Svt{constructor(t,n){this.string=t,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function Due(e){let t=[];do t.push(Cvt(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function Cvt(e){let t=[];do t.push(Ivt(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function Ivt(e){let t=Nvt(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=$vt(e,t);else break;return t}function RH(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function $vt(e,t){let n=RH(e),r=n;return e.eat(",")&&(e.next!="}"?r=RH(e):r=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function Tvt(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let i=[];for(let a in n){let s=n[a];s.groups.indexOf(t)>-1&&i.push(s)}return i.length==0&&e.err("No node type or group '"+t+"' found"),i}function Nvt(e){if(e.eat("(")){let t=Due(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{let t=Tvt(e,e.next).map(n=>(e.inline==null?e.inline=n.isInline:e.inline!=n.isInline&&e.err("Mixing inline and block content"),{type:"name",value:n}));return e.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function Evt(e){let t=[[]];return i(a(e,0),n()),t;function n(){return t.push([])-1}function r(s,o,l){let u={term:l,to:o};return t[s].push(u),u}function i(s,o){s.forEach(l=>l.to=o)}function a(s,o){if(s.type=="choice")return s.exprs.reduce((l,u)=>l.concat(a(u,o)),[]);if(s.type=="seq")for(let l=0;;l++){let u=a(s.exprs[l],o);if(l==s.exprs.length-1)return u;i(u,o=n())}else if(s.type=="star"){let l=n();return r(o,l),i(a(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=n();return i(a(s.expr,o),l),i(a(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(o)].concat(a(s.expr,o));if(s.type=="range"){let l=o;for(let u=0;u<s.min;u++){let c=n();i(a(s.expr,l),c),l=c}if(s.max==-1)i(a(s.expr,l),l);else for(let u=s.min;u<s.max;u++){let c=n();r(l,c),i(a(s.expr,l),c),l=c}return[r(l)]}else{if(s.type=="name")return[r(o,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Lue(e,t){return t-e}function DH(e,t){let n=[];return r(t),n.sort(Lue);function r(i){let a=e[i];if(a.length==1&&!a[0].term)return r(a[0].to);n.push(i);for(let s=0;s<a.length;s++){let{term:o,to:l}=a[s];!o&&n.indexOf(l)==-1&&r(l)}}}function Ovt(e){let t=Object.create(null);return n(DH(e,0));function n(r){let i=[];r.forEach(s=>{e[s].forEach(({term:o,to:l})=>{if(!o)return;let u;for(let c=0;c<i.length;c++)i[c][0]==o&&(u=i[c][1]);DH(e,l).forEach(c=>{u||i.push([o,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let a=t[r.join(",")]=new bh(r.indexOf(e.length-1)>-1);for(let s=0;s<i.length;s++){let o=i[s][1].sort(Lue);a.next.push({type:i[s][0],next:t[o.join(",")]||n(o)})}return a}}function Pvt(e,t){for(let n=0,r=[e];n<r.length;n++){let i=r[n],a=!i.validEnd,s=[];for(let o=0;o<i.next.length;o++){let{type:l,next:u}=i.next[o];s.push(l.name),a&&!(l.isText||l.hasRequiredAttrs())&&(a=!1),r.indexOf(u)==-1&&r.push(u)}a&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Fue(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function zue(e,t){let n=Object.create(null);for(let r in e){let i=t&&t[r];if(i===void 0){let a=e[r];if(a.hasDefault)i=a.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function Bue(e){let t=Object.create(null);if(e)for(let n in e)t[n]=new Avt(e[n]);return t}class CI{constructor(t,n,r){this.name=t,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Bue(r.attrs),this.defaultAttrs=Fue(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==bh.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:zue(this.attrs,t)}create(t=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Wl(this,this.computeAttrs(t),Ae.from(n),Sn.setFrom(r))}createChecked(t=null,n,r){return n=Ae.from(n),this.checkContent(n),new Wl(this,this.computeAttrs(t),n,Sn.setFrom(r))}createAndFill(t=null,n,r){if(t=this.computeAttrs(t),n=Ae.from(n),n.size){let s=this.contentMatch.fillBefore(n);if(!s)return null;n=s.append(n)}let i=this.contentMatch.matchFragment(n),a=i&&i.fillBefore(Ae.empty,!0);return a?new Wl(this,t,n.append(a),Sn.setFrom(r)):null}validContent(t){let n=this.contentMatch.matchFragment(t);if(!n||!n.validEnd)return!1;for(let r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let n=0;n<t.length;n++)if(!this.allowsMarkType(t[n].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let n;for(let r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?n&&n.push(t[r]):n||(n=t.slice(0,r));return n?n.length?n:Sn.none:t}static compile(t,n){let r=Object.create(null);t.forEach((a,s)=>r[a]=new CI(a,n,s));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let a in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}class Avt{constructor(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default}get isRequired(){return!this.hasDefault}}class yT{constructor(t,n,r,i){this.name=t,this.rank=n,this.schema=r,this.spec=i,this.attrs=Bue(i.attrs),this.excluded=null;let a=Fue(this.attrs);this.instance=a?new Sn(this,a):null}create(t=null){return!t&&this.instance?this.instance:new Sn(this,zue(this.attrs,t))}static compile(t,n){let r=Object.create(null),i=0;return t.forEach((a,s)=>r[a]=new yT(a,i++,n,s)),r}removeFromSet(t){for(var n=0;n<t.length;n++)t[n].type==this&&(t=t.slice(0,n).concat(t.slice(n+1)),n--);return t}isInSet(t){for(let n=0;n<t.length;n++)if(t[n].type==this)return t[n]}excludes(t){return this.excluded.indexOf(t)>-1}}class Mvt{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in t)n[i]=t[i];n.nodes=ji.from(t.nodes),n.marks=ji.from(t.marks||{}),this.nodes=CI.compile(this.spec.nodes,this),this.marks=yT.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let a=this.nodes[i],s=a.spec.content||"",o=a.spec.marks;if(a.contentMatch=r[s]||(r[s]=bh.parse(s,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=o=="_"?null:o?LH(this,o.split(" ")):o==""||!a.inlineContent?[]:null}for(let i in this.marks){let a=this.marks[i],s=a.spec.excludes;a.excluded=s==null?[a]:s==""?[]:LH(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,n=null,r,i){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof CI){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(n,r,i)}text(t,n){let r=this.nodes.text;return new SI(r,r.defaultAttrs,t,Sn.setFrom(n))}mark(t,n){return typeof t=="string"&&(t=this.marks[t]),t.create(n)}nodeFromJSON(t){return Wl.fromJSON(this,t)}markFromJSON(t){return Sn.fromJSON(this,t)}nodeType(t){let n=this.nodes[t];if(!n)throw new RangeError("Unknown node type: "+t);return n}}function LH(e,t){let n=[];for(let r=0;r<t.length;r++){let i=t[r],a=e.marks[i],s=a;if(a)n.push(a);else for(let o in e.marks){let l=e.marks[o];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}function Rvt(e){return e.tag!=null}function Dvt(e){return e.style!=null}class hy{constructor(t,n){this.schema=t,this.rules=n,this.tags=[],this.styles=[],n.forEach(r=>{Rvt(r)?this.tags.push(r):Dvt(r)&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=t.nodes[r.node];return i.contentMatch.matchType(i)})}parse(t,n={}){let r=new zH(this,n,!1);return r.addAll(t,n.from,n.to),r.finish()}parseSlice(t,n={}){let r=new zH(this,n,!0);return r.addAll(t,n.from,n.to),Qe.maxOpen(r.finish())}matchTag(t,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let a=this.tags[i];if(zvt(t,a.tag)&&(a.namespace===void 0||t.namespaceURI==a.namespace)&&(!a.context||n.matchesContext(a.context))){if(a.getAttrs){let s=a.getAttrs(t);if(s===!1)continue;a.attrs=s||void 0}return a}}}matchStyle(t,n,r,i){for(let a=i?this.styles.indexOf(i)+1:0;a<this.styles.length;a++){let s=this.styles[a],o=s.style;if(!(o.indexOf(t)!=0||s.context&&!r.matchesContext(s.context)||o.length>t.length&&(o.charCodeAt(t.length)!=61||o.slice(t.length+1)!=n))){if(s.getAttrs){let l=s.getAttrs(n);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(t){let n=[];function r(i){let a=i.priority==null?50:i.priority,s=0;for(;s<n.length;s++){let o=n[s];if((o.priority==null?50:o.priority)<a)break}n.splice(s,0,i)}for(let i in t.marks){let a=t.marks[i].spec.parseDOM;a&&a.forEach(s=>{r(s=BH(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in t.nodes){let a=t.nodes[i].spec.parseDOM;a&&a.forEach(s=>{r(s=BH(s)),s.node||s.ignore||s.mark||(s.node=i)})}return n}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new hy(t,hy.schemaRules(t)))}}const Wue={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Lvt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Vue={ol:!0,ul:!0},II=1,$I=2,$b=4;function FH(e,t,n){return t!=null?(t?II:0)|(t==="full"?$I:0):e&&e.whitespace=="pre"?II|$I:n&~$b}class C_{constructor(t,n,r,i,a,s,o){this.type=t,this.attrs=n,this.marks=r,this.pendingMarks=i,this.solid=a,this.options=o,this.content=[],this.activeMarks=Sn.none,this.stashMarks=[],this.match=s||(o&$b?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(Ae.from(t));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(t.type))?(this.match=r,i):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&II)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let a=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-i[0].length))}}let n=Ae.from(this.content);return!t&&this.match&&(n=n.append(this.match.fillBefore(Ae.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}popFromStashMark(t){for(let n=this.stashMarks.length-1;n>=0;n--)if(t.eq(this.stashMarks[n]))return this.stashMarks.splice(n,1)[0]}applyPending(t){for(let n=0,r=this.pendingMarks;n<r.length;n++){let i=r[n];(this.type?this.type.allowsMarkType(i.type):Bvt(i.type,t))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!Wue.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class zH{constructor(t,n,r){this.parser=t,this.options=n,this.isOpen=r,this.open=0;let i=n.topNode,a,s=FH(null,n.preserveWhitespace,0)|(r?$b:0);i?a=new C_(i.type,i.attrs,Sn.none,Sn.none,!0,n.topMatch||i.type.contentMatch,s):r?a=new C_(null,null,Sn.none,Sn.none,!0,null,s):a=new C_(t.schema.topNodeType,null,Sn.none,Sn.none,!0,null,s),this.nodes=[a],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t){t.nodeType==3?this.addTextNode(t):t.nodeType==1&&this.addElement(t)}withStyleRules(t,n){let r=t.style;if(!r||!r.length)return n();let i=this.readStyles(t.style);if(!i)return;let[a,s]=i,o=this.top;for(let l=0;l<s.length;l++)this.removePendingMark(s[l],o);for(let l=0;l<a.length;l++)this.addPendingMark(a[l]);n();for(let l=0;l<a.length;l++)this.removePendingMark(a[l],o);for(let l=0;l<s.length;l++)this.addPendingMark(s[l])}addTextNode(t){let n=t.nodeValue,r=this.top;if(r.options&$I||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(r.options&II)r.options&$I?n=n.replace(/\r\n?/g,`
`):n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],a=t.previousSibling;(!i||a&&a.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n)),this.findInText(t)}else this.findInside(t)}addElement(t,n){let r=t.nodeName.toLowerCase(),i;Vue.hasOwnProperty(r)&&this.parser.normalizeLists&&Fvt(t);let a=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(i=this.parser.matchTag(t,this,n));if(a?a.ignore:Lvt.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(t=a.skip);let s,o=this.top,l=this.needsBlock;if(Wue.hasOwnProperty(r))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),s=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t);return}a&&a.skip?this.addAll(t):this.withStyleRules(t,()=>this.addAll(t)),s&&this.sync(o),this.needsBlock=l}else this.withStyleRules(t,()=>{this.addElementByRule(t,a,a.consuming===!1?i:void 0)})}leafFallback(t){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`))}ignoreFallback(t){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(t){let n=Sn.none,r=Sn.none;for(let i=0,a=t.length;i<a;i++){let s=t.item(i);for(let o=void 0;;){let l=this.parser.matchStyle(s,t.getPropertyValue(s),this,o);if(!l)break;if(l.ignore)return null;if(l.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(u=>{l.clearMark(u)&&(r=u.addToSet(r))}):n=this.parser.schema.marks[l.mark].create(l.attrs).addToSet(n),l.consuming===!1)o=l;else break}}return[n,r]}addElementByRule(t,n,r){let i,a,s;n.node?(a=this.parser.schema.nodes[n.node],a.isLeaf?this.insertNode(a.create(n.attrs))||this.leafFallback(t):i=this.enter(a,n.attrs||null,n.preserveWhitespace)):(s=this.parser.schema.marks[n.mark].create(n.attrs),this.addPendingMark(s));let o=this.top;if(a&&a.isLeaf)this.findInside(t);else if(r)this.addElement(t,r);else if(n.getContent)this.findInside(t),n.getContent(t,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=t;typeof n.contentElement=="string"?l=t.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(t):n.contentElement&&(l=n.contentElement),this.findAround(t,l,!0),this.addAll(l)}i&&this.sync(o)&&this.open--,s&&this.removePendingMark(s,o)}addAll(t,n,r){let i=n||0;for(let a=n?t.childNodes[n]:t.firstChild,s=r==null?null:t.childNodes[r];a!=s;a=a.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(a);this.findAtPoint(t,i)}findPlace(t){let n,r;for(let i=this.open;i>=0;i--){let a=this.nodes[i],s=a.findWrapping(t);if(s&&(!n||n.length>s.length)&&(n=s,r=a,!s.length)||a.solid)break}if(!n)return!1;this.sync(r);for(let i=0;i<n.length;i++)this.enterInner(n[i],null,!1);return!0}insertNode(t){if(t.isInline&&this.needsBlock&&!this.top.type){let n=this.textblockFromContext();n&&this.enterInner(n)}if(this.findPlace(t)){this.closeExtra();let n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));let r=n.activeMarks;for(let i=0;i<t.marks.length;i++)(!n.type||n.type.allowsMarkType(t.marks[i].type))&&(r=t.marks[i].addToSet(r));return n.content.push(t.mark(r)),!0}return!1}enter(t,n,r){let i=this.findPlace(t.create(n));return i&&this.enterInner(t,n,!0,r),i}enterInner(t,n=null,r=!1,i){this.closeExtra();let a=this.top;a.applyPending(t),a.match=a.match&&a.match.matchType(t);let s=FH(t,i,a.options);a.options&$b&&a.content.length==0&&(s|=$b),this.nodes.push(new C_(t,n,a.activeMarks,a.pendingMarks,r,null,s)),this.open++}closeExtra(t=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(t){for(let n=this.open;n>=0;n--)if(this.nodes[n]==t)return this.open=n,!0;return!1}get currentPos(){this.closeExtra();let t=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)t+=r[i].nodeSize;n&&t++}return t}findAtPoint(t,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&t.nodeType==1&&t.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(t,n,r){if(t!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&(this.find[n].pos=this.currentPos-(t.nodeValue.length-this.find[n].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let n=t.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),a=-(r?r.depth+1:0)+(i?0:1),s=(o,l)=>{for(;o>=0;o--){let u=n[o];if(u==""){if(o==n.length-1||o==0)continue;for(;l>=a;l--)if(s(o-1,l))return!0;return!1}else{let c=l>0||l==0&&i?this.nodes[l].type:r&&l>=a?r.node(l-a).type:null;if(!c||c.name!=u&&c.groups.indexOf(u)==-1)return!1;l--}}return!0};return s(n.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let n=t.depth;n>=0;n--){let r=t.node(n).contentMatchAt(t.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(t){let n=Wvt(t,this.top.pendingMarks);n&&this.top.stashMarks.push(n),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)}removePendingMark(t,n){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(t)>-1)i.pendingMarks=t.removeFromSet(i.pendingMarks);else{i.activeMarks=t.removeFromSet(i.activeMarks);let s=i.popFromStashMark(t);s&&i.type&&i.type.allowsMarkType(s.type)&&(i.activeMarks=s.addToSet(i.activeMarks))}if(i==n)break}}}function Fvt(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let r=t.nodeType==1?t.nodeName.toLowerCase():null;r&&Vue.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):r=="li"?n=t:r&&(n=null)}}function zvt(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function BH(e){let t={};for(let n in e)t[n]=e[n];return t}function Bvt(e,t){let n=t.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(e))continue;let a=[],s=o=>{a.push(o);for(let l=0;l<o.edgeCount;l++){let{type:u,next:c}=o.edge(l);if(u==t||a.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}function Wvt(e,t){for(let n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}class Pl{constructor(t,n){this.nodes=t,this.marks=n}serializeFragment(t,n={},r){r||(r=bE(n).createDocumentFragment());let i=r,a=[];return t.forEach(s=>{if(a.length||s.marks.length){let o=0,l=0;for(;o<a.length&&l<s.marks.length;){let u=s.marks[l];if(!this.marks[u.type.name]){l++;continue}if(!u.eq(a[o][0])||u.type.spec.spanning===!1)break;o++,l++}for(;o<a.length;)i=a.pop()[1];for(;l<s.marks.length;){let u=s.marks[l++],c=this.serializeMark(u,s.isInline,n);c&&(a.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,n))}),r}serializeNodeInner(t,n){let{dom:r,contentDOM:i}=Pl.renderSpec(bE(n),this.nodes[t.type.name](t));if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,n,i)}return r}serializeNode(t,n={}){let r=this.serializeNodeInner(t,n);for(let i=t.marks.length-1;i>=0;i--){let a=this.serializeMark(t.marks[i],t.isInline,n);a&&((a.contentDOM||a.dom).appendChild(r),r=a.dom)}return r}serializeMark(t,n,r={}){let i=this.marks[t.type.name];return i&&Pl.renderSpec(bE(r),i(t,n))}static renderSpec(t,n,r=null){if(typeof n=="string")return{dom:t.createTextNode(n)};if(n.nodeType!=null)return{dom:n};if(n.dom&&n.dom.nodeType!=null)return n;let i=n[0],a=i.indexOf(" ");a>0&&(r=i.slice(0,a),i=i.slice(a+1));let s,o=r?t.createElementNS(r,i):t.createElement(i),l=n[1],u=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){u=2;for(let c in l)if(l[c]!=null){let d=c.indexOf(" ");d>0?o.setAttributeNS(c.slice(0,d),c.slice(d+1),l[c]):o.setAttribute(c,l[c])}}for(let c=u;c<n.length;c++){let d=n[c];if(d===0){if(c<n.length-1||c>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:o,contentDOM:o}}else{let{dom:p,contentDOM:h}=Pl.renderSpec(t,d,r);if(o.appendChild(p),h){if(s)throw new RangeError("Multiple content holes");s=h}}}return{dom:o,contentDOM:s}}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new Pl(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let n=WH(t.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(t){return WH(t.marks)}}function WH(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function bE(e){return e.document||window.document}const jue=65535,Uue=Math.pow(2,16);function Vvt(e,t){return e+t*Uue}function VH(e){return e&jue}function jvt(e){return(e-(e&jue))/Uue}const Hue=1,Gue=2,fk=4,que=8;class yA{constructor(t,n,r){this.pos=t,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&que)>0}get deletedBefore(){return(this.delInfo&(Hue|fk))>0}get deletedAfter(){return(this.delInfo&(Gue|fk))>0}get deletedAcross(){return(this.delInfo&fk)>0}}class Cs{constructor(t,n=!1){if(this.ranges=t,this.inverted=n,!t.length&&Cs.empty)return Cs.empty}recover(t){let n=0,r=VH(t);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+jvt(t)}mapResult(t,n=1){return this._map(t,n,!1)}map(t,n=1){return this._map(t,n,!0)}_map(t,n,r){let i=0,a=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?i:0);if(l>t)break;let u=this.ranges[o+a],c=this.ranges[o+s],d=l+u;if(t<=d){let p=u?t==l?-1:t==d?1:n:n,h=l+i+(p<0?0:c);if(r)return h;let m=t==(n<0?l:d)?null:Vvt(o/3,t-l),g=t==l?Gue:t==d?Hue:fk;return(n<0?t!=l:t!=d)&&(g|=que),new yA(h,g,m)}i+=c-u}return r?t+i:new yA(t+i,0,null)}touches(t,n){let r=0,i=VH(n),a=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?r:0);if(l>t)break;let u=this.ranges[o+a],c=l+u;if(t<=c&&o==i*3)return!0;r+=this.ranges[o+s]-u}return!1}forEach(t){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,a=0;i<this.ranges.length;i+=3){let s=this.ranges[i],o=s-(this.inverted?a:0),l=s+(this.inverted?0:a),u=this.ranges[i+n],c=this.ranges[i+r];t(o,o+u,l,l+c),a+=c-u}}invert(){return new Cs(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?Cs.empty:new Cs(t<0?[0,-t,0]:[0,0,t])}}Cs.empty=new Cs([]);class Ng{constructor(t=[],n,r=0,i=t.length){this.maps=t,this.mirror=n,this.from=r,this.to=i}slice(t=0,n=this.maps.length){return new Ng(this.maps,this.mirror,t,n)}copy(){return new Ng(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(t,n){this.to=this.maps.push(t),n!=null&&this.setMirror(this.maps.length-1,n)}appendMapping(t){for(let n=0,r=this.maps.length;n<t.maps.length;n++){let i=t.getMirror(n);this.appendMap(t.maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(t){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==t)return this.mirror[n+(n%2?-1:1)]}}setMirror(t,n){this.mirror||(this.mirror=[]),this.mirror.push(t,n)}appendMappingInverted(t){for(let n=t.maps.length-1,r=this.maps.length+t.maps.length;n>=0;n--){let i=t.getMirror(n);this.appendMap(t.maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let t=new Ng;return t.appendMappingInverted(this),t}map(t,n=1){if(this.mirror)return this._map(t,n,!0);for(let r=this.from;r<this.to;r++)t=this.maps[r].map(t,n);return t}mapResult(t,n=1){return this._map(t,n,!1)}_map(t,n,r){let i=0;for(let a=this.from;a<this.to;a++){let s=this.maps[a],o=s.mapResult(t,n);if(o.recover!=null){let l=this.getMirror(a);if(l!=null&&l>a&&l<this.to){a=l,t=this.maps[l].recover(o.recover);continue}}i|=o.delInfo,t=o.pos}return r?t:new yA(t,i,null)}}const wE=Object.create(null);class Ia{getMap(){return Cs.empty}merge(t){return null}static fromJSON(t,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=wE[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(t,n)}static jsonID(t,n){if(t in wE)throw new RangeError("Duplicate use of step JSON ID "+t);return wE[t]=n,n.prototype.jsonID=t,n}}class Qr{constructor(t,n){this.doc=t,this.failed=n}static ok(t){return new Qr(t,null)}static fail(t){return new Qr(null,t)}static fromReplace(t,n,r,i){try{return Qr.ok(t.replace(n,r,i))}catch(a){if(a instanceof xI)return Qr.fail(a.message);throw a}}}function d3(e,t,n){let r=[];for(let i=0;i<e.childCount;i++){let a=e.child(i);a.content.size&&(a=a.copy(d3(a.content,t,a))),a.isInline&&(a=t(a,n,i)),r.push(a)}return Ae.fromArray(r)}class Rc extends Ia{constructor(t,n,r){super(),this.from=t,this.to=n,this.mark=r}apply(t){let n=t.slice(this.from,this.to),r=t.resolve(this.from),i=r.node(r.sharedDepth(this.to)),a=new Qe(d3(n.content,(s,o)=>!s.isAtom||!o.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),n.openStart,n.openEnd);return Qr.fromReplace(t,this.from,this.to,a)}invert(){return new Al(this.from,this.to,this.mark)}map(t){let n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Rc(n.pos,r.pos,this.mark)}merge(t){return t instanceof Rc&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Rc(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Rc(n.from,n.to,t.markFromJSON(n.mark))}}Ia.jsonID("addMark",Rc);class Al extends Ia{constructor(t,n,r){super(),this.from=t,this.to=n,this.mark=r}apply(t){let n=t.slice(this.from,this.to),r=new Qe(d3(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),t),n.openStart,n.openEnd);return Qr.fromReplace(t,this.from,this.to,r)}invert(){return new Rc(this.from,this.to,this.mark)}map(t){let n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Al(n.pos,r.pos,this.mark)}merge(t){return t instanceof Al&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Al(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Al(n.from,n.to,t.markFromJSON(n.mark))}}Ia.jsonID("removeMark",Al);class Dc extends Ia{constructor(t,n){super(),this.pos=t,this.mark=n}apply(t){let n=t.nodeAt(this.pos);if(!n)return Qr.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Qr.fromReplace(t,this.pos,this.pos+1,new Qe(Ae.from(r),0,n.isLeaf?0:1))}invert(t){let n=t.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new Dc(this.pos,n.marks[i]);return new Dc(this.pos,this.mark)}}return new fy(this.pos,this.mark)}map(t){let n=t.mapResult(this.pos,1);return n.deletedAfter?null:new Dc(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Dc(n.pos,t.markFromJSON(n.mark))}}Ia.jsonID("addNodeMark",Dc);class fy extends Ia{constructor(t,n){super(),this.pos=t,this.mark=n}apply(t){let n=t.nodeAt(this.pos);if(!n)return Qr.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Qr.fromReplace(t,this.pos,this.pos+1,new Qe(Ae.from(r),0,n.isLeaf?0:1))}invert(t){let n=t.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new Dc(this.pos,this.mark)}map(t){let n=t.mapResult(this.pos,1);return n.deletedAfter?null:new fy(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new fy(n.pos,t.markFromJSON(n.mark))}}Ia.jsonID("removeNodeMark",fy);class Ci extends Ia{constructor(t,n,r,i=!1){super(),this.from=t,this.to=n,this.slice=r,this.structure=i}apply(t){return this.structure&&vA(t,this.from,this.to)?Qr.fail("Structure replace would overwrite content"):Qr.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Cs([this.from,this.to-this.from,this.slice.size])}invert(t){return new Ci(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Ci(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(t){if(!(t instanceof Ci)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let n=this.slice.size+t.slice.size==0?Qe.empty:new Qe(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Ci(this.from,this.to+(t.to-t.from),n,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let n=this.slice.size+t.slice.size==0?Qe.empty:new Qe(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Ci(t.from,this.to,n,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ci(n.from,n.to,Qe.fromJSON(t,n.slice),!!n.structure)}}Ia.jsonID("replace",Ci);class Oi extends Ia{constructor(t,n,r,i,a,s,o=!1){super(),this.from=t,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=a,this.insert=s,this.structure=o}apply(t){if(this.structure&&(vA(t,this.from,this.gapFrom)||vA(t,this.gapTo,this.to)))return Qr.fail("Structure gap-replace would overwrite content");let n=t.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Qr.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?Qr.fromReplace(t,this.from,this.to,r):Qr.fail("Content does not fit in gap")}getMap(){return new Cs([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let n=this.gapTo-this.gapFrom;return new Oi(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:t.map(this.gapFrom,-1),a=this.to==this.gapTo?r.pos:t.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||a>r.pos?null:new Oi(n.pos,r.pos,i,a,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Oi(n.from,n.to,n.gapFrom,n.gapTo,Qe.fromJSON(t,n.slice),n.insert,!!n.structure)}}Ia.jsonID("replaceAround",Oi);function vA(e,t,n){let r=e.resolve(t),i=n-t,a=r.depth;for(;i>0&&a>0&&r.indexAfter(a)==r.node(a).childCount;)a--,i--;if(i>0){let s=r.node(a).maybeChild(r.indexAfter(a));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function Uvt(e,t,n,r){let i=[],a=[],s,o;e.doc.nodesBetween(t,n,(l,u,c)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&c.type.allowsMarkType(r.type)){let p=Math.max(u,t),h=Math.min(u+l.nodeSize,n),m=r.addToSet(d);for(let g=0;g<d.length;g++)d[g].isInSet(m)||(s&&s.to==p&&s.mark.eq(d[g])?s.to=h:i.push(s=new Al(p,h,d[g])));o&&o.to==p?o.to=h:a.push(o=new Rc(p,h,r))}}),i.forEach(l=>e.step(l)),a.forEach(l=>e.step(l))}function Hvt(e,t,n,r){let i=[],a=0;e.doc.nodesBetween(t,n,(s,o)=>{if(!s.isInline)return;a++;let l=null;if(r instanceof yT){let u=s.marks,c;for(;c=r.isInSet(u);)(l||(l=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let u=Math.min(o+s.nodeSize,n);for(let c=0;c<l.length;c++){let d=l[c],p;for(let h=0;h<i.length;h++){let m=i[h];m.step==a-1&&d.eq(i[h].style)&&(p=m)}p?(p.to=u,p.step=a):i.push({style:d,from:Math.max(o,t),to:u,step:a})}}}),i.forEach(s=>e.step(new Al(s.from,s.to,s.style)))}function Kue(e,t,n,r=n.contentMatch,i=!0){let a=e.doc.nodeAt(t),s=[],o=t+1;for(let l=0;l<a.childCount;l++){let u=a.child(l),c=o+u.nodeSize,d=r.matchType(u.type);if(!d)s.push(new Ci(o,c,Qe.empty));else{r=d;for(let p=0;p<u.marks.length;p++)n.allowsMarkType(u.marks[p].type)||e.step(new Al(o,c,u.marks[p]));if(i&&u.isText&&n.whitespace!="pre"){let p,h=/\r?\n|\r/g,m;for(;p=h.exec(u.text);)m||(m=new Qe(Ae.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),s.push(new Ci(o+p.index,o+p.index+p[0].length,m))}}o=c}if(!r.validEnd){let l=r.fillBefore(Ae.empty,!0);e.replace(o,o,new Qe(l,0,0))}for(let l=s.length-1;l>=0;l--)e.step(s[l])}function Gvt(e,t,n){return(t==0||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function n0(e){let n=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let r=e.depth;;--r){let i=e.$from.node(r),a=e.$from.index(r),s=e.$to.indexAfter(r);if(r<e.depth&&i.canReplace(a,s,n))return r;if(r==0||i.type.spec.isolating||!Gvt(i,a,s))break}return null}function qvt(e,t,n){let{$from:r,$to:i,depth:a}=t,s=r.before(a+1),o=i.after(a+1),l=s,u=o,c=Ae.empty,d=0;for(let m=a,g=!1;m>n;m--)g||r.index(m)>0?(g=!0,c=Ae.from(r.node(m).copy(c)),d++):l--;let p=Ae.empty,h=0;for(let m=a,g=!1;m>n;m--)g||i.after(m+1)<i.end(m)?(g=!0,p=Ae.from(i.node(m).copy(p)),h++):u++;e.step(new Oi(l,u,s,o,new Qe(c.append(p),d,h),c.size-d,!0))}function p3(e,t,n=null,r=e){let i=Kvt(e,t),a=i&&Zvt(r,t);return a?i.map(jH).concat({type:t,attrs:n}).concat(a.map(jH)):null}function jH(e){return{type:e,attrs:null}}function Kvt(e,t){let{parent:n,startIndex:r,endIndex:i}=e,a=n.contentMatchAt(r).findWrapping(t);if(!a)return null;let s=a.length?a[0]:t;return n.canReplaceWith(r,i,s)?a:null}function Zvt(e,t){let{parent:n,startIndex:r,endIndex:i}=e,a=n.child(r),s=t.contentMatch.findWrapping(a.type);if(!s)return null;let l=(s.length?s[s.length-1]:t).contentMatch;for(let u=r;l&&u<i;u++)l=l.matchType(n.child(u).type);return!l||!l.validEnd?null:s}function Xvt(e,t,n){let r=Ae.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let o=n[s].type.contentMatch.matchFragment(r);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Ae.from(n[s].type.create(n[s].attrs,r))}let i=t.start,a=t.end;e.step(new Oi(i,a,i,a,new Qe(r,0,0),n.length,!0))}function Jvt(e,t,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=e.steps.length;e.doc.nodesBetween(t,n,(s,o)=>{if(s.isTextblock&&!s.hasMarkup(r,i)&&e0t(e.doc,e.mapping.slice(a).map(o),r)){let l=null;if(r.schema.linebreakReplacement){let p=r.whitespace=="pre",h=!!r.contentMatch.matchType(r.schema.linebreakReplacement);p&&!h?l=!1:!p&&h&&(l=!0)}l===!1&&Qvt(e,s,o,a),Kue(e,e.mapping.slice(a).map(o,1),r,void 0,l===null);let u=e.mapping.slice(a),c=u.map(o,1),d=u.map(o+s.nodeSize,1);return e.step(new Oi(c,d,c+1,d-1,new Qe(Ae.from(r.create(i,null,s.marks)),0,0),1,!0)),l===!0&&Yvt(e,s,o,a),!1}})}function Yvt(e,t,n,r){t.forEach((i,a)=>{if(i.isText){let s,o=/\r?\n|\r/g;for(;s=o.exec(i.text);){let l=e.mapping.slice(r).map(n+1+a+s.index);e.replaceWith(l,l+1,t.type.schema.linebreakReplacement.create())}}})}function Qvt(e,t,n,r){t.forEach((i,a)=>{if(i.type==i.type.schema.linebreakReplacement){let s=e.mapping.slice(r).map(n+1+a);e.replaceWith(s,s+1,t.type.schema.text(`
`))}})}function e0t(e,t,n){let r=e.resolve(t),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function t0t(e,t,n,r,i){let a=e.doc.nodeAt(t);if(!a)throw new RangeError("No node at given position");n||(n=a.type);let s=n.create(r,null,i||a.marks);if(a.isLeaf)return e.replaceWith(t,t+a.nodeSize,s);if(!n.validContent(a.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new Oi(t,t+a.nodeSize,t+1,t+a.nodeSize-1,new Qe(Ae.from(s),0,0),1,!0))}function Eg(e,t,n=1,r){let i=e.resolve(t),a=i.depth-n,s=r&&r[r.length-1]||i.parent;if(a<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=n-2;u>a;u--,c--){let d=i.node(u),p=i.index(u);if(d.type.spec.isolating)return!1;let h=d.content.cutByIndex(p,d.childCount),m=r&&r[c+1];m&&(h=h.replaceChild(0,m.type.create(m.attrs)));let g=r&&r[c]||d;if(!d.canReplace(p+1,d.childCount)||!g.type.validContent(h))return!1}let o=i.indexAfter(a),l=r&&r[0];return i.node(a).canReplaceWith(o,o,l?l.type:i.node(a+1).type)}function n0t(e,t,n=1,r){let i=e.doc.resolve(t),a=Ae.empty,s=Ae.empty;for(let o=i.depth,l=i.depth-n,u=n-1;o>l;o--,u--){a=Ae.from(i.node(o).copy(a));let c=r&&r[u];s=Ae.from(c?c.type.create(c.attrs,s):i.node(o).copy(s))}e.step(new Ci(t,t,new Qe(a.append(s),n,n),!0))}function Hd(e,t){let n=e.resolve(t),r=n.index();return Zue(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Zue(e,t){return!!(e&&t&&!e.isLeaf&&e.canAppend(t))}function vT(e,t,n=-1){let r=e.resolve(t);for(let i=r.depth;;i--){let a,s,o=r.index(i);if(i==r.depth?(a=r.nodeBefore,s=r.nodeAfter):n>0?(a=r.node(i+1),o++,s=r.node(i).maybeChild(o)):(a=r.node(i).maybeChild(o-1),s=r.node(i+1)),a&&!a.isTextblock&&Zue(a,s)&&r.node(i).canReplace(o,o+1))return t;if(i==0)break;t=n<0?r.before(i):r.after(i)}}function r0t(e,t,n){let r=new Ci(t-n,t+n,Qe.empty,!0);e.step(r)}function i0t(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let a=r.index(i);if(r.node(i).canReplaceWith(a,a,n))return r.before(i+1);if(a>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let a=r.indexAfter(i);if(r.node(i).canReplaceWith(a,a,n))return r.after(i+1);if(a<r.node(i).childCount)return null}return null}function Xue(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let i=n.content;for(let a=0;a<n.openStart;a++)i=i.firstChild.content;for(let a=1;a<=(n.openStart==0&&n.size?2:1);a++)for(let s=r.depth;s>=0;s--){let o=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(o>0?1:0),u=r.node(s),c=!1;if(a==1)c=u.canReplace(l,l,i);else{let d=u.contentMatchAt(l).findWrapping(i.firstChild.type);c=d&&u.canReplaceWith(l,l,d[0])}if(c)return o==0?r.pos:o<0?r.before(s+1):r.after(s+1)}return null}function bT(e,t,n=t,r=Qe.empty){if(t==n&&!r.size)return null;let i=e.resolve(t),a=e.resolve(n);return Jue(i,a,r)?new Ci(t,n,r):new a0t(i,a,r).fit()}function Jue(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}class a0t{constructor(t,n,r){this.$from=t,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=Ae.empty;for(let i=0;i<=t.depth;i++){let a=t.node(i);this.frontier.push({type:a.type,match:a.contentMatchAt(t.indexAfter(i))})}for(let i=t.depth;i>0;i--)this.placed=Ae.from(t.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(t<0?this.$to:r.doc.resolve(t));if(!i)return null;let a=this.placed,s=r.depth,o=i.depth;for(;s&&o&&a.childCount==1;)a=a.firstChild.content,s--,o--;let l=new Qe(a,s,o);return t>-1?new Oi(r.pos,t,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new Ci(r.pos,i.pos,l):null}findFittable(){let t=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<t;r++){let a=n.firstChild;if(n.childCount>1&&(i=0),a.type.spec.isolating&&i<=r){t=r;break}n=a.content}for(let n=1;n<=2;n++)for(let r=n==1?t:this.unplaced.openStart;r>=0;r--){let i,a=null;r?(a=xE(this.unplaced.content,r-1).firstChild,i=a.content):i=this.unplaced.content;let s=i.firstChild;for(let o=this.depth;o>=0;o--){let{type:l,match:u}=this.frontier[o],c,d=null;if(n==1&&(s?u.matchType(s.type)||(d=u.fillBefore(Ae.from(s),!1)):a&&l.compatibleContent(a.type)))return{sliceDepth:r,frontierDepth:o,parent:a,inject:d};if(n==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:o,parent:a,wrap:c};if(a&&u.matchType(a.type))break}}}openMore(){let{content:t,openStart:n,openEnd:r}=this.unplaced,i=xE(t,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new Qe(t,n+1,Math.max(r,i.size+n>=t.size-r?n+1:0)),!0)}dropNode(){let{content:t,openStart:n,openEnd:r}=this.unplaced,i=xE(t,n);if(i.childCount<=1&&n>0){let a=t.size-n<=n+i.size;this.unplaced=new Qe(ob(t,n-1,1),n-1,a?n-1:r)}else this.unplaced=new Qe(ob(t,n,1),n,r)}placeNodes({sliceDepth:t,frontierDepth:n,parent:r,inject:i,wrap:a}){for(;this.depth>n;)this.closeFrontierNode();if(a)for(let g=0;g<a.length;g++)this.openFrontierNode(a[g]);let s=this.unplaced,o=r?r.content:s.content,l=s.openStart-t,u=0,c=[],{match:d,type:p}=this.frontier[n];if(i){for(let g=0;g<i.childCount;g++)c.push(i.child(g));d=d.matchFragment(i)}let h=o.size+t-(s.content.size-s.openEnd);for(;u<o.childCount;){let g=o.child(u),v=d.matchType(g.type);if(!v)break;u++,(u>1||l==0||g.content.size)&&(d=v,c.push(Yue(g.mark(p.allowedMarks(g.marks)),u==1?l:0,u==o.childCount?h:-1)))}let m=u==o.childCount;m||(h=-1),this.placed=lb(this.placed,n,Ae.from(c)),this.frontier[n].match=d,m&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,v=o;g<h;g++){let y=v.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),v=y.content}this.unplaced=m?t==0?Qe.empty:new Qe(ob(s.content,t-1,1),t-1,h<0?s.openEnd:t-1):new Qe(ob(s.content,t,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],n;if(!t.type.isTextblock||!_E(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(t){e:for(let n=Math.min(this.depth,t.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],a=n<t.depth&&t.end(n+1)==t.pos+(t.depth-(n+1)),s=_E(t,n,i,r,a);if(!!s){for(let o=n-1;o>=0;o--){let{match:l,type:u}=this.frontier[o],c=_E(t,o,u,l,!0);if(!c||c.childCount)continue e}return{depth:n,fit:s,move:a?t.doc.resolve(t.after(n+1)):t}}}}close(t){let n=this.findCloseLevel(t);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=lb(this.placed,n.depth,n.fit)),t=n.move;for(let r=n.depth+1;r<=t.depth;r++){let i=t.node(r),a=i.type.contentMatch.fillBefore(i.content,!0,t.index(r));this.openFrontierNode(i.type,i.attrs,a)}return t}openFrontierNode(t,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=lb(this.placed,this.depth,Ae.from(t.create(n,r))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(Ae.empty,!0);n.childCount&&(this.placed=lb(this.placed,this.frontier.length,n))}}function ob(e,t,n){return t==0?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(ob(e.firstChild.content,t-1,n)))}function lb(e,t,n){return t==0?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(lb(e.lastChild.content,t-1,n)))}function xE(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function Yue(e,t,n){if(t<=0)return e;let r=e.content;return t>1&&(r=r.replaceChild(0,Yue(r.firstChild,t-1,r.childCount==1?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(Ae.empty,!0)))),e.copy(r)}function _E(e,t,n,r,i){let a=e.node(t),s=i?e.indexAfter(t):e.index(t);if(s==a.childCount&&!n.compatibleContent(a.type))return null;let o=r.fillBefore(a.content,!0,s);return o&&!s0t(n,a.content,s)?o:null}function s0t(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}function o0t(e){return e.spec.defining||e.spec.definingForContent}function l0t(e,t,n,r){if(!r.size)return e.deleteRange(t,n);let i=e.doc.resolve(t),a=e.doc.resolve(n);if(Jue(i,a,r))return e.step(new Ci(t,n,r));let s=ece(i,e.doc.resolve(n));s[s.length-1]==0&&s.pop();let o=-(i.depth+1);s.unshift(o);for(let p=i.depth,h=i.pos-1;p>0;p--,h--){let m=i.node(p).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;s.indexOf(p)>-1?o=p:i.before(p)==h&&s.splice(1,0,-p)}let l=s.indexOf(o),u=[],c=r.openStart;for(let p=r.content,h=0;;h++){let m=p.firstChild;if(u.push(m),h==r.openStart)break;p=m.content}for(let p=c-1;p>=0;p--){let h=u[p],m=o0t(h.type);if(m&&!h.sameMarkup(i.node(Math.abs(o)-1)))c=p;else if(m||!h.type.isTextblock)break}for(let p=r.openStart;p>=0;p--){let h=(p+c+1)%(r.openStart+1),m=u[h];if(!!m)for(let g=0;g<s.length;g++){let v=s[(g+l)%s.length],y=!0;v<0&&(y=!1,v=-v);let b=i.node(v-1),_=i.index(v-1);if(b.canReplaceWith(_,_,m.type,m.marks))return e.replace(i.before(v),y?a.after(v):n,new Qe(Que(r.content,0,r.openStart,h),h,r.openEnd))}}let d=e.steps.length;for(let p=s.length-1;p>=0&&(e.replace(t,n,r),!(e.steps.length>d));p--){let h=s[p];h<0||(t=i.before(h),n=a.after(h))}}function Que(e,t,n,r,i){if(t<n){let a=e.firstChild;e=e.replaceChild(0,a.copy(Que(a.content,t+1,n,r,a)))}if(t>r){let a=i.contentMatchAt(0),s=a.fillBefore(e).append(e);e=s.append(a.matchFragment(s).fillBefore(Ae.empty,!0))}return e}function u0t(e,t,n,r){if(!r.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let i=i0t(e.doc,t,r.type);i!=null&&(t=n=i)}e.replaceRange(t,n,new Qe(Ae.from(r),0,0))}function c0t(e,t,n){let r=e.doc.resolve(t),i=e.doc.resolve(n),a=ece(r,i);for(let s=0;s<a.length;s++){let o=a[s],l=s==a.length-1;if(l&&o==0||r.node(o).type.contentMatch.validEnd)return e.delete(r.start(o),i.end(o));if(o>0&&(l||r.node(o-1).canReplace(r.index(o-1),i.indexAfter(o-1))))return e.delete(r.before(o),i.after(o))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(t-r.start(s)==r.depth-s&&n>r.end(s)&&i.end(s)-n!=i.depth-s)return e.delete(r.before(s),n);e.delete(t,n)}function ece(e,t){let n=[],r=Math.min(e.depth,t.depth);for(let i=r;i>=0;i--){let a=e.start(i);if(a<e.pos-(e.depth-i)||t.end(i)>t.pos+(t.depth-i)||e.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(a==t.start(i)||i==e.depth&&i==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==a-1)&&n.push(i)}return n}class Og extends Ia{constructor(t,n,r){super(),this.pos=t,this.attr=n,this.value=r}apply(t){let n=t.nodeAt(this.pos);if(!n)return Qr.fail("No node at attribute step's position");let r=Object.create(null);for(let a in n.attrs)r[a]=n.attrs[a];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return Qr.fromReplace(t,this.pos,this.pos+1,new Qe(Ae.from(i),0,n.isLeaf?0:1))}getMap(){return Cs.empty}invert(t){return new Og(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let n=t.mapResult(this.pos,1);return n.deletedAfter?null:new Og(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Og(n.pos,n.attr,n.value)}}Ia.jsonID("attr",Og);class b1 extends Ia{constructor(t,n){super(),this.attr=t,this.value=n}apply(t){let n=Object.create(null);for(let i in t.attrs)n[i]=t.attrs[i];n[this.attr]=this.value;let r=t.type.create(n,t.content,t.marks);return Qr.ok(r)}getMap(){return Cs.empty}invert(t){return new b1(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new b1(n.attr,n.value)}}Ia.jsonID("docAttr",b1);let my=class extends Error{};my=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n};my.prototype=Object.create(Error.prototype);my.prototype.constructor=my;my.prototype.name="TransformError";class d0t{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new Ng}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let n=this.maybeStep(t);if(n.failed)throw new my(n.failed);return this}maybeStep(t){let n=t.apply(this.doc);return n.failed||this.addStep(t,n.doc),n}get docChanged(){return this.steps.length>0}addStep(t,n){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=n}replace(t,n=t,r=Qe.empty){let i=bT(this.doc,t,n,r);return i&&this.step(i),this}replaceWith(t,n,r){return this.replace(t,n,new Qe(Ae.from(r),0,0))}delete(t,n){return this.replace(t,n,Qe.empty)}insert(t,n){return this.replaceWith(t,t,n)}replaceRange(t,n,r){return l0t(this,t,n,r),this}replaceRangeWith(t,n,r){return u0t(this,t,n,r),this}deleteRange(t,n){return c0t(this,t,n),this}lift(t,n){return qvt(this,t,n),this}join(t,n=1){return r0t(this,t,n),this}wrap(t,n){return Xvt(this,t,n),this}setBlockType(t,n=t,r,i=null){return Jvt(this,t,n,r,i),this}setNodeMarkup(t,n,r=null,i){return t0t(this,t,n,r,i),this}setNodeAttribute(t,n,r){return this.step(new Og(t,n,r)),this}setDocAttribute(t,n){return this.step(new b1(t,n)),this}addNodeMark(t,n){return this.step(new Dc(t,n)),this}removeNodeMark(t,n){if(!(n instanceof Sn)){let r=this.doc.nodeAt(t);if(!r)throw new RangeError("No node at position "+t);if(n=n.isInSet(r.marks),!n)return this}return this.step(new fy(t,n)),this}split(t,n=1,r){return n0t(this,t,n,r),this}addMark(t,n,r){return Uvt(this,t,n,r),this}removeMark(t,n,r){return Hvt(this,t,n,r),this}clearIncompatible(t,n,r){return Kue(this,t,n,r),this}}const kE=Object.create(null);class en{constructor(t,n,r){this.$anchor=t,this.$head=n,this.ranges=r||[new p0t(t.min(n),t.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let n=0;n<t.length;n++)if(t[n].$from.pos!=t[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,n=Qe.empty){let r=n.content.lastChild,i=null;for(let o=0;o<n.openEnd;o++)i=r,r=r.lastChild;let a=t.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:l,$to:u}=s[o],c=t.mapping.slice(a);t.replaceRange(c.map(l.pos),c.map(u.pos),o?Qe.empty:n),o==0&&GH(t,a,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(t,n){let r=t.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:s,$to:o}=i[a],l=t.mapping.slice(r),u=l.map(s.pos),c=l.map(o.pos);a?t.deleteRange(u,c):(t.replaceRangeWith(u,c,n),GH(t,r,n.isInline?-1:1))}}static findFrom(t,n,r=!1){let i=t.parent.inlineContent?new Ht(t):Gm(t.node(0),t.parent,t.pos,t.index(),n,r);if(i)return i;for(let a=t.depth-1;a>=0;a--){let s=n<0?Gm(t.node(0),t.node(a),t.before(a+1),t.index(a),n,r):Gm(t.node(0),t.node(a),t.after(a+1),t.index(a)+1,n,r);if(s)return s}return null}static near(t,n=1){return this.findFrom(t,n)||this.findFrom(t,-n)||new jo(t.node(0))}static atStart(t){return Gm(t,t,0,0,1)||new jo(t)}static atEnd(t){return Gm(t,t,t.content.size,t.childCount,-1)||new jo(t)}static fromJSON(t,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=kE[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(t,n)}static jsonID(t,n){if(t in kE)throw new RangeError("Duplicate use of selection JSON ID "+t);return kE[t]=n,n.prototype.jsonID=t,n}getBookmark(){return Ht.between(this.$anchor,this.$head).getBookmark()}}en.prototype.visible=!0;class p0t{constructor(t,n){this.$from=t,this.$to=n}}let UH=!1;function HH(e){!UH&&!e.parent.inlineContent&&(UH=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class Ht extends en{constructor(t,n=t){HH(t),HH(n),super(t,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,n){let r=t.resolve(n.map(this.head));if(!r.parent.inlineContent)return en.near(r);let i=t.resolve(n.map(this.anchor));return new Ht(i.parent.inlineContent?i:r,r)}replace(t,n=Qe.empty){if(super.replace(t,n),n==Qe.empty){let r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}}eq(t){return t instanceof Ht&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new wT(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ht(t.resolve(n.anchor),t.resolve(n.head))}static create(t,n,r=n){let i=t.resolve(n);return new this(i,r==n?i:t.resolve(r))}static between(t,n,r){let i=t.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let a=en.findFrom(n,r,!0)||en.findFrom(n,-r,!0);if(a)n=a.$head;else return en.near(n,r)}return t.parent.inlineContent||(i==0?t=n:(t=(en.findFrom(t,-r,!0)||en.findFrom(t,r,!0)).$anchor,t.pos<n.pos!=i<0&&(t=n))),new Ht(t,n)}}en.jsonID("text",Ht);class wT{constructor(t,n){this.anchor=t,this.head=n}map(t){return new wT(t.map(this.anchor),t.map(this.head))}resolve(t){return Ht.between(t.resolve(this.anchor),t.resolve(this.head))}}class It extends en{constructor(t){let n=t.nodeAfter,r=t.node(0).resolve(t.pos+n.nodeSize);super(t,r),this.node=n}map(t,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),a=t.resolve(i);return r?en.near(a):new It(a)}content(){return new Qe(Ae.from(this.node),0,0)}eq(t){return t instanceof It&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new h3(this.anchor)}static fromJSON(t,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new It(t.resolve(n.anchor))}static create(t,n){return new It(t.resolve(n))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}It.prototype.visible=!1;en.jsonID("node",It);class h3{constructor(t){this.anchor=t}map(t){let{deleted:n,pos:r}=t.mapResult(this.anchor);return n?new wT(r,r):new h3(r)}resolve(t){let n=t.resolve(this.anchor),r=n.nodeAfter;return r&&It.isSelectable(r)?new It(n):en.near(n)}}class jo extends en{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,n=Qe.empty){if(n==Qe.empty){t.delete(0,t.doc.content.size);let r=en.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else super.replace(t,n)}toJSON(){return{type:"all"}}static fromJSON(t){return new jo(t)}map(t){return new jo(t)}eq(t){return t instanceof jo}getBookmark(){return h0t}}en.jsonID("all",jo);const h0t={map(){return this},resolve(e){return new jo(e)}};function Gm(e,t,n,r,i,a=!1){if(t.inlineContent)return Ht.create(e,n);for(let s=r-(i>0?0:1);i>0?s<t.childCount:s>=0;s+=i){let o=t.child(s);if(o.isAtom){if(!a&&It.isSelectable(o))return It.create(e,n-(i<0?o.nodeSize:0))}else{let l=Gm(e,o,n+i,i<0?o.childCount:0,i,a);if(l)return l}n+=o.nodeSize*i}return null}function GH(e,t,n){let r=e.steps.length-1;if(r<t)return;let i=e.steps[r];if(!(i instanceof Ci||i instanceof Oi))return;let a=e.mapping.maps[r],s;a.forEach((o,l,u,c)=>{s==null&&(s=c)}),e.setSelection(en.near(e.doc.resolve(s),n))}const qH=1,I_=2,KH=4;class f0t extends d0t{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|qH)&~I_,this.storedMarks=null,this}get selectionSet(){return(this.updated&qH)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=I_,this}ensureMarks(t){return Sn.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&I_)>0}addStep(t,n){super.addStep(t,n),this.updated=this.updated&~I_,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,n=!0){let r=this.selection;return n&&(t=t.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Sn.none))),r.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,n,r){let i=this.doc.type.schema;if(n==null)return t?this.replaceSelectionWith(i.text(t),!0):this.deleteSelection();{if(r==null&&(r=n),r=r==null?n:r,!t)return this.deleteRange(n,r);let a=this.storedMarks;if(!a){let s=this.doc.resolve(n);a=r==n?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(t,a)),this.selection.empty||this.setSelection(en.near(this.selection.$to)),this}}setMeta(t,n){return this.meta[typeof t=="string"?t:t.key]=n,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=KH,this}get scrolledIntoView(){return(this.updated&KH)>0}}function ZH(e,t){return!t||!e?e:e.bind(t)}class ub{constructor(t,n,r){this.name=t,this.init=ZH(n.init,r),this.apply=ZH(n.apply,r)}}const m0t=[new ub("doc",{init(e){return e.doc||e.schema.topNodeType.createAndFill()},apply(e){return e.doc}}),new ub("selection",{init(e,t){return e.selection||en.atStart(t.doc)},apply(e){return e.selection}}),new ub("storedMarks",{init(e){return e.storedMarks||null},apply(e,t,n,r){return r.selection.$cursor?e.storedMarks:null}}),new ub("scrollToSelection",{init(){return 0},apply(e,t){return e.scrolledIntoView?t+1:t}})];class SE{constructor(t,n){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=m0t.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new ub(r.key,r.spec.state,r))})}}class lg{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let n=[t],r=this.applyInner(t),i=null;for(;;){let a=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let l=i?i[s].n:0,u=i?i[s].state:this,c=l<n.length&&o.spec.appendTransaction.call(o,l?n.slice(l):n,u,r);if(c&&r.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",t),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<s?{state:r,n:n.length}:{state:this,n:0})}n.push(c),r=r.applyInner(c),a=!0}i&&(i[s]={state:r,n:n.length})}}if(!a)return{state:r,transactions:n}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new lg(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let a=r[i];n[a.name]=a.apply(t,this[a.name],this,n)}return n}get tr(){return new f0t(this)}static create(t){let n=new SE(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new lg(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(t,r);return r}reconfigure(t){let n=new SE(this.schema,t.plugins),r=n.fields,i=new lg(n);for(let a=0;a<r.length;a++){let s=r[a].name;i[s]=this.hasOwnProperty(s)?this[s]:r[a].init(t,i)}return i}toJSON(t){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),t&&typeof t=="object")for(let r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=t[r],a=i.spec.state;a&&a.toJSON&&(n[r]=a.toJSON.call(i,this[i.key]))}return n}static fromJSON(t,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let i=new SE(t.schema,t.plugins),a=new lg(i);return i.fields.forEach(s=>{if(s.name=="doc")a.doc=Wl.fromJSON(t.schema,n.doc);else if(s.name=="selection")a.selection=en.fromJSON(a.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(a.storedMarks=n.storedMarks.map(t.schema.markFromJSON));else{if(r)for(let o in r){let l=r[o],u=l.spec.state;if(l.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(n,o)){a[s.name]=u.fromJSON.call(l,t,n[o],a);return}}a[s.name]=s.init(t,a)}}),a}}function tce(e,t,n){for(let r in e){let i=e[r];i instanceof Function?i=i.bind(t):r=="handleDOMEvents"&&(i=tce(i,t,{})),n[r]=i}return n}class Gs{constructor(t){this.spec=t,this.props={},t.props&&tce(t.props,this,this.props),this.key=t.key?t.key.key:nce("plugin")}getState(t){return t[this.key]}}const CE=Object.create(null);function nce(e){return e in CE?e+"$"+ ++CE[e]:(CE[e]=0,e+"$")}class Yu{constructor(t="key"){this.key=nce(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const Gi=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},w1=function(e){let t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t};let bA=null;const du=function(e,t,n){let r=bA||(bA=document.createRange());return r.setEnd(e,n==null?e.nodeValue.length:n),r.setStart(e,t||0),r},g0t=function(){bA=null},wh=function(e,t,n,r){return n&&(XH(e,t,n,r,-1)||XH(e,t,n,r,1))},y0t=/^(img|br|input|textarea|hr)$/i;function XH(e,t,n,r,i){for(;;){if(e==n&&t==r)return!0;if(t==(i<0?0:Tl(e))){let a=e.parentNode;if(!a||a.nodeType!=1||Xw(e)||y0t.test(e.nodeName)||e.contentEditable=="false")return!1;t=Gi(e)+(i<0?0:1),e=a}else if(e.nodeType==1){if(e=e.childNodes[t+(i<0?-1:0)],e.contentEditable=="false")return!1;t=i<0?Tl(e):0}else return!1}}function Tl(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function v0t(e,t){for(;;){if(e.nodeType==3&&t)return e;if(e.nodeType==1&&t>0){if(e.contentEditable=="false")return null;e=e.childNodes[t-1],t=Tl(e)}else if(e.parentNode&&!Xw(e))t=Gi(e),e=e.parentNode;else return null}}function b0t(e,t){for(;;){if(e.nodeType==3&&t<e.nodeValue.length)return e;if(e.nodeType==1&&t<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[t],t=0}else if(e.parentNode&&!Xw(e))t=Gi(e)+1,e=e.parentNode;else return null}}function w0t(e,t,n){for(let r=t==0,i=t==Tl(e);r||i;){if(e==n)return!0;let a=Gi(e);if(e=e.parentNode,!e)return!1;r=r&&a==0,i=i&&a==Tl(e)}}function Xw(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const xT=function(e){return e.focusNode&&wh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function yp(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}function x0t(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function _0t(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:r.offset}}catch{}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:r.startOffset}}}const Hl=typeof navigator<"u"?navigator:null,JH=typeof document<"u"?document:null,Gd=Hl&&Hl.userAgent||"",wA=/Edge\/(\d+)/.exec(Gd),rce=/MSIE \d/.exec(Gd),xA=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Gd),hs=!!(rce||xA||wA),Yc=rce?document.documentMode:xA?+xA[1]:wA?+wA[1]:0,rl=!hs&&/gecko\/(\d+)/i.test(Gd);rl&&+(/Firefox\/(\d+)/.exec(Gd)||[0,0])[1];const _A=!hs&&/Chrome\/(\d+)/.exec(Gd),Ma=!!_A,k0t=_A?+_A[1]:0,Va=!hs&&!!Hl&&/Apple Computer/.test(Hl.vendor),gy=Va&&(/Mobile\/\w+/.test(Gd)||!!Hl&&Hl.maxTouchPoints>2),eo=gy||(Hl?/Mac/.test(Hl.platform):!1),S0t=Hl?/Win/.test(Hl.platform):!1,Ro=/Android \d/.test(Gd),Jw=!!JH&&"webkitFontSmoothing"in JH.documentElement.style,C0t=Jw?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function I0t(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function lu(e,t){return typeof e=="number"?e:e[t]}function $0t(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function YH(e,t,n){let r=e.someProp("scrollThreshold")||0,i=e.someProp("scrollMargin")||5,a=e.dom.ownerDocument;for(let s=n||e.dom;s;s=w1(s)){if(s.nodeType!=1)continue;let o=s,l=o==a.body,u=l?I0t(a):$0t(o),c=0,d=0;if(t.top<u.top+lu(r,"top")?d=-(u.top-t.top+lu(i,"top")):t.bottom>u.bottom-lu(r,"bottom")&&(d=t.bottom-t.top>u.bottom-u.top?t.top+lu(i,"top")-u.top:t.bottom-u.bottom+lu(i,"bottom")),t.left<u.left+lu(r,"left")?c=-(u.left-t.left+lu(i,"left")):t.right>u.right-lu(r,"right")&&(c=t.right-u.right+lu(i,"right")),c||d)if(l)a.defaultView.scrollBy(c,d);else{let p=o.scrollLeft,h=o.scrollTop;d&&(o.scrollTop+=d),c&&(o.scrollLeft+=c);let m=o.scrollLeft-p,g=o.scrollTop-h;t={left:t.left-m,top:t.top-g,right:t.right-m,bottom:t.bottom-g}}if(l||/^(fixed|sticky)$/.test(getComputedStyle(s).position))break}}function T0t(e){let t=e.dom.getBoundingClientRect(),n=Math.max(0,t.top),r,i;for(let a=(t.left+t.right)/2,s=n+1;s<Math.min(innerHeight,t.bottom);s+=5){let o=e.root.elementFromPoint(a,s);if(!o||o==e.dom||!e.dom.contains(o))continue;let l=o.getBoundingClientRect();if(l.top>=n-20){r=o,i=l.top;break}}return{refDOM:r,refTop:i,stack:ice(e.dom)}}function ice(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=w1(r));return t}function N0t({refDOM:e,refTop:t,stack:n}){let r=e?e.getBoundingClientRect().top:0;ace(n,r==0?0:r-t)}function ace(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:i,left:a}=e[n];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=a&&(r.scrollLeft=a)}}let zm=null;function E0t(e){if(e.setActive)return e.setActive();if(zm)return e.focus(zm);let t=ice(e);e.focus(zm==null?{get preventScroll(){return zm={preventScroll:!0},!0}}:void 0),zm||(zm=!1,ace(t,0))}function sce(e,t){let n,r=2e8,i,a=0,s=t.top,o=t.top,l,u;for(let c=e.firstChild,d=0;c;c=c.nextSibling,d++){let p;if(c.nodeType==1)p=c.getClientRects();else if(c.nodeType==3)p=du(c).getClientRects();else continue;for(let h=0;h<p.length;h++){let m=p[h];if(m.top<=s&&m.bottom>=o){s=Math.max(m.bottom,s),o=Math.min(m.top,o);let g=m.left>t.left?m.left-t.left:m.right<t.left?t.left-m.right:0;if(g<r){n=c,r=g,i=g&&n.nodeType==3?{left:m.right<t.left?m.right:m.left,top:t.top}:t,c.nodeType==1&&g&&(a=d+(t.left>=(m.left+m.right)/2?1:0));continue}}else m.top>t.top&&!l&&m.left<=t.left&&m.right>=t.left&&(l=c,u={left:Math.max(m.left,Math.min(m.right,t.left)),top:m.top});!n&&(t.left>=m.right&&t.top>=m.top||t.left>=m.left&&t.top>=m.bottom)&&(a=d+1)}}return!n&&l&&(n=l,i=u,r=0),n&&n.nodeType==3?O0t(n,i):!n||r&&n.nodeType==1?{node:e,offset:a}:sce(n,i)}function O0t(e,t){let n=e.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(e,i+1),r.setStart(e,i);let a=gc(r,1);if(a.top!=a.bottom&&f3(t,a))return{node:e,offset:i+(t.left>=(a.left+a.right)/2?1:0)}}return{node:e,offset:0}}function f3(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function P0t(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}function A0t(e,t,n){let{node:r,offset:i}=sce(t,n),a=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();a=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return e.docView.posFromDOM(r,i,a)}function M0t(e,t,n,r){let i=-1;for(let a=t,s=!1;a!=e.dom;){let o=e.docView.nearestDesc(a,!0);if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)){let l=o.dom.getBoundingClientRect();if(o.node.isBlock&&o.parent&&(!s&&l.left>r.left||l.top>r.top?i=o.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(i=o.posAfter),s=!0),!o.contentDOM&&i<0&&!o.node.isText)return(o.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?o.posBefore:o.posAfter}a=o.dom.parentNode}return i>-1?i:e.docView.posFromDOM(t,n,-1)}function oce(e,t,n){let r=e.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),a=i;;){let s=e.childNodes[a];if(s.nodeType==1){let o=s.getClientRects();for(let l=0;l<o.length;l++){let u=o[l];if(f3(t,u))return oce(s,t,u)}}if((a=(a+1)%r)==i)break}return e}function R0t(e,t){let n=e.dom.ownerDocument,r,i=0,a=_0t(n,t.left,t.top);a&&({node:r,offset:i}=a);let s=(e.root.elementFromPoint?e.root:n).elementFromPoint(t.left,t.top),o;if(!s||!e.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=e.dom.getBoundingClientRect();if(!f3(t,u)||(s=oce(e.dom,t,u),!s))return null}if(Va)for(let u=s;r&&u;u=w1(u))u.draggable&&(r=void 0);if(s=P0t(s,t),r){if(rl&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],d;c.nodeName=="IMG"&&(d=c.getBoundingClientRect()).right<=t.left&&d.bottom>t.top&&i++}let u;Jw&&i&&r.nodeType==1&&(u=r.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=t.top&&i--,r==e.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&t.top>r.lastChild.getBoundingClientRect().bottom?o=e.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(o=M0t(e,r,i,t))}o==null&&(o=A0t(e,s,t));let l=e.docView.nearestDesc(s,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function QH(e){return e.top<e.bottom||e.left<e.right}function gc(e,t){let n=e.getClientRects();if(n.length){let r=n[t<0?0:n.length-1];if(QH(r))return r}return Array.prototype.find.call(n,QH)||e.getBoundingClientRect()}const D0t=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function lce(e,t,n){let{node:r,offset:i,atom:a}=e.docView.domFromPos(t,n<0?-1:1),s=Jw||rl;if(r.nodeType==3)if(s&&(D0t.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let l=gc(du(r,i,i),n);if(rl&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let u=gc(du(r,i-1,i-1),-1);if(u.top==l.top){let c=gc(du(r,i,i+1),-1);if(c.top!=l.top)return U0(c,c.left<u.left)}}return l}else{let l=i,u=i,c=n<0?1:-1;return n<0&&!i?(u++,c=-1):n>=0&&i==r.nodeValue.length?(l--,c=1):n<0?l--:u++,U0(gc(du(r,l,u),c),c<0)}if(!e.state.doc.resolve(t-(a||0)).parent.inlineContent){if(a==null&&i&&(n<0||i==Tl(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return IE(l.getBoundingClientRect(),!1)}if(a==null&&i<Tl(r)){let l=r.childNodes[i];if(l.nodeType==1)return IE(l.getBoundingClientRect(),!0)}return IE(r.getBoundingClientRect(),n>=0)}if(a==null&&i&&(n<0||i==Tl(r))){let l=r.childNodes[i-1],u=l.nodeType==3?du(l,Tl(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(u)return U0(gc(u,1),!1)}if(a==null&&i<Tl(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let u=l?l.nodeType==3?du(l,0,s?0:1):l.nodeType==1?l:null:null;if(u)return U0(gc(u,-1),!0)}return U0(gc(r.nodeType==3?du(r):r,-n),n>=0)}function U0(e,t){if(e.width==0)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function IE(e,t){if(e.height==0)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function uce(e,t,n){let r=e.state,i=e.root.activeElement;r!=t&&e.updateState(t),i!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),i!=e.dom&&i&&i.focus()}}function L0t(e,t,n){let r=t.selection,i=n=="up"?r.$from:r.$to;return uce(e,t,()=>{let{node:a}=e.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let o=e.docView.nearestDesc(a,!0);if(!o)break;if(o.node.isBlock){a=o.contentDOM||o.dom;break}a=o.dom.parentNode}let s=lce(e,i.pos,1);for(let o=a.firstChild;o;o=o.nextSibling){let l;if(o.nodeType==1)l=o.getClientRects();else if(o.nodeType==3)l=du(o,0,o.nodeValue.length).getClientRects();else continue;for(let u=0;u<l.length;u++){let c=l[u];if(c.bottom>c.top+1&&(n=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const F0t=/[\u0590-\u08ac]/;function z0t(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,a=!i,s=i==r.parent.content.size,o=e.domSelection();return!F0t.test(r.parent.textContent)||!o.modify?n=="left"||n=="backward"?a:s:uce(e,t,()=>{let{focusNode:l,focusOffset:u,anchorNode:c,anchorOffset:d}=e.domSelectionRange(),p=o.caretBidiLevel;o.modify("move",n,"character");let h=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:m,focusOffset:g}=e.domSelectionRange(),v=m&&!h.contains(m.nodeType==1?m:m.parentNode)||l==m&&u==g;try{o.collapse(c,d),l&&(l!=c||u!=d)&&o.extend&&o.extend(l,u)}catch{}return p!=null&&(o.caretBidiLevel=p),v})}let e8=null,t8=null,n8=!1;function B0t(e,t,n){return e8==t&&t8==n?n8:(e8=t,t8=n,n8=n=="up"||n=="down"?L0t(e,t,n):z0t(e,t,n))}const uo=0,r8=1,Sp=2,Gl=3;class Yw{constructor(t,n,r,i){this.parent=t,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=uo,r.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,n,r){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let n=0;n<this.children.length;n++)t+=this.children[n].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==t)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,n,r){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(r<0){let a,s;if(t==this.contentDOM)a=t.childNodes[n-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.previousSibling}for(;a&&!((s=a.pmViewDesc)&&s.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(s)+s.size:this.posAtStart}else{let a,s;if(t==this.contentDOM)a=t.childNodes[n];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.nextSibling}for(;a&&!((s=a.pmViewDesc)&&s.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(s):this.posAtEnd}let i;if(t==this.dom&&this.contentDOM)i=n>Gi(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let a=t;;a=a.parentNode){if(a==this.dom){i=!1;break}if(a.previousSibling)break}if(i==null&&n==t.childNodes.length)for(let a=t;;a=a.parentNode){if(a==this.dom){i=!0;break}if(a.nextSibling)break}}return(i==null?r>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(t,n=!1){for(let r=!0,i=t;i;i=i.parentNode){let a=this.getDesc(i),s;if(a&&(!n||a.node))if(r&&(s=a.nodeDOM)&&!(s.nodeType==1?s.contains(t.nodeType==1?t:t.parentNode):s==t))r=!1;else return a}}getDesc(t){let n=t.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(t,n,r){for(let i=t;i;i=i.parentNode){let a=this.getDesc(i);if(a)return a.localPosFromDOM(t,n,r)}return-1}descAt(t){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],a=r+i.size;if(r==t&&a!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<a)return i.descAt(t-r-i.border);r=a}}domFromPos(t,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r=0,i=0;for(let a=0;r<this.children.length;r++){let s=this.children[r],o=a+s.size;if(o>t||s instanceof dce){i=t-a;break}a=o}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let a;r&&!(a=this.children[r-1]).size&&a instanceof cce&&a.side>=0;r--);if(n<=0){let a,s=!0;for(;a=r?this.children[r-1]:null,!(!a||a.dom.parentNode==this.contentDOM);r--,s=!1);return a&&n&&s&&!a.border&&!a.domAtom?a.domFromPos(a.size,n):{node:this.contentDOM,offset:a?Gi(a.dom)+1:0}}else{let a,s=!0;for(;a=r<this.children.length?this.children[r]:null,!(!a||a.dom.parentNode==this.contentDOM);r++,s=!1);return a&&s&&!a.border&&!a.domAtom?a.domFromPos(0,n):{node:this.contentDOM,offset:a?Gi(a.dom):this.contentDOM.childNodes.length}}}parseRange(t,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,a=-1;for(let s=r,o=0;;o++){let l=this.children[o],u=s+l.size;if(i==-1&&t<=u){let c=s+l.border;if(t>=c&&n<=u-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(t,n,c);t=s;for(let d=o;d>0;d--){let p=this.children[d-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){i=Gi(p.dom)+1;break}t-=p.size}i==-1&&(i=0)}if(i>-1&&(u>n||o==this.children.length-1)){n=u;for(let c=o+1;c<this.children.length;c++){let d=this.children[c];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){a=Gi(d.dom);break}n+=d.size}a==-1&&(a=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:t,to:n,fromOffset:i,toOffset:a}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[t<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(t)}domAfterPos(t){let{node:n,offset:r}=this.domFromPos(t,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]}setSelection(t,n,r,i=!1){let a=Math.min(t,n),s=Math.max(t,n);for(let p=0,h=0;p<this.children.length;p++){let m=this.children[p],g=h+m.size;if(a>h&&s<g)return m.setSelection(t-h-m.border,n-h-m.border,r,i);h=g}let o=this.domFromPos(t,t?-1:1),l=n==t?o:this.domFromPos(n,n?-1:1),u=r.getSelection(),c=!1;if((rl||Va)&&t==n){let{node:p,offset:h}=o;if(p.nodeType==3){if(c=!!(h&&p.nodeValue[h-1]==`
`),c&&h==p.nodeValue.length)for(let m=p,g;m;m=m.parentNode){if(g=m.nextSibling){g.nodeName=="BR"&&(o=l={node:g.parentNode,offset:Gi(g)+1});break}let v=m.pmViewDesc;if(v&&v.node&&v.node.isBlock)break}}else{let m=p.childNodes[h-1];c=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(rl&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let p=u.focusNode.childNodes[u.focusOffset];p&&p.contentEditable=="false"&&(i=!0)}if(!(i||c&&Va)&&wh(o.node,o.offset,u.anchorNode,u.anchorOffset)&&wh(l.node,l.offset,u.focusNode,u.focusOffset))return;let d=!1;if((u.extend||t==n)&&!c){u.collapse(o.node,o.offset);try{t!=n&&u.extend(l.node,l.offset),d=!0}catch{}}if(!d){if(t>n){let h=o;o=l,l=h}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(o.node,o.offset),u.removeAllRanges(),u.addRange(p)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,n){for(let r=0,i=0;i<this.children.length;i++){let a=this.children[i],s=r+a.size;if(r==s?t<=s&&n>=r:t<s&&n>r){let o=r+a.border,l=s-a.border;if(t>=o&&n<=l){this.dirty=t==r||n==s?Sp:r8,t==o&&n==l&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=Gl:a.markDirty(t-o,n-o);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?Sp:Gl}r=s}this.dirty=Sp}markParentsDirty(){let t=1;for(let n=this.parent;n;n=n.parent,t++){let r=t==1?Sp:r8;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(t){return!1}}class cce extends Yw{constructor(t,n,r,i){let a,s=n.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!a)return i;if(a.parent)return a.parent.posBeforeChild(a)})),!n.type.spec.raw){if(s.nodeType!=1){let o=document.createElement("span");o.appendChild(s),s=o}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(t,[],s,null),this.widget=n,this.widget=n,a=this}matchesWidget(t){return this.dirty==uo&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let n=this.widget.spec.stopEvent;return n?n(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class W0t extends Yw{constructor(t,n,r,i){super(t,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(t,n){return t!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class xh extends Yw{constructor(t,n,r,i){super(t,[],r,i),this.mark=n}static create(t,n,r,i){let a=i.nodeViews[n.type.name],s=a&&a(n,i,r);return(!s||!s.dom)&&(s=Pl.renderSpec(document,n.type.spec.toDOM(n,r))),new xh(t,n,s.dom,s.contentDOM||s.dom)}parseRule(){return this.dirty&Gl||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=Gl&&this.mark.eq(t)}markDirty(t,n){if(super.markDirty(t,n),this.dirty!=uo){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=uo}}slice(t,n,r){let i=xh.create(this.parent,this.mark,!0,r),a=this.children,s=this.size;n<s&&(a=CA(a,n,s,r)),t>0&&(a=CA(a,0,t,r));for(let o=0;o<a.length;o++)a[o].parent=i;return i.children=a,i}}class Qc extends Yw{constructor(t,n,r,i,a,s,o,l,u){super(t,[],a,s),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=o}static create(t,n,r,i,a,s){let o=a.nodeViews[n.type.name],l,u=o&&o(n,a,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,i),c=u&&u.dom,d=u&&u.contentDOM;if(n.isText){if(!c)c=document.createTextNode(n.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:d}=Pl.renderSpec(document,n.type.spec.toDOM(n)));!d&&!n.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),n.type.spec.draggable&&(c.draggable=!0));let p=c;return c=fce(c,r,n),u?l=new V0t(t,n,r,i,c,d||null,p,u,a,s+1):n.isText?new _T(t,n,r,i,c,p,a):new Qc(t,n,r,i,c,d||null,p,a,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){t.contentElement=r.dom.parentNode;break}}t.contentElement||(t.getContent=()=>Ae.empty)}return t}matchesNode(t,n,r){return this.dirty==uo&&t.eq(this.node)&&SA(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,n){let r=this.node.inlineContent,i=n,a=t.composing?this.localCompositionInfo(t,n):null,s=a&&a.pos>-1?a:null,o=a&&a.pos<0,l=new U0t(this,s&&s.node,t);q0t(this.node,this.innerDeco,(u,c,d)=>{u.spec.marks?l.syncToMarks(u.spec.marks,r,t):u.type.side>=0&&!d&&l.syncToMarks(c==this.node.childCount?Sn.none:this.node.child(c).marks,r,t),l.placeWidget(u,t,i)},(u,c,d,p)=>{l.syncToMarks(u.marks,r,t);let h;l.findNodeMatch(u,c,d,p)||o&&t.state.selection.from>i&&t.state.selection.to<i+u.nodeSize&&(h=l.findIndexWithChild(a.node))>-1&&l.updateNodeAt(u,c,d,h,t)||l.updateNextNode(u,c,d,t,p,i)||l.addNode(u,c,d,t,i),i+=u.nodeSize}),l.syncToMarks([],r,t),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Sp)&&(s&&this.protectLocalComposition(t,s),pce(this.contentDOM,this.children,t),gy&&K0t(this.dom))}localCompositionInfo(t,n){let{from:r,to:i}=t.state.selection;if(!(t.state.selection instanceof Ht)||r<n||i>n+this.node.content.size)return null;let a=t.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let s=a.nodeValue,o=Z0t(this.node.content,s,r-n,i-n);return o<0?null:{node:a,pos:o,text:s}}else return{node:a,pos:-1,text:""}}protectLocalComposition(t,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let a=n;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let s=new W0t(this,a,n,i);t.input.compositionNodes.push(s),this.children=CA(this.children,r,r+i.length,t,s)}update(t,n,r,i){return this.dirty==Gl||!t.sameMarkup(this.node)?!1:(this.updateInner(t,n,r,i),!0)}updateInner(t,n,r,i){this.updateOuterDeco(n),this.node=t,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=uo}updateOuterDeco(t){if(SA(t,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=hce(this.dom,this.nodeDOM,kA(this.outerDeco,this.node,n),kA(t,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function i8(e,t,n,r,i){fce(r,t,e);let a=new Qc(void 0,e,t,n,r,r,r,i,0);return a.contentDOM&&a.updateChildren(i,0),a}class _T extends Qc{constructor(t,n,r,i,a,s,o){super(t,n,r,i,a,null,s,o,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,n,r,i){return this.dirty==Gl||this.dirty!=uo&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=uo||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=uo,!0)}inParent(){let t=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,n,r){return t==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(t,n,r)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,n,r){let i=this.node.cut(t,n),a=document.createTextNode(i.text);return new _T(this.parent,i,this.outerDeco,this.innerDeco,a,a,r)}markDirty(t,n){super.markDirty(t,n),this.dom!=this.nodeDOM&&(t==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Gl)}get domAtom(){return!1}isText(t){return this.node.text==t}}class dce extends Yw{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==uo&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class V0t extends Qc{constructor(t,n,r,i,a,s,o,l,u,c){super(t,n,r,i,a,s,o,u,c),this.spec=l}update(t,n,r,i){if(this.dirty==Gl)return!1;if(this.spec.update){let a=this.spec.update(t,n,r);return a&&this.updateInner(t,n,r,i),a}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,n,r,i){this.spec.setSelection?this.spec.setSelection(t,n,r):super.setSelection(t,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function pce(e,t,n){let r=e.firstChild,i=!1;for(let a=0;a<t.length;a++){let s=t[a],o=s.dom;if(o.parentNode==e){for(;o!=r;)r=a8(r),i=!0;r=r.nextSibling}else i=!0,e.insertBefore(o,r);if(s instanceof xh){let l=r?r.previousSibling:e.lastChild;pce(s.contentDOM,s.children,n),r=l?l.nextSibling:e.firstChild}}for(;r;)r=a8(r),i=!0;i&&n.trackWrites==e&&(n.trackWrites=null)}const Tb=function(e){e&&(this.nodeName=e)};Tb.prototype=Object.create(null);const Cp=[new Tb];function kA(e,t,n){if(e.length==0)return Cp;let r=n?Cp[0]:new Tb,i=[r];for(let a=0;a<e.length;a++){let s=e[a].type.attrs;if(!!s){s.nodeName&&i.push(r=new Tb(s.nodeName));for(let o in s){let l=s[o];l!=null&&(n&&i.length==1&&i.push(r=new Tb(t.isInline?"span":"div")),o=="class"?r.class=(r.class?r.class+" ":"")+l:o=="style"?r.style=(r.style?r.style+";":"")+l:o!="nodeName"&&(r[o]=l))}}}return i}function hce(e,t,n,r){if(n==Cp&&r==Cp)return t;let i=t;for(let a=0;a<r.length;a++){let s=r[a],o=n[a];if(a){let l;o&&o.nodeName==s.nodeName&&i!=e&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),o=Cp[0]),i=l}j0t(i,o||Cp[0],s)}return i}function j0t(e,t,n){for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&e.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let a=0;a<r.length;a++)i.indexOf(r[a])==-1&&e.classList.remove(r[a]);for(let a=0;a<i.length;a++)r.indexOf(i[a])==-1&&e.classList.add(i[a]);e.classList.length==0&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(t.style);)e.style.removeProperty(i[1])}n.style&&(e.style.cssText+=n.style)}}function fce(e,t,n){return hce(e,e,Cp,kA(t,n,e.nodeType!=1))}function SA(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function a8(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class U0t{constructor(t,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=H0t(t.node.content,t)}destroyBetween(t,n){if(t!=n){for(let r=t;r<n;r++)this.top.children[r].destroy();this.top.children.splice(t,n-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,n,r){let i=0,a=this.stack.length>>1,s=Math.min(a,t.length);for(;i<s&&(i==a-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&t[i].type.spec.spanning!==!1;)i++;for(;i<a;)this.destroyRest(),this.top.dirty=uo,this.index=this.stack.pop(),this.top=this.stack.pop(),a--;for(;a<t.length;){this.stack.push(this.top,this.index+1);let o=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let u=this.top.children[l];if(u.matchesMark(t[a])&&!this.isLocked(u.dom)){o=l;break}}if(o>-1)o>this.index&&(this.changed=!0,this.destroyBetween(this.index,o)),this.top=this.top.children[this.index];else{let l=xh.create(this.top,t[a],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,a++}}findNodeMatch(t,n,r,i){let a=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(t,n,r))a=this.top.children.indexOf(s,this.index);else for(let o=this.index,l=Math.min(this.top.children.length,o+5);o<l;o++){let u=this.top.children[o];if(u.matchesNode(t,n,r)&&!this.preMatch.matched.has(u)){a=o;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(t,n,r,i,a){let s=this.top.children[i];return s.dirty==Gl&&s.dom==s.contentDOM&&(s.dirty=Sp),s.update(t,n,r,a)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(t){for(;;){let n=t.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=t.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}t=n}}updateNextNode(t,n,r,i,a,s){for(let o=this.index;o<this.top.children.length;o++){let l=this.top.children[o];if(l instanceof Qc){let u=this.preMatch.matched.get(l);if(u!=null&&u!=a)return!1;let c=l.dom,d,p=this.isLocked(c)&&!(t.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==t.text&&l.dirty!=Gl&&SA(n,l.outerDeco));if(!p&&l.update(t,n,r,i))return this.destroyBetween(this.index,o),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!p&&(d=this.recreateWrapper(l,t,n,r,i,s)))return this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Sp,d.updateChildren(i,s+1),d.dirty=uo),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,n,r,i,a,s){if(t.dirty||n.isAtom||!t.children.length||!t.node.content.eq(n.content))return null;let o=Qc.create(this.top,n,r,i,a,s);if(o.contentDOM){o.children=t.children,t.children=[];for(let l of o.children)l.parent=o}return t.destroy(),o}addNode(t,n,r,i,a){let s=Qc.create(this.top,t,n,r,i,a);s.contentDOM&&s.updateChildren(i,a+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(t,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(t)&&(t==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let a=new cce(this.top,t,n,r);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],n=this.top;for(;t instanceof xh;)n=t,t=n.children[n.children.length-1];(!t||!(t instanceof _T)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Va||Ma)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(t,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(t))this.index++;else{let r=document.createElement(t);t=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),t=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new dce(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function H0t(e,t){let n=t,r=n.children.length,i=e.childCount,a=new Map,s=[];e:for(;i>0;){let o;for(;;)if(r){let u=n.children[r-1];if(u instanceof xh)n=u,r=u.children.length;else{o=u,r--;break}}else{if(n==t)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=o.node;if(!!l){if(l!=e.child(i-1))break;--i,a.set(o,i),s.push(o)}}return{index:i,matched:a,matches:s.reverse()}}function G0t(e,t){return e.type.side-t.type.side}function q0t(e,t,n,r){let i=t.locals(e),a=0;if(i.length==0){for(let u=0;u<e.childCount;u++){let c=e.child(u);r(c,i,t.forChild(a,c),u),a+=c.nodeSize}return}let s=0,o=[],l=null;for(let u=0;;){let c,d;for(;s<i.length&&i[s].to==a;){let v=i[s++];v.widget&&(c?(d||(d=[c])).push(v):c=v)}if(c)if(d){d.sort(G0t);for(let v=0;v<d.length;v++)n(d[v],u,!!l)}else n(c,u,!!l);let p,h;if(l)h=-1,p=l,l=null;else if(u<e.childCount)h=u,p=e.child(u++);else break;for(let v=0;v<o.length;v++)o[v].to<=a&&o.splice(v--,1);for(;s<i.length&&i[s].from<=a&&i[s].to>a;)o.push(i[s++]);let m=a+p.nodeSize;if(p.isText){let v=m;s<i.length&&i[s].from<v&&(v=i[s].from);for(let y=0;y<o.length;y++)o[y].to<v&&(v=o[y].to);v<m&&(l=p.cut(v-a),p=p.cut(0,v-a),m=v,h=-1)}else for(;s<i.length&&i[s].to<m;)s++;let g=p.isInline&&!p.isLeaf?o.filter(v=>!v.inline):o.slice();r(p,g,t.forChild(a,p),h),a=m}}function K0t(e){if(e.nodeName=="UL"||e.nodeName=="OL"){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function Z0t(e,t,n,r){for(let i=0,a=0;i<e.childCount&&a<=r;){let s=e.child(i++),o=a;if(a+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<e.childCount;){let u=e.child(i++);if(a+=u.nodeSize,!u.isText)break;l+=u.text}if(a>=n){if(a>=r&&l.slice(r-t.length-o,r-o)==t)return r-t.length;let u=o<r?l.lastIndexOf(t,r-o-1):-1;if(u>=0&&u+t.length+o>=n)return o+u;if(n==r&&l.length>=r+t.length-o&&l.slice(r-o,r-o+t.length)==t)return r}}return-1}function CA(e,t,n,r,i){let a=[];for(let s=0,o=0;s<e.length;s++){let l=e[s],u=o,c=o+=l.size;u>=n||c<=t?a.push(l):(u<t&&a.push(l.slice(0,t-u,r)),i&&(a.push(i),i=void 0),c>n&&a.push(l.slice(n-u,l.size,r)))}return a}function m3(e,t=null){let n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;let i=e.docView.nearestDesc(n.focusNode),a=i&&i.size==0,s=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let o=r.resolve(s),l,u;if(xT(n)){for(l=o;i&&!i.node;)i=i.parent;let c=i.node;if(i&&c.isAtom&&It.isSelectable(c)&&i.parent&&!(c.isInline&&w0t(n.focusNode,n.focusOffset,i.dom))){let d=i.posBefore;u=new It(s==d?o:r.resolve(d))}}else{let c=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(c<0)return null;l=r.resolve(c)}if(!u){let c=t=="pointer"||e.state.selection.head<o.pos&&!a?1:-1;u=g3(e,l,o,c)}return u}function mce(e){return e.editable?e.hasFocus():yce(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Iu(e,t=!1){let n=e.state.selection;if(gce(e,n),!!mce(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Ma){let r=e.domSelectionRange(),i=e.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&wh(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)J0t(e);else{let{anchor:r,head:i}=n,a,s;s8&&!(n instanceof Ht)&&(n.$from.parent.inlineContent||(a=o8(e,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(s=o8(e,n.to))),e.docView.setSelection(r,i,e.root,t),s8&&(a&&l8(a),s&&l8(s)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&X0t(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const s8=Va||Ma&&k0t<63;function o8(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),i=r<n.childNodes.length?n.childNodes[r]:null,a=r?n.childNodes[r-1]:null;if(Va&&i&&i.contentEditable=="false")return $E(i);if((!i||i.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(i)return $E(i);if(a)return $E(a)}}function $E(e){return e.contentEditable="true",Va&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function l8(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function X0t(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!mce(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function J0t(e){let t=e.domSelection(),n=document.createRange(),r=e.cursorWrapper.dom,i=r.nodeName=="IMG";i?n.setEnd(r.parentNode,Gi(r)+1):n.setEnd(r,0),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!i&&!e.state.selection.visible&&hs&&Yc<=11&&(r.disabled=!0,r.disabled=!1)}function gce(e,t){if(t instanceof It){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(u8(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else u8(e)}function u8(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function g3(e,t,n,r){return e.someProp("createSelectionBetween",i=>i(e,t,n))||Ht.between(t,n,r)}function c8(e){return e.editable&&!e.hasFocus()?!1:yce(e)}function yce(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function Y0t(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return wh(t.node,t.offset,n.anchorNode,n.anchorOffset)}function IA(e,t){let{$anchor:n,$head:r}=e.selection,i=t>0?n.max(r):n.min(r),a=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return a&&en.findFrom(a,t)}function _c(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function d8(e,t,n){let r=e.state.selection;if(r instanceof Ht)if(n.indexOf("s")>-1){let{$head:i}=r,a=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let s=e.state.doc.resolve(i.pos+a.nodeSize*(t<0?-1:1));return _c(e,new Ht(r.$anchor,s))}else if(r.empty){if(e.endOfTextblock(t>0?"forward":"backward")){let i=IA(e.state,t);return i&&i instanceof It?_c(e,i):!1}else if(!(eo&&n.indexOf("m")>-1)){let i=r.$head,a=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter,s;if(!a||a.isText)return!1;let o=t<0?i.pos-a.nodeSize:i.pos;return a.isAtom||(s=e.docView.descAt(o))&&!s.contentDOM?It.isSelectable(a)?_c(e,new It(t<0?e.state.doc.resolve(i.pos-a.nodeSize):i)):Jw?_c(e,new Ht(e.state.doc.resolve(t<0?o:o+a.nodeSize))):!1:!1}}else return!1;else{if(r instanceof It&&r.node.isInline)return _c(e,new Ht(t>0?r.$to:r.$from));{let i=IA(e.state,t);return i?_c(e,i):!1}}}function TI(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function Nb(e,t){let n=e.pmViewDesc;return n&&n.size==0&&(t<0||e.nextSibling||e.nodeName!="BR")}function Bm(e,t){return t<0?Q0t(e):ebt(e)}function Q0t(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let i,a,s=!1;for(rl&&n.nodeType==1&&r<TI(n)&&Nb(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(n.nodeType!=1)break;{let o=n.childNodes[r-1];if(Nb(o,-1))i=n,a=--r;else if(o.nodeType==3)n=o,r=n.nodeValue.length;else break}}else{if(vce(n))break;{let o=n.previousSibling;for(;o&&Nb(o,-1);)i=n.parentNode,a=Gi(o),o=o.previousSibling;if(o)n=o,r=TI(n);else{if(n=n.parentNode,n==e.dom)break;r=0}}}s?$A(e,n,r):i&&$A(e,i,a)}function ebt(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let i=TI(n),a,s;for(;;)if(r<i){if(n.nodeType!=1)break;let o=n.childNodes[r];if(Nb(o,1))a=n,s=++r;else break}else{if(vce(n))break;{let o=n.nextSibling;for(;o&&Nb(o,1);)a=o.parentNode,s=Gi(o)+1,o=o.nextSibling;if(o)n=o,r=0,i=TI(n);else{if(n=n.parentNode,n==e.dom)break;r=i=0}}}a&&$A(e,a,s)}function vce(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function tbt(e,t){for(;e&&t==e.childNodes.length&&!Xw(e);)t=Gi(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;e=n,t=0}}function nbt(e,t){for(;e&&!t&&!Xw(e);)t=Gi(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;e=n,t=e.childNodes.length}}function $A(e,t,n){if(t.nodeType!=3){let a,s;(s=tbt(t,n))?(t=s,n=0):(a=nbt(t,n))&&(t=a,n=a.nodeValue.length)}let r=e.domSelection();if(xT(r)){let a=document.createRange();a.setEnd(t,n),a.setStart(t,n),r.removeAllRanges(),r.addRange(a)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:i}=e;setTimeout(()=>{e.state==i&&Iu(e)},50)}function p8(e,t){let n=e.state.doc.resolve(t);if(!(Ma||S0t)&&n.parent.inlineContent){let i=e.coordsAtPos(t);if(t>n.start()){let a=e.coordsAtPos(t-1),s=(a.top+a.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(a.left-i.left)>1)return a.left<i.left?"ltr":"rtl"}if(t<n.end()){let a=e.coordsAtPos(t+1),s=(a.top+a.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(a.left-i.left)>1)return a.left>i.left?"ltr":"rtl"}}return getComputedStyle(e.dom).direction=="rtl"?"rtl":"ltr"}function h8(e,t,n){let r=e.state.selection;if(r instanceof Ht&&!r.empty||n.indexOf("s")>-1||eo&&n.indexOf("m")>-1)return!1;let{$from:i,$to:a}=r;if(!i.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let s=IA(e.state,t);if(s&&s instanceof It)return _c(e,s)}if(!i.parent.inlineContent){let s=t<0?i:a,o=r instanceof jo?en.near(s,t):en.findFrom(s,t);return o?_c(e,o):!1}return!1}function f8(e,t){if(!(e.state.selection instanceof Ht))return!0;let{$head:n,$anchor:r,empty:i}=e.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let a=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(a&&!a.isText){let s=e.state.tr;return t<0?s.delete(n.pos-a.nodeSize,n.pos):s.delete(n.pos,n.pos+a.nodeSize),e.dispatch(s),!0}return!1}function m8(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function rbt(e){if(!Va||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&t.nodeType==1&&n==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let r=t.firstChild;m8(e,r,"true"),setTimeout(()=>m8(e,r,"false"),20)}return!1}function ibt(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function abt(e,t){let n=t.keyCode,r=ibt(t);if(n==8||eo&&n==72&&r=="c")return f8(e,-1)||Bm(e,-1);if(n==46&&!t.shiftKey||eo&&n==68&&r=="c")return f8(e,1)||Bm(e,1);if(n==13||n==27)return!0;if(n==37||eo&&n==66&&r=="c"){let i=n==37?p8(e,e.state.selection.from)=="ltr"?-1:1:-1;return d8(e,i,r)||Bm(e,i)}else if(n==39||eo&&n==70&&r=="c"){let i=n==39?p8(e,e.state.selection.from)=="ltr"?1:-1:1;return d8(e,i,r)||Bm(e,i)}else{if(n==38||eo&&n==80&&r=="c")return h8(e,-1,r)||Bm(e,-1);if(n==40||eo&&n==78&&r=="c")return rbt(e)||h8(e,1,r)||Bm(e,1);if(r==(eo?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function bce(e,t){e.someProp("transformCopied",h=>{t=h(t,e)});let n=[],{content:r,openStart:i,openEnd:a}=t;for(;i>1&&a>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,a--;let h=r.firstChild;n.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let s=e.someProp("clipboardSerializer")||Pl.fromSchema(e.state.schema),o=Cce(),l=o.createElement("div");l.appendChild(s.serializeFragment(r,{document:o}));let u=l.firstChild,c,d=0;for(;u&&u.nodeType==1&&(c=Sce[u.nodeName.toLowerCase()]);){for(let h=c.length-1;h>=0;h--){let m=o.createElement(c[h]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),d++}u=l.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${a}${d?` -${d}`:""} ${JSON.stringify(n)}`);let p=e.someProp("clipboardTextSerializer",h=>h(t,e))||t.content.textBetween(0,t.content.size,`

`);return{dom:l,text:p,slice:t}}function wce(e,t,n,r,i){let a=i.parent.type.spec.code,s,o;if(!n&&!t)return null;let l=t&&(r||a||!n);if(l){if(e.someProp("transformPastedText",p=>{t=p(t,a||r,e)}),a)return t?new Qe(Ae.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0):Qe.empty;let d=e.someProp("clipboardTextParser",p=>p(t,i,r,e));if(d)o=d;else{let p=i.marks(),{schema:h}=e.state,m=Pl.fromSchema(h);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(g=>{let v=s.appendChild(document.createElement("p"));g&&v.appendChild(m.serializeNode(h.text(g,p)))})}}else e.someProp("transformPastedHTML",d=>{n=d(n,e)}),s=lbt(n),Jw&&ubt(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let d=+c[3];d>0;d--){let p=s.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;s=p}if(o||(o=(e.someProp("clipboardParser")||e.someProp("domParser")||hy.fromSchema(e.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||c),context:i,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!sbt.test(p.parentNode.nodeName)?{ignore:!0}:null}})),c)o=cbt(g8(o,+c[1],+c[2]),c[4]);else if(o=Qe.maxOpen(obt(o.content,i),!0),o.openStart||o.openEnd){let d=0,p=0;for(let h=o.content.firstChild;d<o.openStart&&!h.type.spec.isolating;d++,h=h.firstChild);for(let h=o.content.lastChild;p<o.openEnd&&!h.type.spec.isolating;p++,h=h.lastChild);o=g8(o,d,p)}return e.someProp("transformPasted",d=>{o=d(o,e)}),o}const sbt=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function obt(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let i=t.node(n).contentMatchAt(t.index(n)),a,s=[];if(e.forEach(o=>{if(!s)return;let l=i.findWrapping(o.type),u;if(!l)return s=null;if(u=s.length&&a.length&&_ce(l,a,o,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=kce(s[s.length-1],a.length));let c=xce(o,l);s.push(c),i=i.matchType(c.type),a=l}}),s)return Ae.from(s)}return e}function xce(e,t,n=0){for(let r=t.length-1;r>=n;r--)e=t[r].create(null,Ae.from(e));return e}function _ce(e,t,n,r,i){if(i<e.length&&i<t.length&&e[i]==t[i]){let a=_ce(e,t,n,r.lastChild,i+1);if(a)return r.copy(r.content.replaceChild(r.childCount-1,a));if(r.contentMatchAt(r.childCount).matchType(i==e.length-1?n.type:e[i+1]))return r.copy(r.content.append(Ae.from(xce(n,e,i+1))))}}function kce(e,t){if(t==0)return e;let n=e.content.replaceChild(e.childCount-1,kce(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(Ae.empty,!0);return e.copy(n.append(r))}function TA(e,t,n,r,i,a){let s=t<0?e.firstChild:e.lastChild,o=s.content;return e.childCount>1&&(a=0),i<r-1&&(o=TA(o,t,n,r,i+1,a)),i>=n&&(o=t<0?s.contentMatchAt(0).fillBefore(o,a<=i).append(o):o.append(s.contentMatchAt(s.childCount).fillBefore(Ae.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(o))}function g8(e,t,n){return t<e.openStart&&(e=new Qe(TA(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new Qe(TA(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const Sce={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let y8=null;function Cce(){return y8||(y8=document.implementation.createHTMLDocument("title"))}function lbt(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n=Cce().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(e),i;if((i=r&&Sce[r[1].toLowerCase()])&&(e=i.map(a=>"<"+a+">").join("")+e+i.map(a=>"</"+a+">").reverse().join("")),n.innerHTML=e,i)for(let a=0;a<i.length;a++)n=n.querySelector(i[a])||n;return n}function ubt(e){let t=e.querySelectorAll(Ma?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];r.childNodes.length==1&&r.textContent=="\xA0"&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}function cbt(e,t){if(!e.size)return e;let n=e.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch{return e}let{content:i,openStart:a,openEnd:s}=e;for(let o=r.length-2;o>=0;o-=2){let l=n.nodes[r[o]];if(!l||l.hasRequiredAttrs())break;i=Ae.from(l.create(r[o+1],i)),a++,s++}return new Qe(i,a,s)}const ja={},Ua={},dbt={touchstart:!0,touchmove:!0};class pbt{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function hbt(e){for(let t in ja){let n=ja[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=r=>{mbt(e,r)&&!y3(e,r)&&(e.editable||!(r.type in Ua))&&n(e,r)},dbt[t]?{passive:!0}:void 0)}Va&&e.dom.addEventListener("input",()=>null),NA(e)}function Lc(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function fbt(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}function NA(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=r=>y3(e,r))})}function y3(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return r?r(e,t)||t.defaultPrevented:!1})}function mbt(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function gbt(e,t){!y3(e,t)&&ja[t.type]&&(e.editable||!(t.type in Ua))&&ja[t.type](e,t)}Ua.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=n.keyCode==16||n.shiftKey,!$ce(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!(Ro&&Ma&&n.keyCode==13)))if(n.keyCode!=229&&e.domObserver.forceFlush(),gy&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();e.input.lastIOSEnter=r,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==r&&(e.someProp("handleKeyDown",i=>i(e,yp(13,"Enter"))),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",r=>r(e,n))||abt(e,n)?n.preventDefault():Lc(e,"key")};Ua.keyup=(e,t)=>{t.keyCode==16&&(e.input.shiftKey=!1)};Ua.keypress=(e,t)=>{let n=t;if($ce(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||eo&&n.metaKey)return;if(e.someProp("handleKeyPress",i=>i(e,n))){n.preventDefault();return}let r=e.state.selection;if(!(r instanceof Ht)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode);!/[\r\n]/.test(i)&&!e.someProp("handleTextInput",a=>a(e,r.$from.pos,r.$to.pos,i))&&e.dispatch(e.state.tr.insertText(i).scrollIntoView()),n.preventDefault()}};function kT(e){return{left:e.clientX,top:e.clientY}}function ybt(e,t){let n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}function v3(e,t,n,r,i){if(r==-1)return!1;let a=e.state.doc.resolve(r);for(let s=a.depth+1;s>0;s--)if(e.someProp(t,o=>s>a.depth?o(e,n,a.nodeAfter,a.before(s),i,!0):o(e,n,a.node(s),a.before(s),i,!1)))return!0;return!1}function Pg(e,t,n){e.focused||e.focus();let r=e.state.tr.setSelection(t);n=="pointer"&&r.setMeta("pointer",!0),e.dispatch(r)}function vbt(e,t){if(t==-1)return!1;let n=e.state.doc.resolve(t),r=n.nodeAfter;return r&&r.isAtom&&It.isSelectable(r)?(Pg(e,new It(n),"pointer"),!0):!1}function bbt(e,t){if(t==-1)return!1;let n=e.state.selection,r,i;n instanceof It&&(r=n.node);let a=e.state.doc.resolve(t);for(let s=a.depth+1;s>0;s--){let o=s>a.depth?a.nodeAfter:a.node(s);if(It.isSelectable(o)){r&&n.$from.depth>0&&s>=n.$from.depth&&a.before(n.$from.depth+1)==n.$from.pos?i=a.before(n.$from.depth):i=a.before(s);break}}return i!=null?(Pg(e,It.create(e.state.doc,i),"pointer"),!0):!1}function wbt(e,t,n,r,i){return v3(e,"handleClickOn",t,n,r)||e.someProp("handleClick",a=>a(e,t,r))||(i?bbt(e,n):vbt(e,n))}function xbt(e,t,n,r){return v3(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",i=>i(e,t,r))}function _bt(e,t,n,r){return v3(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",i=>i(e,t,r))||kbt(e,n,r)}function kbt(e,t,n){if(n.button!=0)return!1;let r=e.state.doc;if(t==-1)return r.inlineContent?(Pg(e,Ht.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(t);for(let a=i.depth+1;a>0;a--){let s=a>i.depth?i.nodeAfter:i.node(a),o=i.before(a);if(s.inlineContent)Pg(e,Ht.create(r,o+1,o+1+s.content.size),"pointer");else if(It.isSelectable(s))Pg(e,It.create(r,o),"pointer");else continue;return!0}}function b3(e){return NI(e)}const Ice=eo?"metaKey":"ctrlKey";ja.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let r=b3(e),i=Date.now(),a="singleClick";i-e.input.lastClick.time<500&&ybt(n,e.input.lastClick)&&!n[Ice]&&(e.input.lastClick.type=="singleClick"?a="doubleClick":e.input.lastClick.type=="doubleClick"&&(a="tripleClick")),e.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:a};let s=e.posAtCoords(kT(n));!s||(a=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new Sbt(e,s,n,!!r)):(a=="doubleClick"?xbt:_bt)(e,s.pos,s.inside,n)?n.preventDefault():Lc(e,"pointer"))};class Sbt{constructor(t,n,r,i){this.view=t,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!r[Ice],this.allowDefault=r.shiftKey;let a,s;if(n.inside>-1)a=t.state.doc.nodeAt(n.inside),s=n.inside;else{let c=t.state.doc.resolve(n.pos);a=c.parent,s=c.depth?c.before():0}const o=i?null:r.target,l=o?t.docView.nearestDesc(o,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:u}=t.state;(r.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||u instanceof It&&u.from<=s&&u.to>s)&&(this.mightDrag={node:a,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&rl&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Lc(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Iu(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(kT(t))),this.updateAllowDefault(t),this.allowDefault||!n?Lc(this.view,"pointer"):wbt(this.view,n.pos,n.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||Va&&this.mightDrag&&!this.mightDrag.node.isAtom||Ma&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Pg(this.view,en.near(this.view.state.doc.resolve(n.pos)),"pointer"),t.preventDefault()):Lc(this.view,"pointer")}move(t){this.updateAllowDefault(t),Lc(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}ja.touchstart=e=>{e.input.lastTouch=Date.now(),b3(e),Lc(e,"pointer")};ja.touchmove=e=>{e.input.lastTouch=Date.now(),Lc(e,"pointer")};ja.contextmenu=e=>b3(e);function $ce(e,t){return e.composing?!0:Va&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}const Cbt=Ro?5e3:-1;Ua.compositionstart=Ua.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))e.markCursor=e.state.storedMarks||n.marks(),NI(e,!0),e.markCursor=null;else if(NI(e),rl&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=e.domSelectionRange();for(let i=r.focusNode,a=r.focusOffset;i&&i.nodeType==1&&a!=0;){let s=a<0?i.lastChild:i.childNodes[a-1];if(!s)break;if(s.nodeType==3){e.domSelection().collapse(s,s.nodeValue.length);break}else i=s,a=-1}}e.input.composing=!0}Tce(e,Cbt)};Ua.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,Tce(e,20))};function Tce(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>NI(e),t))}function Nce(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=$bt());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function Ibt(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=v0t(t.focusNode,t.focusOffset),r=b0t(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,a=e.domObserver.lastChangedTextNode;if(n==a||r==a)return a;if(!i||!i.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let s=n.pmViewDesc;if(!(!s||!s.isText(n.nodeValue)))return r}}return n||r}function $bt(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function NI(e,t=!1){if(!(Ro&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),Nce(e),t||e.docView&&e.docView.dirty){let n=m3(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):e.updateState(e.state),!0}return!1}}function Tbt(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}const x1=hs&&Yc<15||gy&&C0t<604;ja.copy=Ua.cut=(e,t)=>{let n=t,r=e.state.selection,i=n.type=="cut";if(r.empty)return;let a=x1?null:n.clipboardData,s=r.content(),{dom:o,text:l}=bce(e,s);a?(n.preventDefault(),a.clearData(),a.setData("text/html",o.innerHTML),a.setData("text/plain",l)):Tbt(e,o),i&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Nbt(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function Ebt(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?_1(e,r.value,null,i,t):_1(e,r.textContent,r.innerHTML,i,t)},50)}function _1(e,t,n,r,i){let a=wce(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",l=>l(e,i,a||Qe.empty)))return!0;if(!a)return!1;let s=Nbt(a),o=s?e.state.tr.replaceSelectionWith(s,r):e.state.tr.replaceSelection(a);return e.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Ece(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Ua.paste=(e,t)=>{let n=t;if(e.composing&&!Ro)return;let r=x1?null:n.clipboardData,i=e.input.shiftKey&&e.input.lastKeyCode!=45;r&&_1(e,Ece(r),r.getData("text/html"),i,n)?n.preventDefault():Ebt(e,n)};class Oce{constructor(t,n,r){this.slice=t,this.move=n,this.node=r}}const Pce=eo?"altKey":"ctrlKey";ja.dragstart=(e,t)=>{let n=t,r=e.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=e.state.selection,a=i.empty?null:e.posAtCoords(kT(n)),s;if(!(a&&a.pos>=i.from&&a.pos<=(i instanceof It?i.to-1:i.to))){if(r&&r.mightDrag)s=It.create(e.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let d=e.docView.nearestDesc(n.target,!0);d&&d.node.type.spec.draggable&&d!=e.docView&&(s=It.create(e.state.doc,d.posBefore))}}let o=(s||e.state.selection).content(),{dom:l,text:u,slice:c}=bce(e,o);n.dataTransfer.clearData(),n.dataTransfer.setData(x1?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",x1||n.dataTransfer.setData("text/plain",u),e.dragging=new Oce(c,!n[Pce],s)};ja.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)};Ua.dragover=Ua.dragenter=(e,t)=>t.preventDefault();Ua.drop=(e,t)=>{let n=t,r=e.dragging;if(e.dragging=null,!n.dataTransfer)return;let i=e.posAtCoords(kT(n));if(!i)return;let a=e.state.doc.resolve(i.pos),s=r&&r.slice;s?e.someProp("transformPasted",m=>{s=m(s,e)}):s=wce(e,Ece(n.dataTransfer),x1?null:n.dataTransfer.getData("text/html"),!1,a);let o=!!(r&&!n[Pce]);if(e.someProp("handleDrop",m=>m(e,n,s||Qe.empty,o))){n.preventDefault();return}if(!s)return;n.preventDefault();let l=s?Xue(e.state.doc,a.pos,s):a.pos;l==null&&(l=a.pos);let u=e.state.tr;if(o){let{node:m}=r;m?m.replace(u):u.deleteSelection()}let c=u.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,p=u.doc;if(d?u.replaceRangeWith(c,c,s.content.firstChild):u.replaceRange(c,c,s),u.doc.eq(p))return;let h=u.doc.resolve(c);if(d&&It.isSelectable(s.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(s.content.firstChild))u.setSelection(new It(h));else{let m=u.mapping.map(l);u.mapping.maps[u.mapping.maps.length-1].forEach((g,v,y,b)=>m=b),u.setSelection(g3(e,h,u.doc.resolve(m)))}e.focus(),e.dispatch(u.setMeta("uiEvent","drop"))};ja.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Iu(e)},20))};ja.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};ja.beforeinput=(e,t)=>{if(Ma&&Ro&&t.inputType=="deleteContentBackward"){e.domObserver.flushSoon();let{domChangeCount:r}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=r||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",a=>a(e,yp(8,"Backspace")))))return;let{$cursor:i}=e.state.selection;i&&i.pos>0&&e.dispatch(e.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let e in Ua)ja[e]=Ua[e];function k1(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class EI{constructor(t,n){this.toDOM=t,this.spec=n||Fp,this.side=this.spec.side||0}map(t,n,r,i){let{pos:a,deleted:s}=t.mapResult(n.from+i,this.side<0?-1:1);return s?null:new ao(a-r,a-r,this)}valid(){return!0}eq(t){return this==t||t instanceof EI&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&k1(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class ed{constructor(t,n){this.attrs=t,this.spec=n||Fp}map(t,n,r,i){let a=t.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,s=t.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return a>=s?null:new ao(a,s,this)}valid(t,n){return n.from<n.to}eq(t){return this==t||t instanceof ed&&k1(this.attrs,t.attrs)&&k1(this.spec,t.spec)}static is(t){return t.type instanceof ed}destroy(){}}class w3{constructor(t,n){this.attrs=t,this.spec=n||Fp}map(t,n,r,i){let a=t.mapResult(n.from+i,1);if(a.deleted)return null;let s=t.mapResult(n.to+i,-1);return s.deleted||s.pos<=a.pos?null:new ao(a.pos-r,s.pos-r,this)}valid(t,n){let{index:r,offset:i}=t.content.findIndex(n.from),a;return i==n.from&&!(a=t.child(r)).isText&&i+a.nodeSize==n.to}eq(t){return this==t||t instanceof w3&&k1(this.attrs,t.attrs)&&k1(this.spec,t.spec)}destroy(){}}class ao{constructor(t,n,r){this.from=t,this.to=n,this.type=r}copy(t,n){return new ao(t,n,this.type)}eq(t,n=0){return this.type.eq(t.type)&&this.from+n==t.from&&this.to+n==t.to}map(t,n,r){return this.type.map(t,this,n,r)}static widget(t,n,r){return new ao(t,t,new EI(n,r))}static inline(t,n,r,i){return new ao(t,n,new ed(r,i))}static node(t,n,r,i){return new ao(t,n,new w3(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof ed}get widget(){return this.type instanceof EI}}const qm=[],Fp={};class ci{constructor(t,n){this.local=t.length?t:qm,this.children=n.length?n:qm}static create(t,n){return n.length?OI(n,t,0,Fp):la}find(t,n,r){let i=[];return this.findInner(t==null?0:t,n==null?1e9:n,i,0,r),i}findInner(t,n,r,i,a){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=n&&o.to>=t&&(!a||a(o.spec))&&r.push(o.copy(o.from+i,o.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<n&&this.children[s+1]>t){let o=this.children[s]+1;this.children[s+2].findInner(t-o,n-o,r,i+o,a)}}map(t,n,r){return this==la||t.maps.length==0?this:this.mapInner(t,n,0,0,r||Fp)}mapInner(t,n,r,i,a){let s;for(let o=0;o<this.local.length;o++){let l=this.local[o].map(t,r,i);l&&l.type.valid(n,l)?(s||(s=[])).push(l):a.onRemove&&a.onRemove(this.local[o].spec)}return this.children.length?Obt(this.children,s||[],t,n,r,i,a):s?new ci(s.sort(zp),qm):la}add(t,n){return n.length?this==la?ci.create(t,n):this.addInner(t,n,0):this}addInner(t,n,r){let i,a=0;t.forEach((o,l)=>{let u=l+r,c;if(!!(c=Mce(n,o,u))){for(i||(i=this.children.slice());a<i.length&&i[a]<l;)a+=3;i[a]==l?i[a+2]=i[a+2].addInner(o,c,u+1):i.splice(a,0,l,l+o.nodeSize,OI(c,o,u+1,Fp)),a+=3}});let s=Ace(a?Rce(n):n,-r);for(let o=0;o<s.length;o++)s[o].type.valid(t,s[o])||s.splice(o--,1);return new ci(s.length?this.local.concat(s).sort(zp):this.local,i||this.children)}remove(t){return t.length==0||this==la?this:this.removeInner(t,0)}removeInner(t,n){let r=this.children,i=this.local;for(let a=0;a<r.length;a+=3){let s,o=r[a]+n,l=r[a+1]+n;for(let c=0,d;c<t.length;c++)(d=t[c])&&d.from>o&&d.to<l&&(t[c]=null,(s||(s=[])).push(d));if(!s)continue;r==this.children&&(r=this.children.slice());let u=r[a+2].removeInner(s,o+1);u!=la?r[a+2]=u:(r.splice(a,3),a-=3)}if(i.length){for(let a=0,s;a<t.length;a++)if(s=t[a])for(let o=0;o<i.length;o++)i[o].eq(s,n)&&(i==this.local&&(i=this.local.slice()),i.splice(o--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new ci(i,r):la}forChild(t,n){if(this==la)return this;if(n.isLeaf)return ci.empty;let r,i;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(r=this.children[o+2]);break}let a=t+1,s=a+n.content.size;for(let o=0;o<this.local.length;o++){let l=this.local[o];if(l.from<s&&l.to>a&&l.type instanceof ed){let u=Math.max(a,l.from)-a,c=Math.min(s,l.to)-a;u<c&&(i||(i=[])).push(l.copy(u,c))}}if(i){let o=new ci(i.sort(zp),qm);return r?new $c([o,r]):o}return r||la}eq(t){if(this==t)return!0;if(!(t instanceof ci)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(t.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0}locals(t){return x3(this.localsInner(t))}localsInner(t){if(this==la)return qm;if(t.inlineContent||!this.local.some(ed.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof ed||n.push(this.local[r]);return n}}ci.empty=new ci([],[]);ci.removeOverlap=x3;const la=ci.empty;class $c{constructor(t){this.members=t}map(t,n){const r=this.members.map(i=>i.map(t,n,Fp));return $c.from(r)}forChild(t,n){if(n.isLeaf)return ci.empty;let r=[];for(let i=0;i<this.members.length;i++){let a=this.members[i].forChild(t,n);a!=la&&(a instanceof $c?r=r.concat(a.members):r.push(a))}return $c.from(r)}eq(t){if(!(t instanceof $c)||t.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(t.members[n]))return!1;return!0}locals(t){let n,r=!0;for(let i=0;i<this.members.length;i++){let a=this.members[i].localsInner(t);if(!!a.length)if(!n)n=a;else{r&&(n=n.slice(),r=!1);for(let s=0;s<a.length;s++)n.push(a[s])}}return n?x3(r?n:n.sort(zp)):qm}static from(t){switch(t.length){case 0:return la;case 1:return t[0];default:return new $c(t.every(n=>n instanceof ci)?t:t.reduce((n,r)=>n.concat(r instanceof ci?r:r.members),[]))}}}function Obt(e,t,n,r,i,a,s){let o=e.slice();for(let u=0,c=a;u<n.maps.length;u++){let d=0;n.maps[u].forEach((p,h,m,g)=>{let v=g-m-(h-p);for(let y=0;y<o.length;y+=3){let b=o[y+1];if(b<0||p>b+c-d)continue;let _=o[y]+c-d;h>=_?o[y+1]=p<=_?-2:-1:p>=c&&v&&(o[y]+=v,o[y+1]+=v)}d+=v}),c=n.maps[u].map(c,-1)}let l=!1;for(let u=0;u<o.length;u+=3)if(o[u+1]<0){if(o[u+1]==-2){l=!0,o[u+1]=-1;continue}let c=n.map(e[u]+a),d=c-i;if(d<0||d>=r.content.size){l=!0;continue}let p=n.map(e[u+1]+a,-1),h=p-i,{index:m,offset:g}=r.content.findIndex(d),v=r.maybeChild(m);if(v&&g==d&&g+v.nodeSize==h){let y=o[u+2].mapInner(n,v,c+1,e[u]+a+1,s);y!=la?(o[u]=d,o[u+1]=h,o[u+2]=y):(o[u+1]=-2,l=!0)}else l=!0}if(l){let u=Pbt(o,e,t,n,i,a,s),c=OI(u,r,0,s);t=c.local;for(let d=0;d<o.length;d+=3)o[d+1]<0&&(o.splice(d,3),d-=3);for(let d=0,p=0;d<c.children.length;d+=3){let h=c.children[d];for(;p<o.length&&o[p]<h;)p+=3;o.splice(p,0,c.children[d],c.children[d+1],c.children[d+2])}}return new ci(t.sort(zp),o)}function Ace(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let i=e[r];n.push(new ao(i.from+t,i.to+t,i.type))}return n}function Pbt(e,t,n,r,i,a,s){function o(l,u){for(let c=0;c<l.local.length;c++){let d=l.local[c].map(r,i,u);d?n.push(d):s.onRemove&&s.onRemove(l.local[c].spec)}for(let c=0;c<l.children.length;c+=3)o(l.children[c+2],l.children[c]+u+1)}for(let l=0;l<e.length;l+=3)e[l+1]==-1&&o(e[l+2],t[l]+a+1);return n}function Mce(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,i=null;for(let a=0,s;a<e.length;a++)(s=e[a])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),e[a]=null);return i}function Rce(e){let t=[];for(let n=0;n<e.length;n++)e[n]!=null&&t.push(e[n]);return t}function OI(e,t,n,r){let i=[],a=!1;t.forEach((o,l)=>{let u=Mce(e,o,l+n);if(u){a=!0;let c=OI(u,o,n+l+1,r);c!=la&&i.push(l,l+o.nodeSize,c)}});let s=Ace(a?Rce(e):e,-n).sort(zp);for(let o=0;o<s.length;o++)s[o].type.valid(t,s[o])||(r.onRemove&&r.onRemove(s[o].spec),s.splice(o--,1));return s.length||i.length?new ci(s,i):la}function zp(e,t){return e.from-t.from||e.to-t.to}function x3(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let i=n+1;i<t.length;i++){let a=t[i];if(a.from==r.from){a.to!=r.to&&(t==e&&(t=e.slice()),t[i]=a.copy(a.from,r.to),v8(t,i+1,a.copy(r.to,a.to)));continue}else{a.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,a.from),v8(t,i,r.copy(a.from,r.to)));break}}}return t}function v8(e,t,n){for(;t<e.length&&zp(n,e[t])>0;)t++;e.splice(t,0,n)}function TE(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=la&&t.push(r)}),e.cursorWrapper&&t.push(ci.create(e.state.doc,[e.cursorWrapper.deco])),$c.from(t)}const Abt={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Mbt=hs&&Yc<=11;class Rbt{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class Dbt{constructor(t,n){this.view=t,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Rbt,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);hs&&Yc<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Mbt&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Abt)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let n=0;n<t.length;n++)this.queue.push(t[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(!!c8(this.view)){if(this.suppressingSelectionUpdates)return Iu(this.view);if(hs&&Yc<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&wh(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let n=new Set,r;for(let a=t.focusNode;a;a=w1(a))n.add(a);for(let a=t.anchorNode;a;a=w1(a))if(n.has(a)){r=a;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&c8(t)&&!this.ignoreSelectionChange(r),a=-1,s=-1,o=!1,l=[];if(t.editable)for(let c=0;c<n.length;c++){let d=this.registerMutation(n[c],l);d&&(a=a<0?d.from:Math.min(d.from,a),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(o=!0))}if(rl&&l.length){let c=l.filter(d=>d.nodeName=="BR");if(c.length==2){let[d,p]=c;d.parentNode&&d.parentNode.parentNode==p.parentNode?p.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let p of c){let h=p.parentNode;h&&h.nodeName=="LI"&&(!d||zbt(t,d)!=h)&&p.remove()}}}let u=null;a<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&xT(r)&&(u=m3(t))&&u.eq(en.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Iu(t),this.currentSelection.set(r),t.scrollToSelection()):(a>-1||i)&&(a>-1&&(t.docView.markDirty(a,s),Lbt(t)),this.handleDOMChange(a,s,o,l),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||Iu(t),this.currentSelection.set(r))}registerMutation(t,n){if(n.indexOf(t.target)>-1)return null;let r=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(r==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if(t.type=="childList"){for(let c=0;c<t.addedNodes.length;c++){let d=t.addedNodes[c];n.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};let i=t.previousSibling,a=t.nextSibling;if(hs&&Yc<=11&&t.addedNodes.length)for(let c=0;c<t.addedNodes.length;c++){let{previousSibling:d,nextSibling:p}=t.addedNodes[c];(!d||Array.prototype.indexOf.call(t.addedNodes,d)<0)&&(i=d),(!p||Array.prototype.indexOf.call(t.addedNodes,p)<0)&&(a=p)}let s=i&&i.parentNode==t.target?Gi(i)+1:0,o=r.localPosFromDOM(t.target,s,-1),l=a&&a.parentNode==t.target?Gi(a):t.target.childNodes.length,u=r.localPosFromDOM(t.target,l,1);return{from:o,to:u}}else return t.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=t.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let b8=new WeakMap,w8=!1;function Lbt(e){if(!b8.has(e)&&(b8.set(e,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)!==-1)){if(e.requiresGeckoHackNode=rl,w8)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),w8=!0}}function x8(e,t){let n=t.startContainer,r=t.startOffset,i=t.endContainer,a=t.endOffset,s=e.domAtPos(e.state.selection.anchor);return wh(s.node,s.offset,i,a)&&([n,r,i,a]=[i,a,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:a}}function Fbt(e,t){if(t.getComposedRanges){let i=t.getComposedRanges(e.root)[0];if(i)return x8(e,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?x8(e,n):null}function zbt(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let r=e.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function Bbt(e,t,n){let{node:r,fromOffset:i,toOffset:a,from:s,to:o}=e.docView.parseRange(t,n),l=e.domSelectionRange(),u,c=l.anchorNode;if(c&&e.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:l.anchorOffset}],xT(l)||u.push({node:l.focusNode,offset:l.focusOffset})),Ma&&e.input.lastKeyCode===8)for(let v=a;v>i;v--){let y=r.childNodes[v-1],b=y.pmViewDesc;if(y.nodeName=="BR"&&!b){a=v;break}if(!b||b.size)break}let d=e.state.doc,p=e.someProp("domParser")||hy.fromSchema(e.state.schema),h=d.resolve(s),m=null,g=p.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:a,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:Wbt,context:h});if(u&&u[0].pos!=null){let v=u[0].pos,y=u[1]&&u[1].pos;y==null&&(y=v),m={anchor:v+s,head:y+s}}return{doc:g,sel:m,from:s,to:o}}function Wbt(e){let t=e.pmViewDesc;if(t)return t.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(Va&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(e.parentNode.lastChild==e||Va&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Vbt=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function jbt(e,t,n,r,i){let a=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let D=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,O=m3(e,D);if(O&&!e.state.selection.eq(O)){if(Ma&&Ro&&e.input.lastKeyCode===13&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",E=>E(e,yp(13,"Enter"))))return;let F=e.state.tr.setSelection(O);D=="pointer"?F.setMeta("pointer",!0):D=="key"&&F.scrollIntoView(),a&&F.setMeta("composition",a),e.dispatch(F)}return}let s=e.state.doc.resolve(t),o=s.sharedDepth(n);t=s.before(o+1),n=e.state.doc.resolve(n).after(o+1);let l=e.state.selection,u=Bbt(e,t,n),c=e.state.doc,d=c.slice(u.from,u.to),p,h;e.input.lastKeyCode===8&&Date.now()-100<e.input.lastKeyCodeTime?(p=e.state.selection.to,h="end"):(p=e.state.selection.from,h="start"),e.input.lastKeyCode=null;let m=Gbt(d.content,u.doc.content,u.from,p,h);if((gy&&e.input.lastIOSEnter>Date.now()-225||Ro)&&i.some(D=>D.nodeType==1&&!Vbt.test(D.nodeName))&&(!m||m.endA>=m.endB)&&e.someProp("handleKeyDown",D=>D(e,yp(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!m)if(r&&l instanceof Ht&&!l.empty&&l.$head.sameParent(l.$anchor)&&!e.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))m={start:l.from,endA:l.to,endB:l.to};else{if(u.sel){let D=_8(e,e.state.doc,u.sel);if(D&&!D.eq(e.state.selection)){let O=e.state.tr.setSelection(D);a&&O.setMeta("composition",a),e.dispatch(O)}}return}e.input.domChangeCount++,e.state.selection.from<e.state.selection.to&&m.start==m.endB&&e.state.selection instanceof Ht&&(m.start>e.state.selection.from&&m.start<=e.state.selection.from+2&&e.state.selection.from>=u.from?m.start=e.state.selection.from:m.endA<e.state.selection.to&&m.endA>=e.state.selection.to-2&&e.state.selection.to<=u.to&&(m.endB+=e.state.selection.to-m.endA,m.endA=e.state.selection.to)),hs&&Yc<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>u.from&&u.doc.textBetween(m.start-u.from-1,m.start-u.from+1)==" \xA0"&&(m.start--,m.endA--,m.endB--);let g=u.doc.resolveNoCache(m.start-u.from),v=u.doc.resolveNoCache(m.endB-u.from),y=c.resolve(m.start),b=g.sameParent(v)&&g.parent.inlineContent&&y.end()>=m.endA,_;if((gy&&e.input.lastIOSEnter>Date.now()-225&&(!b||i.some(D=>D.nodeName=="DIV"||D.nodeName=="P"))||!b&&g.pos<u.doc.content.size&&!g.sameParent(v)&&(_=en.findFrom(u.doc.resolve(g.pos+1),1,!0))&&_.head==v.pos)&&e.someProp("handleKeyDown",D=>D(e,yp(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>m.start&&Hbt(c,m.start,m.endA,g,v)&&e.someProp("handleKeyDown",D=>D(e,yp(8,"Backspace")))){Ro&&Ma&&e.domObserver.suppressSelectionUpdates();return}Ma&&Ro&&m.endB==m.start&&(e.input.lastAndroidDelete=Date.now()),Ro&&!b&&g.start()!=v.start()&&v.parentOffset==0&&g.depth==v.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==m.endA&&(m.endB-=2,v=u.doc.resolveNoCache(m.endB-u.from),setTimeout(()=>{e.someProp("handleKeyDown",function(D){return D(e,yp(13,"Enter"))})},20));let k=m.start,C=m.endA,$,N,A;if(b){if(g.pos==v.pos)hs&&Yc<=11&&g.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>Iu(e),20)),$=e.state.tr.delete(k,C),N=c.resolve(m.start).marksAcross(c.resolve(m.endA));else if(m.endA==m.endB&&(A=Ubt(g.parent.content.cut(g.parentOffset,v.parentOffset),y.parent.content.cut(y.parentOffset,m.endA-y.start()))))$=e.state.tr,A.type=="add"?$.addMark(k,C,A.mark):$.removeMark(k,C,A.mark);else if(g.parent.child(g.index()).isText&&g.index()==v.index()-(v.textOffset?0:1)){let D=g.parent.textBetween(g.parentOffset,v.parentOffset);if(e.someProp("handleTextInput",O=>O(e,k,C,D)))return;$=e.state.tr.insertText(D,k,C)}}if($||($=e.state.tr.replace(k,C,u.doc.slice(m.start-u.from,m.endB-u.from))),u.sel){let D=_8(e,$.doc,u.sel);D&&!(Ma&&Ro&&e.composing&&D.empty&&(m.start!=m.endB||e.input.lastAndroidDelete<Date.now()-100)&&(D.head==k||D.head==$.mapping.map(C)-1)||hs&&D.empty&&D.head==k)&&$.setSelection(D)}N&&$.ensureMarks(N),a&&$.setMeta("composition",a),e.dispatch($.scrollIntoView())}function _8(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:g3(e,t.resolve(n.anchor),t.resolve(n.head))}function Ubt(e,t){let n=e.firstChild.marks,r=t.firstChild.marks,i=n,a=r,s,o,l;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<n.length;c++)a=n[c].removeFromSet(a);if(i.length==1&&a.length==0)o=i[0],s="add",l=c=>c.mark(o.addToSet(c.marks));else if(i.length==0&&a.length==1)o=a[0],s="remove",l=c=>c.mark(o.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<t.childCount;c++)u.push(l(t.child(c)));if(Ae.from(u).eq(e))return{mark:o,type:s}}function Hbt(e,t,n,r,i){if(n-t<=i.pos-r.pos||NE(r,!0,!1)<i.pos)return!1;let a=e.resolve(t);if(!r.parent.isTextblock){let o=a.nodeAfter;return o!=null&&n==t+o.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let s=e.resolve(NE(a,!0,!0));return!s.parent.isTextblock||s.pos>n||NE(s,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function NE(e,t,n){let r=e.depth,i=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,i++,t=!1;if(n){let a=e.node(r).maybeChild(e.indexAfter(r));for(;a&&!a.isLeaf;)a=a.firstChild,i++}return i}function Gbt(e,t,n,r,i){let a=e.findDiffStart(t,n);if(a==null)return null;let{a:s,b:o}=e.findDiffEnd(t,n+e.size,n+t.size);if(i=="end"){let l=Math.max(0,a-Math.min(s,o));r-=s+l-a}if(s<a&&e.size<t.size){let l=r<=a&&r>=s?a-r:0;a-=l,a&&a<t.size&&k8(t.textBetween(a-1,a+1))&&(a+=l?1:-1),o=a+(o-s),s=a}else if(o<a){let l=r<=a&&r>=o?a-r:0;a-=l,a&&a<e.size&&k8(e.textBetween(a-1,a+1))&&(a+=l?1:-1),s=a+(s-o),o=a}return{start:a,endA:s,endB:o}}function k8(e){if(e.length!=2)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class qbt{constructor(t,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new pbt,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(T8),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=I8(this),C8(this),this.nodeViews=$8(this),this.docView=i8(this.state.doc,S8(this),TE(this),this.dom,this),this.domObserver=new Dbt(this,(r,i,a,s)=>jbt(this,r,i,a,s)),this.domObserver.start(),hbt(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let n in t)this._props[n]=t[n];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&NA(this);let n=this._props;this._props=t,t.plugins&&(t.plugins.forEach(T8),this.directPlugins=t.plugins),this.updateStateInner(t.state,n)}setProps(t){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in t)n[r]=t[r];this.update(n)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,n){var r;let i=this.state,a=!1,s=!1;t.storedMarks&&this.composing&&(Nce(this),s=!0),this.state=t;let o=i.plugins!=t.plugins||this._props.plugins!=n.plugins;if(o||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let h=$8(this);Zbt(h,this.nodeViews)&&(this.nodeViews=h,a=!0)}(o||n.handleDOMEvents!=this._props.handleDOMEvents)&&NA(this),this.editable=I8(this),C8(this);let l=TE(this),u=S8(this),c=i.plugins!=t.plugins&&!i.doc.eq(t.doc)?"reset":t.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=a||!this.docView.matchesNode(t.doc,u,l);(d||!t.selection.eq(i.selection))&&(s=!0);let p=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&T0t(this);if(s){this.domObserver.stop();let h=d&&(hs||Ma)&&!this.composing&&!i.selection.empty&&!t.selection.empty&&Kbt(i.selection,t.selection);if(d){let m=Ma?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Ibt(this)),(a||!this.docView.update(t.doc,u,l,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=i8(t.doc,u,l,this.dom,this)),m&&!this.trackWrites&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Y0t(this))?Iu(this,h):(gce(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),((r=this.dragging)===null||r===void 0?void 0:r.node)&&!i.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():p&&N0t(p)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof It){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&YH(this,n.getBoundingClientRect(),t)}else YH(this,this.coordsAtPos(this.state.selection.head,1),t)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,t)}}updateDraggedNode(t,n){let r=t.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let a=r.from+(this.state.doc.content.size-n.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==r.node&&(i=a)}this.dragging=new Oce(t.slice,t.move,i<0?void 0:It.create(this.state.doc,i))}someProp(t,n){let r=this._props&&this._props[t],i;if(r!=null&&(i=n?n(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let o=this.directPlugins[s].props[t];if(o!=null&&(i=n?n(o):o))return i}let a=this.state.plugins;if(a)for(let s=0;s<a.length;s++){let o=a[s].props[t];if(o!=null&&(i=n?n(o):o))return i}}hasFocus(){if(hs){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&E0t(this.dom),Iu(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return t||document}updateRoot(){this._root=null}posAtCoords(t){return R0t(this,t)}coordsAtPos(t,n=1){return lce(this,t,n)}domAtPos(t,n=0){return this.docView.domFromPos(t,n)}nodeDOM(t){let n=this.docView.descAt(t);return n?n.nodeDOM:null}posAtDOM(t,n,r=-1){let i=this.docView.posFromDOM(t,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,n){return B0t(this,n||this.state,t)}pasteHTML(t,n){return _1(this,"",t,!1,n||new ClipboardEvent("paste"))}pasteText(t,n){return _1(this,t,null,!0,n||new ClipboardEvent("paste"))}destroy(){!this.docView||(fbt(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],TE(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,g0t())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return gbt(this,t)}dispatch(t){let n=this._props.dispatchTransaction;n?n.call(this,t):this.updateState(this.state.apply(t))}domSelectionRange(){let t=this.domSelection();return Va&&this.root.nodeType===11&&x0t(this.dom.ownerDocument)==this.dom&&Fbt(this,t)||t}domSelection(){return this.root.getSelection()}}function S8(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(e.state)),n)for(let r in n)r=="class"?t.class+=" "+n[r]:r=="style"?t.style=(t.style?t.style+";":"")+n[r]:!t[r]&&r!="contenteditable"&&r!="nodeName"&&(t[r]=String(n[r]))}),t.translate||(t.translate="no"),[ao.node(0,e.state.doc.content.size,t)]}function C8(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:ao.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function I8(e){return!e.someProp("editable",t=>t(e.state)===!1)}function Kbt(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}function $8(e){let t=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=r[i])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function Zbt(e,t){let n=0,r=0;for(let i in e){if(e[i]!=t[i])return!0;n++}for(let i in t)r++;return n!=r}function T8(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var bd={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},PI={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Xbt=typeof navigator<"u"&&/Mac/.test(navigator.platform),Jbt=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var qi=0;qi<10;qi++)bd[48+qi]=bd[96+qi]=String(qi);for(var qi=1;qi<=24;qi++)bd[qi+111]="F"+qi;for(var qi=65;qi<=90;qi++)bd[qi]=String.fromCharCode(qi+32),PI[qi]=String.fromCharCode(qi);for(var EE in bd)PI.hasOwnProperty(EE)||(PI[EE]=bd[EE]);function Ybt(e){var t=Xbt&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||Jbt&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",n=!t&&e.key||(e.shiftKey?PI:bd)[e.keyCode]||e.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const Qbt=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function e1t(e){let t=e.split(/-(?!$)/),n=t[t.length-1];n=="Space"&&(n=" ");let r,i,a,s;for(let o=0;o<t.length-1;o++){let l=t[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))Qbt?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),s&&(n="Meta-"+n),a&&(n="Shift-"+n),n}function t1t(e){let t=Object.create(null);for(let n in e)t[e1t(n)]=e[n];return t}function OE(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function n1t(e){return new Gs({props:{handleKeyDown:Dce(e)}})}function Dce(e){let t=t1t(e);return function(n,r){let i=Ybt(r),a,s=t[OE(i,r)];if(s&&s(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let o=t[OE(i,r,!1)];if(o&&o(n.state,n.dispatch,n))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(a=bd[r.keyCode])&&a!=i){let o=t[OE(a,r)];if(o&&o(n.state,n.dispatch,n))return!0}}return!1}}const r1t=(e,t)=>e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function Lce(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}const i1t=(e,t,n)=>{let r=Lce(e,n);if(!r)return!1;let i=_3(r);if(!i){let s=r.blockRange(),o=s&&n0(s);return o==null?!1:(t&&t(e.tr.lift(s,o).scrollIntoView()),!0)}let a=i.nodeBefore;if(!a.type.spec.isolating&&Wce(e,i,t))return!0;if(r.parent.content.size==0&&(yy(a,"end")||It.isSelectable(a))){let s=bT(e.doc,r.before(),r.after(),Qe.empty);if(s&&s.slice.size<s.to-s.from){if(t){let o=e.tr.step(s);o.setSelection(yy(a,"end")?en.findFrom(o.doc.resolve(o.mapping.map(i.pos,-1)),-1):It.create(o.doc,i.pos-a.nodeSize)),t(o.scrollIntoView())}return!0}}return a.isAtom&&i.depth==r.depth-1?(t&&t(e.tr.delete(i.pos-a.nodeSize,i.pos).scrollIntoView()),!0):!1},a1t=(e,t,n)=>{let r=Lce(e,n);if(!r)return!1;let i=_3(r);return i?Fce(e,i,t):!1},s1t=(e,t,n)=>{let r=zce(e,n);if(!r)return!1;let i=k3(r);return i?Fce(e,i,t):!1};function Fce(e,t,n){let r=t.nodeBefore,i=r,a=t.pos-1;for(;!i.isTextblock;a--){if(i.type.spec.isolating)return!1;let c=i.lastChild;if(!c)return!1;i=c}let s=t.nodeAfter,o=s,l=t.pos+1;for(;!o.isTextblock;l++){if(o.type.spec.isolating)return!1;let c=o.firstChild;if(!c)return!1;o=c}let u=bT(e.doc,a,l,Qe.empty);if(!u||u.from!=a||u instanceof Ci&&u.slice.size>=l-a)return!1;if(n){let c=e.tr.step(u);c.setSelection(Ht.create(c.doc,a)),n(c.scrollIntoView())}return!0}function yy(e,t,n=!1){for(let r=e;r;r=t=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const o1t=(e,t,n)=>{let{$head:r,empty:i}=e.selection,a=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;a=_3(r)}let s=a&&a.nodeBefore;return!s||!It.isSelectable(s)?!1:(t&&t(e.tr.setSelection(It.create(e.doc,a.pos-s.nodeSize)).scrollIntoView()),!0)};function _3(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function zce(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}const l1t=(e,t,n)=>{let r=zce(e,n);if(!r)return!1;let i=k3(r);if(!i)return!1;let a=i.nodeAfter;if(Wce(e,i,t))return!0;if(r.parent.content.size==0&&(yy(a,"start")||It.isSelectable(a))){let s=bT(e.doc,r.before(),r.after(),Qe.empty);if(s&&s.slice.size<s.to-s.from){if(t){let o=e.tr.step(s);o.setSelection(yy(a,"start")?en.findFrom(o.doc.resolve(o.mapping.map(i.pos)),1):It.create(o.doc,o.mapping.map(i.pos))),t(o.scrollIntoView())}return!0}}return a.isAtom&&i.depth==r.depth-1?(t&&t(e.tr.delete(i.pos,i.pos+a.nodeSize).scrollIntoView()),!0):!1},u1t=(e,t,n)=>{let{$head:r,empty:i}=e.selection,a=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;a=k3(r)}let s=a&&a.nodeAfter;return!s||!It.isSelectable(s)?!1:(t&&t(e.tr.setSelection(It.create(e.doc,a.pos)).scrollIntoView()),!0)};function k3(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}const c1t=(e,t)=>{let n=e.selection,r=n instanceof It,i;if(r){if(n.node.isTextblock||!Hd(e.doc,n.from))return!1;i=n.from}else if(i=vT(e.doc,n.from,-1),i==null)return!1;if(t){let a=e.tr.join(i);r&&a.setSelection(It.create(a.doc,i-e.doc.resolve(i).nodeBefore.nodeSize)),t(a.scrollIntoView())}return!0},d1t=(e,t)=>{let n=e.selection,r;if(n instanceof It){if(n.node.isTextblock||!Hd(e.doc,n.to))return!1;r=n.to}else if(r=vT(e.doc,n.to,1),r==null)return!1;return t&&t(e.tr.join(r).scrollIntoView()),!0},p1t=(e,t)=>{let{$from:n,$to:r}=e.selection,i=n.blockRange(r),a=i&&n0(i);return a==null?!1:(t&&t(e.tr.lift(i,a).scrollIntoView()),!0)},h1t=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function Bce(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const f1t=(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),a=n.indexAfter(-1),s=Bce(i.contentMatchAt(a));if(!s||!i.canReplaceWith(a,a,s))return!1;if(t){let o=n.after(),l=e.tr.replaceWith(o,o,s.createAndFill());l.setSelection(en.near(l.doc.resolve(o),1)),t(l.scrollIntoView())}return!0},m1t=(e,t)=>{let n=e.selection,{$from:r,$to:i}=n;if(n instanceof jo||r.parent.inlineContent||i.parent.inlineContent)return!1;let a=Bce(i.parent.contentMatchAt(i.indexAfter()));if(!a||!a.isTextblock)return!1;if(t){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,o=e.tr.insert(s,a.createAndFill());o.setSelection(Ht.create(o.doc,s+1)),t(o.scrollIntoView())}return!0},g1t=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let a=n.before();if(Eg(e.doc,a))return t&&t(e.tr.split(a).scrollIntoView()),!0}let r=n.blockRange(),i=r&&n0(r);return i==null?!1:(t&&t(e.tr.lift(r,i).scrollIntoView()),!0)},y1t=(e,t)=>{let{$from:n,to:r}=e.selection,i,a=n.sharedDepth(r);return a==0?!1:(i=n.before(a),t&&t(e.tr.setSelection(It.create(e.doc,i))),!0)};function v1t(e,t,n){let r=t.nodeBefore,i=t.nodeAfter,a=t.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&t.parent.canReplace(a-1,a)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(a,a+1)||!(i.isTextblock||Hd(e.doc,t.pos))?!1:(n&&n(e.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),!0)}function Wce(e,t,n){let r=t.nodeBefore,i=t.nodeAfter,a,s;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(v1t(e,t,n))return!0;let o=t.parent.canReplace(t.index(),t.index()+1);if(o&&(a=(s=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&s.matchType(a[0]||i.type).validEnd){if(n){let d=t.pos+i.nodeSize,p=Ae.empty;for(let g=a.length-1;g>=0;g--)p=Ae.from(a[g].create(null,p));p=Ae.from(r.copy(p));let h=e.tr.step(new Oi(t.pos-1,d,t.pos,d,new Qe(p,1,0),a.length,!0)),m=d+2*a.length;Hd(h.doc,m)&&h.join(m),n(h.scrollIntoView())}return!0}let l=en.findFrom(t,1),u=l&&l.$from.blockRange(l.$to),c=u&&n0(u);if(c!=null&&c>=t.depth)return n&&n(e.tr.lift(u,c).scrollIntoView()),!0;if(o&&yy(i,"start",!0)&&yy(r,"end")){let d=r,p=[];for(;p.push(d),!d.isTextblock;)d=d.lastChild;let h=i,m=1;for(;!h.isTextblock;h=h.firstChild)m++;if(d.canReplace(d.childCount,d.childCount,h.content)){if(n){let g=Ae.empty;for(let y=p.length-1;y>=0;y--)g=Ae.from(p[y].copy(g));let v=e.tr.step(new Oi(t.pos-p.length,t.pos+i.nodeSize,t.pos+m,t.pos+i.nodeSize-m,new Qe(g,p.length,0),0,!0));n(v.scrollIntoView())}return!0}}return!1}function Vce(e){return function(t,n){let r=t.selection,i=e<0?r.$from:r.$to,a=i.depth;for(;i.node(a).isInline;){if(!a)return!1;a--}return i.node(a).isTextblock?(n&&n(t.tr.setSelection(Ht.create(t.doc,e<0?i.start(a):i.end(a)))),!0):!1}}const b1t=Vce(-1),w1t=Vce(1);function x1t(e,t=null){return function(n,r){let{$from:i,$to:a}=n.selection,s=i.blockRange(a),o=s&&p3(s,e,t);return o?(r&&r(n.tr.wrap(s,o).scrollIntoView()),!0):!1}}function N8(e,t=null){return function(n,r){let i=!1;for(let a=0;a<n.selection.ranges.length&&!i;a++){let{$from:{pos:s},$to:{pos:o}}=n.selection.ranges[a];n.doc.nodesBetween(s,o,(l,u)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(e,t)))if(l.type==e)i=!0;else{let c=n.doc.resolve(u),d=c.index();i=c.parent.canReplaceWith(d,d+1,e)}})}if(!i)return!1;if(r){let a=n.tr;for(let s=0;s<n.selection.ranges.length;s++){let{$from:{pos:o},$to:{pos:l}}=n.selection.ranges[s];a.setBlockType(o,l,e,t)}r(a.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function _1t(e,t=null){return function(n,r){let{$from:i,$to:a}=n.selection,s=i.blockRange(a),o=!1,l=s;if(!s)return!1;if(s.depth>=2&&i.node(s.depth-1).type.compatibleContent(e)&&s.startIndex==0){if(i.index(s.depth-1)==0)return!1;let c=n.doc.resolve(s.start-2);l=new kI(c,c,s.depth),s.endIndex<s.parent.childCount&&(s=new kI(i,n.doc.resolve(a.end(s.depth)),s.depth)),o=!0}let u=p3(l,e,t,s);return u?(r&&r(k1t(n.tr,s,u,o,e).scrollIntoView()),!0):!1}}function k1t(e,t,n,r,i){let a=Ae.empty;for(let c=n.length-1;c>=0;c--)a=Ae.from(n[c].type.create(n[c].attrs,a));e.step(new Oi(t.start-(r?2:0),t.end,t.start,t.end,new Qe(a,0,0),n.length,!0));let s=0;for(let c=0;c<n.length;c++)n[c].type==i&&(s=c+1);let o=n.length-s,l=t.start+n.length-(r?2:0),u=t.parent;for(let c=t.startIndex,d=t.endIndex,p=!0;c<d;c++,p=!1)!p&&Eg(e.doc,l,o)&&(e.split(l,o),l+=2*o),l+=u.child(c).nodeSize;return e}function S1t(e){return function(t,n){let{$from:r,$to:i}=t.selection,a=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==e);return a?n?r.node(a.depth-1).type==e?C1t(t,n,e,a):I1t(t,n,a):!0:!1}}function C1t(e,t,n,r){let i=e.tr,a=r.end,s=r.$to.end(r.depth);a<s&&(i.step(new Oi(a-1,s,a,s,new Qe(Ae.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new kI(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const o=n0(r);if(o==null)return!1;i.lift(r,o);let l=i.mapping.map(a,-1)-1;return Hd(i.doc,l)&&i.join(l),t(i.scrollIntoView()),!0}function I1t(e,t,n){let r=e.tr,i=n.parent;for(let h=n.end,m=n.endIndex-1,g=n.startIndex;m>g;m--)h-=i.child(m).nodeSize,r.delete(h-1,h+1);let a=r.doc.resolve(n.start),s=a.nodeAfter;if(r.mapping.map(n.end)!=n.start+a.nodeAfter.nodeSize)return!1;let o=n.startIndex==0,l=n.endIndex==i.childCount,u=a.node(-1),c=a.index(-1);if(!u.canReplace(c+(o?0:1),c+1,s.content.append(l?Ae.empty:Ae.from(i))))return!1;let d=a.pos,p=d+s.nodeSize;return r.step(new Oi(d-(o?1:0),p+(l?1:0),d+1,p-1,new Qe((o?Ae.empty:Ae.from(i.copy(Ae.empty))).append(l?Ae.empty:Ae.from(i.copy(Ae.empty))),o?0:1,l?0:1),o?0:1)),t(r.scrollIntoView()),!0}function $1t(e){return function(t,n){let{$from:r,$to:i}=t.selection,a=r.blockRange(i,u=>u.childCount>0&&u.firstChild.type==e);if(!a)return!1;let s=a.startIndex;if(s==0)return!1;let o=a.parent,l=o.child(s-1);if(l.type!=e)return!1;if(n){let u=l.lastChild&&l.lastChild.type==o.type,c=Ae.from(u?e.create():null),d=new Qe(Ae.from(e.create(null,Ae.from(o.type.create(null,c)))),u?3:1,0),p=a.start,h=a.end;n(t.tr.step(new Oi(p-(u?3:1),h,p,h,d,1,!0)).scrollIntoView())}return!0}}function ST(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:i}=n,{storedMarks:a}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return a},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,a=n.storedMarks,n}}}class CT{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:r}=this,{view:i}=n,{tr:a}=r,s=this.buildProps(a);return Object.fromEntries(Object.entries(t).map(([o,l])=>[o,(...c)=>{const d=l(...c)(s);return!a.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(a),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:r,editor:i,state:a}=this,{view:s}=i,o=[],l=!!t,u=t||a.tr,c=()=>(!l&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(u),o.every(p=>p===!0)),d={...Object.fromEntries(Object.entries(r).map(([p,h])=>[p,(...g)=>{const v=this.buildProps(u,n),y=h(...g)(v);return o.push(y),d}])),run:c};return d}createCan(t){const{rawCommands:n,state:r}=this,i=!1,a=t||r.tr,s=this.buildProps(a,i);return{...Object.fromEntries(Object.entries(n).map(([l,u])=>[l,(...c)=>u(...c)({...s,dispatch:void 0})])),chain:()=>this.createChain(a,i)}}buildProps(t,n=!0){const{rawCommands:r,editor:i,state:a}=this,{view:s}=i,o={tr:t,editor:i,view:s,state:ST({state:a,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t,n),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([l,u])=>[l,(...c)=>u(...c)(o)]))}};return o}}class T1t{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const r=this.callbacks[t];return r&&r.forEach(i=>i.apply(this,n)),this}off(t,n){const r=this.callbacks[t];return r&&(n?this.callbacks[t]=r.filter(i=>i!==n):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}function ht(e,t,n){return e.config[t]===void 0&&e.parent?ht(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind({...n,parent:e.parent?ht(e.parent,t,n):null}):e.config[t]}function IT(e){const t=e.filter(i=>i.type==="extension"),n=e.filter(i=>i.type==="node"),r=e.filter(i=>i.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:r}}function jce(e){const t=[],{nodeExtensions:n,markExtensions:r}=IT(e),i=[...n,...r],a={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage},l=ht(s,"addGlobalAttributes",o);if(!l)return;l().forEach(c=>{c.types.forEach(d=>{Object.entries(c.attributes).forEach(([p,h])=>{t.push({type:d,name:p,attribute:{...a,...h}})})})})}),i.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage},l=ht(s,"addAttributes",o);if(!l)return;const u=l();Object.entries(u).forEach(([c,d])=>{const p={...a,...d};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),(p==null?void 0:p.isRequired)&&(p==null?void 0:p.default)===void 0&&delete p.default,t.push({type:s.name,name:c,attribute:p})})}),t}function Mi(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function mr(...e){return e.filter(t=>!!t).reduce((t,n)=>{const r={...t};return Object.entries(n).forEach(([i,a])=>{if(!r[i]){r[i]=a;return}if(i==="class"){const o=a?a.split(" "):[],l=r[i]?r[i].split(" "):[],u=o.filter(c=>!l.includes(c));r[i]=[...l,...u].join(" ")}else i==="style"?r[i]=[r[i],a].join("; "):r[i]=a}),r},{})}function EA(e,t){return t.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,r)=>mr(n,r),{})}function Uce(e){return typeof e=="function"}function Qt(e,t=void 0,...n){return Uce(e)?t?e.bind(t)(...n):e(...n):e}function N1t(e={}){return Object.keys(e).length===0&&e.constructor===Object}function E1t(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function E8(e,t){return e.style?e:{...e,getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(r===!1)return!1;const i=t.reduce((a,s)=>{const o=s.attribute.parseHTML?s.attribute.parseHTML(n):E1t(n.getAttribute(s.name));return o==null?a:{...a,[s.name]:o}},{});return{...r,...i}}}}function O8(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&N1t(n)?!1:n!=null))}function O1t(e,t){var n;const r=jce(e),{nodeExtensions:i,markExtensions:a}=IT(e),s=(n=i.find(u=>ht(u,"topNode")))===null||n===void 0?void 0:n.name,o=Object.fromEntries(i.map(u=>{const c=r.filter(y=>y.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:t},p=e.reduce((y,b)=>{const _=ht(b,"extendNodeSchema",d);return{...y,..._?_(u):{}}},{}),h=O8({...p,content:Qt(ht(u,"content",d)),marks:Qt(ht(u,"marks",d)),group:Qt(ht(u,"group",d)),inline:Qt(ht(u,"inline",d)),atom:Qt(ht(u,"atom",d)),selectable:Qt(ht(u,"selectable",d)),draggable:Qt(ht(u,"draggable",d)),code:Qt(ht(u,"code",d)),defining:Qt(ht(u,"defining",d)),isolating:Qt(ht(u,"isolating",d)),attrs:Object.fromEntries(c.map(y=>{var b;return[y.name,{default:(b=y==null?void 0:y.attribute)===null||b===void 0?void 0:b.default}]}))}),m=Qt(ht(u,"parseHTML",d));m&&(h.parseDOM=m.map(y=>E8(y,c)));const g=ht(u,"renderHTML",d);g&&(h.toDOM=y=>g({node:y,HTMLAttributes:EA(y,c)}));const v=ht(u,"renderText",d);return v&&(h.toText=v),[u.name,h]})),l=Object.fromEntries(a.map(u=>{const c=r.filter(v=>v.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:t},p=e.reduce((v,y)=>{const b=ht(y,"extendMarkSchema",d);return{...v,...b?b(u):{}}},{}),h=O8({...p,inclusive:Qt(ht(u,"inclusive",d)),excludes:Qt(ht(u,"excludes",d)),group:Qt(ht(u,"group",d)),spanning:Qt(ht(u,"spanning",d)),code:Qt(ht(u,"code",d)),attrs:Object.fromEntries(c.map(v=>{var y;return[v.name,{default:(y=v==null?void 0:v.attribute)===null||y===void 0?void 0:y.default}]}))}),m=Qt(ht(u,"parseHTML",d));m&&(h.parseDOM=m.map(v=>E8(v,c)));const g=ht(u,"renderHTML",d);return g&&(h.toDOM=v=>g({mark:v,HTMLAttributes:EA(v,c)})),[u.name,h]}));return new Mvt({topNode:s,nodes:o,marks:l})}function PE(e,t){return t.nodes[e]||t.marks[e]||null}function P8(e,t){return Array.isArray(t)?t.some(n=>(typeof n=="string"?n:n.name)===e.name):t}const P1t=(e,t=500)=>{let n="";const r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(i,a,s,o)=>{var l,u;const c=((u=(l=i.type.spec).toText)===null||u===void 0?void 0:u.call(l,{node:i,pos:a,parent:s,index:o}))||i.textContent||"%leaf%";n+=c.slice(0,Math.max(0,r-a))}),n};function S3(e){return Object.prototype.toString.call(e)==="[object RegExp]"}class $T{constructor(t){this.find=t.find,this.handler=t.handler}}const A1t=(e,t)=>{if(S3(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function $_(e){var t;const{editor:n,from:r,to:i,text:a,rules:s,plugin:o}=e,{view:l}=n;if(l.composing)return!1;const u=l.state.doc.resolve(r);if(u.parent.type.spec.code||!!(!((t=u.nodeBefore||u.nodeAfter)===null||t===void 0)&&t.marks.find(p=>p.type.spec.code)))return!1;let c=!1;const d=P1t(u)+a;return s.forEach(p=>{if(c)return;const h=A1t(d,p.find);if(!h)return;const m=l.state.tr,g=ST({state:l.state,transaction:m}),v={from:r-(h[0].length-a.length),to:i},{commands:y,chain:b,can:_}=new CT({editor:n,state:g});p.handler({state:g,range:v,match:h,commands:y,chain:b,can:_})===null||!m.steps.length||(m.setMeta(o,{transform:m,from:r,to:i,text:a}),l.dispatch(m),c=!0)}),c}function M1t(e){const{editor:t,rules:n}=e,r=new Gs({state:{init(){return null},apply(i,a){const s=i.getMeta(r);if(s)return s;const o=i.getMeta("applyInputRules");return!!o&&setTimeout(()=>{const{from:u,text:c}=o,d=u+c.length;$_({editor:t,from:u,to:d,text:c,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:a}},props:{handleTextInput(i,a,s,o){return $_({editor:t,from:a,to:s,text:o,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:a}=i.state.selection;a&&$_({editor:t,from:a.pos,to:a.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,a){if(a.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?$_({editor:t,from:s.pos,to:s.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function R1t(e){return typeof e=="number"}class D1t{constructor(t){this.find=t.find,this.handler=t.handler}}const L1t=(e,t,n)=>{if(S3(t))return[...e.matchAll(t)];const r=t(e,n);return r?r.map(i=>{const a=[i.text];return a.index=i.index,a.input=e,a.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(i.replaceWith)),a}):[]};function F1t(e){const{editor:t,state:n,from:r,to:i,rule:a,pasteEvent:s,dropEvent:o}=e,{commands:l,chain:u,can:c}=new CT({editor:t,state:n}),d=[];return n.doc.nodesBetween(r,i,(h,m)=>{if(!h.isTextblock||h.type.spec.code)return;const g=Math.max(r,m),v=Math.min(i,m+h.content.size),y=h.textBetween(g-m,v-m,void 0,"\uFFFC");L1t(y,a.find,s).forEach(_=>{if(_.index===void 0)return;const k=g+_.index+1,C=k+_[0].length,$={from:n.tr.mapping.map(k),to:n.tr.mapping.map(C)},N=a.handler({state:n,range:$,match:_,commands:l,chain:u,can:c,pasteEvent:s,dropEvent:o});d.push(N)})}),d.every(h=>h!==null)}const z1t=e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=n.clipboardData)===null||t===void 0||t.setData("text/html",e),n};function B1t(e){const{editor:t,rules:n}=e;let r=null,i=!1,a=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o=typeof DragEvent<"u"?new DragEvent("drop"):null;const l=({state:c,from:d,to:p,rule:h,pasteEvt:m})=>{const g=c.tr,v=ST({state:c,transaction:g});if(!(!F1t({editor:t,state:v,from:Math.max(d-1,0),to:p.b-1,rule:h,pasteEvent:m,dropEvent:o})||!g.steps.length))return o=typeof DragEvent<"u"?new DragEvent("drop"):null,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g};return n.map(c=>new Gs({view(d){const p=h=>{var m;r=!((m=d.dom.parentElement)===null||m===void 0)&&m.contains(h.target)?d.dom.parentElement:null};return window.addEventListener("dragstart",p),{destroy(){window.removeEventListener("dragstart",p)}}},props:{handleDOMEvents:{drop:(d,p)=>(a=r===d.dom.parentElement,o=p,!1),paste:(d,p)=>{var h;const m=(h=p.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return s=p,i=!!(m!=null&&m.includes("data-pm-slice")),!1}}},appendTransaction:(d,p,h)=>{const m=d[0],g=m.getMeta("uiEvent")==="paste"&&!i,v=m.getMeta("uiEvent")==="drop"&&!a,y=m.getMeta("applyPasteRules"),b=!!y;if(!g&&!v&&!b)return;if(b){const{from:C,text:$}=y,N=C+$.length,A=z1t($);return l({rule:c,state:h,from:C,to:{b:N},pasteEvt:A})}const _=p.doc.content.findDiffStart(h.doc.content),k=p.doc.content.findDiffEnd(h.doc.content);if(!(!R1t(_)||!k||_===k.b))return l({rule:c,state:h,from:_,to:k,pasteEvt:s})}}))}function W1t(e){const t=e.filter((n,r)=>e.indexOf(n)!==r);return[...new Set(t)]}class ug{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=ug.resolve(t),this.schema=O1t(this.extensions,n),this.setupExtensions()}static resolve(t){const n=ug.sort(ug.flatten(t)),r=W1t(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},i=ht(n,"addExtensions",r);return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(t){return t.sort((r,i)=>{const a=ht(r,"priority")||100,s=ht(i,"priority")||100;return a>s?-1:a<s?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:PE(n.name,this.schema)},i=ht(n,"addCommands",r);return i?{...t,...i()}:t},{})}get plugins(){const{editor:t}=this,n=ug.sort([...this.extensions].reverse()),r=[],i=[],a=n.map(s=>{const o={name:s.name,options:s.options,storage:s.storage,editor:t,type:PE(s.name,this.schema)},l=[],u=ht(s,"addKeyboardShortcuts",o);let c={};if(s.type==="mark"&&s.config.exitable&&(c.ArrowRight=()=>Ha.handleExit({editor:t,mark:s})),u){const g=Object.fromEntries(Object.entries(u()).map(([v,y])=>[v,()=>y({editor:t})]));c={...c,...g}}const d=n1t(c);l.push(d);const p=ht(s,"addInputRules",o);P8(s,t.options.enableInputRules)&&p&&r.push(...p());const h=ht(s,"addPasteRules",o);P8(s,t.options.enablePasteRules)&&h&&i.push(...h());const m=ht(s,"addProseMirrorPlugins",o);if(m){const g=m();l.push(...g)}return l}).flat();return[M1t({editor:t,rules:r}),...B1t({editor:t,rules:i}),...a]}get attributes(){return jce(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=IT(this.extensions);return Object.fromEntries(n.filter(r=>!!ht(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),a={name:r.name,options:r.options,storage:r.storage,editor:t,type:Mi(r.name,this.schema)},s=ht(r,"addNodeView",a);if(!s)return[];const o=(l,u,c,d)=>{const p=EA(l,i);return s()({editor:t,node:l,getPos:c,decorations:d,HTMLAttributes:p,extension:r})};return[r.name,o]}))}setupExtensions(){this.extensions.forEach(t=>{var n;this.editor.extensionStorage[t.name]=t.storage;const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:PE(t.name,this.schema)};t.type==="mark"&&((n=Qt(ht(t,"keepOnSplit",r)))!==null&&n!==void 0?n:!0)&&this.splittableMarks.push(t.name);const i=ht(t,"onBeforeCreate",r),a=ht(t,"onCreate",r),s=ht(t,"onUpdate",r),o=ht(t,"onSelectionUpdate",r),l=ht(t,"onTransaction",r),u=ht(t,"onFocus",r),c=ht(t,"onBlur",r),d=ht(t,"onDestroy",r);i&&this.editor.on("beforeCreate",i),a&&this.editor.on("create",a),s&&this.editor.on("update",s),o&&this.editor.on("selectionUpdate",o),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}}function V1t(e){return Object.prototype.toString.call(e).slice(8,-1)}function AE(e){return V1t(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function TT(e,t){const n={...e};return AE(e)&&AE(t)&&Object.keys(t).forEach(r=>{AE(t[r])?r in e?n[r]=TT(e[r],t[r]):Object.assign(n,{[r]:t[r]}):Object.assign(n,{[r]:t[r]})}),n}class wa{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Qt(ht(this,"addOptions",{name:this.name}))),this.storage=Qt(ht(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new wa(t)}configure(t={}){const n=this.extend();return n.parent=this.parent,n.options=TT(this.options,t),n.storage=Qt(ht(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new wa({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Qt(ht(n,"addOptions",{name:n.name})),n.storage=Qt(ht(n,"addStorage",{name:n.name,options:n.options})),n}}function Hce(e,t,n){const{from:r,to:i}=t,{blockSeparator:a=`

`,textSerializers:s={}}=n||{};let o="";return e.nodesBetween(r,i,(l,u,c,d)=>{var p;l.isBlock&&u>r&&(o+=a);const h=s==null?void 0:s[l.type.name];if(h)return c&&(o+=h({node:l,pos:u,parent:c,index:d,range:t})),!1;l.isText&&(o+=(p=l==null?void 0:l.text)===null||p===void 0?void 0:p.slice(Math.max(r,u)-u,i-u))}),o}function Gce(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const j1t=wa.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Gs({key:new Yu("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:i}=t,{ranges:a}=i,s=Math.min(...a.map(c=>c.$from.pos)),o=Math.max(...a.map(c=>c.$to.pos)),l=Gce(n);return Hce(r,{from:s,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),U1t=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),H1t=(e=!1)=>({commands:t})=>t.setContent("",e),G1t=()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:i}=r;return n&&i.forEach(({$from:a,$to:s})=>{e.doc.nodesBetween(a.pos,s.pos,(o,l)=>{if(o.type.isText)return;const{doc:u,mapping:c}=t,d=u.resolve(c.map(l)),p=u.resolve(c.map(l+o.nodeSize)),h=d.blockRange(p);if(!h)return;const m=n0(h);if(o.type.isTextblock){const{defaultType:g}=d.parent.contentMatchAt(d.index());t.setNodeMarkup(h.start,g)}(m||m===0)&&t.lift(h,m)})}),!0},q1t=e=>t=>e(t),K1t=()=>({state:e,dispatch:t})=>m1t(e,t),Z1t=(e,t)=>({editor:n,tr:r})=>{const{state:i}=n,a=i.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const s=r.mapping.map(t);return r.insert(s,a.content),r.setSelection(new Ht(r.doc.resolve(s-1))),!0},X1t=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;const i=e.selection.$anchor;for(let a=i.depth;a>0;a-=1)if(i.node(a).type===r.type){if(t){const o=i.before(a),l=i.after(a);e.delete(o,l).scrollIntoView()}return!0}return!1},J1t=e=>({tr:t,state:n,dispatch:r})=>{const i=Mi(e,n.schema),a=t.selection.$anchor;for(let s=a.depth;s>0;s-=1)if(a.node(s).type===i){if(r){const l=a.before(s),u=a.after(s);t.delete(l,u).scrollIntoView()}return!0}return!1},Y1t=e=>({tr:t,dispatch:n})=>{const{from:r,to:i}=e;return n&&t.delete(r,i),!0},Q1t=()=>({state:e,dispatch:t})=>r1t(e,t),ewt=()=>({commands:e})=>e.keyboardShortcut("Enter"),twt=()=>({state:e,dispatch:t})=>f1t(e,t);function AI(e,t,n={strict:!0}){const r=Object.keys(t);return r.length?r.every(i=>n.strict?t[i]===e[i]:S3(t[i])?t[i].test(e[i]):t[i]===e[i]):!0}function OA(e,t,n={}){return e.find(r=>r.type===t&&AI(r.attrs,n))}function nwt(e,t,n={}){return!!OA(e,t,n)}function C3(e,t,n={}){if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if(e.parentOffset===r.offset&&r.offset!==0&&(r=e.parent.childBefore(e.parentOffset)),!r.node)return;const i=OA([...r.node.marks],t,n);if(!i)return;let a=r.index,s=e.start()+r.offset,o=a+1,l=s+r.node.nodeSize;for(OA([...r.node.marks],t,n);a>0&&i.isInSet(e.parent.child(a-1).marks);)a-=1,s-=e.parent.child(a).nodeSize;for(;o<e.parent.childCount&&nwt([...e.parent.child(o).marks],t,n);)l+=e.parent.child(o).nodeSize,o+=1;return{from:s,to:l}}function qd(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}const rwt=(e,t={})=>({tr:n,state:r,dispatch:i})=>{const a=qd(e,r.schema),{doc:s,selection:o}=n,{$from:l,from:u,to:c}=o;if(i){const d=C3(l,a,t);if(d&&d.from<=u&&d.to>=c){const p=Ht.create(s,d.from,d.to);n.setSelection(p)}}return!0},iwt=e=>t=>{const n=typeof e=="function"?e(t):e;for(let r=0;r<n.length;r+=1)if(n[r](t))return!0;return!1};function qce(e){return e instanceof Ht}function Ip(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function Kce(e,t=null){if(!t)return null;const n=en.atStart(e),r=en.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return r;const i=n.from,a=r.to;return t==="all"?Ht.create(e,Ip(0,i,a),Ip(e.content.size,i,a)):Ht.create(e,Ip(t,i,a),Ip(t,i,a))}function I3(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const awt=(e=null,t={})=>({editor:n,view:r,tr:i,dispatch:a})=>{t={scrollIntoView:!0,...t};const s=()=>{I3()&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),t!=null&&t.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&e===null||e===!1)return!0;if(a&&e===null&&!qce(n.state.selection))return s(),!0;const o=Kce(i.doc,e)||n.state.selection,l=n.state.selection.eq(o);return a&&(l||i.setSelection(o),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},swt=(e,t)=>n=>e.every((r,i)=>t(r,{...n,index:i})),owt=(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),Zce=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const r=t[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):r.nodeType===1&&Zce(r)}return e};function A8(e){const t=`<body>${e}</body>`,n=new window.DOMParser().parseFromString(t,"text/html").body;return Zce(n)}function MI(e,t,n){n={slice:!0,parseOptions:{},...n};const r=typeof e=="object"&&e!==null,i=typeof e=="string";if(r)try{return Array.isArray(e)&&e.length>0?Ae.fromArray(e.map(s=>t.nodeFromJSON(s))):t.nodeFromJSON(e)}catch(a){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",a),MI("",t,n)}if(i){const a=hy.fromSchema(t);return n.slice?a.parseSlice(A8(e),n.parseOptions).content:a.parse(A8(e),n.parseOptions)}return MI("",t,n)}function lwt(e,t,n){const r=e.steps.length-1;if(r<t)return;const i=e.steps[r];if(!(i instanceof Ci||i instanceof Oi))return;const a=e.mapping.maps[r];let s=0;a.forEach((o,l,u,c)=>{s===0&&(s=c)}),e.setSelection(en.near(e.doc.resolve(s),n))}const uwt=e=>e.toString().startsWith("<"),cwt=(e,t,n)=>({tr:r,dispatch:i,editor:a})=>{if(i){n={parseOptions:{},updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};const s=MI(t,a.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if(s.toString()==="<>")return!0;let{from:o,to:l}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},u=!0,c=!0;if((uwt(s)?s:[s]).forEach(h=>{h.check(),u=u?h.isText&&h.marks.length===0:!1,c=c?h.isBlock:!1}),o===l&&c){const{parent:h}=r.doc.resolve(o);h.isTextblock&&!h.type.spec.code&&!h.childCount&&(o-=1,l+=1)}let p;u?(Array.isArray(t)?p=t.map(h=>h.text||"").join(""):typeof t=="object"&&!!t&&!!t.text?p=t.text:p=t,r.insertText(p,o,l)):(p=s,r.replaceWith(o,l,p)),n.updateSelection&&lwt(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:o,text:p}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:o,text:p})}return!0},dwt=()=>({state:e,dispatch:t})=>c1t(e,t),pwt=()=>({state:e,dispatch:t})=>d1t(e,t),hwt=()=>({state:e,dispatch:t})=>i1t(e,t),fwt=()=>({state:e,dispatch:t})=>l1t(e,t),mwt=()=>({tr:e,state:t,dispatch:n})=>{try{const r=vT(t.doc,t.selection.$from.pos,-1);return r==null?!1:(e.join(r,2),n&&n(e),!0)}catch{return!1}},gwt=()=>({state:e,dispatch:t,tr:n})=>{try{const r=vT(e.doc,e.selection.$from.pos,1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},ywt=()=>({state:e,dispatch:t})=>a1t(e,t),vwt=()=>({state:e,dispatch:t})=>s1t(e,t);function Xce(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function bwt(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let r,i,a,s;for(let o=0;o<t.length-1;o+=1){const l=t[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))I3()||Xce()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),s&&(n=`Meta-${n}`),a&&(n=`Shift-${n}`),n}const wwt=e=>({editor:t,view:n,tr:r,dispatch:i})=>{const a=bwt(e).split(/-(?!$)/),s=a.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),o=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,o))});return l==null||l.steps.forEach(u=>{const c=u.map(r.mapping);c&&i&&r.maybeStep(c)}),!0};function S1(e,t,n={}){const{from:r,to:i,empty:a}=e.selection,s=t?Mi(t,e.schema):null,o=[];e.doc.nodesBetween(r,i,(d,p)=>{if(d.isText)return;const h=Math.max(r,p),m=Math.min(i,p+d.nodeSize);o.push({node:d,from:h,to:m})});const l=i-r,u=o.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>AI(d.node.attrs,n,{strict:!1}));return a?!!u.length:u.reduce((d,p)=>d+p.to-p.from,0)>=l}const xwt=(e,t={})=>({state:n,dispatch:r})=>{const i=Mi(e,n.schema);return S1(n,i,t)?p1t(n,r):!1},_wt=()=>({state:e,dispatch:t})=>g1t(e,t),kwt=e=>({state:t,dispatch:n})=>{const r=Mi(e,t.schema);return S1t(r)(t,n)},Swt=()=>({state:e,dispatch:t})=>h1t(e,t);function NT(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function M8(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((r,i)=>(n.includes(i)||(r[i]=e[i]),r),{})}const Cwt=(e,t)=>({tr:n,state:r,dispatch:i})=>{let a=null,s=null;const o=NT(typeof e=="string"?e:e.name,r.schema);return o?(o==="node"&&(a=Mi(e,r.schema)),o==="mark"&&(s=qd(e,r.schema)),i&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(u,c)=>{a&&a===u.type&&n.setNodeMarkup(c,void 0,M8(u.attrs,t)),s&&u.marks.length&&u.marks.forEach(d=>{s===d.type&&n.addMark(c,c+u.nodeSize,s.create(M8(d.attrs,t)))})})}),!0):!1},Iwt=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),$wt=()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),Twt=()=>({state:e,dispatch:t})=>o1t(e,t),Nwt=()=>({state:e,dispatch:t})=>u1t(e,t),Ewt=()=>({state:e,dispatch:t})=>y1t(e,t),Owt=()=>({state:e,dispatch:t})=>w1t(e,t),Pwt=()=>({state:e,dispatch:t})=>b1t(e,t);function Jce(e,t,n={}){return MI(e,t,{slice:!1,parseOptions:n})}const Awt=(e,t=!1,n={})=>({tr:r,editor:i,dispatch:a})=>{const{doc:s}=r,o=Jce(e,i.schema,n);return a&&r.replaceWith(0,s.content.size,o).setMeta("preventUpdate",!t),!0};function Qw(e,t){const n=qd(t,e.schema),{from:r,to:i,empty:a}=e.selection,s=[];a?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const o=s.find(l=>l.type.name===n.name);return o?{...o.attrs}:{}}function Mwt(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Rwt(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}function $3(e){return t=>Rwt(t.$from,e)}function Dwt(e,t){const n=Pl.fromSchema(t).serializeFragment(e),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}function Lwt(e,t){const n={from:0,to:e.content.size};return Hce(e,n,t)}function Fwt(e,t){const n=Mi(t,e.schema),{from:r,to:i}=e.selection,a=[];e.doc.nodesBetween(r,i,o=>{a.push(o)});const s=a.reverse().find(o=>o.type.name===n.name);return s?{...s.attrs}:{}}function zwt(e,t){const n=NT(typeof t=="string"?t:t.name,e.schema);return n==="node"?Fwt(e,t):n==="mark"?Qw(e,t):{}}function Yce(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(i=>{const a=n.resolve(e-1),s=C3(a,i.type);!s||r.push({mark:i,...s})}):n.nodesBetween(e,t,(i,a)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(s=>({from:a,to:a+i.nodeSize,mark:s})))}),r}function mk(e,t,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=e.find(a=>a.type===t&&a.name===r);return i?i.attribute.keepOnSplit:!1}))}function PA(e,t,n={}){const{empty:r,ranges:i}=e.selection,a=t?qd(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(d=>a?a.name===d.type.name:!0).find(d=>AI(d.attrs,n,{strict:!1}));let s=0;const o=[];if(i.forEach(({$from:d,$to:p})=>{const h=d.pos,m=p.pos;e.doc.nodesBetween(h,m,(g,v)=>{if(!g.isText&&!g.marks.length)return;const y=Math.max(h,v),b=Math.min(m,v+g.nodeSize),_=b-y;s+=_,o.push(...g.marks.map(k=>({mark:k,from:y,to:b})))})}),s===0)return!1;const l=o.filter(d=>a?a.name===d.mark.type.name:!0).filter(d=>AI(d.mark.attrs,n,{strict:!1})).reduce((d,p)=>d+p.to-p.from,0),u=o.filter(d=>a?d.mark.type!==a&&d.mark.type.excludes(a):!0).reduce((d,p)=>d+p.to-p.from,0);return(l>0?l+u:l)>=s}function Bwt(e,t,n={}){if(!t)return S1(e,null,n)||PA(e,null,n);const r=NT(t,e.schema);return r==="node"?S1(e,t,n):r==="mark"?PA(e,t,n):!1}function R8(e,t){const{nodeExtensions:n}=IT(t),r=n.find(s=>s.name===e);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},a=Qt(ht(r,"group",i));return typeof a!="string"?!1:a.split(" ").includes("list")}function Wwt(e){var t;const n=(t=e.type.createAndFill())===null||t===void 0?void 0:t.toJSON(),r=e.toJSON();return JSON.stringify(n)===JSON.stringify(r)}function Vwt(e,t,n){var r;const{selection:i}=t;let a=null;if(qce(i)&&(a=i.$cursor),a){const o=(r=e.storedMarks)!==null&&r!==void 0?r:a.marks();return!!n.isInSet(o)||!o.some(l=>l.type.excludes(n))}const{ranges:s}=i;return s.some(({$from:o,$to:l})=>{let u=o.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(o.pos,l.pos,(c,d,p)=>{if(u)return!1;if(c.isInline){const h=!p||p.type.allowsMarkType(n),m=!!n.isInSet(c.marks)||!c.marks.some(g=>g.type.excludes(n));u=h&&m}return!u}),u})}const jwt=(e,t={})=>({tr:n,state:r,dispatch:i})=>{const{selection:a}=n,{empty:s,ranges:o}=a,l=qd(e,r.schema);if(i)if(s){const u=Qw(r,l);n.addStoredMark(l.create({...u,...t}))}else o.forEach(u=>{const c=u.$from.pos,d=u.$to.pos;r.doc.nodesBetween(c,d,(p,h)=>{const m=Math.max(h,c),g=Math.min(h+p.nodeSize,d);p.marks.find(y=>y.type===l)?p.marks.forEach(y=>{l===y.type&&n.addMark(m,g,l.create({...y.attrs,...t}))}):n.addMark(m,g,l.create(t))})});return Vwt(r,n,l)},Uwt=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),Hwt=(e,t={})=>({state:n,dispatch:r,chain:i})=>{const a=Mi(e,n.schema);return a.isTextblock?i().command(({commands:s})=>N8(a,t)(n)?!0:s.clearNodes()).command(({state:s})=>N8(a,t)(s,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Gwt=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,i=Ip(e,0,r.content.size),a=It.create(r,i);t.setSelection(a)}return!0},qwt=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,{from:i,to:a}=typeof e=="number"?{from:e,to:e}:e,s=Ht.atStart(r).from,o=Ht.atEnd(r).to,l=Ip(i,s,o),u=Ip(a,s,o),c=Ht.create(r,l,u);t.setSelection(c)}return!0},Kwt=e=>({state:t,dispatch:n})=>{const r=Mi(e,t.schema);return $1t(r)(t,n)};function D8(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(i=>t==null?void 0:t.includes(i.type.name));e.tr.ensureMarks(r)}}const Zwt=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:i})=>{const{selection:a,doc:s}=t,{$from:o,$to:l}=a,u=i.extensionManager.attributes,c=mk(u,o.node().type.name,o.node().attrs);if(a instanceof It&&a.node.isBlock)return!o.parentOffset||!Eg(s,o.pos)?!1:(r&&(e&&D8(n,i.extensionManager.splittableMarks),t.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;if(r){const d=l.parentOffset===l.parent.content.size;a instanceof Ht&&t.deleteSelection();const p=o.depth===0?void 0:Mwt(o.node(-1).contentMatchAt(o.indexAfter(-1)));let h=d&&p?[{type:p,attrs:c}]:void 0,m=Eg(t.doc,t.mapping.map(o.pos),1,h);if(!h&&!m&&Eg(t.doc,t.mapping.map(o.pos),1,p?[{type:p}]:void 0)&&(m=!0,h=p?[{type:p,attrs:c}]:void 0),m&&(t.split(t.mapping.map(o.pos),1,h),p&&!d&&!o.parentOffset&&o.parent.type!==p)){const g=t.mapping.map(o.before()),v=t.doc.resolve(g);o.node(-1).canReplaceWith(v.index(),v.index()+1,p)&&t.setNodeMarkup(t.mapping.map(o.before()),p)}e&&D8(n,i.extensionManager.splittableMarks),t.scrollIntoView()}return!0},Xwt=e=>({tr:t,state:n,dispatch:r,editor:i})=>{var a;const s=Mi(e,n.schema),{$from:o,$to:l}=n.selection,u=n.selection.node;if(u&&u.isBlock||o.depth<2||!o.sameParent(l))return!1;const c=o.node(-1);if(c.type!==s)return!1;const d=i.extensionManager.attributes;if(o.parent.content.size===0&&o.node(-1).childCount===o.indexAfter(-1)){if(o.depth===2||o.node(-3).type!==s||o.index(-2)!==o.node(-2).childCount-1)return!1;if(r){let v=Ae.empty;const y=o.index(-1)?1:o.index(-2)?2:3;for(let N=o.depth-y;N>=o.depth-3;N-=1)v=Ae.from(o.node(N).copy(v));const b=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3,_=mk(d,o.node().type.name,o.node().attrs),k=((a=s.contentMatch.defaultType)===null||a===void 0?void 0:a.createAndFill(_))||void 0;v=v.append(Ae.from(s.createAndFill(null,k)||void 0));const C=o.before(o.depth-(y-1));t.replace(C,o.after(-b),new Qe(v,4-y,0));let $=-1;t.doc.nodesBetween(C,t.doc.content.size,(N,A)=>{if($>-1)return!1;N.isTextblock&&N.content.size===0&&($=A+1)}),$>-1&&t.setSelection(Ht.near(t.doc.resolve($))),t.scrollIntoView()}return!0}const p=l.pos===o.end()?c.contentMatchAt(0).defaultType:null,h=mk(d,c.type.name,c.attrs),m=mk(d,o.node().type.name,o.node().attrs);t.delete(o.pos,l.pos);const g=p?[{type:s,attrs:h},{type:p,attrs:m}]:[{type:s,attrs:h}];if(!Eg(t.doc,o.pos,2))return!1;if(r){const{selection:v,storedMarks:y}=n,{splittableMarks:b}=i.extensionManager,_=y||v.$to.parentOffset&&v.$from.marks();if(t.split(o.pos,2,g).scrollIntoView(),!_||!r)return!0;const k=_.filter(C=>b.includes(C.type.name));t.ensureMarks(k)}return!0},ME=(e,t)=>{const n=$3(s=>s.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=e.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Hd(e.doc,n.pos)&&e.join(n.pos),!0},RE=(e,t)=>{const n=$3(s=>s.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=e.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Hd(e.doc,r)&&e.join(r),!0},Jwt=(e,t,n,r={})=>({editor:i,tr:a,state:s,dispatch:o,chain:l,commands:u,can:c})=>{const{extensions:d,splittableMarks:p}=i.extensionManager,h=Mi(e,s.schema),m=Mi(t,s.schema),{selection:g,storedMarks:v}=s,{$from:y,$to:b}=g,_=y.blockRange(b),k=v||g.$to.parentOffset&&g.$from.marks();if(!_)return!1;const C=$3($=>R8($.type.name,d))(g);if(_.depth>=1&&C&&_.depth-C.depth<=1){if(C.node.type===h)return u.liftListItem(m);if(R8(C.node.type.name,d)&&h.validContent(C.node.content)&&o)return l().command(()=>(a.setNodeMarkup(C.pos,h),!0)).command(()=>ME(a,h)).command(()=>RE(a,h)).run()}return!n||!k||!o?l().command(()=>c().wrapInList(h,r)?!0:u.clearNodes()).wrapInList(h,r).command(()=>ME(a,h)).command(()=>RE(a,h)).run():l().command(()=>{const $=c().wrapInList(h,r),N=k.filter(A=>p.includes(A.type.name));return a.ensureMarks(N),$?!0:u.clearNodes()}).wrapInList(h,r).command(()=>ME(a,h)).command(()=>RE(a,h)).run()},Ywt=(e,t={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:a=!1}=n,s=qd(e,r.schema);return PA(r,s,t)?i.unsetMark(s,{extendEmptyMarkRange:a}):i.setMark(s,t)},Qwt=(e,t,n={})=>({state:r,commands:i})=>{const a=Mi(e,r.schema),s=Mi(t,r.schema);return S1(r,a,n)?i.setNode(s):i.setNode(a,n)},ext=(e,t={})=>({state:n,commands:r})=>{const i=Mi(e,n.schema);return S1(n,i,t)?r.lift(i):r.wrapIn(i,t)},txt=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let a;if(i.spec.isInputRules&&(a=i.getState(e))){if(t){const s=e.tr,o=a.transform;for(let l=o.steps.length-1;l>=0;l-=1)s.step(o.steps[l].invert(o.docs[l]));if(a.text){const l=s.doc.resolve(a.from).marks();s.replaceWith(a.from,a.to,e.schema.text(a.text,l))}else s.delete(a.from,a.to)}return!0}}return!1},nxt=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:r,ranges:i}=n;return r||t&&i.forEach(a=>{e.removeMark(a.$from.pos,a.$to.pos)}),!0},rxt=(e,t={})=>({tr:n,state:r,dispatch:i})=>{var a;const{extendEmptyMarkRange:s=!1}=t,{selection:o}=n,l=qd(e,r.schema),{$from:u,empty:c,ranges:d}=o;if(!i)return!0;if(c&&s){let{from:p,to:h}=o;const m=(a=u.marks().find(v=>v.type===l))===null||a===void 0?void 0:a.attrs,g=C3(u,l,m);g&&(p=g.from,h=g.to),n.removeMark(p,h,l)}else d.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,l)});return n.removeStoredMark(l),!0},ixt=(e,t={})=>({tr:n,state:r,dispatch:i})=>{let a=null,s=null;const o=NT(typeof e=="string"?e:e.name,r.schema);return o?(o==="node"&&(a=Mi(e,r.schema)),o==="mark"&&(s=qd(e,r.schema)),i&&n.selection.ranges.forEach(l=>{const u=l.$from.pos,c=l.$to.pos;r.doc.nodesBetween(u,c,(d,p)=>{a&&a===d.type&&n.setNodeMarkup(p,void 0,{...d.attrs,...t}),s&&d.marks.length&&d.marks.forEach(h=>{if(s===h.type){const m=Math.max(p,u),g=Math.min(p+d.nodeSize,c);n.addMark(m,g,s.create({...h.attrs,...t}))}})})}),!0):!1},axt=(e,t={})=>({state:n,dispatch:r})=>{const i=Mi(e,n.schema);return x1t(i,t)(n,r)},sxt=(e,t={})=>({state:n,dispatch:r})=>{const i=Mi(e,n.schema);return _1t(i,t)(n,r)};var oxt=Object.freeze({__proto__:null,blur:U1t,clearContent:H1t,clearNodes:G1t,command:q1t,createParagraphNear:K1t,cut:Z1t,deleteCurrentNode:X1t,deleteNode:J1t,deleteRange:Y1t,deleteSelection:Q1t,enter:ewt,exitCode:twt,extendMarkRange:rwt,first:iwt,focus:awt,forEach:swt,insertContent:owt,insertContentAt:cwt,joinUp:dwt,joinDown:pwt,joinBackward:hwt,joinForward:fwt,joinItemBackward:mwt,joinItemForward:gwt,joinTextblockBackward:ywt,joinTextblockForward:vwt,keyboardShortcut:wwt,lift:xwt,liftEmptyBlock:_wt,liftListItem:kwt,newlineInCode:Swt,resetAttributes:Cwt,scrollIntoView:Iwt,selectAll:$wt,selectNodeBackward:Twt,selectNodeForward:Nwt,selectParentNode:Ewt,selectTextblockEnd:Owt,selectTextblockStart:Pwt,setContent:Awt,setMark:jwt,setMeta:Uwt,setNode:Hwt,setNodeSelection:Gwt,setTextSelection:qwt,sinkListItem:Kwt,splitBlock:Zwt,splitListItem:Xwt,toggleList:Jwt,toggleMark:Ywt,toggleNode:Qwt,toggleWrap:ext,undoInputRule:txt,unsetAllMarks:nxt,unsetMark:rxt,updateAttributes:ixt,wrapIn:axt,wrapInList:sxt});const lxt=wa.create({name:"commands",addCommands(){return{...oxt}}}),uxt=wa.create({name:"editable",addProseMirrorPlugins(){return[new Gs({key:new Yu("editable"),props:{editable:()=>this.editor.options.editable}})]}}),cxt=wa.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new Gs({key:new Yu("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),dxt=wa.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:o})=>{const{selection:l,doc:u}=o,{empty:c,$anchor:d}=l,{pos:p,parent:h}=d,m=d.parent.isTextblock&&p>0?o.doc.resolve(p-1):d,g=m.parent.type.spec.isolating,v=d.pos-d.parentOffset,y=g&&m.parent.childCount===1?v===d.pos:en.atStart(u).from===p;return!c||!h.type.isTextblock||h.textContent.length||!y||y&&d.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},a={...r,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return I3()||Xce()?a:i},addProseMirrorPlugins(){return[new Gs({key:new Yu("clearDocument"),appendTransaction:(e,t,n)=>{if(!(e.some(m=>m.docChanged)&&!t.doc.eq(n.doc)))return;const{empty:i,from:a,to:s}=t.selection,o=en.atStart(t.doc).from,l=en.atEnd(t.doc).to;if(i||!(a===o&&s===l)||!(n.doc.textBetween(0,n.doc.content.size," "," ").length===0))return;const d=n.tr,p=ST({state:n,transaction:d}),{commands:h}=new CT({editor:this.editor,state:p});if(h.clearNodes(),!!d.steps.length)return d}})]}}),pxt=wa.create({name:"tabindex",addProseMirrorPlugins(){return[new Gs({key:new Yu("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});class vp{constructor(t,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=t,this.editor=n,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!==null&&t!==void 0?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new vp(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new vp(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new vp(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,a=this.pos+r+1,s=this.resolvedPos.doc.resolve(a);if(!i&&s.depth<=this.depth)return;const o=new vp(s,this.editor,i,i?n:null);i&&(o.actualDepth=this.depth+1),t.push(new vp(s,this.editor,i,i?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===t)if(Object.keys(n).length>0){const a=i.node.attrs,s=Object.keys(n);for(let o=0;o<s.length;o+=1){const l=s[o];if(a[l]!==n[l])break}}else r=i;i=i.parent}return r}querySelector(t,n={}){return this.querySelectorAll(t,n,!0)[0]||null}querySelectorAll(t,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const a=Object.keys(n);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===t&&a.every(l=>n[l]===s.node.attrs[l])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(t,n,r))))}),i}setAttribute(t){const n=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,t).setTextSelection(n.from).run()}}const hxt=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function fxt(e,t,n){const r=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(r!==null)return r;const i=document.createElement("style");return t&&i.setAttribute("nonce",t),i.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),i.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(i),i}class mxt extends T1t{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=fxt(hxt,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,n=!0){this.setOptions({editable:t}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const r=Uce(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],i=this.state.reconfigure({plugins:r});this.view.updateState(i)}unregisterPlugin(t){if(this.isDestroyed)return;const n=typeof t=="string"?`${t}$`:t.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(n))});this.view.updateState(r)}createExtensionManager(){var t,n;const i=[...this.options.enableCoreExtensions?[uxt,j1t.configure({blockSeparator:(n=(t=this.options.coreExtensionOptions)===null||t===void 0?void 0:t.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),lxt,cxt,dxt,pxt]:[],...this.options.extensions].filter(a=>["extension","node","mark"].includes(a==null?void 0:a.type));this.extensionManager=new ug(i,this)}createCommandManager(){this.commandManager=new CT({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=Jce(this.options.content,this.schema,this.options.parseOptions),n=Kce(t,this.options.autofocus);this.view=new qbt(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:lg.create({doc:t,selection:n||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(s=>{var o;return(o=this.capturedTransaction)===null||o===void 0?void 0:o.step(s)});return}const n=this.state.apply(t),r=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=t.getMeta("focus"),a=t.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:t}),a&&this.emit("blur",{editor:this,event:a.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return zwt(this.state,t)}isActive(t,n){const r=typeof t=="string"?t:null,i=typeof t=="string"?n:t;return Bwt(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Dwt(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:r={}}=t||{};return Lwt(this.state.doc,{blockSeparator:n,textSerializers:{...Gce(this.schema),...r}})}get isEmpty(){return Wwt(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}$node(t,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(t,n))||null}$nodes(t,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(t,n))||null}$pos(t){const n=this.state.doc.resolve(t);return new vp(n,this)}get $doc(){return this.$pos(0)}}function _h(e){return new $T({find:e.find,handler:({state:t,range:n,match:r})=>{const i=Qt(e.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:a}=t,s=r[r.length-1],o=r[0];if(s){const l=o.search(/\S/),u=n.from+o.indexOf(s),c=u+s.length;if(Yce(n.from,n.to,t.doc).filter(h=>h.mark.type.excluded.find(g=>g===e.type&&g!==h.mark.type)).filter(h=>h.to>u).length)return null;c<n.to&&a.delete(c,n.to),u>n.from&&a.delete(n.from+l,u);const p=n.from+l+s.length;a.addMark(n.from+l,p,e.type.create(i||{})),a.removeStoredMark(e.type)}}})}function Qce(e){return new $T({find:e.find,handler:({state:t,range:n,match:r})=>{const i=Qt(e.getAttributes,void 0,r)||{},{tr:a}=t,s=n.from;let o=n.to;const l=e.type.create(i);if(r[1]){const u=r[0].lastIndexOf(r[1]);let c=s+u;c>o?c=o:o=c+r[1].length;const d=r[0][r[0].length-1];a.insertText(d,s+r[0].length-1),a.replaceWith(c,o,l)}else r[0]&&a.insert(s-1,e.type.create(i)).delete(a.mapping.map(s),a.mapping.map(o));a.scrollIntoView()}})}function AA(e){return new $T({find:e.find,handler:({state:t,range:n,match:r})=>{const i=t.doc.resolve(n.from),a=Qt(e.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,a)}})}function C1(e){return new $T({find:e.find,handler:({state:t,range:n,match:r,chain:i})=>{const a=Qt(e.getAttributes,void 0,r)||{},s=t.tr.delete(n.from,n.to),l=s.doc.resolve(n.from).blockRange(),u=l&&p3(l,e.type,a);if(!u)return null;if(s.wrap(l,u),e.keepMarks&&e.editor){const{selection:d,storedMarks:p}=t,{splittableMarks:h}=e.editor.extensionManager,m=p||d.$to.parentOffset&&d.$from.marks();if(m){const g=m.filter(v=>h.includes(v.type.name));s.ensureMarks(g)}}if(e.keepAttributes){const d=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,a).run()}const c=s.doc.resolve(n.from-1).nodeBefore;c&&c.type===e.type&&Hd(s.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,c))&&s.join(n.from-1)}})}class Ha{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Qt(ht(this,"addOptions",{name:this.name}))),this.storage=Qt(ht(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Ha(t)}configure(t={}){const n=this.extend();return n.options=TT(this.options,t),n.storage=Qt(ht(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new Ha({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Qt(ht(n,"addOptions",{name:n.name})),n.storage=Qt(ht(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:t,mark:n}){const{tr:r}=t.state,i=t.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const l=s.find(u=>(u==null?void 0:u.type.name)===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),t.view.dispatch(r),!0}return!1}}class ea{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Qt(ht(this,"addOptions",{name:this.name}))),this.storage=Qt(ht(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new ea(t)}configure(t={}){const n=this.extend();return n.options=TT(this.options,t),n.storage=Qt(ht(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new ea({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Qt(ht(n,"addOptions",{name:n.name})),n.storage=Qt(ht(n,"addStorage",{name:n.name,options:n.options})),n}}function kh(e){return new D1t({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:i})=>{const a=Qt(e.getAttributes,void 0,r,i);if(a===!1||a===null)return null;const{tr:s}=t,o=r[r.length-1],l=r[0];let u=n.to;if(o){const c=l.search(/\S/),d=n.from+l.indexOf(o),p=d+o.length;if(Yce(n.from,n.to,t.doc).filter(m=>m.mark.type.excluded.find(v=>v===e.type&&v!==m.mark.type)).filter(m=>m.to>d).length)return null;p<n.to&&s.delete(p,n.to),d>n.from&&s.delete(n.from+c,d),u=n.from+c+o.length,s.addMark(n.from+c,u,e.type.create(a||{})),s.removeStoredMark(e.type)}}})}const gxt=(...e)=>t=>{e.forEach(n=>{typeof n=="function"?n(t):n&&(n.current=t)})},yxt=({renderers:e})=>x(ze,{children:Object.entries(e).map(([t,n])=>V9.createPortal(n.reactElement,n.element,t))});class vxt extends Ni.Component{constructor(t){super(t),this.editorContentRef=Ni.createRef(),this.initialized=!1,this.state={renderers:{}}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const{editor:t}=this.props;if(t&&t.options.element){if(t.contentComponent)return;const n=this.editorContentRef.current;n.append(...t.options.element.childNodes),t.setOptions({element:n}),t.contentComponent=this,t.createNodeViews(),this.initialized=!0}}maybeFlushSync(t){this.initialized?ql.exports.flushSync(t):t()}setRenderer(t,n){this.maybeFlushSync(()=>{this.setState(({renderers:r})=>({renderers:{...r,[t]:n}}))})}removeRenderer(t){this.maybeFlushSync(()=>{this.setState(({renderers:n})=>{const r={...n};return delete r[t],{renderers:r}})})}componentWillUnmount(){const{editor:t}=this.props;if(!t||(this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),t.contentComponent=null,!t.options.element.firstChild))return;const n=document.createElement("div");n.append(...t.options.element.childNodes),t.setOptions({element:n})}render(){const{editor:t,innerRef:n,...r}=this.props;return B(ze,{children:[x("div",{ref:gxt(n,this.editorContentRef),...r}),x(yxt,{renderers:this.state.renderers})]})}}const bxt=I.exports.forwardRef((e,t)=>{const n=Ni.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[e.editor]);return x(vxt,{innerRef:t,...e},n)}),wxt=Ni.memo(bxt);class xxt extends mxt{constructor(){super(...arguments),this.contentComponent=null}}const om=(e={},t=[])=>{const n=I.exports.useRef(null),[,r]=I.exports.useState({}),{onBeforeCreate:i,onBlur:a,onCreate:s,onDestroy:o,onFocus:l,onSelectionUpdate:u,onTransaction:c,onUpdate:d}=e,p=I.exports.useRef(i),h=I.exports.useRef(a),m=I.exports.useRef(s),g=I.exports.useRef(o),v=I.exports.useRef(l),y=I.exports.useRef(u),b=I.exports.useRef(c),_=I.exports.useRef(d);return I.exports.useEffect(()=>{!n.current||(i&&(n.current.off("beforeCreate",p.current),n.current.on("beforeCreate",i),p.current=i),a&&(n.current.off("blur",h.current),n.current.on("blur",a),h.current=a),s&&(n.current.off("create",m.current),n.current.on("create",s),m.current=s),o&&(n.current.off("destroy",g.current),n.current.on("destroy",o),g.current=o),l&&(n.current.off("focus",v.current),n.current.on("focus",l),v.current=l),u&&(n.current.off("selectionUpdate",y.current),n.current.on("selectionUpdate",u),y.current=u),c&&(n.current.off("transaction",b.current),n.current.on("transaction",c),b.current=c),d&&(n.current.off("update",_.current),n.current.on("update",d),_.current=d))},[i,a,s,o,l,u,c,d,n.current]),I.exports.useEffect(()=>{let k=!0;const C=new xxt(e);return n.current=C,n.current.on("transaction",()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{k&&r({})})})}),()=>{k=!1,C.destroy()}},t),n.current},_xt=I.exports.createContext({editor:null});_xt.Consumer;const kxt=I.exports.createContext({onDragStart:void 0}),Sxt=()=>I.exports.useContext(kxt);Ni.forwardRef((e,t)=>{const{onDragStart:n}=Sxt(),r=e.as||"div";return x(r,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})});const Cxt=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,Ixt=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,lm=Ha.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:e=>e.getAttribute("data-color")||e.style.backgroundColor,renderHTML:e=>e.color?{"data-color":e.color,style:`background-color: ${e.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:e}){return["mark",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{setHighlight:e=>({commands:t})=>t.setMark(this.name,e),toggleHighlight:e=>({commands:t})=>t.toggleMark(this.name,e),unsetHighlight:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[_h({find:Cxt,type:this.type})]},addPasteRules(){return[kh({find:Ixt,type:this.type})]}}),$xt=/^\s*>\s$/,Txt=ea.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[C1({find:$xt,type:this.type})]}}),Nxt=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Ext=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Oxt=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Pxt=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Axt=Ha.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[_h({find:Nxt,type:this.type}),_h({find:Oxt,type:this.type})]},addPasteRules(){return[kh({find:Ext,type:this.type}),kh({find:Pxt,type:this.type})]}}),Mxt=ea.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",mr(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),L8=Ha.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=Qw(e,this.type);return Object.entries(n).some(([,i])=>!!i)?!0:t.unsetMark(this.name)}}}}),F8=/^\s*([-+*])\s$/,Rxt=ea.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Mxt.name,this.editor.getAttributes(L8.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=C1({find:F8,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=C1({find:F8,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(L8.name),editor:this.editor})),[e]}}),Dxt=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))$/,Lxt=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))/g,Fxt=Ha.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[_h({find:Dxt,type:this.type})]},addPasteRules(){return[kh({find:Lxt,type:this.type})]}}),zxt=/^```([a-z]+)?[\s\n]$/,Bxt=/^~~~([a-z]+)?[\s\n]$/,Wxt=ea.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,a=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(s=>s.startsWith(n)).map(s=>s.replace(n,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",mr(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const a=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!a||!s?!1:e.chain().command(({tr:o})=>(o.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:r}=t,{$from:i,empty:a}=n;if(!a||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const o=i.after();return o===void 0||r.nodeAt(o)?!1:e.commands.exitCode()}}},addInputRules(){return[AA({find:zxt,type:this.type,getAttributes:e=>({language:e[1]})}),AA({find:Bxt,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Gs({key:new Yu("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,a=i==null?void 0:i.mode;if(!n||!a)return!1;const{tr:s}=e.state;return e.state.selection.from===e.state.doc.nodeSize-(1+e.state.selection.$to.depth*2)?s.insert(e.state.selection.from-1,this.type.create({language:a})):s.replaceSelectionWith(this.type.create({language:a})),s.setSelection(Ht.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.insertText(n.replace(/\r\n?/g,`
`)),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),Vxt=ea.create({name:"doc",topNode:!0,content:"block+"});function jxt(e={}){return new Gs({view(t){return new Uxt(t,e)}})}class Uxt{constructor(t,n){var r;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let a=s=>{this[i](s)};return t.dom.addEventListener(i,a),{name:i,handler:a}})}destroy(){this.handlers.forEach(({name:t,handler:n})=>this.editorView.dom.removeEventListener(t,n))}update(t,n){this.cursorPos!=null&&n.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent,r;if(n){let o=t.nodeBefore,l=t.nodeAfter;if(o||l){let u=this.editorView.nodeDOM(this.cursorPos-(o?o.nodeSize:0));if(u){let c=u.getBoundingClientRect(),d=o?c.bottom:c.top;o&&l&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:c.left,right:c.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!r){let o=this.editorView.coordsAtPos(this.cursorPos);r={left:o.left-this.width/2,right:o.left+this.width/2,top:o.top,bottom:o.bottom}}let i=this.editorView.dom.offsetParent;this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let a,s;if(!i||i==document.body&&getComputedStyle(i).position=="static")a=-pageXOffset,s=-pageYOffset;else{let o=i.getBoundingClientRect();a=o.left-i.scrollLeft,s=o.top-i.scrollTop}this.element.style.left=r.left-a+"px",this.element.style.top=r.top-s+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,a=typeof i=="function"?i(this.editorView,n,t):i;if(n&&!a){let s=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=Xue(this.editorView.state.doc,s,this.editorView.dragging.slice);o!=null&&(s=o)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){(t.target==this.editorView.dom||!this.editorView.dom.contains(t.relatedTarget))&&this.setCursor(null)}}const Hxt=wa.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[jxt(this.options)]}});class Or extends en{constructor(t){super(t,t)}map(t,n){let r=t.resolve(n.map(this.head));return Or.valid(r)?new Or(r):en.near(r)}content(){return Qe.empty}eq(t){return t instanceof Or&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Or(t.resolve(n.pos))}getBookmark(){return new T3(this.anchor)}static valid(t){let n=t.parent;if(n.isTextblock||!Gxt(t)||!qxt(t))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(t.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(t,n,r=!1){e:for(;;){if(!r&&Or.valid(t))return t;let i=t.pos,a=null;for(let s=t.depth;;s--){let o=t.node(s);if(n>0?t.indexAfter(s)<o.childCount:t.index(s)>0){a=o.child(n>0?t.indexAfter(s):t.index(s)-1);break}else if(s==0)return null;i+=n;let l=t.doc.resolve(i);if(Or.valid(l))return l}for(;;){let s=n>0?a.firstChild:a.lastChild;if(!s){if(a.isAtom&&!a.isText&&!It.isSelectable(a)){t=t.doc.resolve(i+a.nodeSize*n),r=!1;continue e}break}a=s,i+=n;let o=t.doc.resolve(i);if(Or.valid(o))return o}return null}}}Or.prototype.visible=!1;Or.findFrom=Or.findGapCursorFrom;en.jsonID("gapcursor",Or);class T3{constructor(t){this.pos=t}map(t){return new T3(t.map(this.pos))}resolve(t){let n=t.resolve(this.pos);return Or.valid(n)?new Or(n):en.near(n)}}function Gxt(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function qxt(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Kxt(){return new Gs({props:{decorations:Yxt,createSelectionBetween(e,t,n){return t.pos==n.pos&&Or.valid(n)?new Or(n):null},handleClick:Xxt,handleKeyDown:Zxt,handleDOMEvents:{beforeinput:Jxt}}})}const Zxt=Dce({ArrowLeft:T_("horiz",-1),ArrowRight:T_("horiz",1),ArrowUp:T_("vert",-1),ArrowDown:T_("vert",1)});function T_(e,t){const n=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(r,i,a){let s=r.selection,o=t>0?s.$to:s.$from,l=s.empty;if(s instanceof Ht){if(!a.endOfTextblock(n)||o.depth==0)return!1;l=!1,o=r.doc.resolve(t>0?o.after():o.before())}let u=Or.findGapCursorFrom(o,t,l);return u?(i&&i(r.tr.setSelection(new Or(u))),!0):!1}}function Xxt(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!Or.valid(r))return!1;let i=e.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&It.isSelectable(e.state.doc.nodeAt(i.inside))?!1:(e.dispatch(e.state.tr.setSelection(new Or(r))),!0)}function Jxt(e,t){if(t.inputType!="insertCompositionText"||!(e.state.selection instanceof Or))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let i=Ae.empty;for(let s=r.length-1;s>=0;s--)i=Ae.from(r[s].createAndFill(null,i));let a=e.state.tr.replace(n.pos,n.pos,new Qe(i,0,0));return a.setSelection(Ht.near(a.doc.resolve(n.pos+1))),e.dispatch(a),!1}function Yxt(e){if(!(e.selection instanceof Or))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",ci.create(e.doc,[ao.widget(e.selection.head,t,{key:"gapcursor"})])}const Qxt=wa.create({name:"gapCursor",addProseMirrorPlugins(){return[Kxt()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=Qt(ht(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),e_t=ea.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",mr(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:i,storedMarks:a}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=r.extensionManager,l=a||i.$to.parentOffset&&i.$from.marks();return t().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&l&&s){const d=l.filter(p=>o.includes(p.type.name));u.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),t_t=ea.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,mr(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>AA({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var RI=200,Pi=function(){};Pi.prototype.append=function(t){return t.length?(t=Pi.from(t),!this.length&&t||t.length<RI&&this.leafAppend(t)||this.length<RI&&t.leafPrepend(this)||this.appendInner(t)):this};Pi.prototype.prepend=function(t){return t.length?Pi.from(t).append(this):this};Pi.prototype.appendInner=function(t){return new n_t(this,t)};Pi.prototype.slice=function(t,n){return t===void 0&&(t=0),n===void 0&&(n=this.length),t>=n?Pi.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,n))};Pi.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};Pi.prototype.forEach=function(t,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(t,n,r,0):this.forEachInvertedInner(t,n,r,0)};Pi.prototype.map=function(t,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(a,s){return i.push(t(a,s))},n,r),i};Pi.from=function(t){return t instanceof Pi?t:t&&t.length?new ede(t):Pi.empty};var ede=function(e){function t(r){e.call(this),this.values=r}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(i,a){return i==0&&a==this.length?this:new t(this.values.slice(i,a))},t.prototype.getInner=function(i){return this.values[i]},t.prototype.forEachInner=function(i,a,s,o){for(var l=a;l<s;l++)if(i(this.values[l],o+l)===!1)return!1},t.prototype.forEachInvertedInner=function(i,a,s,o){for(var l=a-1;l>=s;l--)if(i(this.values[l],o+l)===!1)return!1},t.prototype.leafAppend=function(i){if(this.length+i.length<=RI)return new t(this.values.concat(i.flatten()))},t.prototype.leafPrepend=function(i){if(this.length+i.length<=RI)return new t(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(Pi);Pi.empty=new ede([]);var n_t=function(e){function t(n,r){e.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},t.prototype.forEachInner=function(r,i,a,s){var o=this.left.length;if(i<o&&this.left.forEachInner(r,i,Math.min(a,o),s)===!1||a>o&&this.right.forEachInner(r,Math.max(i-o,0),Math.min(this.length,a)-o,s+o)===!1)return!1},t.prototype.forEachInvertedInner=function(r,i,a,s){var o=this.left.length;if(i>o&&this.right.forEachInvertedInner(r,i-o,Math.max(a,o)-o,s+o)===!1||a<o&&this.left.forEachInvertedInner(r,Math.min(i,o),a,s)===!1)return!1},t.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var a=this.left.length;return i<=a?this.left.slice(r,i):r>=a?this.right.slice(r-a,i-a):this.left.slice(r,a).append(this.right.slice(0,i-a))},t.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new t(this.left,i)},t.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new t(i,this.right)},t.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new t(this.left,new t(this.right,r)):new t(this,r)},t}(Pi);const r_t=500;class Do{constructor(t,n){this.items=t,this.eventCount=n}popEvent(t,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,a;n&&(i=this.remapping(r,this.items.length),a=i.maps.length);let s=t.tr,o,l,u=[],c=[];return this.items.forEach((d,p)=>{if(!d.step){i||(i=this.remapping(r,p+1),a=i.maps.length),a--,c.push(d);return}if(i){c.push(new vl(d.map));let h=d.step.map(i.slice(a)),m;h&&s.maybeStep(h).doc&&(m=s.mapping.maps[s.mapping.maps.length-1],u.push(new vl(m,void 0,void 0,u.length+c.length))),a--,m&&i.appendMap(m,a)}else s.maybeStep(d.step);if(d.selection)return o=i?d.selection.map(i.slice(a)):d.selection,l=new Do(this.items.slice(0,r).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:o}}addTransform(t,n,r,i){let a=[],s=this.eventCount,o=this.items,l=!i&&o.length?o.get(o.length-1):null;for(let c=0;c<t.steps.length;c++){let d=t.steps[c].invert(t.docs[c]),p=new vl(t.mapping.maps[c],d,n),h;(h=l&&l.merge(p))&&(p=h,c?a.pop():o=o.slice(0,o.length-1)),a.push(p),n&&(s++,n=void 0),i||(l=p)}let u=s-r.depth;return u>a_t&&(o=i_t(o,u),s-=u),new Do(o.append(a),s)}remapping(t,n){let r=new Ng;return this.items.forEach((i,a)=>{let s=i.mirrorOffset!=null&&a-i.mirrorOffset>=t?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},t,n),r}addMaps(t){return this.eventCount==0?this:new Do(this.items.append(t.map(n=>new vl(n))),this.eventCount)}rebased(t,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),a=t.mapping,s=t.steps.length,o=this.eventCount;this.items.forEach(p=>{p.selection&&o--},i);let l=n;this.items.forEach(p=>{let h=a.getMirror(--l);if(h==null)return;s=Math.min(s,h);let m=a.maps[h];if(p.step){let g=t.steps[h].invert(t.docs[h]),v=p.selection&&p.selection.map(a.slice(l+1,h));v&&o++,r.push(new vl(m,g,v))}else r.push(new vl(m))},i);let u=[];for(let p=n;p<s;p++)u.push(new vl(a.maps[p]));let c=this.items.slice(0,i).append(u).append(r),d=new Do(c,o);return d.emptyItemCount()>r_t&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let t=0;return this.items.forEach(n=>{n.step||t++}),t}compress(t=this.items.length){let n=this.remapping(0,t),r=n.maps.length,i=[],a=0;return this.items.forEach((s,o)=>{if(o>=t)i.push(s),s.selection&&a++;else if(s.step){let l=s.step.map(n.slice(r)),u=l&&l.getMap();if(r--,u&&n.appendMap(u,r),l){let c=s.selection&&s.selection.map(n.slice(r));c&&a++;let d=new vl(u.invert(),l,c),p,h=i.length-1;(p=i.length&&i[h].merge(d))?i[h]=p:i.push(d)}}else s.map&&r--},this.items.length,0),new Do(Pi.from(i.reverse()),a)}}Do.empty=new Do(Pi.empty,0);function i_t(e,t){let n;return e.forEach((r,i)=>{if(r.selection&&t--==0)return n=i,!1}),e.slice(n)}class vl{constructor(t,n,r,i){this.map=t,this.step=n,this.selection=r,this.mirrorOffset=i}merge(t){if(this.step&&t.step&&!t.selection){let n=t.step.merge(this.step);if(n)return new vl(n.getMap().invert(),n,this.selection)}}}class kc{constructor(t,n,r,i,a){this.done=t,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=a}}const a_t=20;function s_t(e,t,n,r){let i=n.getMeta(Bp),a;if(i)return i.historyState;n.getMeta(u_t)&&(e=new kc(e.done,e.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(n.steps.length==0)return e;if(s&&s.getMeta(Bp))return s.getMeta(Bp).redo?new kc(e.done.addTransform(n,void 0,r,gk(t)),e.undone,z8(n.mapping.maps[n.steps.length-1]),e.prevTime,e.prevComposition):new kc(e.done,e.undone.addTransform(n,void 0,r,gk(t)),null,e.prevTime,e.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let o=n.getMeta("composition"),l=e.prevTime==0||!s&&e.prevComposition!=o&&(e.prevTime<(n.time||0)-r.newGroupDelay||!o_t(n,e.prevRanges)),u=s?DE(e.prevRanges,n.mapping):z8(n.mapping.maps[n.steps.length-1]);return new kc(e.done.addTransform(n,l?t.selection.getBookmark():void 0,r,gk(t)),Do.empty,u,n.time,o==null?e.prevComposition:o)}else return(a=n.getMeta("rebased"))?new kc(e.done.rebased(n,a),e.undone.rebased(n,a),DE(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new kc(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),DE(e.prevRanges,n.mapping),e.prevTime,e.prevComposition)}function o_t(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((r,i)=>{for(let a=0;a<t.length;a+=2)r<=t[a+1]&&i>=t[a]&&(n=!0)}),n}function z8(e){let t=[];return e.forEach((n,r,i,a)=>t.push(i,a)),t}function DE(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let i=t.map(e[r],1),a=t.map(e[r+1],-1);i<=a&&n.push(i,a)}return n}function l_t(e,t,n){let r=gk(t),i=Bp.get(t).spec.config,a=(n?e.undone:e.done).popEvent(t,r);if(!a)return null;let s=a.selection.resolve(a.transform.doc),o=(n?e.done:e.undone).addTransform(a.transform,t.selection.getBookmark(),i,r),l=new kc(n?o:a.remaining,n?a.remaining:o,null,0,-1);return a.transform.setSelection(s).setMeta(Bp,{redo:n,historyState:l})}let LE=!1,B8=null;function gk(e){let t=e.plugins;if(B8!=t){LE=!1,B8=t;for(let n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){LE=!0;break}}return LE}const Bp=new Yu("history"),u_t=new Yu("closeHistory");function c_t(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new Gs({key:Bp,state:{init(){return new kc(Do.empty,Do.empty,null,0,-1)},apply(t,n,r){return s_t(n,r,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,n){let r=n.inputType,i=r=="historyUndo"?nde:r=="historyRedo"?rde:null;return i?(n.preventDefault(),i(t.state,t.dispatch)):!1}}}})}function tde(e,t){return(n,r)=>{let i=Bp.getState(n);if(!i||(e?i.undone:i.done).eventCount==0)return!1;if(r){let a=l_t(i,n,e);a&&r(t?a.scrollIntoView():a)}return!0}}const nde=tde(!1,!0),rde=tde(!0,!0),d_t=wa.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>nde(e,t),redo:()=>({state:e,dispatch:t})=>rde(e,t)}},addProseMirrorPlugins(){return[c_t(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}}),p_t=ea.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",mr(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{const{$to:n}=t.selection,r=e();return n.parentOffset===0?r.insertContentAt(Math.max(n.pos-2,0),{type:this.name}):r.insertContent({type:this.name}),r.command(({tr:i,dispatch:a})=>{var s;if(a){const{$to:o}=i.selection,l=o.end();if(o.nodeAfter)o.nodeAfter.isTextblock?i.setSelection(Ht.create(i.doc,o.pos+1)):o.nodeAfter.isBlock?i.setSelection(It.create(i.doc,o.pos)):i.setSelection(Ht.create(i.doc,o.pos));else{const u=(s=o.parent.type.contentMatch.defaultType)===null||s===void 0?void 0:s.create();u&&(i.insert(l,u),i.setSelection(Ht.create(i.doc,l+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Qce({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),h_t=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,f_t=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,m_t=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,g_t=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,y_t=Ha.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[_h({find:h_t,type:this.type}),_h({find:m_t,type:this.type})]},addPasteRules(){return[kh({find:f_t,type:this.type}),kh({find:g_t,type:this.type})]}}),v_t=ea.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",mr(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),b_t=ea.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",mr(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),W8=Ha.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=Qw(e,this.type);return Object.entries(n).some(([,i])=>!!i)?!0:t.unsetMark(this.name)}}}}),V8=/^(\d+)\.\s$/,w_t=ea.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return t===1?["ol",mr(this.options.HTMLAttributes,n),0]:["ol",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(b_t.name,this.editor.getAttributes(W8.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=C1({find:V8,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=C1({find:V8,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(W8.name)}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),x_t=ea.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),__t=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,k_t=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,S_t=Ha.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[_h({find:__t,type:this.type})]},addPasteRules(){return[kh({find:k_t,type:this.type})]}}),C_t=ea.create({name:"text",group:"inline"}),um=wa.create({name:"starterKit",addExtensions(){var e,t,n,r,i,a,s,o,l,u,c,d,p,h,m,g,v,y;const b=[];return this.options.blockquote!==!1&&b.push(Txt.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bold!==!1&&b.push(Axt.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.bulletList!==!1&&b.push(Rxt.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&b.push(Fxt.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&b.push(Wxt.configure((i=this.options)===null||i===void 0?void 0:i.codeBlock)),this.options.document!==!1&&b.push(Vxt.configure((a=this.options)===null||a===void 0?void 0:a.document)),this.options.dropcursor!==!1&&b.push(Hxt.configure((s=this.options)===null||s===void 0?void 0:s.dropcursor)),this.options.gapcursor!==!1&&b.push(Qxt.configure((o=this.options)===null||o===void 0?void 0:o.gapcursor)),this.options.hardBreak!==!1&&b.push(e_t.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&b.push(t_t.configure((u=this.options)===null||u===void 0?void 0:u.heading)),this.options.history!==!1&&b.push(d_t.configure((c=this.options)===null||c===void 0?void 0:c.history)),this.options.horizontalRule!==!1&&b.push(p_t.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&b.push(y_t.configure((p=this.options)===null||p===void 0?void 0:p.italic)),this.options.listItem!==!1&&b.push(v_t.configure((h=this.options)===null||h===void 0?void 0:h.listItem)),this.options.orderedList!==!1&&b.push(w_t.configure((m=this.options)===null||m===void 0?void 0:m.orderedList)),this.options.paragraph!==!1&&b.push(x_t.configure((g=this.options)===null||g===void 0?void 0:g.paragraph)),this.options.strike!==!1&&b.push(S_t.configure((v=this.options)===null||v===void 0?void 0:v.strike)),this.options.text!==!1&&b.push(C_t.configure((y=this.options)===null||y===void 0?void 0:y.text)),b}}),cm=Ha.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),dm=wa.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>e.style.textAlign||this.options.defaultAlignment,renderHTML:e=>e.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${e.textAlign}`}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>this.options.alignments.includes(e)?this.options.types.map(n=>t.updateAttributes(n,{textAlign:e})).every(n=>n):!1,unsetTextAlign:()=>({commands:e})=>this.options.types.map(t=>e.resetAttributes(t,"textAlign")).every(t=>t)}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),pm=Ha.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(e){return e!=="super"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sup",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{setSuperscript:()=>({commands:e})=>e.setMark(this.name),toggleSuperscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSuperscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),hm=Ha.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(e){return e!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sub",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{setSubscript:()=>({commands:e})=>e.setMark(this.name),toggleSubscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSubscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),I_t=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,N3=ea.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",mr(this.options.HTMLAttributes,e)]},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[Qce({find:I_t,type:this.type,getAttributes:e=>{const[,,t,n,r]=e;return{src:n,alt:t,title:r}}})]}}),fm=N3.extend({addAttributes(){return{src:{default:null},alt:{default:null},style:{default:"width: 100%; height: auto; cursor: pointer;",parseHTML:e=>{const t=e.getAttribute("width");return t?`width: ${t}px; height: auto; cursor: pointer;`:`${e.style.cssText}`}},title:{default:null},loading:{default:null},srcset:{default:null},sizes:{default:null},crossorigin:{default:null},usemap:{default:null},ismap:{default:null},width:{default:null},height:{default:null},referrerpolicy:{default:null},longdesc:{default:null},decoding:{default:null},class:{default:null},id:{default:null},name:{default:null},draggable:{default:!0},tabindex:{default:null},"aria-label":{default:null},"aria-labelledby":{default:null},"aria-describedby":{default:null}}},addNodeView(){return({node:e,editor:t,getPos:n})=>{const{view:r,options:{editable:i}}=t,{style:a}=e.attrs,s=document.createElement("div"),o=document.createElement("div"),l=document.createElement("img"),u="width: 24px; height: 24px; cursor: pointer;",c=()=>{if(typeof n=="function"){const y=Object.assign(Object.assign({},e.attrs),{style:`${l.style.cssText}`});r.dispatch(r.state.tr.setNodeMarkup(n(),null,y))}},d=()=>{const y=document.createElement("div"),b=document.createElement("img"),_=document.createElement("img"),k=document.createElement("img"),C=N=>{N.target.style.opacity=.3},$=N=>{N.target.style.opacity=1};y.setAttribute("style","position: absolute; top: 0%; left: 50%; width: 100px; height: 25px; z-index: 999; background-color: rgba(255, 255, 255, 0.7); border-radius: 4px; border: 2px solid #6C6C6C; cursor: pointer; transform: translate(-50%, -50%); display: flex; justify-content: space-between; align-items: center; padding: 0 10px;"),b.setAttribute("src","https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_left/default/20px.svg"),b.setAttribute("style",u),b.addEventListener("mouseover",C),b.addEventListener("mouseout",$),_.setAttribute("src","https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_center/default/20px.svg"),_.setAttribute("style",u),_.addEventListener("mouseover",C),_.addEventListener("mouseout",$),k.setAttribute("src","https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_right/default/20px.svg"),k.setAttribute("style",u),k.addEventListener("mouseover",C),k.addEventListener("mouseout",$),b.addEventListener("click",()=>{l.setAttribute("style",`${l.style.cssText} margin: 0 auto 0 0;`),c()}),_.addEventListener("click",()=>{l.setAttribute("style",`${l.style.cssText} margin: 0 auto;`),c()}),k.addEventListener("click",()=>{l.setAttribute("style",`${l.style.cssText} margin: 0 0 0 auto;`),c()}),y.appendChild(b),y.appendChild(_),y.appendChild(k),o.appendChild(y)};if(s.setAttribute("style","display: flex;"),s.appendChild(o),o.setAttribute("style",`${a}`),o.appendChild(l),Object.entries(e.attrs).forEach(([y,b])=>{b!=null&&l.setAttribute(y,b)}),!i)return{dom:l};const p=["top: -4px; left: -4px; cursor: nwse-resize;","top: -4px; right: -4px; cursor: nesw-resize;","bottom: -4px; left: -4px; cursor: nesw-resize;","bottom: -4px; right: -4px; cursor: nwse-resize;"];let h=!1,m,g,v;return o.addEventListener("click",()=>{if(o.childElementCount>3)for(let y=0;y<5;y++)o.removeChild(o.lastChild);d(),o.setAttribute("style",`position: relative; border: 1px dashed #6C6C6C; ${a} cursor: pointer;`),Array.from({length:4},(y,b)=>{const _=document.createElement("div");_.setAttribute("style",`position: absolute; width: 9px; height: 9px; border: 1.5px solid #6C6C6C; border-radius: 50%; ${p[b]}`),_.addEventListener("mousedown",k=>{k.preventDefault(),h=!0,m=k.clientX,g=o.offsetWidth,v=o.offsetHeight;const C=N=>{if(!h)return;const A=b%2===0?-(N.clientX-m):N.clientX-m,D=g/v,O=g+A,F=O/D;o.style.width=O+"px",o.style.height=F+"px",l.style.width=O+"px",l.style.height=F+"px"},$=()=>{h&&(h=!1),c(),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",$)};document.addEventListener("mousemove",C),document.addEventListener("mouseup",$)}),o.appendChild(_)})}),document.addEventListener("click",y=>{const b=y.target;if(!(o.contains(b)||b.style.cssText===u)){const k=o.getAttribute("style"),C=k==null?void 0:k.replace("border: 1px dashed #6C6C6C;","");if(o.setAttribute("style",C),o.childElementCount>3)for(let $=0;$<5;$++)o.removeChild(o.lastChild)}}),{dom:s}}}}),r0=Ha.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",mr(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=Qw(e,this.type);return Object.entries(n).some(([,i])=>!!i)?!0:t.unsetMark(this.name)}}}}),i0=wa.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:e=>{var t;return(t=e.style.color)===null||t===void 0?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.color?{style:`color: ${e.color}`}:{}}}}]},addCommands(){return{setColor:e=>({chain:t})=>t().setMark("textStyle",{color:e}).run(),unsetColor:()=>({chain:e})=>e().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),mm=wa.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize"}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc;return((e==null?void 0:e.mode)||this.options.mode)==="textSize"?t.textBetween(0,t.content.size,void 0," ").length:t.nodeSize},this.storage.words=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc;return t.textBetween(0,t.content.size," "," ").split(" ").filter(i=>i!=="").length}},addProseMirrorPlugins(){return[new Gs({key:new Yu("characterCount"),filterTransaction:(e,t)=>{const n=this.options.limit;if(!e.docChanged||n===0||n===null||n===void 0)return!0;const r=this.storage.characters({node:t.doc}),i=this.storage.characters({node:e.doc});if(i<=n||r>n&&i>n&&i<=r)return!0;if(r>n&&i>n&&i>r||!e.getMeta("paste"))return!1;const s=e.selection.$head.pos,o=i-n,l=s-o,u=s;return e.deleteRange(l,u),!(this.storage.characters({node:e.doc})>n)}})]}}),[$_t,Kd]=Iy("RichTextEditor was not found in tree");var T_t=Object.defineProperty,j8=Object.getOwnPropertySymbols,N_t=Object.prototype.hasOwnProperty,E_t=Object.prototype.propertyIsEnumerable,U8=(e,t,n)=>t in e?T_t(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,FE=(e,t)=>{for(var n in t||(t={}))N_t.call(t,n)&&U8(e,n,t[n]);if(j8)for(var n of j8(t))E_t.call(t,n)&&U8(e,n,t[n]);return e};function O_t(e,t){if(!e)return null;const n=t.colorScheme==="dark"?5:7;return{pre:{background:t.colorScheme==="dark"?t.colors.dark[8]:t.fn.rgba(t.colors.gray[0],.65),borderRadius:t.fn.radius(),color:t.colorScheme==="dark"?t.colors.dark[0]:t.colors.gray[9],fontFamily:t.fontFamilyMonospace,padding:`${t.spacing.md} ${t.spacing.xl}`,"& code":{background:"none",color:"inherit",fontSize:t.fontSizes.sm,padding:0}," & .hljs-comment, & .hljs-quote":{color:t.colorScheme==="dark"?t.colors.dark[2]:t.colors.gray[5]},"& .hljs-variable, & .hljs-template-variable, & .hljs-attribute, & .hljs-tag, & .hljs-name, & .hljs-regexp, & .hljs-link, & .hljs-name, & .hljs-selector-id, & .hljs-selector-class":{color:t.colors.red[n]},"& .hljs-number, & .hljs-meta, & .hljs-built_in, & .hljs-builtin-name, & .hljs-literal, & .hljs-type, & .hljs-params":{color:t.colors[t.colorScheme==="dark"?"cyan":"blue"][n]},"& .hljs-string, & .hljs-symbol, & .hljs-bullet":{color:t.colors.red[n]},"& .hljs-title, & .hljs-section":{color:t.colors[t.colorScheme==="dark"?"yellow":"pink"][n]},"& .hljs-keyword, & .hljs-selector-tag":{color:t.colors.violet[n]},"& .hljs-emphasis":{fontStyle:"italic"},"& .hljs-strong":{fontWeight:700}}}}function P_t(e){return e?{"& li > p":{margin:0},"& ul li, & ol li":{marginTop:G(2)},"& ul, & ol":{marginTop:G(5),marginBottom:G(5)},"& p":{marginBottom:G(7)},"& h1, & h2, & h3, & h4, & h5, & h6, & p":{marginTop:0}}:null}var A_t=it((e,{withCodeHighlightStyles:t,withTypographyStyles:n})=>({typographyStylesProvider:FE({},P_t(n)),content:FE({backgroundColor:e.colorScheme==="dark"?e.colors.dark[7]:e.white,borderRadius:e.fn.radius(),"& .ProseMirror":{outline:0,padding:e.spacing.md},"& .ProseMirror > *:last-child":{marginBottom:0},"& .ProseMirror p.is-editor-empty:first-of-type::before":FE({content:"attr(data-placeholder)",pointerEvents:"none",userSelect:"none",float:"left",height:0},e.fn.placeholderStyles())},O_t(t,e))}));const M_t=A_t;var R_t=Object.defineProperty,DI=Object.getOwnPropertySymbols,ide=Object.prototype.hasOwnProperty,ade=Object.prototype.propertyIsEnumerable,H8=(e,t,n)=>t in e?R_t(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,D_t=(e,t)=>{for(var n in t||(t={}))ide.call(t,n)&&H8(e,n,t[n]);if(DI)for(var n of DI(t))ade.call(t,n)&&H8(e,n,t[n]);return e},L_t=(e,t)=>{var n={};for(var r in e)ide.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&DI)for(var r of DI(e))t.indexOf(r)<0&&ade.call(e,r)&&(n[r]=e[r]);return n};const F_t={},sde=I.exports.forwardRef((e,t)=>{const n=Ke("RichTextEditorContent",F_t,e),{className:r}=n,i=L_t(n,["className"]),{editor:a,withCodeHighlightStyles:s,withTypographyStyles:o,classNames:l,styles:u,unstyled:c,variant:d}=Kd(),{classes:p,cx:h}=M_t({withCodeHighlightStyles:s,withTypographyStyles:o},{name:"RichTextEditor",classNames:l,styles:u,unstyled:c,variant:d});return x(jY,{className:h(p.typographyStylesProvider,r),unstyled:!o||c,ref:t,children:x(wt,{...D_t({component:wxt,editor:a,className:p.content},i)})})});sde.displayName="@mantine/tiptap/Content";var z_t=Object.defineProperty,G8=Object.getOwnPropertySymbols,B_t=Object.prototype.hasOwnProperty,W_t=Object.prototype.propertyIsEnumerable,q8=(e,t,n)=>t in e?z_t(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,K8=(e,t)=>{for(var n in t||(t={}))B_t.call(t,n)&&q8(e,n,t[n]);if(G8)for(var n of G8(t))W_t.call(t,n)&&q8(e,n,t[n]);return e},V_t=it(e=>{const t=e.fn.variant({variant:"light"});return{control:{backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.white,minWidth:G(26),height:G(26),display:"flex",justifyContent:"center",alignItems:"center",border:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,borderRadius:e.fn.radius(),cursor:"default","&[data-interactive]":K8({cursor:"pointer"},e.fn.hover({backgroundColor:e.colorScheme==="dark"?e.colors.dark[5]:e.colors.gray[0]})),"&[data-active]":{backgroundColor:t.background,color:t.color,"&:hover":K8({},e.fn.hover({backgroundColor:t.hover}))}}}});const j_t=V_t;var U_t=Object.defineProperty,LI=Object.getOwnPropertySymbols,ode=Object.prototype.hasOwnProperty,lde=Object.prototype.propertyIsEnumerable,Z8=(e,t,n)=>t in e?U_t(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,H_t=(e,t)=>{for(var n in t||(t={}))ode.call(t,n)&&Z8(e,n,t[n]);if(LI)for(var n of LI(t))lde.call(t,n)&&Z8(e,n,t[n]);return e},G_t=(e,t)=>{var n={};for(var r in e)ode.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&LI)for(var r of LI(e))t.indexOf(r)<0&&lde.call(e,r)&&(n[r]=e[r]);return n};const q_t={interactive:!0},ex=I.exports.forwardRef((e,t)=>{const n=Ke("RichTextEditorControl",q_t,e),{className:r,active:i,children:a,interactive:s}=n,o=G_t(n,["className","active","children","interactive"]),{classNames:l,styles:u,unstyled:c,variant:d}=Kd(),{classes:p,cx:h}=j_t(null,{name:"RichTextEditor",classNames:l,styles:u,unstyled:c,variant:d});return x(D1,{...H_t({className:h(p.control,r),"data-rich-text-editor-control":!0,tabIndex:s?0:-1,"data-interactive":s||void 0,"data-active":i||void 0,"aria-pressed":i&&s||void 0,"aria-hidden":!s||void 0,ref:t,unstyled:c},o),children:a})});ex.displayName="@mantine/tiptap/Control";var K_t=it(e=>({controlsGroup:{display:"flex","& [data-rich-text-editor-control]":{borderRadius:0,"&:not(:last-of-type)":{borderRight:0},"&:last-of-type":{borderTopRightRadius:e.fn.radius(),borderBottomRightRadius:e.fn.radius()},"&:first-of-type":{borderTopLeftRadius:e.fn.radius(),borderBottomLeftRadius:e.fn.radius()}}}}));const Z_t=K_t;var X_t=Object.defineProperty,FI=Object.getOwnPropertySymbols,ude=Object.prototype.hasOwnProperty,cde=Object.prototype.propertyIsEnumerable,X8=(e,t,n)=>t in e?X_t(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,J_t=(e,t)=>{for(var n in t||(t={}))ude.call(t,n)&&X8(e,n,t[n]);if(FI)for(var n of FI(t))cde.call(t,n)&&X8(e,n,t[n]);return e},Y_t=(e,t)=>{var n={};for(var r in e)ude.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&FI)for(var r of FI(e))t.indexOf(r)<0&&cde.call(e,r)&&(n[r]=e[r]);return n};const Q_t={},dde=I.exports.forwardRef((e,t)=>{const n=Ke("RichTextEditorControlsGroup",Q_t,e),{className:r,children:i}=n,a=Y_t(n,["className","children"]),{classNames:s,styles:o,unstyled:l}=Kd(),{classes:u,cx:c}=Z_t(null,{name:"RichTextEditor",classNames:s,styles:o,unstyled:l});return x(wt,{...J_t({className:c(u.controlsGroup,r),ref:t},a),children:i})});dde.displayName="@mantine/tiptap/ControlsGroup";var ekt=it((e,{sticky:t,stickyOffset:n})=>({toolbar:{position:t?"sticky":"static",top:t?G(n):void 0,padding:`${e.spacing.xs} ${e.spacing.md}`,backgroundColor:e.colorScheme==="dark"?e.colors.dark[7]:e.white,zIndex:1,borderTopRightRadius:e.fn.radius(),borderTopLeftRadius:e.fn.radius(),borderBottom:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`}}));const tkt=ekt;var nkt=Object.defineProperty,zI=Object.getOwnPropertySymbols,pde=Object.prototype.hasOwnProperty,hde=Object.prototype.propertyIsEnumerable,J8=(e,t,n)=>t in e?nkt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rkt=(e,t)=>{for(var n in t||(t={}))pde.call(t,n)&&J8(e,n,t[n]);if(zI)for(var n of zI(t))hde.call(t,n)&&J8(e,n,t[n]);return e},ikt=(e,t)=>{var n={};for(var r in e)pde.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&zI)for(var r of zI(e))t.indexOf(r)<0&&hde.call(e,r)&&(n[r]=e[r]);return n};const akt={stickyOffset:0},fde=I.exports.forwardRef((e,t)=>{const n=Ke("RichTextEditorToolbar",akt,e),{className:r,children:i,sticky:a,stickyOffset:s}=n,o=ikt(n,["className","children","sticky","stickyOffset"]),l=Kd(),{classes:u,cx:c}=tkt({sticky:a,stickyOffset:s},{name:"RichTextEditor",classNames:l.classNames,styles:l.styles,unstyled:l.unstyled,variant:l.variant});return x(me,{...rkt({className:c(u.toolbar,r),ref:t},o),children:i})});fde.displayName="@mantine/tiptap/Toolbar";const skt={linkControlLabel:"Link",colorPickerControlLabel:"Text color",highlightControlLabel:"Highlight text",colorControlLabel:e=>`Set text color ${e}`,boldControlLabel:"Bold",italicControlLabel:"Italic",underlineControlLabel:"Underline",strikeControlLabel:"Strikethrough",clearFormattingControlLabel:"Clear formatting",unlinkControlLabel:"Remove link",bulletListControlLabel:"Bullet list",orderedListControlLabel:"Ordered list",h1ControlLabel:"Heading 1",h2ControlLabel:"Heading 2",h3ControlLabel:"Heading 3",h4ControlLabel:"Heading 4",h5ControlLabel:"Heading 5",h6ControlLabel:"Heading 6",blockquoteControlLabel:"Blockquote",alignLeftControlLabel:"Align text: left",alignCenterControlLabel:"Align text: center",alignRightControlLabel:"Align text: right",alignJustifyControlLabel:"Align text: justify",codeControlLabel:"Code",codeBlockControlLabel:"Code block",subscriptControlLabel:"Subscript",superscriptControlLabel:"Superscript",unsetColorControlLabel:"Unset color",hrControlLabel:"Horizontal line",linkEditorInputLabel:"Enter URL",linkEditorInputPlaceholder:"https://example.com/",linkEditorExternalLink:"Open link in a new tab",linkEditorInternalLink:"Open link in the same tab",linkEditorSave:"Save",colorPickerCancel:"Cancel",colorPickerClear:"Clear color",colorPickerColorPicker:"Color picker",colorPickerPalette:"Color palette",colorPickerSave:"Save",colorPickerColorLabel:e=>`Set text color ${e}`};var okt=it(e=>({root:{position:"relative",border:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,borderRadius:e.fn.radius()}}));const lkt=okt;var ukt=Object.defineProperty,BI=Object.getOwnPropertySymbols,mde=Object.prototype.hasOwnProperty,gde=Object.prototype.propertyIsEnumerable,Y8=(e,t,n)=>t in e?ukt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ckt=(e,t)=>{for(var n in t||(t={}))mde.call(t,n)&&Y8(e,n,t[n]);if(BI)for(var n of BI(t))gde.call(t,n)&&Y8(e,n,t[n]);return e},dkt=(e,t)=>{var n={};for(var r in e)mde.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&BI)for(var r of BI(e))t.indexOf(r)<0&&gde.call(e,r)&&(n[r]=e[r]);return n};const E3=I.exports.forwardRef((e,t)=>{var n=e,{className:r,active:i,icon:a}=n,s=dkt(n,["className","active","icon"]);return x(ex,{...ckt({active:i,ref:t},s),children:x(a,{size:"1rem"})})});E3.displayName="@mantine/tiptap/ControlBase";var pkt=Object.defineProperty,Q8=Object.getOwnPropertySymbols,hkt=Object.prototype.hasOwnProperty,fkt=Object.prototype.propertyIsEnumerable,eG=(e,t,n)=>t in e?pkt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mkt=(e,t)=>{for(var n in t||(t={}))hkt.call(t,n)&&eG(e,n,t[n]);if(Q8)for(var n of Q8(t))fkt.call(t,n)&&eG(e,n,t[n]);return e};function or({label:e,isActive:t,operation:n,icon:r}){return I.exports.forwardRef((i,a)=>{const{editor:s,labels:o}=Kd(),l=o[e];return x(E3,{...mkt({"aria-label":l,title:l,active:t!=null&&t.name?s==null?void 0:s.isActive(t.name,t.attributes):!1,ref:a,onClick:()=>s==null?void 0:s.chain().focus()[n.name](n.attributes).run(),icon:r},i)})})}var gkt=Object.defineProperty,ykt=Object.defineProperties,vkt=Object.getOwnPropertyDescriptors,tG=Object.getOwnPropertySymbols,bkt=Object.prototype.hasOwnProperty,wkt=Object.prototype.propertyIsEnumerable,nG=(e,t,n)=>t in e?gkt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lr=(e,t)=>{for(var n in t||(t={}))bkt.call(t,n)&&nG(e,n,t[n]);if(tG)for(var n of tG(t))wkt.call(t,n)&&nG(e,n,t[n]);return e},ur=(e,t)=>ykt(e,vkt(t));const xkt=or({label:"boldControlLabel",icon:e=>x(QAe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"bold"},operation:{name:"toggleBold"}}),_kt=or({label:"italicControlLabel",icon:e=>x(bMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"italic"},operation:{name:"toggleItalic"}}),kkt=or({label:"underlineControlLabel",icon:e=>x(RMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"underline"},operation:{name:"toggleUnderline"}}),Skt=or({label:"strikeControlLabel",icon:e=>x(OMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"strike"},operation:{name:"toggleStrike"}}),Ckt=or({label:"clearFormattingControlLabel",icon:e=>x(iMe,{...ur(lr({},e),{stroke:1.5})}),operation:{name:"unsetAllMarks"}}),Ikt=or({label:"unlinkControlLabel",icon:e=>x(DMe,{...ur(lr({},e),{stroke:1.5})}),operation:{name:"unsetLink"}}),$kt=or({label:"bulletListControlLabel",icon:e=>x(kMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"bulletList"},operation:{name:"toggleBulletList"}}),Tkt=or({label:"orderedListControlLabel",icon:e=>x(_Me,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"orderedList"},operation:{name:"toggleOrderedList"}}),Nkt=or({label:"h1ControlLabel",icon:e=>x(pMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"heading",attributes:{level:1}},operation:{name:"toggleHeading",attributes:{level:1}}}),Ekt=or({label:"h2ControlLabel",icon:e=>x(hMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"heading",attributes:{level:2}},operation:{name:"toggleHeading",attributes:{level:2}}}),Okt=or({label:"h3ControlLabel",icon:e=>x(fMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"heading",attributes:{level:3}},operation:{name:"toggleHeading",attributes:{level:3}}}),Pkt=or({label:"h4ControlLabel",icon:e=>x(mMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"heading",attributes:{level:4}},operation:{name:"toggleHeading",attributes:{level:4}}}),Akt=or({label:"h5ControlLabel",icon:e=>x(gMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"heading",attributes:{level:5}},operation:{name:"toggleHeading",attributes:{level:5}}}),Mkt=or({label:"h6ControlLabel",icon:e=>x(yMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"heading",attributes:{level:6}},operation:{name:"toggleHeading",attributes:{level:6}}}),Rkt=or({label:"blockquoteControlLabel",icon:e=>x(YAe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"blockquote"},operation:{name:"toggleBlockquote"}}),Dkt=or({label:"alignLeftControlLabel",icon:e=>x(XAe,{...ur(lr({},e),{stroke:1.5})}),operation:{name:"setTextAlign",attributes:"left"}}),Lkt=or({label:"alignRightControlLabel",icon:e=>x(JAe,{...ur(lr({},e),{stroke:1.5})}),operation:{name:"setTextAlign",attributes:"right"}}),Fkt=or({label:"alignCenterControlLabel",icon:e=>x(KAe,{...ur(lr({},e),{stroke:1.5})}),operation:{name:"setTextAlign",attributes:"center"}}),zkt=or({label:"alignJustifyControlLabel",icon:e=>x(ZAe,{...ur(lr({},e),{stroke:1.5})}),operation:{name:"setTextAlign",attributes:"justify"}}),Bkt=or({label:"subscriptControlLabel",icon:e=>x(PMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"subscript"},operation:{name:"toggleSubscript"}}),Wkt=or({label:"superscriptControlLabel",icon:e=>x(AMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"superscript"},operation:{name:"toggleSuperscript"}}),Vkt=or({label:"codeControlLabel",icon:e=>x(tQ,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"code"},operation:{name:"toggleCode"}}),jkt=or({label:"codeBlockControlLabel",icon:e=>x(tQ,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"codeBlock"},operation:{name:"toggleCodeBlock"}}),Ukt=or({label:"highlightControlLabel",icon:e=>x(vMe,{...ur(lr({},e),{stroke:1.5})}),isActive:{name:"highlight"},operation:{name:"toggleHighlight"}}),Hkt=or({label:"hrControlLabel",icon:e=>x(wMe,{...ur(lr({},e),{stroke:1.5})}),operation:{name:"setHorizontalRule"}}),Gkt=or({label:"unsetColorControlLabel",icon:e=>x(eQ,{...ur(lr({},e),{stroke:1.5})}),operation:{name:"unsetColor"}});var qkt=Object.defineProperty,rG=Object.getOwnPropertySymbols,Kkt=Object.prototype.hasOwnProperty,Zkt=Object.prototype.propertyIsEnumerable,iG=(e,t,n)=>t in e?qkt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Xkt=(e,t)=>{for(var n in t||(t={}))Kkt.call(t,n)&&iG(e,n,t[n]);if(rG)for(var n of rG(t))Zkt.call(t,n)&&iG(e,n,t[n]);return e},Jkt=it(e=>{const t=e.fn.variant({variant:"light"});return{linkEditor:{display:"flex"},linkEditorInput:{borderTopRightRadius:0,borderBottomRightRadius:0,borderRight:0},linkEditorExternalControl:{backgroundColor:e.colorScheme==="dark"?e.fn.rgba(e.colors.dark[7],.5):e.white,border:`${G(1)} solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,height:G(24),width:G(24),display:"flex",justifyContent:"center",alignItems:"center",borderRadius:e.fn.radius(),"&[data-active]":Xkt({backgroundColor:t.background,borderColor:t.border,color:t.color},e.fn.hover({background:t.hover}))},linkEditorSave:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}});const Ykt=Jkt;var Qkt=Object.defineProperty,eSt=Object.defineProperties,tSt=Object.getOwnPropertyDescriptors,WI=Object.getOwnPropertySymbols,yde=Object.prototype.hasOwnProperty,vde=Object.prototype.propertyIsEnumerable,aG=(e,t,n)=>t in e?Qkt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,MA=(e,t)=>{for(var n in t||(t={}))yde.call(t,n)&&aG(e,n,t[n]);if(WI)for(var n of WI(t))vde.call(t,n)&&aG(e,n,t[n]);return e},nSt=(e,t)=>eSt(e,tSt(t)),bde=(e,t)=>{var n={};for(var r in e)yde.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&WI)for(var r of WI(e))t.indexOf(r)<0&&vde.call(e,r)&&(n[r]=e[r]);return n};const rSt=e=>{var t=e,{size:n}=t,r=bde(t,["size"]);return x(xMe,{...MA({size:n,stroke:1.5},r)})},iSt={initialExternal:!1},aSt=I.exports.forwardRef((e,t)=>{const n=Ke("RichTextEditorLinkControl",iSt,e),{icon:r,popoverProps:i,disableTooltips:a,initialExternal:s}=n,o=bde(n,["icon","popoverProps","disableTooltips","initialExternal"]),{editor:l,labels:u,classNames:c,styles:d,unstyled:p,variant:h}=Kd(),{classes:m}=Ykt(null,{name:"RichTextEditor",classNames:c,styles:d,unstyled:p,variant:h}),[g,v]=s0e(""),[y,b]=I.exports.useState(s),[_,{open:k,close:C}]=$r(!1),$=()=>{k();const O=l==null?void 0:l.getAttributes("link");v((O==null?void 0:O.href)||""),b((O==null?void 0:O.target)==="_blank")},N=()=>{C(),v(""),b(s)},A=()=>{N(),g===""?l.chain().focus().extendMarkRange("link").unsetLink().run():l.chain().focus().extendMarkRange("link").setLink({href:g,target:y?"_blank":null}).run()},D=O=>{O.key==="Enter"&&(O.preventDefault(),A())};return Xk("edit-link",$,!1),B(Da,{...MA({trapFocus:!0,shadow:"md",withinPortal:!0,opened:_,onClose:N,offset:-44,zIndex:1e4,unstyled:p},i),children:[x(Da.Target,{children:x(E3,{...nSt(MA({icon:r||rSt,"aria-label":u.linkControlLabel,title:u.linkControlLabel,onClick:$,active:l==null?void 0:l.isActive("link"),unstyled:p},o),{ref:t})})}),x(Da.Dropdown,{sx:O=>({backgroundColor:O.colorScheme==="dark"?O.colors.dark[7]:O.white}),children:B("div",{className:m.linkEditor,children:[x(Xe,{placeholder:u.linkEditorInputPlaceholder,"aria-label":u.linkEditorInputLabel,type:"url",value:g,onChange:v,classNames:{input:m.linkEditorInput},onKeyDown:D,unstyled:p,rightSection:x(rs,{label:y?u.linkEditorExternalLink:u.linkEditorInternalLink,events:{hover:!0,focus:!0,touch:!0},withinPortal:!0,withArrow:!0,disabled:a,unstyled:p,zIndex:1e4,children:x(D1,{onClick:()=>b(O=>!O),"data-active":y||void 0,className:m.linkEditorExternalControl,unstyled:p,children:x(lMe,{size:G(14),stroke:1.5})})})}),x(Ct,{variant:"default",onClick:A,className:m.linkEditorSave,unstyled:p,children:u.linkEditorSave})]})})]})});var sSt=Object.defineProperty,oSt=Object.defineProperties,lSt=Object.getOwnPropertyDescriptors,VI=Object.getOwnPropertySymbols,wde=Object.prototype.hasOwnProperty,xde=Object.prototype.propertyIsEnumerable,sG=(e,t,n)=>t in e?sSt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zE=(e,t)=>{for(var n in t||(t={}))wde.call(t,n)&&sG(e,n,t[n]);if(VI)for(var n of VI(t))xde.call(t,n)&&sG(e,n,t[n]);return e},uSt=(e,t)=>oSt(e,lSt(t)),cSt=(e,t)=>{var n={};for(var r in e)wde.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&VI)for(var r of VI(e))t.indexOf(r)<0&&xde.call(e,r)&&(n[r]=e[r]);return n};const dSt={},_de=I.exports.forwardRef((e,t)=>{const n=Ke("RichTextEditorColorPickerControl",dSt,e),{popoverProps:r,colors:i,colorPickerProps:a}=n,s=cSt(n,["popoverProps","colors","colorPickerProps"]),{editor:o,labels:l,unstyled:u}=Kd(),[c,{toggle:d,close:p}]=$r(!1),[h,m]=I.exports.useState("palette"),g=Ka(),v=(o==null?void 0:o.getAttributes("textStyle").color)||(g.colorScheme==="dark"?g.colors.dark[1]:g.black),y=(k,C=!0)=>{o.chain().focus().setColor(k).run(),C&&p()},b=()=>{o.chain().focus().unsetColor().run(),p()},_=i.map((k,C)=>x(Yb,{component:"button",color:k,onClick:()=>y(k),size:26,radius:"xs",sx:{cursor:"pointer"},title:l.colorPickerColorLabel(k),"aria-label":l.colorPickerColorLabel(k),unstyled:u},C));return B(Da,{...zE({opened:c,withinPortal:!0,trapFocus:!0,onClose:p,unstyled:u},r),children:[x(Da.Target,{children:x(ex,{...uSt(zE({"aria-label":l.colorPickerControlLabel,title:l.colorPickerControlLabel},s),{ref:t,onClick:d}),children:x(Yb,{color:v,size:14,unstyled:u})})}),B(Da.Dropdown,{sx:()=>({backgroundColor:g.colorScheme==="dark"?g.colors.dark[7]:g.white}),children:[h==="palette"&&x(iY,{cols:7,spacing:2,children:_}),h==="colorPicker"&&x(TR,{...zE({defaultValue:v,onChange:k=>y(k,!1),unstyled:u},a)}),x(rs.Group,{closeDelay:200,children:B(me,{position:"right",spacing:"xs",mt:"sm",children:[h==="palette"&&x(Fe,{variant:"default",onClick:p,unstyled:u,title:l.colorPickerCancel,"aria-label":l.colorPickerCancel,children:x(ui,{stroke:1.5,size:"1rem"})}),x(Fe,{variant:"default",onClick:b,unstyled:u,title:l.colorPickerClear,"aria-label":l.colorPickerClear,children:x(eQ,{stroke:1.5,size:"1rem"})}),h==="palette"?x(Fe,{variant:"default",onClick:()=>m("colorPicker"),unstyled:u,title:l.colorPickerColorPicker,"aria-label":l.colorPickerColorPicker,children:x(sMe,{stroke:1.5,size:"1rem"})}):x(Fe,{variant:"default",onClick:()=>m("palette"),unstyled:u,"aria-label":l.colorPickerPalette,title:l.colorPickerPalette,children:x(TMe,{stroke:1.5,size:"1rem"})}),h==="colorPicker"&&x(Fe,{variant:"default",onClick:p,unstyled:u,title:l.colorPickerSave,"aria-label":l.colorPickerSave,children:x(tMe,{stroke:1.5,size:"1rem"})})]})})]})]})});_de.displayName="@mantine/tiptap/ColorPickerControl";var pSt=Object.defineProperty,hSt=Object.defineProperties,fSt=Object.getOwnPropertyDescriptors,jI=Object.getOwnPropertySymbols,kde=Object.prototype.hasOwnProperty,Sde=Object.prototype.propertyIsEnumerable,oG=(e,t,n)=>t in e?pSt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mSt=(e,t)=>{for(var n in t||(t={}))kde.call(t,n)&&oG(e,n,t[n]);if(jI)for(var n of jI(t))Sde.call(t,n)&&oG(e,n,t[n]);return e},gSt=(e,t)=>hSt(e,fSt(t)),ySt=(e,t)=>{var n={};for(var r in e)kde.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&jI)for(var r of jI(e))t.indexOf(r)<0&&Sde.call(e,r)&&(n[r]=e[r]);return n};const vSt={},bSt=I.exports.forwardRef((e,t)=>{const n=Ke("RichTextEditorColorControl",vSt,e),{color:r}=n,i=ySt(n,["color"]),{editor:a,labels:s,unstyled:o}=Kd(),l=(a==null?void 0:a.getAttributes("textStyle").color)||null,u=s.colorControlLabel(r);return x(ex,{...gSt(mSt({active:l===r,"aria-label":u,title:u,onClick:()=>a.chain().focus().setColor(r).run()},i),{ref:t}),children:x(Yb,{color:r,size:14,unstyled:o})})});var wSt=Object.defineProperty,xSt=Object.defineProperties,_St=Object.getOwnPropertyDescriptors,UI=Object.getOwnPropertySymbols,Cde=Object.prototype.hasOwnProperty,Ide=Object.prototype.propertyIsEnumerable,lG=(e,t,n)=>t in e?wSt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,BE=(e,t)=>{for(var n in t||(t={}))Cde.call(t,n)&&lG(e,n,t[n]);if(UI)for(var n of UI(t))Ide.call(t,n)&&lG(e,n,t[n]);return e},kSt=(e,t)=>xSt(e,_St(t)),SSt=(e,t)=>{var n={};for(var r in e)Cde.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&UI)for(var r of UI(e))t.indexOf(r)<0&&Ide.call(e,r)&&(n[r]=e[r]);return n};const CSt={withCodeHighlightStyles:!0,withTypographyStyles:!0},ot=I.exports.forwardRef((e,t)=>{const n=Ke("RichTextEditor",CSt,e),{editor:r,children:i,className:a,labels:s,withCodeHighlightStyles:o,withTypographyStyles:l,classNames:u,styles:c,unstyled:d,variant:p}=n,h=SSt(n,["editor","children","className","labels","withCodeHighlightStyles","withTypographyStyles","classNames","styles","unstyled","variant"]),{classes:m,cx:g}=lkt(null,{name:"RichTextEditor",classNames:u,styles:c,unstyled:d,variant:p}),v=I.exports.useMemo(()=>BE(BE({},skt),s),[s]);return x($_t,{value:{editor:r,labels:v,withCodeHighlightStyles:o,withTypographyStyles:l,classNames:u,styles:c,unstyled:d,variant:p},children:x(wt,{...kSt(BE({className:g(m.root,a)},h),{ref:t}),children:i})})});ot.Content=sde;ot.Control=ex;ot.ControlsGroup=dde;ot.Toolbar=fde;ot.Bold=xkt;ot.Italic=_kt;ot.Strikethrough=Skt;ot.Underline=kkt;ot.ClearFormatting=Ckt;ot.H1=Nkt;ot.H2=Ekt;ot.H3=Okt;ot.H4=Pkt;ot.H5=Akt;ot.H6=Mkt;ot.BulletList=$kt;ot.OrderedList=Tkt;ot.Link=aSt;ot.Unlink=Ikt;ot.Blockquote=Rkt;ot.AlignLeft=Dkt;ot.AlignRight=Lkt;ot.AlignCenter=Fkt;ot.AlignJustify=zkt;ot.Superscript=Wkt;ot.Subscript=Bkt;ot.Code=Vkt;ot.CodeBlock=jkt;ot.ColorPicker=_de;ot.Color=bSt;ot.Highlight=Ukt;ot.Hr=Hkt;ot.UnsetColor=Gkt;ot.displayName="@mantine/tiptap/RichTextEditor";function gm({editor:e}){return x(SR,{children:B(ot,{editor:e,w:"44vw",children:[B(ot.Toolbar,{sticky:!0,stickyOffset:60,children:[B(ot.ControlsGroup,{children:[x(ot.Bold,{}),x(ot.Italic,{}),x(ot.Underline,{}),x(ot.Strikethrough,{}),x(ot.ClearFormatting,{}),x(ot.Highlight,{}),x(ot.Code,{})]}),B(ot.ControlsGroup,{children:[x(ot.H1,{}),x(ot.H2,{}),x(ot.H3,{}),x(ot.H4,{})]}),B(ot.ControlsGroup,{children:[x(ot.Blockquote,{}),x(ot.Hr,{}),x(ot.BulletList,{}),x(ot.OrderedList,{}),x(ot.Subscript,{}),x(ot.Superscript,{})]}),B(ot.ControlsGroup,{children:[x(ot.AlignLeft,{}),x(ot.AlignCenter,{}),x(ot.AlignJustify,{}),x(ot.AlignRight,{})]}),B(ot.ControlsGroup,{children:[x(ot.ColorPicker,{colors:["#25262b","#868e96","#fa5252","#e64980","#be4bdb","#7950f2","#4c6ef5","#228be6","#15aabf","#12b886","#40c057","#82c91e","#fab005","#fd7e14"]}),x(ot.UnsetColor,{})]})]}),x(ot.Content,{style:{height:"64vh",overflow:"auto"}})]})})}function I1({reportId:e}){const{reports:t,updateReport:n}=ju(),{updateTab:r}=gn(),[i,a]=I.exports.useState(t.find(y=>y.id===e)),{dateFormat:s}=tn(),[o,l]=I.exports.useState(i==null?void 0:i.title),[u]=Kt(o,500),c=I.exports.useRef(0),[d]=Kt(c.current,2500);I.exports.useEffect(()=>{const y=t.find(b=>b.id===e);y&&a(y)},[t,e]);const p=om({extensions:[um,cm,pm,hm,lm,i0,r0,dm.configure({types:["heading","paragraph"]}),fm,mm.configure({limit:1e5})],content:i==null?void 0:i.content}),h=I.exports.useRef(!1);I.exports.useEffect(()=>{!p||!(i!=null&&i.content)||h.current||(h.current=!0,p.commands.setContent(i.content),i!=null&&i.title&&l(i.title))},[p,i]),I.exports.useEffect(()=>{!i||n(i.id,{...i,title:u})},[u]),I.exports.useEffect(()=>{!i||n(i.id,{...i,content:p==null?void 0:p.getHTML()})},[d]),I.exports.useEffect(()=>{if(p){const y=()=>{c.current++};return p.on("update",y),()=>{p.off("update",y)}}},[p]),I.exports.useEffect(()=>{p&&p.setOptions({editorProps:{handlePaste:(y,b,_)=>{const k=b.clipboardData,C=k==null?void 0:k.getData("text/plain");return/https?:\/\/\S+\.(jpg|jpeg|png|gif)/i.test(C||"")&&C?(b.preventDefault(),p.commands.setImage({src:C}),!0):!1}}})},[p]);const m=I.exports.useCallback(()=>{r({title:"reports",component:x(mA,{})})},[i,r]),g=I.exports.useCallback(()=>{const y={...i,title:o,content:p==null?void 0:p.getHTML()};Ne("saveReport",y)},[i,o,p]),v=I.exports.useCallback(()=>{In.openConfirmModal({title:K.are_you_sure_remove,labels:{confirm:K.confirm,cancel:K.cancel},centered:!0,onConfirm:()=>{Ne("removeReport",i==null?void 0:i.id),r({title:"reports",component:x(mA,{})})}})},[i,r]);return x(ze,{children:i&&B(me,{spacing:20,h:"100%",style:{alignItems:"start"},children:[B(Ce,{w:"60%",h:"100%",justify:"flex-start",spacing:10,children:[x(Bt,{w:"100%",h:80,color:"dark.6",radius:"xs",px:10,shadow:"xs",children:B(Ce,{h:"100%",justify:"center",spacing:5,children:[B(me,{position:"apart",children:[x(Xe,{variant:"filled",value:o||"",onChange:y=>l(y.currentTarget.value),sx:{input:{fontSize:18,fontWeight:630}},w:"60%"}),B(me,{spacing:10,children:[B(bt,{radius:"sm",children:["ID: ",i.id===-1&&"Temporary"||i.id]}),x(Fe,{variant:"subtle",color:"blue",onClick:m,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:g,children:x(Us,{})}),x(Fe,{variant:"subtle",color:"red",onClick:v,children:x(go,{})})]})]}),B(Te,{fw:550,size:12,color:"gray.6",children:[i.creator," - ",new Date(i.date*1e3).toLocaleString([],s||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]})]})}),x(Bt,{w:"100%",h:"100%",color:"dark.7",radius:"xs",p:20,shadow:"xs",children:x(gm,{editor:p})})]}),x(ol,{page:"report",sidebar:i.sideBarData,pageId:i.id,updateData:n})]})})}function ISt({searchQuery:e}){const{policeReports:t,updatePoliceReport:n}=Qb(),{updateTab:r}=gn(),{dateFormat:i}=tn(),a=I.exports.useMemo(()=>t.filter(o=>{var l,u,c,d;return((l=o.title)==null?void 0:l.toLowerCase().includes(e.toLowerCase()))||((u=o.creator)==null?void 0:u.toLowerCase().includes(e.toLowerCase()))||((c=o.phoneNumber)==null?void 0:c.toLowerCase().includes(e.toLowerCase()))||((d=o.id)==null?void 0:d.toString().includes(e.toLowerCase()))}).sort((o,l)=>l.id-o.id),[e,t]),s=({index:o,style:l})=>{const u=a[o];return u.id<=-1?null:x("div",{style:{...l},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getPoliceReport",u.id).then(c=>{!c||!u.id||n(u.id,c)}),r({title:"policeReports",component:x($de,{reportId:u.id})})},p:10,children:x(me,{spacing:15,children:B(Ce,{spacing:1,children:[x(Te,{fw:600,size:16,children:u.title}),u.creator&&x(Te,{size:12,color:"gray.5",children:u.creator}),x(Te,{fw:500,size:12,color:"gray.5",children:new Date(u.date*1e3).toLocaleString([],i||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]})})})})};return x(ta,{height:window.innerHeight*.77,itemCount:a.length,itemSize:110,width:"100%",children:s})}function RA(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200);return B(ze,{children:[x(xa,{title:K.policeReports,searchQuery:e,setSearchQuery:t}),x(ISt,{searchQuery:n})]})}function $de({reportId:e}){const{policeReports:t,updatePoliceReport:n}=Qb(),{updateTab:r}=gn(),[i,a]=I.exports.useState(t.find(l=>l.id===e)),{dateFormat:s}=tn();I.exports.useEffect(()=>{a(t.find(l=>l.id===e))},[t]);const o=I.exports.useCallback(()=>{In.openConfirmModal({title:K.are_you_sure_remove,labels:{confirm:K.confirm,cancel:K.cancel},centered:!0,onConfirm:()=>{Ne("removePoliceReport",i==null?void 0:i.id),r({title:"policeReports",component:x(RA,{})})}})},[i,r]);return x(ze,{children:i&&B(me,{spacing:20,children:[x(Bt,{w:"60%",h:"81vh",color:"dark.6",radius:"xs",p:20,shadow:"xs",children:B(Ce,{w:"100%",spacing:25,children:[B(me,{w:"100%",position:"apart",children:[x(me,{w:"85%",children:x(Ce,{w:"70%",h:160,align:"flex-start",justify:"flex-start",spacing:0,children:x(An,{h:"100%",scrollHideDelay:0,scrollbarSize:5,children:B(me,{w:"100%",spacing:10,children:[x(Xe,{label:K.title,variant:"filled",value:i.title,size:"xs",readOnly:!0}),x(Xe,{label:K.date,variant:"filled",value:new Date(i.date*1e3).toLocaleString([],s||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),size:"xs",readOnly:!0}),x(Xe,{label:K.creator,variant:"filled",value:i.creator,size:"xs",readOnly:!0,disabled:!i.creator}),x(Xe,{label:K.phone_number,variant:"filled",value:i.phoneNumber,size:"xs",readOnly:!0,disabled:!i.phoneNumber})]})})})}),x(Ce,{h:160,justify:"flex-start",children:B(me,{spacing:10,children:[x(Fe,{variant:"subtle",color:"blue",onClick:()=>{r({title:"policeReports",component:x(RA,{})})},children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",children:x(Us,{})}),x(Fe,{variant:"subtle",color:"red",onClick:o,children:x(go,{})})]})})]}),x(bs,{label:"Notes",minRows:28,value:i.content,readOnly:!0})]})}),x(ol,{page:"policeReport",sidebar:i.sideBarData,pageId:i.id,updateData:n})]})})}function HI({pageId:e,currentUrl:t,currentPhotos:n,updateData:r}){const[i,a]=I.exports.useState(t||""),s=()=>{In.closeAll(),Ne("hideUI"),Ne("takePhoto","photos")};return x(ze,{children:B(Ce,{spacing:20,children:[x(Xe,{label:K.url,placeholder:K.url,value:i,onChange:o=>a(o.currentTarget.value),rightSection:x(Fe,{onClick:s,children:x(Kl,{})})}),x(me,{position:"right",children:x(Ct,{onClick:()=>{if(!i)return;r(e,{sideBarData:{photos:[...n||[],i]}}),In.closeAll()},children:K.confirm})})]})})}function $St({searchQuery:e,filters:t}){const{weapons:n,updateWeapon:r}=j1(),{updateTab:i}=gn(),{dateFormat:a}=tn(),s=I.exports.useMemo(()=>n.filter(l=>{var d,p,h;const u=l.name.toLowerCase().includes(e.toLowerCase())||l.creator.toLowerCase().includes(e.toLowerCase())||((p=(d=l.sideBarData)==null?void 0:d.owners)==null?void 0:p.some(m=>{var g;return(g=m==null?void 0:m.name)==null?void 0:g.toLowerCase().includes(e.toLowerCase())}))||((h=l.serial)==null?void 0:h.toLowerCase().includes(e.toLowerCase()))||l.id.toString()===e;if(!t)return u;const c=t.every(m=>{if(!l.sideBarData)return!1;let g;if(m.type in l.sideBarData?g=l.sideBarData[m.type]:g=l[m.type],Array.isArray(g)&&g.length>0){if(typeof g[0]=="object")return g.some(v=>Object.values(v).some(y=>typeof y=="string"?y.toLowerCase().includes(m.value.toLowerCase()):!1));if(typeof g[0]=="string")return g.some(v=>v.toLowerCase().includes(m.value.toLowerCase()))}return typeof g=="string"?g.toLowerCase().includes(m.value.toLowerCase()):!1});return u&&c}).sort((l,u)=>u.id-l.id),[e,t,n]),o=({index:l,style:u})=>{var d;const c=s[l];return c.id<=-1?null:x("div",{style:{...u},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getWeapon",c.id).then(p=>{!p||!c.id||r(c.id,p)}),i({title:"weapons",component:x(O3,{weaponId:c.id})})},p:10,children:B(me,{spacing:15,children:[x(er,{size:80,src:c.image}),B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:c.name}),B(bt,{radius:"sm",children:["ID: ",c.id]})]}),((d=c==null?void 0:c.sideBarData)==null?void 0:d.owners)&&c.sideBarData.owners.length>0&&B(Te,{w:700,fw:500,size:13,color:"gray.4",style:{overflow:"hidden",wordBreak:"break-all",textOverflow:"ellipsis"},children:[K.owners_list," ",c.sideBarData.owners.map(p=>p.name).join(", ")]}),B(Te,{fw:500,size:12,color:"gray.5",children:[c.creator," - ",new Date(c.date*1e3).toLocaleString([],a||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]})]})]})})})};return x(ta,{height:window.innerHeight*.77,itemCount:s.length,itemSize:110,width:"100%",children:o})}function DA(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200),[r,i]=I.exports.useState(),[a,s]=I.exports.useState([{type:"creator",value:""},{type:"tags",value:""},{type:"owners",value:""}]),{updateTab:o}=gn(),l=()=>{Ne("createWeapon").then(u=>{!u||o({title:"weapons",component:x(O3,{weaponId:u.id})})})};return B(ze,{children:[x(xa,{title:K.weapons,searchQuery:e,filterInputs:a,filters:r,setFilterInputs:s,setFilters:i,setSearchQuery:t,createNew:l}),x($St,{searchQuery:n,filters:r})]})}function O3({weaponId:e}){const{weapons:t,updateWeapon:n}=j1(),{updateTab:r}=gn(),[i,a]=I.exports.useState(t.find(D=>D.id===e)),[s,{open:o,close:l}]=$r(!1),{dateFormat:u}=tn(),[c,d]=I.exports.useState(i==null?void 0:i.image),[p,h]=I.exports.useState(i==null?void 0:i.notes),[m,g]=I.exports.useState(i==null?void 0:i.name),[v,y]=I.exports.useState(i==null?void 0:i.serial),[b]=Kt(p,1e3),[_]=Kt(m,500),[k]=Kt(v,500);I.exports.useEffect(()=>{a(t.find(D=>D.id===e))},[t]),I.exports.useEffect(()=>{d(i==null?void 0:i.image)},[i]),I.exports.useEffect(()=>{i&&b&&n(i.id,{notes:b})},[b]),I.exports.useEffect(()=>{i&&_&&n(i.id,{name:_})},[_]),I.exports.useEffect(()=>{i&&k&&n(i.id,{serial:k})},[k]);const C=I.exports.useCallback(()=>{r({title:"weapons",component:x(DA,{})})},[i,r]),$=I.exports.useCallback(()=>{const D={...i,name:m,serial:v,notes:p};Ne("saveWeapon",D)},[i,p]),N=I.exports.useCallback(()=>{In.openConfirmModal({title:K.are_you_sure_remove,labels:{confirm:K.confirm,cancel:K.cancel},centered:!0,onConfirm:()=>{Ne("removeWeapon",i==null?void 0:i.id),r({title:"weapons",component:x(DA,{})})}})},[i,r]),A=()=>{l(),Ne("hideUI"),Ne("takePhoto","weapon")};return kt("photoTaken",D=>{D.page==="weapon"&&(o(),d(D.url))}),B(ze,{children:[i&&B(me,{spacing:20,children:[x(Bt,{w:"60%",h:"81vh",color:"dark.6",radius:"xs",p:20,shadow:"xs",children:B(Ce,{w:"100%",spacing:25,children:[B(me,{w:"100%",position:"apart",children:[B(me,{w:"85%",children:[x(er,{size:160,src:i.image,onClick:o,sx:{cursor:"pointer"}}),x(An,{w:"75%",h:160,scrollHideDelay:0,scrollbarSize:5,children:B(me,{w:"100%",spacing:10,children:[x(Xe,{label:K.weapon_name,variant:"filled",value:m,onChange:D=>g(D.currentTarget.value),size:"xs"}),x(Xe,{label:K.creator,variant:"filled",readOnly:!0,value:i.creator,size:"xs"}),x(Xe,{label:K.date,variant:"filled",readOnly:!0,value:new Date(i.date*1e3).toLocaleString([],u||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),size:"xs"}),x(Xe,{label:K.serial_number,variant:"filled",value:v,onChange:D=>y(D.currentTarget.value),size:"xs"})]})})]}),x(Ce,{h:160,justify:"flex-start",children:B(me,{spacing:10,children:[x(Fe,{variant:"subtle",color:"blue",onClick:C,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:$,children:x(Us,{})}),x(Fe,{variant:"subtle",color:"red",onClick:N,children:x(go,{})})]})})]}),x(bs,{w:"100%",label:K.notes,minRows:28,maxLength:5e4,value:p,onChange:D=>h(D.currentTarget.value)})]})}),x(ol,{page:"weapon",sidebar:i.sideBarData,pageId:i.id,updateData:n})]}),x(sr,{size:"40%",centered:!0,title:i==null?void 0:i.name,opened:s,onClose:l,withinPortal:!0,children:B(Ce,{spacing:20,children:[x(il,{radius:"md",src:i==null?void 0:i.image}),x(Xe,{label:K.image_url,placeholder:K.url,variant:"filled",value:c,onChange:D=>d(D.currentTarget.value),rightSection:x(Fe,{onClick:A,children:x(Kl,{})})}),x(me,{position:"right",children:x(Ct,{onClick:()=>{!i||(l(),n(i.id,{image:c}))},children:K.confirm})})]})})]})}function TSt({currentWeapons:e,pageId:t,updateData:n}){const[r,i]=I.exports.useState([]),{weapons:a}=j1();I.exports.useEffect(()=>{i(e.map(o=>o.toString()))},[]);const s=()=>{const o=r.map(l=>parseInt(l,10));n(t,{sideBarData:{weapons:o}}),In.closeAll()};return x(ze,{children:B(Ce,{spacing:20,children:[x(Au,{data:a.map(o=>({value:o.id.toString(),label:`${o.name} (ID: ${o.id})`})),value:r,onChange:i,placeholder:K.select_weapons,searchable:!0,clearable:!0,withinPortal:!0,nothingFound:K.nothing_found,limit:25}),x(me,{position:"right",children:x(Ct,{onClick:s,children:K.confirm})})]})})}function NSt({pageTitle:e,sidebar:t,pageId:n,updateData:r}){const[i,{toggle:a}]=$r(!1),{addTab:s}=gn(),{updateVehicle:o}=Th(),{employees:l}=Jo(),{players:u}=RR(),{incidents:c,updateIncident:d}=$d(),{reports:p,updateReport:h}=ju(),{policeReports:m}=Qb(),{updateProfile:g}=js(),{updateProperty:v}=F2(),{weapons:y,updateWeapon:b}=j1(),{evidence:_,updateEvidence:k}=V1(),{updatePoliceReport:C}=Qb(),{tags:$}=Ey(),N=(O,F)=>{const E=async(z,q,H,J)=>{const ee=await z(O);!ee||!r||(q(O,ee),s({title:J,component:H}))};switch(t.title){case"vehicles":E(z=>Ne("getVehicle",z),o,x(VR,{vehiclePlate:O}),"vehicles");break;case"properties":E(z=>Ne("getProperty",z),v,x($ue,{propertyId:O}),"properties");break;case"weapons":E(z=>Ne("getWeapon",z),b,x(O3,{weaponId:O}),"weapons");break;case"evidence":E(z=>Ne("getEvidence",z),k,x(c3,{evidenceId:O}),"evidence");break;case"linkedReports":E(z=>Ne("getReport",z),h,x(I1,{reportId:O}),"reports");break;case"linkedIncidents":case"warrants":case"bolos":F?E(z=>Ne("getReport",z),h,x(I1,{reportId:O}),"reports"):E(z=>Ne("getIncident",z),d,x(tx,{incidentId:O}),"incidents");break;case"linkedPoliceReports":E(z=>Ne("getPoliceReport",z),C,x($de,{reportId:O}),"policeReports");break;case"linkedProfiles":case"employees":case"officers":case"suspects":case"criminals":case"civilians":case"owners":E(z=>Ne("getProfile",z),g,x(u3,{profileId:O}),"profiles");break}},A=()=>{if(!r)return;const O=F=>{In.open({centered:!0,title:K[t.title],children:F})};switch(t.title){case"tags":O(x(dQ,{currentTags:t.data,pageId:n,updateData:r}));break;case"licenses":O(x(bRe,{currentLicenses:t.data,pageId:n,updateData:r}));break;case"evidence":O(x(wRe,{currentEvidence:t.data,pageId:n,updateData:r}));break;case"weapons":O(x(TSt,{currentWeapons:t.data,pageId:n,updateData:r}));break;case"vehicles":O(x(xRe,{currentVehicles:t.data,pageId:n,updateData:r}));break;case"officers":case"criminals":case"suspects":case"civilians":case"owners":O(x(qg,{title:t.title,allPlayers:t.title==="officers"?l:u,currentPlayers:t.data,pageId:n,updateData:r}));break;case"linkedProfiles":O(x(qg,{title:t.title,allPlayers:u,currentPlayers:t.data,pageId:n,includeReason:!0,updateData:r}));break;case"linkedIncidents":O(x(ik,{title:t.title,allReports:c,currentReports:t.data,pageId:n,updateData:r}));break;case"linkedReports":O(x(ik,{title:t.title,allReports:p,currentReports:t.data,pageId:n,updateData:r}));break;case"linkedPoliceReports":O(x(ik,{title:t.title,allReports:m,currentReports:t.data,pageId:n,updateData:r}));break;case"photos":O(x(HI,{pageId:n,currentPhotos:t.data,updateData:r}));break}};t.title==="photos"&&kt("photoTaken",O=>{!r||O.page!=="photos"||In.open({centered:!0,title:t.title,children:x(HI,{pageId:n,currentUrl:O.url,currentPhotos:t.data,updateData:r})})});const D=O=>{if(!r)return;const F=(E,z)=>{r(n,{sideBarData:{[E]:t.data.filter(z)}})};switch(t.title){case"tags":F(t.title,E=>E!==O);break;case"licenses":F(t.title,E=>E!==O);break;case"officers":case"suspects":case"criminals":case"civilians":case"owners":case"linkedProfiles":F(t.title,E=>E.identifier!==O);break;case"vehicles":F(t.title,E=>E.plate!==O);break;case"evidence":case"weapons":F(t.title,E=>E!==O);break;default:F(t.title,E=>E.id!==O);break}};return B(ze,{children:[x(Bt,{w:"100%",h:50,bg:"dark.7",radius:"xs",shadow:"xs",onClick:a,style:{cursor:"pointer"},mb:10,children:B(me,{position:"apart",h:"100%",px:15,children:[x(Te,{size:15,fw:450,children:K[t.title]}),(t.title==="linkedProfiles"||t.title==="tags"||t.title==="licenses"||t.title==="officers"||t.title==="suspects"||t.title==="criminals"||t.title==="civilians"||t.title==="evidence"||t.title==="photos"||t.title==="owners"||e!=="vehicle"&&e!=="profile"&&e!=="evidence"&&e!=="weapon"&&(t.title==="vehicles"||t.title==="linkedIncidents"||t.title==="linkedReports"||t.title==="linkedPoliceReports"||t.title==="weapons"))&&x(Fe,{color:"blue",variant:"subtle",onClick:O=>{O.stopPropagation(),A()},children:x(Oy,{})})]})}),x(ze,{children:x(T2,{in:i,children:x(An.Autosize,{mah:500,type:"always",scrollbarSize:3,pb:15,children:x(me,{spacing:10,pb:5,children:(!(t!=null&&t.data)||t.data.length===0)&&x(bt,{color:"dark",children:K.no_sidebar_data.format(K[t.title])})||(t.title==="jobs"||t.title==="charges")&&t.data.map((O,F)=>x(bt,{children:O},F))||t.title==="tags"&&r&&t.data.map((O,F)=>{const E=$.find(z=>z.name===O);return E?x(bt,{style:{backgroundColor:E.color,color:"#ced4da",textShadow:"0px 1px 2px rgba(0, 0, 0, 1.0"},rightSection:x(Fe,{size:14,variant:"transparent",onClick:()=>D(O),children:x(ui,{})}),children:O},F):null})||t.title==="criminals"&&r&&t.data.map((O,F)=>x(ze,{children:x(kRe,{index:F,incidentId:n,item:O,handleBadgeRemove:D})}))||t.title==="vehicles"&&r&&t.data.map((O,F)=>x(ze,{children:x(CRe,{pageTitle:e,index:F,pageId:n,item:O,canAddBOLO:e!=="profile",handleBadgeRemove:D})}))||(t.title==="driving"||t.title==="shooting"||t.title==="professionalism"||t.title==="generalKnowledge"||t.title==="reports"||t.title==="radio")&&r&&x(mQ,{sidebar:t,pageId:n,updateData:r})||(t.title==="officers"||t.title==="suspects"||t.title==="civilians"||t.title==="owners")&&r&&t.data.map((O,F)=>x(bt,{style:{cursor:"pointer"},onClick:()=>N(O.identifier),rightSection:x(Fe,{size:14,variant:"transparent",onClick:E=>{E.stopPropagation(),D(O.identifier)},children:x(ui,{})}),children:O.name},F))||t.title==="licenses"&&r&&t.data.map((O,F)=>x(bt,{rightSection:x(Fe,{size:14,variant:"transparent",onClick:()=>D(O),children:x(ui,{})}),children:O},F))||t.title==="properties"&&t.data.map((O,F)=>B(bt,{onClick:()=>N(O.id),style:{cursor:"pointer"},children:[O.name," (ID: ",O.id,")"]},F))||t.title==="employees"&&t.data.map((O,F)=>x(bt,{onClick:()=>N(O.identifier),style:{cursor:"pointer"},children:O.name},F))||t.title==="evidence"&&t.data.map((O,F)=>{const E=_.find(z=>z.id===O);return E?x(rs,{p:5,label:x("img",{src:E.image,width:250}),position:"left",color:"dark.6",hidden:!Kg(E.image),withArrow:!0,withinPortal:!0,children:B(bt,{onClick:()=>N(O),style:{cursor:"pointer"},rightSection:x(Fe,{size:14,variant:"transparent",onClick:z=>{z.stopPropagation(),D(O)},children:x(ui,{})}),children:[E.name," - (ID: ",O,")"]})},F):null})||t.title==="weapons"&&t.data.map((O,F)=>{const E=y.find(z=>z.id===O);return E?x(rs,{p:5,label:x("img",{src:E.image,width:250}),position:"left",color:"dark.6",hidden:!Kg(E.image),withArrow:!0,withinPortal:!0,children:B(bt,{onClick:()=>N(O),style:{cursor:"pointer"},rightSection:e!=="profile"&&x(Fe,{size:14,variant:"transparent",onClick:z=>{z.stopPropagation(),D(O)},children:x(ui,{})}),children:[E.name," - (ID: ",O,")"]})},F):null})||(t.title==="linkedReports"||t.title==="linkedIncidents"||t.title==="linkedPoliceReports")&&kg(t.data).map((O,F)=>{let E=null;return t.title==="linkedReports"?E=p.find(z=>z.id===O):t.title==="linkedIncidents"?E=c.find(z=>z.id===O):t.title==="linkedPoliceReports"&&(E=m.find(z=>z.id===O)),E?x(bt,{onClick:()=>N(O),style:{cursor:"pointer"},rightSection:e!=="evidence"&&e!=="weapon"&&e!=="profile"&&e!=="vehicle"&&x(Fe,{size:14,onClick:z=>{z.stopPropagation(),D(O)},children:x(ui,{})}),children:`${E.title} (ID: ${O})`},F):null})||t.title==="warrants"&&t.data.map((O,F)=>B(bt,{onClick:()=>N(O.incidentId),style:{cursor:"pointer"},children:[O.incidentTitle," (ID: ",O.incidentId,")"]},F))||t.title==="bolos"&&t.data.map((O,F)=>B(bt,{onClick:()=>N(O.id,O.isReport),style:{cursor:"pointer"},children:[O.id," (ID: ",O.title,")"]},F))||t.title==="linkedProfiles"&&t.data.map((O,F)=>B(bt,{onClick:()=>N(O.identifier),style:{cursor:"pointer"},rightSection:x(Fe,{size:14,variant:"transparent",onClick:E=>{E.stopPropagation(),D(O.identifier)},children:x(ui,{})}),children:[O.name,": ",O.reason]},F))||t.title==="photos"&&t.data.map((O,F)=>x(rs,{p:5,label:x("img",{src:O,width:576}),position:"left",color:"dark.6",withArrow:!0,withinPortal:!0,children:x(il,{src:O,maw:192,style:{cursor:"pointer"},onClick:()=>{!r||In.openConfirmModal({title:K.are_you_sure,centered:!0,children:x(Te,{size:"sm",children:K.are_you_sure_remove_photo}),labels:{confirm:K.confirm,cancel:K.cancel},onConfirm:()=>r(n,{sideBarData:{photos:t.data.filter(E=>E!==E)}})})}})},F))||t.data.map((O,F)=>x(bt,{children:O},F))})})})})]})}function ol({page:e,sidebar:t,pageId:n,updateData:r}){const{sidebarOrder:i}=tn();if(!t)return null;const a=Object.keys(t).filter(s=>i.includes(s)).sort((s,o)=>{const l=i.indexOf(s),u=i.indexOf(o);return(l===-1?i.length:l)-(u===-1?i.length:u)});return x(An,{w:"38%",h:"81vh",type:"never",children:x(Ce,{justify:"flex-start",h:"100%",spacing:0,children:a.map((s,o)=>x(NSt,{pageTitle:e,sidebar:{title:s,data:t[s]},pageId:n,updateData:r},o))})})}function tx({incidentId:e}){const{incidents:t,updateIncident:n}=$d(),{updateTab:r}=gn(),[i,a]=I.exports.useState(t.find(y=>y.id===e)),{dateFormat:s}=tn(),[o,l]=I.exports.useState(i==null?void 0:i.title),[u]=Kt(o,500),c=I.exports.useRef(0),[d]=Kt(c.current,2500);I.exports.useEffect(()=>{const y=t.find(b=>b.id===e);y&&a(y)},[t,e]);const p=om({extensions:[um,cm,pm,hm,lm,i0,r0,dm.configure({types:["heading","paragraph"]}),fm,mm.configure({limit:1e5})],content:i==null?void 0:i.content}),h=I.exports.useRef(!1);I.exports.useEffect(()=>{!p||!(i!=null&&i.content)||h.current||(h.current=!0,p.commands.setContent(i.content),i!=null&&i.title&&l(i.title))},[p,i]),I.exports.useEffect(()=>{!i||n(i.id,{...i,title:u})},[u]),I.exports.useEffect(()=>{!i||n(i.id,{...i,content:p==null?void 0:p.getHTML()})},[d]),I.exports.useEffect(()=>{if(p){const y=()=>{c.current++};return p.on("update",y),()=>{p.off("update",y)}}},[p]),I.exports.useEffect(()=>{p&&p.setOptions({editorProps:{handlePaste:(y,b,_)=>{const k=b.clipboardData,C=k==null?void 0:k.getData("text/plain");return/https?:\/\/\S+\.(jpg|jpeg|png|gif)/i.test(C||"")&&C?(b.preventDefault(),p.commands.setImage({src:C}),!0):!1}}})},[p]);const m=I.exports.useCallback(()=>{r({title:"incidents",component:x(oP,{})})},[i,r]),g=I.exports.useCallback(()=>{const y={...i,title:o,content:p==null?void 0:p.getHTML()};Ne("saveIncident",y)},[i,o,p]),v=I.exports.useCallback(()=>{In.openConfirmModal({title:K.are_you_sure_remove,labels:{confirm:K.confirm,cancel:K.cancel},centered:!0,onConfirm:()=>{Ne("removeIncident",i==null?void 0:i.id),r({title:"incidents",component:x(oP,{})})}})},[i,r]);return x(ze,{children:i&&B(me,{spacing:20,h:"100%",style:{alignItems:"start"},children:[B(Ce,{w:"60%",h:"100%",justify:"flex-start",spacing:10,children:[x(Bt,{w:"100%",h:80,color:"dark.6",radius:"xs",px:10,shadow:"xs",children:B(Ce,{h:"100%",justify:"center",spacing:5,children:[B(me,{position:"apart",children:[x(Xe,{variant:"filled",value:o||"",onChange:y=>l(y.currentTarget.value),sx:{input:{fontSize:18,fontWeight:630}},w:"60%"}),B(me,{spacing:10,children:[B(bt,{radius:"sm",children:["ID: ",i.id===-1&&"Temporary"||i.id]}),x(Fe,{variant:"subtle",color:"blue",onClick:m,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:g,children:x(Us,{})}),x(Fe,{variant:"subtle",color:"red",onClick:v,children:x(go,{})})]})]}),B(Te,{fw:550,size:12,color:"gray.6",children:[i.creator," - ",new Date(i.date*1e3).toLocaleString([],s||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]})]})}),x(Bt,{w:"100%",h:"100%",color:"dark.7",radius:"xs",p:20,shadow:"xs",children:x(gm,{editor:p})})]}),x(ol,{page:"incident",sidebar:i.sideBarData,pageId:i.id,updateData:n})]})})}function Ki(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function ESt(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const N_=43200,uG=1440;let OSt={};function PSt(){return OSt}function cG(e){const t=Ki(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function yk(e,t){const n=Ki(e),r=Ki(t),i=n.getTime()-r.getTime();return i<0?-1:i>0?1:i}function ASt(e){return ESt(e,Date.now())}function MSt(e,t){const n=Ki(e),r=Ki(t),i=n.getFullYear()-r.getFullYear(),a=n.getMonth()-r.getMonth();return i*12+a}function RSt(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function DSt(e,t){return+Ki(e)-+Ki(t)}function LSt(e){const t=Ki(e);return t.setHours(23,59,59,999),t}function FSt(e){const t=Ki(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function zSt(e){const t=Ki(e);return+LSt(t)==+FSt(t)}function BSt(e,t){const n=Ki(e),r=Ki(t),i=yk(n,r),a=Math.abs(MSt(n,r));let s;if(a<1)s=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*a);let o=yk(n,r)===-i;zSt(Ki(e))&&a===1&&yk(e,r)===1&&(o=!1),s=i*(a-Number(o))}return s===0?0:s}function WSt(e,t,n){const r=DSt(e,t)/1e3;return RSt(n==null?void 0:n.roundingMethod)(r)}const VSt={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},jSt=(e,t,n)=>{let r;const i=VSt[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function WE(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const USt={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},HSt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},GSt={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},qSt={date:WE({formats:USt,defaultWidth:"full"}),time:WE({formats:HSt,defaultWidth:"full"}),dateTime:WE({formats:GSt,defaultWidth:"full"})},KSt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ZSt=(e,t,n,r)=>KSt[e];function H0(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let i;if(r==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):s;i=e.formattingValues[o]||e.formattingValues[s]}else{const s=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;i=e.values[o]||e.values[s]}const a=e.argumentCallback?e.argumentCallback(t):t;return i[a]}}const XSt={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},JSt={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},YSt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},QSt={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},eCt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tCt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},nCt=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},rCt={ordinalNumber:nCt,era:H0({values:XSt,defaultWidth:"wide"}),quarter:H0({values:JSt,defaultWidth:"wide",argumentCallback:e=>e-1}),month:H0({values:YSt,defaultWidth:"wide"}),day:H0({values:QSt,defaultWidth:"wide"}),dayPeriod:H0({values:eCt,defaultWidth:"wide",formattingValues:tCt,defaultFormattingWidth:"wide"})};function G0(e){return(t,n={})=>{const r=n.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],a=t.match(i);if(!a)return null;const s=a[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?aCt(o,d=>d.test(s)):iCt(o,d=>d.test(s));let u;u=e.valueCallback?e.valueCallback(l):l,u=n.valueCallback?n.valueCallback(u):u;const c=t.slice(s.length);return{value:u,rest:c}}}function iCt(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function aCt(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function sCt(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const i=r[0],a=t.match(e.parsePattern);if(!a)return null;let s=e.valueCallback?e.valueCallback(a[0]):a[0];s=n.valueCallback?n.valueCallback(s):s;const o=t.slice(i.length);return{value:s,rest:o}}}const oCt=/^(\d+)(th|st|nd|rd)?/i,lCt=/\d+/i,uCt={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},cCt={any:[/^b/i,/^(a|c)/i]},dCt={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},pCt={any:[/1/i,/2/i,/3/i,/4/i]},hCt={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},fCt={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},mCt={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},gCt={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},yCt={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},vCt={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},bCt={ordinalNumber:sCt({matchPattern:oCt,parsePattern:lCt,valueCallback:e=>parseInt(e,10)}),era:G0({matchPatterns:uCt,defaultMatchWidth:"wide",parsePatterns:cCt,defaultParseWidth:"any"}),quarter:G0({matchPatterns:dCt,defaultMatchWidth:"wide",parsePatterns:pCt,defaultParseWidth:"any",valueCallback:e=>e+1}),month:G0({matchPatterns:hCt,defaultMatchWidth:"wide",parsePatterns:fCt,defaultParseWidth:"any"}),day:G0({matchPatterns:mCt,defaultMatchWidth:"wide",parsePatterns:gCt,defaultParseWidth:"any"}),dayPeriod:G0({matchPatterns:yCt,defaultMatchWidth:"any",parsePatterns:vCt,defaultParseWidth:"any"})},wCt={code:"en-US",formatDistance:jSt,formatLong:qSt,formatRelative:ZSt,localize:rCt,match:bCt,options:{weekStartsOn:0,firstWeekContainsDate:1}};function xCt(e,t,n){var m,g;const r=PSt(),i=(g=(m=n==null?void 0:n.locale)!=null?m:r.locale)!=null?g:wCt,a=2520,s=yk(e,t);if(isNaN(s))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:s});let l,u;s>0?(l=Ki(t),u=Ki(e)):(l=Ki(e),u=Ki(t));const c=WSt(u,l),d=(cG(u)-cG(l))/1e3,p=Math.round((c-d)/60);let h;if(p<2)return n!=null&&n.includeSeconds?c<5?i.formatDistance("lessThanXSeconds",5,o):c<10?i.formatDistance("lessThanXSeconds",10,o):c<20?i.formatDistance("lessThanXSeconds",20,o):c<40?i.formatDistance("halfAMinute",0,o):c<60?i.formatDistance("lessThanXMinutes",1,o):i.formatDistance("xMinutes",1,o):p===0?i.formatDistance("lessThanXMinutes",1,o):i.formatDistance("xMinutes",p,o);if(p<45)return i.formatDistance("xMinutes",p,o);if(p<90)return i.formatDistance("aboutXHours",1,o);if(p<uG){const v=Math.round(p/60);return i.formatDistance("aboutXHours",v,o)}else{if(p<a)return i.formatDistance("xDays",1,o);if(p<N_){const v=Math.round(p/uG);return i.formatDistance("xDays",v,o)}else if(p<N_*2)return h=Math.round(p/N_),i.formatDistance("aboutXMonths",h,o)}if(h=BSt(u,l),h<12){const v=Math.round(p/N_);return i.formatDistance("xMonths",v,o)}else{const v=h%12,y=Math.trunc(h/12);return v<3?i.formatDistance("aboutXYears",y,o):v<9?i.formatDistance("overXYears",y,o):i.formatDistance("almostXYears",y+1,o)}}function P3(e,t){return xCt(e,ASt(e),t)}function _Ct(){const{addTab:e}=gn(),{profiles:t}=js(),[n,r]=I.exports.useState(t.filter(c=>{var d;return((d=c.sideBarData)==null?void 0:d.warrants)&&c.sideBarData.warrants.length>0})),[i,a]=I.exports.useState(""),[s]=Kt(i,200);I.exports.useEffect(()=>{r(t.filter(c=>{var d;return((d=c.sideBarData)==null?void 0:d.warrants)&&c.sideBarData.warrants.length>0}))},[t]);const o=I.exports.useMemo(()=>n.filter(c=>{var d,p;return((d=c==null?void 0:c.name)==null?void 0:d.toLowerCase().includes(s.toLowerCase()))||((p=c==null?void 0:c.identifier)==null?void 0:p.toLowerCase().includes(s.toLowerCase()))}),[s,n]),l=I.exports.useMemo(()=>o.flatMap(c=>{var d,p;return(p=(d=c.sideBarData)==null?void 0:d.warrants)==null?void 0:p.map(h=>({...h,profile:c}))}),[o]),u=({index:c,style:d})=>{const p=l[c],h=p==null?void 0:p.profile;return!p||!h?null:B("div",{style:d,children:[x(Ct,{w:"100%",h:70,variant:"subtle",color:"gray",styles:{inner:{justifyContent:"start"}},leftIcon:x(er,{size:40,src:h.image}),onClick:()=>e({title:"incidents",component:x(tx,{incidentId:p.incidentId})}),children:B(Ce,{w:"100%",spacing:1,align:"flex-start",children:[p.expires&&B(bt,{color:"gray",px:5,children:[K.expires," ",P3(p.expires,{addSuffix:!0})]}),x(Te,{fw:650,size:15,children:h.name}),B(Te,{size:13,style:{wordBreak:"break-all"},children:[p.incidentTitle," (ID: ",p.incidentId,")"]})]})}),x(Ds,{w:"90%",ml:"5%"})]},`${h.identifier}-${p.incidentId}`)};return x(Bt,{w:450,h:"50%",shadow:"sm",p:"sm",children:B(Ce,{p:20,pt:0,h:"100%",children:[x(Te,{fw:700,size:20,align:"center",children:K.warrants}),x(Bt,{h:"30vh",p:"sm",bg:"dark.8",withBorder:!0,children:B(Ce,{h:"100%",justify:"flex-start",spacing:10,children:[x(Xe,{placeholder:K.search,rightSection:x(B2,{}),w:"100%",value:i,onChange:c=>a(c.currentTarget.value)}),n.length===0?x(Te,{fw:450,size:14,align:"center",color:"gray.6",mt:"10vh",children:K.no_warrants_yet}):x(ta,{height:innerHeight*.3,itemCount:l.length,itemSize:75,width:"100%",children:u})]})})]})})}function kCt(){const{addTab:e}=gn(),{vehicles:t}=Th(),{updateIncident:n}=$d(),{updateReport:r}=ju(),[i,a]=I.exports.useState(t.filter(p=>{var h;return((h=p.sideBarData)==null?void 0:h.bolos)&&p.sideBarData.bolos.length>0})),[s,o]=I.exports.useState(""),[l]=Kt(s,200);I.exports.useEffect(()=>{a(t.filter(p=>{var h;return((h=p.sideBarData)==null?void 0:h.bolos)&&p.sideBarData.bolos.length>0}))},[t]);const u=I.exports.useMemo(()=>i.filter(p=>{var h,m,g;return((h=p==null?void 0:p.name)==null?void 0:h.toLowerCase().includes(l.toLowerCase()))||((m=p==null?void 0:p.owner)==null?void 0:m.toLowerCase().includes(l.toLowerCase()))||((g=p==null?void 0:p.plate)==null?void 0:g.toLowerCase().includes(l.toLowerCase()))}),[l,i]),c=I.exports.useMemo(()=>u.flatMap(p=>{var h,m;return(m=(h=p.sideBarData)==null?void 0:h.bolos)==null?void 0:m.map(g=>({...g,vehicle:p}))}),[u]),d=({index:p,style:h})=>{const m=c[p],g=m==null?void 0:m.vehicle;return!m||!g?null:B("div",{style:h,children:[x(Ct,{h:70,w:"100%",variant:"subtle",color:"gray",styles:{inner:{justifyContent:"start"}},leftIcon:x(er,{size:40,src:g.image}),onClick:()=>{m.isReport?(Ne("getReport",m.id).then(v=>{!v||!m.id||r(m.id,v)}),e({title:"reports",component:x(I1,{reportId:m.id})})):(Ne("getIncident",m.id).then(v=>{!v||!m.id||n(m.id,v)}),e({title:"incidents",component:x(tx,{incidentId:m.id})}))},children:B(Ce,{w:"100%",spacing:1,align:"flex-start",children:[m.expires&&B(bt,{color:"gray",px:5,children:[K.expires," ",P3(m.expires,{addSuffix:!0})]}),B(Te,{fw:650,size:15,children:[g.name," [",g.plate,"]"]}),B(Te,{size:13,style:{wordBreak:"break-all"},children:[m.title," (ID: ",m.id,")"]})]})}),x(Ds,{w:"90%",ml:"5%"})]},`${g.plate}-${m.id}`)};return x(Bt,{w:450,h:"50%",shadow:"sm",p:"sm",children:B(Ce,{p:20,pt:0,h:"100%",children:[x(Te,{fw:700,size:20,align:"center",children:K.bolos}),x(Bt,{h:"30vh",p:"sm",bg:"dark.8",withBorder:!0,children:B(Ce,{h:"100%",justify:"flex-start",spacing:10,children:[x(Xe,{placeholder:K.search,rightSection:x(B2,{}),w:"100%",value:s,onChange:p=>o(p.currentTarget.value)}),i.length===0?x(Te,{fw:450,size:14,align:"center",color:"gray.6",mt:"10vh",children:K.no_bolos_yet}):x(ta,{height:innerHeight*.3,itemCount:c.length,itemSize:75,width:"100%",children:d})]})})]})})}function SCt(){return x(SR,{children:B(me,{position:"apart",spacing:30,h:"80vh",children:[x(FMe,{}),x(zMe,{}),B(Ce,{spacing:30,h:"100%",children:[x(_Ct,{}),x(kCt,{})]})]})})}function Tde(e,t){const n=I.exports.useRef(t);I.exports.useEffect(function(){t!==n.current&&e.attributionControl!=null&&(n.current!=null&&e.attributionControl.removeAttribution(n.current),t!=null&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}const CCt=1;function ICt(e){return Object.freeze({__version:CCt,map:e})}function $Ct(e,t){return Object.freeze({...e,...t})}const Nde=I.exports.createContext(null),Ede=Nde.Provider;function Ode(){const e=I.exports.useContext(Nde);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function TCt(e){function t(n,r){const{instance:i,context:a}=e(n).current;return I.exports.useImperativeHandle(r,()=>i),n.children==null?null:x(Ede,{value:a,children:n.children})}return I.exports.forwardRef(t)}function NCt(e){function t(n,r){const[i,a]=I.exports.useState(!1),{instance:s}=e(n,a).current;I.exports.useImperativeHandle(r,()=>s),I.exports.useEffect(function(){i&&s.update()},[s,i,n.children]);const o=s._contentNode;return o?ql.exports.createPortal(n.children,o):null}return I.exports.forwardRef(t)}function ECt(e){function t(n,r){const{instance:i}=e(n).current;return I.exports.useImperativeHandle(r,()=>i),null}return I.exports.forwardRef(t)}function Pde(e,t){const n=I.exports.useRef();I.exports.useEffect(function(){return t!=null&&e.instance.on(t),n.current=t,function(){n.current!=null&&e.instance.off(n.current),n.current=null}},[e,t])}function A3(e,t){var r;const n=(r=e.pane)!=null?r:t.pane;return n?{...e,pane:n}:e}function OCt(e,t){return function(r,i){const a=Ode(),s=e(A3(r,a),a);return Tde(a.map,r.attribution),Pde(s.current,r.eventHandlers),t(s.current,a,r,i),s}}var wd={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,r){r(t)})(hhe,function(n){var r="1.9.4";function i(f){var w,S,T,R;for(S=1,T=arguments.length;S<T;S++){R=arguments[S];for(w in R)f[w]=R[w]}return f}var a=Object.create||function(){function f(){}return function(w){return f.prototype=w,new f}}();function s(f,w){var S=Array.prototype.slice;if(f.bind)return f.bind.apply(f,S.call(arguments,1));var T=S.call(arguments,2);return function(){return f.apply(w,T.length?T.concat(S.call(arguments)):arguments)}}var o=0;function l(f){return"_leaflet_id"in f||(f._leaflet_id=++o),f._leaflet_id}function u(f,w,S){var T,R,j,ie;return ie=function(){T=!1,R&&(j.apply(S,R),R=!1)},j=function(){T?R=arguments:(f.apply(S,arguments),setTimeout(ie,w),T=!0)},j}function c(f,w,S){var T=w[1],R=w[0],j=T-R;return f===T&&S?f:((f-R)%j+j)%j+R}function d(){return!1}function p(f,w){if(w===!1)return f;var S=Math.pow(10,w===void 0?6:w);return Math.round(f*S)/S}function h(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function m(f){return h(f).split(/\s+/)}function g(f,w){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?a(f.options):{});for(var S in w)f.options[S]=w[S];return f.options}function v(f,w,S){var T=[];for(var R in f)T.push(encodeURIComponent(S?R.toUpperCase():R)+"="+encodeURIComponent(f[R]));return(!w||w.indexOf("?")===-1?"?":"&")+T.join("&")}var y=/\{ *([\w_ -]+) *\}/g;function b(f,w){return f.replace(y,function(S,T){var R=w[T];if(R===void 0)throw new Error("No value provided for variable "+S);return typeof R=="function"&&(R=R(w)),R})}var _=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function k(f,w){for(var S=0;S<f.length;S++)if(f[S]===w)return S;return-1}var C="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function $(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var N=0;function A(f){var w=+new Date,S=Math.max(0,16-(w-N));return N=w+S,window.setTimeout(f,S)}var D=window.requestAnimationFrame||$("RequestAnimationFrame")||A,O=window.cancelAnimationFrame||$("CancelAnimationFrame")||$("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function F(f,w,S){if(S&&D===A)f.call(w);else return D.call(window,s(f,w))}function E(f){f&&O.call(window,f)}var z={__proto__:null,extend:i,create:a,bind:s,get lastId(){return o},stamp:l,throttle:u,wrapNum:c,falseFn:d,formatNum:p,trim:h,splitWords:m,setOptions:g,getParamString:v,template:b,isArray:_,indexOf:k,emptyImageUrl:C,requestFn:D,cancelFn:O,requestAnimFrame:F,cancelAnimFrame:E};function q(){}q.extend=function(f){var w=function(){g(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},S=w.__super__=this.prototype,T=a(S);T.constructor=w,w.prototype=T;for(var R in this)Object.prototype.hasOwnProperty.call(this,R)&&R!=="prototype"&&R!=="__super__"&&(w[R]=this[R]);return f.statics&&i(w,f.statics),f.includes&&(H(f.includes),i.apply(null,[T].concat(f.includes))),i(T,f),delete T.statics,delete T.includes,T.options&&(T.options=S.options?a(S.options):{},i(T.options,f.options)),T._initHooks=[],T.callInitHooks=function(){if(!this._initHooksCalled){S.callInitHooks&&S.callInitHooks.call(this),this._initHooksCalled=!0;for(var j=0,ie=T._initHooks.length;j<ie;j++)T._initHooks[j].call(this)}},w},q.include=function(f){var w=this.prototype.options;return i(this.prototype,f),f.options&&(this.prototype.options=w,this.mergeOptions(f.options)),this},q.mergeOptions=function(f){return i(this.prototype.options,f),this},q.addInitHook=function(f){var w=Array.prototype.slice.call(arguments,1),S=typeof f=="function"?f:function(){this[f].apply(this,w)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(S),this};function H(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=_(f)?f:[f];for(var w=0;w<f.length;w++)f[w]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var J={on:function(f,w,S){if(typeof f=="object")for(var T in f)this._on(T,f[T],w);else{f=m(f);for(var R=0,j=f.length;R<j;R++)this._on(f[R],w,S)}return this},off:function(f,w,S){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var T in f)this._off(T,f[T],w);else{f=m(f);for(var R=arguments.length===1,j=0,ie=f.length;j<ie;j++)R?this._off(f[j]):this._off(f[j],w,S)}return this},_on:function(f,w,S,T){if(typeof w!="function"){console.warn("wrong listener type: "+typeof w);return}if(this._listens(f,w,S)===!1){S===this&&(S=void 0);var R={fn:w,ctx:S};T&&(R.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(R)}},_off:function(f,w,S){var T,R,j;if(!!this._events&&(T=this._events[f],!!T)){if(arguments.length===1){if(this._firingCount)for(R=0,j=T.length;R<j;R++)T[R].fn=d;delete this._events[f];return}if(typeof w!="function"){console.warn("wrong listener type: "+typeof w);return}var ie=this._listens(f,w,S);if(ie!==!1){var ge=T[ie];this._firingCount&&(ge.fn=d,this._events[f]=T=T.slice()),T.splice(ie,1)}}},fire:function(f,w,S){if(!this.listens(f,S))return this;var T=i({},w,{type:f,target:this,sourceTarget:w&&w.sourceTarget||this});if(this._events){var R=this._events[f];if(R){this._firingCount=this._firingCount+1||1;for(var j=0,ie=R.length;j<ie;j++){var ge=R[j],be=ge.fn;ge.once&&this.off(f,be,ge.ctx),be.call(ge.ctx||this,T)}this._firingCount--}}return S&&this._propagateEvent(T),this},listens:function(f,w,S,T){typeof f!="string"&&console.warn('"string" type argument expected');var R=w;typeof w!="function"&&(T=!!w,R=void 0,S=void 0);var j=this._events&&this._events[f];if(j&&j.length&&this._listens(f,R,S)!==!1)return!0;if(T){for(var ie in this._eventParents)if(this._eventParents[ie].listens(f,w,S,T))return!0}return!1},_listens:function(f,w,S){if(!this._events)return!1;var T=this._events[f]||[];if(!w)return!!T.length;S===this&&(S=void 0);for(var R=0,j=T.length;R<j;R++)if(T[R].fn===w&&T[R].ctx===S)return R;return!1},once:function(f,w,S){if(typeof f=="object")for(var T in f)this._on(T,f[T],w,!0);else{f=m(f);for(var R=0,j=f.length;R<j;R++)this._on(f[R],w,S,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[l(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[l(f)],this},_propagateEvent:function(f){for(var w in this._eventParents)this._eventParents[w].fire(f.type,i({layer:f.target,propagatedFrom:f.target},f),!0)}};J.addEventListener=J.on,J.removeEventListener=J.clearAllEventListeners=J.off,J.addOneTimeEventListener=J.once,J.fireEvent=J.fire,J.hasEventListeners=J.listens;var ee=q.extend(J);function V(f,w,S){this.x=S?Math.round(f):f,this.y=S?Math.round(w):w}var Q=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};V.prototype={clone:function(){return new V(this.x,this.y)},add:function(f){return this.clone()._add(X(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(X(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new V(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new V(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Q(this.x),this.y=Q(this.y),this},distanceTo:function(f){f=X(f);var w=f.x-this.x,S=f.y-this.y;return Math.sqrt(w*w+S*S)},equals:function(f){return f=X(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=X(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function X(f,w,S){return f instanceof V?f:_(f)?new V(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new V(f.x,f.y):new V(f,w,S)}function Y(f,w){if(!!f)for(var S=w?[f,w]:f,T=0,R=S.length;T<R;T++)this.extend(S[T])}Y.prototype={extend:function(f){var w,S;if(!f)return this;if(f instanceof V||typeof f[0]=="number"||"x"in f)w=S=X(f);else if(f=ce(f),w=f.min,S=f.max,!w||!S)return this;return!this.min&&!this.max?(this.min=w.clone(),this.max=S.clone()):(this.min.x=Math.min(w.x,this.min.x),this.max.x=Math.max(S.x,this.max.x),this.min.y=Math.min(w.y,this.min.y),this.max.y=Math.max(S.y,this.max.y)),this},getCenter:function(f){return X((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return X(this.min.x,this.max.y)},getTopRight:function(){return X(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var w,S;return typeof f[0]=="number"||f instanceof V?f=X(f):f=ce(f),f instanceof Y?(w=f.min,S=f.max):w=S=f,w.x>=this.min.x&&S.x<=this.max.x&&w.y>=this.min.y&&S.y<=this.max.y},intersects:function(f){f=ce(f);var w=this.min,S=this.max,T=f.min,R=f.max,j=R.x>=w.x&&T.x<=S.x,ie=R.y>=w.y&&T.y<=S.y;return j&&ie},overlaps:function(f){f=ce(f);var w=this.min,S=this.max,T=f.min,R=f.max,j=R.x>w.x&&T.x<S.x,ie=R.y>w.y&&T.y<S.y;return j&&ie},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var w=this.min,S=this.max,T=Math.abs(w.x-S.x)*f,R=Math.abs(w.y-S.y)*f;return ce(X(w.x-T,w.y-R),X(S.x+T,S.y+R))},equals:function(f){return f?(f=ce(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function ce(f,w){return!f||f instanceof Y?f:new Y(f,w)}function pe(f,w){if(!!f)for(var S=w?[f,w]:f,T=0,R=S.length;T<R;T++)this.extend(S[T])}pe.prototype={extend:function(f){var w=this._southWest,S=this._northEast,T,R;if(f instanceof ye)T=f,R=f;else if(f instanceof pe){if(T=f._southWest,R=f._northEast,!T||!R)return this}else return f?this.extend(_e(f)||fe(f)):this;return!w&&!S?(this._southWest=new ye(T.lat,T.lng),this._northEast=new ye(R.lat,R.lng)):(w.lat=Math.min(T.lat,w.lat),w.lng=Math.min(T.lng,w.lng),S.lat=Math.max(R.lat,S.lat),S.lng=Math.max(R.lng,S.lng)),this},pad:function(f){var w=this._southWest,S=this._northEast,T=Math.abs(w.lat-S.lat)*f,R=Math.abs(w.lng-S.lng)*f;return new pe(new ye(w.lat-T,w.lng-R),new ye(S.lat+T,S.lng+R))},getCenter:function(){return new ye((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ye(this.getNorth(),this.getWest())},getSouthEast:function(){return new ye(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof ye||"lat"in f?f=_e(f):f=fe(f);var w=this._southWest,S=this._northEast,T,R;return f instanceof pe?(T=f.getSouthWest(),R=f.getNorthEast()):T=R=f,T.lat>=w.lat&&R.lat<=S.lat&&T.lng>=w.lng&&R.lng<=S.lng},intersects:function(f){f=fe(f);var w=this._southWest,S=this._northEast,T=f.getSouthWest(),R=f.getNorthEast(),j=R.lat>=w.lat&&T.lat<=S.lat,ie=R.lng>=w.lng&&T.lng<=S.lng;return j&&ie},overlaps:function(f){f=fe(f);var w=this._southWest,S=this._northEast,T=f.getSouthWest(),R=f.getNorthEast(),j=R.lat>w.lat&&T.lat<S.lat,ie=R.lng>w.lng&&T.lng<S.lng;return j&&ie},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,w){return f?(f=fe(f),this._southWest.equals(f.getSouthWest(),w)&&this._northEast.equals(f.getNorthEast(),w)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function fe(f,w){return f instanceof pe?f:new pe(f,w)}function ye(f,w,S){if(isNaN(f)||isNaN(w))throw new Error("Invalid LatLng object: ("+f+", "+w+")");this.lat=+f,this.lng=+w,S!==void 0&&(this.alt=+S)}ye.prototype={equals:function(f,w){if(!f)return!1;f=_e(f);var S=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return S<=(w===void 0?1e-9:w)},toString:function(f){return"LatLng("+p(this.lat,f)+", "+p(this.lng,f)+")"},distanceTo:function(f){return Se.distance(this,_e(f))},wrap:function(){return Se.wrapLatLng(this)},toBounds:function(f){var w=180*f/40075017,S=w/Math.cos(Math.PI/180*this.lat);return fe([this.lat-w,this.lng-S],[this.lat+w,this.lng+S])},clone:function(){return new ye(this.lat,this.lng,this.alt)}};function _e(f,w,S){return f instanceof ye?f:_(f)&&typeof f[0]!="object"?f.length===3?new ye(f[0],f[1],f[2]):f.length===2?new ye(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new ye(f.lat,"lng"in f?f.lng:f.lon,f.alt):w===void 0?null:new ye(f,w,S)}var Ee={latLngToPoint:function(f,w){var S=this.projection.project(f),T=this.scale(w);return this.transformation._transform(S,T)},pointToLatLng:function(f,w){var S=this.scale(w),T=this.transformation.untransform(f,S);return this.projection.unproject(T)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var w=this.projection.bounds,S=this.scale(f),T=this.transformation.transform(w.min,S),R=this.transformation.transform(w.max,S);return new Y(T,R)},infinite:!1,wrapLatLng:function(f){var w=this.wrapLng?c(f.lng,this.wrapLng,!0):f.lng,S=this.wrapLat?c(f.lat,this.wrapLat,!0):f.lat,T=f.alt;return new ye(S,w,T)},wrapLatLngBounds:function(f){var w=f.getCenter(),S=this.wrapLatLng(w),T=w.lat-S.lat,R=w.lng-S.lng;if(T===0&&R===0)return f;var j=f.getSouthWest(),ie=f.getNorthEast(),ge=new ye(j.lat-T,j.lng-R),be=new ye(ie.lat-T,ie.lng-R);return new pe(ge,be)}},Se=i({},Ee,{wrapLng:[-180,180],R:6371e3,distance:function(f,w){var S=Math.PI/180,T=f.lat*S,R=w.lat*S,j=Math.sin((w.lat-f.lat)*S/2),ie=Math.sin((w.lng-f.lng)*S/2),ge=j*j+Math.cos(T)*Math.cos(R)*ie*ie,be=2*Math.atan2(Math.sqrt(ge),Math.sqrt(1-ge));return this.R*be}}),Re=6378137,Ze={R:Re,MAX_LATITUDE:85.0511287798,project:function(f){var w=Math.PI/180,S=this.MAX_LATITUDE,T=Math.max(Math.min(S,f.lat),-S),R=Math.sin(T*w);return new V(this.R*f.lng*w,this.R*Math.log((1+R)/(1-R))/2)},unproject:function(f){var w=180/Math.PI;return new ye((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*w,f.x*w/this.R)},bounds:function(){var f=Re*Math.PI;return new Y([-f,-f],[f,f])}()};function at(f,w,S,T){if(_(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=w,this._c=S,this._d=T}at.prototype={transform:function(f,w){return this._transform(f.clone(),w)},_transform:function(f,w){return w=w||1,f.x=w*(this._a*f.x+this._b),f.y=w*(this._c*f.y+this._d),f},untransform:function(f,w){return w=w||1,new V((f.x/w-this._b)/this._a,(f.y/w-this._d)/this._c)}};function Je(f,w,S,T){return new at(f,w,S,T)}var st=i({},Se,{code:"EPSG:3857",projection:Ze,transformation:function(){var f=.5/(Math.PI*Ze.R);return Je(f,.5,-f,.5)}()}),He=i({},st,{code:"EPSG:900913"});function xt(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function gt(f,w){var S="",T,R,j,ie,ge,be;for(T=0,j=f.length;T<j;T++){for(ge=f[T],R=0,ie=ge.length;R<ie;R++)be=ge[R],S+=(R?"L":"M")+be.x+" "+be.y;S+=w?Ue.svg?"z":"x":""}return S||"M0 0"}var ft=document.documentElement.style,Ft="ActiveXObject"in window,Hn=Ft&&!document.addEventListener,_t="msLaunchUri"in navigator&&!("documentMode"in document),bn=an("webkit"),Jt=an("android"),Mt=an("android 2")||an("android 3"),Rn=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Gn=Jt&&an("Google")&&Rn<537&&!("AudioNode"in window),wn=!!window.opera,$n=!_t&&an("chrome"),cn=an("gecko")&&!bn&&!wn&&!Ft,Nr=!$n&&an("safari"),wi=an("phantom"),tr="OTransition"in ft,$a=navigator.platform.indexOf("Win")===0,yn=Ft&&"transition"in ft,Ge="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Mt,rt="MozPerspective"in ft,xi=!window.L_DISABLE_3D&&(yn||Ge||rt)&&!tr&&!wi,Tn=typeof orientation<"u"||an("mobile"),qn=Tn&&bn,ii=Tn&&Ge,Rr=!window.PointerEvent&&window.MSPointerEvent,Kn=!!(window.PointerEvent||Rr),Dn="ontouchstart"in window||!!window.TouchEvent,se=!window.L_NO_TOUCH&&(Dn||Kn),Xn=Tn&&wn,nr=Tn&&cn,ve=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ie=function(){var f=!1;try{var w=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",d,w),window.removeEventListener("testPassiveEventSupport",d,w)}catch{}return f}(),Ye=function(){return!!document.createElement("canvas").getContext}(),Le=!!(document.createElementNS&&xt("svg").createSVGRect),Lt=!!Le&&function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Zt=!Le&&function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var w=f.firstChild;return w.style.behavior="url(#default#VML)",w&&typeof w.adj=="object"}catch{return!1}}(),$t=navigator.platform.indexOf("Mac")===0,St=navigator.platform.indexOf("Linux")===0;function an(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var Ue={ie:Ft,ielt9:Hn,edge:_t,webkit:bn,android:Jt,android23:Mt,androidStock:Gn,opera:wn,chrome:$n,gecko:cn,safari:Nr,phantom:wi,opera12:tr,win:$a,ie3d:yn,webkit3d:Ge,gecko3d:rt,any3d:xi,mobile:Tn,mobileWebkit:qn,mobileWebkit3d:ii,msPointer:Rr,pointer:Kn,touch:se,touchNative:Dn,mobileOpera:Xn,mobileGecko:nr,retina:ve,passiveEvents:Ie,canvas:Ye,svg:Le,vml:Zt,inlineSvg:Lt,mac:$t,linux:St},Li=Ue.msPointer?"MSPointerDown":"pointerdown",xo=Ue.msPointer?"MSPointerMove":"pointermove",_s=Ue.msPointer?"MSPointerUp":"pointerup",nt=Ue.msPointer?"MSPointerCancel":"pointercancel",Et={touchstart:Li,touchmove:xo,touchend:_s,touchcancel:nt},Ln={touchstart:eu,touchmove:Ql,touchend:Ql,touchcancel:Ql},Ot={},_o=!1;function Fi(f,w,S){return w==="touchstart"&&ko(),Ln[w]?(S=Ln[w].bind(this,S),f.addEventListener(Et[w],S,!1),S):(console.warn("wrong event specified:",w),d)}function ym(f,w,S){if(!Et[w]){console.warn("wrong event specified:",w);return}f.removeEventListener(Et[w],S,!1)}function s0(f){Ot[f.pointerId]=f}function o0(f){Ot[f.pointerId]&&(Ot[f.pointerId]=f)}function rr(f){delete Ot[f.pointerId]}function ko(){_o||(document.addEventListener(Li,s0,!0),document.addEventListener(xo,o0,!0),document.addEventListener(_s,rr,!0),document.addEventListener(nt,rr,!0),_o=!0)}function Ql(f,w){if(w.pointerType!==(w.MSPOINTER_TYPE_MOUSE||"mouse")){w.touches=[];for(var S in Ot)w.touches.push(Ot[S]);w.changedTouches=[w],f(w)}}function eu(f,w){w.MSPOINTER_TYPE_TOUCH&&w.pointerType===w.MSPOINTER_TYPE_TOUCH&&Gr(w),Ql(f,w)}function l0(f){var w={},S,T;for(T in f)S=f[T],w[T]=S&&S.bind?S.bind(f):S;return f=w,w.type="dblclick",w.detail=2,w.isTrusted=!1,w._simulated=!0,w}var Zd=200;function u0(f,w){f.addEventListener("dblclick",w);var S=0,T;function R(j){if(j.detail!==1){T=j.detail;return}if(!(j.pointerType==="mouse"||j.sourceCapabilities&&!j.sourceCapabilities.firesTouchEvents)){var ie=ix(j);if(!(ie.some(function(be){return be instanceof HTMLLabelElement&&be.attributes.for})&&!ie.some(function(be){return be instanceof HTMLInputElement||be instanceof HTMLSelectElement}))){var ge=Date.now();ge-S<=Zd?(T++,T===2&&w(l0(j))):T=1,S=ge}}}return f.addEventListener("click",R),{dblclick:w,simDblclick:R}}function c0(f,w){f.removeEventListener("dblclick",w.dblclick),f.removeEventListener("click",w.simDblclick)}var Xd=Jd(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),zi=Jd(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),vt=zi==="webkitTransition"||zi==="OTransition"?zi+"End":"transitionend";function xn(f){return typeof f=="string"?document.getElementById(f):f}function Hr(f,w){var S=f.style[w]||f.currentStyle&&f.currentStyle[w];if((!S||S==="auto")&&document.defaultView){var T=document.defaultView.getComputedStyle(f,null);S=T?T[w]:null}return S==="auto"?null:S}function Wt(f,w,S){var T=document.createElement(f);return T.className=w||"",S&&S.appendChild(T),T}function fn(f){var w=f.parentNode;w&&w.removeChild(f)}function Bi(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function Ta(f){var w=f.parentNode;w&&w.lastChild!==f&&w.appendChild(f)}function ra(f){var w=f.parentNode;w&&w.firstChild!==f&&w.insertBefore(f,w.firstChild)}function d0(f,w){if(f.classList!==void 0)return f.classList.contains(w);var S=vm(f);return S.length>0&&new RegExp("(^|\\s)"+w+"(\\s|$)").test(S)}function Vt(f,w){if(f.classList!==void 0)for(var S=m(w),T=0,R=S.length;T<R;T++)f.classList.add(S[T]);else if(!d0(f,w)){var j=vm(f);p0(f,(j?j+" ":"")+w)}}function gr(f,w){f.classList!==void 0?f.classList.remove(w):p0(f,h((" "+vm(f)+" ").replace(" "+w+" "," ")))}function p0(f,w){f.className.baseVal===void 0?f.className=w:f.className.baseVal=w}function vm(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function Xa(f,w){"opacity"in f.style?f.style.opacity=w:"filter"in f.style&&DT(f,w)}function DT(f,w){var S=!1,T="DXImageTransform.Microsoft.Alpha";try{S=f.filters.item(T)}catch{if(w===1)return}w=Math.round(w*100),S?(S.Enabled=w!==100,S.Opacity=w):f.style.filter+=" progid:"+T+"(opacity="+w+")"}function Jd(f){for(var w=document.documentElement.style,S=0;S<f.length;S++)if(f[S]in w)return f[S];return!1}function qs(f,w,S){var T=w||new V(0,0);f.style[Xd]=(Ue.ie3d?"translate("+T.x+"px,"+T.y+"px)":"translate3d("+T.x+"px,"+T.y+"px,0)")+(S?" scale("+S+")":"")}function _r(f,w){f._leaflet_pos=w,Ue.any3d?qs(f,w):(f.style.left=w.x+"px",f.style.top=w.y+"px")}function ll(f){return f._leaflet_pos||new V(0,0)}var Qu,tu,bm;if("onselectstart"in document)Qu=function(){ue(window,"selectstart",Gr)},tu=function(){je(window,"selectstart",Gr)};else{var ec=Jd(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Qu=function(){if(ec){var f=document.documentElement.style;bm=f[ec],f[ec]="none"}},tu=function(){ec&&(document.documentElement.style[ec]=bm,bm=void 0)}}function Yd(){ue(window,"dragstart",Gr)}function tc(){je(window,"dragstart",Gr)}var nu,nc;function wm(f){for(;f.tabIndex===-1;)f=f.parentNode;!f.style||(ru(),nu=f,nc=f.style.outlineStyle,f.style.outlineStyle="none",ue(window,"keydown",ru))}function ru(){!nu||(nu.style.outlineStyle=nc,nu=void 0,nc=void 0,je(window,"keydown",ru))}function Qd(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function h0(f){var w=f.getBoundingClientRect();return{x:w.width/f.offsetWidth||1,y:w.height/f.offsetHeight||1,boundingClientRect:w}}var te={__proto__:null,TRANSFORM:Xd,TRANSITION:zi,TRANSITION_END:vt,get:xn,getStyle:Hr,create:Wt,remove:fn,empty:Bi,toFront:Ta,toBack:ra,hasClass:d0,addClass:Vt,removeClass:gr,setClass:p0,getClass:vm,setOpacity:Xa,testProp:Jd,setTransform:qs,setPosition:_r,getPosition:ll,get disableTextSelection(){return Qu},get enableTextSelection(){return tu},disableImageDrag:Yd,enableImageDrag:tc,preventOutline:wm,restoreOutline:ru,getSizedParentNode:Qd,getScale:h0};function ue(f,w,S,T){if(w&&typeof w=="object")for(var R in w)qe(f,R,w[R],S);else{w=m(w);for(var j=0,ie=w.length;j<ie;j++)qe(f,w[j],S,T)}return this}var Pe="_leaflet_events";function je(f,w,S,T){if(arguments.length===1)Pt(f),delete f[Pe];else if(w&&typeof w=="object")for(var R in w)mt(f,R,w[R],S);else if(w=m(w),arguments.length===2)Pt(f,function(ge){return k(w,ge)!==-1});else for(var j=0,ie=w.length;j<ie;j++)mt(f,w[j],S,T);return this}function Pt(f,w){for(var S in f[Pe]){var T=S.split(/\d/)[0];(!w||w(T))&&mt(f,T,null,null,S)}}var At={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function qe(f,w,S,T){var R=w+l(S)+(T?"_"+l(T):"");if(f[Pe]&&f[Pe][R])return this;var j=function(ge){return S.call(T||f,ge||window.event)},ie=j;!Ue.touchNative&&Ue.pointer&&w.indexOf("touch")===0?j=Fi(f,w,j):Ue.touch&&w==="dblclick"?j=u0(f,j):"addEventListener"in f?w==="touchstart"||w==="touchmove"||w==="wheel"||w==="mousewheel"?f.addEventListener(At[w]||w,j,Ue.passiveEvents?{passive:!1}:!1):w==="mouseenter"||w==="mouseleave"?(j=function(ge){ge=ge||window.event,LT(f,ge)&&ie(ge)},f.addEventListener(At[w],j,!1)):f.addEventListener(w,ie,!1):f.attachEvent("on"+w,j),f[Pe]=f[Pe]||{},f[Pe][R]=j}function mt(f,w,S,T,R){R=R||w+l(S)+(T?"_"+l(T):"");var j=f[Pe]&&f[Pe][R];if(!j)return this;!Ue.touchNative&&Ue.pointer&&w.indexOf("touch")===0?ym(f,w,j):Ue.touch&&w==="dblclick"?c0(f,j):"removeEventListener"in f?f.removeEventListener(At[w]||w,j,!1):f.detachEvent("on"+w,j),f[Pe][R]=null}function vn(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function Wi(f){return qe(f,"wheel",vn),this}function Na(f){return ue(f,"mousedown touchstart dblclick contextmenu",vn),f._leaflet_disable_click=!0,this}function Gr(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function So(f){return Gr(f),vn(f),this}function ix(f){if(f.composedPath)return f.composedPath();for(var w=[],S=f.target;S;)w.push(S),S=S.parentNode;return w}function ia(f,w){if(!w)return new V(f.clientX,f.clientY);var S=h0(w),T=S.boundingClientRect;return new V((f.clientX-T.left)/S.x-w.clientLeft,(f.clientY-T.top)/S.y-w.clientTop)}var rc=Ue.linux&&Ue.chrome?window.devicePixelRatio:Ue.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function f0(f){return Ue.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/rc:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function LT(f,w){var S=w.relatedTarget;if(!S)return!0;try{for(;S&&S!==f;)S=S.parentNode}catch{return!1}return S!==f}var xpe={__proto__:null,on:ue,off:je,stopPropagation:vn,disableScrollPropagation:Wi,disableClickPropagation:Na,preventDefault:Gr,stop:So,getPropagationPath:ix,getMousePosition:ia,getWheelDelta:f0,isExternalTarget:LT,addListener:ue,removeListener:je},j3=ee.extend({run:function(f,w,S,T){this.stop(),this._el=f,this._inProgress=!0,this._duration=S||.25,this._easeOutPower=1/Math.max(T||.5,.2),this._startPos=ll(f),this._offset=w.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){!this._inProgress||(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(f){var w=+new Date-this._startTime,S=this._duration*1e3;w<S?this._runFrame(this._easeOut(w/S),f):(this._runFrame(1),this._complete())},_runFrame:function(f,w){var S=this._startPos.add(this._offset.multiplyBy(f));w&&S._round(),_r(this._el,S),this.fire("step")},_complete:function(){E(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),dn=ee.extend({options:{crs:st,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,w){w=g(this,w),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=s(this._onResize,this),this._initEvents(),w.maxBounds&&this.setMaxBounds(w.maxBounds),w.zoom!==void 0&&(this._zoom=this._limitZoom(w.zoom)),w.center&&w.zoom!==void 0&&this.setView(_e(w.center),w.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=zi&&Ue.any3d&&!Ue.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ue(this._proxy,vt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,w,S){if(w=w===void 0?this._zoom:this._limitZoom(w),f=this._limitCenter(_e(f),w,this.options.maxBounds),S=S||{},this._stop(),this._loaded&&!S.reset&&S!==!0){S.animate!==void 0&&(S.zoom=i({animate:S.animate},S.zoom),S.pan=i({animate:S.animate,duration:S.duration},S.pan));var T=this._zoom!==w?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,w,S.zoom):this._tryAnimatedPan(f,S.pan);if(T)return clearTimeout(this._sizeTimer),this}return this._resetView(f,w,S.pan&&S.pan.noMoveStart),this},setZoom:function(f,w){return this._loaded?this.setView(this.getCenter(),f,{zoom:w}):(this._zoom=f,this)},zoomIn:function(f,w){return f=f||(Ue.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,w)},zoomOut:function(f,w){return f=f||(Ue.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,w)},setZoomAround:function(f,w,S){var T=this.getZoomScale(w),R=this.getSize().divideBy(2),j=f instanceof V?f:this.latLngToContainerPoint(f),ie=j.subtract(R).multiplyBy(1-1/T),ge=this.containerPointToLatLng(R.add(ie));return this.setView(ge,w,{zoom:S})},_getBoundsCenterZoom:function(f,w){w=w||{},f=f.getBounds?f.getBounds():fe(f);var S=X(w.paddingTopLeft||w.padding||[0,0]),T=X(w.paddingBottomRight||w.padding||[0,0]),R=this.getBoundsZoom(f,!1,S.add(T));if(R=typeof w.maxZoom=="number"?Math.min(w.maxZoom,R):R,R===1/0)return{center:f.getCenter(),zoom:R};var j=T.subtract(S).divideBy(2),ie=this.project(f.getSouthWest(),R),ge=this.project(f.getNorthEast(),R),be=this.unproject(ie.add(ge).divideBy(2).add(j),R);return{center:be,zoom:R}},fitBounds:function(f,w){if(f=fe(f),!f.isValid())throw new Error("Bounds are not valid.");var S=this._getBoundsCenterZoom(f,w);return this.setView(S.center,S.zoom,w)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,w){return this.setView(f,this._zoom,{pan:w})},panBy:function(f,w){if(f=X(f).round(),w=w||{},!f.x&&!f.y)return this.fire("moveend");if(w.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new j3,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),w.noMoveStart||this.fire("movestart"),w.animate!==!1){Vt(this._mapPane,"leaflet-pan-anim");var S=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,S,w.duration||.25,w.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,w,S){if(S=S||{},S.animate===!1||!Ue.any3d)return this.setView(f,w,S);this._stop();var T=this.project(this.getCenter()),R=this.project(f),j=this.getSize(),ie=this._zoom;f=_e(f),w=w===void 0?ie:w;var ge=Math.max(j.x,j.y),be=ge*this.getZoomScale(ie,w),Oe=R.distanceTo(T)||1,tt=1.42,Nt=tt*tt;function rn(qr){var gx=qr?-1:1,uhe=qr?be:ge,che=be*be-ge*ge+gx*Nt*Nt*Oe*Oe,dhe=2*uhe*Nt*Oe,KT=che/dhe,kB=Math.sqrt(KT*KT+1)-KT,phe=kB<1e-9?-18:Math.log(kB);return phe}function Ea(qr){return(Math.exp(qr)-Math.exp(-qr))/2}function _i(qr){return(Math.exp(qr)+Math.exp(-qr))/2}function Zs(qr){return Ea(qr)/_i(qr)}var Ja=rn(0);function Im(qr){return ge*(_i(Ja)/_i(Ja+tt*qr))}function ahe(qr){return ge*(_i(Ja)*Zs(Ja+tt*qr)-Ea(Ja))/Nt}function she(qr){return 1-Math.pow(1-qr,1.5)}var ohe=Date.now(),xB=(rn(1)-Ja)/tt,lhe=S.duration?1e3*S.duration:1e3*xB*.8;function _B(){var qr=(Date.now()-ohe)/lhe,gx=she(qr)*xB;qr<=1?(this._flyToFrame=F(_B,this),this._move(this.unproject(T.add(R.subtract(T).multiplyBy(ahe(gx)/Oe)),ie),this.getScaleZoom(ge/Im(gx),ie),{flyTo:!0})):this._move(f,w)._moveEnd(!0)}return this._moveStart(!0,S.noMoveStart),_B.call(this),this},flyToBounds:function(f,w){var S=this._getBoundsCenterZoom(f,w);return this.flyTo(S.center,S.zoom,w)},setMaxBounds:function(f){return f=fe(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var w=this.options.minZoom;return this.options.minZoom=f,this._loaded&&w!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var w=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&w!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,w){this._enforcingBounds=!0;var S=this.getCenter(),T=this._limitCenter(S,this._zoom,fe(f));return S.equals(T)||this.panTo(T,w),this._enforcingBounds=!1,this},panInside:function(f,w){w=w||{};var S=X(w.paddingTopLeft||w.padding||[0,0]),T=X(w.paddingBottomRight||w.padding||[0,0]),R=this.project(this.getCenter()),j=this.project(f),ie=this.getPixelBounds(),ge=ce([ie.min.add(S),ie.max.subtract(T)]),be=ge.getSize();if(!ge.contains(j)){this._enforcingBounds=!0;var Oe=j.subtract(ge.getCenter()),tt=ge.extend(j).getSize().subtract(be);R.x+=Oe.x<0?-tt.x:tt.x,R.y+=Oe.y<0?-tt.y:tt.y,this.panTo(this.unproject(R),w),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=i({animate:!1,pan:!0},f===!0?{animate:!0}:f);var w=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var S=this.getSize(),T=w.divideBy(2).round(),R=S.divideBy(2).round(),j=T.subtract(R);return!j.x&&!j.y?this:(f.animate&&f.pan?this.panBy(j):(f.pan&&this._rawPanBy(j),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(s(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:w,newSize:S}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=i({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var w=s(this._handleGeolocationResponse,this),S=s(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(w,S,f):navigator.geolocation.getCurrentPosition(w,S,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(!!this._container._leaflet_id){var w=f.code,S=f.message||(w===1?"permission denied":w===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:w,message:"Geolocation error: "+S+"."})}},_handleGeolocationResponse:function(f){if(!!this._container._leaflet_id){var w=f.coords.latitude,S=f.coords.longitude,T=new ye(w,S),R=T.toBounds(f.coords.accuracy*2),j=this._locateOptions;if(j.setView){var ie=this.getBoundsZoom(R);this.setView(T,j.maxZoom?Math.min(ie,j.maxZoom):ie)}var ge={latlng:T,bounds:R,timestamp:f.timestamp};for(var be in f.coords)typeof f.coords[be]=="number"&&(ge[be]=f.coords[be]);this.fire("locationfound",ge)}},addHandler:function(f,w){if(!w)return this;var S=this[f]=new w(this);return this._handlers.push(S),this.options[f]&&S.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),fn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(E(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)fn(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,w){var S="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),T=Wt("div",S,w||this._mapPane);return f&&(this._panes[f]=T),T},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),w=this.unproject(f.getBottomLeft()),S=this.unproject(f.getTopRight());return new pe(w,S)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,w,S){f=fe(f),S=X(S||[0,0]);var T=this.getZoom()||0,R=this.getMinZoom(),j=this.getMaxZoom(),ie=f.getNorthWest(),ge=f.getSouthEast(),be=this.getSize().subtract(S),Oe=ce(this.project(ge,T),this.project(ie,T)).getSize(),tt=Ue.any3d?this.options.zoomSnap:1,Nt=be.x/Oe.x,rn=be.y/Oe.y,Ea=w?Math.max(Nt,rn):Math.min(Nt,rn);return T=this.getScaleZoom(Ea,T),tt&&(T=Math.round(T/(tt/100))*(tt/100),T=w?Math.ceil(T/tt)*tt:Math.floor(T/tt)*tt),Math.max(R,Math.min(j,T))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new V(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,w){var S=this._getTopLeftPoint(f,w);return new Y(S,S.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,w){var S=this.options.crs;return w=w===void 0?this._zoom:w,S.scale(f)/S.scale(w)},getScaleZoom:function(f,w){var S=this.options.crs;w=w===void 0?this._zoom:w;var T=S.zoom(f*S.scale(w));return isNaN(T)?1/0:T},project:function(f,w){return w=w===void 0?this._zoom:w,this.options.crs.latLngToPoint(_e(f),w)},unproject:function(f,w){return w=w===void 0?this._zoom:w,this.options.crs.pointToLatLng(X(f),w)},layerPointToLatLng:function(f){var w=X(f).add(this.getPixelOrigin());return this.unproject(w)},latLngToLayerPoint:function(f){var w=this.project(_e(f))._round();return w._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(_e(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(fe(f))},distance:function(f,w){return this.options.crs.distance(_e(f),_e(w))},containerPointToLayerPoint:function(f){return X(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return X(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var w=this.containerPointToLayerPoint(X(f));return this.layerPointToLatLng(w)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(_e(f)))},mouseEventToContainerPoint:function(f){return ia(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var w=this._container=xn(f);if(w){if(w._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ue(w,"scroll",this._onScroll,this),this._containerId=l(w)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ue.any3d,Vt(f,"leaflet-container"+(Ue.touch?" leaflet-touch":"")+(Ue.retina?" leaflet-retina":"")+(Ue.ielt9?" leaflet-oldie":"")+(Ue.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var w=Hr(f,"position");w!=="absolute"&&w!=="relative"&&w!=="fixed"&&w!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),_r(this._mapPane,new V(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Vt(f.markerPane,"leaflet-zoom-hide"),Vt(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,w,S){_r(this._mapPane,new V(0,0));var T=!this._loaded;this._loaded=!0,w=this._limitZoom(w),this.fire("viewprereset");var R=this._zoom!==w;this._moveStart(R,S)._move(f,w)._moveEnd(R),this.fire("viewreset"),T&&this.fire("load")},_moveStart:function(f,w){return f&&this.fire("zoomstart"),w||this.fire("movestart"),this},_move:function(f,w,S,T){w===void 0&&(w=this._zoom);var R=this._zoom!==w;return this._zoom=w,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),T?S&&S.pinch&&this.fire("zoom",S):((R||S&&S.pinch)&&this.fire("zoom",S),this.fire("move",S)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return E(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){_r(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[l(this._container)]=this;var w=f?je:ue;w(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&w(window,"resize",this._onResize,this),Ue.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){E(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,w){for(var S=[],T,R=w==="mouseout"||w==="mouseover",j=f.target||f.srcElement,ie=!1;j;){if(T=this._targets[l(j)],T&&(w==="click"||w==="preclick")&&this._draggableMoved(T)){ie=!0;break}if(T&&T.listens(w,!0)&&(R&&!LT(j,f)||(S.push(T),R))||j===this._container)break;j=j.parentNode}return!S.length&&!ie&&!R&&this.listens(w,!0)&&(S=[this]),S},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var w=f.target||f.srcElement;if(!(!this._loaded||w._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(w))){var S=f.type;S==="mousedown"&&wm(w),this._fireDOMEvent(f,S)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,w,S){if(f.type==="click"){var T=i({},f);T.type="preclick",this._fireDOMEvent(T,T.type,S)}var R=this._findEventTargets(f,w);if(S){for(var j=[],ie=0;ie<S.length;ie++)S[ie].listens(w,!0)&&j.push(S[ie]);R=j.concat(R)}if(!!R.length){w==="contextmenu"&&Gr(f);var ge=R[0],be={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var Oe=ge.getLatLng&&(!ge._radius||ge._radius<=10);be.containerPoint=Oe?this.latLngToContainerPoint(ge.getLatLng()):this.mouseEventToContainerPoint(f),be.layerPoint=this.containerPointToLayerPoint(be.containerPoint),be.latlng=Oe?ge.getLatLng():this.layerPointToLatLng(be.layerPoint)}for(ie=0;ie<R.length;ie++)if(R[ie].fire(w,be,!0),be.originalEvent._stopped||R[ie].options.bubblingMouseEvents===!1&&k(this._mouseEvents,w)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,w=this._handlers.length;f<w;f++)this._handlers[f].disable()},whenReady:function(f,w){return this._loaded?f.call(w||this,{target:this}):this.on("load",f,w),this},_getMapPanePos:function(){return ll(this._mapPane)||new V(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,w){var S=f&&w!==void 0?this._getNewPixelOrigin(f,w):this.getPixelOrigin();return S.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,w){var S=this.getSize()._divideBy(2);return this.project(f,w)._subtract(S)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,w,S){var T=this._getNewPixelOrigin(S,w);return this.project(f,w)._subtract(T)},_latLngBoundsToNewLayerBounds:function(f,w,S){var T=this._getNewPixelOrigin(S,w);return ce([this.project(f.getSouthWest(),w)._subtract(T),this.project(f.getNorthWest(),w)._subtract(T),this.project(f.getSouthEast(),w)._subtract(T),this.project(f.getNorthEast(),w)._subtract(T)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,w,S){if(!S)return f;var T=this.project(f,w),R=this.getSize().divideBy(2),j=new Y(T.subtract(R),T.add(R)),ie=this._getBoundsOffset(j,S,w);return Math.abs(ie.x)<=1&&Math.abs(ie.y)<=1?f:this.unproject(T.add(ie),w)},_limitOffset:function(f,w){if(!w)return f;var S=this.getPixelBounds(),T=new Y(S.min.add(f),S.max.add(f));return f.add(this._getBoundsOffset(T,w))},_getBoundsOffset:function(f,w,S){var T=ce(this.project(w.getNorthEast(),S),this.project(w.getSouthWest(),S)),R=T.min.subtract(f.min),j=T.max.subtract(f.max),ie=this._rebound(R.x,-j.x),ge=this._rebound(R.y,-j.y);return new V(ie,ge)},_rebound:function(f,w){return f+w>0?Math.round(f-w)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(w))},_limitZoom:function(f){var w=this.getMinZoom(),S=this.getMaxZoom(),T=Ue.any3d?this.options.zoomSnap:1;return T&&(f=Math.round(f/T)*T),Math.max(w,Math.min(S,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){gr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,w){var S=this._getCenterOffset(f)._trunc();return(w&&w.animate)!==!0&&!this.getSize().contains(S)?!1:(this.panBy(S,w),!0)},_createAnimProxy:function(){var f=this._proxy=Wt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(w){var S=Xd,T=this._proxy.style[S];qs(this._proxy,this.project(w.center,w.zoom),this.getZoomScale(w.zoom,1)),T===this._proxy.style[S]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){fn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),w=this.getZoom();qs(this._proxy,this.project(f,w),this.getZoomScale(w,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,w,S){if(this._animatingZoom)return!0;if(S=S||{},!this._zoomAnimated||S.animate===!1||this._nothingToAnimate()||Math.abs(w-this._zoom)>this.options.zoomAnimationThreshold)return!1;var T=this.getZoomScale(w),R=this._getCenterOffset(f)._divideBy(1-1/T);return S.animate!==!0&&!this.getSize().contains(R)?!1:(F(function(){this._moveStart(!0,S.noMoveStart||!1)._animateZoom(f,w,!0)},this),!0)},_animateZoom:function(f,w,S,T){!this._mapPane||(S&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=w,Vt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:w,noUpdate:T}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(s(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){!this._animatingZoom||(this._mapPane&&gr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function _pe(f,w){return new dn(f,w)}var Co=q.extend({options:{position:"topright"},initialize:function(f){g(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var w=this._map;return w&&w.removeControl(this),this.options.position=f,w&&w.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var w=this._container=this.onAdd(f),S=this.getPosition(),T=f._controlCorners[S];return Vt(w,"leaflet-control"),S.indexOf("bottom")!==-1?T.insertBefore(w,T.firstChild):T.appendChild(w),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(fn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),m0=function(f){return new Co(f)};dn.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},w="leaflet-",S=this._controlContainer=Wt("div",w+"control-container",this._container);function T(R,j){var ie=w+R+" "+w+j;f[R+j]=Wt("div",ie,S)}T("top","left"),T("top","right"),T("bottom","left"),T("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)fn(this._controlCorners[f]);fn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var U3=Co.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,w,S,T){return S<T?-1:T<S?1:0}},initialize:function(f,w,S){g(this,S),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var T in f)this._addLayer(f[T],T);for(T in w)this._addLayer(w[T],T,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var w=0;w<this._layers.length;w++)this._layers[w].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return Co.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,w){return this._addLayer(f,w),this._map?this._update():this},addOverlay:function(f,w){return this._addLayer(f,w,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var w=this._getLayer(l(f));return w&&this._layers.splice(this._layers.indexOf(w),1),this._map?this._update():this},expand:function(){Vt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(Vt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):gr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return gr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",w=this._container=Wt("div",f),S=this.options.collapsed;w.setAttribute("aria-haspopup",!0),Na(w),Wi(w);var T=this._section=Wt("section",f+"-list");S&&(this._map.on("click",this.collapse,this),ue(w,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var R=this._layersLink=Wt("a",f+"-toggle",w);R.href="#",R.title="Layers",R.setAttribute("role","button"),ue(R,{keydown:function(j){j.keyCode===13&&this._expandSafely()},click:function(j){Gr(j),this._expandSafely()}},this),S||this.expand(),this._baseLayersList=Wt("div",f+"-base",T),this._separator=Wt("div",f+"-separator",T),this._overlaysList=Wt("div",f+"-overlays",T),w.appendChild(T)},_getLayer:function(f){for(var w=0;w<this._layers.length;w++)if(this._layers[w]&&l(this._layers[w].layer)===f)return this._layers[w]},_addLayer:function(f,w,S){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:w,overlay:S}),this.options.sortLayers&&this._layers.sort(s(function(T,R){return this.options.sortFunction(T.layer,R.layer,T.name,R.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Bi(this._baseLayersList),Bi(this._overlaysList),this._layerControlInputs=[];var f,w,S,T,R=0;for(S=0;S<this._layers.length;S++)T=this._layers[S],this._addItem(T),w=w||T.overlay,f=f||!T.overlay,R+=T.overlay?0:1;return this.options.hideSingleBase&&(f=f&&R>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=w&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var w=this._getLayer(l(f.target)),S=w.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;S&&this._map.fire(S,w)},_createRadioElement:function(f,w){var S='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(w?' checked="checked"':"")+"/>",T=document.createElement("div");return T.innerHTML=S,T.firstChild},_addItem:function(f){var w=document.createElement("label"),S=this._map.hasLayer(f.layer),T;f.overlay?(T=document.createElement("input"),T.type="checkbox",T.className="leaflet-control-layers-selector",T.defaultChecked=S):T=this._createRadioElement("leaflet-base-layers_"+l(this),S),this._layerControlInputs.push(T),T.layerId=l(f.layer),ue(T,"click",this._onInputClick,this);var R=document.createElement("span");R.innerHTML=" "+f.name;var j=document.createElement("span");w.appendChild(j),j.appendChild(T),j.appendChild(R);var ie=f.overlay?this._overlaysList:this._baseLayersList;return ie.appendChild(w),this._checkDisabledLayers(),w},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,w,S,T=[],R=[];this._handlingClick=!0;for(var j=f.length-1;j>=0;j--)w=f[j],S=this._getLayer(w.layerId).layer,w.checked?T.push(S):w.checked||R.push(S);for(j=0;j<R.length;j++)this._map.hasLayer(R[j])&&this._map.removeLayer(R[j]);for(j=0;j<T.length;j++)this._map.hasLayer(T[j])||this._map.addLayer(T[j]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,w,S,T=this._map.getZoom(),R=f.length-1;R>=0;R--)w=f[R],S=this._getLayer(w.layerId).layer,w.disabled=S.options.minZoom!==void 0&&T<S.options.minZoom||S.options.maxZoom!==void 0&&T>S.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,ue(f,"click",Gr),this.expand();var w=this;setTimeout(function(){je(f,"click",Gr),w._preventClick=!1})}}),kpe=function(f,w,S){return new U3(f,w,S)},FT=Co.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var w="leaflet-control-zoom",S=Wt("div",w+" leaflet-bar"),T=this.options;return this._zoomInButton=this._createButton(T.zoomInText,T.zoomInTitle,w+"-in",S,this._zoomIn),this._zoomOutButton=this._createButton(T.zoomOutText,T.zoomOutTitle,w+"-out",S,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),S},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,w,S,T,R){var j=Wt("a",S,T);return j.innerHTML=f,j.href="#",j.title=w,j.setAttribute("role","button"),j.setAttribute("aria-label",w),Na(j),ue(j,"click",So),ue(j,"click",R,this),ue(j,"click",this._refocusOnMap,this),j},_updateDisabled:function(){var f=this._map,w="leaflet-disabled";gr(this._zoomInButton,w),gr(this._zoomOutButton,w),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(Vt(this._zoomOutButton,w),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(Vt(this._zoomInButton,w),this._zoomInButton.setAttribute("aria-disabled","true"))}});dn.mergeOptions({zoomControl:!0}),dn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new FT,this.addControl(this.zoomControl))});var Spe=function(f){return new FT(f)},H3=Co.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var w="leaflet-control-scale",S=Wt("div",w),T=this.options;return this._addScales(T,w+"-line",S),f.on(T.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),S},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,w,S){f.metric&&(this._mScale=Wt("div",w,S)),f.imperial&&(this._iScale=Wt("div",w,S))},_update:function(){var f=this._map,w=f.getSize().y/2,S=f.distance(f.containerPointToLatLng([0,w]),f.containerPointToLatLng([this.options.maxWidth,w]));this._updateScales(S)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var w=this._getRoundNum(f),S=w<1e3?w+" m":w/1e3+" km";this._updateScale(this._mScale,S,w/f)},_updateImperial:function(f){var w=f*3.2808399,S,T,R;w>5280?(S=w/5280,T=this._getRoundNum(S),this._updateScale(this._iScale,T+" mi",T/S)):(R=this._getRoundNum(w),this._updateScale(this._iScale,R+" ft",R/w))},_updateScale:function(f,w,S){f.style.width=Math.round(this.options.maxWidth*S)+"px",f.innerHTML=w},_getRoundNum:function(f){var w=Math.pow(10,(Math.floor(f)+"").length-1),S=f/w;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:1,w*S}}),Cpe=function(f){return new H3(f)},Ipe='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',zT=Co.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ue.inlineSvg?Ipe+" ":"")+"Leaflet</a>"},initialize:function(f){g(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=Wt("div","leaflet-control-attribution"),Na(this._container);for(var w in f._layers)f._layers[w].getAttribution&&this.addAttribution(f._layers[w].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(!!this._map){var f=[];for(var w in this._attributions)this._attributions[w]&&f.push(w);var S=[];this.options.prefix&&S.push(this.options.prefix),f.length&&S.push(f.join(", ")),this._container.innerHTML=S.join(' <span aria-hidden="true">|</span> ')}}});dn.mergeOptions({attributionControl:!0}),dn.addInitHook(function(){this.options.attributionControl&&new zT().addTo(this)});var $pe=function(f){return new zT(f)};Co.Layers=U3,Co.Zoom=FT,Co.Scale=H3,Co.Attribution=zT,m0.layers=kpe,m0.zoom=Spe,m0.scale=Cpe,m0.attribution=$pe;var ul=q.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ul.addTo=function(f,w){return f.addHandler(w,this),this};var Tpe={Events:J},G3=Ue.touch?"touchstart mousedown":"mousedown",ic=ee.extend({options:{clickTolerance:3},initialize:function(f,w,S,T){g(this,T),this._element=f,this._dragStartTarget=w||f,this._preventOutline=S},enable:function(){this._enabled||(ue(this._dragStartTarget,G3,this._onDown,this),this._enabled=!0)},disable:function(){!this._enabled||(ic._dragging===this&&this.finishDrag(!0),je(this._dragStartTarget,G3,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(!!this._enabled&&(this._moved=!1,!d0(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){ic._dragging===this&&this.finishDrag();return}if(!(ic._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(ic._dragging=this,this._preventOutline&&wm(this._element),Yd(),Qu(),!this._moving)){this.fire("down");var w=f.touches?f.touches[0]:f,S=Qd(this._element);this._startPoint=new V(w.clientX,w.clientY),this._startPos=ll(this._element),this._parentScale=h0(S);var T=f.type==="mousedown";ue(document,T?"mousemove":"touchmove",this._onMove,this),ue(document,T?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(!!this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var w=f.touches&&f.touches.length===1?f.touches[0]:f,S=new V(w.clientX,w.clientY)._subtract(this._startPoint);!S.x&&!S.y||Math.abs(S.x)+Math.abs(S.y)<this.options.clickTolerance||(S.x/=this._parentScale.x,S.y/=this._parentScale.y,Gr(f),this._moved||(this.fire("dragstart"),this._moved=!0,Vt(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Vt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(S),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),_r(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){!this._enabled||this.finishDrag()},finishDrag:function(f){gr(document.body,"leaflet-dragging"),this._lastTarget&&(gr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),je(document,"mousemove touchmove",this._onMove,this),je(document,"mouseup touchend touchcancel",this._onUp,this),tc(),tu();var w=this._moved&&this._moving;this._moving=!1,ic._dragging=!1,w&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function q3(f,w,S){var T,R=[1,4,2,8],j,ie,ge,be,Oe,tt,Nt,rn;for(j=0,tt=f.length;j<tt;j++)f[j]._code=ep(f[j],w);for(ge=0;ge<4;ge++){for(Nt=R[ge],T=[],j=0,tt=f.length,ie=tt-1;j<tt;ie=j++)be=f[j],Oe=f[ie],be._code&Nt?Oe._code&Nt||(rn=ax(Oe,be,Nt,w,S),rn._code=ep(rn,w),T.push(rn)):(Oe._code&Nt&&(rn=ax(Oe,be,Nt,w,S),rn._code=ep(rn,w),T.push(rn)),T.push(be));f=T}return f}function K3(f,w){var S,T,R,j,ie,ge,be,Oe,tt;if(!f||f.length===0)throw new Error("latlngs not passed");Ks(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var Nt=_e([0,0]),rn=fe(f),Ea=rn.getNorthWest().distanceTo(rn.getSouthWest())*rn.getNorthEast().distanceTo(rn.getNorthWest());Ea<1700&&(Nt=BT(f));var _i=f.length,Zs=[];for(S=0;S<_i;S++){var Ja=_e(f[S]);Zs.push(w.project(_e([Ja.lat-Nt.lat,Ja.lng-Nt.lng])))}for(ge=be=Oe=0,S=0,T=_i-1;S<_i;T=S++)R=Zs[S],j=Zs[T],ie=R.y*j.x-j.y*R.x,be+=(R.x+j.x)*ie,Oe+=(R.y+j.y)*ie,ge+=ie*3;ge===0?tt=Zs[0]:tt=[be/ge,Oe/ge];var Im=w.unproject(X(tt));return _e([Im.lat+Nt.lat,Im.lng+Nt.lng])}function BT(f){for(var w=0,S=0,T=0,R=0;R<f.length;R++){var j=_e(f[R]);w+=j.lat,S+=j.lng,T++}return _e([w/T,S/T])}var Npe={__proto__:null,clipPolygon:q3,polygonCenter:K3,centroid:BT};function Z3(f,w){if(!w||!f.length)return f.slice();var S=w*w;return f=Ppe(f,S),f=Ope(f,S),f}function X3(f,w,S){return Math.sqrt(g0(f,w,S,!0))}function Epe(f,w,S){return g0(f,w,S)}function Ope(f,w){var S=f.length,T=typeof Uint8Array!=void 0+""?Uint8Array:Array,R=new T(S);R[0]=R[S-1]=1,WT(f,R,w,0,S-1);var j,ie=[];for(j=0;j<S;j++)R[j]&&ie.push(f[j]);return ie}function WT(f,w,S,T,R){var j=0,ie,ge,be;for(ge=T+1;ge<=R-1;ge++)be=g0(f[ge],f[T],f[R],!0),be>j&&(ie=ge,j=be);j>S&&(w[ie]=1,WT(f,w,S,T,ie),WT(f,w,S,ie,R))}function Ppe(f,w){for(var S=[f[0]],T=1,R=0,j=f.length;T<j;T++)Ape(f[T],f[R])>w&&(S.push(f[T]),R=T);return R<j-1&&S.push(f[j-1]),S}var J3;function Y3(f,w,S,T,R){var j=T?J3:ep(f,S),ie=ep(w,S),ge,be,Oe;for(J3=ie;;){if(!(j|ie))return[f,w];if(j&ie)return!1;ge=j||ie,be=ax(f,w,ge,S,R),Oe=ep(be,S),ge===j?(f=be,j=Oe):(w=be,ie=Oe)}}function ax(f,w,S,T,R){var j=w.x-f.x,ie=w.y-f.y,ge=T.min,be=T.max,Oe,tt;return S&8?(Oe=f.x+j*(be.y-f.y)/ie,tt=be.y):S&4?(Oe=f.x+j*(ge.y-f.y)/ie,tt=ge.y):S&2?(Oe=be.x,tt=f.y+ie*(be.x-f.x)/j):S&1&&(Oe=ge.x,tt=f.y+ie*(ge.x-f.x)/j),new V(Oe,tt,R)}function ep(f,w){var S=0;return f.x<w.min.x?S|=1:f.x>w.max.x&&(S|=2),f.y<w.min.y?S|=4:f.y>w.max.y&&(S|=8),S}function Ape(f,w){var S=w.x-f.x,T=w.y-f.y;return S*S+T*T}function g0(f,w,S,T){var R=w.x,j=w.y,ie=S.x-R,ge=S.y-j,be=ie*ie+ge*ge,Oe;return be>0&&(Oe=((f.x-R)*ie+(f.y-j)*ge)/be,Oe>1?(R=S.x,j=S.y):Oe>0&&(R+=ie*Oe,j+=ge*Oe)),ie=f.x-R,ge=f.y-j,T?ie*ie+ge*ge:new V(R,j)}function Ks(f){return!_(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function Q3(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ks(f)}function eB(f,w){var S,T,R,j,ie,ge,be,Oe;if(!f||f.length===0)throw new Error("latlngs not passed");Ks(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var tt=_e([0,0]),Nt=fe(f),rn=Nt.getNorthWest().distanceTo(Nt.getSouthWest())*Nt.getNorthEast().distanceTo(Nt.getNorthWest());rn<1700&&(tt=BT(f));var Ea=f.length,_i=[];for(S=0;S<Ea;S++){var Zs=_e(f[S]);_i.push(w.project(_e([Zs.lat-tt.lat,Zs.lng-tt.lng])))}for(S=0,T=0;S<Ea-1;S++)T+=_i[S].distanceTo(_i[S+1])/2;if(T===0)Oe=_i[0];else for(S=0,j=0;S<Ea-1;S++)if(ie=_i[S],ge=_i[S+1],R=ie.distanceTo(ge),j+=R,j>T){be=(j-T)/R,Oe=[ge.x-be*(ge.x-ie.x),ge.y-be*(ge.y-ie.y)];break}var Ja=w.unproject(X(Oe));return _e([Ja.lat+tt.lat,Ja.lng+tt.lng])}var Mpe={__proto__:null,simplify:Z3,pointToSegmentDistance:X3,closestPointOnSegment:Epe,clipSegment:Y3,_getEdgeIntersection:ax,_getBitCode:ep,_sqClosestPointOnSegment:g0,isFlat:Ks,_flat:Q3,polylineCenter:eB},VT={project:function(f){return new V(f.lng,f.lat)},unproject:function(f){return new ye(f.y,f.x)},bounds:new Y([-180,-90],[180,90])},jT={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Y([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var w=Math.PI/180,S=this.R,T=f.lat*w,R=this.R_MINOR/S,j=Math.sqrt(1-R*R),ie=j*Math.sin(T),ge=Math.tan(Math.PI/4-T/2)/Math.pow((1-ie)/(1+ie),j/2);return T=-S*Math.log(Math.max(ge,1e-10)),new V(f.lng*w*S,T)},unproject:function(f){for(var w=180/Math.PI,S=this.R,T=this.R_MINOR/S,R=Math.sqrt(1-T*T),j=Math.exp(-f.y/S),ie=Math.PI/2-2*Math.atan(j),ge=0,be=.1,Oe;ge<15&&Math.abs(be)>1e-7;ge++)Oe=R*Math.sin(ie),Oe=Math.pow((1-Oe)/(1+Oe),R/2),be=Math.PI/2-2*Math.atan(j*Oe)-ie,ie+=be;return new ye(ie*w,f.x*w/S)}},Rpe={__proto__:null,LonLat:VT,Mercator:jT,SphericalMercator:Ze},Dpe=i({},Se,{code:"EPSG:3395",projection:jT,transformation:function(){var f=.5/(Math.PI*jT.R);return Je(f,.5,-f,.5)}()}),tB=i({},Se,{code:"EPSG:4326",projection:VT,transformation:Je(1/180,1,-1/180,.5)}),Lpe=i({},Ee,{projection:VT,transformation:Je(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,w){var S=w.lng-f.lng,T=w.lat-f.lat;return Math.sqrt(S*S+T*T)},infinite:!0});Ee.Earth=Se,Ee.EPSG3395=Dpe,Ee.EPSG3857=st,Ee.EPSG900913=He,Ee.EPSG4326=tB,Ee.Simple=Lpe;var Io=ee.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[l(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[l(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var w=f.target;if(!!w.hasLayer(this)){if(this._map=w,this._zoomAnimated=w._zoomAnimated,this.getEvents){var S=this.getEvents();w.on(S,this),this.once("remove",function(){w.off(S,this)},this)}this.onAdd(w),this.fire("add"),w.fire("layeradd",{layer:this})}}});dn.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var w=l(f);return this._layers[w]?this:(this._layers[w]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var w=l(f);return this._layers[w]?(this._loaded&&f.onRemove(this),delete this._layers[w],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return l(f)in this._layers},eachLayer:function(f,w){for(var S in this._layers)f.call(w,this._layers[S]);return this},_addLayers:function(f){f=f?_(f)?f:[f]:[];for(var w=0,S=f.length;w<S;w++)this.addLayer(f[w])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[l(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var w=l(f);this._zoomBoundLayers[w]&&(delete this._zoomBoundLayers[w],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,w=-1/0,S=this._getZoomSpan();for(var T in this._zoomBoundLayers){var R=this._zoomBoundLayers[T].options;f=R.minZoom===void 0?f:Math.min(f,R.minZoom),w=R.maxZoom===void 0?w:Math.max(w,R.maxZoom)}this._layersMaxZoom=w===-1/0?void 0:w,this._layersMinZoom=f===1/0?void 0:f,S!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var xm=Io.extend({initialize:function(f,w){g(this,w),this._layers={};var S,T;if(f)for(S=0,T=f.length;S<T;S++)this.addLayer(f[S])},addLayer:function(f){var w=this.getLayerId(f);return this._layers[w]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var w=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[w]&&this._map.removeLayer(this._layers[w]),delete this._layers[w],this},hasLayer:function(f){var w=typeof f=="number"?f:this.getLayerId(f);return w in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var w=Array.prototype.slice.call(arguments,1),S,T;for(S in this._layers)T=this._layers[S],T[f]&&T[f].apply(T,w);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,w){for(var S in this._layers)f.call(w,this._layers[S]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return l(f)}}),Fpe=function(f,w){return new xm(f,w)},iu=xm.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),xm.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),xm.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new pe;for(var w in this._layers){var S=this._layers[w];f.extend(S.getBounds?S.getBounds():S.getLatLng())}return f}}),zpe=function(f,w){return new iu(f,w)},_m=q.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){g(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,w){var S=this._getIconUrl(f);if(!S){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var T=this._createImg(S,w&&w.tagName==="IMG"?w:null);return this._setIconStyles(T,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),T},_setIconStyles:function(f,w){var S=this.options,T=S[w+"Size"];typeof T=="number"&&(T=[T,T]);var R=X(T),j=X(w==="shadow"&&S.shadowAnchor||S.iconAnchor||R&&R.divideBy(2,!0));f.className="leaflet-marker-"+w+" "+(S.className||""),j&&(f.style.marginLeft=-j.x+"px",f.style.marginTop=-j.y+"px"),R&&(f.style.width=R.x+"px",f.style.height=R.y+"px")},_createImg:function(f,w){return w=w||document.createElement("img"),w.src=f,w},_getIconUrl:function(f){return Ue.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function Bpe(f){return new _m(f)}var y0=_m.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof y0.imagePath!="string"&&(y0.imagePath=this._detectIconPath()),(this.options.imagePath||y0.imagePath)+_m.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var w=function(S,T,R){var j=T.exec(S);return j&&j[R]};return f=w(f,/^url\((['"])?(.+)\1\)$/,2),f&&w(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=Wt("div","leaflet-default-icon-path",document.body),w=Hr(f,"background-image")||Hr(f,"backgroundImage");if(document.body.removeChild(f),w=this._stripUrl(w),w)return w;var S=document.querySelector('link[href$="leaflet.css"]');return S?S.href.substring(0,S.href.length-11-1):""}}),nB=ul.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new ic(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Vt(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&gr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var w=this._marker,S=w._map,T=this._marker.options.autoPanSpeed,R=this._marker.options.autoPanPadding,j=ll(w._icon),ie=S.getPixelBounds(),ge=S.getPixelOrigin(),be=ce(ie.min._subtract(ge).add(R),ie.max._subtract(ge).subtract(R));if(!be.contains(j)){var Oe=X((Math.max(be.max.x,j.x)-be.max.x)/(ie.max.x-be.max.x)-(Math.min(be.min.x,j.x)-be.min.x)/(ie.min.x-be.min.x),(Math.max(be.max.y,j.y)-be.max.y)/(ie.max.y-be.max.y)-(Math.min(be.min.y,j.y)-be.min.y)/(ie.min.y-be.min.y)).multiplyBy(T);S.panBy(Oe,{animate:!1}),this._draggable._newPos._add(Oe),this._draggable._startPos._add(Oe),_r(w._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=F(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(E(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,f)))},_onDrag:function(f){var w=this._marker,S=w._shadow,T=ll(w._icon),R=w._map.layerPointToLatLng(T);S&&_r(S,T),w._latlng=R,f.latlng=R,f.oldLatLng=this._oldLatLng,w.fire("move",f).fire("drag",f)},_onDragEnd:function(f){E(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),sx=Io.extend({options:{icon:new y0,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,w){g(this,w),this._latlng=_e(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var w=this._latlng;return this._latlng=_e(f),this.update(),this.fire("move",{oldLatLng:w,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,w="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),S=f.icon.createIcon(this._icon),T=!1;S!==this._icon&&(this._icon&&this._removeIcon(),T=!0,f.title&&(S.title=f.title),S.tagName==="IMG"&&(S.alt=f.alt||"")),Vt(S,w),f.keyboard&&(S.tabIndex="0",S.setAttribute("role","button")),this._icon=S,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ue(S,"focus",this._panOnFocus,this);var R=f.icon.createShadow(this._shadow),j=!1;R!==this._shadow&&(this._removeShadow(),j=!0),R&&(Vt(R,w),R.alt=""),this._shadow=R,f.opacity<1&&this._updateOpacity(),T&&this.getPane().appendChild(this._icon),this._initInteraction(),R&&j&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&je(this._icon,"focus",this._panOnFocus,this),fn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&fn(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&_r(this._icon,f),this._shadow&&_r(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var w=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(w)},_initInteraction:function(){if(!!this.options.interactive&&(Vt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),nB)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new nB(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&Xa(this._icon,f),this._shadow&&Xa(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(!!f){var w=this.options.icon.options,S=w.iconSize?X(w.iconSize):X(0,0),T=w.iconAnchor?X(w.iconAnchor):X(0,0);f.panInside(this._latlng,{paddingTopLeft:T,paddingBottomRight:S.subtract(T)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Wpe(f,w){return new sx(f,w)}var ac=Io.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return g(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ox=ac.extend({options:{fill:!0,radius:10},initialize:function(f,w){g(this,w),this._latlng=_e(f),this._radius=this.options.radius},setLatLng:function(f){var w=this._latlng;return this._latlng=_e(f),this.redraw(),this.fire("move",{oldLatLng:w,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var w=f&&f.radius||this._radius;return ac.prototype.setStyle.call(this,f),this.setRadius(w),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,w=this._radiusY||f,S=this._clickTolerance(),T=[f+S,w+S];this._pxBounds=new Y(this._point.subtract(T),this._point.add(T))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Vpe(f,w){return new ox(f,w)}var UT=ox.extend({initialize:function(f,w,S){if(typeof w=="number"&&(w=i({},S,{radius:w})),g(this,w),this._latlng=_e(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new pe(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:ac.prototype.setStyle,_project:function(){var f=this._latlng.lng,w=this._latlng.lat,S=this._map,T=S.options.crs;if(T.distance===Se.distance){var R=Math.PI/180,j=this._mRadius/Se.R/R,ie=S.project([w+j,f]),ge=S.project([w-j,f]),be=ie.add(ge).divideBy(2),Oe=S.unproject(be).lat,tt=Math.acos((Math.cos(j*R)-Math.sin(w*R)*Math.sin(Oe*R))/(Math.cos(w*R)*Math.cos(Oe*R)))/R;(isNaN(tt)||tt===0)&&(tt=j/Math.cos(Math.PI/180*w)),this._point=be.subtract(S.getPixelOrigin()),this._radius=isNaN(tt)?0:be.x-S.project([Oe,f-tt]).x,this._radiusY=be.y-ie.y}else{var Nt=T.unproject(T.project(this._latlng).subtract([this._mRadius,0]));this._point=S.latLngToLayerPoint(this._latlng),this._radius=this._point.x-S.latLngToLayerPoint(Nt).x}this._updateBounds()}});function jpe(f,w,S){return new UT(f,w,S)}var au=ac.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,w){g(this,w),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var w=1/0,S=null,T=g0,R,j,ie=0,ge=this._parts.length;ie<ge;ie++)for(var be=this._parts[ie],Oe=1,tt=be.length;Oe<tt;Oe++){R=be[Oe-1],j=be[Oe];var Nt=T(f,R,j,!0);Nt<w&&(w=Nt,S=T(f,R,j))}return S&&(S.distance=Math.sqrt(w)),S},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return eB(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,w){return w=w||this._defaultShape(),f=_e(f),w.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new pe,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return Ks(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var w=[],S=Ks(f),T=0,R=f.length;T<R;T++)S?(w[T]=_e(f[T]),this._bounds.extend(w[T])):w[T]=this._convertLatLngs(f[T]);return w},_project:function(){var f=new Y;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),w=new V(f,f);!this._rawPxBounds||(this._pxBounds=new Y([this._rawPxBounds.min.subtract(w),this._rawPxBounds.max.add(w)]))},_projectLatlngs:function(f,w,S){var T=f[0]instanceof ye,R=f.length,j,ie;if(T){for(ie=[],j=0;j<R;j++)ie[j]=this._map.latLngToLayerPoint(f[j]),S.extend(ie[j]);w.push(ie)}else for(j=0;j<R;j++)this._projectLatlngs(f[j],w,S)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var w=this._parts,S,T,R,j,ie,ge,be;for(S=0,R=0,j=this._rings.length;S<j;S++)for(be=this._rings[S],T=0,ie=be.length;T<ie-1;T++)ge=Y3(be[T],be[T+1],f,T,!0),ge&&(w[R]=w[R]||[],w[R].push(ge[0]),(ge[1]!==be[T+1]||T===ie-2)&&(w[R].push(ge[1]),R++))}},_simplifyPoints:function(){for(var f=this._parts,w=this.options.smoothFactor,S=0,T=f.length;S<T;S++)f[S]=Z3(f[S],w)},_update:function(){!this._map||(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,w){var S,T,R,j,ie,ge,be=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(S=0,j=this._parts.length;S<j;S++)for(ge=this._parts[S],T=0,ie=ge.length,R=ie-1;T<ie;R=T++)if(!(!w&&T===0)&&X3(f,ge[R],ge[T])<=be)return!0;return!1}});function Upe(f,w){return new au(f,w)}au._flat=Q3;var km=au.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return K3(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var w=au.prototype._convertLatLngs.call(this,f),S=w.length;return S>=2&&w[0]instanceof ye&&w[0].equals(w[S-1])&&w.pop(),w},_setLatLngs:function(f){au.prototype._setLatLngs.call(this,f),Ks(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ks(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,w=this.options.weight,S=new V(w,w);if(f=new Y(f.min.subtract(S),f.max.add(S)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var T=0,R=this._rings.length,j;T<R;T++)j=q3(this._rings[T],f,!0),j.length&&this._parts.push(j)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var w=!1,S,T,R,j,ie,ge,be,Oe;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(j=0,be=this._parts.length;j<be;j++)for(S=this._parts[j],ie=0,Oe=S.length,ge=Oe-1;ie<Oe;ge=ie++)T=S[ie],R=S[ge],T.y>f.y!=R.y>f.y&&f.x<(R.x-T.x)*(f.y-T.y)/(R.y-T.y)+T.x&&(w=!w);return w||au.prototype._containsPoint.call(this,f,!0)}});function Hpe(f,w){return new km(f,w)}var su=iu.extend({initialize:function(f,w){g(this,w),this._layers={},f&&this.addData(f)},addData:function(f){var w=_(f)?f:f.features,S,T,R;if(w){for(S=0,T=w.length;S<T;S++)R=w[S],(R.geometries||R.geometry||R.features||R.coordinates)&&this.addData(R);return this}var j=this.options;if(j.filter&&!j.filter(f))return this;var ie=lx(f,j);return ie?(ie.feature=dx(f),ie.defaultOptions=ie.options,this.resetStyle(ie),j.onEachFeature&&j.onEachFeature(f,ie),this.addLayer(ie)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=i({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(w){this._setLayerStyle(w,f)},this)},_setLayerStyle:function(f,w){f.setStyle&&(typeof w=="function"&&(w=w(f.feature)),f.setStyle(w))}});function lx(f,w){var S=f.type==="Feature"?f.geometry:f,T=S?S.coordinates:null,R=[],j=w&&w.pointToLayer,ie=w&&w.coordsToLatLng||HT,ge,be,Oe,tt;if(!T&&!S)return null;switch(S.type){case"Point":return ge=ie(T),rB(j,f,ge,w);case"MultiPoint":for(Oe=0,tt=T.length;Oe<tt;Oe++)ge=ie(T[Oe]),R.push(rB(j,f,ge,w));return new iu(R);case"LineString":case"MultiLineString":return be=ux(T,S.type==="LineString"?0:1,ie),new au(be,w);case"Polygon":case"MultiPolygon":return be=ux(T,S.type==="Polygon"?1:2,ie),new km(be,w);case"GeometryCollection":for(Oe=0,tt=S.geometries.length;Oe<tt;Oe++){var Nt=lx({geometry:S.geometries[Oe],type:"Feature",properties:f.properties},w);Nt&&R.push(Nt)}return new iu(R);case"FeatureCollection":for(Oe=0,tt=S.features.length;Oe<tt;Oe++){var rn=lx(S.features[Oe],w);rn&&R.push(rn)}return new iu(R);default:throw new Error("Invalid GeoJSON object.")}}function rB(f,w,S,T){return f?f(w,S):new sx(S,T&&T.markersInheritOptions&&T)}function HT(f){return new ye(f[1],f[0],f[2])}function ux(f,w,S){for(var T=[],R=0,j=f.length,ie;R<j;R++)ie=w?ux(f[R],w-1,S):(S||HT)(f[R]),T.push(ie);return T}function GT(f,w){return f=_e(f),f.alt!==void 0?[p(f.lng,w),p(f.lat,w),p(f.alt,w)]:[p(f.lng,w),p(f.lat,w)]}function cx(f,w,S,T){for(var R=[],j=0,ie=f.length;j<ie;j++)R.push(w?cx(f[j],Ks(f[j])?0:w-1,S,T):GT(f[j],T));return!w&&S&&R.length>0&&R.push(R[0].slice()),R}function Sm(f,w){return f.feature?i({},f.feature,{geometry:w}):dx(w)}function dx(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var qT={toGeoJSON:function(f){return Sm(this,{type:"Point",coordinates:GT(this.getLatLng(),f)})}};sx.include(qT),UT.include(qT),ox.include(qT),au.include({toGeoJSON:function(f){var w=!Ks(this._latlngs),S=cx(this._latlngs,w?1:0,!1,f);return Sm(this,{type:(w?"Multi":"")+"LineString",coordinates:S})}}),km.include({toGeoJSON:function(f){var w=!Ks(this._latlngs),S=w&&!Ks(this._latlngs[0]),T=cx(this._latlngs,S?2:w?1:0,!0,f);return w||(T=[T]),Sm(this,{type:(S?"Multi":"")+"Polygon",coordinates:T})}}),xm.include({toMultiPoint:function(f){var w=[];return this.eachLayer(function(S){w.push(S.toGeoJSON(f).geometry.coordinates)}),Sm(this,{type:"MultiPoint",coordinates:w})},toGeoJSON:function(f){var w=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(w==="MultiPoint")return this.toMultiPoint(f);var S=w==="GeometryCollection",T=[];return this.eachLayer(function(R){if(R.toGeoJSON){var j=R.toGeoJSON(f);if(S)T.push(j.geometry);else{var ie=dx(j);ie.type==="FeatureCollection"?T.push.apply(T,ie.features):T.push(ie)}}}),S?Sm(this,{geometries:T,type:"GeometryCollection"}):{type:"FeatureCollection",features:T}}});function iB(f,w){return new su(f,w)}var Gpe=iB,px=Io.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,w,S){this._url=f,this._bounds=fe(w),g(this,S)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Vt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){fn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&Ta(this._image),this},bringToBack:function(){return this._map&&ra(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=fe(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",w=this._image=f?this._url:Wt("img");if(Vt(w,"leaflet-image-layer"),this._zoomAnimated&&Vt(w,"leaflet-zoom-animated"),this.options.className&&Vt(w,this.options.className),w.onselectstart=d,w.onmousemove=d,w.onload=s(this.fire,this,"load"),w.onerror=s(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=w.src;return}w.src=this._url,w.alt=this.options.alt},_animateZoom:function(f){var w=this._map.getZoomScale(f.zoom),S=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;qs(this._image,S,w)},_reset:function(){var f=this._image,w=new Y(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),S=w.getSize();_r(f,w.min),f.style.width=S.x+"px",f.style.height=S.y+"px"},_updateOpacity:function(){Xa(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),qpe=function(f,w,S){return new px(f,w,S)},aB=px.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",w=this._image=f?this._url:Wt("video");if(Vt(w,"leaflet-image-layer"),this._zoomAnimated&&Vt(w,"leaflet-zoom-animated"),this.options.className&&Vt(w,this.options.className),w.onselectstart=d,w.onmousemove=d,w.onloadeddata=s(this.fire,this,"load"),f){for(var S=w.getElementsByTagName("source"),T=[],R=0;R<S.length;R++)T.push(S[R].src);this._url=S.length>0?T:[w.src];return}_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(w.style,"objectFit")&&(w.style.objectFit="fill"),w.autoplay=!!this.options.autoplay,w.loop=!!this.options.loop,w.muted=!!this.options.muted,w.playsInline=!!this.options.playsInline;for(var j=0;j<this._url.length;j++){var ie=Wt("source");ie.src=this._url[j],w.appendChild(ie)}}});function Kpe(f,w,S){return new aB(f,w,S)}var sB=px.extend({_initImage:function(){var f=this._image=this._url;Vt(f,"leaflet-image-layer"),this._zoomAnimated&&Vt(f,"leaflet-zoom-animated"),this.options.className&&Vt(f,this.options.className),f.onselectstart=d,f.onmousemove=d}});function Zpe(f,w,S){return new sB(f,w,S)}var cl=Io.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,w){f&&(f instanceof ye||_(f))?(this._latlng=_e(f),g(this,w)):(g(this,f),this._source=w),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&Xa(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&Xa(this._container,1),this.bringToFront(),this.options.interactive&&(Vt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(Xa(this._container,0),this._removeTimeout=setTimeout(s(fn,void 0,this._container),200)):fn(this._container),this.options.interactive&&(gr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=_e(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){!this._map||(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ta(this._container),this},bringToBack:function(){return this._map&&ra(this._container),this},_prepareOpen:function(f){var w=this._source;if(!w._map)return!1;if(w instanceof iu){w=null;var S=this._source._layers;for(var T in S)if(S[T]._map){w=S[T];break}if(!w)return!1;this._source=w}if(!f)if(w.getCenter)f=w.getCenter();else if(w.getLatLng)f=w.getLatLng();else if(w.getBounds)f=w.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(!!this._content){var f=this._contentNode,w=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof w=="string")f.innerHTML=w;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(w)}this.fire("contentupdate")}},_updatePosition:function(){if(!!this._map){var f=this._map.latLngToLayerPoint(this._latlng),w=X(this.options.offset),S=this._getAnchor();this._zoomAnimated?_r(this._container,f.add(S)):w=w.add(f).add(S);var T=this._containerBottom=-w.y,R=this._containerLeft=-Math.round(this._containerWidth/2)+w.x;this._container.style.bottom=T+"px",this._container.style.left=R+"px"}},_getAnchor:function(){return[0,0]}});dn.include({_initOverlay:function(f,w,S,T){var R=w;return R instanceof f||(R=new f(T).setContent(w)),S&&R.setLatLng(S),R}}),Io.include({_initOverlay:function(f,w,S,T){var R=S;return R instanceof f?(g(R,T),R._source=this):(R=w&&!T?w:new f(T,this),R.setContent(S)),R}});var hx=cl.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,cl.prototype.openOn.call(this,f)},onAdd:function(f){cl.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ac||this._source.on("preclick",vn))},onRemove:function(f){cl.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ac||this._source.off("preclick",vn))},getEvents:function(){var f=cl.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",w=this._container=Wt("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),S=this._wrapper=Wt("div",f+"-content-wrapper",w);if(this._contentNode=Wt("div",f+"-content",S),Na(w),Wi(this._contentNode),ue(w,"contextmenu",vn),this._tipContainer=Wt("div",f+"-tip-container",w),this._tip=Wt("div",f+"-tip",this._tipContainer),this.options.closeButton){var T=this._closeButton=Wt("a",f+"-close-button",w);T.setAttribute("role","button"),T.setAttribute("aria-label","Close popup"),T.href="#close",T.innerHTML='<span aria-hidden="true">&#215;</span>',ue(T,"click",function(R){Gr(R),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,w=f.style;w.width="",w.whiteSpace="nowrap";var S=f.offsetWidth;S=Math.min(S,this.options.maxWidth),S=Math.max(S,this.options.minWidth),w.width=S+1+"px",w.whiteSpace="",w.height="";var T=f.offsetHeight,R=this.options.maxHeight,j="leaflet-popup-scrolled";R&&T>R?(w.height=R+"px",Vt(f,j)):gr(f,j),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var w=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),S=this._getAnchor();_r(this._container,w.add(S))},_adjustPan:function(){if(!!this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,w=parseInt(Hr(this._container,"marginBottom"),10)||0,S=this._container.offsetHeight+w,T=this._containerWidth,R=new V(this._containerLeft,-S-this._containerBottom);R._add(ll(this._container));var j=f.layerPointToContainerPoint(R),ie=X(this.options.autoPanPadding),ge=X(this.options.autoPanPaddingTopLeft||ie),be=X(this.options.autoPanPaddingBottomRight||ie),Oe=f.getSize(),tt=0,Nt=0;j.x+T+be.x>Oe.x&&(tt=j.x+T-Oe.x+be.x),j.x-tt-ge.x<0&&(tt=j.x-ge.x),j.y+S+be.y>Oe.y&&(Nt=j.y+S-Oe.y+be.y),j.y-Nt-ge.y<0&&(Nt=j.y-ge.y),(tt||Nt)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([tt,Nt]))}},_getAnchor:function(){return X(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Xpe=function(f,w){return new hx(f,w)};dn.mergeOptions({closePopupOnClick:!0}),dn.include({openPopup:function(f,w,S){return this._initOverlay(hx,f,w,S).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),Io.include({bindPopup:function(f,w){return this._popup=this._initOverlay(hx,this._popup,f,w),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof iu||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){So(f);var w=f.layer||f.target;if(this._popup._source===w&&!(w instanceof ac)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=w,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var fx=cl.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){cl.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){cl.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=cl.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",w=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Wt("div",w),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var w,S,T=this._map,R=this._container,j=T.latLngToContainerPoint(T.getCenter()),ie=T.layerPointToContainerPoint(f),ge=this.options.direction,be=R.offsetWidth,Oe=R.offsetHeight,tt=X(this.options.offset),Nt=this._getAnchor();ge==="top"?(w=be/2,S=Oe):ge==="bottom"?(w=be/2,S=0):ge==="center"?(w=be/2,S=Oe/2):ge==="right"?(w=0,S=Oe/2):ge==="left"?(w=be,S=Oe/2):ie.x<j.x?(ge="right",w=0,S=Oe/2):(ge="left",w=be+(tt.x+Nt.x)*2,S=Oe/2),f=f.subtract(X(w,S,!0)).add(tt).add(Nt),gr(R,"leaflet-tooltip-right"),gr(R,"leaflet-tooltip-left"),gr(R,"leaflet-tooltip-top"),gr(R,"leaflet-tooltip-bottom"),Vt(R,"leaflet-tooltip-"+ge),_r(R,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&Xa(this._container,f)},_animateZoom:function(f){var w=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(w)},_getAnchor:function(){return X(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Jpe=function(f,w){return new fx(f,w)};dn.include({openTooltip:function(f,w,S){return this._initOverlay(fx,f,w,S).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),Io.include({bindTooltip:function(f,w){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(fx,this._tooltip,f,w),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var w=f?"off":"on",S={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?S.add=this._openTooltip:(S.mouseover=this._openTooltip,S.mouseout=this.closeTooltip,S.click=this._openTooltip,this._map?this._addFocusListeners():S.add=this._addFocusListeners),this._tooltip.options.sticky&&(S.mousemove=this._moveTooltip),this[w](S),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof iu||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var w=typeof f.getElement=="function"&&f.getElement();w&&(ue(w,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),ue(w,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var w=typeof f.getElement=="function"&&f.getElement();w&&w.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var w=this;this._map.once("moveend",function(){w._openOnceFlag=!1,w._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var w=f.latlng,S,T;this._tooltip.options.sticky&&f.originalEvent&&(S=this._map.mouseEventToContainerPoint(f.originalEvent),T=this._map.containerPointToLayerPoint(S),w=this._map.layerPointToLatLng(T)),this._tooltip.setLatLng(w)}});var oB=_m.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var w=f&&f.tagName==="DIV"?f:document.createElement("div"),S=this.options;if(S.html instanceof Element?(Bi(w),w.appendChild(S.html)):w.innerHTML=S.html!==!1?S.html:"",S.bgPos){var T=X(S.bgPos);w.style.backgroundPosition=-T.x+"px "+-T.y+"px"}return this._setIconStyles(w,"icon"),w},createShadow:function(){return null}});function Ype(f){return new oB(f)}_m.Default=y0;var v0=Io.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ue.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){g(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),fn(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ta(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ra(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof V?f:new V(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var w=this.getPane().children,S=-f(-1/0,1/0),T=0,R=w.length,j;T<R;T++)j=w[T].style.zIndex,w[T]!==this._container&&j&&(S=f(S,+j));isFinite(S)&&(this.options.zIndex=S+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(!!this._map&&!Ue.ielt9){Xa(this._container,this.options.opacity);var f=+new Date,w=!1,S=!1;for(var T in this._tiles){var R=this._tiles[T];if(!(!R.current||!R.loaded)){var j=Math.min(1,(f-R.loaded)/200);Xa(R.el,j),j<1?w=!0:(R.active?S=!0:this._onOpaqueTile(R),R.active=!0)}}S&&!this._noPrune&&this._pruneTiles(),w&&(E(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:d,_initContainer:function(){this._container||(this._container=Wt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,w=this.options.maxZoom;if(f!==void 0){for(var S in this._levels)S=Number(S),this._levels[S].el.children.length||S===f?(this._levels[S].el.style.zIndex=w-Math.abs(f-S),this._onUpdateLevel(S)):(fn(this._levels[S].el),this._removeTilesAtZoom(S),this._onRemoveLevel(S),delete this._levels[S]);var T=this._levels[f],R=this._map;return T||(T=this._levels[f]={},T.el=Wt("div","leaflet-tile-container leaflet-zoom-animated",this._container),T.el.style.zIndex=w,T.origin=R.project(R.unproject(R.getPixelOrigin()),f).round(),T.zoom=f,this._setZoomTransform(T,R.getCenter(),R.getZoom()),d(T.el.offsetWidth),this._onCreateLevel(T)),this._level=T,T}},_onUpdateLevel:d,_onRemoveLevel:d,_onCreateLevel:d,_pruneTiles:function(){if(!!this._map){var f,w,S=this._map.getZoom();if(S>this.options.maxZoom||S<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)w=this._tiles[f],w.retain=w.current;for(f in this._tiles)if(w=this._tiles[f],w.current&&!w.active){var T=w.coords;this._retainParent(T.x,T.y,T.z,T.z-5)||this._retainChildren(T.x,T.y,T.z,T.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var w in this._tiles)this._tiles[w].coords.z===f&&this._removeTile(w)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)fn(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,w,S,T){var R=Math.floor(f/2),j=Math.floor(w/2),ie=S-1,ge=new V(+R,+j);ge.z=+ie;var be=this._tileCoordsToKey(ge),Oe=this._tiles[be];return Oe&&Oe.active?(Oe.retain=!0,!0):(Oe&&Oe.loaded&&(Oe.retain=!0),ie>T?this._retainParent(R,j,ie,T):!1)},_retainChildren:function(f,w,S,T){for(var R=2*f;R<2*f+2;R++)for(var j=2*w;j<2*w+2;j++){var ie=new V(R,j);ie.z=S+1;var ge=this._tileCoordsToKey(ie),be=this._tiles[ge];if(be&&be.active){be.retain=!0;continue}else be&&be.loaded&&(be.retain=!0);S+1<T&&this._retainChildren(R,j,S+1,T)}},_resetView:function(f){var w=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),w,w)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var w=this.options;return w.minNativeZoom!==void 0&&f<w.minNativeZoom?w.minNativeZoom:w.maxNativeZoom!==void 0&&w.maxNativeZoom<f?w.maxNativeZoom:f},_setView:function(f,w,S,T){var R=Math.round(w);this.options.maxZoom!==void 0&&R>this.options.maxZoom||this.options.minZoom!==void 0&&R<this.options.minZoom?R=void 0:R=this._clampZoom(R);var j=this.options.updateWhenZooming&&R!==this._tileZoom;(!T||j)&&(this._tileZoom=R,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),R!==void 0&&this._update(f),S||this._pruneTiles(),this._noPrune=!!S),this._setZoomTransforms(f,w)},_setZoomTransforms:function(f,w){for(var S in this._levels)this._setZoomTransform(this._levels[S],f,w)},_setZoomTransform:function(f,w,S){var T=this._map.getZoomScale(S,f.zoom),R=f.origin.multiplyBy(T).subtract(this._map._getNewPixelOrigin(w,S)).round();Ue.any3d?qs(f.el,R,T):_r(f.el,R)},_resetGrid:function(){var f=this._map,w=f.options.crs,S=this._tileSize=this.getTileSize(),T=this._tileZoom,R=this._map.getPixelWorldBounds(this._tileZoom);R&&(this._globalTileRange=this._pxBoundsToTileRange(R)),this._wrapX=w.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,w.wrapLng[0]],T).x/S.x),Math.ceil(f.project([0,w.wrapLng[1]],T).x/S.y)],this._wrapY=w.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([w.wrapLat[0],0],T).y/S.x),Math.ceil(f.project([w.wrapLat[1],0],T).y/S.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var w=this._map,S=w._animatingZoom?Math.max(w._animateToZoom,w.getZoom()):w.getZoom(),T=w.getZoomScale(S,this._tileZoom),R=w.project(f,this._tileZoom).floor(),j=w.getSize().divideBy(T*2);return new Y(R.subtract(j),R.add(j))},_update:function(f){var w=this._map;if(!!w){var S=this._clampZoom(w.getZoom());if(f===void 0&&(f=w.getCenter()),this._tileZoom!==void 0){var T=this._getTiledPixelBounds(f),R=this._pxBoundsToTileRange(T),j=R.getCenter(),ie=[],ge=this.options.keepBuffer,be=new Y(R.getBottomLeft().subtract([ge,-ge]),R.getTopRight().add([ge,-ge]));if(!(isFinite(R.min.x)&&isFinite(R.min.y)&&isFinite(R.max.x)&&isFinite(R.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Oe in this._tiles){var tt=this._tiles[Oe].coords;(tt.z!==this._tileZoom||!be.contains(new V(tt.x,tt.y)))&&(this._tiles[Oe].current=!1)}if(Math.abs(S-this._tileZoom)>1){this._setView(f,S);return}for(var Nt=R.min.y;Nt<=R.max.y;Nt++)for(var rn=R.min.x;rn<=R.max.x;rn++){var Ea=new V(rn,Nt);if(Ea.z=this._tileZoom,!!this._isValidTile(Ea)){var _i=this._tiles[this._tileCoordsToKey(Ea)];_i?_i.current=!0:ie.push(Ea)}}if(ie.sort(function(Ja,Im){return Ja.distanceTo(j)-Im.distanceTo(j)}),ie.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Zs=document.createDocumentFragment();for(rn=0;rn<ie.length;rn++)this._addTile(ie[rn],Zs);this._level.el.appendChild(Zs)}}}},_isValidTile:function(f){var w=this._map.options.crs;if(!w.infinite){var S=this._globalTileRange;if(!w.wrapLng&&(f.x<S.min.x||f.x>S.max.x)||!w.wrapLat&&(f.y<S.min.y||f.y>S.max.y))return!1}if(!this.options.bounds)return!0;var T=this._tileCoordsToBounds(f);return fe(this.options.bounds).overlaps(T)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var w=this._map,S=this.getTileSize(),T=f.scaleBy(S),R=T.add(S),j=w.unproject(T,f.z),ie=w.unproject(R,f.z);return[j,ie]},_tileCoordsToBounds:function(f){var w=this._tileCoordsToNwSe(f),S=new pe(w[0],w[1]);return this.options.noWrap||(S=this._map.wrapLatLngBounds(S)),S},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var w=f.split(":"),S=new V(+w[0],+w[1]);return S.z=+w[2],S},_removeTile:function(f){var w=this._tiles[f];!w||(fn(w.el),delete this._tiles[f],this.fire("tileunload",{tile:w.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){Vt(f,"leaflet-tile");var w=this.getTileSize();f.style.width=w.x+"px",f.style.height=w.y+"px",f.onselectstart=d,f.onmousemove=d,Ue.ielt9&&this.options.opacity<1&&Xa(f,this.options.opacity)},_addTile:function(f,w){var S=this._getTilePos(f),T=this._tileCoordsToKey(f),R=this.createTile(this._wrapCoords(f),s(this._tileReady,this,f));this._initTile(R),this.createTile.length<2&&F(s(this._tileReady,this,f,null,R)),_r(R,S),this._tiles[T]={el:R,coords:f,current:!0},w.appendChild(R),this.fire("tileloadstart",{tile:R,coords:f})},_tileReady:function(f,w,S){w&&this.fire("tileerror",{error:w,tile:S,coords:f});var T=this._tileCoordsToKey(f);S=this._tiles[T],S&&(S.loaded=+new Date,this._map._fadeAnimated?(Xa(S.el,0),E(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(S.active=!0,this._pruneTiles()),w||(Vt(S.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:S.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ue.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(s(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var w=new V(this._wrapX?c(f.x,this._wrapX):f.x,this._wrapY?c(f.y,this._wrapY):f.y);return w.z=f.z,w},_pxBoundsToTileRange:function(f){var w=this.getTileSize();return new Y(f.min.unscaleBy(w).floor(),f.max.unscaleBy(w).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function Qpe(f){return new v0(f)}var Cm=v0.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,w){this._url=f,w=g(this,w),w.detectRetina&&Ue.retina&&w.maxZoom>0?(w.tileSize=Math.floor(w.tileSize/2),w.zoomReverse?(w.zoomOffset--,w.minZoom=Math.min(w.maxZoom,w.minZoom+1)):(w.zoomOffset++,w.maxZoom=Math.max(w.minZoom,w.maxZoom-1)),w.minZoom=Math.max(0,w.minZoom)):w.zoomReverse?w.minZoom=Math.min(w.maxZoom,w.minZoom):w.maxZoom=Math.max(w.minZoom,w.maxZoom),typeof w.subdomains=="string"&&(w.subdomains=w.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,w){return this._url===f&&w===void 0&&(w=!0),this._url=f,w||this.redraw(),this},createTile:function(f,w){var S=document.createElement("img");return ue(S,"load",s(this._tileOnLoad,this,w,S)),ue(S,"error",s(this._tileOnError,this,w,S)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(S.referrerPolicy=this.options.referrerPolicy),S.alt="",S.src=this.getTileUrl(f),S},getTileUrl:function(f){var w={r:Ue.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var S=this._globalTileRange.max.y-f.y;this.options.tms&&(w.y=S),w["-y"]=S}return b(this._url,i(w,this.options))},_tileOnLoad:function(f,w){Ue.ielt9?setTimeout(s(f,this,null,w),0):f(null,w)},_tileOnError:function(f,w,S){var T=this.options.errorTileUrl;T&&w.getAttribute("src")!==T&&(w.src=T),f(S,w)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,w=this.options.maxZoom,S=this.options.zoomReverse,T=this.options.zoomOffset;return S&&(f=w-f),f+T},_getSubdomain:function(f){var w=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[w]},_abortLoading:function(){var f,w;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(w=this._tiles[f].el,w.onload=d,w.onerror=d,!w.complete)){w.src=C;var S=this._tiles[f].coords;fn(w),delete this._tiles[f],this.fire("tileabort",{tile:w,coords:S})}},_removeTile:function(f){var w=this._tiles[f];if(!!w)return w.el.setAttribute("src",C),v0.prototype._removeTile.call(this,f)},_tileReady:function(f,w,S){if(!(!this._map||S&&S.getAttribute("src")===C))return v0.prototype._tileReady.call(this,f,w,S)}});function lB(f,w){return new Cm(f,w)}var uB=Cm.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,w){this._url=f;var S=i({},this.defaultWmsParams);for(var T in w)T in this.options||(S[T]=w[T]);w=g(this,w);var R=w.detectRetina&&Ue.retina?2:1,j=this.getTileSize();S.width=j.x*R,S.height=j.y*R,this.wmsParams=S},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var w=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[w]=this._crs.code,Cm.prototype.onAdd.call(this,f)},getTileUrl:function(f){var w=this._tileCoordsToNwSe(f),S=this._crs,T=ce(S.project(w[0]),S.project(w[1])),R=T.min,j=T.max,ie=(this._wmsVersion>=1.3&&this._crs===tB?[R.y,R.x,j.y,j.x]:[R.x,R.y,j.x,j.y]).join(","),ge=Cm.prototype.getTileUrl.call(this,f);return ge+v(this.wmsParams,ge,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ie},setParams:function(f,w){return i(this.wmsParams,f),w||this.redraw(),this}});function ehe(f,w){return new uB(f,w)}Cm.WMS=uB,lB.wms=ehe;var ou=Io.extend({options:{padding:.1},initialize:function(f){g(this,f),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Vt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,w){var S=this._map.getZoomScale(w,this._zoom),T=this._map.getSize().multiplyBy(.5+this.options.padding),R=this._map.project(this._center,w),j=T.multiplyBy(-S).add(R).subtract(this._map._getNewPixelOrigin(f,w));Ue.any3d?qs(this._container,j,S):_r(this._container,j)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,w=this._map.getSize(),S=this._map.containerPointToLayerPoint(w.multiplyBy(-f)).round();this._bounds=new Y(S,S.add(w.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),cB=ou.extend({options:{tolerance:0},getEvents:function(){var f=ou.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ou.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");ue(f,"mousemove",this._onMouseMove,this),ue(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ue(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){E(this._redrawRequest),delete this._ctx,fn(this._container),je(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var w in this._layers)f=this._layers[w],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ou.prototype._update.call(this);var f=this._bounds,w=this._container,S=f.getSize(),T=Ue.retina?2:1;_r(w,f.min),w.width=T*S.x,w.height=T*S.y,w.style.width=S.x+"px",w.style.height=S.y+"px",Ue.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){ou.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[l(f)]=f;var w=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=w),this._drawLast=w,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var w=f._order,S=w.next,T=w.prev;S?S.prev=T:this._drawLast=T,T?T.next=S:this._drawFirst=S,delete f._order,delete this._layers[l(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var w=f.options.dashArray.split(/[, ]+/),S=[],T,R;for(R=0;R<w.length;R++){if(T=Number(w[R]),isNaN(T))return;S.push(T)}f.options._dashArray=S}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){!this._map||(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var w=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Y,this._redrawBounds.extend(f._pxBounds.min.subtract([w,w])),this._redrawBounds.extend(f._pxBounds.max.add([w,w]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var w=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,w.x,w.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,w=this._redrawBounds;if(this._ctx.save(),w){var S=w.getSize();this._ctx.beginPath(),this._ctx.rect(w.min.x,w.min.y,S.x,S.y),this._ctx.clip()}this._drawing=!0;for(var T=this._drawFirst;T;T=T.next)f=T.layer,(!w||f._pxBounds&&f._pxBounds.intersects(w))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,w){if(!!this._drawing){var S,T,R,j,ie=f._parts,ge=ie.length,be=this._ctx;if(!!ge){for(be.beginPath(),S=0;S<ge;S++){for(T=0,R=ie[S].length;T<R;T++)j=ie[S][T],be[T?"lineTo":"moveTo"](j.x,j.y);w&&be.closePath()}this._fillStroke(be,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var w=f._point,S=this._ctx,T=Math.max(Math.round(f._radius),1),R=(Math.max(Math.round(f._radiusY),1)||T)/T;R!==1&&(S.save(),S.scale(1,R)),S.beginPath(),S.arc(w.x,w.y/R,T,0,Math.PI*2,!1),R!==1&&S.restore(),this._fillStroke(S,f)}},_fillStroke:function(f,w){var S=w.options;S.fill&&(f.globalAlpha=S.fillOpacity,f.fillStyle=S.fillColor||S.color,f.fill(S.fillRule||"evenodd")),S.stroke&&S.weight!==0&&(f.setLineDash&&f.setLineDash(w.options&&w.options._dashArray||[]),f.globalAlpha=S.opacity,f.lineWidth=S.weight,f.strokeStyle=S.color,f.lineCap=S.lineCap,f.lineJoin=S.lineJoin,f.stroke())},_onClick:function(f){for(var w=this._map.mouseEventToLayerPoint(f),S,T,R=this._drawFirst;R;R=R.next)S=R.layer,S.options.interactive&&S._containsPoint(w)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(S))&&(T=S);this._fireEvent(T?[T]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var w=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,w)}},_handleMouseOut:function(f){var w=this._hoveredLayer;w&&(gr(this._container,"leaflet-interactive"),this._fireEvent([w],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,w){if(!this._mouseHoverThrottled){for(var S,T,R=this._drawFirst;R;R=R.next)S=R.layer,S.options.interactive&&S._containsPoint(w)&&(T=S);T!==this._hoveredLayer&&(this._handleMouseOut(f),T&&(Vt(this._container,"leaflet-interactive"),this._fireEvent([T],f,"mouseover"),this._hoveredLayer=T)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(s(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,w,S){this._map._fireDOMEvent(w,S||w.type,f)},_bringToFront:function(f){var w=f._order;if(!!w){var S=w.next,T=w.prev;if(S)S.prev=T;else return;T?T.next=S:S&&(this._drawFirst=S),w.prev=this._drawLast,this._drawLast.next=w,w.next=null,this._drawLast=w,this._requestRedraw(f)}},_bringToBack:function(f){var w=f._order;if(!!w){var S=w.next,T=w.prev;if(T)T.next=S;else return;S?S.prev=T:T&&(this._drawLast=T),w.prev=null,w.next=this._drawFirst,this._drawFirst.prev=w,this._drawFirst=w,this._requestRedraw(f)}}});function dB(f){return Ue.canvas?new cB(f):null}var b0=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),the={_initContainer:function(){this._container=Wt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ou.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var w=f._container=b0("shape");Vt(w,"leaflet-vml-shape "+(this.options.className||"")),w.coordsize="1 1",f._path=b0("path"),w.appendChild(f._path),this._updateStyle(f),this._layers[l(f)]=f},_addPath:function(f){var w=f._container;this._container.appendChild(w),f.options.interactive&&f.addInteractiveTarget(w)},_removePath:function(f){var w=f._container;fn(w),f.removeInteractiveTarget(w),delete this._layers[l(f)]},_updateStyle:function(f){var w=f._stroke,S=f._fill,T=f.options,R=f._container;R.stroked=!!T.stroke,R.filled=!!T.fill,T.stroke?(w||(w=f._stroke=b0("stroke")),R.appendChild(w),w.weight=T.weight+"px",w.color=T.color,w.opacity=T.opacity,T.dashArray?w.dashStyle=_(T.dashArray)?T.dashArray.join(" "):T.dashArray.replace(/( *, *)/g," "):w.dashStyle="",w.endcap=T.lineCap.replace("butt","flat"),w.joinstyle=T.lineJoin):w&&(R.removeChild(w),f._stroke=null),T.fill?(S||(S=f._fill=b0("fill")),R.appendChild(S),S.color=T.fillColor||T.color,S.opacity=T.fillOpacity):S&&(R.removeChild(S),f._fill=null)},_updateCircle:function(f){var w=f._point.round(),S=Math.round(f._radius),T=Math.round(f._radiusY||S);this._setPath(f,f._empty()?"M0 0":"AL "+w.x+","+w.y+" "+S+","+T+" 0,"+65535*360)},_setPath:function(f,w){f._path.v=w},_bringToFront:function(f){Ta(f._container)},_bringToBack:function(f){ra(f._container)}},mx=Ue.vml?b0:xt,w0=ou.extend({_initContainer:function(){this._container=mx("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=mx("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){fn(this._container),je(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ou.prototype._update.call(this);var f=this._bounds,w=f.getSize(),S=this._container;(!this._svgSize||!this._svgSize.equals(w))&&(this._svgSize=w,S.setAttribute("width",w.x),S.setAttribute("height",w.y)),_r(S,f.min),S.setAttribute("viewBox",[f.min.x,f.min.y,w.x,w.y].join(" ")),this.fire("update")}},_initPath:function(f){var w=f._path=mx("path");f.options.className&&Vt(w,f.options.className),f.options.interactive&&Vt(w,"leaflet-interactive"),this._updateStyle(f),this._layers[l(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){fn(f._path),f.removeInteractiveTarget(f._path),delete this._layers[l(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var w=f._path,S=f.options;!w||(S.stroke?(w.setAttribute("stroke",S.color),w.setAttribute("stroke-opacity",S.opacity),w.setAttribute("stroke-width",S.weight),w.setAttribute("stroke-linecap",S.lineCap),w.setAttribute("stroke-linejoin",S.lineJoin),S.dashArray?w.setAttribute("stroke-dasharray",S.dashArray):w.removeAttribute("stroke-dasharray"),S.dashOffset?w.setAttribute("stroke-dashoffset",S.dashOffset):w.removeAttribute("stroke-dashoffset")):w.setAttribute("stroke","none"),S.fill?(w.setAttribute("fill",S.fillColor||S.color),w.setAttribute("fill-opacity",S.fillOpacity),w.setAttribute("fill-rule",S.fillRule||"evenodd")):w.setAttribute("fill","none"))},_updatePoly:function(f,w){this._setPath(f,gt(f._parts,w))},_updateCircle:function(f){var w=f._point,S=Math.max(Math.round(f._radius),1),T=Math.max(Math.round(f._radiusY),1)||S,R="a"+S+","+T+" 0 1,0 ",j=f._empty()?"M0 0":"M"+(w.x-S)+","+w.y+R+S*2+",0 "+R+-S*2+",0 ";this._setPath(f,j)},_setPath:function(f,w){f._path.setAttribute("d",w)},_bringToFront:function(f){Ta(f._path)},_bringToBack:function(f){ra(f._path)}});Ue.vml&&w0.include(the);function pB(f){return Ue.svg||Ue.vml?new w0(f):null}dn.include({getRenderer:function(f){var w=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return w||(w=this._renderer=this._createRenderer()),this.hasLayer(w)||this.addLayer(w),w},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var w=this._paneRenderers[f];return w===void 0&&(w=this._createRenderer({pane:f}),this._paneRenderers[f]=w),w},_createRenderer:function(f){return this.options.preferCanvas&&dB(f)||pB(f)}});var hB=km.extend({initialize:function(f,w){km.prototype.initialize.call(this,this._boundsToLatLngs(f),w)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=fe(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function nhe(f,w){return new hB(f,w)}w0.create=mx,w0.pointsToPath=gt,su.geometryToLayer=lx,su.coordsToLatLng=HT,su.coordsToLatLngs=ux,su.latLngToCoords=GT,su.latLngsToCoords=cx,su.getFeature=Sm,su.asFeature=dx,dn.mergeOptions({boxZoom:!0});var fB=ul.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){ue(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){je(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){fn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Qu(),Yd(),this._startPoint=this._map.mouseEventToContainerPoint(f),ue(document,{contextmenu:So,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Wt("div","leaflet-zoom-box",this._container),Vt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var w=new Y(this._point,this._startPoint),S=w.getSize();_r(this._box,w.min),this._box.style.width=S.x+"px",this._box.style.height=S.y+"px"},_finish:function(){this._moved&&(fn(this._box),gr(this._container,"leaflet-crosshair")),tu(),tc(),je(document,{contextmenu:So,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(s(this._resetState,this),0);var w=new pe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(w).fire("boxzoomend",{boxZoomBounds:w})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});dn.addInitHook("addHandler","boxZoom",fB),dn.mergeOptions({doubleClickZoom:!0});var mB=ul.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var w=this._map,S=w.getZoom(),T=w.options.zoomDelta,R=f.originalEvent.shiftKey?S-T:S+T;w.options.doubleClickZoom==="center"?w.setZoom(R):w.setZoomAround(f.containerPoint,R)}});dn.addInitHook("addHandler","doubleClickZoom",mB),dn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var gB=ul.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new ic(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}Vt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){gr(this._map._container,"leaflet-grab"),gr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var w=fe(this._map.options.maxBounds);this._offsetLimit=ce(this._map.latLngToContainerPoint(w.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(w.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var w=this._lastTime=+new Date,S=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(S),this._times.push(w),this._prunePositions(w)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),w=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=w.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,w){return f-(f-w)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),w=this._offsetLimit;f.x<w.min.x&&(f.x=this._viscousLimit(f.x,w.min.x)),f.y<w.min.y&&(f.y=this._viscousLimit(f.y,w.min.y)),f.x>w.max.x&&(f.x=this._viscousLimit(f.x,w.max.x)),f.y>w.max.y&&(f.y=this._viscousLimit(f.y,w.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,w=Math.round(f/2),S=this._initialWorldOffset,T=this._draggable._newPos.x,R=(T-w+S)%f+w-S,j=(T+w+S)%f-w-S,ie=Math.abs(R+S)<Math.abs(j+S)?R:j;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ie},_onDragEnd:function(f){var w=this._map,S=w.options,T=!S.inertia||f.noInertia||this._times.length<2;if(w.fire("dragend",f),T)w.fire("moveend");else{this._prunePositions(+new Date);var R=this._lastPos.subtract(this._positions[0]),j=(this._lastTime-this._times[0])/1e3,ie=S.easeLinearity,ge=R.multiplyBy(ie/j),be=ge.distanceTo([0,0]),Oe=Math.min(S.inertiaMaxSpeed,be),tt=ge.multiplyBy(Oe/be),Nt=Oe/(S.inertiaDeceleration*ie),rn=tt.multiplyBy(-Nt/2).round();!rn.x&&!rn.y?w.fire("moveend"):(rn=w._limitOffset(rn,w.options.maxBounds),F(function(){w.panBy(rn,{duration:Nt,easeLinearity:ie,noMoveStart:!0,animate:!0})}))}}});dn.addInitHook("addHandler","dragging",gB),dn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var yB=ul.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),ue(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),je(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,w=document.documentElement,S=f.scrollTop||w.scrollTop,T=f.scrollLeft||w.scrollLeft;this._map._container.focus(),window.scrollTo(T,S)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var w=this._panKeys={},S=this.keyCodes,T,R;for(T=0,R=S.left.length;T<R;T++)w[S.left[T]]=[-1*f,0];for(T=0,R=S.right.length;T<R;T++)w[S.right[T]]=[f,0];for(T=0,R=S.down.length;T<R;T++)w[S.down[T]]=[0,f];for(T=0,R=S.up.length;T<R;T++)w[S.up[T]]=[0,-1*f]},_setZoomDelta:function(f){var w=this._zoomKeys={},S=this.keyCodes,T,R;for(T=0,R=S.zoomIn.length;T<R;T++)w[S.zoomIn[T]]=f;for(T=0,R=S.zoomOut.length;T<R;T++)w[S.zoomOut[T]]=-f},_addHooks:function(){ue(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){je(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var w=f.keyCode,S=this._map,T;if(w in this._panKeys){if(!S._panAnim||!S._panAnim._inProgress)if(T=this._panKeys[w],f.shiftKey&&(T=X(T).multiplyBy(3)),S.options.maxBounds&&(T=S._limitOffset(X(T),S.options.maxBounds)),S.options.worldCopyJump){var R=S.wrapLatLng(S.unproject(S.project(S.getCenter()).add(T)));S.panTo(R)}else S.panBy(T)}else if(w in this._zoomKeys)S.setZoom(S.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[w]);else if(w===27&&S._popup&&S._popup.options.closeOnEscapeKey)S.closePopup();else return;So(f)}}});dn.addInitHook("addHandler","keyboard",yB),dn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var vB=ul.extend({addHooks:function(){ue(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){je(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var w=f0(f),S=this._map.options.wheelDebounceTime;this._delta+=w,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var T=Math.max(S-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(s(this._performZoom,this),T),So(f)},_performZoom:function(){var f=this._map,w=f.getZoom(),S=this._map.options.zoomSnap||0;f._stop();var T=this._delta/(this._map.options.wheelPxPerZoomLevel*4),R=4*Math.log(2/(1+Math.exp(-Math.abs(T))))/Math.LN2,j=S?Math.ceil(R/S)*S:R,ie=f._limitZoom(w+(this._delta>0?j:-j))-w;this._delta=0,this._startTime=null,ie&&(f.options.scrollWheelZoom==="center"?f.setZoom(w+ie):f.setZoomAround(this._lastMousePos,w+ie))}});dn.addInitHook("addHandler","scrollWheelZoom",vB);var rhe=600;dn.mergeOptions({tapHold:Ue.touchNative&&Ue.safari&&Ue.mobile,tapTolerance:15});var bB=ul.extend({addHooks:function(){ue(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){je(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var w=f.touches[0];this._startPos=this._newPos=new V(w.clientX,w.clientY),this._holdTimeout=setTimeout(s(function(){this._cancel(),this._isTapValid()&&(ue(document,"touchend",Gr),ue(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",w))},this),rhe),ue(document,"touchend touchcancel contextmenu",this._cancel,this),ue(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){je(document,"touchend",Gr),je(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),je(document,"touchend touchcancel contextmenu",this._cancel,this),je(document,"touchmove",this._onMove,this)},_onMove:function(f){var w=f.touches[0];this._newPos=new V(w.clientX,w.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,w){var S=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:w.screenX,screenY:w.screenY,clientX:w.clientX,clientY:w.clientY});S._simulated=!0,w.target.dispatchEvent(S)}});dn.addInitHook("addHandler","tapHold",bB),dn.mergeOptions({touchZoom:Ue.touch,bounceAtZoomLimits:!0});var wB=ul.extend({addHooks:function(){Vt(this._map._container,"leaflet-touch-zoom"),ue(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){gr(this._map._container,"leaflet-touch-zoom"),je(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var w=this._map;if(!(!f.touches||f.touches.length!==2||w._animatingZoom||this._zooming)){var S=w.mouseEventToContainerPoint(f.touches[0]),T=w.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=w.getSize()._divideBy(2),this._startLatLng=w.containerPointToLatLng(this._centerPoint),w.options.touchZoom!=="center"&&(this._pinchStartLatLng=w.containerPointToLatLng(S.add(T)._divideBy(2))),this._startDist=S.distanceTo(T),this._startZoom=w.getZoom(),this._moved=!1,this._zooming=!0,w._stop(),ue(document,"touchmove",this._onTouchMove,this),ue(document,"touchend touchcancel",this._onTouchEnd,this),Gr(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var w=this._map,S=w.mouseEventToContainerPoint(f.touches[0]),T=w.mouseEventToContainerPoint(f.touches[1]),R=S.distanceTo(T)/this._startDist;if(this._zoom=w.getScaleZoom(R,this._startZoom),!w.options.bounceAtZoomLimits&&(this._zoom<w.getMinZoom()&&R<1||this._zoom>w.getMaxZoom()&&R>1)&&(this._zoom=w._limitZoom(this._zoom)),w.options.touchZoom==="center"){if(this._center=this._startLatLng,R===1)return}else{var j=S._add(T)._divideBy(2)._subtract(this._centerPoint);if(R===1&&j.x===0&&j.y===0)return;this._center=w.unproject(w.project(this._pinchStartLatLng,this._zoom).subtract(j),this._zoom)}this._moved||(w._moveStart(!0,!1),this._moved=!0),E(this._animRequest);var ie=s(w._move,w,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(ie,this,!0),Gr(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,E(this._animRequest),je(document,"touchmove",this._onTouchMove,this),je(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});dn.addInitHook("addHandler","touchZoom",wB),dn.BoxZoom=fB,dn.DoubleClickZoom=mB,dn.Drag=gB,dn.Keyboard=yB,dn.ScrollWheelZoom=vB,dn.TapHold=bB,dn.TouchZoom=wB,n.Bounds=Y,n.Browser=Ue,n.CRS=Ee,n.Canvas=cB,n.Circle=UT,n.CircleMarker=ox,n.Class=q,n.Control=Co,n.DivIcon=oB,n.DivOverlay=cl,n.DomEvent=xpe,n.DomUtil=te,n.Draggable=ic,n.Evented=ee,n.FeatureGroup=iu,n.GeoJSON=su,n.GridLayer=v0,n.Handler=ul,n.Icon=_m,n.ImageOverlay=px,n.LatLng=ye,n.LatLngBounds=pe,n.Layer=Io,n.LayerGroup=xm,n.LineUtil=Mpe,n.Map=dn,n.Marker=sx,n.Mixin=Tpe,n.Path=ac,n.Point=V,n.PolyUtil=Npe,n.Polygon=km,n.Polyline=au,n.Popup=hx,n.PosAnimation=j3,n.Projection=Rpe,n.Rectangle=hB,n.Renderer=ou,n.SVG=w0,n.SVGOverlay=sB,n.TileLayer=Cm,n.Tooltip=fx,n.Transformation=at,n.Util=z,n.VideoOverlay=aB,n.bind=s,n.bounds=ce,n.canvas=dB,n.circle=jpe,n.circleMarker=Vpe,n.control=m0,n.divIcon=Ype,n.extend=i,n.featureGroup=zpe,n.geoJSON=iB,n.geoJson=Gpe,n.gridLayer=Qpe,n.icon=Bpe,n.imageOverlay=qpe,n.latLng=_e,n.latLngBounds=fe,n.layerGroup=Fpe,n.map=_pe,n.marker=Wpe,n.point=X,n.polygon=Hpe,n.polyline=Upe,n.popup=Xpe,n.rectangle=nhe,n.setOptions=g,n.stamp=l,n.svg=pB,n.svgOverlay=Zpe,n.tileLayer=lB,n.tooltip=Jpe,n.transformation=Je,n.version=r,n.videoOverlay=Kpe;var ihe=window.L;n.noConflict=function(){return window.L=ihe,this},window.L=n})})(wd,wd.exports);const E_=wd.exports;function M3(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function R3(e,t){return t==null?function(r,i){const a=I.exports.useRef();return a.current||(a.current=e(r,i)),a}:function(r,i){const a=I.exports.useRef();a.current||(a.current=e(r,i));const s=I.exports.useRef(r),{instance:o}=a.current;return I.exports.useEffect(function(){s.current!==r&&(t(o,r,s.current),s.current=r)},[o,r,i]),a}}function PCt(e,t){I.exports.useEffect(function(){var i;return((i=t.layerContainer)!=null?i:t.map).addLayer(e.instance),function(){var s;(s=t.layerContainer)==null||s.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Ade(e){return function(n){const r=Ode(),i=e(A3(n,r),r);return Tde(r.map,n.attribution),Pde(i.current,n.eventHandlers),PCt(i.current,r),i}}function ACt(e,t){const n=R3(e,t),r=Ade(n);return TCt(r)}function MCt(e,t){const n=R3(e),r=OCt(n,t);return NCt(r)}function RCt(e,t){const n=R3(e,t),r=Ade(n);return ECt(r)}function DCt(e,t,n){const{opacity:r,zIndex:i}=t;r!=null&&r!==n.opacity&&e.setOpacity(r),i!=null&&i!==n.zIndex&&e.setZIndex(i)}function LCt({bounds:e,boundsOptions:t,center:n,children:r,className:i,id:a,placeholder:s,style:o,whenReady:l,zoom:u,...c},d){const[p]=I.exports.useState({className:i,id:a,style:o}),[h,m]=I.exports.useState(null);I.exports.useImperativeHandle(d,()=>{var y;return(y=h==null?void 0:h.map)!=null?y:null},[h]);const g=I.exports.useCallback(y=>{if(y!==null&&h===null){const b=new wd.exports.Map(y,c);n!=null&&u!=null?b.setView(n,u):e!=null&&b.fitBounds(e,t),l!=null&&b.whenReady(l),m(ICt(b))}},[]);I.exports.useEffect(()=>()=>{h==null||h.map.remove()},[h]);const v=h?x(Ede,{value:h,children:r}):s!=null?s:null;return x("div",{...p,ref:g,children:v})}const FCt=I.exports.forwardRef(LCt),zCt=ACt(function({position:t,...n},r){const i=new wd.exports.Marker(t,n);return M3(i,$Ct(r,{overlayContainer:i}))},function(t,n,r){n.position!==r.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),BCt=MCt(function(t,n){const r=new wd.exports.Popup(t,n.overlayContainer);return M3(r,n)},function(t,n,{position:r},i){I.exports.useEffect(function(){const{instance:s}=t;function o(u){u.popup===s&&(s.update(),i(!0))}function l(u){u.popup===s&&i(!1)}return n.map.on({popupopen:o,popupclose:l}),n.overlayContainer==null?(r!=null&&s.setLatLng(r),s.openOn(n.map)):n.overlayContainer.bindPopup(s),function(){var c;n.map.off({popupopen:o,popupclose:l}),(c=n.overlayContainer)==null||c.unbindPopup(),n.map.removeLayer(s)}},[t,n,i,r])}),WCt=RCt(function({url:t,...n},r){const i=new wd.exports.TileLayer(t,A3(n,r));return M3(i,r)},function(t,n,r){DCt(t,n,r);const{url:i}=n;i!=null&&i!==r.url&&t.setUrl(i)});const Mde=Tr(e=>({units:[],addUnit:t=>e(n=>({units:[...n.units,t]})),setUnits:t=>e({units:t})}));function VCt(){const{units:e,setUnits:t}=Mde();return I.exports.useEffect(()=>{Ne("getActiveUnits").then(n=>{!n||t(n)})},[]),x(ze,{children:B(Ce,{justify:"flex-start",spacing:10,h:"100%",w:"49%",children:[x(Bt,{w:"100%",h:40,color:"dark.6",radius:"xs",py:5,px:10,shadow:"xs",children:x(me,{h:"100%",children:x(Te,{fw:650,size:20,children:K.active_units})})}),x(An,{h:"100%",scrollHideDelay:0,scrollbarSize:5,children:x(Ce,{spacing:10,children:e&&e.length>0&&e.map((n,r)=>x(Bt,{w:"100%",color:"dark.6",radius:"md",p:25,shadow:"md",children:B(me,{children:[x(bt,{color:"blue",variant:"filled",children:n.callsign}),x(Te,{fw:600,children:n.name})]})},r))})})]})})}function jCt(){const{calls:e}=FR();return B(Ce,{justify:"flex-start",spacing:10,h:"100%",w:"49%",children:[x(Bt,{w:"100%",h:40,color:"dark.6",radius:"xs",py:5,px:10,shadow:"xs",children:x(me,{h:"100%",children:x(Te,{fw:650,size:20,children:K.calls})})}),x(An,{h:500,scrollHideDelay:0,scrollbarSize:5,children:x(Ce,{spacing:10,children:e&&e.length>0&&e.map((t,n)=>x(Bt,{w:"100%",color:"dark.6",radius:"md",p:10,shadow:"md",children:B(Ce,{spacing:0,h:"100%",children:[B(me,{spacing:5,children:[x(bt,{color:"blue",variant:"filled",children:t.id}),t.callsign&&x(bt,{color:"blue",variant:"filled",children:t.callsign}),x(Te,{fw:650,children:t.title})]}),t.location&&B(me,{spacing:5,children:[x(CMe,{size:16}),x(Te,{fw:600,size:14,children:t.location})]}),t.gender&&B(me,{spacing:5,children:[x(dMe,{size:16}),x(Te,{fw:600,size:14,children:t.gender})]}),t.vehicle&&B(me,{spacing:5,children:[x(QY,{size:16}),B(Te,{fw:600,size:14,children:[t.vehicle.color," ",t.vehicle.model," [",t.vehicle.plate,"]"]})]}),t.weapon&&B(me,{spacing:5,children:[x(MMe,{size:16}),x(Te,{fw:600,size:14,children:t.weapon})]}),x(Ce,{justify:"flex-end",h:"100%",children:x(Te,{fw:500,size:13,color:"gray.5",children:P3(t.timestamp,{addSuffix:!0,includeSeconds:!0})})})]})},n))})})]})}var dr="-ms-",Eb="-moz-",Nn="-webkit-",Rde="comm",ET="rule",D3="decl",UCt="@import",Dde="@keyframes",HCt="@layer",Lde=Math.abs,L3=String.fromCharCode,LA=Object.assign;function GCt(e,t){return Si(e,0)^45?(((t<<2^Si(e,0))<<2^Si(e,1))<<2^Si(e,2))<<2^Si(e,3):0}function Fde(e){return e.trim()}function pu(e,t){return(e=t.exec(e))?e[0]:e}function Yt(e,t,n){return e.replace(t,n)}function vk(e,t,n){return e.indexOf(t,n)}function Si(e,t){return e.charCodeAt(t)|0}function vy(e,t,n){return e.slice(t,n)}function Cl(e){return e.length}function zde(e){return e.length}function cb(e,t){return t.push(e),e}function qCt(e,t){return e.map(t).join("")}function dG(e,t){return e.filter(function(n){return!pu(n,t)})}var OT=1,by=1,Bde=0,fo=0,Zr=0,a0="";function PT(e,t,n,r,i,a,s,o){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:OT,column:by,length:s,return:"",siblings:o}}function yc(e,t){return LA(PT("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function Wm(e){for(;e.root;)e=yc(e.root,{children:[e]});cb(e,e.siblings)}function KCt(){return Zr}function ZCt(){return Zr=fo>0?Si(a0,--fo):0,by--,Zr===10&&(by=1,OT--),Zr}function Uo(){return Zr=fo<Bde?Si(a0,fo++):0,by++,Zr===10&&(by=1,OT++),Zr}function Wp(){return Si(a0,fo)}function bk(){return fo}function AT(e,t){return vy(a0,e,t)}function FA(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function XCt(e){return OT=by=1,Bde=Cl(a0=e),fo=0,[]}function JCt(e){return a0="",e}function VE(e){return Fde(AT(fo-1,zA(e===91?e+2:e===40?e+1:e)))}function YCt(e){for(;(Zr=Wp())&&Zr<33;)Uo();return FA(e)>2||FA(Zr)>3?"":" "}function QCt(e,t){for(;--t&&Uo()&&!(Zr<48||Zr>102||Zr>57&&Zr<65||Zr>70&&Zr<97););return AT(e,bk()+(t<6&&Wp()==32&&Uo()==32))}function zA(e){for(;Uo();)switch(Zr){case e:return fo;case 34:case 39:e!==34&&e!==39&&zA(Zr);break;case 40:e===41&&zA(e);break;case 92:Uo();break}return fo}function eIt(e,t){for(;Uo()&&e+Zr!==47+10;)if(e+Zr===42+42&&Wp()===47)break;return"/*"+AT(t,fo-1)+"*"+L3(e===47?e:Uo())}function tIt(e){for(;!FA(Wp());)Uo();return AT(e,fo)}function nIt(e){return JCt(wk("",null,null,null,[""],e=XCt(e),0,[0],e))}function wk(e,t,n,r,i,a,s,o,l){for(var u=0,c=0,d=s,p=0,h=0,m=0,g=1,v=1,y=1,b=0,_="",k=i,C=a,$=r,N=_;v;)switch(m=b,b=Uo()){case 40:if(m!=108&&Si(N,d-1)==58){vk(N+=Yt(VE(b),"&","&\f"),"&\f",Lde(u?o[u-1]:0))!=-1&&(y=-1);break}case 34:case 39:case 91:N+=VE(b);break;case 9:case 10:case 13:case 32:N+=YCt(m);break;case 92:N+=QCt(bk()-1,7);continue;case 47:switch(Wp()){case 42:case 47:cb(rIt(eIt(Uo(),bk()),t,n,l),l);break;default:N+="/"}break;case 123*g:o[u++]=Cl(N)*y;case 125*g:case 59:case 0:switch(b){case 0:case 125:v=0;case 59+c:y==-1&&(N=Yt(N,/\f/g,"")),h>0&&Cl(N)-d&&cb(h>32?hG(N+";",r,n,d-1,l):hG(Yt(N," ","")+";",r,n,d-2,l),l);break;case 59:N+=";";default:if(cb($=pG(N,t,n,u,c,i,o,_,k=[],C=[],d,a),a),b===123)if(c===0)wk(N,t,$,$,k,a,d,o,C);else switch(p===99&&Si(N,3)===110?100:p){case 100:case 108:case 109:case 115:wk(e,$,$,r&&cb(pG(e,$,$,0,0,i,o,_,i,k=[],d,C),C),i,C,d,o,r?k:C);break;default:wk(N,$,$,$,[""],C,0,o,C)}}u=c=h=0,g=y=1,_=N="",d=s;break;case 58:d=1+Cl(N),h=m;default:if(g<1){if(b==123)--g;else if(b==125&&g++==0&&ZCt()==125)continue}switch(N+=L3(b),b*g){case 38:y=c>0?1:(N+="\f",-1);break;case 44:o[u++]=(Cl(N)-1)*y,y=1;break;case 64:Wp()===45&&(N+=VE(Uo())),p=Wp(),c=d=Cl(_=N+=tIt(bk())),b++;break;case 45:m===45&&Cl(N)==2&&(g=0)}}return a}function pG(e,t,n,r,i,a,s,o,l,u,c,d){for(var p=i-1,h=i===0?a:[""],m=zde(h),g=0,v=0,y=0;g<r;++g)for(var b=0,_=vy(e,p+1,p=Lde(v=s[g])),k=e;b<m;++b)(k=Fde(v>0?h[b]+" "+_:Yt(_,/&\f/g,h[b])))&&(l[y++]=k);return PT(e,t,n,i===0?ET:o,l,u,c,d)}function rIt(e,t,n,r){return PT(e,t,n,Rde,L3(KCt()),vy(e,2,-2),0,r)}function hG(e,t,n,r,i){return PT(e,t,n,D3,vy(e,0,r),vy(e,r+1,-1),r,i)}function Wde(e,t,n){switch(GCt(e,t)){case 5103:return Nn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Nn+e+e;case 4789:return Eb+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Nn+e+Eb+e+dr+e+e;case 5936:switch(Si(e,t+11)){case 114:return Nn+e+dr+Yt(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Nn+e+dr+Yt(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Nn+e+dr+Yt(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return Nn+e+dr+e+e;case 6165:return Nn+e+dr+"flex-"+e+e;case 5187:return Nn+e+Yt(e,/(\w+).+(:[^]+)/,Nn+"box-$1$2"+dr+"flex-$1$2")+e;case 5443:return Nn+e+dr+"flex-item-"+Yt(e,/flex-|-self/g,"")+(pu(e,/flex-|baseline/)?"":dr+"grid-row-"+Yt(e,/flex-|-self/g,""))+e;case 4675:return Nn+e+dr+"flex-line-pack"+Yt(e,/align-content|flex-|-self/g,"")+e;case 5548:return Nn+e+dr+Yt(e,"shrink","negative")+e;case 5292:return Nn+e+dr+Yt(e,"basis","preferred-size")+e;case 6060:return Nn+"box-"+Yt(e,"-grow","")+Nn+e+dr+Yt(e,"grow","positive")+e;case 4554:return Nn+Yt(e,/([^-])(transform)/g,"$1"+Nn+"$2")+e;case 6187:return Yt(Yt(Yt(e,/(zoom-|grab)/,Nn+"$1"),/(image-set)/,Nn+"$1"),e,"")+e;case 5495:case 3959:return Yt(e,/(image-set\([^]*)/,Nn+"$1$`$1");case 4968:return Yt(Yt(e,/(.+:)(flex-)?(.*)/,Nn+"box-pack:$3"+dr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Nn+e+e;case 4200:if(!pu(e,/flex-|baseline/))return dr+"grid-column-align"+vy(e,t)+e;break;case 2592:case 3360:return dr+Yt(e,"template-","")+e;case 4384:case 3616:return n&&n.some(function(r,i){return t=i,pu(r.props,/grid-\w+-end/)})?~vk(e+(n=n[t].value),"span",0)?e:dr+Yt(e,"-start","")+e+dr+"grid-row-span:"+(~vk(n,"span",0)?pu(n,/\d+/):+pu(n,/\d+/)-+pu(e,/\d+/))+";":dr+Yt(e,"-start","")+e;case 4896:case 4128:return n&&n.some(function(r){return pu(r.props,/grid-\w+-start/)})?e:dr+Yt(Yt(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Yt(e,/(.+)-inline(.+)/,Nn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Cl(e)-1-t>6)switch(Si(e,t+1)){case 109:if(Si(e,t+4)!==45)break;case 102:return Yt(e,/(.+:)(.+)-([^]+)/,"$1"+Nn+"$2-$3$1"+Eb+(Si(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~vk(e,"stretch",0)?Wde(Yt(e,"stretch","fill-available"),t,n)+e:e}break;case 5152:case 5920:return Yt(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,i,a,s,o,l,u){return dr+i+":"+a+u+(s?dr+i+"-span:"+(o?l:+l-+a)+u:"")+e});case 4949:if(Si(e,t+6)===121)return Yt(e,":",":"+Nn)+e;break;case 6444:switch(Si(e,Si(e,14)===45?18:11)){case 120:return Yt(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Nn+(Si(e,14)===45?"inline-":"")+"box$3$1"+Nn+"$2$3$1"+dr+"$2box$3")+e;case 100:return Yt(e,":",":"+dr)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Yt(e,"scroll-","scroll-snap-")+e}return e}function GI(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function iIt(e,t,n,r){switch(e.type){case HCt:if(e.children.length)break;case UCt:case D3:return e.return=e.return||e.value;case Rde:return"";case Dde:return e.return=e.value+"{"+GI(e.children,r)+"}";case ET:if(!Cl(e.value=e.props.join(",")))return""}return Cl(n=GI(e.children,r))?e.return=e.value+"{"+n+"}":""}function aIt(e){var t=zde(e);return function(n,r,i,a){for(var s="",o=0;o<t;o++)s+=e[o](n,r,i,a)||"";return s}}function sIt(e){return function(t){t.root||(t=t.return)&&e(t)}}function oIt(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case D3:e.return=Wde(e.value,e.length,n);return;case Dde:return GI([yc(e,{value:Yt(e.value,"@","@"+Nn)})],r);case ET:if(e.length)return qCt(n=e.props,function(i){switch(pu(i,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Wm(yc(e,{props:[Yt(i,/:(read-\w+)/,":"+Eb+"$1")]})),Wm(yc(e,{props:[i]})),LA(e,{props:dG(n,r)});break;case"::placeholder":Wm(yc(e,{props:[Yt(i,/:(plac\w+)/,":"+Nn+"input-$1")]})),Wm(yc(e,{props:[Yt(i,/:(plac\w+)/,":"+Eb+"$1")]})),Wm(yc(e,{props:[Yt(i,/:(plac\w+)/,dr+"input-$1")]})),Wm(yc(e,{props:[i]})),LA(e,{props:dG(n,r)});break}return""})}}var wy=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",Vde="active",jde="data-styled-version",MT="6.1.11",F3=`/*!sc*/
`,z3=typeof window<"u"&&"HTMLElement"in window,lIt=Boolean(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""?{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY:!1),RT=Object.freeze([]),xy=Object.freeze({});function uIt(e,t,n){return n===void 0&&(n=xy),e.theme!==n.theme&&e.theme||t||n.theme}var Ude=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),cIt=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,dIt=/(^-|-$)/g;function fG(e){return e.replace(cIt,"-").replace(dIt,"")}var pIt=/(a)(d)/gi,O_=52,mG=function(e){return String.fromCharCode(e+(e>25?39:97))};function BA(e){var t,n="";for(t=Math.abs(e);t>O_;t=t/O_|0)n=mG(t%O_)+n;return(mG(t%O_)+n).replace(pIt,"$1-$2")}var jE,Hde=5381,cg=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},Gde=function(e){return cg(Hde,e)};function hIt(e){return BA(Gde(e)>>>0)}function fIt(e){return e.displayName||e.name||"Component"}function UE(e){return typeof e=="string"&&!0}var qde=typeof Symbol=="function"&&Symbol.for,Kde=qde?Symbol.for("react.memo"):60115,mIt=qde?Symbol.for("react.forward_ref"):60112,gIt={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},yIt={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Zde={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},vIt=((jE={})[mIt]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},jE[Kde]=Zde,jE);function gG(e){return("type"in(t=e)&&t.type.$$typeof)===Kde?Zde:"$$typeof"in e?vIt[e.$$typeof]:gIt;var t}var bIt=Object.defineProperty,wIt=Object.getOwnPropertyNames,yG=Object.getOwnPropertySymbols,xIt=Object.getOwnPropertyDescriptor,_It=Object.getPrototypeOf,vG=Object.prototype;function Xde(e,t,n){if(typeof t!="string"){if(vG){var r=_It(t);r&&r!==vG&&Xde(e,r,n)}var i=wIt(t);yG&&(i=i.concat(yG(t)));for(var a=gG(e),s=gG(t),o=0;o<i.length;++o){var l=i[o];if(!(l in yIt||n&&n[l]||s&&l in s||a&&l in a)){var u=xIt(t,l);try{bIt(e,l,u)}catch{}}}}return e}function _y(e){return typeof e=="function"}function B3(e){return typeof e=="object"&&"styledComponentId"in e}function $p(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function bG(e,t){if(e.length===0)return"";for(var n=e[0],r=1;r<e.length;r++)n+=t?t+e[r]:e[r];return n}function $1(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function WA(e,t,n){if(n===void 0&&(n=!1),!n&&!$1(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)e[r]=WA(e[r],t[r]);else if($1(t))for(var r in t)e[r]=WA(e[r],t[r]);return e}function W3(e,t){Object.defineProperty(e,"toString",{value:t})}function nx(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var kIt=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var n=0,r=0;r<t;r++)n+=this.groupSizes[r];return n},e.prototype.insertRules=function(t,n){if(t>=this.groupSizes.length){for(var r=this.groupSizes,i=r.length,a=i;t>=a;)if((a<<=1)<0)throw nx(16,"".concat(t));this.groupSizes=new Uint32Array(a),this.groupSizes.set(r),this.length=a;for(var s=i;s<a;s++)this.groupSizes[s]=0}for(var o=this.indexOfGroup(t+1),l=(s=0,n.length);s<l;s++)this.tag.insertRule(o,n[s])&&(this.groupSizes[t]++,o++)},e.prototype.clearGroup=function(t){if(t<this.length){var n=this.groupSizes[t],r=this.indexOfGroup(t),i=r+n;this.groupSizes[t]=0;for(var a=r;a<i;a++)this.tag.deleteRule(r)}},e.prototype.getGroup=function(t){var n="";if(t>=this.length||this.groupSizes[t]===0)return n;for(var r=this.groupSizes[t],i=this.indexOfGroup(t),a=i+r,s=i;s<a;s++)n+="".concat(this.tag.getRule(s)).concat(F3);return n},e}(),xk=new Map,qI=new Map,_k=1,P_=function(e){if(xk.has(e))return xk.get(e);for(;qI.has(_k);)_k++;var t=_k++;return xk.set(e,t),qI.set(t,e),t},SIt=function(e,t){_k=t+1,xk.set(e,t),qI.set(t,e)},CIt="style[".concat(wy,"][").concat(jde,'="').concat(MT,'"]'),IIt=new RegExp("^".concat(wy,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),$It=function(e,t,n){for(var r,i=n.split(","),a=0,s=i.length;a<s;a++)(r=i[a])&&e.registerName(t,r)},TIt=function(e,t){for(var n,r=((n=t.textContent)!==null&&n!==void 0?n:"").split(F3),i=[],a=0,s=r.length;a<s;a++){var o=r[a].trim();if(o){var l=o.match(IIt);if(l){var u=0|parseInt(l[1],10),c=l[2];u!==0&&(SIt(c,u),$It(e,c,l[3]),e.getTag().insertRules(u,i)),i.length=0}else i.push(o)}}};function NIt(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var Jde=function(e){var t=document.head,n=e||t,r=document.createElement("style"),i=function(o){var l=Array.from(o.querySelectorAll("style[".concat(wy,"]")));return l[l.length-1]}(n),a=i!==void 0?i.nextSibling:null;r.setAttribute(wy,Vde),r.setAttribute(jde,MT);var s=NIt();return s&&r.setAttribute("nonce",s),n.insertBefore(r,a),r},EIt=function(){function e(t){this.element=Jde(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var r=document.styleSheets,i=0,a=r.length;i<a;i++){var s=r[i];if(s.ownerNode===n)return s}throw nx(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,n){try{return this.sheet.insertRule(n,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var n=this.sheet.cssRules[t];return n&&n.cssText?n.cssText:""},e}(),OIt=function(){function e(t){this.element=Jde(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,n){if(t<=this.length&&t>=0){var r=document.createTextNode(n);return this.element.insertBefore(r,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),PIt=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,n){return t<=this.length&&(this.rules.splice(t,0,n),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),wG=z3,AIt={isServer:!z3,useCSSOMInjection:!lIt},Yde=function(){function e(t,n,r){t===void 0&&(t=xy),n===void 0&&(n={});var i=this;this.options=Pr(Pr({},AIt),t),this.gs=n,this.names=new Map(r),this.server=!!t.isServer,!this.server&&z3&&wG&&(wG=!1,function(a){for(var s=document.querySelectorAll(CIt),o=0,l=s.length;o<l;o++){var u=s[o];u&&u.getAttribute(wy)!==Vde&&(TIt(a,u),u.parentNode&&u.parentNode.removeChild(u))}}(this)),W3(this,function(){return function(a){for(var s=a.getTag(),o=s.length,l="",u=function(d){var p=function(y){return qI.get(y)}(d);if(p===void 0)return"continue";var h=a.names.get(p),m=s.getGroup(d);if(h===void 0||m.length===0)return"continue";var g="".concat(wy,".g").concat(d,'[id="').concat(p,'"]'),v="";h!==void 0&&h.forEach(function(y){y.length>0&&(v+="".concat(y,","))}),l+="".concat(m).concat(g,'{content:"').concat(v,'"}').concat(F3)},c=0;c<o;c++)u(c);return l}(i)})}return e.registerId=function(t){return P_(t)},e.prototype.reconstructWithOptions=function(t,n){return n===void 0&&(n=!0),new e(Pr(Pr({},this.options),t),this.gs,n&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(n){var r=n.useCSSOMInjection,i=n.target;return n.isServer?new PIt(i):r?new EIt(i):new OIt(i)}(this.options),new kIt(t)));var t},e.prototype.hasNameForId=function(t,n){return this.names.has(t)&&this.names.get(t).has(n)},e.prototype.registerName=function(t,n){if(P_(t),this.names.has(t))this.names.get(t).add(n);else{var r=new Set;r.add(n),this.names.set(t,r)}},e.prototype.insertRules=function(t,n,r){this.registerName(t,n),this.getTag().insertRules(P_(t),r)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(P_(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),MIt=/&/g,RIt=/^\s*\/\/.*$/gm;function Qde(e,t){return e.map(function(n){return n.type==="rule"&&(n.value="".concat(t," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(t," ")),n.props=n.props.map(function(r){return"".concat(t," ").concat(r)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=Qde(n.children,t)),n})}function DIt(e){var t,n,r,i=e===void 0?xy:e,a=i.options,s=a===void 0?xy:a,o=i.plugins,l=o===void 0?RT:o,u=function(p,h,m){return m.startsWith(n)&&m.endsWith(n)&&m.replaceAll(n,"").length>0?".".concat(t):p},c=l.slice();c.push(function(p){p.type===ET&&p.value.includes("&")&&(p.props[0]=p.props[0].replace(MIt,n).replace(r,u))}),s.prefix&&c.push(oIt),c.push(iIt);var d=function(p,h,m,g){h===void 0&&(h=""),m===void 0&&(m=""),g===void 0&&(g="&"),t=g,n=h,r=new RegExp("\\".concat(n,"\\b"),"g");var v=p.replace(RIt,""),y=nIt(m||h?"".concat(m," ").concat(h," { ").concat(v," }"):v);s.namespace&&(y=Qde(y,s.namespace));var b=[];return GI(y,aIt(c.concat(sIt(function(_){return b.push(_)})))),b};return d.hash=l.length?l.reduce(function(p,h){return h.name||nx(15),cg(p,h.name)},Hde).toString():"",d}var LIt=new Yde,VA=DIt(),epe=Ni.createContext({shouldForwardProp:void 0,styleSheet:LIt,stylis:VA});epe.Consumer;Ni.createContext(void 0);function xG(){return I.exports.useContext(epe)}var FIt=function(){function e(t,n){var r=this;this.inject=function(i,a){a===void 0&&(a=VA);var s=r.name+a.hash;i.hasNameForId(r.id,s)||i.insertRules(r.id,s,a(r.rules,s,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=n,W3(this,function(){throw nx(12,String(r.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=VA),this.name+t.hash},e}(),zIt=function(e){return e>="A"&&e<="Z"};function _G(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(n===1&&r==="-"&&e[0]==="-")return e;zIt(r)?t+="-"+r.toLowerCase():t+=r}return t.startsWith("ms-")?"-"+t:t}var tpe=function(e){return e==null||e===!1||e===""},npe=function(e){var t,n,r=[];for(var i in e){var a=e[i];e.hasOwnProperty(i)&&!tpe(a)&&(Array.isArray(a)&&a.isCss||_y(a)?r.push("".concat(_G(i),":"),a,";"):$1(a)?r.push.apply(r,Kb(Kb(["".concat(i," {")],npe(a),!1),["}"],!1)):r.push("".concat(_G(i),": ").concat((t=i,(n=a)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||t in bq||t.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return r};function Vp(e,t,n,r){if(tpe(e))return[];if(B3(e))return[".".concat(e.styledComponentId)];if(_y(e)){if(!_y(a=e)||a.prototype&&a.prototype.isReactComponent||!t)return[e];var i=e(t);return Vp(i,t,n,r)}var a;return e instanceof FIt?n?(e.inject(n,r),[e.getName(r)]):[e]:$1(e)?npe(e):Array.isArray(e)?Array.prototype.concat.apply(RT,e.map(function(s){return Vp(s,t,n,r)})):[e.toString()]}function BIt(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(_y(n)&&!B3(n))return!1}return!0}var WIt=Gde(MT),VIt=function(){function e(t,n,r){this.rules=t,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&BIt(t),this.componentId=n,this.baseHash=cg(WIt,n),this.baseStyle=r,Yde.registerId(n)}return e.prototype.generateAndInjectStyles=function(t,n,r){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,n,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))i=$p(i,this.staticRulesId);else{var a=bG(Vp(this.rules,t,n,r)),s=BA(cg(this.baseHash,a)>>>0);if(!n.hasNameForId(this.componentId,s)){var o=r(a,".".concat(s),void 0,this.componentId);n.insertRules(this.componentId,s,o)}i=$p(i,s),this.staticRulesId=s}else{for(var l=cg(this.baseHash,r.hash),u="",c=0;c<this.rules.length;c++){var d=this.rules[c];if(typeof d=="string")u+=d;else if(d){var p=bG(Vp(d,t,n,r));l=cg(l,p+c),u+=p}}if(u){var h=BA(l>>>0);n.hasNameForId(this.componentId,h)||n.insertRules(this.componentId,h,r(u,".".concat(h),void 0,this.componentId)),i=$p(i,h)}}return i},e}(),rpe=Ni.createContext(void 0);rpe.Consumer;var HE={};function jIt(e,t,n){var r=B3(e),i=e,a=!UE(e),s=t.attrs,o=s===void 0?RT:s,l=t.componentId,u=l===void 0?function(k,C){var $=typeof k!="string"?"sc":fG(k);HE[$]=(HE[$]||0)+1;var N="".concat($,"-").concat(hIt(MT+$+HE[$]));return C?"".concat(C,"-").concat(N):N}(t.displayName,t.parentComponentId):l,c=t.displayName,d=c===void 0?function(k){return UE(k)?"styled.".concat(k):"Styled(".concat(fIt(k),")")}(e):c,p=t.displayName&&t.componentId?"".concat(fG(t.displayName),"-").concat(t.componentId):t.componentId||u,h=r&&i.attrs?i.attrs.concat(o).filter(Boolean):o,m=t.shouldForwardProp;if(r&&i.shouldForwardProp){var g=i.shouldForwardProp;if(t.shouldForwardProp){var v=t.shouldForwardProp;m=function(k,C){return g(k,C)&&v(k,C)}}else m=g}var y=new VIt(n,p,r?i.componentStyle:void 0);function b(k,C){return function($,N,A){var D=$.attrs,O=$.componentStyle,F=$.defaultProps,E=$.foldedComponentIds,z=$.styledComponentId,q=$.target,H=Ni.useContext(rpe),J=xG(),ee=$.shouldForwardProp||J.shouldForwardProp,V=uIt(N,H,F)||xy,Q=function(ye,_e,Ee){for(var Se,Re=Pr(Pr({},_e),{className:void 0,theme:Ee}),Ze=0;Ze<ye.length;Ze+=1){var at=_y(Se=ye[Ze])?Se(Re):Se;for(var Je in at)Re[Je]=Je==="className"?$p(Re[Je],at[Je]):Je==="style"?Pr(Pr({},Re[Je]),at[Je]):at[Je]}return _e.className&&(Re.className=$p(Re.className,_e.className)),Re}(D,N,V),X=Q.as||q,Y={};for(var ce in Q)Q[ce]===void 0||ce[0]==="$"||ce==="as"||ce==="theme"&&Q.theme===V||(ce==="forwardedAs"?Y.as=Q.forwardedAs:ee&&!ee(ce,X)||(Y[ce]=Q[ce]));var pe=function(ye,_e){var Ee=xG(),Se=ye.generateAndInjectStyles(_e,Ee.styleSheet,Ee.stylis);return Se}(O,Q),fe=$p(E,z);return pe&&(fe+=" "+pe),Q.className&&(fe+=" "+Q.className),Y[UE(X)&&!Ude.has(X)?"class":"className"]=fe,Y.ref=A,I.exports.createElement(X,Y)}(_,k,C)}b.displayName=d;var _=Ni.forwardRef(b);return _.attrs=h,_.componentStyle=y,_.displayName=d,_.shouldForwardProp=m,_.foldedComponentIds=r?$p(i.foldedComponentIds,i.styledComponentId):"",_.styledComponentId=p,_.target=r?i.target:e,Object.defineProperty(_,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(k){this._foldedDefaultProps=r?function(C){for(var $=[],N=1;N<arguments.length;N++)$[N-1]=arguments[N];for(var A=0,D=$;A<D.length;A++)WA(C,D[A],!0);return C}({},i.defaultProps,k):k}}),W3(_,function(){return".".concat(_.styledComponentId)}),a&&Xde(_,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),_}function kG(e,t){for(var n=[e[0]],r=0,i=t.length;r<i;r+=1)n.push(t[r],e[r+1]);return n}var SG=function(e){return Object.assign(e,{isCss:!0})};function UIt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(_y(e)||$1(e))return SG(Vp(kG(RT,Kb([e],t,!0))));var r=e;return t.length===0&&r.length===1&&typeof r[0]=="string"?Vp(r):SG(Vp(kG(r,t)))}function jA(e,t,n){if(n===void 0&&(n=xy),!t)throw nx(1,t);var r=function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return e(t,n,UIt.apply(void 0,Kb([i],a,!1)))};return r.attrs=function(i){return jA(e,t,Pr(Pr({},n),{attrs:Array.prototype.concat(n.attrs,i).filter(Boolean)}))},r.withConfig=function(i){return jA(e,t,Pr(Pr({},n),i))},r}var ipe=function(e){return jA(jIt,e)},ape=ipe;Ude.forEach(function(e){ape[e]=ipe(e)});const CG=e=>{const[t,n]=e;return[n,t]},HIt=117.3,GIt=172.8,qIt=.02072,KIt=.0205,ZIt=-5661,XIt=6692,JIt=-4060,YIt=8430,QIt=E_.extend({},E_.CRS.Simple,{projection:E_.Projection.LonLat,scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/.6931471805599453},distance:function(e,t){var n=t.lng-e.lng,r=t.lat-e.lat;return Math.sqrt(n*n+r*r)},transformation:new E_.Transformation(qIt,HIt,-KIt,GIt),infinite:!0}),IG=[[JIt,ZIt],[YIt,XIt]],e2t=ape(FCt)`
  .leaflet-control-attribution {
    display: none !important;
  }
`,t2t=new wd.exports.Icon({iconUrl:"https://cdn.iconscout.com/icon/free/png-256/free-pin-locate-marker-location-navigation-16-28668.png",iconSize:[24,24],iconAnchor:[13,15],popupAnchor:[0,-25]});function spe(){const[e,t]=I.exports.useState([]),[n,r]=I.exports.useState(!1),[i,a]=I.exports.useState(""),[s,o]=I.exports.useState(null),{units:l}=Mde(),{calls:u}=FR(),c=()=>{s&&i.trim()!==""&&(console.log(s),t([...e,{position:s,name:i}]),a(""),r(!1))};return I.exports.useEffect(()=>{if(!l)return;const d=e.filter(h=>!h.isOfficer),p=l&&l.length>0&&l.map(h=>({position:CG(h.coords),name:h.callsign&&h.callsign!=="N/A"?`${h.name} - ${h.callsign}`:h.name,isOfficer:!0}))||[];t([...d,...p])},[l]),I.exports.useEffect(()=>{if(!u)return;const d=e.filter(h=>!h.isCall),p=u&&u.length>0&&u.map(h=>({position:CG(h.coords),name:h.title,isCall:!0}))||[];t([...d,...p])},[u]),B(ze,{children:[B(me,{w:"100%",style:{alignItems:"start"},children:[B(e2t,{crs:QIt,center:[0,0],minZoom:2,zoom:3,maxZoom:5,maxBounds:IG,maxBoundsViscosity:1,style:{height:"80vh",width:"35vw"},children:[x(WCt,{url:"tiles/{z}/{x}/{y}.png",bounds:IG,noWrap:!0}),e.map((d,p)=>x(zCt,{position:d.position,icon:t2t,children:x(BCt,{children:d.name})},p))]}),B(me,{w:"53%",h:"80vh",spacing:15,style:{alignItems:"start"},children:[x(VCt,{}),x(jCt,{})]})]}),x(sr,{opened:n,onClose:()=>r(!1),title:K.add_marker,centered:!0,children:B(Ce,{spacing:20,children:[x(Xe,{label:K.marker_name,placeholder:K.marker_name,value:i,onChange:d=>a(d.currentTarget.value)}),x(me,{position:"right",children:x(Ct,{onClick:c,children:K.add})})]})})]})}function ope({reportId:e}){const{trainingReports:t,updateTrainingReport:n}=W1(),{updateTab:r}=gn(),[i,a]=I.exports.useState(t.find(y=>y.id===e)),{dateFormat:s}=tn(),[o,l]=I.exports.useState(i==null?void 0:i.title),[u]=Kt(o,500),c=I.exports.useRef(0),[d]=Kt(c.current,2500);I.exports.useEffect(()=>{const y=t.find(b=>b.id===e);y&&a(y)},[t,e]);const p=om({extensions:[um,cm,pm,hm,lm,i0,r0,dm.configure({types:["heading","paragraph"]}),N3,fm,mm.configure({limit:1e5})],content:i==null?void 0:i.content}),h=I.exports.useRef(!1);I.exports.useEffect(()=>{!p||!(i!=null&&i.content)||h.current||(h.current=!0,p.commands.setContent(i.content),i!=null&&i.title&&l(i.title))},[p,i]),I.exports.useEffect(()=>{!i||n(i.id,{...i,title:u})},[u]),I.exports.useEffect(()=>{!i||n(i.id,{...i,content:p==null?void 0:p.getHTML()})},[d]),I.exports.useEffect(()=>{if(p){const y=()=>{c.current++};return p.on("update",y),()=>{p.off("update",y)}}},[p]),I.exports.useEffect(()=>{p&&p.setOptions({editorProps:{handlePaste:(y,b,_)=>{const k=b.clipboardData,C=k==null?void 0:k.getData("text/plain");return/https?:\/\/\S+\.(jpg|jpeg|png|gif)/i.test(C||"")&&C?(b.preventDefault(),p.commands.setImage({src:C}),!0):!1}}})},[p]);const m=I.exports.useCallback(()=>{r({title:"trainingReports",component:x(UA,{})})},[i,r]),g=I.exports.useCallback(()=>{const y={...i,title:o,content:p==null?void 0:p.getHTML()};Ne("saveTrainingReport",y)},[i,o,p]),v=I.exports.useCallback(()=>{In.openConfirmModal({title:K.are_you_sure_remove,labels:{confirm:K.confirm,cancel:K.cancel},centered:!0,onConfirm:()=>{Ne("removeTrainingReport",i==null?void 0:i.id),r({title:"trainingReports",component:x(UA,{})})}})},[i,r]);return x(ze,{children:i&&B(me,{spacing:20,h:"100%",style:{alignItems:"start"},children:[B(Ce,{w:"60%",h:"100%",spacing:10,children:[x(Bt,{w:"100%",h:80,color:"dark.6",radius:"xs",px:10,shadow:"xs",children:B(Ce,{h:"100%",justify:"center",spacing:5,children:[B(me,{position:"apart",children:[x(Xe,{variant:"filled",value:o,onChange:y=>l(y.currentTarget.value),sx:{input:{fontSize:18,fontWeight:630}},w:"60%"}),B(me,{spacing:10,children:[B(bt,{radius:"sm",children:["ID: ",i.id]}),x(Fe,{variant:"subtle",color:"blue",onClick:m,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:g,children:x(Us,{})}),x(Fe,{variant:"subtle",color:"red",onClick:v,children:x(go,{})})]})]}),B(Te,{fw:550,size:12,color:"gray.6",children:[i.creator," - ",new Date(i.date*1e3).toLocaleString([],s||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})," - ",K.trainee.format(i.trainee)]})]})}),x(Bt,{w:"100%",h:"72%",color:"dark.7",radius:"xs",p:20,shadow:"xs",children:x(gm,{editor:p})})]}),x(ol,{page:"trainingReport",sidebar:i.sideBarData,pageId:i.id,updateData:n})]})})}function n2t({searchQuery:e}){const{updateTab:t}=gn(),{trainingReports:n,updateTrainingReport:r}=W1(),{dateFormat:i}=tn(),a=I.exports.useMemo(()=>n.filter(o=>{var l,u,c;return((l=o.creator)==null?void 0:l.toLowerCase().includes(e.toLowerCase()))||((u=o.officer)==null?void 0:u.toLowerCase().includes(e.toLowerCase()))||((c=o.id)==null?void 0:c.toString())===e}).sort((o,l)=>l.id-o.id),[e,n]),s=({index:o,style:l})=>{const u=a[o];return x("div",{style:{...l},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getTrainingReport",u.id).then(c=>{!c||!u.id||r(u.id,c)}),t({title:"trainingReports",component:x(ope,{reportId:u.id})})},p:10,children:x(me,{spacing:15,children:B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:u.title}),B(bt,{radius:"sm",children:["ID: ",u.id]})]}),B(Te,{fw:500,size:12,color:"gray.5",children:[u.creator," - ",new Date(u.date*1e3).toLocaleString([],i||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})," - ",K.trainee.format(u.trainee)]})]})})})})};return x(ta,{height:window.innerHeight*.77,itemCount:a.length,itemSize:110,width:"100%",children:s})}function UA(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200),[r,{open:i,close:a}]=$r(!1),[s,o]=I.exports.useState(),{employees:l,minTrainingReportGrade:u,maxTraineeGrade:c}=Jo(),{playerGrade:d,isBoss:p}=tn(),{updateTab:h}=gn(),m=()=>{i()};return I.exports.useEffect(()=>{!s||s===""||Ne("createTrainingReport",s).then(g=>{!g||h({title:"trainingReports",component:x(ope,{reportId:g.id})})})},[s]),B(ze,{children:[x(xa,{title:K.trainingReports,searchQuery:e,setSearchQuery:t,createNew:d>=u?m:void 0}),p&&x(n2t,{searchQuery:n}),x(sr,{opened:r,onClose:a,title:K.new_training_report,centered:!0,children:x(qg,{allPlayers:l.filter(g=>g.gradeNumber<=c),setTrainee:o})})]})}function r2t({businessName:e}){const{businesses:t,updateBusiness:n}=MR(),{updateTab:r}=gn(),[i,a]=I.exports.useState(t.find(y=>y.name===e)),[s,{open:o,close:l}]=$r(!1),[u,c]=I.exports.useState(i==null?void 0:i.image),[d,p]=I.exports.useState(i==null?void 0:i.notes),[h]=Kt(d,1e3);I.exports.useEffect(()=>{a(t.find(y=>y.name===e))},[t]),I.exports.useEffect(()=>{c(i==null?void 0:i.image)},[i]),I.exports.useEffect(()=>{i&&h&&n(i.name,{notes:h})},[h]);const m=I.exports.useCallback(()=>{r({title:"businesses",component:x(lpe,{})})},[i,r]),g=I.exports.useCallback(()=>{const y={...i,notes:d};Ne("saveBusiness",y)},[i,d]),v=()=>{l(),Ne("hideUI"),Ne("takePhoto","business")};return kt("photoTaken",y=>{y.page==="business"&&(o(),c(y.url))}),B(ze,{children:[i&&x(ze,{children:B(me,{spacing:20,children:[x(Bt,{w:"60%",h:"81vh",color:"dark.6",radius:"xs",p:20,shadow:"xs",children:B(Ce,{w:"100%",spacing:25,children:[B(me,{w:"100%",position:"apart",children:[B(me,{w:"90%",children:[x(er,{size:160,src:i.image,onClick:o,style:{cursor:"pointer"}}),x(An,{w:"75%",h:160,scrollHideDelay:0,scrollbarSize:5,children:x(me,{w:"100%",spacing:10,children:x(Xe,{label:K.business_name,readOnly:!0,variant:"filled",value:i.label,size:"xs"})})})]}),x(Ce,{h:160,justify:"flex-start",children:B(me,{spacing:10,children:[x(Fe,{variant:"subtle",color:"blue",onClick:m,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:g,children:x(Us,{})})]})})]}),x(bs,{w:"100%",label:K.notes,minRows:28,maxLength:5e4,value:d,onChange:y=>p(y.currentTarget.value)})]})}),x(ol,{page:"business",sidebar:i.sideBarData,pageId:i.name,updateData:n})]})}),x(sr,{size:"40%",centered:!0,title:i==null?void 0:i.label,opened:s,onClose:l,withinPortal:!0,children:B(Ce,{spacing:20,children:[x(il,{radius:"md",src:i==null?void 0:i.image}),x(Xe,{label:K.image_url,placeholder:K.url,variant:"filled",value:u,onChange:y=>c(y.currentTarget.value),rightSection:x(Fe,{onClick:v,children:x(Kl,{})})}),x(me,{position:"right",children:x(Ct,{onClick:()=>{!i||(l(),n(i.name,{image:u}))},children:K.confirm})})]})})]})}function i2t({searchQuery:e}){const{businesses:t,updateBusiness:n}=MR(),{updateTab:r}=gn(),i=I.exports.useMemo(()=>t.filter(s=>{var o;return s.label.toLowerCase().includes(e.toLowerCase())||((o=s.address)==null?void 0:o.toLowerCase().includes(e.toLowerCase()))}).sort((s,o)=>s.label.localeCompare(o.label)),[e,t]),a=({index:s,style:o})=>{const l=i[s];return x("div",{style:{...o},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getBusiness",l.name).then(u=>{!u||!l.name||n(l.name,u)}),r({title:"businesses",component:x(r2t,{businessName:l.name})})},p:10,children:B(me,{spacing:15,children:[x(er,{size:80,src:l.image}),x(Ce,{spacing:1,children:x(Te,{fw:600,size:16,children:l.label})})]})})})};return x(ta,{height:window.innerHeight*.77,itemCount:i.length,itemSize:110,width:"100%",children:a})}function lpe(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200);return B(ze,{children:[x(xa,{title:K.businesses,searchQuery:e,setSearchQuery:t}),x(i2t,{searchQuery:n})]})}function a2t({identifier:e,currentCallsign:t}){const[n,r]=I.exports.useState(t);return B(Ce,{spacing:20,children:[x(Xe,{label:K.callsign,placeholder:K.callsign,value:n,onChange:i=>r(i.currentTarget.value)}),x(me,{position:"right",children:x(Ct,{onClick:()=>{In.closeAll(),Ne("updateEmployeeCallsign",{identifier:e,callsign:n,page:"police"})},children:K.confirm})})]})}function s2t({identifier:e,currentNotes:t}){const[n,r]=I.exports.useState(t);return B(Ce,{spacing:20,children:[x(bs,{label:K.notes,placeholder:K.notes,rows:4,value:n,onChange:i=>r(i.currentTarget.value)}),x(me,{position:"right",children:x(Ct,{onClick:()=>{In.closeAll(),Ne("updateEmployeeNotes",{identifier:e,notes:n,page:"police"})},children:K.confirm})})]})}function o2t({identifier:e,currentImage:t}){const[n,r]=I.exports.useState(t),i=()=>{In.closeAll(),Ne("hideUI"),Ne("takePhoto","employee")};return B(Ce,{spacing:20,children:[x(Xe,{label:K.image_url,placeholder:K.url,value:n,onChange:a=>r(a.currentTarget.value),rightSection:x(Fe,{onClick:i,children:x(Kl,{})})}),x(me,{position:"right",children:x(Ct,{onClick:()=>{In.closeAll(),Ne("updateEmployeeImage",{identifier:e,image:n,page:"police"})},children:K.confirm})})]})}function l2t({searchQuery:e,setSearchQuery:t}){return x(Bt,{w:"100%",color:"dark.6",radius:"xs",py:5,px:10,shadow:"xs",mb:10,children:B(me,{position:"apart",h:"100%",children:[x(Te,{fw:650,size:24,children:K.employees}),x(Xe,{placeholder:K.search,rightSection:x(B2,{}),w:400,value:e,onChange:n=>t(n.currentTarget.value)})]})})}function upe(){const{identifier:e,isBoss:t,lastEmployeeIdentifier:n,setLastEmployeeIdentifier:r}=tn(),{employees:i,licenses:a}=Jo(),[s,o]=I.exports.useState(""),[l]=Kt(s,200),[u,c]=I.exports.useState({key:"name",direction:"ascending"}),{status:d}=Jo(),p=(C,$,N)=>{Ne("updateEmployeeLicenses",{identifier:C,license:$,newValue:N,page:"police"})},h=C=>{let $="ascending";u.key===C&&u.direction==="ascending"&&($="descending"),c({key:C,direction:$})},g=[...i].sort((C,$)=>u.direction==="ascending"?C[u.key]>$[u.key]?1:-1:u.direction==="descending"?C[u.key]<$[u.key]?1:-1:0).filter(C=>C.name.toLowerCase().includes(l.toLowerCase())),v=(C,$)=>x("th",{onClick:()=>h($),style:{cursor:"pointer",width:"150px"},children:B(me,{spacing:5,children:[C,u.key===$&&(u.direction==="ascending"?x(rMe,{}):x(nMe,{}))]})}),y=(C,$)=>{Ne("updateEmployeeStatus",{identifier:C,status:$})},b=(C,$)=>{In.open({centered:!0,title:K.edit_callsign,children:x(a2t,{identifier:C,currentCallsign:$})})},_=(C,$)=>{In.open({centered:!0,title:K.edit_notes,children:x(s2t,{identifier:C,currentNotes:$})})},k=(C,$)=>{r(C),In.open({centered:!0,title:K.edit_image,children:x(o2t,{identifier:C,currentImage:$})})};return kt("photoTaken",C=>{!n||C.page==="employee"&&k(n,C.url)}),B(ze,{children:[x(l2t,{searchQuery:s,setSearchQuery:o}),x(An,{px:10,children:B(IY,{children:[x("thead",{children:B("tr",{children:[x("th",{children:K.image}),v(K.player_name,"name"),v(K.callsign,"callsign"),v(K.phone,"phoneNumber"),v(K.grade,"grade"),v(K.grade_number,"gradeNumber"),v(K.status,"status"),a&&a.map((C,$)=>x("th",{children:C},$)),x("th",{children:K.notes})]})}),x("tbody",{children:g.map(C=>{const $=t||C.identifier===e;return B("tr",{children:[x("td",{width:70,children:x(rs,{p:5,label:x("img",{src:C.image,width:150}),position:"top",color:"dark.6",hidden:!Kg(C.image),withArrow:!0,withinPortal:!0,children:x(er,{src:C.image,onClick:()=>{$&&k(C.identifier,C.image)},sx:{cursor:$?"pointer":"default"}})})}),x("td",{width:200,children:C.name}),x("td",{width:80,children:x(Te,{style:{cursor:$?"pointer":"default"},onClick:()=>{$&&b(C.identifier,C.callsign)},children:C.callsign||"-"})}),x("td",{width:80,children:C.phoneNumber}),x("td",{width:100,children:C.grade}),x("td",{width:250,children:C.gradeNumber}),x("td",{width:200,children:x(ER,{variant:"filled",value:C.status,data:d,onChange:N=>y(C.identifier,N||""),withinPortal:!0,disabled:!$})}),a&&a.map((N,A)=>x("td",{width:120,children:x(Hg,{checked:(C==null?void 0:C.licenses)&&C.licenses[N],onChange:()=>p(C.identifier,N,!((C==null?void 0:C.licenses)&&C.licenses[N])),disabled:!$})},A)),x("td",{width:400,children:x(Te,{style:{cursor:$?"pointer":"default"},onClick:()=>{$&&_(C.identifier,C.notes)},children:C.notes||"-"})})]},C.identifier)})})]})})]})}const cpe=Tr(e=>({laws:[],addLaw:t=>e(n=>({laws:[...n.laws,t]})),updateLaw:(t,n)=>e(r=>({laws:r.laws.map(a=>{if(a.id===t){let s=!1,o={...a};if(n.sideBarData){const l={...a.sideBarData,...n.sideBarData};JSON.stringify(l)!==JSON.stringify(a.sideBarData)&&(o.sideBarData=l,s=!0)}for(const l in n)l!=="sideBarData"&&a[l]!==n[l]&&(o[l]=n[l],s=!0);return s?o:a}return a})})),setLaws:t=>e({laws:t}),removeLaw:t=>e(n=>({laws:n.laws.filter(r=>r.id!==t)}))}));function u2t({isCitizen:e,opened:t,law:n,close:r}){if(!n)return null;const[i,a]=I.exports.useState(n.name),{isBoss:s}=tn(),o=!e&&s,l=om({extensions:[um,cm,pm,hm,lm,dm.configure({types:["heading","paragraph"]}),fm,mm.configure({limit:1e5})],editable:o});I.exports.useEffect(()=>{Ne("getLaw",n.id).then(d=>{l==null||l.commands.setContent(d.description)})},[l]);const u=()=>{!i||!(l!=null&&l.getHTML())||(Ne("updateLaw",{id:n.id,name:i,description:l==null?void 0:l.getHTML()}),r())},c=()=>{r(),Ne("removeLaw",n.id)};return x(sr,{size:"51%",centered:!0,title:K.law.format(n.id),opened:t,onClose:r,children:B(Ce,{spacing:10,children:[x(Xe,{label:K.law_name,placeholder:K.law_name,value:i,onChange:d=>a(d.currentTarget.value),readOnly:!o,rightSection:o&&x(Fe,{onClick:c,children:x(go,{})})}),B(Ce,{spacing:2,children:[x(Te,{fw:650,size:14,children:K.description}),o&&x(gm,{editor:l})||x(Bt,{fz:"sm",h:"64vh",bg:"dark.6",radius:"xs",withBorder:!0,style:{whiteSpace:"pre-wrap",overflow:"auto",userSelect:"text",wordWrap:"break-word"},children:x(ot,{editor:l,sx:{border:0},w:"44vw",children:x(ot.Content,{bg:"none",style:{height:"64vh",overflow:"auto"}})})})]}),o&&x(me,{position:"right",children:x(Ct,{onClick:u,children:K.save})})]})})}function c2t({isCitizen:e,searchQuery:t}){const{laws:n}=cpe(),[r,{open:i,close:a}]=$r(!1),[s,o]=I.exports.useState(null),{dateFormat:l}=tn(),u=I.exports.useMemo(()=>n.filter(d=>d.name.toLowerCase().includes(t.toLowerCase())||d.id.toString()===t).sort((d,p)=>p.id-d.id),[n,t]),c=({index:d,style:p})=>{const h=u[d];return x("div",{style:{...p},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{o(h),i()},p:10,children:x(me,{spacing:15,children:B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:h.name}),B(bt,{radius:"sm",children:["ID: ",h.id]})]}),x(Te,{fw:500,size:12,color:"gray.5",children:new Date(h.date*1e3).toLocaleString([],l||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]})})})})};return B(ze,{children:[x(ta,{height:window.innerHeight*.77,itemCount:u.length,itemSize:110,width:"100%",children:c}),x(u2t,{isCitizen:e,opened:r,law:s,close:a})]})}function d2t({opened:e,close:t}){const[n,r]=I.exports.useState(),i=()=>{!n||!(a!=null&&a.getHTML())||(Ne("createLaw",{name:n,description:a==null?void 0:a.getHTML()}),t())},a=om({extensions:[um,cm,pm,hm,lm,i0,r0,dm.configure({types:["heading","paragraph"]}),fm,mm.configure({limit:1e5})],content:""});return I.exports.useEffect(()=>{r(void 0),a==null||a.commands.setContent("")},[e]),I.exports.useEffect(()=>{a&&a.setOptions({editorProps:{handlePaste:(s,o,l)=>{const u=o.clipboardData,c=u==null?void 0:u.getData("text/plain");return/https?:\/\/\S+\.(jpg|jpeg|png|gif)/i.test(c||"")&&c?(o.preventDefault(),a.commands.setImage({src:c}),!0):!1}}})},[a]),x(sr,{size:"51%",centered:!0,title:K.create_law,opened:e,onClose:t,children:B(Ce,{spacing:10,children:[x(Xe,{label:K.law_name,placeholder:K.law_name,value:n,onChange:s=>r(s.currentTarget.value)}),B(Ce,{spacing:2,children:[x(Te,{fw:650,size:14,children:K.description}),x(gm,{editor:a})]}),x(me,{position:"right",children:x(Ct,{onClick:i,children:K.confirm})})]})})}function dpe({isCitizen:e}){const[t,n]=I.exports.useState(""),[r]=Kt(t,200),[i,{open:a,close:s}]=$r(!1),o=()=>{a()};return B(ze,{children:[x(xa,{title:K.legislation,searchQuery:t,setSearchQuery:n,createNew:e?void 0:o}),x(c2t,{isCitizen:e,searchQuery:r}),x(d2t,{opened:i,close:s})]})}function p2t(){const{tabs:e,activeTab:t,initialTab:n,updateTab:r,setTabs:i,setInitialTab:a,setActiveTab:s}=gn(),{policePages:o}=tn(),l=[{name:"home",icon:x(aP,{}),component:x(SCt,{})},{name:"profiles",icon:x(zR,{}),component:x(Cue,{})},{name:"vehicles",icon:x(QY,{}),component:x(fQ,{})},{name:"properties",icon:x(aP,{}),component:x(Iue,{})},{name:"businesses",icon:x(eMe,{}),component:x(lpe,{})},{name:"incidents",icon:x(qAe,{}),component:x(oP,{})},{name:"reports",icon:x(iQ,{}),component:x(mA,{})},{name:"trainingReports",icon:x(sQ,{}),component:x(UA,{})},{name:"policeReports",icon:x(IMe,{}),component:x(RA,{})},{name:"evidence",icon:x(LMe,{}),component:x(fA,{})},{name:"weapons",icon:x($Me,{}),component:x(DA,{})},{name:"map",icon:x(rQ,{}),component:x(spe,{})},{name:"charges",icon:x(zC,{}),component:x(WR,{})},{name:"legislation",icon:x(nQ,{}),component:x(dpe,{})},{name:"employees",icon:x(oQ,{}),component:x(upe,{})}];I.exports.useEffect(()=>{var h;if(n)return;const c=(h=l.find(m=>m.name===o[0]))==null?void 0:h.component,d=Mu(),p={id:d,title:o[0],component:c};a(p),i([p]),s(d)},[o]);const u=c=>{r({title:c.name,component:c.component})};return B(ze,{children:[x(An,{w:220,h:"84vh",bg:"dark.7",px:10,py:10,scrollHideDelay:0,scrollbarSize:5,children:x(Ce,{h:"100%",spacing:5,align:"flex-start",children:l.map((c,d)=>{var m;if(!o.includes(c.name))return;const h=((m=e.find(g=>g.id===t))==null?void 0:m.title)===c.name;return x(Ct,{leftIcon:c.icon,color:"gray",variant:h?"light":"subtle",w:"100%",h:40,px:10,styles:{inner:{justifyContent:"start"}},onClick:()=>u(c),children:K[c.name]},d)})})}),x(Ds,{orientation:"vertical",color:"dark.6"})]})}function h2t(){const{tabs:e,activeTab:t,setActiveTab:n,removeTab:r,addTab:i}=gn(),{employees:a}=Jo(),{identifier:s,dateFormat:o}=tn(),[l,u]=I.exports.useState(K.officer),[c,d]=I.exports.useState();I.exports.useEffect(()=>{const y=a.find(b=>b.identifier===s);u((y==null?void 0:y.name)||K.officer),d(y==null?void 0:y.image)},[]),I.exports.useEffect(()=>{const y=a.find(b=>b.identifier===s);d(y==null?void 0:y.image)},[a]);var[p,h]=I.exports.useState(new Date);I.exports.useEffect(()=>{const y=setInterval(()=>{h(new Date)},6e4);return()=>clearInterval(y)},[]);const m=I.exports.useRef(null),g=I.exports.useRef({}),v=y=>{m.current&&(m.current.scrollLeft-=.2*y.deltaY)};return B(ze,{children:[x(wt,{h:70,bg:"dark.7",px:20,children:B(me,{h:"100%",position:"apart",children:[B(me,{spacing:105,w:"70%",children:[x(D2,{order:1,w:"8%",children:K.police}),x(gi,{value:t,onTabChange:n,mt:28,defaultValue:"gallery",children:B(me,{w:"100%",spacing:10,children:[x(An,{maw:900,type:"never",onWheel:v,viewportRef:m,children:x(gi.List,{sx:{flexFlow:"row",borderBottom:"0px"},children:e.map(y=>x(gi.Tab,{py:10,value:y.id,ref:b=>g.current[y.id]=b,mb:0,rightSection:x(Fe,{color:"blue",className:"remove-icon",variant:"subtle",size:20,onClick:b=>{b.stopPropagation(),r(y.id)},children:x(ui,{size:14})}),children:K[y.title]},y.id))})}),x(Fe,{ml:10,onClick:()=>{i(),setTimeout(()=>{const y=e[e.length-1].id;g.current[y]&&g.current[y].scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},0)},children:x(Oy,{})})]})})]}),B(me,{spacing:10,children:[B(Ce,{align:"flex-end",spacing:0,children:[x(Te,{fw:650,size:20,children:l}),x(Te,{fw:600,size:13,color:"gray.5",children:p.toLocaleString([],o||o||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]}),x(er,{size:40,src:c})]})]})}),x(Ds,{color:"dark.6"})]})}function f2t(){const{tabs:e,activeTab:t,setActiveTab:n}=gn();return x(gi,{value:t,onTabChange:n,children:e.map(r=>x(gi.Panel,{value:r.id,children:r.component},r.id))})}const wo=AR((e,t)=>({tabs:[],initialTab:null,activeTab:null,setInitialTab:n=>e({initialTab:n}),setTabs:n=>e({tabs:n}),addTab:n=>{if(!t().initialTab&&!n)return;const i=Mu();e(a=>{var s;return{tabs:[...a.tabs,{id:i,title:(n==null?void 0:n.title)||((s=a.initialTab)==null?void 0:s.title)||"",component:(n==null?void 0:n.component)||a.initialTab&&a.initialTab.component}],activeTab:i}})},removeTab:n=>{const r=t();if(!!r.initialTab){if(r.tabs.length===1){r.updateTab({title:r.initialTab.title,component:r.initialTab.component});return}e(i=>{const a=i.tabs.filter(o=>o.id!==n),s=i.activeTab===n&&a.length>0?a[0].id:i.activeTab;return{tabs:a,activeTab:s}})}},setActiveTab:n=>e({activeTab:n}),updateTab:n=>{const r=Mu();e(i=>({tabs:i.tabs.map(a=>a.id===i.activeTab?{...n,id:r}:a),activeTab:r}))}}));function m2t(){const{messages:e}=DR(),[t,n]=I.exports.useState(""),r=I.exports.useRef(null),{employees:i}=Jo(),a=()=>{t.trim()!==""&&(Ne("addChatMessage",t),n(""))};return I.exports.useEffect(()=>{r.current&&r.current.scrollTo({top:r.current.scrollHeight,behavior:"smooth"})},[e]),x(Bt,{w:710,h:"100%",shadow:"sm",p:"sm",children:B(Ce,{p:20,pt:0,h:"100%",children:[x(Te,{fw:700,size:20,align:"center",children:K.chat}),x(Bt,{h:"72vh",p:20,bg:"dark.8",withBorder:!0,children:B(Ce,{h:"100%",justify:"flex-end",spacing:10,children:[x(An,{h:"100%",scrollbarSize:0,viewportRef:r,children:x(Ce,{justify:"flex-end",spacing:15,h:"100%",children:!e||e.length===0&&x(Te,{fw:450,size:14,align:"center",color:"gray.6",mt:"30vh",children:K.no_messages_yet})||x(ze,{children:e.map((s,o)=>{const l=i.find(u=>u.identifier===s.from);return B(Ce,{w:"100%",spacing:1,children:[B(me,{spacing:8,sx:{alignItems:"end"},children:[x(er,{src:l==null?void 0:l.image,size:28,radius:"md"}),x(Te,{fw:650,size:15,children:l==null?void 0:l.name}),x(Te,{fw:400,size:10,color:"gray.6",children:new Date(s.timestamp*1e3).toLocaleString([],{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})})]}),x(Te,{size:13,style:{wordBreak:"break-all"},children:s.message})]},o)})})})}),x(me,{align:"center",w:"100%",children:x(Xe,{w:"100%",placeholder:K.write,value:t,onChange:s=>n(s.target.value),onKeyDown:s=>{s.key==="Enter"&&a()},rightSection:x(Fe,{variant:"subtle",color:"blue",onClick:a,children:x(W2,{size:20})})})})]})})]})})}function g2t(){const{announcements:e}=LR(),{isBoss:t,dateFormat:n}=tn(),[r,i]=I.exports.useState(""),a=I.exports.useRef(null),s=()=>{if(r.trim()!==""){const c=r.replace(/\n/g,"<br>");Ne("createAnnouncement",c),i("")}},o=I.exports.useCallback(c=>{const d=e.find(p=>p.id===c);d&&Ne("toggleAnnouncementPin",{id:c,pinned:!d.pinned,page:"ambulance"})},[e]),l=I.exports.useCallback(c=>{Ne("removeAnnouncement",{id:c,page:"ambulance"})},[]),u=[...e].sort((c,d)=>c.pinned&&!d.pinned?-1:!c.pinned&&d.pinned?1:new Date(d.date).getTime()-new Date(c.date).getTime());return x(Bt,{w:710,h:"100%",shadow:"sm",p:"sm",children:B(Ce,{p:20,pt:0,h:"100%",children:[x(Te,{fw:700,size:20,align:"center",children:K.announcements}),x(Bt,{h:"72vh",p:20,bg:"dark.8",withBorder:!0,children:B(Ce,{h:"100%",justify:"flex-end",spacing:10,children:[x(An,{h:"100%",scrollbarSize:0,viewportRef:a,children:x(Ce,{justify:"flex-end",spacing:15,h:"100%",children:!u||u.length===0?x(Te,{fw:450,size:14,align:"center",color:"gray.6",mt:"30vh",children:K.no_announcements_yet}):x(ze,{children:u.map((c,d)=>B(Ce,{w:"100%",spacing:1,children:[B(me,{spacing:8,sx:{alignItems:"end"},children:[t&&B(ze,{children:[x(Fe,{variant:"light",color:"red",onClick:()=>l(c.id),children:x(go,{size:20})}),x(Fe,{variant:c.pinned?"filled":"light",color:"blue",onClick:()=>o(c.id),children:x(aQ,{size:20})})]}),x(er,{size:28,radius:"md"}),x(Te,{fw:650,size:15,children:c.creator}),x(Te,{fw:400,size:10,color:"gray.6",children:new Date(c.date*1e3).toLocaleString([],n||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]}),x(Te,{size:13,style:{wordBreak:"break-all"},dangerouslySetInnerHTML:{__html:c.message.replace(/\n/g,"<br>")}}),x(Ds,{mt:15,w:"80%",ml:"10%",color:"dark.5"})]},d))})})}),x(me,{align:"center",w:"100%",children:x(bs,{w:"100%",placeholder:K.write,rightSection:x(Fe,{variant:"subtle",color:"blue",onClick:s,children:x(W2,{size:20})}),disabled:!t,autosize:!0,rows:2,minRows:1,maxRows:4,value:r,onChange:c=>i(c.target.value),onKeyDown:c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),s())}})})]})})]})})}function y2t(){return x(SR,{children:B(me,{position:"apart",spacing:30,h:"80vh",children:[x(m2t,{}),x(g2t,{})]})})}function ppe({profileId:e}){const{profiles:t,updateProfile:n}=js(),{updateTab:r}=wo(),[i,a]=I.exports.useState(t.find(y=>y.identifier===e)),[s,{open:o,close:l}]=$r(!1),[u,c]=I.exports.useState(i==null?void 0:i.image),[d,p]=I.exports.useState(i==null?void 0:i.notes),[h]=Kt(d,1e3);I.exports.useEffect(()=>{a(t.find(y=>y.identifier===e))},[t]),I.exports.useEffect(()=>{c(i==null?void 0:i.image)},[i]),I.exports.useEffect(()=>{i&&h&&n(i.identifier,{notes:h})},[h]);const m=I.exports.useCallback(()=>{r({title:"profiles",component:x(hpe,{})})},[i,r]),g=I.exports.useCallback(()=>{const y={...i,notes:d};Ne("saveProfile",y)},[i,d]),v=()=>{l(),Ne("hideUI"),Ne("takePhoto","profile")};return kt("photoTaken",y=>{y.page==="profile"&&(o(),c(y.url))}),B(ze,{children:[i&&B(me,{spacing:20,children:[x(Bt,{w:"60%",h:"81vh",color:"dark.6",radius:"xs",p:20,shadow:"xs",children:B(Ce,{w:"100%",spacing:25,align:"flex-start",children:[B(me,{w:"100%",position:"apart",children:[B(bt,{radius:"sm",children:["ID: ",i.identifier]}),B(me,{spacing:10,children:[x(Fe,{variant:"subtle",color:"blue",onClick:m,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:g,children:x(Us,{})})]})]}),x(me,{w:"100%",position:"apart",children:B(me,{w:"90%",children:[x(er,{size:160,src:i.image,onClick:o,sx:{cursor:"pointer"}}),x(An,{w:"75%",h:160,scrollHideDelay:0,scrollbarSize:5,children:B(me,{w:"100%",spacing:10,children:[x(Xe,{label:K.player_name,variant:"filled",readOnly:!0,value:i.name,size:"xs"}),x(Xe,{label:K.dob,variant:"filled",readOnly:!0,value:i.dob,size:"xs"}),x(Xe,{label:K.phone_number,variant:"filled",readOnly:!0,value:i.phoneNumber,size:"xs"}),x(Xe,{label:K.gender,variant:"filled",readOnly:!0,value:K[i.gender],size:"xs"}),i.fingerprint&&x(Xe,{label:K.fingerprint,variant:"filled",readOnly:!0,value:i.fingerprint,size:"xs"}),i.bloodType&&x(Xe,{label:K.bloodType,variant:"filled",readOnly:!0,value:i.bloodType,size:"xs"})]})})]})}),x(bs,{w:"100%",label:K.notes,minRows:25,maxLength:5e4,value:d,onChange:y=>p(y.currentTarget.value)})]})}),x(ol,{page:"profile",sidebar:i.sideBarData,pageId:i.identifier,updateData:n})]}),x(sr,{size:"40%",centered:!0,title:i==null?void 0:i.name,opened:s,onClose:l,withinPortal:!0,children:B(Ce,{spacing:20,children:[x(il,{radius:"md",src:i==null?void 0:i.image}),x(Xe,{label:K.image_url,placeholder:K.url,variant:"filled",value:u,onChange:y=>c(y.currentTarget.value),rightSection:x(Fe,{onClick:v,children:x(Kl,{})})}),x(me,{position:"right",children:x(Ct,{onClick:()=>{!i||(l(),n(i.identifier,{image:u}))},children:K.confirm})})]})})]})}function v2t({searchQuery:e,filters:t}){const{profiles:n,updateProfile:r}=js(),{updateTab:i}=wo(),a=I.exports.useMemo(()=>n.filter(o=>{var c,d,p;const l=((c=o.name)==null?void 0:c.toLowerCase().includes(e.toLowerCase()))||((d=o.identifier)==null?void 0:d.toLowerCase().includes(e.toLowerCase()))||((p=o.fingerprint)==null?void 0:p.toLowerCase().includes(e.toLowerCase()));if(!t)return l;const u=t.every(h=>{if(!o.sideBarData)return!1;let m;if(h.type in o.sideBarData?m=o.sideBarData[h.type]:m=o[h.type],Array.isArray(m)&&m.length>0){if(typeof m[0]=="object")return m.some(g=>Object.values(g).some(v=>typeof v=="string"?v.toLowerCase().includes(h.value.toLowerCase()):!1));if(typeof m[0]=="string")return m.some(g=>g.toLowerCase().includes(h.value.toLowerCase()))}return typeof m=="string"?m.toLowerCase().includes(h.value.toLowerCase()):!1});return l&&u}),[e,t,n]),s=({index:o,style:l})=>{const u=a[o];return x("div",{style:{...l},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getProfile",u.identifier).then(c=>{!c||!u.identifier||r(u.identifier,c)}),i({title:"profiles",component:x(ppe,{profileId:u.identifier})})},p:10,children:B(me,{spacing:15,children:[x(er,{size:80,src:u.image}),B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:u.name}),B(bt,{radius:"sm",children:["ID: ",u.identifier]})]}),x(Te,{fw:500,size:12,color:"gray.5",children:u.dob})]})]})})})};return x(ta,{height:window.innerHeight*.77,itemCount:a.length,itemSize:110,width:"100%",children:s})}function hpe(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200);$r(!1);const[r,i]=I.exports.useState(),[a,s]=I.exports.useState([{type:"tags",value:""}]);return B(ze,{children:[x(xa,{title:K.profiles,searchQuery:e,filterInputs:a,filters:r,setFilterInputs:s,setSearchQuery:t,setFilters:i}),x(v2t,{searchQuery:n,filters:r})]})}function b2t({pageTitle:e,sidebar:t,pageId:n,updateData:r}){const[i,{toggle:a}]=$r(!1),{addTab:s}=wo(),{reports:o,updateReport:l}=ju(),{updateProfile:u}=js(),{employees:c}=Jo(),{players:d}=RR(),{tags:p}=Ey(),h=v=>{const y=async(b,_,k,C)=>{const $=await b(v);!$||!r||(_(v,$),s({title:C,component:k}))};switch(t.title){case"linkedReports":y(b=>Ne("getReport",b),l,x(V3,{reportId:v}),"reports");break;case"linkedProfiles":case"paramedics":case"patients":y(b=>Ne("getProfile",b),u,x(ppe,{profileId:v}),"profiles");break}},m=()=>{if(!r)return;const v=y=>{In.open({centered:!0,title:K[t.title],children:y})};switch(t.title){case"tags":v(x(dQ,{currentTags:t.data,pageId:n,updateData:r}));break;case"paramedics":case"patients":v(x(qg,{title:t.title,allPlayers:t.title==="paramedics"?c:d,currentPlayers:t.data,pageId:n,updateData:r}));break;case"linkedProfiles":v(x(qg,{title:t.title,allPlayers:d,currentPlayers:t.data,pageId:n,includeReason:!0,updateData:r}));break;case"linkedReports":v(x(ik,{title:t.title,allReports:o,currentReports:t.data,pageId:n,updateData:r}));break;case"photos":v(x(HI,{pageId:n,currentPhotos:t.data,updateData:r}));break}};t.title==="photos"&&kt("photoTaken",v=>{!r||v.page!=="photos"||In.open({centered:!0,title:t.title,children:x(HI,{pageId:n,currentUrl:v.url,currentPhotos:t.data,updateData:r})})});const g=v=>{if(!r)return;const y=(b,_)=>{r(n,{sideBarData:{[b]:t.data.filter(_)}})};switch(t.title){case"tags":y(t.title,b=>b!==v);break;case"paramedics":case"patients":case"linkedProfiles":y(t.title,b=>b.identifier!==v);break;default:y(t.title,b=>b.id!==v);break}};return B(ze,{children:[x(Bt,{w:"100%",h:50,bg:"dark.7",radius:"xs",shadow:"xs",onClick:a,style:{cursor:"pointer"},mb:10,children:B(me,{position:"apart",h:"100%",px:15,children:[x(Te,{size:15,fw:450,children:K[t.title]}),(t.title==="linkedProfiles"||t.title==="tags"||t.title==="paramedics"||t.title==="patients"||t.title==="photos"||e!=="profile"&&t.title==="linkedReports")&&x(Fe,{color:"blue",variant:"subtle",onClick:v=>{v.stopPropagation(),m()},children:x(Oy,{})})]})}),x(ze,{children:x(T2,{in:i,children:x(An.Autosize,{mah:500,type:"always",scrollbarSize:3,pb:15,children:x(me,{spacing:10,pb:5,children:(!(t!=null&&t.data)||t.data.length===0)&&x(bt,{color:"dark",children:K.no_sidebar_data.format(K[t.title])})||(t.title==="jobs"||t.title==="charges")&&t.data.map((v,y)=>x(bt,{children:v},y))||t.title==="tags"&&r&&t.data.map((v,y)=>{const b=p.find(_=>_.name===v);return b?x(bt,{style:{backgroundColor:b.color,color:"#ced4da",textShadow:"0px 1px 2px rgba(0, 0, 0, 1.0"},rightSection:x(Fe,{size:14,variant:"transparent",onClick:()=>g(v),children:x(ui,{})}),children:v},y):null})||(t.title==="driving"||t.title==="professionalism"||t.title==="generalKnowledge"||t.title==="reports"||t.title==="radio")&&r&&x(mQ,{sidebar:t,pageId:n,updateData:r})||(t.title==="paramedics"||t.title==="patients")&&r&&t.data.map((v,y)=>x(bt,{style:{cursor:"pointer"},onClick:()=>h(v.identifier),rightSection:x(Fe,{size:14,variant:"transparent",onClick:b=>{b.stopPropagation(),g(v.identifier)},children:x(ui,{})}),children:v.name},y))||t.title==="linkedReports"&&kg(t.data).map((v,y)=>{const b=o.find(_=>_.id===v);return b?x(bt,{onClick:()=>h(v),style:{cursor:"pointer"},rightSection:e!=="evidence"&&e!=="weapon"&&x(Fe,{size:14,onClick:_=>{_.stopPropagation(),g(v)},children:x(ui,{})}),children:`${b.title} (ID: ${v})`},y):null})||t.title==="linkedProfiles"&&t.data.map((v,y)=>B(bt,{onClick:()=>h(v.identifier),style:{cursor:"pointer"},rightSection:x(Fe,{size:14,variant:"transparent",onClick:b=>{b.stopPropagation(),g(v.identifier)},children:x(ui,{})}),children:[v.name,": ",v.reason]},y))||t.title==="photos"&&t.data.map((v,y)=>x(rs,{p:5,label:x("img",{src:v,width:576}),position:"left",color:"dark.6",withArrow:!0,withinPortal:!0,children:x(il,{src:v,maw:192,style:{cursor:"pointer"},onClick:()=>{!r||In.openConfirmModal({title:K.are_you_sure,centered:!0,children:x(Te,{size:"sm",children:K.are_you_sure_remove_photo}),labels:{confirm:K.confirm,cancel:K.cancel},onConfirm:()=>r(n,{sideBarData:{photos:t.data.filter(b=>b!==b)}})})}})},y))||t.data.map((v,y)=>x(bt,{children:v},y))})})})})]})}function fpe({page:e,sidebar:t,pageId:n,updateData:r}){const{sidebarOrder:i}=tn();if(!t)return null;const a=Object.keys(t).filter(s=>i.includes(s)).sort((s,o)=>{const l=i.indexOf(s),u=i.indexOf(o);return(l===-1?i.length:l)-(u===-1?i.length:u)});return x(An,{w:"38%",h:"81vh",type:"never",children:x(Ce,{justify:"flex-start",h:"100%",spacing:0,children:a.map((s,o)=>x(b2t,{pageTitle:e,sidebar:{title:s,data:t[s]},pageId:n,updateData:r},o))})})}function V3({reportId:e}){const{reports:t,updateReport:n}=ju(),{updateTab:r}=wo(),[i,a]=I.exports.useState(t.find(y=>y.id===e)),{dateFormat:s}=tn(),[o,l]=I.exports.useState(i==null?void 0:i.title),[u]=Kt(o,500),c=I.exports.useRef(0),[d]=Kt(c.current,2500);I.exports.useEffect(()=>{const y=t.find(b=>b.id===e);y&&a(y)},[t,e]);const p=om({extensions:[um,cm,pm,hm,lm,i0,r0,dm.configure({types:["heading","paragraph"]}),fm,mm.configure({limit:1e5})],content:i==null?void 0:i.content}),h=I.exports.useRef(!1);I.exports.useEffect(()=>{!p||!(i!=null&&i.content)||h.current||(h.current=!0,p.commands.setContent(i.content),i!=null&&i.title&&l(i.title))},[p,i]),I.exports.useEffect(()=>{!i||n(i.id,{...i,title:u})},[u]),I.exports.useEffect(()=>{!i||n(i.id,{...i,content:p==null?void 0:p.getHTML()})},[d]),I.exports.useEffect(()=>{if(p){const y=()=>{c.current++};return p.on("update",y),()=>{p.off("update",y)}}},[p]),I.exports.useEffect(()=>{p&&p.setOptions({editorProps:{handlePaste:(y,b,_)=>{const k=b.clipboardData,C=k==null?void 0:k.getData("text/plain");return/https?:\/\/\S+\.(jpg|jpeg|png|gif)/i.test(C||"")&&C?(b.preventDefault(),p.commands.setImage({src:C}),!0):!1}}})},[p]);const m=I.exports.useCallback(()=>{r({title:"reports",component:x(HA,{})})},[i,r]),g=I.exports.useCallback(()=>{const y={...i,title:o,content:p==null?void 0:p.getHTML()};Ne("saveReport",y)},[i,o,p]),v=I.exports.useCallback(()=>{In.openConfirmModal({title:K.are_you_sure_remove,labels:{confirm:K.confirm,cancel:K.cancel},centered:!0,onConfirm:()=>{Ne("removeReport",i==null?void 0:i.id),r({title:"reports",component:x(HA,{})})}})},[i,r]);return x(ze,{children:i&&B(me,{spacing:20,h:"100%",style:{alignItems:"start"},children:[B(Ce,{w:"60%",h:"100%",justify:"flex-start",spacing:10,children:[x(Bt,{w:"100%",h:80,color:"dark.6",radius:"xs",px:10,shadow:"xs",children:B(Ce,{h:"100%",justify:"center",spacing:5,children:[B(me,{position:"apart",children:[x(Xe,{variant:"filled",value:o||"",onChange:y=>l(y.currentTarget.value),sx:{input:{fontSize:18,fontWeight:630}},w:"60%"}),B(me,{spacing:10,children:[B(bt,{radius:"sm",children:["ID: ",i.id===-1&&"Temporary"||i.id]}),x(Fe,{variant:"subtle",color:"blue",onClick:m,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:g,children:x(Us,{})}),x(Fe,{variant:"subtle",color:"red",onClick:v,children:x(go,{})})]})]}),B(Te,{fw:550,size:12,color:"gray.6",children:[i.creator," - ",new Date(i.date*1e3).toLocaleString([],s||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]})]})}),x(Bt,{w:"100%",h:"100%",color:"dark.7",radius:"xs",p:20,shadow:"xs",children:x(gm,{editor:p})})]}),x(fpe,{page:"report",sidebar:i.sideBarData,pageId:i.id,updateData:n})]})})}function w2t({searchQuery:e,filters:t}){const{reports:n,updateReport:r}=ju(),{updateTab:i}=wo(),{dateFormat:a}=tn(),s=I.exports.useMemo(()=>n.filter(l=>{var d,p,h,m;const u=((d=l.title)==null?void 0:d.toLowerCase().includes(e.toLowerCase()))||((p=l.id)==null?void 0:p.toString())===e||l.sideBarData&&(((h=l.sideBarData.paramedics)==null?void 0:h.some(g=>{var v;return(v=g==null?void 0:g.name)==null?void 0:v.toLowerCase().includes(e.toLowerCase())}))||((m=l.sideBarData.patients)==null?void 0:m.some(g=>{var v;return(v=g==null?void 0:g.name)==null?void 0:v.toLowerCase().includes(e.toLowerCase())})));if(!t)return u;const c=t.every(g=>{if(!l.sideBarData)return!1;let v;if(g.type in l.sideBarData?v=l.sideBarData[g.type]:v=l[g.type],Array.isArray(v)&&v.length>0){if(typeof v[0]=="object")return v.some(y=>Object.values(y).some(b=>typeof b=="string"?b.toLowerCase().includes(g.value.toLowerCase()):!1));if(typeof v[0]=="string")return v.some(y=>y.toLowerCase().includes(g.value.toLowerCase()))}return typeof v=="string"?v.toLowerCase().includes(g.value.toLowerCase()):!1});return u&&c}).sort((l,u)=>u.id-l.id),[e,t,n]),o=({index:l,style:u})=>{const c=s[l];return c.id<=-1?null:x("div",{style:{...u},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getReport",c.id).then(d=>{!d||!c.id||r(c.id,d)}),i({title:"reports",component:x(V3,{reportId:c.id})})},p:10,children:x(me,{spacing:15,children:B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:c.title}),B(bt,{radius:"sm",children:["ID: ",c.id]})]}),c.sideBarData.paramedics&&c.sideBarData.paramedics.length>0&&B(Te,{w:700,fw:500,size:13,color:"gray.4",style:{overflow:"hidden",wordBreak:"break-all",textOverflow:"ellipsis"},children:[K.paramedics_list," ",c.sideBarData.paramedics.map(d=>d==null?void 0:d.name).join(", ")]}),c.sideBarData.patients&&c.sideBarData.patients.length>0&&B(Te,{w:700,fw:500,size:13,color:"gray.4",style:{overflow:"hidden",wordBreak:"break-all",textOverflow:"ellipsis"},children:[K.patients_list," ",c.sideBarData.patients.map(d=>d.name).join(", ")]}),x(Te,{fw:500,size:12,color:"gray.5",children:new Date(c.date*1e3).toLocaleString([],a||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]})})})})};return x(ta,{height:window.innerHeight*.77,itemCount:s.length,itemSize:110,width:"100%",children:o})}function HA(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200),[r,i]=I.exports.useState(),[a,s]=I.exports.useState([{type:"creator",value:""},{type:"tags",value:""},{type:"paramedics",value:""},{type:"patients",value:""}]),{updateTab:o}=wo(),l=()=>{Ne("createReport").then(u=>{!u||o({title:"reports",component:x(V3,{reportId:u.id})})})};return B(ze,{children:[x(xa,{title:K.reports,searchQuery:e,filterInputs:a,filters:r,setFilterInputs:s,setSearchQuery:t,setFilters:i,createNew:l}),x(w2t,{searchQuery:n,filters:r})]})}function mpe({reportId:e}){const{trainingReports:t,updateTrainingReport:n}=W1(),{updateTab:r}=wo(),[i,a]=I.exports.useState(t.find(y=>y.id===e)),{dateFormat:s}=tn(),[o,l]=I.exports.useState(i==null?void 0:i.title),[u]=Kt(o,500),c=I.exports.useRef(0),[d]=Kt(c.current,2500);I.exports.useEffect(()=>{const y=t.find(b=>b.id===e);y&&a(y)},[t,e]);const p=om({extensions:[um,cm,pm,hm,lm,i0,r0,dm.configure({types:["heading","paragraph"]}),N3,fm,mm.configure({limit:1e5})],content:i==null?void 0:i.content}),h=I.exports.useRef(!1);I.exports.useEffect(()=>{!p||!(i!=null&&i.content)||h.current||(h.current=!0,p.commands.setContent(i.content),i!=null&&i.title&&l(i.title))},[p,i]),I.exports.useEffect(()=>{!i||n(i.id,{...i,title:u})},[u]),I.exports.useEffect(()=>{!i||n(i.id,{...i,content:p==null?void 0:p.getHTML()})},[d]),I.exports.useEffect(()=>{if(p){const y=()=>{c.current++};return p.on("update",y),()=>{p.off("update",y)}}},[p]),I.exports.useEffect(()=>{p&&p.setOptions({editorProps:{handlePaste:(y,b,_)=>{const k=b.clipboardData,C=k==null?void 0:k.getData("text/plain");return/https?:\/\/\S+\.(jpg|jpeg|png|gif)/i.test(C||"")&&C?(b.preventDefault(),p.commands.setImage({src:C}),!0):!1}}})},[p]);const m=I.exports.useCallback(()=>{r({title:"trainingReports",component:x(GA,{})})},[i,r]),g=I.exports.useCallback(()=>{const y={...i,title:o,content:p==null?void 0:p.getHTML()};Ne("saveTrainingReport",y)},[i,o,p]),v=I.exports.useCallback(()=>{In.openConfirmModal({title:K.are_you_sure_remove,labels:{confirm:K.confirm,cancel:K.cancel},centered:!0,onConfirm:()=>{Ne("removeTrainingReport",i==null?void 0:i.id),r({title:"trainingReports",component:x(GA,{})})}})},[i,r]);return x(ze,{children:i&&B(me,{spacing:20,h:"100%",style:{alignItems:"start"},children:[B(Ce,{w:"60%",h:"100%",spacing:10,children:[x(Bt,{w:"100%",h:80,color:"dark.6",radius:"xs",px:10,shadow:"xs",children:B(Ce,{h:"100%",justify:"center",spacing:5,children:[B(me,{position:"apart",children:[x(Xe,{variant:"filled",value:o,onChange:y=>l(y.currentTarget.value),sx:{input:{fontSize:18,fontWeight:630}},w:"60%"}),B(me,{spacing:10,children:[B(bt,{radius:"sm",children:["ID: ",i.id]}),x(Fe,{variant:"subtle",color:"blue",onClick:m,children:x(ws,{})}),x(Fe,{variant:"subtle",color:"blue",onClick:g,children:x(Us,{})}),x(Fe,{variant:"subtle",color:"red",onClick:v,children:x(go,{})})]})]}),B(Te,{fw:550,size:12,color:"gray.6",children:[i.creator," - ",new Date(i.date*1e3).toLocaleString([],s||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})," - ",K.trainee.format(i.trainee)]})]})}),x(Bt,{w:"100%",h:"72%",color:"dark.7",radius:"xs",p:20,shadow:"xs",children:x(gm,{editor:p})})]}),x(fpe,{page:"trainingReport",sidebar:i.sideBarData,pageId:i.id,updateData:n})]})})}function x2t({searchQuery:e}){const{updateTab:t}=wo(),{trainingReports:n,updateTrainingReport:r}=W1(),{dateFormat:i}=tn(),a=I.exports.useMemo(()=>n.filter(o=>{var l,u,c;return((l=o.creator)==null?void 0:l.toLowerCase().includes(e.toLowerCase()))||((u=o.trainee)==null?void 0:u.toLowerCase().includes(e.toLowerCase()))||((c=o.id)==null?void 0:c.toString())===e}).sort((o,l)=>l.id-o.id),[e,n]),s=({index:o,style:l})=>{const u=a[o];return x("div",{style:{...l},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getTrainingReport",u.id).then(c=>{!c||!u.id||r(u.id,c)}),t({title:"trainingReports",component:x(mpe,{reportId:u.id})})},p:10,children:x(me,{spacing:15,children:B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:u.title}),B(bt,{radius:"sm",children:["ID: ",u.id]})]}),B(Te,{fw:500,size:12,color:"gray.5",children:[u.creator," - ",new Date(u.date*1e3).toLocaleString([],i||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})," - ",K.trainee.format(u.trainee)]})]})})})})};return x(ta,{height:window.innerHeight*.77,itemCount:a.length,itemSize:110,width:"100%",children:s})}function GA(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200),[r,{open:i,close:a}]=$r(!1),[s,o]=I.exports.useState(),{employees:l,minTrainingReportGrade:u,maxTraineeGrade:c}=Jo(),{playerGrade:d,isBoss:p}=tn(),{updateTab:h}=wo(),m=()=>{i()};return I.exports.useEffect(()=>{!s||s===""||Ne("createTrainingReport",s).then(g=>{!g||h({title:"trainingReports",component:x(mpe,{reportId:g.id})})})},[s]),B(ze,{children:[x(xa,{title:K.trainingReports,searchQuery:e,setSearchQuery:t,createNew:d>=u?m:void 0}),p&&x(x2t,{searchQuery:n}),x(sr,{opened:r,onClose:a,title:K.new_training_report,centered:!0,children:x(qg,{allPlayers:l.filter(g=>g.gradeNumber<=c),setTrainee:o})})]})}function _2t(){const{tabs:e,activeTab:t,initialTab:n,updateTab:r,setInitialTab:i,setTabs:a,setActiveTab:s}=wo(),{emsPages:o}=tn(),l=[{name:"home",icon:x(aP,{}),component:x(y2t,{})},{name:"profiles",icon:x(zR,{}),component:x(hpe,{})},{name:"reports",icon:x(iQ,{}),component:x(HA,{})},{name:"trainingReports",icon:x(sQ,{}),component:x(GA,{})},{name:"map",icon:x(rQ,{}),component:x(spe,{})},{name:"employees",icon:x(oQ,{}),component:x(upe,{})}];I.exports.useEffect(()=>{var h;if(n)return;const c=(h=l.find(m=>m.name===o[0]))==null?void 0:h.component,d=Mu(),p={id:d,title:o[0],component:c};i(p),a([p]),s(d)},[o]);const u=c=>{r({title:c.name,component:c.component})};return B(ze,{children:[x(An,{w:220,h:"84vh",bg:"dark.7",px:10,py:10,scrollHideDelay:0,scrollbarSize:5,children:x(Ce,{h:"100%",spacing:5,align:"flex-start",children:l.map((c,d)=>{var m;if(!o.includes(c.name))return;const h=((m=e.find(g=>g.id===t))==null?void 0:m.title)===c.name;return x(Ct,{leftIcon:c.icon,color:"gray",variant:h?"light":"subtle",w:"100%",h:40,px:10,styles:{inner:{justifyContent:"start"}},onClick:()=>u(c),children:K[c.name]},d)})})}),x(Ds,{orientation:"vertical",color:"dark.6"})]})}function k2t(){const{tabs:e,activeTab:t,setActiveTab:n}=wo();return x(gi,{value:t,onTabChange:n,children:e.map(r=>x(gi.Panel,{value:r.id,children:r.component},r.id))})}function S2t(){const{tabs:e,activeTab:t,setActiveTab:n,removeTab:r,addTab:i}=wo(),{employees:a}=Jo(),{identifier:s,dateFormat:o}=tn(),[l,u]=I.exports.useState(K.paramedic),[c,d]=I.exports.useState();I.exports.useEffect(()=>{const y=a.find(b=>b.identifier===s);u((y==null?void 0:y.name)||K.paramedic),d(y==null?void 0:y.image)},[]),I.exports.useEffect(()=>{const y=a.find(b=>b.identifier===s);d(y==null?void 0:y.image)},[a]);var[p,h]=I.exports.useState(new Date);I.exports.useEffect(()=>{const y=setInterval(()=>{h(new Date)},6e4);return()=>clearInterval(y)},[]);const m=I.exports.useRef(null),g=I.exports.useRef({}),v=y=>{m.current&&(m.current.scrollLeft-=.2*y.deltaY)};return B(ze,{children:[x(wt,{h:70,bg:"dark.7",px:20,children:B(me,{h:"100%",position:"apart",children:[B(me,{spacing:105,w:"70%",children:[x(D2,{order:1,w:"8%",children:K.ems}),x(gi,{value:t,onTabChange:n,mt:28,defaultValue:"gallery",children:B(me,{w:"100%",spacing:10,children:[x(An,{maw:900,type:"never",onWheel:v,viewportRef:m,children:x(gi.List,{sx:{flexFlow:"row",borderBottom:"0px"},children:e.map(y=>x(gi.Tab,{py:10,value:y.id,ref:b=>g.current[y.id]=b,mb:0,rightSection:x(Fe,{color:"blue",className:"remove-icon",variant:"subtle",size:20,onClick:b=>{b.stopPropagation(),r(y.id)},children:x(ui,{size:14})}),children:K[y.title]},y.id))})}),x(Fe,{ml:10,onClick:()=>{i(),setTimeout(()=>{const y=e[e.length-1].id;g.current[y]&&g.current[y].scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},0)},children:x(Oy,{})})]})})]}),B(me,{spacing:10,children:[B(Ce,{align:"flex-end",spacing:0,children:[x(Te,{fw:650,size:20,children:l}),x(Te,{fw:600,size:13,color:"gray.5",children:p.toLocaleString([],o||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]}),x(er,{size:40,src:c})]})]})}),x(Ds,{color:"dark.6"})]})}const rx=AR((e,t)=>({tabs:[],initialTab:null,activeTab:null,setInitialTab:n=>e({initialTab:n}),setTabs:n=>e({tabs:n}),addTab:n=>{if(!t().initialTab&&!n)return;const i=Mu();e(a=>{var s;return{tabs:[...a.tabs,{id:i,title:(n==null?void 0:n.title)||((s=a.initialTab)==null?void 0:s.title)||"",component:(n==null?void 0:n.component)||a.initialTab&&a.initialTab.component}],activeTab:i}})},removeTab:n=>{const r=t();if(!!r.initialTab){if(r.tabs.length===1){r.updateTab({title:r.initialTab.title,component:r.initialTab.component});return}e(i=>{const a=i.tabs.filter(o=>o.id!==n),s=i.activeTab===n&&a.length>0?a[0].id:i.activeTab;return{tabs:a,activeTab:s}})}},setActiveTab:n=>e({activeTab:n}),updateTab:n=>{const r=Mu();e(i=>({tabs:i.tabs.map(a=>a.id===i.activeTab?{...n,id:r}:a),activeTab:r}))}}));function C2t({pageTitle:e,sidebar:t,pageId:n,updateData:r}){const[i,{toggle:a}]=$r(!1);return B(ze,{children:[x(Bt,{w:"100%",h:50,bg:"dark.7",radius:"xs",shadow:"xs",onClick:a,style:{cursor:"pointer"},mb:10,children:x(me,{position:"apart",h:"100%",px:15,children:x(Te,{size:15,fw:450,children:K[t.title]})})}),x(ze,{children:x(T2,{in:i,children:x(An.Autosize,{mah:500,type:"always",scrollbarSize:3,pb:15,children:x(me,{spacing:10,pb:5,children:(!(t!=null&&t.data)||t.data.length===0)&&x(bt,{color:"dark",children:K.no_sidebar_data.format(K[t.title])})||t.title==="charges"&&t.data.map((s,o)=>x(bt,{children:s},o))||t.title==="licenses"&&r&&t.data.map((s,o)=>x(bt,{children:s},o))||t.title==="properties"&&t.data.map((s,o)=>B(bt,{children:[s.name," (ID: ",s.id,")"]},o))||t.title==="vehicles"&&t.data.map((s,o)=>B(bt,{children:[s.name," [",s.plate,"]"]},o))||t.title==="warrants"&&t.data.map((s,o)=>B(bt,{children:[s.incidentTitle," (ID: ",s.incidentId,")"]},o))||t.data.map((s,o)=>x(bt,{children:s},o))})})})})]})}function I2t({page:e,sidebar:t,pageId:n,updateData:r}){const{sidebarOrder:i}=tn();if(!t)return null;const a=Object.keys(t).filter(s=>i.includes(s)).sort((s,o)=>{const l=i.indexOf(s),u=i.indexOf(o);return(l===-1?i.length:l)-(u===-1?i.length:u)});return x(An,{w:"38%",h:"81vh",type:"never",children:x(Ce,{justify:"flex-start",h:"100%",spacing:0,children:a.map((s,o)=>x(C2t,{pageTitle:e,sidebar:{title:s,data:t[s]},pageId:n,updateData:r},o))})})}const $2t=it(e=>({wave:{position:"absolute",bottom:0,width:"100%",height:"40%",zIndex:-1,color:e.colors.dark[7]}}));function T2t({profileId:e}){$2t();const{profiles:t,updateProfile:n}=js(),{updateTab:r}=rx(),[i,a]=I.exports.useState(t.find(p=>p.identifier===e)),[s,{open:o,close:l}]=$r(!1),[u,c]=I.exports.useState(i==null?void 0:i.image);I.exports.useState(i==null?void 0:i.notes),I.exports.useEffect(()=>{a(t.find(p=>p.identifier===e))},[t]),I.exports.useEffect(()=>{c(i==null?void 0:i.image)},[i]);const d=I.exports.useCallback(()=>{r({title:"profiles",component:x(gpe,{})})},[i,r]);return B(ze,{children:[i&&B(me,{spacing:20,sx:{alignItems:"start"},children:[x(Bt,{w:"60%",h:"23vh",color:"dark.6",radius:"xs",p:20,shadow:"xs",children:B(Ce,{w:"100%",spacing:25,align:"flex-start",children:[B(me,{w:"100%",position:"apart",children:[B(bt,{radius:"sm",children:["ID: ",i.identifier]}),x(Fe,{variant:"subtle",color:"blue",onClick:d,children:x(ws,{})})]}),x(me,{w:"100%",position:"apart",children:B(me,{w:"90%",children:[x(er,{size:160,src:i.image,onClick:o,sx:{cursor:"pointer"}}),x(An,{w:"75%",h:160,scrollHideDelay:0,scrollbarSize:5,children:B(me,{w:"100%",spacing:10,children:[x(Xe,{label:K.player_name,variant:"filled",readOnly:!0,value:i.name,size:"xs"}),x(Xe,{label:K.dob,variant:"filled",readOnly:!0,value:i.dob,size:"xs"})]})})]})})]})}),x(I2t,{page:"profile",sidebar:i.sideBarData,pageId:i.identifier,updateData:n})]}),x(sr,{size:"40%",centered:!0,title:i==null?void 0:i.name,opened:s,onClose:l,withinPortal:!0,children:B(Ce,{spacing:20,children:[x(il,{radius:"md",src:i==null?void 0:i.image}),x(Xe,{label:K.image_url,placeholder:K.url,variant:"filled",value:u,readOnly:!0})]})})]})}function N2t({searchQuery:e}){const{profiles:t,updateProfile:n}=js(),{updateTab:r}=rx(),i=I.exports.useMemo(()=>t.filter(s=>{var o,l;return((o=s.name)==null?void 0:o.toLowerCase().includes(e.toLowerCase()))||((l=s.identifier)==null?void 0:l.toLowerCase().includes(e.toLowerCase()))}),[e,t]),a=({index:s,style:o})=>{const l=i[s];return x("div",{style:{...o},children:x(Ct,{w:"100%",h:100,variant:"light",color:"gray",styles:{inner:{justifyContent:"start"}},onClick:()=>{Ne("getProfile",l.identifier).then(u=>{!u||!l.identifier||n(l.identifier,u)}),r({title:"profiles",component:x(T2t,{profileId:l.identifier})})},p:10,children:B(me,{spacing:15,children:[x(er,{size:80,src:l.image}),B(Ce,{spacing:1,children:[B(me,{spacing:10,children:[x(Te,{fw:600,size:16,children:l.name}),B(bt,{radius:"sm",children:["ID: ",l.identifier]})]}),x(Te,{fw:500,size:12,color:"gray.5",children:l.dob})]})]})})})};return x(ta,{height:window.innerHeight*.77,itemCount:i.length,itemSize:110,width:"100%",children:a})}function gpe(){const[e,t]=I.exports.useState(""),[n]=Kt(e,200);return B(ze,{children:[x(xa,{title:K.profiles,searchQuery:e,setSearchQuery:t}),x(N2t,{searchQuery:n})]})}function E2t(){const{tabs:e,activeTab:t,initialTab:n,updateTab:r,setInitialTab:i,setTabs:a,setActiveTab:s}=rx(),{citizenPages:o}=tn(),l=[{name:"profiles",icon:x(zR,{}),component:x(gpe,{})},{name:"charges",icon:x(zC,{}),component:x(WR,{isCitizen:!0})},{name:"legislation",icon:x(nQ,{}),component:x(dpe,{isCitizen:!0})}];I.exports.useEffect(()=>{var h;if(n)return;const c=(h=l.find(m=>m.name===o[0]))==null?void 0:h.component,d=Mu(),p={id:d,title:o[0],component:c};i(p),a([p]),s(d)},[o]);const u=c=>{r({title:c.name,component:c.component})};return B(ze,{children:[x(An,{w:220,h:"84vh",bg:"dark.7",px:10,py:10,scrollHideDelay:0,scrollbarSize:5,children:x(Ce,{h:"100%",spacing:5,align:"flex-start",children:l.map((c,d)=>{var m;if(!o.includes(c.name))return;const h=((m=e.find(g=>g.id===t))==null?void 0:m.title)===c.name;return x(Ct,{leftIcon:c.icon,color:"gray",variant:h?"light":"subtle",w:"100%",h:40,px:10,styles:{inner:{justifyContent:"start"}},onClick:()=>u(c),children:K[c.name]},d)})})}),x(Ds,{orientation:"vertical",color:"dark.6"})]})}function O2t(){const{tabs:e,activeTab:t,setActiveTab:n,removeTab:r,addTab:i}=rx(),{profiles:a}=js(),{identifier:s,dateFormat:o}=tn(),[l,u]=I.exports.useState(K.citizen),[c,d]=I.exports.useState();I.exports.useEffect(()=>{const y=a.find(b=>b.identifier===s);u((y==null?void 0:y.name)||K.citizen),d(y==null?void 0:y.image)},[]),I.exports.useEffect(()=>{const y=a.find(b=>b.identifier===s);d(y==null?void 0:y.image)},[a]);var[p,h]=I.exports.useState(new Date);I.exports.useEffect(()=>{const y=setInterval(()=>{h(new Date)},6e4);return()=>clearInterval(y)},[]);const m=I.exports.useRef(null),g=I.exports.useRef({}),v=y=>{m.current&&(m.current.scrollLeft-=.2*y.deltaY)};return B(ze,{children:[x(wt,{h:70,bg:"dark.7",px:20,children:B(me,{h:"100%",position:"apart",children:[B(me,{spacing:105,w:"70%",children:[x(D2,{order:1,w:"8%",children:K.citizen}),x(gi,{value:t,onTabChange:n,mt:28,defaultValue:"gallery",children:B(me,{w:"100%",spacing:10,children:[x(An,{maw:900,type:"never",onWheel:v,viewportRef:m,children:x(gi.List,{sx:{flexFlow:"row",borderBottom:"0px"},children:e.map(y=>x(gi.Tab,{py:10,value:y.id,ref:b=>g.current[y.id]=b,mb:0,rightSection:x(Fe,{color:"blue",className:"remove-icon",variant:"subtle",size:20,onClick:b=>{b.stopPropagation(),r(y.id)},children:x(ui,{size:14})}),children:K[y.title]},y.id))})}),x(Fe,{ml:10,onClick:()=>{i(),setTimeout(()=>{const y=e[e.length-1].id;g.current[y]&&g.current[y].scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},0)},children:x(Oy,{})})]})})]}),B(me,{spacing:10,children:[B(Ce,{align:"flex-end",spacing:0,children:[x(Te,{fw:650,size:20,children:l}),x(Te,{fw:600,size:13,color:"gray.5",children:p.toLocaleString([],o||{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]}),x(er,{size:40,src:c})]})]})}),x(Ds,{color:"dark.6"})]})}function P2t(){const{tabs:e,activeTab:t,setActiveTab:n}=rx();return x(gi,{value:t,onTabChange:n,children:e.map(r=>x(gi.Panel,{value:r.id,children:r.component},r.id))})}function A2t(){const{setLoading:e,setIdentifier:t,setPlayerJob:n,setPlayerGrade:r,setIsBoss:i,setName:a,setPhoneNumber:s,setSidebarOrder:o,setPolicePages:l,setEMSPages:u,setCitizenPages:c,setDateFormat:d}=tn(),{setPlayers:p}=RR(),{setGrades:h}=cQ(),{setLicenses:m}=pQ(),{setTags:g,addTag:v}=Ey(),{setProfiles:y,updateProfile:b,addProfile:_}=js(),{setVehicles:k,updateVehicle:C,addVehicle:$}=Th(),{setProperties:N}=F2(),{setBusinesses:A}=MR(),{setIncidents:D,addIncident:O,updateIncident:F,removeIncident:E}=$d(),{setReports:z,addReport:q,updateReport:H,removeReport:J}=ju(),{setTrainingReports:ee,addTrainingReport:V,updateTrainingReport:Q,removeTrainingReport:X}=W1(),{setPoliceReports:Y,addPoliceReport:ce,removePoliceReport:pe}=Qb(),{setEvidence:fe,addEvidence:ye,updateEvidence:_e,removeEvidence:Ee}=V1(),{setWeapons:Se,addWeapon:Re,updateWeapon:Ze,removeWeapon:at}=j1(),{setCharges:Je,addCharge:st,updateCharge:He,removeCharge:xt}=z2(),{setLaws:gt,addLaw:ft,updateLaw:Ft,removeLaw:Hn}=cpe(),{addEmployee:_t,setEmployees:bn,setEmployeeLicenses:Jt,setStatus:Mt,updateEmployee:Rn,setMinTrainingReportGrade:Gn,setMaxTraineeGrade:wn}=Jo(),{setMessages:$n,addMessage:cn}=DR(),{setAnnouncements:Nr,addAnnouncement:wi,togglePin:tr,removeAnnouncement:$a}=LR(),{setCalls:yn,addCall:Ge,removeCall:rt}=FR(),[xi,Tn]=I.exports.useState(1),qn=se=>{const{clientX:Xn,clientY:nr}=se,ve=window.innerWidth*.9,Ie=window.innerHeight*.9,Ye=(window.innerWidth-ve)/2,Le=(window.innerHeight-Ie)/2,Lt=Xn>=Ye&&Xn<=Ye+ve&&nr>=Le&&nr<=Le+Ie;Tn(Lt?1:.3)};I.exports.useEffect(()=>(window.addEventListener("mousemove",qn),()=>{window.removeEventListener("mousemove",qn)}),[]);const ii=it(se=>({app:{borderRadius:10,position:"relative",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:se.colors.dark[8],height:"90vh",width:"90vw",mx:"auto",overflow:"hidden",transition:"opacity 0.1s",opacity:xi}})),{classes:Rr}=ii();kt("init",se=>{se.locales&&Ej(se.locales),se.dateFormat&&d(se.dateFormat),se.sidebarOrder&&o(se.sidebarOrder),se.policePages&&l(se.policePages),se.emsPages&&u(se.emsPages),se.citizenPages&&c(se.citizenPages),se.name&&a(se.name),se.phoneNumber&&s(se.phoneNumber),se.identifier&&t(se.identifier),se.players&&p(se.players),se.grades&&h(se.grades),se.licenses&&m(se.licenses),se.employeeLicenses&&Jt(se.employeeLicenses),se.status&&Mt(se.status),se.minTrainingReportGrade&&Gn(se.minTrainingReportGrade),se.maxTraineeGrade&&wn(se.maxTraineeGrade),se.tags&&g(se.tags),se.charges&&Je(se.charges),se.laws&&gt(se.laws),se.profiles&&y(se.profiles),se.vehicles&&k(se.vehicles),se.properties&&N(se.properties),se.businesses&&A(se.businesses),se.incidents&&D(se.incidents),se.reports&&z(se.reports),se.trainingReports&&ee(se.trainingReports),se.policeReports&&Y(se.policeReports),se.evidence&&fe(se.evidence),se.weapons&&Se(se.weapons),se.employees&&bn(se.employees),se.chatMessages&&$n(se.chatMessages),se.announcements&&Nr(se.announcements),se.employeeLicenses&&Jt(se.employeeLicenses),se.calls&&yn(se.calls),e(!1)}),kt("setJob",se=>{n(se.playerJob),r(se.playerGrade)}),kt("addEmployee",se=>{_t(se)}),kt("addTag",se=>{v(se)}),kt("addIncident",se=>{O(se)}),kt("addReport",se=>{q(se)}),kt("addTrainingReport",se=>{V(se)}),kt("addPoliceReport",se=>{ce(se)}),kt("addEvidence",se=>{ye(se)}),kt("addWeapon",se=>{Re(se)}),kt("addCharge",se=>{st(se)}),kt("updateCharge",se=>{He(se.id,{name:se.name,class:se.class,description:se.description,fine:se.fine,sentence:se.sentence,points:se.points})}),kt("removeCharge",se=>{xt(se)}),kt("removeLaw",se=>{Hn(se)}),kt("addLaw",se=>{ft(se)}),kt("updateLaw",se=>{Ft(se.id,{name:se.name})}),kt("addChatMessage",se=>{cn(se)}),kt("addAnnouncement",se=>{wi(se)}),kt("toggleAnnouncementPin",se=>{tr(se.id,se.pinned)}),kt("removeAnnouncement",se=>{$a(se)}),kt("updateEmployeeImage",se=>{Rn(se.identifier,{image:se.image})}),kt("updateEmployeeCallsign",se=>{Rn(se.identifier,{callsign:se.callsign})}),kt("updateEmployeeStatus",se=>{Rn(se.identifier,{status:se.status})}),kt("updateEmployeeNotes",se=>{Rn(se.identifier,{notes:se.notes})}),kt("updateEmployeeLicenses",se=>{Rn(se.identifier,{licenses:se.licenses})}),kt("addCall",se=>{Ge(se)}),kt("removeCall",se=>{rt(se)}),kt("updateIncident",se=>{F(se.id,{title:se.title,sideBarData:{tags:se.sideBarData.tags,officers:se.sideBarData.officers,criminals:se.sideBarData.criminals,civilians:se.sideBarData.civilians}})}),kt("updateVehicle",se=>{C(se.plate,{sideBarData:{bolos:se.bolos}})}),kt("updateProfile",se=>{b(se.identifier,{image:se.image,sideBarData:{warrants:se.warrants}})}),kt("updateReport",se=>{H(se.id,{title:se.title,sideBarData:{tags:se.sideBarData.tags,officers:se.sideBarData.officers,suspects:se.sideBarData.suspects,civilians:se.sideBarData.civilians}})}),kt("updateTrainingReport",se=>{Q(se.id,{title:se.title})}),kt("updateEvidence",se=>{_e(se.id,{title:se.title,image:se.image,sideBarData:{tags:se.sideBarData.tags}})}),kt("updateWeapon",se=>{Ze(se.id,{title:se.title,image:se.image,sideBarData:{tags:se.sideBarData.tags,owners:se.sideBarData.owners}})}),kt("removeEvidence",se=>{Ee(se)}),kt("removeWeapon",se=>{at(se)}),kt("removePoliceReport",se=>{pe(se)}),kt("removeIncident",se=>{E(se)}),kt("removeReport",se=>{J(se)}),kt("removeTrainingReport",se=>{X(se)}),kt("addProfile",se=>{_(se)}),kt("addVehicle",se=>{$(se)});const{visible:Kn,page:Dn}=pAe();return I.exports.useEffect(()=>{Kn&&((!K||Object.keys(K).length<=0)&&(console.log("No locales found, this can lead to missing translations. Trying to fetch locales again."),Ne("getLocales").then(se=>{!se||se.length<=0||Ej(se)})),(Dn==="police"||Dn==="ambulance")&&Ne("getJobData").then(se=>{n(se.job),r(se.grade),i(se.isBoss)}))},[Kn,Dn]),B(ze,{children:[x(_u,{mounted:Kn&&Dn==="police",transition:"slide-up",duration:400,timingFunction:"ease",children:se=>x("div",{style:{...se,height:"100%",width:"100%"},children:x(X_,{className:Rr.app,padding:"md",navbar:x(p2t,{}),header:x(h2t,{}),children:x(f2t,{})})})}),x(_u,{mounted:Kn&&Dn==="ambulance",transition:"slide-up",duration:400,timingFunction:"ease",children:se=>x("div",{style:{...se,height:"100%",width:"100%"},children:x(X_,{className:Rr.app,padding:"md",navbar:x(_2t,{}),header:x(S2t,{}),children:x(k2t,{})})})}),x(_u,{mounted:Kn&&Dn==="citizen",transition:"slide-up",duration:400,timingFunction:"ease",children:se=>x("div",{style:{...se,height:"100%",width:"100%"},children:x(X_,{className:Rr.app,padding:"md",navbar:x(E2t,{}),header:x(O2t,{}),children:x(P2t,{})})})}),Kn&&Dn==="report"&&x(DAe,{})]})}const M2t=()=>x(Cq,{withNormalizeCSS:!0,withGlobalStyles:!0,theme:{...Pme},children:x(vRe,{children:x(A2t,{})})});/**
 * @remix-run/router v1.16.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function KI(){return KI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KI.apply(this,arguments)}var Tp;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Tp||(Tp={}));const $G="popstate";function R2t(e){e===void 0&&(e={});function t(r,i){let{pathname:a,search:s,hash:o}=r.location;return qA("",{pathname:a,search:s,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:vpe(i)}return L2t(t,n,null,e)}function ype(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function D2t(){return Math.random().toString(36).substr(2,8)}function TG(e,t){return{usr:e.state,key:e.key,idx:t}}function qA(e,t,n,r){return n===void 0&&(n=null),KI({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?bpe(t):t,{state:n,key:t&&t.key||r||D2t()})}function vpe(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function bpe(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function L2t(e,t,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,s=i.history,o=Tp.Pop,l=null,u=c();u==null&&(u=0,s.replaceState(KI({},s.state,{idx:u}),""));function c(){return(s.state||{idx:null}).idx}function d(){o=Tp.Pop;let v=c(),y=v==null?null:v-u;u=v,l&&l({action:o,location:g.location,delta:y})}function p(v,y){o=Tp.Push;let b=qA(g.location,v,y);n&&n(b,v),u=c()+1;let _=TG(b,u),k=g.createHref(b);try{s.pushState(_,"",k)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(k)}a&&l&&l({action:o,location:g.location,delta:1})}function h(v,y){o=Tp.Replace;let b=qA(g.location,v,y);n&&n(b,v),u=c();let _=TG(b,u),k=g.createHref(b);s.replaceState(_,"",k),a&&l&&l({action:o,location:g.location,delta:0})}function m(v){let y=i.location.origin!=="null"?i.location.origin:i.location.href,b=typeof v=="string"?v:vpe(v);return b=b.replace(/ $/,"%20"),ype(y,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,y)}let g={get action(){return o},get location(){return e(i,s)},listen(v){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener($G,d),l=v,()=>{i.removeEventListener($G,d),l=null}},createHref(v){return t(i,v)},createURL:m,encodeLocation(v){let y=m(v);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:p,replace:h,go(v){return s.go(v)}};return g}var NG;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(NG||(NG={}));function F2t(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const z2t=["post","put","patch","delete"];[...z2t];/**
 * React Router v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function KA(){return KA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KA.apply(this,arguments)}const B2t=I.exports.createContext(null),wpe=I.exports.createContext(null);function W2t(){return I.exports.useContext(wpe)!=null}const V2t="startTransition";jp[V2t];function j2t(e){let{basename:t="/",children:n=null,location:r,navigationType:i=Tp.Pop,navigator:a,static:s=!1,future:o}=e;W2t()&&ype(!1);let l=t.replace(/^\/*/,"/"),u=I.exports.useMemo(()=>({basename:l,navigator:a,static:s,future:KA({v7_relativeSplatPath:!1},o)}),[l,o,a,s]);typeof r=="string"&&(r=bpe(r));let{pathname:c="/",search:d="",hash:p="",state:h=null,key:m="default"}=r,g=I.exports.useMemo(()=>{let v=F2t(c,l);return v==null?null:{location:{pathname:v,search:d,hash:p,state:h,key:m},navigationType:i}},[l,c,d,p,h,m,i]);return g==null?null:x(B2t.Provider,{value:u,children:x(wpe.Provider,{children:n,value:g})})}new Promise(()=>{});/**
 * React Router DOM v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const U2t="6";try{window.__reactRouterVersion=U2t}catch{}const H2t="startTransition",EG=jp[H2t],G2t="flushSync";Ome[G2t];const q2t="useId";jp[q2t];function K2t(e){let{basename:t,children:n,future:r,window:i}=e,a=I.exports.useRef();a.current==null&&(a.current=R2t({window:i,v5Compat:!0}));let s=a.current,[o,l]=I.exports.useState({action:s.action,location:s.location}),{v7_startTransition:u}=r||{},c=I.exports.useCallback(d=>{u&&EG?EG(()=>l(d)):l(d)},[l,u]);return I.exports.useLayoutEffect(()=>s.listen(c),[s,c]),x(j2t,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:s,future:r})}var OG;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(OG||(OG={}));var PG;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(PG||(PG={}));if(PR()){const e=document.getElementById("root");e.style.backgroundImage='url("https://i.imgur.com/3pzRj9n.png")',e.style.backgroundSize="cover",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="center"}const Z2t=document.getElementById("root");GE.createRoot(Z2t).render(x(Ni.StrictMode,{children:x(dAe,{children:x(K2t,{children:x(M2t,{})})})}));
